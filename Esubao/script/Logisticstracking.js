function Gather(e){ 
var l, c, i, s = "sf_gather_queue_page", d = "sf_gather_queue", u = "sf_gather_event", a = "sf_gather_id", h = !1, r = !1, p = 500, o = 1e3, f = [], m = [], g = [], _ = [], v = {}, y = [], b = !0, t = 0, w = null, C = 0, n = 0, x = 0, k = 60, T = 20, S = 0, $ = 60, A = 10, I = 0, D = !0, P = /^(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?:\:([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?:\:([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/, j = !0, L = ""; function M(e, t, i) { return e.hasOwnProperty(t) ? e[t] : i } function R(e) { var t = e.getAttribute("sftag"); if (!t) return null; var i = t.split(","); if (0 === i.length) return null; for (var n = { event_id: "click_auto", tagName: e.tagName.toLowerCase() }, a = ["id", "class"], s = 0; s < a.length; s++) { e.getAttribute(a[s]) && (n[a[s]] = e.getAttribute(a[s])) } for (s = 0; s < i.length; s++) { var r = i[s].split(":"); if (2 === r.length) { var o = r[0].trim(), l = r[1].trim(); "event_id" === o ? l && "null" !== l && (n.event_id = l) : n[o] = l } } return n } function O(e, t, i) { e.addEventListener ? e.addEventListener(t, i, !0) : e.attachEvent ? e.attachEvent("on" + t, i) : e["on" + t] = i } function E() { return Math.floor((new Date).getTime() / 1e3) } function N() { var e = (new Date).getTime(); return e <= I ? I++ : I = e, I } this.q = [], this.onload = [], this.app_id = "", this.device_id = q(a) || (i = (new Date).getTime(), "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, function (e) { var t = (i + 16 * Math.random()) % 16 | 0; return i = Math.floor(i / 16), ("x" == e ? t : 3 & t | 8).toString(16) })), this.url = "http://218.17.248.243:40021/json_data", this.platform = "pc", this.app_version = "0.0", this.uid = "", this.sec_uid = "", this.login_type = "", this.ignore_visitor = !1, this.ignore_report = !1, this.force_post = !1, this.auto = !0, this.auto_error = !0, this.auto_pv = !0, this.auto_sftag = !0, this.canParentAutoPop = !1, this.parentAutoPopLevel = 6, this.passed_data = {}, e && (this.q = e.q || [], r = e.debug || !1, this.url = e.url || "", this.app_id = e.app_id || "", this.app_version = e.app_version || "", this.storeKey = e.storeKey || ""), this.init = function (e) { if (c = E(), v = {}, p = (e = e || this).interval || p, o = e.queue_size || o, k = e.fail_timeout || k, T = e.inactivity_time || T, $ = e.session_update || $, A = e.max_events || A, this.app_id = e.app_id || this.app_id, this.device_id = e.device_id || this.device_id, this.url = function (e) { if ("/" == e.substr(e.length - 1)) return e.substr(0, e.length - 1); return e }(e.url || this.url), this.platform = e.platform || this.platform, this.app_version = e.app_version || this.app_version, this.uid = e.uid || this.uid, this.sec_uid = e.sec_uid || this.sec_uid, this.login_type = e.login_type || this.login_type, r = M(e, "debug", r), this.ignore_visitor = M(e, "ignore_visitor", this.ignore_visitor), this.ignore_report = M(e, "ignore_report", this.ignore_report), this.force_post = M(e, "force_post", this.force_post), this.auto = M(e, "auto", this.auto), this.auto_pv = M(e, "auto_pv", this.auto_pv), this.auto_sftag = M(e, "auto_sftag", this.auto_sftag), this.auto_error = M(e, "auto_error", this.auto_error), this.canParentAutoPop = M(e, "canParentAutoPop", this.canParentAutoPop), this.parentAutoPopLevel = M(e, "parentAutoPopLevel", this.parentAutoPopLevel), this.q = e.q || this.q, this.onload = e.onload || this.onload, e.ignore_referrers && e.ignore_referrers.constructor === Array && (y = e.ignore_referrers), L = this.initParams(e.storeKey || this.storeKey || window.location.pathname), function () { var t = !1; if ("undefined" != typeof localStorage) { t = !0; try { localStorage.setItem("testLocal", !0) } catch (e) { t = !1 } } t ? function () { for (var e = 0; e < localStorage.length; e++) { var t = localStorage.key(e); if (0 < t.search("sf_gather")) { var i = localStorage.getItem(t); i && "[]" !== i && "" !== i || localStorage.removeItem(t) } } }() : function () { for (var e = document.cookie.split(";"), t = "", i = 0, n = e.length; i < n; i++) { var a = e[i], s = a.split("="); if (2 === s.length) { var r = s[1], o = s[0]; 0 < o.search("sf_gather") && r && "[]" !== r && "" !== r && (t += a + "; ") } } document.cookie = t }() }(), g = U(u) || [], f = U(d) || [], function () { var e = U(s) || []; if (e.length && 0 < e.length) { for (var t = 0; t < e.length; t++)f.push(e[t]); U(d, f), U(s, m), e = null } }(), "" === this.url && (log("Please provide server URL"), this.ignore_visitor = !0), window.name && 0 === window.name.indexOf("sf_gather:") ? this.passed_data = JSON.parse(window.name.replace("sf_gather:", "")) : location.hash && 0 === location.hash.indexOf("#sf_gather:") && (this.passed_data = JSON.parse(location.hash.replace("#sf_gather:", ""))), this.passed_data && this.passed_data.token && this.passed_data.purpose && (this.passed_data.token != U("sf_gather_old_token") && (U("sf_gather_token", this.passed_data.token), U("sf_gather_old_token", this.passed_data.token)), "heatmap" === this.passed_data.purpose && (this.ignore_visitor = !0, showLoader(), loadJS(this.url + "/views/heatmap.js", hideLoader))), this.auto && this.initAction(), console, this.onload.constructor !== Array && (this.onload = []), this.q.constructor !== Array && (this.q = []), this.heartBeat(), q(a, this.device_id), location.search) for (var t = location.search.substring(1).split("&"), i = 0; i < t.length; i++) { var n = t[i].split("="); n[0] == a ? q("sf_gather_cmp_id", n[1]) : "sf_gather_uid" == n[0] && q("sf_gather_cmp_uid", n[1]) } }, this.initParams = function (e) { var t = e + "/" + this.app_id; if (!r) { for (var i = 0, n = 0, a = 0, s = 0; s < t.length; s++)i += a = t.charCodeAt(s), 47 == a && n++; t = i.toString(16) + "_" + n } return log("顺丰大数据:" + t), t }, this.initAction = function () { var t = this; this.auto_sftag && O(document, "click", function (e) { t.globalClickEventHandler(e) }), this.auto_pv && (O(window, "load", function () { t.onPageView() }), O(window, "hashchange", function () { t.onPageView() })), this.auto_error && (window.onerror = function () { t.onError(arguments) }) }, this.heartBeat = function () { var t = this; if (!this.ignore_report) { var e = 0; if (void 0 !== this.onload && 0 < this.onload.length) { for (e = 0; e < this.onload.length; e++)"function" == typeof this.onload[e] && this.onload[e](); this.onload = [] } if (void 0 !== this.q && 0 < this.q.length) { var i, n = this.q; for (this.q = [], e = 0; e < n.length; e++)i = n[e], log("Processing queued call", i), "function" == typeof this[i] ? this[i]() : i.constructor === Array && 0 < i.length && void 0 !== this[i[0]] && this[i[0]].apply(this, i.slice(1)) } if (h && b && j) { var a = E(); $ < a - l && (this.session_duration(a - l), l = a) } if (0 < g.length && !this.ignore_visitor) { if (1 === g.length) g.forEach(function (e) { t.toRequestQueue(e) }), g = []; else { var s = g.splice(0, A), r = { event_id: "batch", type: "batch", properties: [] }; s.forEach(function (e) { e.type || (e.type = "event"), r.properties.push(e) }), this.toRequestQueue(r) } U(u, g) } if (0 < f.length && D && E() > x) { D = !1; var o = f.shift(); log("Processing request", o), this.sendXmlHttpRequest(o, function (e, t) { log("Request Finished", t, e), e && (f.unshift(t), x = E() + k), U(d, f), D = !0 }) } } setTimeout(function () { t.heartBeat() }, p) }, this.sendDataDirect = function (e, t, i) { if (!this.ignore_visitor && e && "function" == typeof e) if (this.device_id) if (this.url) if (t) { var n = this.buildEvent(t); if (n) { var a = this.buildRequest(n); m.push(a), U(s, m), this.sendXmlHttpRequest(a, this.createTimeoutFunc(e, i)) } } else this.createTimeoutFunc(e, i); else log("url is missing"); else log("device_id is missing") }, this.createTimeoutFunc = function (e, t) { if (e) { var i = !1; function n() { 0 == arguments.length ? log("超时回调") : (log("请求回调参数：" + JSON.stringify(arguments)), arguments[0] || (m.shift(arguments[1]), U(s, m))), i || (i = !0, e(arguments)) } return t = isNaN(t) ? 1e3 : t, setTimeout(n, t), n } }, this.globalClickEventHandler = function (e) { var t = B(e), i = R(t); if (i && this.q.push(["add_event", i]), this.canParentAutoPop) for (var n = 0; t.parentElement && (t = t.parentElement, n++ , !(0 < this.parentAutoPopLevel && n > this.parentAutoPopLevel));)(i = R(t)) && this.q.push(["add_event", i]) }, this.buildRequest = function (e) { e.app_id = this.app_id, e.app_v = this.app_version, e.platform = this.platform, e.device_id = this.device_id, e.cookie_id = function (e) { for (var t = e + "=", i = document.cookie.split(";"), n = 0, a = i.length; n < a; n++) { for (var s = i[n]; " " === s.charAt(0);)s = s.substring(1, s.length); if (0 === s.indexOf(t)) return s.substring(t.length, s.length) } return null }("JSESSIONID") || "", e.sdk = "js", e.sdk_name = "SfGather-js", e.sdk_v = "1.0.14", e.s_w = function () { var e = window.devicePixelRatio || 1, t = Math.round(screen.width * e); 1242 === t && "ios" === H() && (t = 1080); 1082 === t && (t = 1080); return t }(), e.s_h = function () { var e = window.devicePixelRatio || 1, t = Math.round(screen.height * e); 2208 === t && "ios" === H() && (t = 1920); 1922 === t && (t = 1920); return t }(), e.model = function (e) { if ("android" === H(e = e || navigator.userAgent) && /android\s+\d+(?:.\d+)*;\s+(.+)\s+build/i.test(e)) return RegExp.$1; return "" }(), e.os = H(), e.os_v = function (e) { var t = H(e = e || navigator.userAgent); if ("android" === t) { if (/android\s+(\d+(.\d+)*)/i.test(e)) return RegExp.$1 } else if ("ios" === t && /cpu\s+(?:iphone\s+)?os\s+(\d+(_\d+)*)/i.test(e)) return RegExp.$1.replace(/_/g, "."); return "" }(); var t = function () { var e = { appname: "unknown", version: 0 }, t = window.navigator.userAgent.toLowerCase(); /(msie|firefox|opera|chrome|netscape)\D+(\d[\d.]*)/.test(t) ? (e.appname = RegExp.$1, e.version = RegExp.$2) : /version\D+(\d[\d.]*).*safari/.test(t) && (e.appname = "safari", e.version = RegExp.$2); return e }(); return e.browser = t.appname, e.browser_v = t.version, e.event_id || (e.event_id = "view_default"), e.type || (e.type = "event"), e.time || (e.time = N()), e }, this.toRequestQueue = function (e) { this.ignore_visitor || (this.device_id ? this.url ? (this.buildRequest(e), f.length > o && f.shift(), f.push(e), U(d, f)) : log("url is missing") : log("device_id is missing")) }, this.begin_session = function (e) { if (!h) { log("Session started"), l = E(), h = !0, b = !e; var t = { begin_session: 1, event_id: "session" }; this.add_event(t) } }, this.set_login_info = function (e, t, i) { e && (this.uid = e), t && (this.sec_uid = t), i && (this.login_type = i) }, this.session_duration = function (e) { h && (log("Session extended", e), this.add_event({ session_duration: e, event_id: "session_duration" })) }, this.end_session = function (e) { h && (e = e || E() - l, log("Ending session"), this.reportViewDuration(), h = !1, this.add_event({ event_id: "session", end_session: 1, session_duration: e })) }, this.change_id = function (e, t) { if (this.device_id != e) { t || (this.end_session(), v = {}); var i = this.device_id; this.device_id = e, q(a, this.device_id), log("Changing id"), t ? this.toRequestQueue({ old_device_id: i }) : this.begin_session(!b) } }, this.add_event = function (e) { var t = this.buildEvent(e); t && (g.push(t), U(u, g)) }, this.buildEvent = function (e) { if (!this.ignore_visitor) { var t = {}; return t.time = N(), e.page_url ? (t.page_url = e.page_url, delete e.page_url) : t.page_url = location.href, e.page_ref ? (t.page_ref = e.page_ref, delete e.page_ref) : t.page_ref = document.referrer, e.page_name ? (t.page_name = e.page_name, delete e.page_name) : document.getElementsByTagName("title")[0] && (t.page_name = document.getElementsByTagName("title")[0].innerHTML), e.event_id ? (t.event_id = e.event_id, delete e.event_id) : t.event_id = "view_default", t.properties = e, this.uid && (t.uid = this.uid), this.sec_uid && (t.sec_uid = this.sec_uid), this.login_type && (t.login_type = this.login_type), t } }, this.start_event = function (e) { v[e] ? log("Timed event with key " + e + " already started") : v[e] = E() }, this.end_event = function (e) { "string" == typeof e && (e = { key: e }), e.dur = E() - v[e.key], this.add_event(e), delete v[e.key] }, this.user_details = function (e) { log("Adding userdetails: ", e); this.toRequestQueue({ user_details: JSON.stringify(function (e, t) { for (var i, n = {}, a = 0; a < t.length; a++)i = t[a], void 0 !== e[i] && (n[i] = e[i]); return n }(e, ["name", "username", "email", "organization", "phone", "picture", "gender", "byear", "custom"])) }) }, this.onError = function (e) { var t, i, n; 0 < e.length && (t = e[0]), 1 < e.length && (i = e[1]), 2 < e.length && (n = e[2]); var a = ""; void 0 !== t && (a = a + t + "\n"), void 0 !== i && (a += "at " + i), void 0 !== n && (a += ":" + n), a += "\n"; try { for (var s = [], r = e.callee.caller; r;)s.push(r.name), r = r.caller; a += s.join("\n") } catch (e) { } this.recordError({ stack: a, event_id: "error_auto" }, !1) }, this.track_errors = function (e, t) { this.recordError(e, !0, t) }, this.add_log = function (e) { _.push(e) }, this.stop_time = function () { j && (j = !1, t = E() - l, n = E() - C) }, this.start_time = function () { j || (j = !0, l = E() - t, C = E() - n, n = 0) }, this.track_sessions = function () { this.begin_session(), this.start_time(); var e = this; O(window, "beforeunload", function () { e.end_session() }), O(window, "unload", function () { e.end_session() }); var t = "hidden"; function i() { document[t] ? e.stop_time() : e.start_time() } function n() { T <= S && e.start_time(), S = 0 } t in document ? document.addEventListener("visibilitychange", i) : (t = "mozHidden") in document ? document.addEventListener("mozvisibilitychange", i) : (t = "webkitHidden") in document ? document.addEventListener("webkitvisibilitychange", i) : (t = "msHidden") in document ? document.addEventListener("msvisibilitychange", i) : "onfocusin" in document ? (O(window, "focusin", function () { e.start_time() }), O(window, "focusout", function () { e.stop_time() })) : (O(window, "focus", function () { e.start_time() }), O(window, "blur", function () { e.stop_time() }), O(window, "pageshow", function () { e.start_time() }), O(window, "pagehide", function () { e.stop_time() })), O(window, "mousemove", n), O(window, "click", n), O(window, "keydown", n), O(window, "scroll", n), setInterval(function () { T <= ++S && e.stop_time() }, 6e4) }, this.track_pageview = function (e, t) { if (this.reportViewDuration(), e && e.constructor === Array && (t = e, e = null), e = e || window.location.pathname, t && t.length) for (var i = 0; i < t.length; i++)try { if (new RegExp(t[i]).test(e)) return void log("Ignored:", e) } catch (e) { } w = e, C = E(); var n = { name: e, visit: 1, domain: window.location.hostname }; if (void 0 !== document.referrer && document.referrer.length) { var a = P.exec(document.referrer); a && a[11] && a[11] != window.location.hostname && (n.start = 1) } n.event_id = "view_page", this.add_event(n) }, this.onPageView = function () { var e = { event_id: "view_page_auto" }; window.gatherConfig && window.gatherConfig._st && window.gatherConfig._st instanceof Date && (e.load_time = (new Date).getTime() - window.gatherConfig._st.getTime()), this.add_event(e) }, this.moniter_autoPV = this.onPageView, this.track_clicks = function (e, o) { e = e || document; var l = !0, c = this; O(e, "click", function (e) { if (l) { if (l = !1, F(e), void 0 !== e.pageX && void 0 !== e.pageY) { var t, i = (r = document, Math.max(Math.max(r.body.scrollHeight, r.documentElement.scrollHeight), Math.max(r.body.offsetHeight, r.documentElement.offsetHeight), Math.max(r.body.clientHeight, r.documentElement.clientHeight))), n = (s = document, Math.max(Math.max(s.body.scrollWidth, s.documentElement.scrollWidth), Math.max(s.body.offsetWidth, s.documentElement.offsetWidth), Math.max(s.body.clientWidth, s.documentElement.clientWidth))), a = { type: "click", x: e.pageX, y: e.pageY, width: n, height: i, domain: window.location.hostname }; (t = o ? Object.assign(o, a) : a).event_id = "click", c.add_event(t) } setTimeout(function () { l = !0 }, 1e3) } var s, r }) }, this.track_links = function (e) { O(e = e || document, "click", function (e) { var t = B(e).closest("a"); t && (F(e), this.add_event({ event_id: "click_link", href: t.href, text: t.innerText, id: t.id, x: e.pageX, y: e.pageY }), void 0 === t.href || "_blank" === t.target || e.metaKey || e.altKey || e.ctrlKey || e.shiftKey || 0 !== t.href.replace(window.location.href.split("#")[0], "").indexOf("#") && this.end_session()) }) }, this.track_forms = function (e) { function l(e) { return e.name || e.id || e.type || e.nodeName } e = e || document; var c = this; O(e, "submit", function (e) { var t, i = B(e), n = { id: i.id, name: i.name, action: i.action, method: i.method }; if (void 0 !== i.elements) for (var a = 0; a < i.elements.length; a++)if ((t = i.elements[a]) && "password" != t.type) if (void 0 === n["input:" + l(t)] && (n["input:" + l(t)] = []), "select" == t.nodeName.toLowerCase()) if (void 0 !== t.multiple) { var s = []; if (void 0 !== t.options) for (var r = 0; r < t.options.length; r++)t.options[r].selected && s.push(t.options[r].value); n["input:" + l(t)].push(s.join(", ")) } else n["input:" + l(t)].push(t.options[t.selectedIndex].value); else "input" == t.nodeName.toLowerCase() ? void 0 === t.type || "checkbox" != t.type.toLowerCase() && "radio" != t.type.toLowerCase() ? n["input:" + l(t)].push(t.value) : t.checked && n["input:" + l(t)].push(t.value) : "textarea" == t.nodeName.toLowerCase() ? n["input:" + l(t)].push(t.value) : void 0 !== t.value && n["input:" + l(t)].push(t.value); for (var o in n) void 0 !== n[o].join && (n[o] = n[o].join(", ")); n.event_id = "formSubmit", c.add_event(n), c.end_session() }) }, this.collect_from_forms = function (h, p) { h = h || document; var f = this; O(h, "submit", function (e) { var t, i = B(e), n = {}, a = !1; if (void 0 !== i.elements) { var s, r, o = {}, l = h.getElementsByTagName("LABEL"); for (s = 0; s < l.length; s++)l[s].htmlFor && "" !== l[s].htmlFor && (o[l[s].htmlFor] = l[s].innerText || l[s].textContent || l[s].innerHTML); for (s = 0; s < i.elements.length; s++)if ((t = i.elements[s]) && "password" != t.type && -1 == t.className.indexOf("sf_gather_user_ignore")) { var c = ""; if ("select" == t.nodeName.toLowerCase()) if (void 0 !== t.multiple) { var d = []; if (void 0 !== t.options) for (r = 0; r < t.options.length; r++)t.options[r].selected && d.push(t.options[r].value); c = d.join(", ") } else c = t.options[t.selectedIndex].value; else "input" == t.nodeName.toLowerCase() ? void 0 === t.type || "checkbox" != t.type.toLowerCase() && "radio" != t.type.toLowerCase() ? c = t.value : t.checked && (c = t.value) : "textarea" == t.nodeName.toLowerCase() ? c = t.value : void 0 !== t.value && (c = t.value); if (t.className && -1 != t.className.indexOf("sf_gather_user_")) { var u = t.className.split(" "); for (r = 0; r < u.length; r++)if (0 === u[r].indexOf("sf_gather_user_")) { n[u[r].replace("sf_gather_user_", "")] = c, a = !0; break } } else t.type && "email" == t.type.toLowerCase() || t.name && -1 != t.name.toLowerCase().indexOf("email") || t.id && -1 != t.id.toLowerCase().indexOf("email") || t.id && o[t.id] && -1 != o[t.id].toLowerCase().indexOf("email") || /[^@\s]+@[^@\s]+\.[^@\s]+/.test(c) ? (n.email || (n.email = c), a = !0) : t.name && -1 != t.name.toLowerCase().indexOf("username") || t.id && -1 != t.id.toLowerCase().indexOf("username") || t.id && o[t.id] && -1 != o[t.id].toLowerCase().indexOf("username") ? (n.username || (n.username = c), a = !0) : t.name && (-1 != t.name.toLowerCase().indexOf("tel") || -1 != t.name.toLowerCase().indexOf("phone") || -1 != t.name.toLowerCase().indexOf("number")) || t.id && (-1 != t.id.toLowerCase().indexOf("tel") || -1 != t.id.toLowerCase().indexOf("phone") || -1 != t.id.toLowerCase().indexOf("number")) || t.id && o[t.id] && (-1 != o[t.id].toLowerCase().indexOf("tel") || -1 != o[t.id].toLowerCase().indexOf("phone") || -1 != o[t.id].toLowerCase().indexOf("number")) ? (n.phone || (n.phone = c), a = !0) : t.name && (-1 != t.name.toLowerCase().indexOf("org") || -1 != t.name.toLowerCase().indexOf("company")) || t.id && (-1 != t.id.toLowerCase().indexOf("org") || -1 != t.id.toLowerCase().indexOf("company")) || t.id && o[t.id] && (-1 != o[t.id].toLowerCase().indexOf("org") || -1 != o[t.id].toLowerCase().indexOf("company")) ? (n.organization || (n.organization = c), a = !0) : (t.name && -1 != t.name.toLowerCase().indexOf("name") || t.id && -1 != t.id.toLowerCase().indexOf("name") || t.id && o[t.id] && -1 != o[t.id].toLowerCase().indexOf("name")) && (n.name || (n.name = ""), n.name += c + " ", a = !0) } } a && (log("Gathered user data", n), p ? f.user_details({ custom: n }) : f.user_details(n)), f.end_session() }) }, this.reportViewDuration = function () { if (w) { var e = { event_id: "view_page_duration", name: w, segment: this.platform, dur: E() - C }; this.add_event(e), w = null } }, this.getMetrics = function () { var e = {}; if (e._app_version = this.app_version, e._ua = navigator.userAgent, screen.width) { var t = screen.width ? parseInt(screen.width) : 0, i = screen.height ? parseInt(screen.height) : 0; if (0 !== t && 0 !== i) { if (!!navigator.platform && /iPad|iPhone|iPod/.test(navigator.platform) && window.devicePixelRatio) t = Math.round(t * window.devicePixelRatio), i = Math.round(i * window.devicePixelRatio); else if (90 === Math.abs(window.orientation)) { var n = t; t = i, i = n } e._resolution = t + "x" + i } } window.devicePixelRatio && (e._density = window.devicePixelRatio); var a = navigator.language || navigator.browserLanguage || navigator.systemLanguage || navigator.userLanguage; if (void 0 !== a && (e._locale = a), void 0 !== document.referrer && document.referrer.length) { var s = P.exec(document.referrer); if (s && s[11] && s[11] != window.location.hostname) { var r = !1; if (y && y.length) for (var o = 0; o < y.length; o++)try { if (new RegExp(y[o]).test(document.referrer)) { log("Ignored:", document.referrer), r = !0; break } } catch (e) { } r || (e._store = document.referrer) } } return log("Got metrics", e), e }, log = function () { r && "undefined" != typeof console && arguments[1] && "object" == typeof arguments[1] && (arguments[1] = JSON.stringify(arguments[1])) }, this.recordError = function (e, t, i) { if (e) { i = i || null; var n = ""; "object" == typeof e ? void 0 !== e.stack ? n = e.stack : (void 0 !== e.name && (n += e.name + ":"), void 0 !== e.message && (n += e.message + "\n"), void 0 !== e.fileName && (n += "in " + e.fileName + "\n"), void 0 !== e.lineNumber && (n += "on " + e.lineNumber), void 0 !== e.columnNumber && (n += ":" + e.columnNumber)) : n = e + "", t = !!t; var a = this.getMetrics(), s = { _resolution: a._resolution, _error: n, _app_version: a._app_version, _run: E() - c, _not_os_specific: !0 }, r = navigator.battery || navigator.webkitBattery || navigator.mozBattery || navigator.msBattery; r && (s._bat = Math.floor(100 * r.level)), void 0 !== navigator.onLine && (s._online = !!navigator.onLine), s._background = !document.hasFocus(), 0 < _.length && (s._logs = _.join("\n")), _ = [], s._nonfatal = t, s._view = (window.location.pathname || "") + (window.location.search || "") + (window.location.hash || ""), void 0 !== i && (s._custom = i); try { var o = document.createElement("canvas").getContext("experimental-webgl"); s._opengl = o.getParameter(o.VERSION) } catch (e) { } var l = e.event_id ? e.event_id : "error"; this.add_event({ error_log: JSON.stringify(s), event_id: l }) } }, this.sendXmlHttpRequest = function (t, i) { try { log("Sending XML HTTP request"); var e = window.XMLHttpRequest ? new window.XMLHttpRequest : window.ActiveXObject ? new ActiveXObject("Microsoft.XMLHTTP") : null, n = JSON.stringify(t); e.open("POST", this.url + "", !0), e.setRequestHeader("Content-type", "text/plain; charset=utf-8"), e.onreadystatechange = function () { 4 === this.readyState && 200 <= this.status && this.status < 500 ? "function" == typeof i && i(!1, t) : 4 === this.readyState && (log("Failed Server XML HTTP request", this.status), "function" == typeof i && i(!0, t)) }, e.send(n) } catch (e) { log("Failed XML HTTP request", e), "function" == typeof i && i(!0, t) } }, Element.prototype.closest || (Element.prototype.closest = function (e) { var t = this; for (e = e.toUpperCase(); t;) { if (t.nodeName.toUpperCase() == e) return t; t = t.parentElement } }); var B = function (e) { return e ? void 0 !== e.target ? e.target : e.srcElement : window.event.srcElement }; function F(e) { return void 0 === e.pageY && "number" == typeof e.clientX && document.documentElement && (e.pageX = e.clientX + document.body.scrollLeft + document.documentElement.scrollLeft, e.pageY = e.clientY + document.body.scrollTop + document.documentElement.scrollTop), e } function q(e, t, i) { i = i || !1; var n, a = !1; if ("undefined" != typeof localStorage) { a = !0; try { localStorage.setItem("testLocal", !0) } catch (e) { a = !1 } } if (null != t && ("object" == typeof t && (t = JSON.stringify(t)), a ? localStorage.setItem(e, t) : i || s(e, t, 30)), void 0 === t) { a ? n = localStorage.getItem(e) : i || (n = function (e) { for (var t = e + "=", i = document.cookie.split(";"), n = 0, a = i.length; n < a; n++) { for (var s = i[n]; " " === s.charAt(0);)s = s.substring(1, s.length); if (0 === s.indexOf(t)) return s.substring(t.length, s.length) } return null }(e)); try { n = JSON.parse(n) } catch (e) { n = n } return n } function s(e, t, i) { var n = new Date; n.setTime(n.getTime() + 24 * i * 60 * 60 * 1e3); var a = "; expires=" + n.toGMTString(); document.cookie = e + "=" + t + a + "; path=/" } null === t && (a ? localStorage.removeItem(e) : i || s(e, "", -1)) } function U(e, t) { if ("string" == typeof L && "string" == typeof e && 0 !== e.trim().length) { var i = L + "_" + e; if (void 0 === t) { var n = q(i); return n || null } q(i, t) } } function H(e) { return e = e || navigator.userAgent, /(Windows NT 10.0|Windows 10)/i.test(e) ? "windows 10" : /(Windows NT 6.3|Windows 8.1)/i.test(e) ? "windows 8.1" : /(Windows NT 6.2|Windows 8)/i.test(e) ? "windows 8" : /(Windows NT 6.1|Windows 7)/i.test(e) ? "windows 7" : /Windows NT 6.0/i.test(e) ? "windows vista" : /Windows NT 5.2/i.test(e) ? "windows 2003" : /Windows NT 5.1/i.test(e) ? "windows xp" : /Windows NT 5.0/i.test(e) ? "windows 2000" : /(iPhone|iPad|iPod|iOS)/i.test(e) ? "ios" : /android/i.test(e) ? "android" : /linux/i.test(e) ? "linux" : /(macintosh|mac os x)/i.test(e) ? "mac os" : "" } } !function (e, m) { "use strict"; var i = m.prototype.trim, n = m.prototype.trimRight, a = m.prototype.trimLeft, s = function (e) { return 1 * e || 0 }, r = function (e, t) { if (t < 1) return ""; for (var i = ""; 0 < t;)1 & t && (i += e), t >>= 1, e += e; return i }, o = [].slice, l = function (e) { return null == e ? "\\s" : e.source ? e.source : "[" + h.escapeRegExp(e) + "]" }; function c(e, t) { var i, n, a = e.toLowerCase(); for (t = [].concat(t), i = 0; i < t.length; i += 1)if (n = t[i]) { if (n.test && n.test(e)) return !0; if (n.toLowerCase() === a) return !0 } } var d = { lt: "<", gt: ">", quot: '"', amp: "&", apos: "'" }, t = {}; for (var u in d) t[d[u]] = u; t["'"] = "#39"; var g = function () { function p(e) { return Object.prototype.toString.call(e).slice(8, -1).toLowerCase() } var f = r, e = function () { return e.cache.hasOwnProperty(arguments[0]) || (e.cache[arguments[0]] = e.parse(arguments[0])), e.format.call(null, e.cache[arguments[0]], arguments) }; return e.format = function (e, t) { var i, n, a, s, r, o, l, c = 1, d = e.length, u = "", h = []; for (n = 0; n < d; n++)if ("string" === (u = p(e[n]))) h.push(e[n]); else if ("array" === u) { if ((s = e[n])[2]) for (i = t[c], a = 0; a < s[2].length; a++) { if (!i.hasOwnProperty(s[2][a])) throw new Error(g('[_.sprintf] property "%s" does not exist', s[2][a])); i = i[s[2][a]] } else i = s[1] ? t[s[1]] : t[c++]; if (/[^s]/.test(s[8]) && "number" != p(i)) throw new Error(g("[_.sprintf] expecting number but found %s", p(i))); switch (s[8]) { case "b": i = i.toString(2); break; case "c": i = m.fromCharCode(i); break; case "d": i = parseInt(i, 10); break; case "e": i = s[7] ? i.toExponential(s[7]) : i.toExponential(); break; case "f": i = s[7] ? parseFloat(i).toFixed(s[7]) : parseFloat(i); break; case "o": i = i.toString(8); break; case "s": i = (i = m(i)) && s[7] ? i.substring(0, s[7]) : i; break; case "u": i = Math.abs(i); break; case "x": i = i.toString(16); break; case "X": i = i.toString(16).toUpperCase() }i = /[def]/.test(s[8]) && s[3] && 0 <= i ? "+" + i : i, o = s[4] ? "0" == s[4] ? "0" : s[4].charAt(1) : " ", l = s[6] - m(i).length, r = s[6] ? f(o, l) : "", h.push(s[5] ? i + r : r + i) } return h.join("") }, e.cache = {}, e.parse = function (e) { for (var t = e, i = [], n = [], a = 0; t;) { if (null !== (i = /^[^\x25]+/.exec(t))) n.push(i[0]); else if (null !== (i = /^\x25{2}/.exec(t))) n.push("%"); else { if (null === (i = /^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(t))) throw new Error("[_.sprintf] huh?"); if (i[2]) { a |= 1; var s = [], r = i[2], o = []; if (null === (o = /^([a-z_][a-z_\d]*)/i.exec(r))) throw new Error("[_.sprintf] huh?"); for (s.push(o[1]); "" !== (r = r.substring(o[0].length));)if (null !== (o = /^\.([a-z_][a-z_\d]*)/i.exec(r))) s.push(o[1]); else { if (null === (o = /^\[(\d+)\]/.exec(r))) throw new Error("[_.sprintf] huh?"); s.push(o[1]) } i[2] = s } else a |= 2; if (3 === a) throw new Error("[_.sprintf] mixing positional and named placeholders is not (yet) supported"); n.push(i) } t = t.substring(i[0].length) } return n }, e }(), h = { VERSION: "2.3.0", isBlank: function (e) { return null == e && (e = ""), /^\s*$/.test(e) }, stripTags: function (e) { return null == e ? "" : m(e).replace(/<\/?[^>]+>/g, "") }, capitalize: function (e) { return (e = null == e ? "" : m(e)).charAt(0).toUpperCase() + e.slice(1) }, chop: function (e, t) { return null == e ? [] : (e = m(e), 0 < (t = ~~t) ? e.match(new RegExp(".{1," + t + "}", "g")) : [e]) }, clean: function (e) { return h.strip(e).replace(/\s+/g, " ") }, count: function (e, t) { if (null == e || null == t) return 0; e = m(e); for (var i = 0, n = 0, a = (t = m(t)).length; -1 !== (n = e.indexOf(t, n));)i++ , n += a; return i }, chars: function (e) { return null == e ? [] : m(e).split("") }, swapCase: function (e) { return null == e ? "" : m(e).replace(/\S/g, function (e) { return e === e.toUpperCase() ? e.toLowerCase() : e.toUpperCase() }) }, escapeHTML: function (e) { return null == e ? "" : m(e).replace(/[&<>"']/g, function (e) { return "&" + t[e] + ";" }) }, unescapeHTML: function (e) { return null == e ? "" : m(e).replace(/\&([^;]+);/g, function (e, t) { var i; return t in d ? d[t] : (i = t.match(/^#x([\da-fA-F]+)$/)) ? m.fromCharCode(parseInt(i[1], 16)) : (i = t.match(/^#(\d+)$/)) ? m.fromCharCode(~~i[1]) : e }) }, escapeRegExp: function (e) { return null == e ? "" : m(e).replace(/([.*+?^=!:${}()|[\]\/\\])/g, "\\$1") }, splice: function (e, t, i, n) { var a = h.chars(e); return a.splice(~~t, ~~i, n), a.join("") }, insert: function (e, t, i) { return h.splice(e, t, 0, i) }, include: function (e, t) { return "" === t || null != e && -1 !== m(e).indexOf(t) }, join: function () { var e = o.call(arguments), t = e.shift(); return null == t && (t = ""), e.join(t) }, lines: function (e) { return null == e ? [] : m(e).split("\n") }, reverse: function (e) { return h.chars(e).reverse().join("") }, startsWith: function (e, t) { return "" === t || null != e && null != t && (e = m(e), t = m(t), e.length >= t.length && e.slice(0, t.length) === t) }, endsWith: function (e, t) { return "" === t || null != e && null != t && (e = m(e), t = m(t), e.length >= t.length && e.slice(e.length - t.length) === t) }, succ: function (e) { return null == e ? "" : (e = m(e)).slice(0, -1) + m.fromCharCode(e.charCodeAt(e.length - 1) + 1) }, titleize: function (e) { return null == e ? "" : (e = m(e).toLowerCase()).replace(/(?:^|\s|-)\S/g, function (e) { return e.toUpperCase() }) }, camelize: function (e) { return h.trim(e).replace(/[-_\s]+(.)?/g, function (e, t) { return t ? t.toUpperCase() : "" }) }, underscored: function (e) { return h.trim(e).replace(/([a-z\d])([A-Z]+)/g, "$1_$2").replace(/[-\s]+/g, "_").toLowerCase() }, dasherize: function (e) { return h.trim(e).replace(/([A-Z])/g, "-$1").replace(/[-_\s]+/g, "-").toLowerCase() }, classify: function (e) { return h.titleize(m(e).replace(/[\W_]/g, " ")).replace(/\s/g, "") }, humanize: function (e) { return h.capitalize(h.underscored(e).replace(/_id$/, "").replace(/_/g, " ")) }, trim: function (e, t) { return null == e ? "" : !t && i ? i.call(e) : (t = l(t), m(e).replace(new RegExp("^" + t + "+|" + t + "+$", "g"), "")) }, ltrim: function (e, t) { return null == e ? "" : !t && a ? a.call(e) : (t = l(t), m(e).replace(new RegExp("^" + t + "+"), "")) }, rtrim: function (e, t) { return null == e ? "" : !t && n ? n.call(e) : (t = l(t), m(e).replace(new RegExp(t + "+$"), "")) }, truncate: function (e, t, i) { return null == e ? "" : (i = i || "...", t = ~~t, (e = m(e)).length > t ? e.slice(0, t) + i : e) }, prune: function (e, t, i) { if (null == e) return ""; if (e = m(e), t = ~~t, i = null != i ? m(i) : "...", e.length <= t) return e; var n = e.slice(0, t + 1).replace(/.(?=\W*\w*$)/g, function (e) { return e.toUpperCase() !== e.toLowerCase() ? "A" : " " }); return ((n = n.slice(n.length - 2).match(/\w\w/) ? n.replace(/\s*\S+$/, "") : h.rtrim(n.slice(0, n.length - 1))) + i).length > e.length ? e : e.slice(0, n.length) + i }, words: function (e, t) { return h.isBlank(e) ? [] : h.trim(e, t).split(t || /\s+/) }, pad: function (e, t, i, n) { e = null == e ? "" : m(e), t = ~~t; var a = 0; switch (i ? 1 < i.length && (i = i.charAt(0)) : i = " ", n) { case "right": return a = t - e.length, e + r(i, a); case "both": return a = t - e.length, r(i, Math.ceil(a / 2)) + e + r(i, Math.floor(a / 2)); default: return a = t - e.length, r(i, a) + e } }, lpad: function (e, t, i) { return h.pad(e, t, i) }, rpad: function (e, t, i) { return h.pad(e, t, i, "right") }, lrpad: function (e, t, i) { return h.pad(e, t, i, "both") }, sprintf: g, vsprintf: function (e, t) { return t.unshift(e), g.apply(null, t) }, toNumber: function (e, t) { return e ? (e = h.trim(e)).match(/^-?\d+(?:\.\d+)?$/) ? s(s(e).toFixed(~~t)) : NaN : 0 }, numberFormat: function (e, t, i, n) { if (isNaN(e) || null == e) return ""; n = "string" == typeof n ? n : ","; var a = (e = e.toFixed(~~t)).split("."), s = a[0], r = a[1] ? (i || ".") + a[1] : ""; return s.replace(/(\d)(?=(?:\d{3})+$)/g, "$1" + n) + r }, strRight: function (e, t) { if (null == e) return ""; e = m(e); var i = (t = null != t ? m(t) : t) ? e.indexOf(t) : -1; return ~i ? e.slice(i + t.length, e.length) : e }, strRightBack: function (e, t) { if (null == e) return ""; e = m(e); var i = (t = null != t ? m(t) : t) ? e.lastIndexOf(t) : -1; return ~i ? e.slice(i + t.length, e.length) : e }, strLeft: function (e, t) { if (null == e) return ""; e = m(e); var i = (t = null != t ? m(t) : t) ? e.indexOf(t) : -1; return ~i ? e.slice(0, i) : e }, strLeftBack: function (e, t) { if (null == e) return ""; var i = (e += "").lastIndexOf(t = null != t ? "" + t : t); return ~i ? e.slice(0, i) : e }, toSentence: function (e, t, i, n) { t = t || ", ", i = i || " and "; var a = e.slice(), s = a.pop(); return 2 < e.length && n && (i = h.rtrim(t) + i), a.length ? a.join(t) + i + s : s }, toSentenceSerial: function () { var e = o.call(arguments); return e[3] = !0, h.toSentence.apply(h, e) }, slugify: function (e) { if (null == e) return ""; var i = "ąàáäâãåæăćęèéëêìíïîłńòóöôõøśșțùúüûñçżź", t = new RegExp(l(i), "g"); return e = m(e).toLowerCase().replace(t, function (e) { var t = i.indexOf(e); return "aaaaaaaaaceeeeeiiiilnoooooosstuuuunczz".charAt(t) || "-" }), h.dasherize(e.replace(/[^\w\s-]/g, "")) }, surround: function (e, t) { return [t, e, t].join("") }, quote: function (e, t) { return h.surround(e, t || '"') }, unquote: function (e, t) { return t = t || '"', e[0] === t && e[e.length - 1] === t ? e.slice(1, e.length - 1) : e }, exports: function () { var e = {}; for (var t in this) this.hasOwnProperty(t) && !t.match(/^(?:include|contains|reverse)$/) && (e[t] = this[t]); return e }, repeat: function (e, t, i) { if (null == e) return ""; if (t = ~~t, null == i) return r(m(e), t); for (var n = []; 0 < t; n[--t] = e); return n.join(i) }, naturalCmp: function (e, t) { if (e == t) return 0; if (!e) return -1; if (!t) return 1; for (var i = /(\.\d+)|(\d+)|(\D+)/g, n = m(e).toLowerCase().match(i), a = m(t).toLowerCase().match(i), s = Math.min(n.length, a.length), r = 0; r < s; r++) { var o = n[r], l = a[r]; if (o !== l) { var c = parseInt(o, 10); if (!isNaN(c)) { var d = parseInt(l, 10); if (!isNaN(d) && c - d) return c - d } return o < l ? -1 : 1 } } return n.length === a.length ? n.length - a.length : e < t ? -1 : 1 }, levenshtein: function (e, t) { if (null == e && null == t) return 0; if (null == e) return m(t).length; if (null == t) return m(e).length; e = m(e), t = m(t); for (var i, n, a = [], s = 0; s <= t.length; s++)for (var r = 0; r <= e.length; r++)n = s && r ? e.charAt(r - 1) === t.charAt(s - 1) ? i : Math.min(a[r], a[r - 1], i) + 1 : s + r, i = a[r], a[r] = n; return a.pop() }, toBoolean: function (e, t, i) { return "number" == typeof e && (e = "" + e), "string" != typeof e ? !!e : !!c(e = h.trim(e), t || ["true", "1"]) || !c(e, i || ["false", "0"]) && void 0 } }; h.strip = h.trim, h.lstrip = h.ltrim, h.rstrip = h.rtrim, h.center = h.lrpad, h.rjust = h.lpad, h.ljust = h.rpad, h.contains = h.include, h.q = h.quote, h.toBool = h.toBoolean, "undefined" != typeof exports && ("undefined" != typeof module && module.exports && (module.exports = h), exports._s = h), "function" == typeof define && define.amd && define("underscore.string", [], function () { return h }), e._ = e._ || {}, e._.string = e._.str = h }(this, String), define("const", [], function () { return _.extend({}, { OPEN_MAP_MODEL_KEY: "open-map-model", LATEST_SENDER_ADDRESS_PREFIX: "latest_sender_address_", ALREADY_IFA_VISITOR: "alreadyifaVisitor", ACS_PAY_URL: "acsPayUrl", CURRENT_SELECTED_AREA: "currentSelectedArea", AGREE_QRCODE_CLOUD: "agreeQrCodeCloud" }, { CUR_CN: "￥", CUR_HK: "HKD", CUR_MACAO: "MOP", CUR_TW: "NTD" }, { RATE_OF_HK: "852", RATE_OF_MACAO: "853", RATE_OF_TW: "886" }, { VIRTUAL_T13: ["MOW01A", "ARN01S", "OSL01S", "HEL01S", "TLL01S", "KBP01S", "VNO01S", "RIX01S", "MSQ01S", "WAW01S"], VIRTUAL_T14: ["MOW01A", "ARN01S", "OSL01S", "HEL01S", "TLL01S", "KBP01S"] }, { IVR_SEND: "2", SCAN_SEND: "3", CCS5_SEND: "5", SHUN_XIN_JI: "17", CITY_WIDE: "18" }) }), jQuery.cookie = function (e, t, i) { if (void 0 === t) { var n = null; if (document.cookie && "" != document.cookie) for (var a = document.cookie.split(";"), s = 0; s < a.length; s++) { var r = jQuery.trim(a[s]); if (r.substring(0, e.length + 1) == e + "=") { n = decodeURIComponent(r.substring(e.length + 1)); break } } return n } i = i || {}, null === t && (t = "", i.expires = -1); var o, l = ""; i.expires && ("number" == typeof i.expires || i.expires.toUTCString) && ("number" == typeof i.expires ? (o = new Date).setTime(o.getTime() + 24 * i.expires * 60 * 60 * 1e3) : o = i.expires, l = "; expires=" + o.toUTCString()); var c = i.path ? "; path=" + i.path : "", d = i.domain ? "; domain=" + i.domain : "", u = i.secure ? "; secure" : ""; document.cookie = [e, "=", encodeURIComponent(t), l, c, d, u].join("") }, define("jqcookie", function () { }), define("helper", ["underscore", "const", "jqcookie"], function (r, i) { return { urls: { subregionOrigin: "region/%(parentCode)s/subRegions/origins?level=%(level)s", subregionDest: "region/%(parentCode)s/subRegions/dests?originCode=%(originCode)s&level=%(level)s" }, getSiteLocation: function () { return r.has(window, "_cmsConfig") ? window._cmsConfig.region : "cn" }, getSiteLanguage: function () { return r.has(window, "_cmsConfig") ? window._cmsConfig.language : "sc" }, getParsleyLanguage: function () { var e = { sc: "zh_cn", tc: "zh_tw", ko: "ko", ja: "ja", th: "th", fr: "fr", de: "de" }; return e[this.getSiteLanguage().toLowerCase()] ? e[this.getSiteLanguage().toLowerCase()] : "en" }, getStandardLocale: function () { return { sc: "zh-CN", en: "en-US", tc: "zh-tw", ko: "ko", ja: "ja", ru: "ru", vi: "vn", th: "th", de: "de", fr: "fr" }[this.getSiteLanguage().toLowerCase()] }, assemabledLocationAndLanguageQureyString: function () { return _p("?lang=%s&region=%s", this.getSiteLanguage(), this.getSiteLocation()) }, getUcmpWx: function () { return r.has(window, "_cmsConfig") ? window._cmsConfig.ucmpWx : "https://ucmp.sf-express.com/" }, getUcmpX: function () { return r.has(window, "_cmsConfig") ? window._cmsConfig.ucmpX : "https://ucmp-x.sf-express.com/" }, getOnlineServiceUrl: function () { return "cn" === this.getSiteLanguage() ? _webConfig.onlineServiceUrlCn : _webConfig.onlineServiceUrlEn }, getRESTfulDomain: function (t) { if (_webConfig.newServer.coreSystemIsWork) { var i = !1; if (_webConfig.newServer.coreSystemUrls.forEach(function (e) { new RegExp(e).test(t) && (i = !0) }), i) return "/sf-service-core-web/service/" + t } if (!r.has(window, "_cmsConfig")) return "/sf-service-owf-web/service/" + t; var e = window._cmsConfig.dynamicServerContext; return "/" !== r(e).last() && (e += "/"), "https:" === location.protocol && (e = e.replace("http:", "https:")), e + t }, getImportAndExportPicture: function () { return r.has(window, "_cmsConfig") ? window._cmsConfig.resourcePath + "images/guanwu/" : "https://owf.sit.sf-express.com/resource/images/guanwu/" }, getQueryStrings: function () { if (0 === location.search.slice(1).length) return null; var i = {}, e = location.search.slice(1).split("&"); return r.each(e, function (e) { var t = e.split("="); i[t[0]] = decodeURIComponent(t[1]) || "" }), i }, switchRegionAndLanguage: function (e, t) { if (r.has(window, "_cmsConfig")) { var i = window.location.href, n = window._cmsConfig.language, a = window._cmsConfig.region; if (a != e) { var s = i.indexOf("/" + a + "/" + n + "/"); i = i.substring(0, s), window.location.href = i + "/" + e + "/" + t + "/" } else window.location.href = i.replace("/" + a + "/" + n + "/", "/" + e + "/" + t + "/") } }, getDynamicURLWithContext: function (e) { return this.getURLWithContext("/dynamic_function" + e) }, getURLWithContext: function (e) { var t = "/"; if (r.has(window, "_cmsConfig")) { var i = window._cmsConfig; t = i.root[i.region][i.language] + "/" } return "/" === e[0] && (e = e.substring(1)), t + e }, getResourceURL: function (e) { return r.has(window, "_cmsConfig") ? window._cmsConfig.resourcePath + e : e }, validIdcardNumber: function (e) { return /^\d{17}[0-9|x|X]/.test(e) }, getArea: function (e) { return /^1\d{10}$/.test(e) ? "" : "hk" == this.getSiteLocation() ? "852" : "tw" == this.getSiteLocation() ? "886" : "" }, isValidPhoneNumber: function (e) { return /^(?:[\(]?[\+]?[\d]+[\)]?)((?:\s|-)?[\(]?[\d]*[\)]?)*$/.test(e) }, isValidMobileByChinaAndHMT: function (e) { return /^[1]\d{10}$|^[569]{1}\d{7}$|^6\d{7}$|^9\d{8}$/.test(e) }, isValidMailAddr: function (e) { return /^([\w-]+[\.\w-]*)@([\w-])+([\.\w-])+/.test(e) }, parseChineseChar: function (e) { return encodeURIComponent(e).replace(/%[A-F\d]{2}/g, "U") }, chineseCharSubString: function (e, t, i) { for (var n = 0, a = "", s = /[^\x00-\xff]/g, r = "", o = e.replace(s, "**").length, l = 0; l < o && (null != (r = e.charAt(l).toString()).match(s) ? n += 2 : n++ , !(t < n)); l++)a += r; return i && t < o && (a += "..."), a }, setArrayToCookie: function (e, t, i) { i && t.length > i && (t = t.splice(0, i)), $.cookie(e, t.join(","), { path: "/", expires: 92 }) }, getArrayFromCookie: function (e) { return $.cookie(e) ? $.cookie(e).split(",") : [] }, delArrayItemFromCookie: function (e, t) { if ($.cookie(e)) { var i = $.cookie(e).split(","); i = i.filter(function (e) { return e != t }), $.cookie(e, i.join(","), { path: "/", expires: 92 }) } }, handleStr: function (e) { var t = e.length; return 10 < t ? e.substring(0, 3) + "****" + e.substring(t - 4) : 4 < t || 4 == t ? "****" + e.substring(t - 4) : "****" }, isDirectCity: function (t) { return null != r.find(["010", "021", "022", "023"], function (e) { return e == t }) }, isHK_MC_TW: function (t) { return null != r.find([i.RATE_OF_HK, i.RATE_OF_MACAO, i.RATE_OF_TW], function (e) { return e == t }) }, isHK_MC: function (t) { return null != r.find([i.RATE_OF_HK, i.RATE_OF_MACAO], function (e) { return e == t }) }, isTW: function (e) { return e == i.RATE_OF_TW }, isMC: function (e) { return e == i.RATE_OF_MACAO }, isHK: function (e) { return e == i.RATE_OF_HK }, isInternational: function (e) { return new RegExp("[A-Za-z]+").test(e) }, toFixed: function (e, t) { var i = Math.pow(10, t), n = Math.round(e * i) / i; return parseFloat(n.toFixed(t)) }, getPayType: function (e) { return "1" == e ? "寄付现结" : "2" == e ? "到付" : "3" == e ? "第三方付" : "4" == e ? "寄付月结" : "5" == e ? "到付月结" : "" }, getLang: function () { var e = window.location.pathname; if (0 < e.indexOf("waybill")) return "th" == this.getSiteLanguage() || "vi" == this.getSiteLanguage() || "fr" == this.getSiteLanguage() || "de" == this.getSiteLanguage() ? "en" : this.getSiteLanguage(); if (0 < e.indexOf("rate")) return this.getSiteLanguage(); var t = "ko" == this.getSiteLanguage() || "ja" == this.getSiteLanguage() || "ru" == this.getSiteLanguage() || "vi" == this.getSiteLanguage() || "th" == this.getSiteLanguage() || "fr" == this.getSiteLanguage() || "de" == this.getSiteLanguage() ? "en" : this.getSiteLanguage(); return 0 < e.indexOf("accept") && "tc" == this.getSiteLanguage() ? "sc" : t }, isIE: function () { if (window.ActiveXObject || "ActiveXObject" in window) return !0 }, isLtOrEqIe10: function () { return -1 < window.navigator.userAgent.indexOf("MSIE") }, setHash: function (e) { location.hash === "#" + e ? location.reload() : location.hash = e }, isReceiver: function (e) { return 2 == e || 3 == e }, isSender: function (e) { return 1 == e || 3 == e }, isLogout: function (e) { return 0 == e }, isNotMyWaybill: function (e) { return 4 == e }, supportChangeDelivery: function (e, t) { return "SE0006" != e && "SE0021" != e && 0 != t }, isOnlyChangeToSF: function (e) { return "SP330" == e || "SP334" == e }, isAppleWaybill: function (e) { return "960" == e.toString().substr(0, 3) || "SF960" == e.toString().substr(0, 5) }, isHuaweiWaybill: function (e) { return "962" == e.toString().substr(0, 3) || "SF962" == e.toString().substr(0, 5) }, getFullAddress: function (e, t) { return this.isDirectCity(e) ? t.city + t.county + t.address : t.province + t.city + t.county + t.address }, getFlowCode: function (e, t) { return (this.isHK_MC_TW(t) ? "GAT_" : "ZH_") + (this.isHK_MC_TW(e) ? "GAT" : "ZH") }, getCurrencyByCode: function (e) { return e == i.RATE_OF_HK ? i.CUR_HK : e == i.RATE_OF_MACAO ? i.CUR_MACAO : e == i.RATE_OF_TW ? i.CUR_TW : i.CUR_CN }, getLatestSenderKey: function () { var e = this.getSiteLocation(); return "cn" === e ? i.LATEST_SENDER_ADDRESS_PREFIX : i.LATEST_SENDER_ADDRESS_PREFIX + e } } }), function (c) { var f, e, n = this, h = Math.round, m = 0, g = 1, _ = 2, v = 3, y = 4, o = 5, l = 6, d = {}, a = { _isAMomentObject: null, _i: null, _f: null, _l: null, _strict: null, _isUTC: null, _offset: null, _pf: null, _lang: null }, u = "undefined" != typeof module && module.exports && "undefined" != typeof require, r = /^\/?Date\((\-?\d+)/i, p = /(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/, b = /^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/, w = /(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g, s = /(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g, C = /\d\d?/, x = /\d{1,3}/, k = /\d{1,4}/, T = /[+\-]?\d{1,6}/, S = /\d+/, $ = /[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i, A = /Z|[\+\-]\d\d:?\d\d/gi, I = /T/i, D = /[\+\-]?\d+(\.\d{1,3})?/, P = /\d/, j = /\d\d/, L = /\d{3}/, M = /\d{4}/, R = /[+-]?\d{6}/, O = /[+-]?\d+/, E = /^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/, N = [["YYYYYY-MM-DD", /[+-]\d{6}-\d{2}-\d{2}/], ["YYYY-MM-DD", /\d{4}-\d{2}-\d{2}/], ["GGGG-[W]WW-E", /\d{4}-W\d{2}-\d/], ["GGGG-[W]WW", /\d{4}-W\d{2}/], ["YYYY-DDD", /\d{4}-\d{3}/]], B = [["HH:mm:ss.SSSS", /(T| )\d\d:\d\d:\d\d\.\d{1,3}/], ["HH:mm:ss", /(T| )\d\d:\d\d:\d\d/], ["HH:mm", /(T| )\d\d:\d\d/], ["HH", /(T| )\d\d/]], F = /([\+\-]|\d\d)/gi, t = "Date|Hours|Minutes|Seconds|Milliseconds".split("|"), i = { Milliseconds: 1, Seconds: 1e3, Minutes: 6e4, Hours: 36e5, Days: 864e5, Months: 2592e6, Years: 31536e6 }, q = { ms: "millisecond", s: "second", m: "minute", h: "hour", d: "day", D: "date", w: "week", W: "isoWeek", M: "month", y: "year", DDD: "dayOfYear", e: "weekday", E: "isoWeekday", gg: "weekYear", GG: "isoWeekYear" }, U = { dayofyear: "dayOfYear", isoweekday: "isoWeekday", isoweek: "isoWeek", weekyear: "weekYear", isoweekyear: "isoWeekYear" }, H = {}, W = "DDD w W M D d".split(" "), V = "M D H h m s w W".split(" "), z = { M: function () { return this.month() + 1 }, MMM: function (e) { return this.lang().monthsShort(this, e) }, MMMM: function (e) { return this.lang().months(this, e) }, D: function () { return this.date() }, DDD: function () { return this.dayOfYear() }, d: function () { return this.day() }, dd: function (e) { return this.lang().weekdaysMin(this, e) }, ddd: function (e) { return this.lang().weekdaysShort(this, e) }, dddd: function (e) { return this.lang().weekdays(this, e) }, w: function () { return this.week() }, W: function () { return this.isoWeek() }, YY: function () { return te(this.year() % 100, 2) }, YYYY: function () { return te(this.year(), 4) }, YYYYY: function () { return te(this.year(), 5) }, YYYYYY: function () { var e = this.year(); return (0 <= e ? "+" : "-") + te(Math.abs(e), 6) }, gg: function () { return te(this.weekYear() % 100, 2) }, gggg: function () { return te(this.weekYear(), 4) }, ggggg: function () { return te(this.weekYear(), 5) }, GG: function () { return te(this.isoWeekYear() % 100, 2) }, GGGG: function () { return te(this.isoWeekYear(), 4) }, GGGGG: function () { return te(this.isoWeekYear(), 5) }, e: function () { return this.weekday() }, E: function () { return this.isoWeekday() }, a: function () { return this.lang().meridiem(this.hours(), this.minutes(), !0) }, A: function () { return this.lang().meridiem(this.hours(), this.minutes(), !1) }, H: function () { return this.hours() }, h: function () { return this.hours() % 12 || 12 }, m: function () { return this.minutes() }, s: function () { return this.seconds() }, S: function () { return le(this.milliseconds() / 100) }, SS: function () { return te(le(this.milliseconds() / 10), 2) }, SSS: function () { return te(this.milliseconds(), 3) }, SSSS: function () { return te(this.milliseconds(), 3) }, Z: function () { var e = -this.zone(), t = "+"; return e < 0 && (e = -e, t = "-"), t + te(le(e / 60), 2) + ":" + te(le(e) % 60, 2) }, ZZ: function () { var e = -this.zone(), t = "+"; return e < 0 && (e = -e, t = "-"), t + te(le(e / 60), 2) + te(le(e) % 60, 2) }, z: function () { return this.zoneAbbr() }, zz: function () { return this.zoneName() }, X: function () { return this.unix() }, Q: function () { return this.quarter() } }, Y = ["months", "monthsShort", "weekdays", "weekdaysShort", "weekdaysMin"]; function G(t, i) { return function (e) { return te(t.call(this, e), i) } } function Q(t, i) { return function (e) { return this.lang().ordinal(t.call(this, e), i) } } for (; W.length;)e = W.pop(), z[e + "o"] = Q(z[e], e); for (; V.length;)e = V.pop(), z[e + e] = G(z[e], 2); function J() { } function K(e) { he(e), Z(this, e) } function X(e) { var t = re(e), i = t.year || 0, n = t.month || 0, a = t.week || 0, s = t.day || 0, r = t.hour || 0, o = t.minute || 0, l = t.second || 0, c = t.millisecond || 0; this._milliseconds = +c + 1e3 * l + 6e4 * o + 36e5 * r, this._days = +s + 7 * a, this._months = +n + 12 * i, this._data = {}, this._bubble() } function Z(e, t) { for (var i in t) t.hasOwnProperty(i) && (e[i] = t[i]); return t.hasOwnProperty("toString") && (e.toString = t.toString), t.hasOwnProperty("valueOf") && (e.valueOf = t.valueOf), e } function ee(e) { return e < 0 ? Math.ceil(e) : Math.floor(e) } function te(e, t, i) { for (var n = "" + Math.abs(e), a = 0 <= e; n.length < t;)n = "0" + n; return (a ? i ? "+" : "" : "-") + n } function ie(e, t, i, n) { var a, s, r = t._milliseconds, o = t._days, l = t._months; r && e._d.setTime(+e._d + r * i), (o || l) && (a = e.minute(), s = e.hour()), o && e.date(e.date() + o * i), l && e.month(e.month() + l * i), r && !n && f.updateOffset(e), (o || l) && (e.minute(a), e.hour(s)) } function ne(e) { return "[object Array]" === Object.prototype.toString.call(e) } function ae(e, t, i) { var n, a = Math.min(e.length, t.length), s = Math.abs(e.length - t.length), r = 0; for (n = 0; n < a; n++)(i && e[n] !== t[n] || !i && le(e[n]) !== le(t[n])) && r++; return r + s } function se(e) { if (e) { var t = e.toLowerCase().replace(/(.)s$/, "$1"); e = q[e] || U[t] || t } return e } function re(e) { var t, i, n = {}; for (i in e) e.hasOwnProperty(i) && (t = se(i)) && (n[t] = e[i]); return n } function oe(r) { var o, l; if (0 === r.indexOf("week")) o = 7, l = "day"; else { if (0 !== r.indexOf("month")) return; o = 12, l = "month" } f[r] = function (i, e) { var t, n, a = f.fn._lang[r], s = []; if ("number" == typeof i && (e = i, i = c), n = function (e) { var t = f().utc().set(l, e); return a.call(f.fn._lang, t, i || "") }, null != e) return n(e); for (t = 0; t < o; t++)s.push(n(t)); return s } } function le(e) { var t = +e, i = 0; return 0 !== t && isFinite(t) && (i = 0 <= t ? Math.floor(t) : Math.ceil(t)), i } function ce(e, t) { return new Date(Date.UTC(e, t + 1, 0)).getUTCDate() } function de(e) { return ue(e) ? 366 : 365 } function ue(e) { return e % 4 == 0 && e % 100 != 0 || e % 400 == 0 } function he(e) { var t; e._a && -2 === e._pf.overflow && (t = e._a[g] < 0 || 11 < e._a[g] ? g : e._a[_] < 1 || e._a[_] > ce(e._a[m], e._a[g]) ? _ : e._a[v] < 0 || 23 < e._a[v] ? v : e._a[y] < 0 || 59 < e._a[y] ? y : e._a[o] < 0 || 59 < e._a[o] ? o : e._a[l] < 0 || 999 < e._a[l] ? l : -1, e._pf._overflowDayOfYear && (t < m || _ < t) && (t = _), e._pf.overflow = t) } function pe(e) { return null == e._isValid && (e._isValid = !isNaN(e._d.getTime()) && e._pf.overflow < 0 && !e._pf.empty && !e._pf.invalidMonth && !e._pf.nullInput && !e._pf.invalidFormat && !e._pf.userInvalidated, e._strict && (e._isValid = e._isValid && 0 === e._pf.charsLeftOver && 0 === e._pf.unusedTokens.length)), e._isValid } function fe(e) { return e ? e.toLowerCase().replace("_", "-") : e } function me(e, t) { return t._isUTC ? f(e).zone(t._offset || 0) : f(e).local() } function ge(e) { var t, i, n, a, s = 0, r = function (e) { if (!d[e] && u) try { require("./lang/" + e) } catch (e) { } return d[e] }; if (!e) return f.fn._lang; if (!ne(e)) { if (i = r(e)) return i; e = [e] } for (; s < e.length;) { for (t = (a = fe(e[s]).split("-")).length, n = (n = fe(e[s + 1])) ? n.split("-") : null; 0 < t;) { if (i = r(a.slice(0, t).join("-"))) return i; if (n && n.length >= t && ae(a, n, !0) >= t - 1) break; t-- } s++ } return f.fn._lang } function _e(e, t) { return e.isValid() ? (t = ve(t, e.lang()), H[t] || (H[t] = function (i) { var n, a, e, s = i.match(w); for (n = 0, a = s.length; n < a; n++)z[s[n]] ? s[n] = z[s[n]] : s[n] = (e = s[n]).match(/\[[\s\S]/) ? e.replace(/^\[|\]$/g, "") : e.replace(/\\/g, ""); return function (e) { var t = ""; for (n = 0; n < a; n++)t += s[n] instanceof Function ? s[n].call(e, i) : s[n]; return t } }(t)), H[t](e)) : e.lang().invalidDate() } function ve(e, t) { var i = 5; function n(e) { return t.longDateFormat(e) || e } for (s.lastIndex = 0; 0 <= i && s.test(e);)e = e.replace(s, n), s.lastIndex = 0, i -= 1; return e } function ye(e, t) { var i, n = t._strict; switch (e) { case "DDDD": return L; case "YYYY": case "GGGG": case "gggg": return n ? M : k; case "Y": case "G": case "g": return O; case "YYYYYY": case "YYYYY": case "GGGGG": case "ggggg": return n ? R : T; case "S": if (n) return P; case "SS": if (n) return j; case "SSS": if (n) return L; case "DDD": return x; case "MMM": case "MMMM": case "dd": case "ddd": case "dddd": return $; case "a": case "A": return ge(t._l)._meridiemParse; case "X": return D; case "Z": case "ZZ": return A; case "T": return I; case "SSSS": return S; case "MM": case "DD": case "YY": case "GG": case "gg": case "HH": case "hh": case "mm": case "ss": case "ww": case "WW": return n ? j : C; case "M": case "D": case "d": case "H": case "h": case "m": case "s": case "w": case "W": case "e": case "E": return C; default: return new RegExp((i = e.replace("\\", ""), i.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g, function (e, t, i, n, a) { return t || i || n || a }).replace(/[-\/\\^$*+?.()|[\]{}]/g, "\\$&"))) } } function be(e) { var t = (e = e || "").match(A) || [], i = ((t[t.length - 1] || []) + "").match(F) || ["-", 0, 0], n = 60 * i[1] + le(i[2]); return "+" === i[0] ? -n : n } function we(e, t, i) { var n, a = i._a; switch (e) { case "M": case "MM": null != t && (a[g] = le(t) - 1); break; case "MMM": case "MMMM": null != (n = ge(i._l).monthsParse(t)) ? a[g] = n : i._pf.invalidMonth = t; break; case "D": case "DD": null != t && (a[_] = le(t)); break; case "DDD": case "DDDD": null != t && (i._dayOfYear = le(t)); break; case "YY": a[m] = le(t) + (68 < le(t) ? 1900 : 2e3); break; case "YYYY": case "YYYYY": case "YYYYYY": a[m] = le(t); break; case "a": case "A": i._isPm = ge(i._l).isPM(t); break; case "H": case "HH": case "h": case "hh": a[v] = le(t); break; case "m": case "mm": a[y] = le(t); break; case "s": case "ss": a[o] = le(t); break; case "S": case "SS": case "SSS": case "SSSS": a[l] = le(1e3 * ("0." + t)); break; case "X": i._d = new Date(1e3 * parseFloat(t)); break; case "Z": case "ZZ": i._useUTC = !0, i._tzm = be(t); break; case "w": case "ww": case "W": case "WW": case "d": case "dd": case "ddd": case "dddd": case "e": case "E": e = e.substr(0, 1); case "gg": case "gggg": case "GG": case "GGGG": case "GGGGG": e = e.substr(0, 2), t && (i._w = i._w || {}, i._w[e] = t) } } function Ce(i) { var e, t, n, a, s, r, o, l, c, d, u = []; if (!i._d) { var h, p; for (h = i, p = new Date, n = h._useUTC ? [p.getUTCFullYear(), p.getUTCMonth(), p.getUTCDate()] : [p.getFullYear(), p.getMonth(), p.getDate()], i._w && null == i._a[_] && null == i._a[g] && (s = function (e) { var t = parseInt(e, 10); return e ? e.length < 3 ? 68 < t ? 1900 + t : 2e3 + t : t : null == i._a[m] ? f().weekYear() : i._a[m] }, null != (r = i._w).GG || null != r.W || null != r.E ? o = Ae(s(r.GG), r.W || 1, r.E, 4, 1) : (l = ge(i._l), c = null != r.d ? Se(r.d, l) : null != r.e ? parseInt(r.e, 10) + l._week.dow : 0, d = parseInt(r.w, 10) || 1, null != r.d && c < l._week.dow && d++ , o = Ae(s(r.gg), d, c, l._week.doy, l._week.dow)), i._a[m] = o.year, i._dayOfYear = o.dayOfYear), i._dayOfYear && (a = null == i._a[m] ? n[m] : i._a[m], i._dayOfYear > de(a) && (i._pf._overflowDayOfYear = !0), t = Te(a, 0, i._dayOfYear), i._a[g] = t.getUTCMonth(), i._a[_] = t.getUTCDate()), e = 0; e < 3 && null == i._a[e]; ++e)i._a[e] = u[e] = n[e]; for (; e < 7; e++)i._a[e] = u[e] = null == i._a[e] ? 2 === e ? 1 : 0 : i._a[e]; u[v] += le((i._tzm || 0) / 60), u[y] += le((i._tzm || 0) % 60), i._d = (i._useUTC ? Te : function (e, t, i, n, a, s, r) { var o = new Date(e, t, i, n, a, s, r); e < 1970 && o.setFullYear(e); return o }).apply(null, u) } } function xe(e) { e._a = [], e._pf.empty = !0; var t, i, n, a, s, r = ge(e._l), o = "" + e._i, l = o.length, c = 0; for (n = ve(e._f, r).match(w) || [], t = 0; t < n.length; t++)a = n[t], (i = (o.match(ye(a, e)) || [])[0]) && (0 < (s = o.substr(0, o.indexOf(i))).length && e._pf.unusedInput.push(s), o = o.slice(o.indexOf(i) + i.length), c += i.length), z[a] ? (i ? e._pf.empty = !1 : e._pf.unusedTokens.push(a), we(a, i, e)) : e._strict && !i && e._pf.unusedTokens.push(a); e._pf.charsLeftOver = l - c, 0 < o.length && e._pf.unusedInput.push(o), e._isPm && e._a[v] < 12 && (e._a[v] += 12), !1 === e._isPm && 12 === e._a[v] && (e._a[v] = 0), Ce(e), he(e) } function ke(e) { var t, i, n, a = e._i, s = r.exec(a); a === c ? e._d = new Date : s ? e._d = new Date(+s[1]) : "string" == typeof a ? function (e) { var t, i, n = e._i, a = E.exec(n); if (a) { for (e._pf.iso = !0, t = 0, i = N.length; t < i; t++)if (N[t][1].exec(n)) { e._f = N[t][0] + (a[6] || " "); break } for (t = 0, i = B.length; t < i; t++)if (B[t][1].exec(n)) { e._f += B[t][0]; break } n.match(A) && (e._f += "Z"), xe(e) } else e._d = new Date(n) }(e) : ne(a) ? (e._a = a.slice(0), Ce(e)) : (n = a, "[object Date]" === Object.prototype.toString.call(n) || n instanceof Date ? e._d = new Date(+a) : "object" == typeof a ? (t = e)._d || (i = re(t._i), t._a = [i.year, i.month, i.day, i.hour, i.minute, i.second, i.millisecond], Ce(t)) : e._d = new Date(a)) } function Te(e) { var t = new Date(Date.UTC.apply(null, arguments)); return e < 1970 && t.setUTCFullYear(e), t } function Se(e, t) { if ("string" == typeof e) if (isNaN(e)) { if ("number" != typeof (e = t.weekdaysParse(e))) return null } else e = parseInt(e, 10); return e } function $e(e, t, i) { var n, a = i - t, s = i - e.day(); return a < s && (s -= 7), s < a - 7 && (s += 7), n = f(e).add("d", s), { week: Math.ceil(n.dayOfYear() / 7), year: n.year() } } function Ae(e, t, i, n, a) { var s, r = Te(e, 0, 1).getUTCDay(); return { year: 0 < (s = 7 * (t - 1) + ((i = null != i ? i : a) - a) + (a - r + (n < r ? 7 : 0) - (r < a ? 7 : 0)) + 1) ? e : e - 1, dayOfYear: 0 < s ? s : de(e - 1) + s } } function Ie(e) { var t = e._i, i = e._f; return null === t ? f.invalid({ nullInput: !0 }) : ("string" == typeof t && (e._i = t = ge().preparse(t)), f.isMoment(t) ? (e = function (e) { var t, i = {}; for (t in e) e.hasOwnProperty(t) && a.hasOwnProperty(t) && (i[t] = e[t]); return i }(t))._d = new Date(+t._d) : i ? ne(i) ? function (e) { var t, i, n, a, s; if (0 === e._f.length) return e._pf.invalidFormat = !0, e._d = new Date(NaN); for (a = 0; a < e._f.length; a++)s = 0, (t = Z({}, e))._pf = { empty: !1, unusedTokens: [], unusedInput: [], overflow: -2, charsLeftOver: 0, nullInput: !1, invalidMonth: null, invalidFormat: !1, userInvalidated: !1, iso: !1 }, t._f = e._f[a], xe(t), pe(t) && (s += t._pf.charsLeftOver, s += 10 * t._pf.unusedTokens.length, t._pf.score = s, (null == n || s < n) && (n = s, i = t)); Z(e, i || t) }(e) : xe(e) : ke(e), new K(e)) } for (z.DDDD = G(z.DDD, 3), Z(J.prototype, { set: function (e) { var t, i; for (i in e) "function" == typeof (t = e[i]) ? this[i] = t : this["_" + i] = t }, _months: "January_February_March_April_May_June_July_August_September_October_November_December".split("_"), months: function (e) { return this._months[e.month()] }, _monthsShort: "Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"), monthsShort: function (e) { return this._monthsShort[e.month()] }, monthsParse: function (e) { var t, i, n; for (this._monthsParse || (this._monthsParse = []), t = 0; t < 12; t++)if (this._monthsParse[t] || (i = f.utc([2e3, t]), n = "^" + this.months(i, "") + "|^" + this.monthsShort(i, ""), this._monthsParse[t] = new RegExp(n.replace(".", ""), "i")), this._monthsParse[t].test(e)) return t }, _weekdays: "Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"), weekdays: function (e) { return this._weekdays[e.day()] }, _weekdaysShort: "Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"), weekdaysShort: function (e) { return this._weekdaysShort[e.day()] }, _weekdaysMin: "Su_Mo_Tu_We_Th_Fr_Sa".split("_"), weekdaysMin: function (e) { return this._weekdaysMin[e.day()] }, weekdaysParse: function (e) { var t, i, n; for (this._weekdaysParse || (this._weekdaysParse = []), t = 0; t < 7; t++)if (this._weekdaysParse[t] || (i = f([2e3, 1]).day(t), n = "^" + this.weekdays(i, "") + "|^" + this.weekdaysShort(i, "") + "|^" + this.weekdaysMin(i, ""), this._weekdaysParse[t] = new RegExp(n.replace(".", ""), "i")), this._weekdaysParse[t].test(e)) return t }, _longDateFormat: { LT: "h:mm A", L: "MM/DD/YYYY", LL: "MMMM D YYYY", LLL: "MMMM D YYYY LT", LLLL: "dddd, MMMM D YYYY LT" }, longDateFormat: function (e) { var t = this._longDateFormat[e]; return !t && this._longDateFormat[e.toUpperCase()] && (t = this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g, function (e) { return e.slice(1) }), this._longDateFormat[e] = t), t }, isPM: function (e) { return "p" === (e + "").toLowerCase().charAt(0) }, _meridiemParse: /[ap]\.?m?\.?/i, meridiem: function (e, t, i) { return 11 < e ? i ? "pm" : "PM" : i ? "am" : "AM" }, _calendar: { sameDay: "[Today at] LT", nextDay: "[Tomorrow at] LT", nextWeek: "dddd [at] LT", lastDay: "[Yesterday at] LT", lastWeek: "[Last] dddd [at] LT", sameElse: "L" }, calendar: function (e, t) { var i = this._calendar[e]; return "function" == typeof i ? i.apply(t) : i }, _relativeTime: { future: "in %s", past: "%s ago", s: "a few seconds", m: "a minute", mm: "%d minutes", h: "an hour", hh: "%d hours", d: "a day", dd: "%d days", M: "a month", MM: "%d months", y: "a year", yy: "%d years" }, relativeTime: function (e, t, i, n) { var a = this._relativeTime[i]; return "function" == typeof a ? a(e, t, i, n) : a.replace(/%d/i, e) }, pastFuture: function (e, t) { var i = this._relativeTime[0 < e ? "future" : "past"]; return "function" == typeof i ? i(t) : i.replace(/%s/i, t) }, ordinal: function (e) { return this._ordinal.replace("%d", e) }, _ordinal: "%d", preparse: function (e) { return e }, postformat: function (e) { return e }, week: function (e) { return $e(e, this._week.dow, this._week.doy).week }, _week: { dow: 0, doy: 6 }, _invalidDate: "Invalid date", invalidDate: function () { return this._invalidDate } }), (f = function (e, t, i, n) { var a; return "boolean" == typeof i && (n = i, i = c), (a = { _isAMomentObject: !0 })._i = e, a._f = t, a._l = i, a._strict = n, a._isUTC = !1, a._pf = { empty: !1, unusedTokens: [], unusedInput: [], overflow: -2, charsLeftOver: 0, nullInput: !1, invalidMonth: null, invalidFormat: !1, userInvalidated: !1, iso: !1 }, Ie(a) }).utc = function (e, t, i, n) { var a; return "boolean" == typeof i && (n = i, i = c), (a = { _isAMomentObject: !0, _useUTC: !0, _isUTC: !0 })._l = i, a._i = e, a._f = t, a._strict = n, a._pf = { empty: !1, unusedTokens: [], unusedInput: [], overflow: -2, charsLeftOver: 0, nullInput: !1, invalidMonth: null, invalidFormat: !1, userInvalidated: !1, iso: !1 }, Ie(a).utc() }, f.unix = function (e) { return f(1e3 * e) }, f.duration = function (e, t) { var i, n, a, s = e, r = null; return f.isDuration(e) ? s = { ms: e._milliseconds, d: e._days, M: e._months } : "number" == typeof e ? (s = {}, t ? s[t] = e : s.milliseconds = e) : (r = p.exec(e)) ? (i = "-" === r[1] ? -1 : 1, s = { y: 0, d: le(r[_]) * i, h: le(r[v]) * i, m: le(r[y]) * i, s: le(r[o]) * i, ms: le(r[l]) * i }) : (r = b.exec(e)) && (i = "-" === r[1] ? -1 : 1, s = { y: (a = function (e) { var t = e && parseFloat(e.replace(",", ".")); return (isNaN(t) ? 0 : t) * i })(r[2]), M: a(r[3]), d: a(r[4]), h: a(r[5]), m: a(r[6]), s: a(r[7]), w: a(r[8]) }), n = new X(s), f.isDuration(e) && e.hasOwnProperty("_lang") && (n._lang = e._lang), n }, f.version = "2.5.1", f.defaultFormat = "YYYY-MM-DDTHH:mm:ssZ", f.updateOffset = function () { }, f.lang = function (e, t) { var i, n; return e ? (t ? (i = fe(e), (n = t).abbr = i, d[i] || (d[i] = new J), d[i].set(n), d[i]) : null === t ? (delete d[e], e = "en") : d[e] || ge(e), (f.duration.fn._lang = f.fn._lang = ge(e))._abbr) : f.fn._lang._abbr }, f.langData = function (e) { return e && e._lang && e._lang._abbr && (e = e._lang._abbr), ge(e) }, f.isMoment = function (e) { return e instanceof K || null != e && e.hasOwnProperty("_isAMomentObject") }, f.isDuration = function (e) { return e instanceof X }, e = Y.length - 1; 0 <= e; --e)oe(Y[e]); function De(e, i) { f.fn[e] = f.fn[e + "s"] = function (e) { var t = this._isUTC ? "UTC" : ""; return null != e ? (this._d["set" + t + i](e), f.updateOffset(this), this) : this._d["get" + t + i]() } } for (f.normalizeUnits = function (e) { return se(e) }, f.invalid = function (e) { var t = f.utc(NaN); return null != e ? Z(t._pf, e) : t._pf.userInvalidated = !0, t }, f.parseZone = function (e) { return f(e).parseZone() }, Z(f.fn = K.prototype, { clone: function () { return f(this) }, valueOf: function () { return +this._d + 6e4 * (this._offset || 0) }, unix: function () { return Math.floor(+this / 1e3) }, toString: function () { return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ") }, toDate: function () { return this._offset ? new Date(+this) : this._d }, toISOString: function () { var e = f(this).utc(); return 0 < e.year() && e.year() <= 9999 ? _e(e, "YYYY-MM-DD[T]HH:mm:ss.SSS[Z]") : _e(e, "YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]") }, toArray: function () { var e = this; return [e.year(), e.month(), e.date(), e.hours(), e.minutes(), e.seconds(), e.milliseconds()] }, isValid: function () { return pe(this) }, isDSTShifted: function () { return !!this._a && (this.isValid() && 0 < ae(this._a, (this._isUTC ? f.utc(this._a) : f(this._a)).toArray())) }, parsingFlags: function () { return Z({}, this._pf) }, invalidAt: function () { return this._pf.overflow }, utc: function () { return this.zone(0) }, local: function () { return this.zone(0), this._isUTC = !1, this }, format: function (e) { var t = _e(this, e || f.defaultFormat); return this.lang().postformat(t) }, add: function (e, t) { return ie(this, "string" == typeof e ? f.duration(+t, e) : f.duration(e, t), 1), this }, subtract: function (e, t) { return ie(this, "string" == typeof e ? f.duration(+t, e) : f.duration(e, t), -1), this }, diff: function (e, t, i) { var n, a, s = me(e, this), r = 6e4 * (this.zone() - s.zone()); return "year" === (t = se(t)) || "month" === t ? (n = 432e5 * (this.daysInMonth() + s.daysInMonth()), a = 12 * (this.year() - s.year()) + (this.month() - s.month()), a += (this - f(this).startOf("month") - (s - f(s).startOf("month"))) / n, a -= 6e4 * (this.zone() - f(this).startOf("month").zone() - (s.zone() - f(s).startOf("month").zone())) / n, "year" === t && (a /= 12)) : (n = this - s, a = "second" === t ? n / 1e3 : "minute" === t ? n / 6e4 : "hour" === t ? n / 36e5 : "day" === t ? (n - r) / 864e5 : "week" === t ? (n - r) / 6048e5 : n), i ? a : ee(a) }, from: function (e, t) { return f.duration(this.diff(e)).lang(this.lang()._abbr).humanize(!t) }, fromNow: function (e) { return this.from(f(), e) }, calendar: function () { var e = me(f(), this).startOf("day"), t = this.diff(e, "days", !0), i = t < -6 ? "sameElse" : t < -1 ? "lastWeek" : t < 0 ? "lastDay" : t < 1 ? "sameDay" : t < 2 ? "nextDay" : t < 7 ? "nextWeek" : "sameElse"; return this.format(this.lang().calendar(i, this)) }, isLeapYear: function () { return ue(this.year()) }, isDST: function () { return this.zone() < this.clone().month(0).zone() || this.zone() < this.clone().month(5).zone() }, day: function (e) { var t = this._isUTC ? this._d.getUTCDay() : this._d.getDay(); return null != e ? (e = Se(e, this.lang()), this.add({ d: e - t })) : t }, month: function (e) { var t, i = this._isUTC ? "UTC" : ""; return null != e ? ("string" == typeof e && "number" != typeof (e = this.lang().monthsParse(e)) || (t = this.date(), this.date(1), this._d["set" + i + "Month"](e), this.date(Math.min(t, this.daysInMonth())), f.updateOffset(this)), this) : this._d["get" + i + "Month"]() }, startOf: function (e) { switch (e = se(e)) { case "year": this.month(0); case "month": this.date(1); case "week": case "isoWeek": case "day": this.hours(0); case "hour": this.minutes(0); case "minute": this.seconds(0); case "second": this.milliseconds(0) }return "week" === e ? this.weekday(0) : "isoWeek" === e && this.isoWeekday(1), this }, endOf: function (e) { return e = se(e), this.startOf(e).add("isoWeek" === e ? "week" : e, 1).subtract("ms", 1) }, isAfter: function (e, t) { return t = void 0 !== t ? t : "millisecond", +this.clone().startOf(t) > +f(e).startOf(t) }, isBefore: function (e, t) { return t = void 0 !== t ? t : "millisecond", +this.clone().startOf(t) < +f(e).startOf(t) }, isSame: function (e, t) { return t = t || "ms", +this.clone().startOf(t) == +me(e, this).startOf(t) }, min: function (e) { return (e = f.apply(null, arguments)) < this ? this : e }, max: function (e) { return this < (e = f.apply(null, arguments)) ? this : e }, zone: function (e) { var t = this._offset || 0; return null == e ? this._isUTC ? t : this._d.getTimezoneOffset() : ("string" == typeof e && (e = be(e)), Math.abs(e) < 16 && (e *= 60), this._offset = e, this._isUTC = !0, t !== e && ie(this, f.duration(t - e, "m"), 1, !0), this) }, zoneAbbr: function () { return this._isUTC ? "UTC" : "" }, zoneName: function () { return this._isUTC ? "Coordinated Universal Time" : "" }, parseZone: function () { return this._tzm ? this.zone(this._tzm) : "string" == typeof this._i && this.zone(this._i), this }, hasAlignedHourOffset: function (e) { return e = e ? f(e).zone() : 0, (this.zone() - e) % 60 == 0 }, daysInMonth: function () { return ce(this.year(), this.month()) }, dayOfYear: function (e) { var t = h((f(this).startOf("day") - f(this).startOf("year")) / 864e5) + 1; return null == e ? t : this.add("d", e - t) }, quarter: function () { return Math.ceil((this.month() + 1) / 3) }, weekYear: function (e) { var t = $e(this, this.lang()._week.dow, this.lang()._week.doy).year; return null == e ? t : this.add("y", e - t) }, isoWeekYear: function (e) { var t = $e(this, 1, 4).year; return null == e ? t : this.add("y", e - t) }, week: function (e) { var t = this.lang().week(this); return null == e ? t : this.add("d", 7 * (e - t)) }, isoWeek: function (e) { var t = $e(this, 1, 4).week; return null == e ? t : this.add("d", 7 * (e - t)) }, weekday: function (e) { var t = (this.day() + 7 - this.lang()._week.dow) % 7; return null == e ? t : this.add("d", e - t) }, isoWeekday: function (e) { return null == e ? this.day() || 7 : this.day(this.day() % 7 ? e : e - 7) }, get: function (e) { return this[e = se(e)]() }, set: function (e, t) { return "function" == typeof this[e = se(e)] && this[e](t), this }, lang: function (e) { return e === c ? this._lang : (this._lang = ge(e), this) } }), e = 0; e < t.length; e++)De(t[e].toLowerCase().replace(/s$/, ""), t[e]); function Pe(e) { f.duration.fn[e] = function () { return this._data[e] } } function je(e, t) { f.duration.fn["as" + e] = function () { return +this / t } } for (e in De("year", "FullYear"), f.fn.days = f.fn.day, f.fn.months = f.fn.month, f.fn.weeks = f.fn.week, f.fn.isoWeeks = f.fn.isoWeek, f.fn.toJSON = f.fn.toISOString, Z(f.duration.fn = X.prototype, { _bubble: function () { var e, t, i, n, a = this._milliseconds, s = this._days, r = this._months, o = this._data; o.milliseconds = a % 1e3, e = ee(a / 1e3), o.seconds = e % 60, t = ee(e / 60), o.minutes = t % 60, i = ee(t / 60), o.hours = i % 24, s += ee(i / 24), o.days = s % 30, r += ee(s / 30), o.months = r % 12, n = ee(r / 12), o.years = n }, weeks: function () { return ee(this.days() / 7) }, valueOf: function () { return this._milliseconds + 864e5 * this._days + this._months % 12 * 2592e6 + 31536e6 * le(this._months / 12) }, humanize: function (e) { var t, i, n, a, s, r, o, l, c, d = +this, u = (t = d, i = !e, n = this.lang(), a = h(Math.abs(t) / 1e3), s = h(a / 60), r = h(s / 60), o = h(r / 24), l = h(o / 365), (c = a < 45 && ["s", a] || 1 === s && ["m"] || s < 45 && ["mm", s] || 1 === r && ["h"] || r < 22 && ["hh", r] || 1 === o && ["d"] || o <= 25 && ["dd", o] || o <= 45 && ["M"] || o < 345 && ["MM", h(o / 30)] || 1 === l && ["y"] || ["yy", l])[2] = i, c[3] = 0 < t, c[4] = n, function (e, t, i, n, a) { return a.relativeTime(t || 1, !!i, e, n) }.apply({}, c)); return e && (u = this.lang().pastFuture(d, u)), this.lang().postformat(u) }, add: function (e, t) { var i = f.duration(e, t); return this._milliseconds += i._milliseconds, this._days += i._days, this._months += i._months, this._bubble(), this }, subtract: function (e, t) { var i = f.duration(e, t); return this._milliseconds -= i._milliseconds, this._days -= i._days, this._months -= i._months, this._bubble(), this }, get: function (e) { return this[(e = se(e)).toLowerCase() + "s"]() }, as: function (e) { return this["as" + (e = se(e)).charAt(0).toUpperCase() + e.slice(1) + "s"]() }, lang: f.fn.lang, toIsoString: function () { var e = Math.abs(this.years()), t = Math.abs(this.months()), i = Math.abs(this.days()), n = Math.abs(this.hours()), a = Math.abs(this.minutes()), s = Math.abs(this.seconds() + this.milliseconds() / 1e3); return this.asSeconds() ? (this.asSeconds() < 0 ? "-" : "") + "P" + (e ? e + "Y" : "") + (t ? t + "M" : "") + (i ? i + "D" : "") + (n || a || s ? "T" : "") + (n ? n + "H" : "") + (a ? a + "M" : "") + (s ? s + "S" : "") : "P0D" } }), i) i.hasOwnProperty(e) && (je(e, i[e]), Pe(e.toLowerCase())); function Le(e) { var t = !1, i = f; "undefined" == typeof ender && (e ? (n.moment = function () { return !t && console && console.warn && (t = !0), i.apply(null, arguments) }, Z(n.moment, i)) : n.moment = f) } je("Weeks", 6048e5), f.duration.fn.asMonths = function () { return (+this - 31536e6 * this.years()) / 2592e6 + 12 * this.years() }, f.lang("en", { ordinal: function (e) { var t = e % 10; return e + (1 === le(e % 100 / 10) ? "th" : 1 === t ? "st" : 2 === t ? "nd" : 3 === t ? "rd" : "th") } }), u ? (module.exports = f, Le(!0)) : "function" == typeof define && define.amd ? define("moment", ["require", "exports", "module"], function (e, t, i) { return i.config && i.config() && !0 !== i.config().noGlobal && Le(i.config().noGlobal === c), f }) : Le() }.call(this), function (e, t, o) { var i, n, a = "[object OperaMini]" == Object.prototype.toString.call(e.operamini), s = "placeholder" in t.createElement("input") && !a, r = "placeholder" in t.createElement("textarea") && !a, l = o.fn, c = o.valHooks, d = o.propHooks; function u(e, t) { var i = this, n = o(i); if (i.value == n.attr("placeholder") && n.hasClass("placeholder")) if (n.data("placeholder-password")) { if (n = n.hide().next().show().attr("id", n.removeAttr("id").data("placeholder-id")), !0 === e) return n[0].value = t; n.focus() } else i.value = "", n.removeClass("placeholder"), i == p() && i.select() } function h() { var t, i, n, a, e = this, s = o(e), r = this.id; if (e.value = e.value || "", "" == e.value) { if ("password" == e.type) { if (!s.data("placeholder-textinput")) { try { t = s.clone().attr({ type: "text" }) } catch (e) { t = o("<input>").attr(o.extend((i = this, n = {}, a = /^jQuery\d+$/, o.each(i.attributes, function (e, t) { t.specified && !a.test(t.name) && (n[t.name] = t.value) }), n), { type: "text" })) } t.removeAttr("name").data({ "placeholder-password": s, "placeholder-id": r }).bind("focus.placeholder", u), s.data({ "placeholder-textinput": t, "placeholder-id": r }).before(t) } s = s.removeAttr("id").hide().prev().attr("id", r).show() } s.addClass("placeholder"), s[0] && (s[0].value = s.attr("placeholder")) } else /\d+-tokenfield$/.test(r) || s.attr("placeholder") == e.value || s.removeClass("placeholder") } function p() { try { return t.activeElement } catch (e) { } } s && r ? (n = l.placeholder = function () { return this }).input = n.textarea = !0 : ((n = l.placeholder = function () { return this.filter((s ? "textarea" : ":input") + "[placeholder]").not(".placeholder").bind({ "focus.placeholder": u, "blur.placeholder": h }).data("placeholder-enabled", !0).trigger("blur.placeholder"), h.call(this), this }).input = s, n.textarea = r, i = { get: function (e) { var t = o(e), i = t.data("placeholder-password"); return i ? i[0].value : t.data("placeholder-enabled") && t.hasClass("placeholder") ? "" : e.value }, set: function (e, t) { var i = o(e), n = i.data("placeholder-password"); return n ? n[0].value = t : i.data("placeholder-enabled") ? ("" == t ? (e.value = t, e != p() && h.call(e)) : i.hasClass("placeholder") && u.call(e, !0, t) || (e.value = t), i) : e.value = t } }, s || (c.input = i, d.value = i), r || (c.textarea = i, d.value = i), o(function () { o(t).delegate("form", "submit.placeholder", function () { var e = o(".placeholder", this).each(u); setTimeout(function () { e.each(h) }, 10) }) }), o(e).bind("beforeunload.placeholder", function () { o(".placeholder").each(function () { this.value = "" }) })) }(this, document, jQuery), define("jquery-placeholder", function () { }), function (e) { "function" == typeof define && define.amd ? define("momenttc", ["moment"], e) : "object" == typeof exports ? module.exports = e(require("../moment")) : e(window.moment) }(function (e) { return e.lang("zh-tw", { months: "一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"), monthsShort: "1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"), weekdays: "星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"), weekdaysShort: "週日_週一_週二_週三_週四_週五_週六".split("_"), weekdaysMin: "日_一_二_三_四_五_六".split("_"), longDateFormat: { LT: "Ah點mm", L: "YYYY年MMMD日", LL: "YYYY年MMMD日", LLL: "YYYY年MMMD日LT", LLLL: "YYYY年MMMD日ddddLT", l: "YYYY年MMMD日", ll: "YYYY年MMMD日", lll: "YYYY年MMMD日LT", llll: "YYYY年MMMD日ddddLT" }, meridiem: function (e, t, i) { var n = 100 * e + t; return n < 900 ? "早上" : n < 1130 ? "上午" : n < 1230 ? "中午" : n < 1800 ? "下午" : "晚上" }, calendar: { sameDay: "[今天]LT", nextDay: "[明天]LT", nextWeek: "[下]ddddLT", lastDay: "[昨天]LT", lastWeek: "[上]ddddLT", sameElse: "L" }, ordinal: function (e, t) { switch (t) { case "d": case "D": case "DDD": return e + "日"; case "M": return e + "月"; case "w": case "W": return e + "週"; default: return e } }, relativeTime: { future: "%s內", past: "%s前", s: "幾秒", m: "一分鐘", mm: "%d分鐘", h: "一小時", hh: "%d小時", d: "一天", dd: "%d天", M: "一個月", MM: "%d個月", y: "一年", yy: "%d年" } }) }), function (e) { "function" == typeof define && define.amd ? define("momentko", ["moment"], e) : "object" == typeof exports ? module.exports = e(require("../moment")) : e(window.moment) }(function (e) { return e.lang("ko", { months: "1월_2월_3월_4월_5월_6월_7월_8월_9월_10월_11월_12월".split("_"), monthsShort: "1월_2월_3월_4월_5월_6월_7월_8월_9월_10월_11월_12월".split("_"), weekdays: "일요일_월요일_화요일_수요일_목요일_금요일_토요일".split("_"), weekdaysShort: "일_월_화_수_목_금_토".split("_"), weekdaysMin: "일_월_화_수_목_금_토".split("_"), longDateFormat: { LT: "A h시 mm분", L: "YYYY.MM.DD", LL: "YYYY년 MMMM D일", LLL: "YYYY년 MMMM D일 LT", LLLL: "YYYY년 MMMM D일 dddd LT" }, meridiem: function (e, t, i) { return e < 12 ? "오전" : "오후" }, calendar: { sameDay: "오늘 LT", nextDay: "내일 LT", nextWeek: "dddd LT", lastDay: "어제 LT", lastWeek: "지난주 dddd LT", sameElse: "L" }, relativeTime: { future: "%s 후", past: "%s 전", s: "몇초", ss: "%d초", m: "일분", mm: "%d분", h: "한시간", hh: "%d시간", d: "하루", dd: "%d일", M: "한달", MM: "%d달", y: "일년", yy: "%d년" }, ordinal: "%d일", meridiemParse: /(오전|오후)/, isPM: function (e) { return "오후" === e } }) }), function (e) { "function" == typeof define && define.amd ? define("momentja", ["moment"], e) : "object" == typeof exports ? module.exports = e(require("../moment")) : e(window.moment) }(function (e) { return e.lang("ja", { months: "1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"), monthsShort: "1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"), weekdays: "日曜日_月曜日_火曜日_水曜日_木曜日_金曜日_土曜日".split("_"), weekdaysShort: "日_月_火_水_木_金_土".split("_"), weekdaysMin: "日_月_火_水_木_金_土".split("_"), longDateFormat: { LT: "Ah時m分", L: "YYYY/MM/DD", LL: "YYYY年M月D日", LLL: "YYYY年M月D日LT", LLLL: "YYYY年M月D日LT dddd" }, meridiem: function (e, t, i) { return e < 12 ? "午前" : "午後" }, calendar: { sameDay: "[今日] LT", nextDay: "[明日] LT", nextWeek: "[来週]dddd LT", lastDay: "[昨日] LT", lastWeek: "[前週]dddd LT", sameElse: "L" }, relativeTime: { future: "%s後", past: "%s前", s: "数秒", m: "1分", mm: "%d分", h: "1時間", hh: "%d時間", d: "1日", dd: "%d日", M: "1ヶ月", MM: "%dヶ月", y: "1年", yy: "%d年" } }) }), function (e) { "function" == typeof define && define.amd ? define("momentru", ["moment"], e) : "object" == typeof exports ? module.exports = e(require("../moment")) : e(window.moment) }(function (e) { function t(e, t, i) { var n, a; return "m" === i ? t ? "минута" : "минуту" : e + " " + (n = +e, a = { mm: "минута_минуты_минут", hh: "час_часа_часов", dd: "день_дня_дней", MM: "месяц_месяца_месяцев", yy: "год_года_лет" }[i].split("_"), n % 10 == 1 && n % 100 != 11 ? a[0] : 2 <= n % 10 && n % 10 <= 4 && (n % 100 < 10 || 20 <= n % 100) ? a[1] : a[2]) } return e.lang("ru", { months: function (e, t) { return { nominative: "январь_февраль_март_апрель_май_июнь_июль_август_сентябрь_октябрь_ноябрь_декабрь".split("_"), accusative: "января_февраля_марта_апреля_мая_июня_июля_августа_сентября_октября_ноября_декабря".split("_") }[/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/.test(t) ? "accusative" : "nominative"][e.month()] }, monthsShort: function (e, t) { return { nominative: "янв_фев_мар_апр_май_июнь_июль_авг_сен_окт_ноя_дек".split("_"), accusative: "янв_фев_мар_апр_мая_июня_июля_авг_сен_окт_ноя_дек".split("_") }[/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/.test(t) ? "accusative" : "nominative"][e.month()] }, weekdays: function (e, t) { return { nominative: "воскресенье_понедельник_вторник_среда_четверг_пятница_суббота".split("_"), accusative: "воскресенье_понедельник_вторник_среду_четверг_пятницу_субботу".split("_") }[/\[ ?[Вв] ?(?:прошлую|следующую)? ?\] ?dddd/.test(t) ? "accusative" : "nominative"][e.day()] }, weekdaysShort: "вс_пн_вт_ср_чт_пт_сб".split("_"), weekdaysMin: "вс_пн_вт_ср_чт_пт_сб".split("_"), monthsParse: [/^янв/i, /^фев/i, /^мар/i, /^апр/i, /^ма[й|я]/i, /^июн/i, /^июл/i, /^авг/i, /^сен/i, /^окт/i, /^ноя/i, /^дек/i], longDateFormat: { LT: "HH:mm", L: "DD.MM.YYYY", LL: "D MMMM YYYY г.", LLL: "D MMMM YYYY г., LT", LLLL: "dddd, D MMMM YYYY г., LT" }, calendar: { sameDay: "[Сегодня в] LT", nextDay: "[Завтра в] LT", lastDay: "[Вчера в] LT", nextWeek: function () { return 2 === this.day() ? "[Во] dddd [в] LT" : "[В] dddd [в] LT" }, lastWeek: function () { switch (this.day()) { case 0: return "[В прошлое] dddd [в] LT"; case 1: case 2: case 4: return "[В прошлый] dddd [в] LT"; case 3: case 5: case 6: return "[В прошлую] dddd [в] LT" } }, sameElse: "L" }, relativeTime: { future: "через %s", past: "%s назад", s: "несколько секунд", m: t, mm: t, h: "час", hh: t, d: "день", dd: t, M: "месяц", MM: t, y: "год", yy: t }, meridiem: function (e, t, i) { return e < 4 ? "ночи" : e < 12 ? "утра" : e < 17 ? "дня" : "вечера" }, ordinal: function (e, t) { switch (t) { case "M": case "d": case "DDD": return e + "-й"; case "D": return e + "-го"; case "w": case "W": return e + "-я"; default: return e } }, week: { dow: 1, doy: 7 } }) }), function (e) { "function" == typeof define && define.amd ? define("momentvn", ["moment"], e) : "object" == typeof exports ? module.exports = e(require("../moment")) : e(window.moment) }(function (e) { return e.lang("vn", { months: "tháng 1_tháng 2_tháng 3_tháng 4_tháng 5_tháng 6_tháng 7_tháng 8_tháng 9_tháng 10_tháng 11_tháng 12".split("_"), monthsShort: "Th01_Th02_Th03_Th04_Th05_Th06_Th07_Th08_Th09_Th10_Th11_Th12".split("_"), weekdays: "chủ nhật_thứ hai_thứ ba_thứ tư_thứ năm_thứ sáu_thứ bảy".split("_"), weekdaysShort: "CN_T2_T3_T4_T5_T6_T7".split("_"), weekdaysMin: "CN_T2_T3_T4_T5_T6_T7".split("_"), longDateFormat: { LT: "HH:mm", L: "DD/MM/YYYY", LL: "D MMMM [năm] YYYY", LLL: "D MMMM [năm] YYYY LT", LLLL: "dddd, D MMMM [năm] YYYY LT", l: "DD/M/YYYY", ll: "D MMM YYYY", lll: "D MMM YYYY LT", llll: "ddd, D MMM YYYY LT" }, calendar: { sameDay: "[Hôm nay lúc] LT", nextDay: "[Ngày mai lúc] LT", nextWeek: "dddd [tuần tới lúc] LT", lastDay: "[Hôm qua lúc] LT", lastWeek: "dddd [tuần rồi lúc] LT", sameElse: "L" }, relativeTime: { future: "%s tới", past: "%s trước", s: "vài giây", m: "một phút", mm: "%d phút", h: "một giờ", hh: "%d giờ", d: "một ngày", dd: "%d ngày", M: "một tháng", MM: "%d tháng", y: "một năm", yy: "%d năm" }, ordinal: function (e) { return e }, week: { dow: 1, doy: 4 } }) }), function (e) { "function" == typeof define && define.amd ? define("momentth", ["moment"], e) : "object" == typeof exports ? module.exports = e(require("../moment")) : e(window.moment) }(function (e) { return e.lang("th", { months: "มกราคม_กุมภาพันธ์_มีนาคม_เมษายน_พฤษภาคม_มิถุนายน_กรกฎาคม_สิงหาคม_กันยายน_ตุลาคม_พฤศจิกายน_ธันวาคม".split("_"), monthsShort: "มกรา_กุมภา_มีนา_เมษา_พฤษภา_มิถุนา_กรกฎา_สิงหา_กันยา_ตุลา_พฤศจิกา_ธันวา".split("_"), weekdays: "อาทิตย์_จันทร์_อังคาร_พุธ_พฤหัสบดี_ศุกร์_เสาร์".split("_"), weekdaysShort: "อาทิตย์_จันทร์_อังคาร_พุธ_พฤหัส_ศุกร์_เสาร์".split("_"), weekdaysMin: "อา._จ._อ._พ._พฤ._ศ._ส.".split("_"), longDateFormat: { LT: "H นาฬิกา m นาที", L: "YYYY/MM/DD", LL: "D MMMM YYYY", LLL: "D MMMM YYYY เวลา LT", LLLL: "วันddddที่ D MMMM YYYY เวลา LT" }, meridiem: function (e, t, i) { return e < 12 ? "ก่อนเที่ยง" : "หลังเที่ยง" }, calendar: { sameDay: "[วันนี้ เวลา] LT", nextDay: "[พรุ่งนี้ เวลา] LT", nextWeek: "dddd[หน้า เวลา] LT", lastDay: "[เมื่อวานนี้ เวลา] LT", lastWeek: "[วัน]dddd[ที่แล้ว เวลา] LT", sameElse: "L" }, relativeTime: { future: "อีก %s", past: "%sที่แล้ว", s: "ไม่กี่วินาที", m: "1 นาที", mm: "%d นาที", h: "1 ชั่วโมง", hh: "%d ชั่วโมง", d: "1 วัน", dd: "%d วัน", M: "1 เดือน", MM: "%d เดือน", y: "1 ปี", yy: "%d ปี" } }) }), function (e) { "function" == typeof define && define.amd ? define("momentde", ["moment"], e) : "object" == typeof exports ? module.exports = e(require("../moment")) : e(window.moment) }(function (e) { function t(e, t, i, n) { var a = { m: ["eine Minute", "einer Minute"], h: ["eine Stunde", "einer Stunde"], d: ["ein Tag", "einem Tag"], dd: [e + " Tage", e + " Tagen"], M: ["ein Monat", "einem Monat"], MM: [e + " Monate", e + " Monaten"], y: ["ein Jahr", "einem Jahr"], yy: [e + " Jahre", e + " Jahren"] }; return t ? a[i][0] : a[i][1] } return e.lang("de", { months: "Januar_Februar_März_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"), monthsShort: "Jan._Febr._Mrz._Apr._Mai_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"), weekdays: "Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"), weekdaysShort: "So._Mo._Di._Mi._Do._Fr._Sa.".split("_"), weekdaysMin: "So_Mo_Di_Mi_Do_Fr_Sa".split("_"), longDateFormat: { LT: "H:mm [Uhr]", L: "DD.MM.YYYY", LL: "D. MMMM YYYY", LLL: "D. MMMM YYYY LT", LLLL: "dddd, D. MMMM YYYY LT" }, calendar: { sameDay: "[Heute um] LT", sameElse: "L", nextDay: "[Morgen um] LT", nextWeek: "dddd [um] LT", lastDay: "[Gestern um] LT", lastWeek: "[letzten] dddd [um] LT" }, relativeTime: { future: "in %s", past: "vor %s", s: "ein paar Sekunden", m: t, mm: "%d Minuten", h: t, hh: "%d Stunden", d: t, dd: t, M: t, MM: t, y: t, yy: t }, ordinal: "%d.", week: { dow: 1, doy: 4 } }) }), function (e) { "function" == typeof define && define.amd ? define("momentfr", ["moment"], e) : "object" == typeof exports ? module.exports = e(require("../moment")) : e(window.moment) }(function (e) { return e.lang("fr", { months: "janvier_février_mars_avril_mai_juin_juillet_août_septembre_octobre_novembre_décembre".split("_"), monthsShort: "janv._févr._mars_avr._mai_juin_juil._août_sept._oct._nov._déc.".split("_"), weekdays: "dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"), weekdaysShort: "dim._lun._mar._mer._jeu._ven._sam.".split("_"), weekdaysMin: "Di_Lu_Ma_Me_Je_Ve_Sa".split("_"), longDateFormat: { LT: "HH:mm", L: "DD/MM/YYYY", LL: "D MMMM YYYY", LLL: "D MMMM YYYY LT", LLLL: "dddd D MMMM YYYY LT" }, calendar: { sameDay: "[Aujourd'hui à] LT", nextDay: "[Demain à] LT", nextWeek: "dddd [à] LT", lastDay: "[Hier à] LT", lastWeek: "dddd [dernier à] LT", sameElse: "L" }, relativeTime: { future: "dans %s", past: "il y a %s", s: "quelques secondes", m: "une minute", mm: "%d minutes", h: "une heure", hh: "%d heures", d: "un jour", dd: "%d jours", M: "un mois", MM: "%d mois", y: "un an", yy: "%d ans" }, ordinal: function (e) { return e + (1 === e ? "er" : "") }, week: { dow: 1, doy: 4 } }) }), function (e) { "function" == typeof define && define.amd ? define("momentcn", ["moment"], e) : "object" == typeof exports ? module.exports = e(require("../moment")) : e(window.moment) }(function (i) { return i.lang("zh-cn", { months: "一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"), monthsShort: "1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"), weekdays: "星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"), weekdaysShort: "周日_周一_周二_周三_周四_周五_周六".split("_"), weekdaysMin: "日_一_二_三_四_五_六".split("_"), longDateFormat: { LT: "Ah点mm", L: "YYYY-MM-DD", LL: "YYYY年MMMD日", LLL: "YYYY年MMMD日LT", LLLL: "YYYY年MMMD日ddddLT", l: "YYYY-MM-DD", ll: "YYYY年MMMD日", lll: "YYYY年MMMD日LT", llll: "YYYY年MMMD日ddddLT" }, meridiem: function (e, t, i) { var n = 100 * e + t; return n < 600 ? "凌晨" : n < 900 ? "早上" : n < 1130 ? "上午" : n < 1230 ? "中午" : n < 1800 ? "下午" : "晚上" }, calendar: { sameDay: function () { return 0 === this.minutes() ? "[今天]Ah[点整]" : "[今天]LT" }, nextDay: function () { return 0 === this.minutes() ? "[明天]Ah[点整]" : "[明天]LT" }, lastDay: function () { return 0 === this.minutes() ? "[昨天]Ah[点整]" : "[昨天]LT" }, nextWeek: function () { var e, t; return e = i().startOf("week"), t = 604800 <= this.unix() - e.unix() ? "[下]" : "[本]", 0 === this.minutes() ? t + "dddAh点整" : t + "dddAh点mm" }, lastWeek: function () { var e, t; return e = i().startOf("week"), t = this.unix() < e.unix() ? "[上]" : "[本]", 0 === this.minutes() ? t + "dddAh点整" : t + "dddAh点mm" }, sameElse: "LL" }, ordinal: function (e, t) { switch (t) { case "d": case "D": case "DDD": return e + "日"; case "M": return e + "月"; case "w": case "W": return e + "周"; default: return e } }, relativeTime: { future: "%s内", past: "%s前", s: "几秒", m: "1分钟", mm: "%d分钟", h: "1小时", hh: "%d小时", d: "1天", dd: "%d天", M: "1个月", MM: "%d个月", y: "1年", yy: "%d年" }, week: { dow: 1, doy: 4 } }) }), function (e) { "function" == typeof define && define.amd ? define("parsleyjs", ["jquery"], e) : e(jQuery) }(function (r) { void 0 === r && void 0 !== window.jQuery && (r = window.jQuery); var o = { attr: function (e, t, i) { var n, a = {}, s = this.msieversion(), r = new RegExp("^" + t, "i"); if (void 0 === e || void 0 === e[0]) return {}; for (var o in e[0].attributes) if (null != (n = e[0].attributes[o]) && (!s || 8 <= s || n.specified) && r.test(n.name)) { if (void 0 !== i && new RegExp(i + "$", "i").test(n.name)) return !0; a[this.camelize(n.name.replace(t, ""))] = this.deserializeValue(n.value) } return void 0 === i && a }, setAttr: function (e, t, i, n) { e[0].setAttribute(this.dasherize(t + i), String(n)) }, get: function (e, t) { for (var i = 0, n = (t || "").split("."); this.isObject(e) || this.isArray(e);)if (e = e[n[i++]], i === n.length) return e }, hash: function (e) { return String(Math.random()).substring(2, e ? e + 2 : 9) }, isArray: function (e) { return "[object Array]" === Object.prototype.toString.call(e) }, isObject: function (e) { return e === Object(e) }, deserializeValue: function (t) { var e; try { return t ? "true" == t || "false" != t && ("null" == t ? null : isNaN(e = Number(t)) ? /^[\[\{]/.test(t) ? r.parseJSON(t) : t : e) : t } catch (e) { return t } }, camelize: function (e) { return e.replace(/-+(.)?/g, function (e, t) { return t ? t.toUpperCase() : "" }) }, dasherize: function (e) { return e.replace(/::/g, "/").replace(/([A-Z]+)([A-Z][a-z])/g, "$1_$2").replace(/([a-z\d])([A-Z])/g, "$1_$2").replace(/_/g, "-").toLowerCase() }, msieversion: function () { var e = window.navigator.userAgent, t = e.indexOf("MSIE "); return 0 < t || navigator.userAgent.match(/Trident.*rv\:11\./) ? parseInt(e.substring(t + 5, e.indexOf(".", t)), 10) : 0 } }, a = { namespace: "data-parsley-", inputs: "input, textarea, select", excluded: "input[type=button], input[type=submit], input[type=reset], input[type=hidden]", priorityEnabled: !0, uiEnabled: !0, validationThreshold: 3, focus: "first", trigger: !1, errorClass: "parsley-error", successClass: "parsley-success", classHandler: function () { }, errorsContainer: function () { }, errorsWrapper: '<ul class="parsley-errors-list"></ul>', errorTemplate: "<li></li>" }, s = function () { }; s.prototype = { asyncSupport: !1, actualizeOptions: function () { return this.options = this.OptionsFactory.get(this), this }, validateThroughValidator: function (e, t, i) { return window.ParsleyValidator.validate(e, t, i) }, subscribe: function (e, t) { return r.listenTo(this, e.toLowerCase(), t), this }, unsubscribe: function (e) { return r.unsubscribeTo(this, e.toLowerCase()), this }, reset: function () { if ("ParsleyForm" !== this.__class__) return r.emit("parsley:field:reset", this); for (var e = 0; e < this.fields.length; e++)r.emit("parsley:field:reset", this.fields[e]); r.emit("parsley:form:reset", this) }, destroy: function () { if ("ParsleyForm" !== this.__class__) return this.$element.removeData("Parsley"), this.$element.removeData("ParsleyFieldMultiple"), void r.emit("parsley:field:destroy", this); for (var e = 0; e < this.fields.length; e++)this.fields[e].destroy(); this.$element.removeData("Parsley"), r.emit("parsley:form:destroy", this) } }; var l = function () { var e = {}, l = function (e) { this.__class__ = "Validator", this.__version__ = "1.0.1", this.options = e || {}, this.bindingKey = this.options.bindingKey || "_validatorjsConstraint" }; l.prototype = { constructor: l, validate: function (e, t, i) { if ("string" != typeof e && "object" != typeof e) throw new Error("You must validate an object or a string"); return "string" == typeof e || h(e) ? this._validateString(e, t, i) : this.isBinded(e) ? this._validateBindedObject(e, t) : this._validateObject(e, t, i) }, bind: function (e, t) { if ("object" != typeof e) throw new Error("Must bind a Constraint to an object"); return e[this.bindingKey] = new n(t), this }, unbind: function (e) { return void 0 === e._validatorjsConstraint || delete e[this.bindingKey], this }, isBinded: function (e) { return void 0 !== e[this.bindingKey] }, getBinded: function (e) { return this.isBinded(e) ? e[this.bindingKey] : null }, _validateString: function (e, t, i) { var n, a = []; h(t) || (t = [t]); for (var s = 0; s < t.length; s++) { if (!(t[s] instanceof d)) throw new Error("You must give an Assert or an Asserts array to validate a string"); (n = t[s].check(e, i)) instanceof c && a.push(n) } return !a.length || a }, _validateObject: function (e, t, i) { if ("object" != typeof t) throw new Error("You must give a constraint to validate an object"); return t instanceof n ? t.check(e, i) : new n(t).check(e, i) }, _validateBindedObject: function (e, t) { return e[this.bindingKey].check(e, t) } }, l.errorCode = { must_be_a_string: "must_be_a_string", must_be_an_array: "must_be_an_array", must_be_a_number: "must_be_a_number", must_be_a_string_or_array: "must_be_a_string_or_array" }; var n = function (t, e) { if (this.__class__ = "Constraint", this.options = e || {}, this.nodes = {}, t) try { this._bootstrap(t) } catch (e) { throw new Error("Should give a valid mapping object to Constraint", e, t) } }; n.prototype = { constructor: n, check: function (e, t) { var i, n = {}; for (var a in this.nodes) { for (var s = !1, r = this.get(a), o = h(r) ? r : [r], l = o.length - 1; 0 <= l; l--)"Required" !== o[l].__class__ || (s = o[l].requiresValidation(t)); if (this.has(a, e) || this.options.strict || s) try { this.has(a, this.options.strict || s ? e : void 0) || (new d).HaveProperty(a).validate(e), i = this._check(a, e[a], t), (h(i) && 0 < i.length || !h(i) && !u(i)) && (n[a] = i) } catch (e) { n[a] = e } } return !!u(n) || n }, add: function (e, t) { if (t instanceof d || h(t) && t[0] instanceof d) return this.nodes[e] = t, this; if ("object" == typeof t && !h(t)) return this.nodes[e] = t instanceof n ? t : new n(t), this; throw new Error("Should give an Assert, an Asserts array, a Constraint", t) }, has: function (e, t) { return void 0 !== (t = void 0 !== t ? t : this.nodes)[e] }, get: function (e, t) { return this.has(e) ? this.nodes[e] : t || null }, remove: function (e) { var t = []; for (var i in this.nodes) i !== e && (t[i] = this.nodes[i]); return this.nodes = t, this }, _bootstrap: function (e) { if (e instanceof n) return this.nodes = e.nodes; for (var t in e) this.add(t, e[t]) }, _check: function (e, t, i) { if (this.nodes[e] instanceof d) return this._checkAsserts(t, [this.nodes[e]], i); if (h(this.nodes[e])) return this._checkAsserts(t, this.nodes[e], i); if (this.nodes[e] instanceof n) return this.nodes[e].check(t, i); throw new Error("Invalid node", this.nodes[e]) }, _checkAsserts: function (e, t, i) { for (var n, a = [], s = 0; s < t.length; s++)void 0 !== (n = t[s].check(e, i)) && !0 !== n && a.push(n); return a } }; var c = function (e, t, i) { if (this.__class__ = "Violation", !(e instanceof d)) throw new Error("Should give an assertion implementing the Assert interface"); this.assert = e, this.value = t, void 0 !== i && (this.violation = i) }; c.prototype = { show: function () { var e = { assert: this.assert.__class__, value: this.value }; return this.violation && (e.violation = this.violation), e }, __toString: function () { return void 0 !== this.violation && (this.violation = '", ' + this.getViolation().constraint + " expected was " + this.getViolation().expected), this.assert.__class__ + ' assert failed for "' + this.value + this.violation || "" }, getViolation: function () { var e, t; for (e in this.violation) t = this.violation[e]; return { constraint: e, expected: t } } }; var d = function (e) { this.__class__ = "Assert", this.__parentClass__ = this.__class__, this.groups = [], void 0 !== e && this.addGroup(e) }; d.prototype = { construct: d, requiresValidation: function (e) { return !(e && !this.hasGroup(e)) && !(!e && this.hasGroups()) }, check: function (e, t) { if (this.requiresValidation(t)) try { return this.validate(e, t) } catch (e) { return e } }, hasGroup: function (e) { return h(e) ? this.hasOneOf(e) : "Any" === e || (this.hasGroups() ? -1 !== this.groups.indexOf(e) : "Default" === e) }, hasOneOf: function (e) { for (var t = 0; t < e.length; t++)if (this.hasGroup(e[t])) return !0; return !1 }, hasGroups: function () { return 0 < this.groups.length }, addGroup: function (e) { return h(e) ? this.addGroups(e) : (this.hasGroup(e) || this.groups.push(e), this) }, removeGroup: function (e) { for (var t = [], i = 0; i < this.groups.length; i++)e !== this.groups[i] && t.push(this.groups[i]); return this.groups = t, this }, addGroups: function (e) { for (var t = 0; t < e.length; t++)this.addGroup(e[t]); return this }, HaveProperty: function (e) { return this.__class__ = "HaveProperty", this.node = e, this.validate = function (e) { if (void 0 === e[this.node]) throw new c(this, e, { value: this.node }); return !0 }, this }, Blank: function () { return this.__class__ = "Blank", this.validate = function (e) { if ("string" != typeof e) throw new c(this, e, { value: l.errorCode.must_be_a_string }); if ("" !== e.replace(/^\s+/g, "").replace(/\s+$/g, "")) throw new c(this, e); return !0 }, this }, Callback: function (e) { if (this.__class__ = "Callback", this.arguments = Array.prototype.slice.call(arguments), 1 === this.arguments.length ? this.arguments = [] : this.arguments.splice(0, 1), "function" != typeof e) throw new Error("Callback must be instanciated with a function"); return this.fn = e, this.validate = function (e) { var t = this.fn.apply(this, [e].concat(this.arguments)); if (!0 !== t) throw new c(this, e, { result: t }); return !0 }, this }, Choice: function (e) { if (this.__class__ = "Choice", !h(e) && "function" != typeof e) throw new Error("Choice must be instanciated with an array or a function"); return this.list = e, this.validate = function (e) { for (var t = "function" == typeof this.list ? this.list() : this.list, i = 0; i < t.length; i++)if (e === t[i]) return !0; throw new c(this, e, { choices: t }) }, this }, Collection: function (e) { return this.__class__ = "Collection", this.constraint = void 0 !== e && (e instanceof d ? e : new n(e)), this.validate = function (e, t) { var i, n = new l, a = 0, s = {}, r = this.groups.length ? this.groups : t; if (!h(e)) throw new c(this, e, { value: l.errorCode.must_be_an_array }); for (var o = 0; o < e.length; o++)i = this.constraint ? n.validate(e[o], this.constraint, r) : n.validate(e[o], r), u(i) || (s[a] = i), a++; return !!u(s) || s }, this }, Count: function (e) { return this.__class__ = "Count", this.count = e, this.validate = function (e) { if (!h(e)) throw new c(this, e, { value: l.errorCode.must_be_an_array }); var t = "function" == typeof this.count ? this.count(e) : this.count; if (isNaN(Number(t))) throw new Error("Count must be a valid interger", t); if (t !== e.length) throw new c(this, e, { count: t }); return !0 }, this }, Email: function () { return this.__class__ = "Email", this.validate = function (e) { if ("string" != typeof e) throw new c(this, e, { value: l.errorCode.must_be_a_string }); if (!/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(e)) throw new c(this, e); return !0 }, this }, EqualTo: function (e) { if (this.__class__ = "EqualTo", void 0 === e) throw new Error("EqualTo must be instanciated with a value or a function"); return this.reference = e, this.validate = function (e) { var t = "function" == typeof this.reference ? this.reference(e) : this.reference; if (t !== e) throw new c(this, e, { value: t }); return !0 }, this }, GreaterThan: function (e) { if (this.__class__ = "GreaterThan", void 0 === e) throw new Error("Should give a threshold value"); return this.threshold = e, this.validate = function (e) { if ("" === e || isNaN(Number(e))) throw new c(this, e, { value: l.errorCode.must_be_a_number }); if (this.threshold >= e) throw new c(this, e, { threshold: this.threshold }); return !0 }, this }, GreaterThanOrEqual: function (e) { if (this.__class__ = "GreaterThanOrEqual", void 0 === e) throw new Error("Should give a threshold value"); return this.threshold = e, this.validate = function (e) { if ("" === e || isNaN(Number(e))) throw new c(this, e, { value: l.errorCode.must_be_a_number }); if (this.threshold > e) throw new c(this, e, { threshold: this.threshold }); return !0 }, this }, InstanceOf: function (e) { if (this.__class__ = "InstanceOf", void 0 === e) throw new Error("InstanceOf must be instanciated with a value"); return this.classRef = e, this.validate = function (e) { if (1 != e instanceof this.classRef) throw new c(this, e, { classRef: this.classRef }); return !0 }, this }, Length: function (e) { if (this.__class__ = "Length", !e.min && !e.max) throw new Error("Lenth assert must be instanciated with a { min: x, max: y } object"); return this.min = e.min, this.max = e.max, this.validate = function (e) { if ("string" != typeof e && !h(e)) throw new c(this, e, { value: l.errorCode.must_be_a_string_or_array }); if (void 0 !== this.min && this.min === this.max && e.length !== this.min) throw new c(this, e, { min: this.min, max: this.max }); if (void 0 !== this.max && e.length > this.max) throw new c(this, e, { max: this.max }); if (void 0 !== this.min && e.length < this.min) throw new c(this, e, { min: this.min }); return !0 }, this }, LessThan: function (e) { if (this.__class__ = "LessThan", void 0 === e) throw new Error("Should give a threshold value"); return this.threshold = e, this.validate = function (e) { if ("" === e || isNaN(Number(e))) throw new c(this, e, { value: l.errorCode.must_be_a_number }); if (this.threshold <= e) throw new c(this, e, { threshold: this.threshold }); return !0 }, this }, LessThanOrEqual: function (e) { if (this.__class__ = "LessThanOrEqual", void 0 === e) throw new Error("Should give a threshold value"); return this.threshold = e, this.validate = function (e) { if ("" === e || isNaN(Number(e))) throw new c(this, e, { value: l.errorCode.must_be_a_number }); if (this.threshold < e) throw new c(this, e, { threshold: this.threshold }); return !0 }, this }, NotNull: function () { return this.__class__ = "NotNull", this.validate = function (e) { if (null == e) throw new c(this, e); return !0 }, this }, NotBlank: function () { return this.__class__ = "NotBlank", this.validate = function (e) { if ("string" != typeof e) throw new c(this, e, { value: l.errorCode.must_be_a_string }); if ("" === e.replace(/^\s+/g, "").replace(/\s+$/g, "")) throw new c(this, e); return !0 }, this }, Null: function () { return this.__class__ = "Null", this.validate = function (e) { if (null !== e) throw new c(this, e); return !0 }, this }, Range: function (e, t) { if (this.__class__ = "Range", void 0 === e || void 0 === t) throw new Error("Range assert expects min and max values"); return this.min = e, this.max = t, this.validate = function (t) { try { return "string" == typeof t && isNaN(Number(t)) || h(t) ? (new d).Length({ min: this.min, max: this.max }).validate(t) : (new d).GreaterThanOrEqual(this.min).validate(t) && (new d).LessThanOrEqual(this.max).validate(t), !0 } catch (e) { throw new c(this, t, e.violation) } return !0 }, this }, Regexp: function (e, t) { if (this.__class__ = "Regexp", void 0 === e) throw new Error("You must give a regexp"); return this.regexp = e, this.flag = t || "", this.validate = function (e) { if ("string" != typeof e) throw new c(this, e, { value: l.errorCode.must_be_a_string }); if (!new RegExp(this.regexp, this.flag).test(e)) throw new c(this, e, { regexp: this.regexp, flag: this.flag }); return !0 }, this }, Required: function () { return this.__class__ = "Required", this.validate = function (t) { if (void 0 === t) throw new c(this, t); try { "string" == typeof t ? (new d).NotNull().validate(t) && (new d).NotBlank().validate(t) : !0 === h(t) && (new d).Length({ min: 1 }).validate(t) } catch (e) { throw new c(this, t) } return !0 }, this }, Unique: function (e) { return this.__class__ = "Unique", "object" == typeof e && (this.key = e.key), this.validate = function (e) { var t, i = []; if (!h(e)) throw new c(this, e, { value: l.errorCode.must_be_an_array }); for (var n = 0; n < e.length; n++)if (void 0 !== (t = "object" == typeof e[n] ? e[n][this.key] : e[n])) { if (-1 !== i.indexOf(t)) throw new c(this, e, { value: t }); i.push(t) } return !0 }, this } }, e.Assert = d, e.Validator = l, e.Violation = c, e.Constraint = n, Array.prototype.indexOf || (Array.prototype.indexOf = function (e) { if (null === this) throw new TypeError; var t = Object(this), i = t.length >>> 0; if (0 === i) return -1; var n = 0; if (1 < arguments.length && ((n = Number(arguments[1])) != n ? n = 0 : 0 !== n && 1 / 0 != n && n != -1 / 0 && (n = (0 < n || -1) * Math.floor(Math.abs(n)))), i <= n) return -1; for (var a = 0 <= n ? n : Math.max(i - Math.abs(n), 0); a < i; a++)if (a in t && t[a] === e) return a; return -1 }); var u = function (e) { for (var t in e) return !1; return !0 }, h = function (e) { return "[object Array]" === Object.prototype.toString.call(e) }; return "function" == typeof define && define.amd ? define("vendors/validator.js/dist/validator", [], function () { return e }) : "undefined" != typeof module && module.exports ? module.exports = e : window["undefined" != typeof validatorjs_ns ? validatorjs_ns : "Validator"] = e, e }(); l = void 0 !== l ? l : "undefined" != typeof module ? module.exports : null; var e = function (e, t) { this.__class__ = "ParsleyValidator", this.Validator = l, this.locale = "en", this.init(e || {}, t || {}) }; e.prototype = { init: function (e, t) { for (var i in this.catalog = t, e) this.addValidator(i, e[i].fn, e[i].priority, e[i].requirementsTransformer); r.emit("parsley:validator:init") }, setLocale: function (e) { if (void 0 === this.catalog[e]) throw new Error(e + " is not available in the catalog"); return this.locale = e, this }, addCatalog: function (e, t, i) { return "object" == typeof t && (this.catalog[e] = t), !0 === i ? this.setLocale(e) : this }, addMessage: function (e, t, i) { return void 0 === this.catalog[e] && (this.catalog[e] = {}), this.catalog[e][t.toLowerCase()] = i, this }, validate: function () { return (new this.Validator.Validator).validate.apply(new l.Validator, arguments) }, addValidator: function (e, t, i, n) { return this.validators[e.toLowerCase()] = function (e) { return r.extend((new l.Assert).Callback(t, e), { priority: i, requirementsTransformer: n }) }, this }, updateValidator: function (e, t, i, n) { return this.addValidator(e, t, i, n) }, removeValidator: function (e) { return delete this.validators[e], this }, getErrorMessage: function (e) { var t; return "" !== (t = "type" === e.name ? this.catalog[this.locale][e.name][e.requirements] : this.formatMessage(this.catalog[this.locale][e.name], e.requirements)) ? t : this.catalog[this.locale].defaultMessage }, formatMessage: function (e, t) { if ("object" == typeof t) { for (var i in t) e = this.formatMessage(e, t[i]); return e } return "string" == typeof e ? e.replace(new RegExp("%s", "i"), t) : "" }, validators: { notblank: function () { return r.extend((new l.Assert).NotBlank(), { priority: 2 }) }, required: function () { return r.extend((new l.Assert).Required(), { priority: 512 }) }, type: function (e) { var t; switch (e) { case "email": t = (new l.Assert).Email(); break; case "range": case "number": t = (new l.Assert).Regexp("^-?(?:\\d+|\\d{1,3}(?:,\\d{3})+)?(?:\\.\\d+)?$"); break; case "integer": t = (new l.Assert).Regexp("^-?\\d+$"); break; case "digits": t = (new l.Assert).Regexp("^\\d+$"); break; case "alphanum": t = (new l.Assert).Regexp("^\\w+$", "i"); break; case "url": t = (new l.Assert).Regexp("(https?:\\/\\/)?(www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,24}\\b([-a-zA-Z0-9@:%_\\+.~#?&//=]*)", "i"); break; default: throw new Error("validator type `" + e + "` is not supported") }return r.extend(t, { priority: 256 }) }, pattern: function (e) { var t = ""; return /^\/.*\/(?:[gimy]*)$/.test(e) && (t = e.replace(/.*\/([gimy]*)$/, "$1"), e = e.replace(new RegExp("^/(.*?)/" + t + "$"), "$1")), r.extend((new l.Assert).Regexp(e, t), { priority: 64 }) }, minlength: function (e) { return r.extend((new l.Assert).Length({ min: e }), { priority: 30, requirementsTransformer: function () { return "string" != typeof e || isNaN(e) ? e : parseInt(e, 10) } }) }, maxlength: function (e) { return r.extend((new l.Assert).Length({ max: e }), { priority: 30, requirementsTransformer: function () { return "string" != typeof e || isNaN(e) ? e : parseInt(e, 10) } }) }, length: function (e) { return r.extend((new l.Assert).Length({ min: e[0], max: e[1] }), { priority: 32 }) }, mincheck: function (e) { return this.minlength(e) }, maxcheck: function (e) { return this.maxlength(e) }, check: function (e) { return this.length(e) }, min: function (e) { return r.extend((new l.Assert).GreaterThanOrEqual(e), { priority: 30, requirementsTransformer: function () { return "string" != typeof e || isNaN(e) ? e : parseInt(e, 10) } }) }, max: function (e) { return r.extend((new l.Assert).LessThanOrEqual(e), { priority: 30, requirementsTransformer: function () { return "string" != typeof e || isNaN(e) ? e : parseInt(e, 10) } }) }, range: function (t) { return r.extend((new l.Assert).Range(t[0], t[1]), { priority: 32, requirementsTransformer: function () { for (var e = 0; e < t.length; e++)t[e] = "string" != typeof t[e] || isNaN(t[e]) ? t[e] : parseInt(t[e], 10); return t } }) }, equalto: function (e) { return r.extend((new l.Assert).EqualTo(e), { priority: 256, requirementsTransformer: function () { return r(e).length ? r(e).val() : e } }) } } }; var t = function () { this.__class__ = "ParsleyUI" }; t.prototype = { listen: function () { return r.listen("parsley:form:init", this, this.setupForm), r.listen("parsley:field:init", this, this.setupField), r.listen("parsley:field:validated", this, this.reflow), r.listen("parsley:form:validated", this, this.focus), r.listen("parsley:field:reset", this, this.reset), r.listen("parsley:form:destroy", this, this.destroy), r.listen("parsley:field:destroy", this, this.destroy), this }, reflow: function (e) { if (void 0 !== e._ui && !1 !== e._ui.active) { var t = this._diff(e.validationResult, e._ui.lastValidationResult); e._ui.lastValidationResult = e.validationResult, e._ui.validatedOnce = !0, this.manageStatusClass(e), this.manageErrorsMessages(e, t), this.actualizeTriggers(e), (t.kept.length || t.added.length) && void 0 === e._ui.failedOnce && this.manageFailingFieldTrigger(e) } }, getErrorsMessages: function (e) { if (!0 === e.validationResult) return []; for (var t = [], i = 0; i < e.validationResult.length; i++)t.push(this._getErrorMessage(e, e.validationResult[i].assert)); return t }, manageStatusClass: function (e) { !0 === e.validationResult ? this._successClass(e) : 0 < e.validationResult.length ? this._errorClass(e) : this._resetClass(e) }, manageErrorsMessages: function (e, t) { if (void 0 === e.options.errorsMessagesDisabled) { if (void 0 !== e.options.errorMessage) return t.added.length || t.kept.length ? (0 === e._ui.$errorsWrapper.find(".parsley-custom-error-message").length && e._ui.$errorsWrapper.append(r(e.options.errorTemplate).addClass("parsley-custom-error-message")), e._ui.$errorsWrapper.addClass("filled").find(".parsley-custom-error-message").html(e.options.errorMessage)) : e._ui.$errorsWrapper.removeClass("filled").find(".parsley-custom-error-message").remove(); for (var i = 0; i < t.removed.length; i++)this.removeError(e, t.removed[i].assert.name, !0); for (i = 0; i < t.added.length; i++)this.addError(e, t.added[i].assert.name, void 0, t.added[i].assert, !0); for (i = 0; i < t.kept.length; i++)this.updateError(e, t.kept[i].assert.name, void 0, t.kept[i].assert, !0) } }, addError: function (e, t, i, n, a) { e._ui.$errorsWrapper.addClass("filled").append(r(e.options.errorTemplate).addClass("parsley-" + t).html(i || this._getErrorMessage(e, n))), !0 !== a && this._errorClass(e) }, updateError: function (e, t, i, n, a) { e._ui.$errorsWrapper.addClass("filled").find(".parsley-" + t).html(i || this._getErrorMessage(e, n)), !0 !== a && this._errorClass(e) }, removeError: function (e, t, i) { e._ui.$errorsWrapper.removeClass("filled").find(".parsley-" + t).remove(), !0 !== i && this.manageStatusClass(e) }, focus: function (e) { if (!0 === e.validationResult || "none" === e.options.focus) return e._focusedField = null; e._focusedField = null; for (var t = 0; t < e.fields.length; t++)if (!0 !== e.fields[t].validationResult && 0 < e.fields[t].validationResult.length && void 0 === e.fields[t].options.noFocus) { if ("first" === e.options.focus) return e._focusedField = e.fields[t].$element, e._focusedField.focus(); e._focusedField = e.fields[t].$element } return null === e._focusedField ? null : e._focusedField.focus() }, _getErrorMessage: function (e, t) { var i = t.name + "Message"; return void 0 !== e.options[i] ? window.ParsleyValidator.formatMessage(e.options[i], t.requirements) : window.ParsleyValidator.getErrorMessage(t) }, _diff: function (e, t, i) { for (var n = [], a = [], s = 0; s < e.length; s++) { for (var r = !1, o = 0; o < t.length; o++)if (e[s].assert.name === t[o].assert.name) { r = !0; break } r ? a.push(e[s]) : n.push(e[s]) } return { kept: a, added: n, removed: i ? [] : this._diff(t, e, !0).added } }, setupForm: function (e) { e.$element.on("submit.Parsley", !1, r.proxy(e.onSubmitValidate, e)), !1 !== e.options.uiEnabled && e.$element.attr("novalidate", "") }, setupField: function (e) { var t = { active: !1 }; !1 !== e.options.uiEnabled && (t.active = !0, e.$element.attr(e.options.namespace + "id", e.__id__), t.$errorClassHandler = this._manageClassHandler(e), t.errorsWrapperId = "parsley-id-" + (void 0 !== e.options.multiple ? "multiple-" + e.options.multiple : e.__id__), t.$errorsWrapper = r(e.options.errorsWrapper).attr("id", t.errorsWrapperId), t.lastValidationResult = [], t.validatedOnce = !1, t.validationInformationVisible = !1, e._ui = t, e.$element.is(e.options.excluded) || this._insertErrorWrapper(e), this.actualizeTriggers(e)) }, _manageClassHandler: function (e) { if ("string" == typeof e.options.classHandler && r(e.options.classHandler).length) return r(e.options.classHandler); var t = e.options.classHandler(e); return void 0 !== t && t.length ? t : void 0 === e.options.multiple || e.$element.is("select") ? e.$element : e.$element.parent() }, _insertErrorWrapper: function (e) { var t; if ("string" == typeof e.options.errorsContainer) { if (r(e.options.errorsContainer).length) return r(e.options.errorsContainer).append(e._ui.$errorsWrapper); window.console && window.console.warn && window.console.warn("The errors container `" + e.options.errorsContainer + "` does not exist in DOM") } else "function" == typeof e.options.errorsContainer && (t = e.options.errorsContainer(e)); return void 0 !== t && t.length ? t.append(e._ui.$errorsWrapper) : void 0 === e.options.multiple ? e.$element.after(e._ui.$errorsWrapper) : e.$element.parent().after(e._ui.$errorsWrapper) }, actualizeTriggers: function (e) { var t = e.$element; if (e.options.multiple && (t = r("[" + e.options.namespace + 'multiple="' + e.options.multiple + '"]')), t.off(".Parsley"), !1 !== e.options.trigger) { var i = e.options.trigger.replace(/^\s+/g, "").replace(/\s+$/g, ""); "" !== i && t.on(i.split(" ").join(".Parsley ") + ".Parsley", r.proxy("function" == typeof e.eventValidate ? e.eventValidate : this.eventValidate, e)) } }, eventValidate: function (e) { new RegExp("key").test(e.type) && !this._ui.validationInformationVisible && this.getValue().length <= this.options.validationThreshold || (this._ui.validatedOnce = !0, this.validate()) }, manageFailingFieldTrigger: function (e) { return e._ui.failedOnce = !0, e.options.multiple && r("[" + e.options.namespace + 'multiple="' + e.options.multiple + '"]').each(function () { return new RegExp("change", "i").test(r(this).parsley().options.trigger || "") ? void 0 : r(this).on("change.ParsleyFailedOnce", !1, r.proxy(e.validate, e)) }), e.$element.is("select") && !new RegExp("change", "i").test(e.options.trigger || "") ? e.$element.on("change.ParsleyFailedOnce", !1, r.proxy(e.validate, e)) : new RegExp("keyup", "i").test(e.options.trigger || "") ? void 0 : e.$element.on("keyup.ParsleyFailedOnce", !1, r.proxy(e.validate, e)) }, reset: function (e) { e.$element.off(".Parsley"), e.$element.off(".ParsleyFailedOnce"), void 0 !== e._ui && "ParsleyForm" !== e.__class__ && (e._ui.$errorsWrapper.removeClass("filled").children().remove(), this._resetClass(e), e._ui.validatedOnce = !1, e._ui.lastValidationResult = [], e._ui.validationInformationVisible = !1) }, destroy: function (e) { this.reset(e), "ParsleyForm" !== e.__class__ && (void 0 !== e._ui && e._ui.$errorsWrapper.remove(), delete e._ui) }, _successClass: function (e) { e._ui.validationInformationVisible = !0, e._ui.$errorClassHandler.removeClass(e.options.errorClass).addClass(e.options.successClass) }, _errorClass: function (e) { e._ui.validationInformationVisible = !0, e._ui.$errorClassHandler.removeClass(e.options.successClass).addClass(e.options.errorClass) }, _resetClass: function (e) { e._ui.$errorClassHandler.removeClass(e.options.successClass).removeClass(e.options.errorClass) } }; var c = function (e, t, i, n) { this.__class__ = "OptionsFactory", this.__id__ = o.hash(4), this.formOptions = null, this.fieldOptions = null, this.staticOptions = r.extend(!0, {}, e, t, i, { namespace: n }) }; c.prototype = { get: function (e) { if (void 0 === e.__class__) throw new Error("Parsley Instance expected"); switch (e.__class__) { case "Parsley": return this.staticOptions; case "ParsleyForm": return this.getFormOptions(e); case "ParsleyField": case "ParsleyFieldMultiple": return this.getFieldOptions(e); default: throw new Error("Instance " + e.__class__ + " is not supported") } }, getFormOptions: function (e) { return this.formOptions = o.attr(e.$element, this.staticOptions.namespace), r.extend({}, this.staticOptions, this.formOptions) }, getFieldOptions: function (e) { return this.fieldOptions = o.attr(e.$element, this.staticOptions.namespace), null === this.formOptions && void 0 !== e.parent && (this.formOptions = this.getFormOptions(e.parent)), r.extend({}, this.staticOptions, this.formOptions, this.fieldOptions) } }; var d = function (e, t) { if (this.__class__ = "ParsleyForm", this.__id__ = o.hash(4), "OptionsFactory" !== o.get(t, "__class__")) throw new Error("You must give an OptionsFactory instance"); this.OptionsFactory = t, this.$element = r(e), this.validationResult = null, this.options = this.OptionsFactory.get(this) }; d.prototype = { onSubmitValidate: function (e) { return this.validate(void 0, void 0, e), !1 === this.validationResult && e instanceof r.Event && (e.stopImmediatePropagation(), e.preventDefault()), this }, validate: function (e, t, i) { this.submitEvent = i, this.validationResult = !0; var n = []; r.emit("parsley:form:validate", this), this._refreshFields(); for (var a = 0; a < this.fields.length; a++)(!e || this._isFieldInGroup(this.fields[a], e)) && (!0 !== (n = this.fields[a].validate(t)) && 0 < n.length && this.validationResult && (this.validationResult = !1)); return r.emit("parsley:form:" + (this.validationResult ? "success" : "error"), this), r.emit("parsley:form:validated", this), this.validationResult }, isValid: function (e, t) { this._refreshFields(); for (var i = 0; i < this.fields.length; i++)if ((!e || this._isFieldInGroup(this.fields[i], e)) && !1 === this.fields[i].isValid(t)) return !1; return !0 }, _isFieldInGroup: function (e, t) { return o.isArray(e.options.group) ? -1 !== r.inArray(t, e.options.group) : e.options.group === t }, _refreshFields: function () { return this.actualizeOptions()._bindFields() }, _bindFields: function () { var t = this; return this.fields = [], this.fieldsMappedById = {}, this.$element.find(this.options.inputs).each(function () { var e = new window.Parsley(this, {}, t); "ParsleyField" !== e.__class__ && "ParsleyFieldMultiple" !== e.__class__ || e.$element.is(e.options.excluded) || void 0 === t.fieldsMappedById[e.__class__ + "-" + e.__id__] && (t.fieldsMappedById[e.__class__ + "-" + e.__id__] = e, t.fields.push(e)) }), this } }; var u = function (e, t, i, n, a) { var s = {}; if (!new RegExp("ParsleyField").test(o.get(e, "__class__"))) throw new Error("ParsleyField or ParsleyFieldMultiple instance expected"); if ("function" == typeof window.ParsleyValidator.validators[t] && (s = window.ParsleyValidator.validators[t](i)), "Assert" !== s.__parentClass__) throw new Error("Valid validator expected"); return n = n || (void 0 !== e.options[t + "Priority"] ? e.options[t + "Priority"] : o.get(s, "priority") || 2), "function" == typeof s.requirementsTransformer && (i = s.requirementsTransformer(), s = window.ParsleyValidator.validators[t](i)), r.extend(s, { name: t, requirements: i, priority: n, groups: [n], isDomConstraint: a || o.attr(e.$element, e.options.namespace, t) }) }, h = function (e, t, i) { this.__class__ = "ParsleyField", this.__id__ = o.hash(4), this.$element = r(e), void 0 !== i ? (this.parent = i, this.OptionsFactory = this.parent.OptionsFactory) : this.OptionsFactory = t, this.options = this.OptionsFactory.get(this), this.constraints = [], this.constraintsByName = {}, this.validationResult = [], this._bindConstraints() }; h.prototype = { validate: function (e) { return this.value = this.getValue(), r.emit("parsley:field:validate", this), r.emit("parsley:field:" + (this.isValid(e, this.value) ? "success" : "error"), this), r.emit("parsley:field:validated", this), this.validationResult }, isValid: function (e, t) { this.refreshConstraints(); var i = this._getConstraintsSortedPriorities(); if (0 === i.length) return this.validationResult = []; if (null == t && (t = this.getValue()), !t.length && !this._isRequired() && void 0 === this.options.validateIfEmpty && !0 !== e) return this.validationResult = []; if (!1 === this.options.priorityEnabled) return !0 === (this.validationResult = this.validateThroughValidator(t, this.constraints, "Any")); for (var n = 0; n < i.length; n++)if (!0 !== (this.validationResult = this.validateThroughValidator(t, this.constraints, i[n]))) return !1; return !0 }, getValue: function () { var e; return null == (e = void 0 !== this.options.value ? this.options.value : this.$element.val()) ? "" : !0 === this.options.trimValue ? e.replace(/^\s+|\s+$/g, "") : e }, refreshConstraints: function () { return this.actualizeOptions()._bindConstraints() }, addConstraint: function (e, t, i, n) { if (e = e.toLowerCase(), "function" == typeof window.ParsleyValidator.validators[e]) { var a = new u(this, e, t, i, n); "undefined" !== this.constraintsByName[a.name] && this.removeConstraint(a.name), this.constraints.push(a), this.constraintsByName[a.name] = a } return this }, removeConstraint: function (e) { for (var t = 0; t < this.constraints.length; t++)if (e === this.constraints[t].name) { this.constraints.splice(t, 1); break } return delete this.constraintsByName[e], this }, updateConstraint: function (e, t, i) { return this.removeConstraint(e).addConstraint(e, t, i) }, _bindConstraints: function () { for (var e = [], t = {}, i = 0; i < this.constraints.length; i++)!1 === this.constraints[i].isDomConstraint && (e.push(this.constraints[i]), t[this.constraints[i].name] = this.constraints[i]); for (var n in this.constraints = e, this.constraintsByName = t, this.options) this.addConstraint(n, this.options[n]); return this._bindHtml5Constraints() }, _bindHtml5Constraints: function () { (this.$element.hasClass("required") || this.$element.attr("required")) && this.addConstraint("required", !0, void 0, !0), "string" == typeof this.$element.attr("pattern") && this.addConstraint("pattern", this.$element.attr("pattern"), void 0, !0), void 0 !== this.$element.attr("min") && void 0 !== this.$element.attr("max") ? this.addConstraint("range", [this.$element.attr("min"), this.$element.attr("max")], void 0, !0) : void 0 !== this.$element.attr("min") ? this.addConstraint("min", this.$element.attr("min"), void 0, !0) : void 0 !== this.$element.attr("max") && this.addConstraint("max", this.$element.attr("max"), void 0, !0), void 0 !== this.$element.attr("minlength") && void 0 !== this.$element.attr("maxlength") ? this.addConstraint("length", [this.$element.attr("minlength"), this.$element.attr("maxlength")], void 0, !0) : void 0 !== this.$element.attr("minlength") ? this.addConstraint("minlength", this.$element.attr("minlength"), void 0, !0) : void 0 !== this.$element.attr("maxlength") && this.addConstraint("maxlength", this.$element.attr("maxlength"), void 0, !0); var e = this.$element.attr("type"); return void 0 === e ? this : "number" === e ? void 0 === this.$element.attr("step") || 0 == parseFloat(this.$element.attr("step")) % 1 ? this.addConstraint("type", "integer", void 0, !0) : this.addConstraint("type", "number", void 0, !0) : new RegExp(e, "i").test("email url range") ? this.addConstraint("type", e, void 0, !0) : this }, _isRequired: function () { return void 0 !== this.constraintsByName.required && !1 !== this.constraintsByName.required.requirements }, _getConstraintsSortedPriorities: function () { for (var e = [], t = 0; t < this.constraints.length; t++)-1 === e.indexOf(this.constraints[t].priority) && e.push(this.constraints[t].priority); return e.sort(function (e, t) { return t - e }), e } }; var p = function () { this.__class__ = "ParsleyFieldMultiple" }; p.prototype = { addElement: function (e) { return this.$elements.push(e), this }, refreshConstraints: function () { var e; if (this.constraints = [], this.$element.is("select")) return this.actualizeOptions()._bindConstraints(), this; for (var t = 0; t < this.$elements.length; t++)if (r("html").has(this.$elements[t]).length) { e = this.$elements[t].data("ParsleyFieldMultiple").refreshConstraints().constraints; for (var i = 0; i < e.length; i++)this.addConstraint(e[i].name, e[i].requirements, e[i].priority, e[i].isDomConstraint) } else this.$elements.splice(t, 1); return this }, getValue: function () { if (void 0 !== this.options.value) return this.options.value; if (this.$element.is("input[type=radio]")) return r("[" + this.options.namespace + 'multiple="' + this.options.multiple + '"]:checked').val() || ""; if (this.$element.is("input[type=checkbox]")) { var e = []; return r("[" + this.options.namespace + 'multiple="' + this.options.multiple + '"]:checked').each(function () { e.push(r(this).val()) }), e.length ? e : [] } return this.$element.is("select") && null === this.$element.val() ? [] : this.$element.val() }, _init: function (e) { return this.$elements = [this.$element], this.options.multiple = e, this } }; var f = r({}), m = {}; r.listen = function (e) { if (void 0 === m[e] && (m[e] = []), "function" == typeof arguments[1]) return m[e].push({ fn: arguments[1] }); if ("object" == typeof arguments[1] && "function" == typeof arguments[2]) return m[e].push({ fn: arguments[2], ctxt: arguments[1] }); throw new Error("Wrong parameters") }, r.listenTo = function (e, t, i) { if (void 0 === m[t] && (m[t] = []), !(e instanceof h || e instanceof d)) throw new Error("Must give Parsley instance"); if ("string" != typeof t || "function" != typeof i) throw new Error("Wrong parameters"); m[t].push({ instance: e, fn: i }) }, r.unsubscribe = function (e, t) { if (void 0 !== m[e]) { if ("string" != typeof e || "function" != typeof t) throw new Error("Wrong arguments"); for (var i = 0; i < m[e].length; i++)if (m[e][i].fn === t) return m[e].splice(i, 1) } }, r.unsubscribeTo = function (e, t) { if (void 0 !== m[t]) { if (!(e instanceof h || e instanceof d)) throw new Error("Must give Parsley instance"); for (var i = 0; i < m[t].length; i++)if (void 0 !== m[t][i].instance && m[t][i].instance.__id__ === e.__id__) return m[t].splice(i, 1) } }, r.unsubscribeAll = function (e) { void 0 !== m[e] && delete m[e] }, r.emit = function (e, t) { if (void 0 !== m[e]) for (var i = 0; i < m[e].length; i++)if (void 0 !== m[e][i].instance) { if (t instanceof h || t instanceof d) if (m[e][i].instance.__id__ !== t.__id__) { if (m[e][i].instance instanceof d && t instanceof h) for (var n = 0; n < m[e][i].instance.fields.length; n++)if (m[e][i].instance.fields[n].__id__ === t.__id__) { m[e][i].fn.apply(f, Array.prototype.slice.call(arguments, 1)); continue } } else m[e][i].fn.apply(f, Array.prototype.slice.call(arguments, 1)) } else m[e][i].fn.apply(void 0 !== m[e][i].ctxt ? m[e][i].ctxt : f, Array.prototype.slice.call(arguments, 1)) }, r.subscribed = function () { return m }, window.ParsleyConfig = window.ParsleyConfig || {}, window.ParsleyConfig.i18n = window.ParsleyConfig.i18n || {}, window.ParsleyConfig.i18n.en = r.extend(window.ParsleyConfig.i18n.en || {}, { defaultMessage: "This value seems to be invalid.", type: { email: "This value should be a valid email.", url: "This value should be a valid url.", number: "This value should be a valid number.", integer: "This value should be a valid integer.", digits: "This value should be digits.", alphanum: "This value should be alphanumeric." }, notblank: "This value should not be blank.", required: "This value is required.", pattern: "This value seems to be invalid.", min: "This value should be greater than or equal to %s.", max: "This value should be lower than or equal to %s.", range: "This value should be between %s and %s.", minlength: "This value is too short. It should have %s characters or more.", maxlength: "This value is too long. It should have %s characters or fewer.", length: "This value length is invalid. It should be between %s and %s characters long.", mincheck: "You must select at least %s choices.", maxcheck: "You must select %s choices or fewer.", check: "You must select between %s and %s choices.", equalto: "This value should be the same." }), void 0 !== window.ParsleyValidator && window.ParsleyValidator.addCatalog("en", window.ParsleyConfig.i18n.en, !0); var i = function (e, t, i) { if (this.__class__ = "Parsley", this.__version__ = "2.0.6", this.__id__ = o.hash(4), void 0 === e) throw new Error("You must give an element"); if (void 0 !== i && "ParsleyForm" !== i.__class__) throw new Error("Parent instance must be a ParsleyForm instance"); return this.init(r(e), t, i) }; i.prototype = { init: function (e, t, i) { if (!e.length) throw new Error("You must bind Parsley on an existing element."); if (this.$element = e, this.$element.data("Parsley")) { var n = this.$element.data("Parsley"); return void 0 !== i && (n.parent = i), n } return this.OptionsFactory = new c(a, o.get(window, "ParsleyConfig") || {}, t, this.getNamespace(t)), this.options = this.OptionsFactory.get(this), this.$element.is("form") || o.attr(this.$element, this.options.namespace, "validate") && !this.$element.is(this.options.inputs) ? this.bind("parsleyForm") : this.$element.is(this.options.inputs) && !this.$element.is(this.options.excluded) ? this.isMultiple() ? this.handleMultiple(i) : this.bind("parsleyField", i) : this }, isMultiple: function () { return this.$element.is("input[type=radio], input[type=checkbox]") && void 0 === this.options.multiple || this.$element.is("select") && void 0 !== this.$element.attr("multiple") }, handleMultiple: function (e) { var t, i, n, a = this; if (this.options = r.extend(this.options, e ? e.OptionsFactory.get(e) : {}, o.attr(this.$element, this.options.namespace)), this.options.multiple ? i = this.options.multiple : void 0 !== this.$element.attr("name") && this.$element.attr("name").length ? i = t = this.$element.attr("name") : void 0 !== this.$element.attr("id") && this.$element.attr("id").length && (i = this.$element.attr("id")), this.$element.is("select") && void 0 !== this.$element.attr("multiple")) return this.bind("parsleyFieldMultiple", e, i || this.__id__); if (void 0 === i) return window.console && window.console.warn && window.console.warn("To be binded by Parsley, a radio, a checkbox and a multiple select input must have either a name or a multiple option.", this.$element), this; if (i = i.replace(/(:|\.|\[|\]|\{|\}|\$)/g, ""), void 0 !== t && r('input[name="' + t + '"]').each(function () { r(this).is("input[type=radio], input[type=checkbox]") && r(this).attr(a.options.namespace + "multiple", i) }), r("[" + this.options.namespace + "multiple=" + i + "]").length) for (var s = 0; s < r("[" + this.options.namespace + "multiple=" + i + "]").length; s++)if (void 0 !== r(r("[" + this.options.namespace + "multiple=" + i + "]").get(s)).data("Parsley")) { n = r(r("[" + this.options.namespace + "multiple=" + i + "]").get(s)).data("Parsley"), this.$element.data("ParsleyFieldMultiple") || (n.addElement(this.$element), this.$element.attr(this.options.namespace + "id", n.__id__)); break } return this.bind("parsleyField", e, i, !0), n || this.bind("parsleyFieldMultiple", e, i) }, getNamespace: function (e) { return void 0 !== this.$element.data("parsleyNamespace") ? this.$element.data("parsleyNamespace") : void 0 !== o.get(e, "namespace") ? e.namespace : void 0 !== o.get(window, "ParsleyConfig.namespace") ? window.ParsleyConfig.namespace : a.namespace }, bind: function (e, t, i, n) { var a; switch (e) { case "parsleyForm": a = r.extend(new d(this.$element, this.OptionsFactory), new s, window.ParsleyExtend)._bindFields(); break; case "parsleyField": a = r.extend(new h(this.$element, this.OptionsFactory, t), new s, window.ParsleyExtend); break; case "parsleyFieldMultiple": a = r.extend(new h(this.$element, this.OptionsFactory, t), new s, new p, window.ParsleyExtend)._init(i); break; default: throw new Error(e + "is not a supported Parsley type") }return void 0 !== i && o.setAttr(this.$element, this.options.namespace, "multiple", i), void 0 !== n ? this.$element.data("ParsleyFieldMultiple", a) : new RegExp("ParsleyF", "i").test(a.__class__) && (this.$element.data("Parsley", a), r.emit("parsley:" + ("parsleyForm" === e ? "form" : "field") + ":init", a)), a } }, r.fn.parsley = r.fn.psly = function (e) { if (1 < this.length) { var t = []; return this.each(function () { t.push(r(this).parsley(e)) }), t } return r(this).length ? new i(this, e) : void (window.console && window.console.warn && window.console.warn("You must bind Parsley on an existing element.")) }, window.ParsleyUI = "function" == typeof o.get(window, "ParsleyConfig.ParsleyUI") ? (new window.ParsleyConfig.ParsleyUI).listen() : (new t).listen(), void 0 === window.ParsleyExtend && (window.ParsleyExtend = {}), void 0 === window.ParsleyConfig && (window.ParsleyConfig = {}), window.Parsley = window.psly = i, window.ParsleyUtils = o, window.ParsleyValidator = new e(window.ParsleyConfig.validators, window.ParsleyConfig.i18n), !1 !== o.get(window, "ParsleyConfig.autoBind") && r(function () { r("[data-parsley-validate]").length && r("[data-parsley-validate]").parsley() }) }), window.ParsleyConfig = window.ParsleyConfig || {}, window.ParsleyConfig.i18n = window.ParsleyConfig.i18n || {}, window.ParsleyConfig.i18n.zh_cn = $.extend(window.ParsleyConfig.i18n.zh_cn || {}, { defaultMessage: "不正确的值", type: { email: "请输入一个有效的电子邮箱地址", url: "请输入一个有效的链接", number: "请输入正确的数字", integer: "请输入正确的整数", digits: "请输入正确的号码", alphanum: "请输入字母或数字" }, notblank: "请输入值", required: "必填项", pattern: "格式不正确", min: "输入值请大于或等于 %s", max: "输入值请小于或等于 %s", range: "输入值应该在 %s 到 %s 之间", minlength: "请输入至少 %s 个字符", maxlength: "请输入至多 %s 个字符", length: "字符长度应该在 %s 到 %s 之间", mincheck: "请至少选择 %s 个选项", maxcheck: "请选择不超过 %s 个选项", check: "请选择 %s 到 %s 个选项", equalto: "输入值不同" }), void 0 !== window.ParsleyValidator && window.ParsleyValidator.addCatalog("zh_cn", window.ParsleyConfig.i18n.zh_cn, !0), define("parsleyjssc", ["parsleyjs"], function () { }), window.ParsleyConfig = window.ParsleyConfig || {}, window.ParsleyConfig.i18n = window.ParsleyConfig.i18n || {}, window.ParsleyConfig.i18n.zh_tw = $.extend(window.ParsleyConfig.i18n.zh_tw || {}, { defaultMessage: "這個值似乎是無效的。", type: { email: "請輸入一個有效的email。", url: "請輸入一個有效的網址。", number: "這個值應該是一個數字。", integer: "這個值應該是一個整數數字。", digits: "這個值應該是一個號碼。", alphanum: "這個值應該是字母或數字。" }, notblank: "這個值不應該為空值。", required: "這個空格必須填寫。", pattern: "這個值似乎是無效的。", min: "輸入的值應該大於或等於 %s", max: "輸入的值應該小於或等於 %s", range: "這個值應該在 %s 和 %s 之間。", minlength: "這個值至少要 %s 字元。", maxlength: "這個值最多要 %s 字元。", length: "字元長度應該在 %s 和 %s", mincheck: "你至少要選擇 %s 個項目。", maxcheck: "你最多可選擇 %s 個項目。", check: "你必須選擇 %s 到 %s 個項目。", equalto: "輸入值不同" }), void 0 !== window.ParsleyValidator && window.ParsleyValidator.addCatalog("zh_tw", window.ParsleyConfig.i18n.zh_tw, !0), define("parsleyjstc", ["parsleyjs"], function () { }), window.ParsleyConfig = window.ParsleyConfig || {}, window.ParsleyConfig.i18n = window.ParsleyConfig.i18n || {}, window.ParsleyConfig.i18n.ko = $.extend(window.ParsleyConfig.i18n.ko || {}, { defaultMessage: "입력하신 내용이 올바르지 않습니다.", type: { email: "입력하신 이메일이 유효하지 않습니다.", url: "입력하신 URL이 유효하지 않습니다.", number: "입력하신 전화번호가 올바르지 않습니다.", integer: "입력하신 URL이 유효하지 않습니다.", digits: "숫자를 입력하여 주십시오.", alphanum: "입력하신 내용은 알파벳과 숫자의 조합이어야 합니다." }, notblank: "공백은 입력하실 수 없습니다.", required: "필수 입력사항입니다.", pattern: "입력하신 내용이 올바르지 않습니다.", min: "입력하신 내용이 %s보다 크거나 같아야 합니다. ", max: "입력하신 내용이 %s보다 작거나 같아야 합니다.", range: "입력하신 내용이 %s보다 크고 %s 보다 작아야 합니다.", minlength: "%s 이상의 글자수를 입력하십시오. ", maxlength: "%s 이하의 글자수를 입력하십시오. ", length: "입력하신 내용의 글자수가 %s보다 크고 %s보다 작아야 합니다.", mincheck: "최소한 %s개를 선택하여 주십시오. ", maxcheck: "%s개 또는 그보다 적게 선택하여 주십시오.", check: "선택하신 내용이 %s보다 크거나 %s보다 작아야 합니다.", equalto: "같은 값을 입력하여 주십시오." }), void 0 !== window.ParsleyValidator && window.ParsleyValidator.addCatalog("ko", window.ParsleyConfig.i18n.ko, !0), define("parsleyjsko", ["parsleyjs"], function () { }), window.ParsleyConfig = window.ParsleyConfig || {}, window.ParsleyConfig.i18n = window.ParsleyConfig.i18n || {}, window.ParsleyConfig.i18n.ja = $.extend(window.ParsleyConfig.i18n.ja || {}, { defaultMessage: "無効な値です。", type: { email: "正しいメールアドレスを入力してください。", url: "正しいURLを入力してください。", number: "正しい数字を入力してください。", integer: "正しい数値を入力してください。", digits: "正しい桁数で入力してください。", alphanum: "正しい英数字を入力してください。" }, notblank: "この値を入力してください", required: "この値は必須です。", pattern: "この値は無効です。", min: "%s 以上の値にしてください。", max: "%s 以下の値にしてください。", range: "%s から %s の値にしてください。", minlength: "%s 文字以上で入力してください。", maxlength: "%s 文字以下で入力してください。", length: "%s から %s 文字の間で入力してください。", mincheck: "%s 個以上選択してください。", maxcheck: "%s 個以下選択してください。", check: "%s から %s 個選択してください。", equalto: "値が違います。" }), void 0 !== window.ParsleyValidator && window.ParsleyValidator.addCatalog("ja", window.ParsleyConfig.i18n.ja, !0), define("parsleyjsja", ["parsleyjs"], function () { }), window.ParsleyConfig = window.ParsleyConfig || {}, window.ParsleyConfig.i18n = window.ParsleyConfig.i18n || {}, window.ParsleyConfig.i18n.th = $.extend(window.ParsleyConfig.i18n.th || {}, { defaultMessage: "ค่านี้ดูเหมือนว่าจะไม่ถูกต้อง", type: { email: "ค่านี้ควรจะเป็นอีเมลที่ถูกต้อง", url: "ค่านี้ควรจะเป็น url ที่ถูกต้อง", number: "ค่านี้ควรจะเป็นตัวเลขที่ถูกต้อง", integer: "ค่านี้ควรจะเป็นจำนวนเต็มที่ถูกต้อง", digits: "ค่านี้ควรเป็นทศนิยมที่ถูกต้อง", alphanum: "ค่านี้ควรเป็นอักขระตัวอักษรหรือตัวเลขที่ถูกต้อง" }, notblank: "ค่านี้ไม่ควรจะว่าง", required: "ค่านี้จำเป็น", pattern: "ค่านี้ดูเหมือนว่าจะไม่ถูกต้อง", min: "ค่านี้ควรมากกว่าหรือเท่ากับ %s.", max: "ค่านี้ควรจะน้อยกว่าหรือเท่ากับ %s.", range: "ค่ายี้ควรจะอยู่ระหว่าง %s และ %s.", minlength: "ค่านี้สั้นเกินไป ควรจะมี %s อักขระหรือมากกว่า", maxlength: "ค่านี้ยาวเกินไป ควรจะมี %s อักขระหรือน้อยกว่า", length: "ความยาวของค่านี้ไม่ถูกต้อง ควรมีความยาวอยู่ระหว่าง %s และ %s อักขระ", mincheck: "คุณควรเลือกอย่างน้อย %s ตัวเลือก", maxcheck: "คุณควรเลือก %s ตัวเลือกหรือน้อยกว่า", check: "คุณควรเลือกระหว่าง %s และ %s ตัวเลือก", equalto: "ค่านี้ควรจะเหมือนกัน" }), void 0 !== window.ParsleyValidator && window.ParsleyValidator.addCatalog("th", window.ParsleyConfig.i18n.th, !0), define("parsleyjsth", ["parsleyjs"], function () { }), window.ParsleyConfig = window.ParsleyConfig || {}, window.ParsleyConfig.i18n = window.ParsleyConfig.i18n || {}, window.ParsleyConfig.i18n.fr = $.extend(window.ParsleyConfig.i18n.fr || {}, { defaultMessage: "Cette valeur semble non valide.", type: { email: "Cette valeur n'est pas une adresse email valide.", url: "Cette valeur n'est pas une URL valide.", number: "Cette valeur doit être un nombre.", integer: "Cette valeur doit être un entier.", digits: "Cette valeur doit être numérique.", alphanum: "Cette valeur doit être alphanumérique." }, notblank: "Cette valeur ne peut pas être vide.", required: "Ce champ est requis.", pattern: "Cette valeur semble non valide.", min: "Cette valeur ne doit pas être inférieure à %s.", max: "Cette valeur ne doit pas excéder %s.", range: "Cette valeur doit être comprise entre %s et %s.", minlength: "Cette chaîne est trop courte. Elle doit avoir au minimum %s caractères.", maxlength: "Cette chaîne est trop longue. Elle doit avoir au maximum %s caractères.", length: "Cette valeur doit contenir entre %s et %s caractères.", mincheck: "Vous devez sélectionner au moins %s choix.", maxcheck: "Vous devez sélectionner %s choix maximum.", check: "Vous devez sélectionner entre %s et %s choix.", equalto: "Cette valeur devrait être identique." }), void 0 !== window.ParsleyValidator && window.ParsleyValidator.addCatalog("fr", window.ParsleyConfig.i18n.fr, !0), define("parsleyjsfr", ["parsleyjs"], function () { }), window.ParsleyConfig = window.ParsleyConfig || {}, window.ParsleyConfig.i18n = window.ParsleyConfig.i18n || {}, window.ParsleyConfig.i18n.de = $.extend(window.ParsleyConfig.i18n.de || {}, { defaultMessage: "Die Eingabe scheint nicht korrekt zu sein.", type: { email: "Die Eingabe muss eine gültige E-Mail-Adresse sein.", url: "Die Eingabe muss eine gültige URL sein.", number: "Die Eingabe muss eine Zahl sein.", integer: "Die Eingabe muss eine Zahl sein.", digits: "Die Eingabe darf nur Ziffern enthalten.", alphanum: "Die Eingabe muss alphanumerisch sein." }, notblank: "Die Eingabe darf nicht leer sein.", required: "Dies ist ein Pflichtfeld.", pattern: "Die Eingabe scheint ungültig zu sein.", min: "Die Eingabe muss größer oder gleich %s sein.", max: "Die Eingabe muss kleiner oder gleich %s sein.", range: "Die Eingabe muss zwischen %s und %s liegen.", minlength: "Die Eingabe ist zu kurz. Es müssen mindestens %s Zeichen eingegeben werden.", maxlength: "Die Eingabe ist zu lang. Es dürfen höchstens %s Zeichen eingegeben werden.", length: "Die Länge der Eingabe ist ungültig. Es müssen zwischen %s und %s Zeichen eingegeben werden.", equalto: "Dieses Feld muss dem anderen entsprechen." }), void 0 !== window.ParsleyValidator && window.ParsleyValidator.addCatalog("de", window.ParsleyConfig.i18n.de, !0), define("parsleyjsde", ["parsleyjs"], function () { }), window.SfGather = new Gather(window.SfGather), define("sfgather", function () { }), define("utils/sfgather", ["backbone", "helper", "moment", "sfgather"], function (e, n) { var t; window._cmsConfig && (t = window._cmsConfig.sfgatherHost), t || (t = "http://10.202.109.3/json_data"), SfGather.init({ app_id: "cx", url: t, interval: 100 }), window.sfgather = { trackClicks: function (e, t) { var i = { event_id: t, event_name: e, nation: n.getSiteLocation(), language: n.getSiteLanguage(), phone_number: $.cookie("loginUser"), opera_time: moment().format("YYYY-MM-DD HH:mm:ss") }; SfGather.sendDataDirect(function () { }, i, 1) } }, $("body").delegate(".maidian", "click", function (e) { var t = $(e.currentTarget), i = t.data("md-name"), n = t.data("md-id"); sfgather.trackClicks(i, n) }) }), define("utils/stringUtils", [], function () { return "".startsWith || (String.prototype.startsWith = function (e) { return new RegExp("^" + e).test(this) }), "".endsWith || (String.prototype.endsWith = function (e) { return new RegExp(e + "$").test(this) }), { uuid: function (e, t) { var i, n, a = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""), s = []; if (t = t || a.length, e) for (i = 0; i < e; i++)s[i] = a[0 | Math.random() * t]; else for (s[8] = s[13] = s[18] = s[23] = "-", s[14] = "4", i = 0; i < 36; i++)s[i] || (n = 0 | 16 * Math.random(), s[i] = a[19 == i ? 3 & n | 8 : n]); return s.join("") }, numberToSensitive: function (e) { return e ? 10 < e.length ? e.substring(0, 3) + "****" + e.substring(e.length - 4) : e.length <= 10 && 4 <= e.length ? "******" + e.substring(e.length - 4) : "****" : "" }, nameToSensitive: function (e) { for (var t = e.substring(0, 1), i = 0; i < e.length - 1; i++)t += "*"; return t } } }), define("event", ["backbone", "underscore"], function (e, t) { var i = t.clone(e.Events); return i.RateSearch = "RateSearch", i.SwitchRateSearch = "SwitchRateSearch", i.OriginRegionChange = "OriginRegionChange", i.DestRegionChange = "DestRegionChange", i.DeliverySelectAll = "DeliverySelectAll", i.Needlogin = "Needlogin", i.RegisterLoginCallback = "RegisterLoginCallback", i.impNeedlogin = "impNeedlogin", i.nearlyBillCookied = "nearlyBillCookied", i }); var common = { getScript: ["", { dataType: "script", timeout: 1e4, basePath: "" }], getJson: ["", { dataType: "json", basePath: "" }], getexrate: "exrate", getAddrDistIdByName: "post:region/queryAddrDistIdByName", checkMonthAccount: ["post:cx/{account}/isCustomerCard", { async: !1 }], smsUserNotification: "post:sms/user/{mobile}/notification", getInternalRange: "region/{areaCode}/range", getGlobalRange: "region/{areaCode}/globalRange", getPayFee: "rate/newRates", bulkGetPayFee: "post:rate/list", getTencentUrl: "captcha/getJsUrl", verifyCodAccount: ["general/verifyCodAccount:new", { async: !1 }], analysisExcel: "post:address/analysisExcel:new", validBillNo: ["post:general/waybill/{waybillNo}/valid:new", { async: !1 }], coordinates: "general/networkstore/{geometryCodes}/coordinates:new", getCloudToken: ["user/memid/encrypt:new", { hideLoginModal: !0 }], isGrayUser: ["general/gray/query:new", { hideLoginModal: !0 }], getCityParentCode: ["post:general/address/getParentCode", { resLevel: 2 }] }, otherDynamic = { uploadClearancePic: "post:clearance/upload", uploadClearanceDoc: "post:clearance/clearanceImageUpload", uploadIdCard: "post:clearance/idCard/upload", feedBackUpload: "post:cx-wechat-member/member/feedBack/upload", postSuggestion: ["post:cx/suggestion/save", { resLevel: 2 }] }, gis = { getNearbyAddress: [_cmsConfig.gisDomain + "/rgeo/api", { dataType: "jsonp", jsonp: "cb", jsonpCallback: "__jp0", cache: !0 }], getDetailAddList: [_cmsConfig.gisDomain + "/tip/api", { dataType: "jsonp", jsonp: "cb", cache: !0 }], getLocalByAddress: [_cmsConfig.gisDomain + "/geo/api", { dataType: "jsonp", jsonp: "cb", jsonpCallback: "__cx", cache: !0 }] }, login = { login: "post:user/sms/login:new", qrLoginCheck: "user/qrcode/loginCheck:new", regist: "post:user/{mobile}/regist:new", logout: "post:user/logout:new" }, userCenter = { getUserInfo: "user/center/getUserInfo:new", getUserAvatar: "user/center/queryUserAvatar:new", bindMobile: "post:user/center/bindMobile:new", updateUserInfo: "post:user/center/updateUserInfo:new", checkMobile: "post:user/center/checkMobile:new" }, order = { submitNewOrder: "post:order/create:new", bulkSubmitNewOrder: "post:order/batch/create:new", bulkUpdateAppointBill: "post:appointment/list/updateOrder:new", submitQrNewOrder: "post:order/scan:new", validACSCountry: "post:order/acs/isValidCountry", subACSOrder: "post:order/acs/create", submitAcsBillNo: "post:order/acs/querySolrWaybillno", validAcsBillNo: ["post:order/acs/isValidSolrWaybillNo", { async: !1 }], goodsNameCheck: "order/goodsNameCheck", goodsNameAssociate: "order/goodsNameAssociate", queryCustomerControlStrategy: "post:order/cxQueryBpsInfo", queryBatchControlStrategy: "post:order/batch/cxQueryBpsInfo", queryOrderExceptionInfo: "cx/queryOrderExceptionInfo", batchQueryOrderExceptionInfo: "post:cx/batch/queryOrderExceptionInfo", bpsQueryOrderExceptionInfo: "post:order/queryBpsExceptionInfo", batchBpsQueryOrderExceptionInfo: "post:order/batch/queryBpsExceptionInfo", addressSplit: "post:order/orderAddressSplit", queryAddressRange: ["post:general/queryAddressRange:new", { async: !1, timeout: 2e3 }], batchQueryAddressRange: "post:general/batch/queryAddressRange:new", getCityWorkingTime: ["general/queryBusinessTime:new", { async: !1 }], getServerCurrentTime: ["order/syncServerTim", { async: !1 }] }, waybill = { getMemberSendBillInfo: "waybills/list/send:new", getMemberRecBillInfo: "waybills/list/rec:new", getBatchShipParentList: "waybills/batchShip/parent:new", getBatchShipChildList: "waybills/batchShip/child:new", getCourierInfo: ["general/emp/query:new", { resLevel: 2 }], getWayBillAddrList: "waybills/batchSip/{primaryNo}/addrList:new", getBillDetailByNum: "bills/{id}/route:new", cancelAppointmentBill: "post:appointment/cancel:new", queryAppointBill: ["appointment/{appointmentNo}/detail:new", { resLevel: 3 }], bulkQueryAppointBill: "appointment/{billList}/detail:new", updateAppointOrder: "post:appointment/updateOrder:new", deleteWayBill: ["post:appointment/delete:new", { resLevel: 1 }], routes: "bills/{billNumbers}/routes", electronicStub: "memberBills/{id}/getBillEleStub", signFigure: "memberBills/{id}/image", getWaybillDetails: ["waybills/{billNo}/detail:new", { hideLoginModal: !0 }], getLatestWaybills: "waybills/latest:new", evaluateCourier: "post:waybills/evaluation/courier:new", evaluateSF: "post:waybills/evaluation/sf:new", queryEvaluateCourier: "waybills/evaluation/queryCourier:new", queryEvaluateSF: "waybills/evaluation/querySf:new", queryAcceptableService: ["waybills/{billNo}/queryAcceptableService:new", { resLevel: 2 }], abnormalApply: ["post:waybills/abnormalApply:new", { resLevel: 1 }], getNetworkStore: "waybills/getNetworkStore:new" }, addressBook = { saveOrUpdateAddress: "post:address/save:new", bulkSaveOrUpdateAddress: "post:address/batch/save:new", compoundQueryAddressBook: "cx/compoundQuery", fetchAddressBookList: "address/list:new", deleteOneAddress: "post:address/{id}/delete:new", getAddressById: "address/{id}/query:new", saveToAddressBook: "post:address/save:new", setDefaultAddress: "post:cx/addressBook/updateDefaultAddress", fetchDefaultAndFirstAddress: "cx/addressBook/getDefaultAddress", uploadAddressBook: "post:address/importAddress" }, region = { getPopularRegions: "region/popularRegions", getRegions: "region/{code}/subRegions", getOriginRegions: "region/{code}/subRegions/origins", getDestRegions: "region/A000000000/subRegions/dests", getAddressByPointCode: "general/queryNetworkAddress:new" }, QRMode, QRErrorCorrectLevel, QRMaskPattern, QRUtil, QRMath, i; function QR8bitByte(e) { this.mode = QRMode.MODE_8BIT_BYTE, this.data = e } function QRCode(e, t) { this.typeNumber = e, this.errorCorrectLevel = t, this.modules = null, this.moduleCount = 0, this.dataCache = null, this.dataList = new Array } function QRPolynomial(e, t) { var i, n; if (null == e.length) throw new Error(e.length + "/" + t); for (i = 0; i < e.length && 0 == e[i];)i++; for (this.num = new Array(e.length - i + t), n = 0; n < e.length - i; n++)this.num[n] = e[n + i] } function QRRSBlock(e, t) { this.totalCount = e, this.dataCount = t } function QRBitBuffer() { this.buffer = new Array, this.length = 0 } for (_.extend(window.urlConfigs = {}, common, login, userCenter, order, waybill, addressBook, region, gis, otherDynamic), define("api/interface", function () { }), define("api/ajax", ["event", "helper", "./interface"], function (u, h) { var p = {}; var s = {}; function i(e, t, i) { var n = "get", a = "/sf-service-owf-web/service/"; t.startsWith("post:") && (n = "post", t = t.replace("post:", "")), t.endsWith(":new") && (a = "/sf-service-core-web/service/", t = t.replace(":new", "")), s[e] = function (e) { return function (t) { var e = { basePath: "", langRegion: { lang: h.getLang(), region: h.getSiteLocation(), translate: "hk" != h.getSiteLocation() && "tw" != h.getSiteLocation() || "tc" !== h.getSiteLanguage() ? "" : "tc" }, params: {} }; "http" === (t = _.extend({}, e, t)).url.substr(0, 4) && (t.basePath = "", t.langRegion = null), t.url = t.basePath + t.url; var i = t.url.match(/{(.+?)}/g); if (i && i.length) { var n = _.extend({}, t.data, t.params); for (var a in n) t.url = t.url.replace("{" + a + "}", n[a]); _.each(i, function (e) { e = e.substring(1, e.length - 1), t.data && delete t.data[e], t.params && delete t.params[e] }) } _.extend(t.params, t.langRegion || {}), "GET" === t.type.toUpperCase() ? (_.extend(t.params, t.data), t.data = null) : (void 0 === t.contentType && (t.contentType = "application/json;charset=UTF-8"), "string" == typeof t.contentType && -1 < t.contentType.indexOf("application/json") && (t.data = JSON.stringify(t.data))); var s = "?"; for (var r in t.params) s += r + "=" + t.params[r] + "&"; if (t.url += s.substring(0, s.length - 1), !0 === t.getUrl) return t.url; var o = t.success; t.success = function (e) { if (e && void 0 !== e.code && 121 == e.code && !t.hideLoginModal) return $.cookie("loginUser", "", { expires: -1, path: "/" }), void u.trigger(u.Needlogin, t.login); switch (t.resLevel) { case 1: e && 0 === e.code ? o && o(e.result, t.url) : l && l(e); break; case 2: e && 0 === e.code && e.result ? o && o(e.result, t.url) : l && l(e); break; case 3: e && 0 === e.code && e.result && e.result[0] && e.result[0].success ? o && o(e.result[0], t.url) : l && l(e); break; default: o && o(e, t.url) } }; var l = t.error; t.error = function (e) { l && l(e) }; var c = t.jsonpCallback, d = t.complete; if (t.complete = function (e) { d && d(e), "jsonp" === t.dataType && (p[c].shift(), p[c][0] && Backbone.ajax(p[c][0])) }, "jsonp" !== t.dataType) return Backbone.ajax(t); p[c] && p[c].length ? p[c].push(t) : (p[c] = [t], Backbone.ajax(t)) }(_.extend({ url: t, type: n, basePath: a }, i, e)) } } return Object.keys(window.urlConfigs).forEach(function (e) { var t = window.urlConfigs[e]; "string" == typeof t ? i(e, t) : "object" == typeof t && i(e, t[0], t[1]) }), window.sfAjax = s }), function (m, e) { "use strict"; var g, d, t, i, n = m.layui && layui.define, u = { getPath: (i = document.currentScript ? document.currentScript.src : function () { for (var e, t = document.scripts, i = t.length - 1, n = i; 0 < n; n--)if ("interactive" === t[n].readyState) { e = t[n].src; break } return e || t[i].src }(), i.substring(0, i.lastIndexOf("/") + 1)), config: {}, end: {}, minIndex: 0, minLeft: [], btn: ["&#x786E;&#x5B9A;", "&#x53D6;&#x6D88;"], type: ["dialog", "page", "iframe", "loading", "tips"], getStyle: function (e, t) { var i = e.currentStyle ? e.currentStyle : m.getComputedStyle(e, null); return i[i.getPropertyValue ? "getPropertyValue" : "getAttribute"](t) }, link: function (e, t, i) { if (_.path) { var n = document.getElementsByTagName("head")[0], a = document.createElement("link"); "string" == typeof t && (i = t); var s = "layuicss-" + (i || e).replace(/\.|\//g, ""), r = 0; a.rel = "stylesheet", a.href = _.path + e, a.id = s, document.getElementById(s) || n.appendChild(a), "function" == typeof t && function e() { return 80 < ++r ? m.console && void 0 : void (1989 === parseInt(u.getStyle(document.getElementById(s), "width")) ? t() : setTimeout(e, 100)) }() } } }, _ = { v: "3.1.1", ie: (t = navigator.userAgent.toLowerCase(), !!(m.ActiveXObject || "ActiveXObject" in m) && ((t.match(/msie\s(\d+)/) || [])[1] || "11")), index: m.layer && m.layer.v ? 1e5 : 0, path: u.getPath, config: function (e, t) { return e = e || {}, _.cache = u.config = g.extend({}, u.config, e), _.path = u.config.path || _.path, "string" == typeof e.extend && (e.extend = [e.extend]), u.config.path && _.ready(), e.extend && (n ? layui.addcss("modules/layer/" + e.extend) : u.link("theme/" + e.extend)), this }, ready: function (e) { var t = (n ? "modules/layer/" : "theme/") + "default/layer.css?v=" + _.v; return n ? layui.addcss(t, e, "layer") : u.link(t, e, "layer"), this }, alert: function (e, t, i) { var n = "function" == typeof t; return n && (i = t), _.open(g.extend({ content: e, yes: i }, n ? {} : t)) }, confirm: function (e, t, i, n) { var a = "function" == typeof t; return a && (n = i, i = t), _.open(g.extend({ content: e, btn: u.btn, yes: i, btn2: n }, a ? {} : t)) }, msg: function (e, t, i) { var n = "function" == typeof t, a = u.config.skin, s = (a ? a + " " + a + "-msg" : "") || "layui-layer-msg", r = c.anim.length - 1; return n && (i = t), _.open(g.extend({ content: e, time: 3e3, shade: !1, skin: s, title: !1, closeBtn: !1, btn: !1, resize: !1, end: i }, n && !u.config.skin ? { skin: s + " layui-layer-hui", anim: r } : ((-1 === (t = t || {}).icon || void 0 === t.icon && !u.config.skin) && (t.skin = s + " " + (t.skin || "layui-layer-hui")), t))) }, load: function (e, t) { return _.open(g.extend({ type: 3, icon: e || 0, resize: !1, shade: .01 }, t)) }, tips: function (e, t, i) { return _.open(g.extend({ type: 4, content: [e, t], closeBtn: !1, time: 3e3, shade: !1, resize: !1, fixed: !1, maxWidth: 210 }, i)) } }, a = function (e) { var t = this; t.index = ++_.index, t.config = g.extend({}, t.config, u.config, e), document.body ? t.creat() : setTimeout(function () { t.creat() }, 30) }; a.pt = a.prototype; var c = ["layui-layer", ".layui-layer-title", ".layui-layer-main", ".layui-layer-dialog", "layui-layer-iframe", "layui-layer-content", "layui-layer-btn", "layui-layer-close"]; c.anim = ["layer-anim-00", "layer-anim-01", "layer-anim-02", "layer-anim-03", "layer-anim-04", "layer-anim-05", "layer-anim-06"], a.pt.config = { type: 0, shade: .3, fixed: !0, move: c[1], title: "&#x4FE1;&#x606F;", offset: "auto", area: "auto", closeBtn: 1, time: 0, zIndex: 19891014, maxWidth: 360, anim: 0, isOutAnim: !0, icon: -1, moveType: 1, resize: !0, scrollbar: !0, tips: 2 }, a.pt.vessel = function (e, t) { var i, n = this.index, a = this.config, s = a.zIndex + n, r = "object" == typeof a.title, o = a.maxmin && (1 === a.type || 2 === a.type), l = a.title ? '<div class="layui-layer-title" style="' + (r ? a.title[1] : "") + '">' + (r ? a.title[0] : a.title) + "</div>" : ""; return a.zIndex = s, t([a.shade ? '<div class="layui-layer-shade" id="layui-layer-shade' + n + '" times="' + n + '" style="z-index:' + (s - 1) + '; "></div>' : "", '<div class="' + c[0] + " layui-layer-" + u.type[a.type] + (0 != a.type && 2 != a.type || a.shade ? "" : " layui-layer-border") + " " + (a.skin || "") + '" id="' + c[0] + n + '" type="' + u.type[a.type] + '" times="' + n + '" showtime="' + a.time + '" conType="' + (e ? "object" : "string") + '" style="z-index: ' + s + "; width:" + a.area[0] + ";height:" + a.area[1] + (a.fixed ? "" : ";position:absolute;") + '">' + (e && 2 != a.type ? "" : l) + '<div id="' + (a.id || "") + '" class="layui-layer-content' + (0 == a.type && -1 !== a.icon ? " layui-layer-padding" : "") + (3 == a.type ? " layui-layer-loading" + a.icon : "") + '">' + (0 == a.type && -1 !== a.icon ? '<i class="layui-layer-ico layui-layer-ico' + a.icon + '"></i>' : "") + (1 == a.type && e ? "" : a.content || "") + '</div><span class="layui-layer-setwin">' + (i = o ? '<a class="layui-layer-min" href="javascript:;"><cite></cite></a><a class="layui-layer-ico layui-layer-max" href="javascript:;"></a>' : "", a.closeBtn && (i += '<a class="layui-layer-ico ' + c[7] + " " + c[7] + (a.title ? a.closeBtn : 4 == a.type ? "1" : "2") + '" href="javascript:;"></a>'), i) + "</span>" + (a.btn ? function () { var e = ""; "string" == typeof a.btn && (a.btn = [a.btn]); for (var t = 0, i = a.btn.length; t < i; t++)e += '<a class="' + c[6] + t + '">' + a.btn[t] + "</a>"; return '<div class="' + c[6] + " layui-layer-btn-" + (a.btnAlign || "") + '">' + e + "</div>" }() : "") + (a.resize ? '<span class="layui-layer-resize"></span>' : "") + "</div>"], l, g('<div class="layui-layer-move"></div>')), this }, a.pt.creat = function () { var n = this, a = n.config, s = n.index, r = "object" == typeof (l = a.content), o = g("body"); if (!a.id || !g("#" + a.id)[0]) { switch ("string" == typeof a.area && (a.area = "auto" === a.area ? ["", ""] : [a.area, ""]), a.shift && (a.anim = a.shift), 6 == _.ie && (a.fixed = !1), a.type) { case 0: a.btn = "btn" in a ? a.btn : u.btn[0], _.closeAll("dialog"); break; case 2: var l = a.content = r ? a.content : [a.content || "http://layer.layui.com", "auto"]; a.content = '<iframe scrolling="' + (a.content[1] || "auto") + '" allowtransparency="true" id="' + c[4] + s + '" name="' + c[4] + s + '" onload="this.className=\'\';" class="layui-layer-load" frameborder="0" src="' + a.content[0] + '"></iframe>'; break; case 3: delete a.title, delete a.closeBtn, -1 === a.icon && a.icon, _.closeAll("loading"); break; case 4: r || (a.content = [a.content, "body"]), a.follow = a.content[1], a.content = a.content[0] + '<i class="layui-layer-TipsG"></i>', delete a.title, a.tips = "object" == typeof a.tips ? a.tips : [a.tips, !0], a.tipsMore || _.closeAll("tips") }if (n.vessel(r, function (e, t, i) { o.append(e[0]), r ? 2 == a.type || 4 == a.type ? g("body").append(e[1]) : l.parents("." + c[0])[0] || (l.data("display", l.css("display")).show().addClass("layui-layer-wrap").wrap(e[1]), g("#" + c[0] + s).find("." + c[5]).before(t)) : o.append(e[1]), g(".layui-layer-move")[0] || o.append(u.moveElem = i), n.layero = g("#" + c[0] + s), a.scrollbar || c.html.css("overflow", "hidden").attr("layer-full", s) }).auto(s), g("#layui-layer-shade" + n.index).css({ "background-color": a.shade[1] || "#000", opacity: a.shade[0] || a.shade }), 2 == a.type && 6 == _.ie && n.layero.find("iframe").attr("src", l[0]), 4 == a.type ? n.tips() : n.offset(), a.fixed && d.on("resize", function () { n.offset(), (/^\d+%$/.test(a.area[0]) || /^\d+%$/.test(a.area[1])) && n.auto(s), 4 == a.type && n.tips() }), a.time <= 0 || setTimeout(function () { _.close(n.index) }, a.time), n.move().callback(), c.anim[a.anim]) { var e = "layer-anim " + c.anim[a.anim]; n.layero.addClass(e).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend", function () { g(this).removeClass(e) }) } a.isOutAnim && n.layero.data("isOutAnim", !0) } }, a.pt.auto = function (e) { var t = this.config, i = g("#" + c[0] + e); "" === t.area[0] && 0 < t.maxWidth && (_.ie && _.ie < 8 && t.btn && i.width(i.innerWidth()), i.outerWidth() > t.maxWidth && i.width(t.maxWidth)); var n = [i.innerWidth(), i.innerHeight()], a = i.find(c[1]).outerHeight() || 0, s = i.find("." + c[6]).outerHeight() || 0, r = function (e) { (e = i.find(e)).height(n[1] - a - s - 2 * (0 | parseFloat(e.css("padding-top")))) }; switch (t.type) { case 2: r("iframe"); break; default: "" === t.area[1] ? 0 < t.maxHeight && i.outerHeight() > t.maxHeight ? (n[1] = t.maxHeight, r("." + c[5])) : t.fixed && n[1] >= d.height() && (n[1] = d.height(), r("." + c[5])) : r("." + c[5]) }return this }, a.pt.offset = function () { var e = this, t = e.config, i = e.layero, n = [i.outerWidth(), i.outerHeight()], a = "object" == typeof t.offset; e.offsetTop = (d.height() - n[1]) / 2, e.offsetLeft = (d.width() - n[0]) / 2, a ? (e.offsetTop = t.offset[0], e.offsetLeft = t.offset[1] || e.offsetLeft) : "auto" !== t.offset && ("t" === t.offset ? e.offsetTop = 0 : "r" === t.offset ? e.offsetLeft = d.width() - n[0] : "b" === t.offset ? e.offsetTop = d.height() - n[1] : "l" === t.offset ? e.offsetLeft = 0 : "lt" === t.offset ? (e.offsetTop = 0, e.offsetLeft = 0) : "lb" === t.offset ? (e.offsetTop = d.height() - n[1], e.offsetLeft = 0) : "rt" === t.offset ? (e.offsetTop = 0, e.offsetLeft = d.width() - n[0]) : "rb" === t.offset ? (e.offsetTop = d.height() - n[1], e.offsetLeft = d.width() - n[0]) : e.offsetTop = t.offset), t.fixed || (e.offsetTop = /%$/.test(e.offsetTop) ? d.height() * parseFloat(e.offsetTop) / 100 : parseFloat(e.offsetTop), e.offsetLeft = /%$/.test(e.offsetLeft) ? d.width() * parseFloat(e.offsetLeft) / 100 : parseFloat(e.offsetLeft), e.offsetTop += d.scrollTop(), e.offsetLeft += d.scrollLeft()), i.attr("minLeft") && (e.offsetTop = d.height() - (i.find(c[1]).outerHeight() || 0), e.offsetLeft = i.css("left")), i.css({ top: e.offsetTop, left: e.offsetLeft }) }, a.pt.tips = function () { var e = this.config, t = this.layero, i = [t.outerWidth(), t.outerHeight()], n = g(e.follow); n[0] || (n = g("body")); var a = { width: n.outerWidth(), height: n.outerHeight(), top: n.offset().top, left: n.offset().left }, s = t.find(".layui-layer-TipsG"), r = e.tips[0]; e.tips[1] || s.remove(), a.autoLeft = function () { 0 < a.left + i[0] - d.width() ? (a.tipLeft = a.left + a.width - i[0], s.css({ right: 12, left: "auto" })) : a.tipLeft = a.left }, a.where = [function () { a.autoLeft(), a.tipTop = a.top - i[1] - 10, s.removeClass("layui-layer-TipsB").addClass("layui-layer-TipsT").css("border-right-color", e.tips[1]) }, function () { a.tipLeft = a.left + a.width + 10, a.tipTop = a.top, s.removeClass("layui-layer-TipsL").addClass("layui-layer-TipsR").css("border-bottom-color", e.tips[1]) }, function () { a.autoLeft(), a.tipTop = a.top + a.height + 10, s.removeClass("layui-layer-TipsT").addClass("layui-layer-TipsB").css("border-right-color", e.tips[1]) }, function () { a.tipLeft = a.left - i[0] - 10, a.tipTop = a.top, s.removeClass("layui-layer-TipsR").addClass("layui-layer-TipsL").css("border-bottom-color", e.tips[1]) }], a.where[r - 1](), 1 === r ? a.top - (d.scrollTop() + i[1] + 16) < 0 && a.where[2]() : 2 === r ? 0 < d.width() - (a.left + a.width + i[0] + 16) || a.where[3]() : 3 === r ? 0 < a.top - d.scrollTop() + a.height + i[1] + 16 - d.height() && a.where[0]() : 4 === r && 0 < i[0] + 16 - a.left && a.where[1](), t.find("." + c[5]).css({ "background-color": e.tips[1], "padding-right": e.closeBtn ? "30px" : "" }), t.css({ left: a.tipLeft - (e.fixed ? d.scrollLeft() : 0), top: a.tipTop - (e.fixed ? d.scrollTop() : 0) }) }, a.pt.move = function () { var r = this, o = r.config, e = g(document), l = r.layero, t = l.find(o.move), i = l.find(".layui-layer-resize"), c = {}; return o.move && t.css("cursor", "move"), t.on("mousedown", function (e) { e.preventDefault(), o.move && (c.moveStart = !0, c.offset = [e.clientX - parseFloat(l.css("left")), e.clientY - parseFloat(l.css("top"))], u.moveElem.css("cursor", "move").show()) }), i.on("mousedown", function (e) { e.preventDefault(), c.resizeStart = !0, c.offset = [e.clientX, e.clientY], c.area = [l.outerWidth(), l.outerHeight()], u.moveElem.css("cursor", "se-resize").show() }), e.on("mousemove", function (e) { if (c.moveStart) { var t = e.clientX - c.offset[0], i = e.clientY - c.offset[1], n = "fixed" === l.css("position"); if (e.preventDefault(), c.stX = n ? 0 : d.scrollLeft(), c.stY = n ? 0 : d.scrollTop(), !o.moveOut) { var a = d.width() - l.outerWidth() + c.stX, s = d.height() - l.outerHeight() + c.stY; t < c.stX && (t = c.stX), a < t && (t = a), i < c.stY && (i = c.stY), s < i && (i = s) } l.css({ left: t, top: i }) } if (o.resize && c.resizeStart) { t = e.clientX - c.offset[0], i = e.clientY - c.offset[1]; e.preventDefault(), _.style(r.index, { width: c.area[0] + t, height: c.area[1] + i }), c.isResize = !0, o.resizing && o.resizing(l) } }).on("mouseup", function (e) { c.moveStart && (delete c.moveStart, u.moveElem.hide(), o.moveEnd && o.moveEnd(l)), c.resizeStart && (delete c.resizeStart, u.moveElem.hide()) }), r }, a.pt.callback = function () { var t = this, i = t.layero, n = t.config; t.openLayer(), n.success && (2 == n.type ? i.find("iframe").on("load", function () { n.success(i, t.index) }) : n.success(i, t.index)), 6 == _.ie && t.IE6(i), i.find("." + c[6]).children("a").on("click", function () { var e = g(this).index(); 0 === e ? n.yes ? n.yes(t.index, i) : n.btn1 ? n.btn1(t.index, i) : _.close(t.index) : !1 === (n["btn" + (e + 1)] && n["btn" + (e + 1)](t.index, i)) || _.close(t.index) }), i.find("." + c[7]).on("click", function () { !1 === (n.cancel && n.cancel(t.index, i)) || _.close(t.index) }), n.shadeClose && g("#layui-layer-shade" + t.index).on("click", function () { _.close(t.index) }), i.find(".layui-layer-min").on("click", function () { !1 === (n.min && n.min(i)) || _.min(t.index, n) }), i.find(".layui-layer-max").on("click", function () { g(this).hasClass("layui-layer-maxmin") ? (_.restore(t.index), n.restore && n.restore(i)) : (_.full(t.index, n), setTimeout(function () { n.full && n.full(i) }, 100)) }), n.end && (u.end[t.index] = n.end) }, u.reselect = function () { g.each(g("select"), function (e, t) { var i = g(this); i.parents("." + c[0])[0] || 1 == i.attr("layer") && g("." + c[0]).length < 1 && i.removeAttr("layer").show(), i = null }) }, a.pt.IE6 = function (e) { g("select").each(function (e, t) { var i = g(this); i.parents("." + c[0])[0] || "none" === i.css("display") || i.attr({ layer: "1" }).hide(), i = null }) }, a.pt.openLayer = function () { _.zIndex = this.config.zIndex, _.setTop = function (e) { return _.zIndex = parseInt(e[0].style.zIndex), e.on("mousedown", function () { _.zIndex++ , e.css("z-index", _.zIndex + 1) }), _.zIndex } }, u.record = function (e) { var t = [e.width(), e.height(), e.position().top, e.position().left + parseFloat(e.css("margin-left"))]; e.find(".layui-layer-max").addClass("layui-layer-maxmin"), e.attr({ area: t }) }, u.rescollbar = function (e) { c.html.attr("layer-full") == e && (c.html[0].style.removeProperty ? c.html[0].style.removeProperty("overflow") : c.html[0].style.removeAttribute("overflow"), c.html.removeAttr("layer-full")) }, (m.layer = _).getChildFrame = function (e, t) { return t = t || g("." + c[4]).attr("times"), g("#" + c[0] + t).find("iframe").contents().find(e) }, _.getFrameIndex = function (e) { return g("#" + e).parents("." + c[4]).attr("times") }, _.iframeAuto = function (e) { if (e) { var t = _.getChildFrame("html", e).outerHeight(), i = g("#" + c[0] + e), n = i.find(c[1]).outerHeight() || 0, a = i.find("." + c[6]).outerHeight() || 0; i.css({ height: t + n + a }), i.find("iframe").css({ height: t }) } }, _.iframeSrc = function (e, t) { g("#" + c[0] + e).find("iframe").attr("src", t) }, _.style = function (e, t, i) { var n = g("#" + c[0] + e), a = n.find(".layui-layer-content"), s = n.attr("type"), r = n.find(c[1]).outerHeight() || 0, o = n.find("." + c[6]).outerHeight() || 0; n.attr("minLeft"), s !== u.type[3] && s !== u.type[4] && (i || (parseFloat(t.width) <= 260 && (t.width = 260), parseFloat(t.height) - r - o <= 64 && (t.height = 64 + r + o)), n.css(t), o = n.find("." + c[6]).outerHeight(), s === u.type[2] ? n.find("iframe").css({ height: parseFloat(t.height) - r - o }) : a.css({ height: parseFloat(t.height) - r - o - parseFloat(a.css("padding-top")) - parseFloat(a.css("padding-bottom")) })) }, _.min = function (e, t) { var i = g("#" + c[0] + e), n = i.find(c[1]).outerHeight() || 0, a = i.attr("minLeft") || 181 * u.minIndex + "px", s = i.css("position"); u.record(i), u.minLeft[0] && (a = u.minLeft[0], u.minLeft.shift()), i.attr("position", s), _.style(e, { width: 180, height: n, left: a, top: d.height() - n, position: "fixed", overflow: "hidden" }, !0), i.find(".layui-layer-min").hide(), "page" === i.attr("type") && i.find(c[4]).hide(), u.rescollbar(e), i.attr("minLeft") || u.minIndex++ , i.attr("minLeft", a) }, _.restore = function (e) { var t = g("#" + c[0] + e), i = t.attr("area").split(","); t.attr("type"), _.style(e, { width: parseFloat(i[0]), height: parseFloat(i[1]), top: parseFloat(i[2]), left: parseFloat(i[3]), position: t.attr("position"), overflow: "visible" }, !0), t.find(".layui-layer-max").removeClass("layui-layer-maxmin"), t.find(".layui-layer-min").show(), "page" === t.attr("type") && t.find(c[4]).show(), u.rescollbar(e) }, _.full = function (t) { var e, i = g("#" + c[0] + t); u.record(i), c.html.attr("layer-full") || c.html.css("overflow", "hidden").attr("layer-full", t), clearTimeout(e), e = setTimeout(function () { var e = "fixed" === i.css("position"); _.style(t, { top: e ? 0 : d.scrollTop(), left: e ? 0 : d.scrollLeft(), width: d.width(), height: d.height() }, !0), i.find(".layui-layer-min").hide() }, 100) }, _.title = function (e, t) { g("#" + c[0] + (t || _.index)).find(c[1]).html(e) }, _.close = function (n) { var a = g("#" + c[0] + n), s = a.attr("type"); if (a[0]) { var r = "layui-layer-wrap", e = function () { if (s === u.type[1] && "object" === a.attr("conType")) { a.children(":not(." + c[5] + ")").remove(); for (var e = a.find("." + r), t = 0; t < 2; t++)e.unwrap(); e.css("display", e.data("display")).removeClass(r) } else { if (s === u.type[2]) try { var i = g("#" + c[4] + n)[0]; i.contentWindow.document.write(""), i.contentWindow.close(), a.find("." + c[5])[0].removeChild(i) } catch (e) { } a[0].innerHTML = "", a.remove() } "function" == typeof u.end[n] && u.end[n](), delete u.end[n] }; a.data("isOutAnim") && a.addClass("layer-anim layer-anim-close"), g("#layui-layer-moves, #layui-layer-shade" + n).remove(), 6 == _.ie && u.reselect(), u.rescollbar(n), a.attr("minLeft") && (u.minIndex-- , u.minLeft.push(a.attr("minLeft"))), _.ie && _.ie < 10 || !a.data("isOutAnim") ? e() : setTimeout(function () { e() }, 200) } }, _.closeAll = function (i) { g.each(g("." + c[0]), function () { var e = g(this), t = i ? e.attr("type") === i : 1; t && _.close(e.attr("times")), t = null }) }; var s = _.cache || {}, v = function (e) { return s.skin ? " " + s.skin + " " + s.skin + "-" + e : "" }; _.prompt = function (i, n) { var e = ""; if ("function" == typeof (i = i || {}) && (n = i), i.area) { var t = i.area; e = 'style="width: ' + t[0] + "; height: " + t[1] + ';"', delete i.area } var a, s = 2 == i.formType ? '<textarea class="layui-layer-input"' + e + ">" + (i.value || "") + "</textarea>" : '<input type="' + (1 == i.formType ? "password" : "text") + '" class="layui-layer-input" value="' + (i.value || "") + '">', r = i.success; return delete i.success, _.open(g.extend({ type: 1, btn: ["&#x786E;&#x5B9A;", "&#x53D6;&#x6D88;"], content: s, skin: "layui-layer-prompt" + v("prompt"), maxWidth: d.width(), success: function (e) { (a = e.find(".layui-layer-input")).focus(), "function" == typeof r && r(e) }, resize: !1, yes: function (e) { var t = a.val(); "" === t ? a.focus() : t.length > (i.maxlength || 500) ? _.tips("&#x6700;&#x591A;&#x8F93;&#x5165;" + (i.maxlength || 500) + "&#x4E2A;&#x5B57;&#x6570;", a, { tips: 1 }) : n && n(t, e, a) } }, i)) }, _.tab = function (a) { var n = (a = a || {}).tab || {}, s = "layui-this", i = a.success; return delete a.success, _.open(g.extend({ type: 1, skin: "layui-layer-tab" + v("tab"), resize: !1, title: function () { var e = n.length, t = 1, i = ""; if (0 < e) for (i = '<span class="' + s + '">' + n[0].title + "</span>"; t < e; t++)i += "<span>" + n[t].title + "</span>"; return i }(), content: '<ul class="layui-layer-tabmain">' + function () { var e = n.length, t = 1, i = ""; if (0 < e) for (i = '<li class="layui-layer-tabli ' + s + '">' + (n[0].content || "no content") + "</li>"; t < e; t++)i += '<li class="layui-layer-tabli">' + (n[t].content || "no  content") + "</li>"; return i }() + "</ul>", success: function (e) { var t = e.find(".layui-layer-title").children(), n = e.find(".layui-layer-tabmain").children(); t.on("mousedown", function (e) { e.stopPropagation ? e.stopPropagation() : e.cancelBubble = !0; var t = g(this), i = t.index(); t.addClass(s).siblings().removeClass(s), n.eq(i).show().siblings().hide(), "function" == typeof a.change && a.change(i) }), "function" == typeof i && i(e) } }, a)) }, _.photos = function (a, e, t) { var i, n, s, r, o = {}; if ((a = a || {}).photos) { var l = a.photos.constructor === Object, c = l ? a.photos : {}, d = c.data || [], u = c.start || 0; o.imgIndex = 1 + (0 | u), a.img = a.img || "img"; var h = a.success; if (delete a.success, l) { if (0 === d.length) return _.msg("&#x6CA1;&#x6709;&#x56FE;&#x7247;") } else { var p = g(a.photos), f = function () { d = [], p.find(a.img).each(function (e) { var t = g(this); t.attr("layer-index", e), d.push({ alt: t.attr("alt"), pid: t.attr("layer-pid"), src: t.attr("layer-src") || t.attr("src"), thumb: t.attr("src") }) }) }; if (f(), 0 === d.length) return; if (e || p.on("click", a.img, function () { var e = g(this).attr("layer-index"); _.photos(g.extend(a, { photos: { start: e, data: d, tab: a.tab }, full: a.full }), !0), f() }), !e) return } o.imgprev = function (e) { o.imgIndex-- , o.imgIndex < 1 && (o.imgIndex = d.length), o.tabimg(e) }, o.imgnext = function (e, t) { o.imgIndex++ , o.imgIndex > d.length && (o.imgIndex = 1, t) || o.tabimg(e) }, o.keyup = function (e) { if (!o.end) { var t = e.keyCode; e.preventDefault(), 37 === t ? o.imgprev(!0) : 39 === t ? o.imgnext(!0) : 27 === t && _.close(o.index) } }, o.tabimg = function (e) { if (!(d.length <= 1)) return c.start = o.imgIndex - 1, _.close(o.index), _.photos(a, !0, e) }, o.event = function () { o.bigimg.hover(function () { o.imgsee.show() }, function () { o.imgsee.hide() }), o.bigimg.find(".layui-layer-imgprev").on("click", function (e) { e.preventDefault(), o.imgprev() }), o.bigimg.find(".layui-layer-imgnext").on("click", function (e) { e.preventDefault(), o.imgnext() }), g(document).on("keyup", o.keyup) }, o.loadi = _.load(1, { shade: !("shade" in a) && .9, scrollbar: !1 }), i = d[u].src, n = function (n) { _.close(o.loadi), o.index = _.open(g.extend({ type: 1, id: "layui-layer-photos", area: function () { var e = [n.width, n.height], t = [g(m).width() - 100, g(m).height() - 100]; if (!a.full && (e[0] > t[0] || e[1] > t[1])) { var i = [e[0] / t[0], e[1] / t[1]]; i[1] < i[0] ? (e[0] = e[0] / i[0], e[1] = e[1] / i[0]) : i[0] < i[1] && (e[0] = e[0] / i[1], e[1] = e[1] / i[1]) } return [e[0] + "px", e[1] + "px"] }(), title: !1, shade: .9, shadeClose: !0, closeBtn: !1, move: ".layui-layer-phimg img", moveType: 1, scrollbar: !1, moveOut: !0, isOutAnim: !1, skin: "layui-layer-photos" + v("photos"), content: '<div class="layui-layer-phimg"><img src="' + d[u].src + '" alt="' + (d[u].alt || "") + '" layer-pid="' + d[u].pid + '"><div class="layui-layer-imgsee">' + (1 < d.length ? '<span class="layui-layer-imguide"><a href="javascript:;" class="layui-layer-iconext layui-layer-imgprev"></a><a href="javascript:;" class="layui-layer-iconext layui-layer-imgnext"></a></span>' : "") + '<div class="layui-layer-imgbar" style="display:' + (t ? "block" : "") + '"><span class="layui-layer-imgtit"><a href="javascript:;">' + (d[u].alt || "") + "</a><em>" + o.imgIndex + "/" + d.length + "</em></span></div></div></div>", success: function (e, t) { o.bigimg = e.find(".layui-layer-phimg"), o.imgsee = e.find(".layui-layer-imguide,.layui-layer-imgbar"), o.event(e), a.tab && a.tab(d[u], e), "function" == typeof h && h(e) }, end: function () { o.end = !0, g(document).off("keyup", o.keyup) } }, a)) }, s = function () { _.close(o.loadi), _.msg("&#x5F53;&#x524D;&#x56FE;&#x7247;&#x5730;&#x5740;&#x5F02;&#x5E38;<br>&#x662F;&#x5426;&#x7EE7;&#x7EED;&#x67E5;&#x770B;&#x4E0B;&#x4E00;&#x5F20;&#xFF1F;", { time: 3e4, btn: ["&#x4E0B;&#x4E00;&#x5F20;", "&#x4E0D;&#x770B;&#x4E86;"], yes: function () { 1 < d.length && o.imgnext(!0, !0) } }) }, (r = new Image).src = i, r.complete ? n(r) : (r.onload = function () { r.onload = null, n(r) }, r.onerror = function (e) { r.onerror = null, s(e) }) } }, u.run = function (e) { d = (g = e)(m), c.html = g("html"), _.open = function (e) { return new a(e).index } }, m.layui && layui.define ? (_.ready(), layui.define("jquery", function (e) { _.path = layui.cache.dir, u.run(layui.$), e("layer", m.layer = _) })) : "function" == typeof define && define.amd ? define("xlayer", ["jquery"], function () { return u.run(m.jQuery), _ }) : (u.run(m.jQuery), _.ready()) }(window), define("sflayer", ["xlayer"], function (r) { var o = function () { $(".layui-layer-btn a").on("click", function (e) { e.stopPropagation() }) }; return window.layer = { msg: function (e, t, i) { return r.msg(e, t, i) }, confirm: function (e, t, i, n) { "function" == typeof t && (n = i, i = t, t = {}), (t = _.extend({ title: _l("温馨提示"), resize: !1, move: !1 }, t)).skin = "sf-layer " + (t.skin || ""); var a = t.noStop; delete t.noStop; var s = r.confirm(e, t, i, n); return a || o(), s }, load: function (e, t) { return e = e || 0, t = _.extend({ shade: [.2, "#000"] }, t), r.load(e, t) }, close: function (e) { r.close(e) }, tips: function (e, t, i) { return r.tips(e, t, i) }, alert: function (e, t, i) { "function" == typeof t && (i = t, t = {}), (t = _.extend({ title: _l("温馨提示"), btn: [_l("确定")], resize: !1, move: !1 }, t)).skin = "sf-layer " + (t.skin || ""); var n = r.alert(e, t, i); return o(), n }, open: function (e) { return (e = _.extend({ type: 1, closeBtn: 1, resize: !1, move: !1 }, e)).skin = "sf-layer " + (e.skin || ""), r.open(e) }, title: function (e, t) { return r.title(e, t) } }, window.layer }), define("utils/i18n", ["helper", "api/ajax", "sflayer"], function (e) { var t = {}, n = {}, i = e.getSiteLocation(); sfAjax.getJson({ url: e.getResourceURL("i18n/i18n_universal.json"), async: !1, success: function (e) { e && (t = e) }, error: function () { layer.msg("国际化文件加载失败") } }), "hk" !== i && "tw" !== i && "cn" !== i && "us" !== i || sfAjax.getJson({ url: e.getResourceURL("i18n/i18n_" + i + ".json"), async: !1, success: function (e) { e && (n = _.extend(t, e)) }, error: function () { layer.msg("国际化文件加载失败") } }); var a = e.getSiteLanguage(), s = function (e, t) { if (n[e]) return n[e][a] || t || e; var i = window._ejsLabel; return i && i[e] ? i[e] : t || e }; return window._l = s }), define("utils/btnTip", [], function () { $("body").delegate(".btn-tip", "mouseenter", function (e) { var t = e.currentTarget, i = $(t).data("tip"); i && (t.tipIndex = layer.tips(_l(i), t, { tips: [1, "#333"], time: !1, tipsMore: !0, isOutAnim: !1 })) }), $("body").delegate(".btn-tip", "mouseleave", function (e) { var t = e.currentTarget.tipIndex; t && (layer.close(t), e.currentTarget.tipIndex = void 0) }) }), define("grayScale", ["helper", "api/ajax"], function (i) { function n(e, t) { t && "_blank" === t.target ? window.open(i.getDynamicURLWithContext(e)) : location.href = i.getDynamicURLWithContext(e) } window.jumpOrder = function (t) { "hk" === i.getSiteLocation() || "tw" === i.getSiteLocation() ? $.cookie("loginUser") ? sfAjax.isGrayUser({ data: { type: "hk" == i.getSiteLocation() ? 31 : "tw" == i.getSiteLocation() ? 34 : "" }, success: function (e) { 0 === e.code && !0 === e.result ? n("/order/quick/", { target: t }) : n("/send_introduced/quick/", { target: t }) }, error: function () { n("/send_introduced/quick/", { target: t }) } }) : n("/send_introduced/quick/", { target: t }) : n("/order/quick/", { target: t }) } }), define("initialSetups", ["underscore.string", "helper", "moment", "jquery", "jquery-ui", "jquery-placeholder", "momenttc", "momentko", "momentja", "momentru", "momentvn", "momentth", "momentde", "momentfr", "momentcn", "parsleyjs", "parsleyjssc", "parsleyjstc", "parsleyjsko", "parsleyjsja", "parsleyjsth", "parsleyjsfr", "parsleyjsde", "utils/sfgather", "utils/stringUtils", "utils/i18n", "utils/btnTip", "grayScale", "sflayer"], function (e, t, i, n) { window.ORDER_SYMBOLS = "abcdefghigklmnopqrstuvwxyz", window.ParsleyValidator.setLocale(t.getParsleyLanguage()), window.cache = {}, window.console || (window.console = { log: function () { } }); var a = _.indexOf; _.indexOf = function (e, t, i) { return "string" == typeof e ? e.indexOf(t) : a(e, t, i) }, String.prototype.trim || (String.prototype.trim = function () { return this.replace(/^\s+|\s+$/gm, "") }), n("input, textarea").placeholder(), String.prototype.commaReplace = function () { return this.replace(/\uFF0C/g, ",") }, _.str = e, _.mixin(_.str.exports()), n.ajaxSetup({ data: { lang: t.getLang(), region: t.getSiteLocation(), translate: "hk" != t.getSiteLocation() && "tw" != t.getSiteLocation() || "tc" !== t.getSiteLanguage() ? "" : "tc" }, cache: !t.isIE() }), window._p = _.sprintf, window.Helper = t, String.prototype._p = function (e) { var t = this; for (var i in e) t = t.replace("${" + i + "}", e[i]); return t }, String.prototype.gblen = function () { for (var e = 0, t = 0; t < this.length; t++)0 <= this.charCodeAt(t) && this.charCodeAt(t) <= 128 ? e++ : e += 2; return e }; var s = n("#cnnic-link"); if (s) { var r = s.attr("href"), o = "000000" + Math.round(1e6 * Math.random()); o = o.substr(o.length - 6), s.attr("href", _p(r, o)) } function l() { if (n(this).hasClass("disabled")) return !1 } function c(e) { e.hasClass("disabled") && !e.data("binded-click") && (e.on("click", l), e.data("binded-click", !0)) } n(window).on("beforeunload", function () { n(".detail-location-input input").each(function () { this.value = "" }) }), i.lang(t.getStandardLocale()), n(window.document).on("mouseup", "button", function () { c(n(this)) }), n(window.document).on("keydown", "form", function (e) { var t; 13 === e.keyCode && (c(n(this).find("button")), (t = n(e.currentTarget)).data("binded-enter") || (t.on("keyup", function (e) { if (13 === e.keyCode) return e.stopPropagation(), !1 }), t.data("binded-enter", !0))) }), n(window.document).on("keydown", ".weixin", function (e) { 13 === e.keyCode && (n(this).hasClass("hover") ? n(this).removeClass("hover").attr("aria-expanded", !1) : n(this).addClass("hover").attr("aria-expanded", !0)) }), n(window.document).on("keydown", ".accessible-click", function (e) { if (13 === e.keyCode) return e.preventDefault(), n(this).trigger("click"), !1 }) }), define("utils/grayScale", ["helper", "api/ajax"], function (e) { return { GRAY_TYPE: { HK_ORDER: 31, TW_ORDER: 34 }, isScale: function (e) { var t = $.Deferred(); return $.cookie("loginUser") ? sfAjax.isGrayUser({ data: { type: e }, success: function (e) { 0 === e.code && !0 === e.result ? t.resolve() : t.reject() }, error: function () { t.reject() } }) : setTimeout(function () { t.reject() }), t } } }), define("baseView", ["backbone", "utils/stringUtils", "sflayer", "utils/grayScale"], function (e, s, r, t) { return e.View.extend({ mixins: [], internation: {}, layerOpts: {}, initialize: function (e) { var t = this; if (!e.el) { this.layerOpts.cancel && (this.layerOpts.cancel = this.layerOpts.cancel.bind(t)); var i = "open-" + s.uuid(10), n = "<div class=" + i + "></div>", a = _.extend({}, { cancel: function () { t.remove() } }, this.layerOpts, { content: n }); this.layerIndex = r.open(a), this.$el = $("." + i) } this.internationMixin(), this.interceptor ? this.interceptor.run().done(function () { t._init(e) }) : this._init(e), $(window).resize() }, _init: function (e) { var t = this; this.init(e), this.handlerMixin(), this.render(), this.mounted(), _.each(this.mixins, function (e) { e.mounted && e.mounted.call(t) }) }, init: function () { }, render: function () { }, mounted: function () { }, internationMixin: function () { _.extend(this, this.internation[Helper.getSiteLocation()] || {}) }, handlerMixin: function () { var t = this; _.each(this.mixins, function (e) { _.extend(t.events, e.events), _.extend(t, e.methods) }) }, close: function () { r.close(this.layerIndex) }, isLocked: function (e) { if (e) { var t = e.currentTarget || e; if ($(t).hasClass("disabled")) return !0; $(t).toggleClass("disabled", !0) } }, unlock: function (e) { if (e) { var t = e.currentTarget || e; $(t).toggleClass("disabled", !1) } } }) }), define("templates", [], function () { return this.JST = this.JST || {}, this.JST.acsBillConfirm = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="billConfirm"><h3 class="top-title">' + __e(_l("订单确认")), freightFee && (__p += "<small>" + __e(_l("运费")) + ' <span class="red">' + (null == (__t = freightFee) ? "" : __t) + "HKD</span></small></h3>"), __p += "<h4>" + __e(_l("运单号")) + " " + (null == (__t = acsBillNo) ? "" : __t) + '</h4><div class="row"><div class="col-xs-12 title">' + __e(_l("寄件人")) + '</div></div><div class="row"><div class="col-xs-6">' + __e(_l("姓名")) + "：" + (null == (__t = sender.contact) ? "" : __t) + '</div><div class="col-xs-6">' + __e(_l("联络电邮")) + "：" + (null == (__t = sender.email) ? "" : __t) + '</div><div class="col-xs-6">' + __e(_l("电话号码")) + "：" + (null == (__t = sender.mobile) ? "" : __t) + "</div>", isReceiverHK && (__p += '<div class="col-xs-6">' + __e(_l("托寄物")) + "：" + (null == (__t = cargoList.name) ? "" : __t) + "</div>"), __p += '<div class="col-xs-12">' + __e(_l("留港期间地址")) + "：" + (null == (__t = _.uniq(_.compact([sender.addrInfo.province, sender.addrInfo.city, sender.addrInfo.county, sender.addrInfo.address]), !0).join("")) ? "" : __t) + '</div></div><div class="row"><div class="col-xs-12 title">' + __e(_l("收件人")) + '</div></div><div class="row"><div class="col-xs-6">' + __e(_l("姓名")) + "：" + (null == (__t = receiver.contact) ? "" : __t) + '</div><div class="col-xs-6">' + __e(_l("联络电邮")) + "：" + (null == (__t = receiver.email) ? "" : __t) + '</div><div class="col-xs-6">' + __e(_l("电话号码")) + "：" + (null == (__t = receiver.mobile) ? "" : __t) + "</div>", receiver.addrInfo.postalCode && (__p += '<div class="col-xs-6">' + __e(_l("邮政编号")) + "：" + (null == (__t = receiver.addrInfo.postalCode) ? "" : __t) + "</div>"), __p += '<div class="col-xs-12">' + __e(_l("上门地址")) + "：" + (null == (__t = _.uniq(_.compact([receiverCountry, receiver.addrInfo.province, receiver.addrInfo.city, receiver.addrInfo.county, receiver.addrInfo.address]), !0).join("")) ? "" : __t) + "</div></div>", isReceiverHK || (__p += '<div class="row"><div class="col-xs-12 title">' + __e(_l("报关信息")) + '</div></div><div class="row"><div class="col-xs-12">' + __e(_l("文件")) + "：" + (null == (__t = "en" == Helper.getSiteLanguage() && cargoList.englishName ? cargoList.englishName : cargoList.name) ? "" : __t) + '</div><div class="col-xs-12">' + __e(_l("价值")) + "：" + (null == (__t = cargoList.price) ? "" : __t) + (null == (__t = "en" == Helper.getSiteLanguage() ? cargoList.currency : cargoList.currencyCn) ? "" : __t) + '</div><div class="col-xs-12">' + __e(_l("单位")) + "：" + (null == (__t = cargoList.uom) ? "" : __t) + '</div><div class="col-xs-12">' + __e(_l("原产地")) + "：" + (null == (__t = cargoList.origin) ? "" : __t) + "</div></div>"), isReceiverHKorMACAO && (__p += '<div class="row"><div class="col-xs-12 title">' + __e(_l("支付方式")) + '</div></div><div class="row pay-type"><div class="col-xs-12"><a href="javascript:void(0)" class="aicon-checked" data-type="1">' + __e(_l("寄付")) + '</a></div><div class="col-xs-12"><a href="javascript:void(0)" class="aicon-check-Unseleted-x" data-type="2">' + __e(_l("到付")) + "</a></div></div>"), __p += '<div class="submitWrapper"><button type="button" class="primary-button go-back">' + __e(_l("返回")) + '</button><button type="button" class="primary-button submit-order">' + __e(_l("确认订单")) + "</button></div></div>"; return __p }, this.JST.acsBillInfoFill = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="billInfoFill"><h4>' + __e(_l("运单号")) + " <span>" + (null == (__t = acsBillNo) ? "" : __t) + '</span></h4><div class="row"><div class="col-xs-12 title">' + __e(_l("寄件人")) + ' <span class="fr">*' + __e(_l("为必填")) + '</span></div></div><form class="form-horizontal sender-form"><div class="form-group text"><div class="col-xs-4 require form-label">' + __e(_l("姓名")) + '</div><div class="col-xs-4 require form-label">' + __e(_l("电话号码")) + '</div><div class="col-xs-4 require form-label">' + __e(_l("联络电邮")) + '</div></div><div class="form-group input"><div class="col-xs-4"><input type="text" class="form-control" placeholder="' + __e(_l("请输入寄件人姓名")) + '" id="sender-name" name="sender-name" data-parsley-maxlength="20" data-parsley-required></div><div class="col-xs-4"><input type="text" class="form-control" placeholder="' + __e(_l("请输入电话号码")) + '" id="sender-mobile" name="sender-mobile" data-parsley-required data-parsley-pattern-message="' + __e(_l("您输入的手机号码格式不正确，请重新输入。")) + '" data-parsley-pattern="' + __e(telReg) + '"></div><div class="col-xs-4"><input type="text" class="form-control" placeholder="' + __e(_l("请输入电邮")) + '" id="sender-mail" name="sender-mail" data-parsley-required data-parsley-pattern-message="' + __e(_l("您输入的电邮格式不正确，请重新输入。")) + '" data-parsley-pattern="' + __e(emailReg) + '"></div></div><div class="form-group text"><div class="col-xs-12 require form-label">' + __e(_l("留港期间地址")) + '</div></div><div class="form-group input"><div class="col-xs-12 sender-location location-inputs normal-inputs"><div class="detail-location-input" data-max-level="4" data-hide-area-tab="true" data-hide-macao="true" data-hide-tw="true" data-selected-area="hongkong"><input type="text" class="form-control accessible-click sender-ascbillinfo" readonly data-parsley-required readyonly placeholder="' + __e(_l("请选择所在地区，例如：广东省－深圳市－福田区")) + '"/></div></div></div><div class="form-group text"><div class="col-xs-8 require form-label">' + __e(_l("详细地址")) + '</div></div><div class="form-group input"><div class="col-xs-8"><input type="text" class="form-control" id="sender-address-detail" data-parsley-required placeholder="' + __e(_l("请填写所在街道以及详细地址")) + '"/></div></div></form><div class="row"><div class="col-xs-12 title">' + __e(_l("收件人")) + ' <span class="fr">*' + __e(_l("为必填")) + '</span></div></div><form class="form-horizontal receiver-form"><div class="form-group text"><div class="col-xs-4 require form-label">' + __e(_l("姓名")) + '</div><div class="col-xs-4 require form-label">' + __e(_l("电话号码")) + '</div><div class="col-xs-4 require form-label">' + __e(_l("联络电邮")) + '</div></div><div class="form-group input"><div class="col-xs-4"><input type="text" class="form-control" placeholder="' + __e(_l("请输入收件人姓名")) + '" id="receiver-name" name="receiver-name" data-parsley-maxlength="20" data-parsley-required></div><div class="col-xs-4"><input type="text" class="form-control" placeholder="' + __e(_l("请输入电话号码")) + '" id="receiver-mobile" name="receiver-mobile" data-parsley-required data-parsley-pattern-message="' + __e(_l("您输入的手机号码格式不正确，请重新输入。")) + '" data-parsley-pattern="' + __e(telReg) + '"></div><div class="col-xs-4"><input type="text" class="form-control" placeholder="' + __e(_l("请输入电邮")) + '" id="receiver-mail" name="receiver-mail" data-parsley-required data-parsley-pattern-message="' + __e(_l("您输入的电邮格式不正确，请重新输入。")) + '" data-parsley-pattern="' + __e(emailReg) + '"></div></div><div class="form-group text"><div class="col-xs-12 require form-label">' + __e(_l("上门地址")) + '</div></div><div class="form-group input"><div class="col-xs-12 receiver-location location-inputs normal-inputs"><div class="detail-location-input" data-max-level="4" data-hide-hk="false"><input type="text" class="form-control accessible-click receiver-ascbillinfo" data-parsley-required readonly data-parsley-trigger="change" placeholder="' + __e(_l("请选择所在地区，例如：广东省－深圳市－福田区")) + '" disabled="disabled"/></div></div></div><div class="form-group text"><div class="col-xs-8 require form-label">' + __e(_l("详细地址")) + '</div><div class="col-xs-4 form-label receiver-postcode">' + __e(_l("邮政编号")) + '</div></div><div class="form-group input"><div class="col-xs-8"><input type="text" class="form-control" id="receiver-address-detail" data-parsley-required placeholder="' + __e(_l("请填写所在街道以及详细地址")) + '"/></div><div class="col-xs-4 receiver-postcode"><input type="text" class="form-control" placeholder="' + __e(_l("请输入邮政编号")) + '" id="receiver-postcode" name="receiver-postcode" data-parsley-pattern-message="' + __e(_l("您输入的邮编格式不正确，请重新输入。")) + '" data-parsley-pattern="' + __e(postcodeReg) + '"></div></div></form><div class="receiver-item"><div class="row"><div class="col-xs-12 title">' + __e(_l("托寄物内容")) + '<p class="fr freightFeeWrapper"><span class="freightFee"></span> ' + __e(_l("预计")) + '</p></div></div><div class="row"><ul class="col-xs-12 receiver-item-menu"><li><a class="aicon-checked" href="javascript:void(0)">' + __e(_l("酒类/液体")) + '</a></li><li><a href="javascript:void(0)" class="aicon-check-Unseleted-x">' + __e(_l("乳霜/液/唇膏")) + '</a></li><li><a href="javascript:void(0)" class="aicon-check-Unseleted-x">' + __e(_l("香水/护肤产品")) + '</a></li><li><a href="javascript:void(0)" class="aicon-check-Unseleted-x">' + __e(_l("凝胶")) + '</a></li><li><a href="javascript:void(0)" class="aicon-check-Unseleted-x">' + __e(_l("指甲钳/剃刀")) + '</a></li><li><a href="javascript:void(0)" class="aicon-check-Unseleted-x">' + __e(_l("膏状物品")) + '</a></li><li><a href="javascript:void(0)" class="others-item aicon-check-Unseleted-x">' + __e(_l("其他")) + '<input type="text" class="form-control other-item-input" placeholder="' + __e(_l("请输入其他物品")) + '"></a></li></ul></div></div><div class="declare"><div class="row"><div class="col-xs-12 title">' + __e(_l("报关信息")) + '<p class="fr freightFeeWrapper"><span class="freightFee"></span> ' + __e(_l("预计")) + '</p></div></div><div class="declare-content"></div><div class="form-horizontal countryOfOrigin"><div class="form-group"><label class="control-label col-xs-3">' + __e(_l("原产地")) + '：</label><div class="col-xs-3"><select class="form-control" id="recommendCountrys"></select></div><div class="col-xs-3 orther-contry"><input type="text" class="form-control" placeholder="' + __e(_l("请选择原产地")) + '"></div></div><div class="form-group error country-err"><div class="col-xs-3 col-xs-offset-6">' + __e(_l("请输入正确原产地名称")) + '</div></div><div class="form-group error network-err"><div class="col-xs-3 col-xs-offset-6">' + __e(_l("网络故障，请稍后重试")) + '</div></div><div class="form-group error country-empty"><div class="col-xs-3 col-xs-offset-6">' + __e(_l("必填项")) + '</div></div></div></div><div class="submitWrapper"><button type="button" class="primary-button confirm-order">' + __e(_l("提交")) + '</button></div></div><div class="confirmWrapper"></div>'; return __p }, this.JST.acsBillInput = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="billInputWrapper"><h3 class="title">' + __e(_l("请输入运单号")) + '</h3><form class="billInput" onSubmit="return false;"><input type="text" id="acsBillNo" placeholder="' + __e(_l("请输入以468开头的运单号")) + '" class="form-control" data-parsley-maxlength="12" data-parsley-required data-parsley-pattern="^468\\d{9}$" data-parsley-pattern-message="' + __e(_l("请输入有效运单号码")) + '"><button type="submit" class="primary-button submit-acs disabled">' + __e(_l("继续")) + '</button></form><div class="error" data-error="billno-used">' + __e(_l("运单号已使用")) + '</div><div class="error" data-error="billno-invalid">' + __e(_l("运单号无效")) + '</div><div class="error" data-error="network">' + __e(_l("网络故障，请稍后重试。")) + '</div><div class="tip"><span class="aicon-circle-check toggleChecked checked"></span><span>' + __e(_l('按下"继续"按钮即同意阁下资料将被储存作机场速运服务派送之用')) + "</span></div></div>"; return __p }, this.JST.acsBillState = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="billState"><img src="' + (null == (__t = imgUrl) ? "" : __t) + '" alt="支付状态图片">', 1 == type ? __p += '<div class="title">' + __e(_l("感谢您使用机场速运服务")) + "</div><p>" + __e(_l("确认电邮将发送到你的登记电邮；")) + "</p>" : 2 == type ? __p += '<div class="title">' + __e(_l("支付失败")) + "</div><p>" + __e(_l("很抱歉未能支付成功；")) + "</p>" : 3 == type && (__p += '<div class="title">' + __e(_l("取消支付")) + "</div>"), __p += "<p>" + __e(_l("如有任何查询，请致电客户服务热线")) + "</p><p>+852 2541 2542 (" + __e(_l("香港")) + ")</p>", 2 != type && 3 != type || (__p += '<div class="submitWrapper"><button type="button" class="primary-button pay-again">' + __e(_l("再试一次")) + "</button></div>"), __p += "</div>"; return __p }, this.JST.dropdownRecommendCountrys = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) _.each(dropdownItems, function (e) { __p += '<option value="' + __e(e.code) + '">' + __e(e[Helper.getSiteLanguage() + "Name"]) + "</option>" }), __p += '<option value="ORTHERS">' + __e(_l("其他")) + "</option>"; return __p }, this.JST.addressBook = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="adds-book"><div class="clearfix"><form class="search-form fl"><div class="input-wrapper clearfix"><span class="aicon-search"></span><input type="text" class="form-control search-input" name="searchParm" placeholder="' + __e(_l("请输入姓名/电话查询")) + '"><button class="search primary-btn square small" type="submit">' + __e(_l("搜索")) + '</button></div></form><button type="button" class="primary-btn white square add fr"><span class="aicon-zengjia-01"></span>' + __e(_l("新增地址")) + '</button></div><ul class="table-title">', hasSelectAll && (__p += '<a href="javascript:void(0)" class="selectAll aicon-uncheck"></a>'), __p += '<li style="width: 30%">' + __e(_l("联系人")) + '</li><li style="width: 30%">' + __e(_l("地址")) + '</li><li style="width: 20%">' + __e(_l("公司名称")) + '</li><li style="width: 20%">' + __e(_l("操作")) + '</li></ul><div class="height-scroll table-wrapper"><dl class="address_loading"><dt><img src="' + __e(loadingImg) + '" alt=""></dt><dd><h5>' + __e(_l("正在加载...")) + '</h5></dd></dl><dl class="address_networkErr" style="display: none"><dt><span class="aicon-28 img"></span></dt><dd><h5>' + __e(_l("加载异常，请刷新重试")) + '</h5></dd><dd><button type="button" class="primary-btn try-again autowidth">' + __e(_l("重试")) + '</button></dd></dl><dl class="address_fetch_null" style="display: none"><dt><span class="aicon-emptybox img"></span></dt><dd><h5>' + __e(_l("地址为空")) + "</h5></dd><dd><p>" + __e(_l("您可先添加一条地址信息")) + '</p></dd></dl><dl class="address_search_null" style="display: none"><dt><span class="aicon-emptylist img"></span></dt><dd><p>' + __e(_l("暂时木有内容呀...")) + '</p></dd></dl></div><div class="fix-height"><div class="hide-in-loading"><div class="bootstrap-pagination"><ul class="pagination"></ul></div><p style="text-align: center"><button type="button" class="primary-btn autowidth select-confirm">' + __e(_l("确认选择")) + "</button></p></div></div></div>"; return __p }, this.JST.addressBookaddOrmod_hk = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<form class="form-horizontal address-form"><div class="form-group"><label class="control-label col-xs-3 required" for="add-name">' + __e(_l("姓名")) + ' :</label><div class="col-xs-9"><input type="text" class="form-control" id="add-name" name="add-name" placeholder="' + __e(_l("请输入姓名")) + '"value="' + __e(addressBook ? addressBook.contactName : "") + '" data-parsley-required></div></div><div class="form-group"><label class="control-label col-xs-3" for="add-company">' + __e(_l("公司名称")) + ' :</label><div class="col-xs-9"><input type="text" class="form-control" id="add-company" name="add-company" placeholder="' + __e(_l("请输入公司名称")) + '"value="' + __e(addressBook ? addressBook.companyName : "") + '"data-parsley-maxlength="20"></div></div><div class="form-group"><label class="control-label col-xs-3 required" for="add-address">' + __e(_l("地址")) + ' :</label><div class="col-xs-9 add-address-container"><div class="detail-location-input" data-max-level="4" data-hide-area-tab="true" data-do-restore-state="false" data-only-current-tab="true"><input type="text" class="form-control readonly" data-parsley-required readonly id="add-address" name="add-address" style="border:1px solid #ccc"data-parsley-trigger="change"data-parsley-errors-container=".add-address-container"placeholder="' + __e(_l("请选择所在地区，例如：香港-香港岛")) + '"value="' + __e(addressBook ? _.uniq(_.compact([addressBook.province, addressBook.city, addressBook.county]), !0).join("-") : "") + '"></div></div></div><div class="form-group"><div class="col-xs-9 col-xs-offset-3"><input type="text" class="form-control" id="add-detailaddress" name="add-detailaddress" data-parsley-required placeholder="' + __e(_l("请填写所在街道以及详细地址")) + '"value="' + __e(addressBook ? addressBook.address : "") + '"></div></div><div class="form-group"><label class="control-label col-xs-3" for="add-mobile">' + __e(_l("手机")) + ' :</label><div class="col-xs-9"><input type="text" class="form-control" id="add-mobile" name="add-mobile" placeholder="' + __e(_l("请输入手机号码")) + '"value="' + __e(addressBook ? addressBook.contactTel : "") + '"data-parsley-trigger="change" data-parsley-pattern-message="' + __e(_l("您输入的手机号码格式不正确，请重新输入。")) + '" data-parsley-pattern="^((\\+86)|(86))?1\\d{10}$|^((\\+852)|(852))?\\d{8}$"></div></div><div class="form-group"><label class="control-label col-xs-3" for="add-phone">' + __e(_l("电话")) + ' :</label><div class="col-xs-9"><input type="text" class="form-control" id="add-phone" name="add-phone" placeholder="' + __e(_l("请输入电话")) + '"value="' + __e(addressBook ? addressBook.contactPhone : "") + '"data-parsley-trigger="change" data-parsley-pattern-message="' + __e(_l("您输入的固话号码格式不正确，请重新输入。")) + '" data-parsley-pattern="^((\\d{7,8})|(0\\d{2,3})-?(\\d{7,8})|(0\\d{2,3})-?(\\d{7,8})-?(\\d{0,7})|(\\d{7,8})-?(\\d{0,7}))$"></div></div><div class="form-group receiver-both-phone-mobile error"><div class="col-xs-9 col-xs-offset-3"><p>' + __e(_l("手机和电话请至少填写一项")) + '</p></div></div><div class="form-group save-fail error"><div class="col-xs-9 col-xs-offset-3"><p>' + __e(_l("保存失败，请重试")) + '</p></div></div><div style="text-align: center"><button type="button" class="primary-button save-address" data-loading-text="' + __e(_l("保存中...")) + '" data-addressid="' + __e(addressBook ? addressBook.addressId : "") + '">' + __e(_l("保存")) + "</button></div></form>"; return __p }, this.JST.addressBookEdit = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<form class="form-horizontal add-book-edit ui-front"><div class="intellect-warm-reminder">' + __e(_l("请检查拆分地址信息是否准确，如有遗漏请及时补充")) + '</div><div class="sftitle">' + __e(_l("联系人信息")) + '<span class="small">' + __e(_l("标 * 为必填项")) + '</span></div><div class="form-group"><div class="col-xs-5"><label class="control-label required" for="contactName">' + __e(_l("姓名")) + '</label><input type="text" class="form-control" name="contactName" placeholder="' + __e(_l("请填写联系人姓名")) + '" value="' + __e(addressBook ? addressBook.contactName : "") + '"></div><div class="col-xs-5 col-xs-offset-2"><label class="control-label" for="companyName">' + __e(_l("公司名称")) + '</label><input type="text" class="form-control" name="companyName" placeholder="' + __e(_l("请填写公司名称")) + '" value="' + __e(addressBook ? addressBook.companyName : "") + '"></div></div><div class="form-group"><div class="col-xs-5"><label class="control-label" for="contactTel">' + __e(_l("手机号码")) + '</label><input type="text" class="form-control" name="contactTel" placeholder="' + __e(_l("请填写手机号码")) + '" value="' + __e(addressBook ? addressBook.contactTel : "") + '"></div><div class="col-xs-5 col-xs-offset-2"><label class="control-label" for="contactPhone">' + __e(_l("固话")) + '</label><input type="text" class="form-control" name="contactPhone" placeholder="' + __e(_l("请填写固话号码")) + '" value="' + __e(addressBook ? addressBook.contactPhone : "") + '"></div></div><div class="form-group"><div class="col-xs-10"><label class="control-label required" for="location">' + __e(_l("省市区")) + '</label><div class="detail-location-input" data-max-level="4" data-hide-globe="true" data-hide-hkmctw="false"><input type="text" class="form-control" name="location" placeholder="' + __e(_l("请选择所在地区，例如：广东省－深圳市－福田区")) + '"></div></div></div>', showSelfRaising ? __p += '<div class="form-group"><div class="col-xs-10"><label class="control-label required tip-wrapper" for="address">' + __e(_l("详细地址或自提点编码")) + '<a href="javascript:void(0)" class="aicon-ask btn-tip" data-tip="如自提点编码无法转换为详细地址，请检查编码是否输入正确"></a></label><input type="text" class="form-control self-raising-point" name="address" placeholder="' + __e(_l("请填写所在街道以及详细地址或自提点编码")) + '" value="' + __e(addressBook ? addressBook.address : "") + '"></div></div>' : __p += '<div class="form-group"><div class="col-xs-10"><label class="control-label required" for="address">' + __e(_l("详细地址")) + '</label><input type="text" class="form-control" name="address" placeholder="' + __e(_l("请填写所在街道以及详细地址")) + '" value="' + __e(addressBook ? addressBook.address : "") + '"></div></div>', __p += '<div class="form-group TWlicenseInput" style="display:' + __e(hasCustomerId ? "block" : "none") + '"><div class="col-xs-10"><label for="customerId" class="required control-label">' + __e(_l("收件统编")) + '</label><input type="text" class="form-control" name="customerId" placeholder="' + __e(_l("如收件方为公司请填写营业执照，个人请填写身份证号")) + '" value="' + __e(hasCustomerId ? addressBook.customerId : "") + '"></div></div>', "en" !== Helper.getSiteLanguage() && (__p += '<div class="sftitle">' + __e(_l("智能地址填写")) + '</div><div class="smart-fill"><div class="intellect-fill"><button type="button" class="primary-btn small square intellect-fill-btn disabled">' + __e(_l("识别")) + '</button><textarea class="intellect-order-addr" placeholder="' + __e(_l("例如：顺小哥，13200000000，广东省深圳市南山区某某街道某某大厦001号")) + '"></textarea><p class="intellect-fill-num"><span class="intellect-fill-input">0</span>/<span>100</span></p></div></div>'), __p += '<div class="text-center"><button type="button" class="primary-btn save-address autowidth"data-addressid="' + __e(addressBook ? addressBook.addressId : "") + '">' + __e(_l("确认")) + "</button></div></form>"; return __p }, this.JST.addressSuccessBody = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<table class="address_success hide-in-loading table table-hover table-striped">', _.each(addressBookList, function (e) { __p += '<tr data-addId="' + __e(e.addressId) + '"><td style="width: 10%"><a href="javascript:void(0)" class="address-check aicon-uncheck"></a></td><td style="width: 20%"><p class="contact-name" flex><span class="text">' + __e(e.contactName) + "</span>", 1 == e.isDefault && (__p += '<span class="default-tip" flex-box="0">' + __e(_l("默认")) + "</span>"), __p += "</p>", e.contactTel ? __p += '<p class="gray">' + __e(e.contactTel) + "</p>" : e.contactPhone && (__p += '<p class="gray">' + __e(e.contactPhone) + "</p>"), __p += '</td><td style="width: 30%"><p>' + __e(_.uniq(_.compact([e.province, e.city, e.county]), !0).join("")) + '</p><p class="gray">' + __e(e.address) + '</p></td><td style="width: 20%"><p>' + __e(e.companyName ? e.companyName : _l("无")) + '</p></td><td class="option" style="width: 20%"><a href="javascript:void(0)" class="set-default ' + (null == (__t = 1 == e.isDefault ? "aicon-fill-star active" : "aicon-stroke-star") ? "" : __t) + '"></a><a href="javascript:void(0)" class="modify aicon-bianji"></a><a href="javascript:void(0)" class="delete aicon-delete2"></a></td></tr>' }), __p += "</table>"; return __p }, this.JST.userCenteraddressBook = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="uc-adds-books"><a href="javascript:void(0)" class="go-back aicon-back-setting"></a><h5 class="adds-books-title">' + __e(_l("地址簿")) + '</h5><div class="adds-book"><div class="clearfix"><form class="search-form fl"><div class="input-wrapper clearfix"><span class="aicon-search"></span><input type="text" class="form-control search-input" name="searchParm" placeholder="' + __e(_l("请输入姓名/电话查询")) + '"><button class="search primary-btn square small" type="submit">' + __e(_l("搜索")) + '</button></div></form><button type="button" class="primary-btn white square add fr"><span class="aicon-zengjia-01"></span>' + __e(_l("新增地址")) + '</button></div><ul class="table-title"><li style="width: 30%">' + __e(_l("联系人")) + '</li><li style="width: 30%">' + __e(_l("地址")) + '</li><li style="width: 20%">' + __e(_l("公司名称")) + '</li><li style="width: 20%">' + __e(_l("操作")) + '</li></ul><div class="table-wrapper"><dl class="address_loading"><dt><img src="' + __e(loadingImg) + '" alt=""></dt><dd><h5>' + __e(_l("正在加载...")) + '</h5></dd></dl><dl class="address_networkErr" style="display: none"><dt><span class="aicon-28 img"></span></dt><dd><h5>' + __e(_l("加载异常，请刷新重试")) + '</h5></dd><dd><button type="button" class="primary-btn try-again autowidth">' + __e(_l("重试")) + '</button></dd></dl><dl class="address_fetch_null" style="display: none"><dt><span class="aicon-emptybox img"></span></dt><dd><h5>' + __e(_l("地址为空")) + "</h5></dd><dd><p>" + __e(_l("您可先添加一条地址信息")) + '</p></dd></dl><dl class="address_search_null" style="display: none"><dt><span class="aicon-emptylist img"></span></dt><dd><p>' + __e(_l("暂时木有内容呀...")) + '</p></dd></dl></div><div class="fix-height"><div class="hide-in-loading"><div class="bootstrap-pagination"><ul class="pagination"></ul></div></div></div></div></div>'; return __p }, this.JST.addtionalService = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) _.each(additionalServices, function (e) { __p += '<img src="' + (null == (__t = e.icon) ? "" : __t) + '" alt="' + (null == (__t = e.name) ? "" : __t) + '" class="additional-service-icon" />' + (null == (__t = _l("支持")) ? "" : __t) + (null == (__t = e.name) ? "" : __t) }); return __p }, this.JST.areas = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) _.each(areas, function (e) { __p += "<span ", currentArea.code == e.code && (__p += ' class="current" '), __p += ' ><a href="#" data-code="' + (null == (__t = e.code) ? "" : __t) + '">' + (null == (__t = e.name) ? "" : __t) + "</a></span>" }); return __p }, this.JST.normalWeight = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<ul class="normal-weight clearfix">', _.each(weightArr, function (e, t) { __p += '<li><a data-value="' + __e(e) + '" href="javascript:void(0)" class="aicon-' + __e(e < 1 ? 1 : e) + "kg" + __e(e == initWeight ? " active" : "") + '"></a><p>' + __e(t + 1 == weightArr.length ? ">" : "") + __e(e) + "kg</p></li>" }), __p += "</ul>"; return __p }, this.JST.bookingInfo = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="booking-info-wrapper"><div class="top clearfix"><h3 class="fl">' + __e(_l("预约信息")) + "</h3>", showToggle && (__p += '<p class="fl pick-type"><a href="javascript:void(0)" class="on-door"><span class="aicon-radio icon"></span><span>' + __e(_l("快递员上门取件")) + '</span></a><a href="javascript:void(0)" class="by-self"><span class="aicon-radio icon"></span><span>' + __e(_l("自行联系快递员或自寄")) + "</span></a></p>"), __p += '</div><div class="form-horizontal"><div class="show-on-door"><label class="control-label required">' + __e(_l("上门时间")) + '：</label><div class="pickup-time aicon-time"><input type="text" class="form-control readonly sing-vote" placeholder="' + __e(_l("请选择您适合的时间")) + '" readonly id="date" name="date"/></div></div><div class="show-by-self warm-reminder">' + __e(_l("下单后可打印电子运单二维码，向收派员或到顺丰服务点出示二维码，扫码后快速寄件")) + '</div><div class="warm-reminder shipper-warm-reminder"></div><div class="warm-reminder consignee-warm-reminder"></div><label class="control-label required">' + __e(_l("快递产品")) + '</label><ul class="product-type-wrapper"></ul><div class="information"></div><div class="form-group text-center"><a href="javascript:void(0)" class="aicon-circle-check" id="agree-term-content"></a>' + __e(_l("我同意")) + '<a class="term" href="javascript:void(0)">《' + __e(_l("电子运单契约条款")) + '》</a></div></div><div class="btn_nav clearfix"><button type="button" class="primary-btn white big prev fl">' + __e(_l("上一步")) + '</button><button type="button" class="primary-btn big next fr disabled">' + __e(_l("下一步")) + '<span class="aicon-to-right"></span></button></div></div>'; return __p }, this.JST.bookingInfoReceiver = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<ul class="table-title"><li style="width: 25%"><a href="javascript:void(0)" class="aicon-uncheck check-box select-all"></a>' + __e(_l("收件人")) + '</li><li style="width: 35%">' + __e(_l("地址")) + '</li><li style="width: 40%">' + __e(_l("快递产品")) + '</li></ul><div class="height-scroll"><table class="table table-hover table-striped">', _.each(rList, function (e) { __p += '<tr data-rid="' + __e(e.rid) + '" data-code="' + __e(e.destRateCode) + '"><td style="width: 25%"><a href="javascript:void(0)" class="aicon-uncheck check-box select-one"></a><p>' + __e(e.contactName) + '</p><p class="gray">' + __e(e.contactTel || e.contactPhone) + '</p><p class="consignee-warm-reminder"></p></td><td style="width: 35%"><p>' + __e(_.uniq(_.compact([e.province, e.city, e.county]), !0).join("")) + '</p><p class="gray">' + __e(e.address) + '</p></td><td style="width: 30%" class="rate-cell"></td>', "hk" != Helper.getSiteLocation() && (__p += '<td style="width: 10%" class="option"><a href="javascript:void(0)" class="modify aicon-bianji"></a></td>'), __p += "</tr>" }), __p += "</table></div>"; return __p }, this.JST.bookingSuccHappy = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="happy"><h3>' + __e(_l("预约成功")) + '</h3><img src="' + __e(imgUrl) + '" alt="下单成功图片"><div class="clearfix options"><a href="' + __e(waybillUrl) + '" class="primary-btn white square fl"><span class="aicon-intellect-address"></span>' + __e(_l("查看订单列表")) + "</a></div></div>"; return __p }, this.JST.bulkBookingInfo = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="bulk-booking-info-wrapper"><div class="top clearfix"><h3 class="fl">' + __e(_l("预约信息")) + "</h3>", showToggle && (__p += '<p class="fl pick-type"><a href="javascript:void(0)" class="on-door"><span class="aicon-radio icon"></span><span>' + __e(_l("快递员上门取件")) + '</span></a><a href="javascript:void(0)" class="by-self"><span class="aicon-radio icon"></span><span>' + __e(_l("自行联系快递员或自寄")) + "</span></a></p>"), __p += '</div><div class="form-horizontal"><div class="show-on-door"><label class="control-label required">' + __e(_l("上门时间")) + '：</label><div class="pickup-time aicon-time"><input type="text" class="form-control readonly time-maidian" placeholder="' + __e(_l("请选择您适合的时间")) + '" readonly id="date" name="date"/></div></div><div class="show-by-self warm-reminder">' + __e(_l("下单后可打印电子运单二维码，向收派员或到顺丰服务点出示二维码，扫码后快速寄件")) + '</div><div class="warm-reminder-wrapper"></div><div class="receiver-wrapper"></div><div class="form-group predict-price-content">', "hk" != Helper.getSiteLocation() && (__p += '<div class="col-xs-12"><button type="button" class="primary-btn white square bulk-modify-select">' + __e(_l("批量修改快递产品")) + '</button><button type="button" class="primary-btn square bulk-modify-confirm">' + __e(_l("确认选择")) + '</button><button type="button" class="primary-btn white square bulk-modify-cancel">' + __e(_l("取消选择")) + "</button></div>"), __p += '<div class="predict-price"><p class="text">' + __e(_l("预计总运费")) + '</p><p class="number"><span class="currency">' + __e(currencyCode) + '</span><span class="price"></span></p></div></div><div class="form-group show-on-door"><div class="col-xs-12"><label class="control-label">' + __e(_l("捎话给快递员")) + '</label><a href="javascript:void(0)" class="aicon-msg cargo-msg">' + __e(_l("无")) + '</a></div></div><div class="form-group text-center"><a href="javascript:void(0)" class="aicon-circle-check" id="agree-term-content"></a>' + __e(_l("我同意")) + '<a class="term" href="javascript:void(0)">《' + __e(_l("电子运单契约条款")) + '》</a></div></div><div class="btn_nav clearfix"><button type="button" class="primary-btn white big prev fl">' + __e(_l("上一步")) + '</button><button type="button" class="primary-btn big next fr disabled">' + __e(_l("下一步")) + '<span class="aicon-to-right"></span></button></div></div>'; return __p }, this.JST.bulkOrderSuccess = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="bulk-order-success"><h3>' + __e(_l("下单成功！")) + "</h3>", selfSend ? (__p += '<p class="certificate-prompt">' + __e("tw" !== Helper.getSiteLocation() ? _l("下单后可打印电子运单二维码，向收派员或到顺丰服务点出示二维码，扫码后快速寄件") : _l("請列印電子運單二維碼，向收派員或到順豐服務點出示二維碼，掃碼後快速寄件")) + "</p>", "cn" === Helper.getSiteLocation() && (__p += '<p class="certificate-prompt">' + __e(_l("温馨提示：根据《中华人民共和国反恐怖主义法》《邮件快件实名收寄管理办法》相关要求，寄件时需出示身份证等有效身份证件进行实名登记，请勿寄递禁寄物品，谢谢配合；")) + "</p>")) : (__p += '<p class="certificate-prompt">' + __e(_l("温馨提示：快递员暂不支持批量打印运单服务，请自行打印运单")) + "</p>", "cn" === Helper.getSiteLocation() && (__p += '<p class="certificate-prompt">' + __e(_l("温馨提示：根据《中华人民共和国反恐怖主义法》《邮件快件实名收寄管理办法》相关要求，寄件时需出示身份证等有效身份证件进行实名登记，请勿寄递禁寄物品，谢谢配合；")) + "</p>"), __p += '<div class="delivery-brother clearfix"><div class="fl"><span class="fl bill-man-head"></span><div class="fl man-info"><div><span class="man-name">' + __e(resoure.resourceName || _l("顺丰小哥")) + '</span><div class="star"><span class="gray"><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span></span><span class="red' + __e(resoure.resourceName ? "" : " none") + '"><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span></span><span class="number">' + __e(resoure.resourceName ? resoure.grade : 0) + "</span></div></div><div><span>" + __e(_l("联系电话")) + " </span><span>" + __e(resoure.telphone || "") + '</span></div></div></div><div class="fr clearfix" style="margin-top:5px; text-align: right;"><div><span class="gray">' + __e(_l("预计上门时间")) + "</span></div><div>" + __e(relativeDate) + '<span class="delivery-time">' + __e(relativeHour) + "</span></div></div></div>"), __p += '<div class="order-again"></div><div class="info-toggle-wrapper"><span class="fl">' + __e(_l("${listNO}条运单信息")._p({ listNO: listNO })) + '</span><a href="javascript:void(0)" class="info-toggle primary-btn white">' + __e(_l("预约详情信息")) + '<span class="aicon-chevron-double-down"></span></a><p class="price-desc fr"><span class="price-label">' + __e(_l("预计总运费")) + '</span><span class="currency">' + __e(currencyCode) + '</span><span class="total-freight">' + __e(totalFreight) + '</span></p></div><ul class="info-list"></ul><div class="detail-info-list"></div></div>'; return __p }, this.JST.bulkShipping = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="bulkShipping"><ul class="step clearfix"><li class="active"><strong>01</strong><i></i><p>' + __e(_l("寄件人信息")) + "</p></li><li><strong>02</strong><i></i><p>" + __e(_l("收件人信息")) + "</p></li><li><strong>03</strong><i></i><p>" + __e(_l("预约信息")) + "</p></li><li><strong>04</strong><i></i><p>" + __e(_l("完成下单")) + '</p></li></ul><div class="items clearfix"><div class="page active"><div class="page-wrapper"><div class="sender-info"></div></div></div><div class="page"><div class="page-wrapper"><div class="receiver-info"></div></div></div><div class="page"><div class="page-wrapper"><div class="booking-info"></div></div></div><div class="page"><div class="page-wrapper"><div class="booking-succ"></div></div></div></div></div>'; return __p }, this.JST.bulkShippingRate = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="bulk-shipping"><div class="product-type-wrapper"></div><div class="text-center"><button type="button" class="primary-btn big confirm disabled">' + __e(_l("确定")) + "</button></div></div>"; return __p }, this.JST.detailInfoItem = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="detail-item" data-appointment-no="' + __e(obj.appointmentNo) + '"><p class="line"></p><div class="hover-ele"><table class="receiver-table" style="width:620px; table-layout: fixed"><tr><td style="width:35px;"><div class="sfbadge red">' + __e(_l("收")) + '</div><a href="javascript:void(0)" class="aicon-uncheck select-one" ></a></td><td style="width:210px;"><p class="bold">' + __e(obj.appointmentDetail.appointmentDestDetail.contactName) + '</p><p class="gray">' + __e(obj.appointmentDetail.appointmentDestDetail.contactTel || obj.appointmentDetail.appointmentDestDetail.contactPhone) + '</p></td><td colspan="2"><p>' + __e(_.uniq(_.compact([obj.appointmentDetail.appointmentDestDetail.province, obj.appointmentDetail.appointmentDestDetail.city, obj.appointmentDetail.appointmentDestDetail.county]), !0).join("")) + "</p><p>" + __e(obj.appointmentDetail.appointmentDestDetail.address) + '</p></td></tr><tr><td></td><td colspan="3"><p>' + __e(_l("预约号")) + "： " + __e(obj.appointmentNo) + '</p></td></tr></table><div class="others-wrapper"><ul class="bill-other-info"><li><p class="gray">' + __e(_l("托寄物品信息")) + "</p><p>" + __e(info.cargo) + '</p></li><li><p class="gray">' + __e(_l("付款方式")) + "</p><p>" + __e(info.payType) + "</p></li>", hasCargoInsure && (__p += '<li><p class="gray">' + __e(_l("保价")) + "</p><p>" + __e(info.declaredValue) + "</p></li>"), hasCargoService && (__p += '<li><p class="gray">' + __e(_l("增值服务")) + "</p><p>" + __e(info.additionalText) + "</p></li>"), __p += '</ul><a href="javascript:void(0)" class="aicon-bianji modify modify-hk"></a></div><div class="price-desc"><p class="currency">' + __e(currencyCode) + '</p><p class="meta-price">' + __e(obj.appointmentDetail.metaPrice) + "</p></div></div></div>"; return __p }, this.JST.detailInfoList = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="sfcard pad"><table class="sender-table" style="width:620px; table-layout: fixed"><tr><td class="send-badge" style="width:35px;"><div class="sfbadge black">' + __e(_l("寄")) + '</div><span class="aicon-v-dot"></span></td><td style="width:210px;"><p class="bold">' + __e(sender.contactName) + "</p><p>" + __e(sender.contactTel || sender.contactPhone) + '</p></td><td colspan="2"><p>' + __e(_.uniq(_.compact([sender.province, sender.city, sender.county]), !0).join("")) + "</p><p>" + __e(sender.address) + '</p></td></tr></table><div class="price-desc fr"><p class="price-label">' + __e(_l("预计总运费")) + '</p><p class="total-currency">' + __e(currencyCode) + '</p><p class="total-freight">' + __e(totalFreight) + '</p></div><p class="more-tip">' + __e(_l("多个收件人")) + '</p><div class="receive-info-list"></div></div><div class="clearfix options "><a href="javascript:void(0)" class="aicon-uncheck select-all fl"></a><a href="' + __e(waybillUrl) + '" class="primary-btn white square fl to-waybill"><span class="aicon-intellect-address"></span>' + __e(_l("查看订单列表")) + '</a><button type="button" class="primary-btn white square download fl"><span class="aicon-i-down"></span>' + __e(_l("下载电子运单")) + '</button><button type="button" class="primary-btn big detail-bulk-modify fr">' + __e(_l("批量修改预约信息")) + '</button><button type="button" class="primary-btn big confirm-select fr">' + __e(_l("确认")) + '</button><button type="button" class="primary-btn white big cancle-select fr">' + __e(_l("取消")) + "</button></div>"; return __p }, this.JST.excelTemplate = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="excel-template"><div class="input-wrap clearfix"><input type="text" class="file-input" disabled><input type="button" class="file-btn" value="' + __e(_l("选择文件")) + '"/><input type="file" class="choose-file hide" name="importedExcel" accept=".xls,.xlsx"/></div><div class="tips">' + __e(_l("点击下载模板")) + '</div><div><a href="' + __e(templateUrl) + '" target="_blank" download="' + __e(_l("收件人模板") + ".xlsx") + '" class="primary-btn white big aicon-i-down download">' + __e(_l("excel模板")) + '</a></div><div><button class="primary-btn big upload">' + __e(_l("上传")) + "</button></div></div>"; return __p }, this.JST.infoList = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) _.each(infoList, function (e) { __p += '<li class="sfcard clearfix"  data-appointment-no="' + __e(e.appointmentNo) + '"><div class="sender-info fl"><p class="bold">' + __e(sender.city) + '</p></div><span class="aicon-arrow-right to-right"></span><div class="receiver-info"><p class="receiver-addr bold">' + __e(e.appointmentDetail.appointmentDestDetail.city) + '</p></div><div class="price-desc fr"><p class="currency">' + __e(currencyCode) + '</p><p class="meta-price">' + __e(e.appointmentDetail.metaPrice) + "</p></div></li>" }), __p += '<li class="clearfix options"><a href="' + __e(waybillUrl) + '" class="primary-btn white square fl to-waybill"><span class="aicon-intellect-address"></span>' + __e(_l("查看订单列表")) + '</a><button type="button" class="primary-btn white square download fl"><span class="aicon-i-down"></span>' + __e(_l("下载电子运单")) + '</button><button type="button" class="primary-btn big bulk-modify fr">' + __e(_l("批量修改预约信息")) + "</button></li>"; return __p }, this.JST.orderAgain = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += "<h5>" + __e(_l("提示:由于网络异常，以下的订单未能提交成功，请重试")) + '</h5><ul class="table-title"><li style="width: 30%">' + __e(_l("收件人")) + '</li><li style="width: 30%">' + __e(_l("地址")) + '</li><li style="width: 40%">' + __e(_l("快递产品")) + '</li></ul><div class="height-scroll"><table class="table table-hover table-striped">', _.each(data, function (e) { __p += '<tr><td style="width: 30%"><p>' + __e(e.destinationAddress.contactName) + '</p><p class="gray">' + __e(e.destinationAddress.contactTel || e.destinationAddress.contactPhone) + '</p></td><td style="width: 30%"><p>' + __e(_.uniq(_.compact([e.destinationAddress.province, e.destinationAddress.city, e.destinationAddress.county]), !0).join("")) + '</p><p class="gray">' + __e(e.destinationAddress.address) + '</p></td><td class="rate-cell" style="width: 40%">' + (null == (__t = e.rateHtml) ? "" : __t) + "</td></tr>" }), __p += '</table></div><div class="clearfix"><button type="button" class="primary-btn big fr submit-again">' + __e(_l("重新提交")) + "</button></div>"; return __p }, this.JST.outRange = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="out-range"><ul class="table-title gray"><li style="width: 124px">' + __e(_l("收件人")) + '</li><li style="width: 210px">' + __e(_l("地址")) + '</li><li style="width: 280px">' + __e(_l("提示")) + '</li><li><a href="javascript:void(0)" class="aicon-uncheck check-box select-all"></a>' + __e(_l("网点自取")) + '</li></ul><div class="height-scroll"><table class="table table-hover table-striped">', _.each(outRangeList, function (e) { __p += '<tr data-rid="' + __e(e.rid) + '" data-code="' + __e(e.destRateCode) + '"><td style="width: 124px"><p>' + __e(e.contactName) + "</p><p>" + __e(e.contactTel || e.contactPhone) + '</p></td><td style="width: 210px"><p>' + __e(_.uniq(_.compact([e.province, e.city, e.county]), !0).join("")) + "</p><p>" + __e(e.address) + '</p></td><td style="width: 280px" class="red">' + __e(_l("亲，您的收件地址暂不在我司上门派件范围内，请选择收件人网点自取服务")) + '</td><td class="option"><a href="javascript:void(0)" class="aicon-uncheck check-box select-one"></a></td></tr>' }), __p += '</table></div><div class="text-right"><a href="javascript:void(0)" class="continue-submit primary-btn big">' + __e(_l("确定")) + "</a></div></div>"; return __p }, this.JST.peakControlFill = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="bulk-peak-control"><div class="header clearfix"><div class="fl"><lable class="gray">' + __e(_l("高峰管控提醒分类显示")) + '</lable><select name="select" class="select"></select></div><a href="javascript:void(0)" class="delete-all-select primary-btn white square fr">' + __e(_l("取消所选中的寄件")) + '</a></div><ul class="table-title gray"><li style="width: 139px">' + __e(_l("收件人")) + '<a href="javascript:void(0)" class="aicon-uncheck check-box select-all"></a></li><li style="width: 238px">' + __e(_l("地址")) + '</li><li style="width: 174px">' + __e(_l("快递产品")) + "</li><li>" + __e(_l("操作")) + '</li></ul><div class="height-scroll"><table class="table table-hover table-striped">', _.each(controlReceiverList, function (e) { __p += '<tr data-rid="' + __e(e.index) + '" data-code="' + __e(e.destRateCode) + '"><td style="width: 180px"><a href="javascript:void(0)" class="aicon-uncheck check-box select-one"></a><p class="tip">' + __e(e.obj.notificationMsg) + "</p><p>" + __e(e.contactName) + '</p><p class="gray">' + __e(e.contactTel || e.contactPhone) + '</p></td><td style="width: 238px"><p>' + __e(_.uniq(_.compact([e.province, e.city, e.county]), !0).join("")) + '</p><p class="gray">' + __e(e.address) + '</p></td><td style="width: 174px" class="rate-cell"><p class="red">' + __e(currencyCode + e.priceAndTime.totalFreight + _l("起")) + "</p><p>" + __e(e.priceAndTime.deliverTime ? e.priceAndTime.deliverTime : _l(e.priceAndTime.limitTypeName + "时效")) + '</p></td><td class="option"><a href="javascript:void(0)" class="delete-select primary-btn small white">' + __e(_l("取消寄件")) + "</a></td></tr>" }), __p += '</table></div><div class="text-right"><a href="javascript:void(0)" class="continue-submit primary-btn big">' + __e(_l("继续下单")) + "</a></div></div>"; return __p }, this.JST.rateCell = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) list.showErr ? __p += '<p class="red">' + __e(list.totalFreight) + "</p><p>" + __e(list.deliverTime) + "</p>" : __p += '<p class="red">' + __e(currencyCode + list.totalFreight + _l("起")) + "</p><p>" + __e(list.deliverTime ? list.deliverTime : _l(list.limitTypeName + "时效")) + "</p>"; return __p }, this.JST.receiverInfo = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="drop-down-wrapper"><div class="dropdown"><button class="primary-btn small square white aicon-zengjia-01 add-more" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">' + __e(_l("多个收件人")) + '</button><ul class="dropdown-menu" aria-labelledby="dLabel"><li><a href="javascript:void(0)" class="add-one">' + __e(_l("添加一个收件人")) + '</a></li><li><a href="javascript:void(0)" class="add-from-addressBook">' + __e(_l("从地址簿添加")) + "</a></li>", "en" !== Helper.getSiteLanguage() && (__p += '<li><a href="javascript:void(0)" class="add-from-excel">' + __e(_l("从Excel表格添加")) + "</a></li>"), __p += '</ul></div></div><div class="receiver-container"></div><div class="form-group"><div class="clearfix"><a href="javascript:void(0)" class="aicon-circle-check save-address-check checked  fr">' + __e(_l("保存到地址簿")) + '</a></div></div><div class="btn_nav clearfix"><div class="dropdown"><button class="primary-btn small square white aicon-zengjia-01 add-more" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">' + __e(_l("多个收件人")) + '</button><ul class="dropdown-menu" aria-labelledby="dLabel"><li><a href="javascript:void(0)" class="add-one">' + __e(_l("添加一个收件人")) + '</a></li><li><a href="javascript:void(0)" class="add-from-addressBook">' + __e(_l("从地址簿添加")) + "</a></li>", "en" !== Helper.getSiteLanguage() && (__p += '<li><a href="javascript:void(0)" class="add-from-excel">' + __e(_l("从Excel表格添加")) + "</a></li>"), __p += '</ul></div><button type="button" class="primary-btn white big prev fl">' + __e(_l("上一步")) + '</button><button type="button" class="primary-btn big next fr">' + __e(_l("下一步")) + '<span class="aicon-to-right"></span></button></div>'; return __p }, this.JST.renderReceiverList = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="receiver-list"><div class="sftitle">' + __e(_l("收方信息")), showOnlyIssues && (__p += '<a href="javascript:void(0)" class="' + __e(onlyIssues ? "aicon-check" : "aicon-uncheck") + ' only-issues">' + __e(_l("仅显示错误的地址")) + "</a>"), __p += '</div><ul class="table-title"><li style="width: 27%">' + __e(_l("收件人")) + '</li><li style="width: 27%">' + __e(_l("地址")) + '</li><li style="width: 27%">' + __e(_l("公司名称")) + '</li></ul><div class="height-scroll"><table class="table table-hover table-striped">', _.each(rList, function (e) { __p += '<tr data-rid="' + __e(e.rid) + '" class="' + __e(!1 === e.normal ? "unNormal" : "normal") + '"><td style="width: 27%"><p>' + __e(e.contactName) + "</p>", e.contactTel ? __p += '<p class="gray">' + __e(e.contactTel) + "</p>" : e.contactPhone && (__p += '<p class="gray">' + __e(e.contactPhone) + "</p>"), __p += '</td><td style="width: 27%"><p>' + __e(_.uniq(_.compact([e.province, e.city, e.county]), !0).join("")) + '</p><p class="gray">' + __e(e.address) + '</p></td><td style="width: 27%"><p>' + __e(e.companyName ? e.companyName : _l("无")) + '</p></td><td class="option" style="width: 19%"><a href="javascript:void(0)" class="btn-tip l-modify aicon-bianji" data-tip="修改"></a><a href="javascript:void(0)" class="btn-tip l-delete aicon-delete2" data-tip="删除"></a></td></tr>' }), __p += "</table></div></div>"; return __p }, this.JST.senderInfo = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="sender"></div><div class="btn_nav clearfix"><button type="button" class="primary-btn big next fr">' + __e(_l("下一步")) + '<span class="aicon-to-right"></span></button></div>'; return __p }, this.JST.shipper = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<form class="form-horizontal"><div class="intellect-warm-reminder">' + __e(_l("请检查拆分地址信息是否准确，如有遗漏请及时补充")) + '</div><div class="sftitle">', rDelete && (__p += '<a href="javascript:void(0)" class="aicon-delete2 delete"></a>'), __p += __e("sender" == shipperType ? _l("寄方信息") : _l("收方信息")), rIndex && (__p += '<span class="r-index"></span>'), __p += '<span class="small">' + __e(_l("标 * 为必填项")) + "</span>", "en" !== Helper.getSiteLanguage() && (__p += '<a href="javascript:void(0)" class="aicon-intellect-address addIntellectFill">' + __e(_l("智能地址填写")) + "</a>"), __p += '<a href="javascript:void(0)" class="aicon-address-book address-book">' + __e(_l("使用地址簿")) + "</a>", hasCalc && (__p += '<a href="' + __e(priceUrl) + '" target="_blank" class="aicon-calculator">' + __e(_l("价格计算")) + "</a>"), __p += '</div><p class="warm-reminder"></p><div class="form-group"><div class="col-xs-5 autoAddPicker"><label class="control-label required" for="contactName">' + __e(_l("姓名")) + '</label><input type="text" class="form-control" name="contactName" placeholder="' + __e(_l("请填写联系人姓名")) + '"></div><div class="col-xs-5 col-xs-offset-2 autoAddPicker"><label class="control-label" for="companyName">' + __e(_l("公司名称")) + '</label><input type="text" class="form-control" name="companyName" placeholder="' + __e(_l("请填写公司名称")) + '"></div></div><div class="form-group"><div class="col-xs-5 autoAddPicker"><label class="control-label" for="contactTel">' + __e(_l("手机号码")) + '</label><input type="text" class="form-control" name="contactTel" placeholder="' + __e(_l("请填写手机号码")) + '"></div><div class="col-xs-5 col-xs-offset-2"><label class="control-label" for="contactPhone">' + __e(_l("固话")) + '</label><input type="text" class="form-control" name="contactPhone" placeholder="' + __e(_l("请填写固话号码")) + '"></div></div><div class="form-group"><div class="col-xs-10"><label class="control-label required" for="location">' + __e("hk" === Helper.getSiteLocation() ? _l("城市/区域") : _l("省市区")) + '</label><div class="detail-location-input" data-max-level="4" data-hide-globe="true" data-hide-hkmctw="true"><input type="text" class="form-control ' + __e("sender" == shipperType ? "origins" : "dests") + '" name="location" placeholder="' + __e("hk" === Helper.getSiteLocation() ? _l("请选择所在区域，例如：香港－中西区－上环") : _l("请选择所在地区，例如：广东省－深圳市－福田区")) + '"></div></div>', hasNearBy && (__p += '<a class="getNearbyAddress aicon-location maidian" data-md-name="点击省市区后地标" data-md-id="OWF010103" href="javascript:void(0)"></a>'), __p += '</div><div class="form-group"><div class="col-xs-10"><label class="control-label required" for="address">' + __e(_l("详细地址")) + '</label><input type="text" class="form-control" name="address" placeholder="' + __e(_l("请填写所在街道以及详细地址")) + '"></div></div><div class="form-group error error-sender-address-detail"><div class="col-xs-10">' + __e(_l("亲，您的寄件地址我司暂无法上门收件，您可修改为其它地址")) + "</div></div>", "receiver" == shipperType && (__p += '<div class="form-group error error-receiver-address-detail"><div class="col-xs-12">' + __e(_l("亲，您的收件地址不在我司派送范围内，可选择自取服务")) + "</div></div>"), __p += '<div class="form-group TWlicenseInput"><div class="col-xs-10"><label for="customerId" class="required control-label">' + __e(_l("收件统编")) + '</label><input type="text" class="form-control" name="customerId" placeholder="' + __e(_l("如收件方为公司请填写营业执照，个人请填写身份证号")) + '"></div></div></form>'; return __p }, this.JST.buttonGroupTempletas = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) _.each(items, function (e) { __p += '<button type="button" class="btn btn-default" style="width: ' + (null == (__t = Math.round(100 / items.length)) ? "" : __t) + '%" data-code="' + (null == (__t = e.get("code")) ? "" : __t) + '">' + (null == (__t = e.get("name")) ? "" : __t) + "</button>" }); return __p }, this.JST.changeDelivery = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="modify-bill"><div class="top-info clearfix"><ul class="clearfix shipper fl contact-panel"><li class="sfbadge red">' + __e(_l("收")) + '</li><li><p class="contact-info"><span class="contact-name">' + __e(contactName) + '</span><span class="contact-phone">' + __e(contactPhone) + '</span></p></li></ul><p class="fr right change-panel"><button type="button" class="primary-btn small white square aicon-bianji receiver-change">' + __e(_l("更改")) + '</button></p></div><p class="change-title">' + __e(_l("派送方式")) + '</p><ul class="bill-options-list clearfix"><li><button type="button" class="change-btn aicon aicon-alarm-on time-change ' + __e(deliverDate ? "already-change" : "") + __e(networkStoreName ? "disabled" : "") + '"><span class="method-title">' + __e(_l("预约上门")) + '</span><span class="date-text fr">' + __e(deliverDate) + '</span><span class="time-text fr">' + __e(deliverTime) + "</span>", expectedDeliveryTime || deliverDate || (__p += '<span class="no-delivertim">' + __e(_l("暂无预计派送时间")) + "</span>"), __p += '</button></li><li><button type="button" class="change-btn addr-change ' + __e(networkStoreName ? "already-change" : "") + __e(deliverDate ? "disabled" : "") + '"><span class="method-title aicon aicon-pickup-spot">' + __e(_l("派送至代收点")) + '</span><span class="store-text">' + __e(storeTypeName) + '</span><span class="point-text fl">' + __e(networkStoreName) + '</span><span class="point-addr-text fl">' + __e(networkStoreAddress) + "</span></button></li></ul></div>"; return __p }, this.JST.changeDeliveryAddr = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="change-address">\x3c!-- 地图 --\x3e<div class="delivery-map" id="netmap"></div><ul class="store-wrapper clearfix" role="radiogroup"><li role="radio" data-value="5" class="accessible-click ' + __e(5 == selectStoreType ? "active" : "") + '"' + __e(5 == selectStoreType ? "aria-checked=true" : "") + '><a class="store-name">' + __e(_l("丰巢智能柜")) + '</a></li><li role="radio" data-value="1" class="accessible-click ' + __e(1 == selectStoreType ? "active" : "") + '"' + __e(1 == selectStoreType ? "aria-checked=true" : "") + '><a class="store-name">' + __e(_l("门店")) + '</a></li><li role="radio" data-value="2" class="accessible-click ' + __e(2 == selectStoreType ? "active" : "") + '"' + __e(2 == selectStoreType ? "aria-checked=true" : "") + '><a class="store-name">' + __e(_l("便利店")) + '</a></li><li role="radio" data-value="3" class="accessible-click ' + __e(3 == selectStoreType ? "active" : "") + '"' + __e(3 == selectStoreType ? "aria-checked=true" : "") + '><a class="store-name">' + __e(_l("顺丰优选")) + '</a></li></ul><ul class="point-wrapper" role="radiogroup">', points && 0 < points.length ? _.each(points, function (e) { __p += '<li role="radio" data-value="' + __e(e.code) + '" class="item ' + __e(selectPointCode == e.code ? "active" : "") + ' accessible-click"' + __e(selectPointCode == e.code ? "aria-checked=true" : "") + ' ><a class="store-item"><span class="item-name">' + __e(e.name) + '<span class="aicon"></span></span><br><span class="item-address">' + __e(e.address) + '</span><span class="item-distance">' + __e(e.distance) + "m</span></a></li>" }) : __p += '<li class="overtime store-item">' + __e(_l("附近暂无此类网点，请选择其他类型网点")) + "</li>", __p += '</ul><div class="text-center"><button type="button" class="primary-btn autowidth confirm-change">' + __e(_l("保存并提交")) + "</button></div></div>"; return __p }, this.JST.changeDeliveryReceiver = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="reciever-change"><div class="col-xs-5 change-input"><label class="control-label" for="contactName">' + __e(_l("姓名")) + '</label><input type="text" class="form-control" id="contactName" maxlength="20" placeholder="' + __e(_l("请填写联系人姓名")) + '" value="' + __e(contactName) + '"><span class="err-tip name-error" style="display: none">' + __e(_l("*请填写正确的联系人姓名")) + '</span></div><div class="col-xs-5 col-xs-offset-2 change-input"><label class="control-label" for="companyName">' + __e(_l("电话")) + '</label><input type="tel" class="form-control" id="contactPhone" placeholder="' + __e(_l("请填收件人电话")) + '" value="' + __e(contactPhone) + '"><span class="err-tip phone-error" style="display: none">' + __e(_l("*请填写正确的电话号码")) + '</span></div><div class="text-center"><button type="button" class="primary-btn autowidth receiver-confirm">' + __e(_l("保存并提交")) + "</button></div></div>"; return __p }, this.JST.changeDeliveryTime = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="pickup-time"><div class="center"><label class="gray">' + __e(_l("预计派送时间")) + '</label><input type="text" class="form-control readonly" placeholder="' + __e(_l("请选择您适合的时间")) + '"readonly id="date" name="date"/></div><div class="date-list"><a class="left-arrow" href="javascript:void(0)"><span class="left"></span></a><ul class="date-wrapper" role="radiogroup">', _.each(dates, function (e) { __p += '<li tabindex="0" role="radio" data-value="' + __e(e.date) + '" class="accessible-click"><p>' + __e(_l(e.text)) + '</p><p class="date">' + __e(e.date) + "</p></li>" }), __p += '</ul><a class="right-arrow" href="javascript:void(0)"><span class="right"></span></a></div><ul class="time-wrapper" role="radiogroup">', times && 0 < times.length && _.each(times, function (e) { __p += '<li role="radio" tabindex="0" data-value="' + __e(e.start) + '" class="item accessible-click"><span>' + __e(e.text) + '</span><span class="red aicon-right"></span></li>' }), __p += '</ul><div class="text-center comform-btn"><button type="button" class="primary-btn autowidth confirm-change">' + __e(_l("保存并提交")) + "</button></div></div>"; return __p }, this.JST.cities = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) _.each(cities, function (e) { __p += '<span><a data-code="' + (null == (__t = e.code) ? "" : __t) + '" href="#">' + (null == (__t = e.name.substr(0, 4)) ? "" : __t) + "</a></span>" }); return __p }, this.JST.pickupTimePicker = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<ul class="date-wrapper" role="radiogroup">', _.each(dates, function (e) { __p += '<li tabindex="0" role="radio" data-value="' + __e(e.date) + '" class="accessible-click ' + __e(showDate == e.date ? "current" : "") + '"' + __e(showDate == e.date ? "aria-checked=true" : "") + "><p>" + __e(_l(e.text)) + '</p><p class="date">' + __e(e.date) + '</p><span class="aicon-right"></span></li>' }), __p += '</ul><ul class="time-wrapper" role="radiogroup">', times && 0 < times.length ? _.each(times, function (e) { __p += '<li role="radio" tabindex="0" data-value="' + __e(e.start) + '" class="item ' + __e(showTime == e.start ? "current" : "") + ' accessible-click"' + __e(showTime == e.start ? "aria-checked=true" : "") + ' data-time="' + __e(e.prev) + '"><span>' + __e(e.text) + "</span></li>" }) : __p += '<li class="overtime">' + __e(_l("今天上门时间已过，请选择其他日期")) + "</li>", __p += "</ul>"; return __p }, this.JST.detailedDatePicker = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += ""; return __p }, this.JST.detailedDateTimePicker = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<ul class="date-time-tabs" role="radiogroup"><li tabindex="0" role="radio" class="date ' + (null == (__t = showTimePicker ? "" : "current") ? "" : __t) + ' accessible-click" ' + (null == (__t = showTimePicker ? "" : "aria-checked=true") ? "" : __t) + ">" + (null == (__t = _l("日期")) ? "" : __t) + '</li><li tabindex="0" role="radio" class="time ' + (null == (__t = showTimePicker ? "current" : "") ? "" : __t) + ' accessible-click" ' + (null == (__t = showTimePicker ? "aria-checked=true" : "") ? "" : __t) + ">" + (null == (__t = _l("时间")) ? "" : __t) + "</li></ul>", showTimePicker ? (__p += '<div class="detail-time-picker"><div tabindex="0" class="indicator top disabled accessible-click"><span class="sfi sfi-chevron-up"></span></div><div class="picker-wrapper"><ul class="times" role="radiogroup">', _.each(times, function (e, t) { selectedWithInOneHour ? __p += 0 == t ? '<li role="radio" tabindex="0" class="current accessible-click" aria-checked=true>' + (null == (__t = e) ? "" : __t) + "</li>" : '<li role="radio" tabindex="0" class="accessible-click">' + (null == (__t = e) ? "" : __t) + "</li>" : __p += '<li role="radio" tabindex="0" class="' + (null == (__t = e === selectedTime ? "current" : "") ? "" : __t) + ' accessible-click" ' + (null == (__t = e === selectedTime ? "aria-checked=true" : "") ? "" : __t) + ">" + (null == (__t = e) ? "" : __t) + "</li>" }), __p += '</ul></div><div tabindex="0" class="indicator bottom accessible-click"><span class="sfi sfi-chevron-down"></span></div></div>') : __p += '<div class= "detail-date-picker"></div>'; return __p }, this.JST.detailedLocationPicker = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) if (areaTabs.showAreaTab && (__p += '<ul class="area-level-tabs" role="radiogroup">', areaTabs.showMainLand && (__p += '<li tabindex="0" role="radio"  data-tab="main-land" class="accessible-click ' + (null == (__t = "main-land" === areaTabs.currentTab ? "current" : "") ? "" : __t) + '" ' + (null == (__t = "main-land" === areaTabs.currentTab ? "aria-checked=true" : "") ? "" : __t) + ">" + (null == (__t = _l("大陆")) ? "" : __t) + "</li>"), areaTabs.showHKMCTW && (__p += '<li tabindex="0" role="radio"  data-tab="hk-mc-tw" class="accessible-click ' + (null == (__t = "hk-mc-tw" === areaTabs.currentTab ? "current" : "") ? "" : __t) + '" ' + (null == (__t = "hk-mc-tw" === areaTabs.currentTab ? "aria-checked=true" : "") ? "" : __t) + ">" + (null == (__t = _l("港澳台")) ? "" : __t) + "</li>"), areaTabs.showGlobe && (__p += '<li tabindex="0" role="radio"  data-tab="international" class="accessible-click ' + (null == (__t = "international" === areaTabs.currentTab ? "current" : "") ? "" : __t) + '" ' + (null == (__t = "international" === areaTabs.currentTab ? "aria-checked=true" : "") ? "" : __t) + ">" + (null == (__t = _l("国际")) ? "" : __t) + "</li>"), __p += "</ul>"), __p += '<ul class="region-level-tabs" role="radiogroup">', _.each(regionTabs, function (e) { __p += '<li tabindex="0" role="radio" data-code="' + (null == (__t = e.parentRegion.code) ? "" : __t) + '" class="accessible-click ' + (null == (__t = e.selected ? "current" : "") ? "" : __t) + " " + (null == (__t = e.selectedRegion && !e.selected ? "has-selection" : "") ? "" : __t) + '" ' + (null == (__t = e.selected ? "aria-checked=true" : "") ? "" : __t) + ' style="width: ' + (null == (__t = Math.min(100 / regionTabs.length, 33)) ? "" : __t) + '%" title="' + (null == (__t = e.selectedRegion ? e.selectedRegion.name : "") ? "" : __t) + '">', e.alwaysDisplayName ? __p += null == (__t = e.displayName) ? "" : __t : __p += null == (__t = e.selectedRegion && e.selectedRegion.name ? e.selectedRegion.name : e.displayName || _l("请选择")) ? "" : __t, __p += "</li>" }), __p += "</ul>", isLoading) __p += '<ul class="regions"><p class="loading-text">' + (null == (__t = _l("正在加载地区数据...")) ? "" : __t) + "</p></ul>"; else if (errorLoading) __p += '<ul class="regions"><p class="error-loading">' + (null == (__t = _l("抱歉，加载数据地区数据失败。")) ? "" : __t) + "</p></ul>"; else if (showNotAvailable) __p += '<ul class="regions"><p class="error-loading">' + (null == (__t = _l("该地区暂时没有开通该项业务")) ? "" : __t) + "</p></ul>"; else { if (__p += '<ul class="regions" role="radiogroup">', _.each(availableRegions, function (e, t) { t % pageLimit == 0 && (__p += '<div class="accessible-click regions-page ' + (null == (__t = t ? "" : "current") ? "" : __t) + '" ' + (null == (__t = t ? "" : "aria-checked=true") ? "" : __t) + ' data-page="' + (null == (__t = t / pageLimit + 1) ? "" : __t) + '">'), __p += "<li " + (null == (__t = e.get("code") === currentSelectedRegionCode ? 'class="current" aria-checked=true' : "") ? "" : __t) + ' role="radio"><a href="javascript:void(0)" class="accessible-click" data-id="' + (null == (__t = e.get("id")) ? "" : __t) + '" data-level="' + (null == (__t = e.get("level")) ? "" : __t) + '" data-country-code="' + (null == (__t = e.get("countryCode")) ? "" : __t) + '"data-code="' + (null == (__t = e.get("code")) ? "" : __t) + '" data-rate-code="' + (null == (__t = e.get("rateCode")) ? "" : __t) + '"  data-province-code="' + (null == (__t = e.get("provinceCode")) ? "" : __t) + '"data-province-rate-code="' + (null == (__t = e.get("provinceRateCode")) ? "" : __t) + '" data-province-name="' + (null == (__t = e.get("provinceName")) ? "" : __t) + '"title="' + (null == (__t = e.get("name")) ? "" : __t) + '" data-parent-id="' + (null == (__t = e.get("parentId")) ? "" : __t) + '" data-parent-code="' + (null == (__t = e.get("parentCode")) ? "" : __t) + '" data-dist-id="' + (null == (__t = e.get("distId")) ? "" : __t) + '">' + (null == (__t = e.get("name")) ? "" : __t) + "</a></li>", t % pageLimit == pageLimit - 1 && (__p += "</div>") }), availableRegions.length % pageLimit != 0 && (__p += "</div>"), __p += "</ul>", availableRegions.length > pageLimit) { for (__p += '<ul class="pages-switch">', i = 0; i < availableRegions.length / pageLimit; i++)__p += '<li tabindex="0" class="accessible-click ' + (null == (__t = i ? "" : "current") ? "" : __t) + '">' + (null == (__t = i + 1) ? "" : __t) + "</li>"; __p += "</ul>" } shouldShowFussySelection && (__p += '<p><a class="hide-picker" href="＃" onclick="return false;">' + (null == (__t = _l("不清楚具体地名?")) ? "" : __t) + "</a></p>"), 0 < unavailableRegions.length && (__p += '<div class="unavailable-regions"><p><span class="sfi sfi-info-sign"></span><span>' + (null == (__t = _l("未来将会再开通")) ? "" : __t) + "</span>", 3 < unavailableRegions.length ? __p += null == (__t = _p(_l("%s等%d个服务地区"), _.map(_.first(unavailableRegions, 3), function (e) { return e.get("name") }).join("、"), unavailableRegions.length)) ? "" : __t : __p += null == (__t = _.map(unavailableRegions, function (e) { return e.get("name") }).join("、")) ? "" : __t, __p += "</p></div>") } return __p }, this.JST.dropdownCity = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) for (var i = 0; i < dropdownItems.length; i++)"A" != dropdownItems[i] && (__p += '<li><a href="#" onclick="return false;" data-code="' + (null == (__t = dropdownItems[i]) ? "" : __t) + '">' + (null == (__t = dropdownItems[i]) ? "" : __t) + "</a></li>"); return __p }, this.JST.dropdownRuleTemplates = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) dropdownItems.length ? _.each(dropdownItems, function (e) { __p += '<li><a href="#" onclick="return false;" data-code="' + (null == (__t = e.code) ? "" : __t) + '">' + (null == (__t = _l(e.name)) ? "" : __t) + "</a></li>" }) : __p += '<div class="text-center loading-text">' + (null == (__t = _l("正在加载数据...")) ? "" : __t) + "</div>"; return __p }, this.JST.dropdownSelectTemplate = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) itemList.length ? _.each(itemList, function (e) { __p += '<option value="' + (null == (__t = e.value) ? "" : __t) + '">' + (null == (__t = "en" == Helper.getSiteLanguage() ? e.enTxt : "tc" == Helper.getSiteLanguage() ? e.tcTxt : e.scTxt) ? "" : __t) + "</option>" }) : __p += "<option>" + (null == (__t = _l("正在加载数据...")) ? "" : __t) + "</option>"; return __p }, this.JST.dropdownTemplates = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) dropdownItems.length ? _.each(dropdownItems, function (e) { __p += '<li><a href="#" onclick="return false;" data-code="' + (null == (__t = e.get("code")) ? "" : __t) + '">' + (null == (__t = e.get("name")) ? "" : __t) + "</a></li>" }) : __p += '<div class="text-center loading-text">' + (null == (__t = _l("正在加载数据...")) ? "" : __t) + "</div>"; return __p }, this.JST.hotline = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) { __p += '<table class="table"><thead><tr><th id="th-region">' + (null == (__t = _l("地区")) ? "" : __t) + '</th><th id="th-city">' + (null == (__t = _l("城市")) ? "" : __t) + '</th><th id="th-hotline">' + (null == (__t = _l("应急热线")) ? "" : __t) + '</th><th id="th-fax">' + (null == (__t = _l("传真")) ? "" : __t) + "</th></tr></thead><tbody>"; for (var len = res.length - 1, pro; 0 <= len; len--)pro = res[len], __p += "<tr><td> " + (null == (__t = pro.province) ? "" : __t) + "  </td><td> " + (null == (__t = pro.city) ? "" : __t) + "  </td><td> " + (null == (__t = pro.telephone) ? "" : __t) + "  </td><td> " + (null == (__t = pro.fax) ? "" : __t) + "  </td></tr>"; __p += "</tbody></table>" } return __p }, this.JST.importExportRuleResult = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += "\x3c!--关务进出口规则显示结果的模板文件 --\x3e", _.isEmpty(results) ? __p += '<tr><td colspan="8"> No Found </td></tr>' : _.each(results, function (e, t) { __p += "<tr><td>" + (null == (__t = (pageIndex - 1) * pageSize + (t + 1)) ? "" : __t) + "</td><td>" + (null == (__t = e.goodCode) ? "" : __t) + '</td><td style="width: 100px;" title="' + (null == (__t = "sc" === Helper.getSiteLanguage() || "tc" === Helper.getSiteLanguage() ? e.goodName : e.goodNameEn) ? "" : __t) + '">' + (null == (__t = "sc" === Helper.getSiteLanguage() || "tc" === Helper.getSiteLanguage() ? e.goodName : Helper.chineseCharSubString(e.goodNameEn, 12, !0)) ? "" : __t) + "</td>\x3c!--<td>", "sc" === Helper.getSiteLanguage() || "tc" === Helper.getSiteLanguage() ? __p += null == (__t = "1" == e.resultType ? "允许收寄" : "2" == e.resultType ? "禁止收寄" : "限制收寄") ? "" : __t : __p += null == (__t = "1" == e.resultType ? "Permitted" : "2" == e.resultType ? "Prohibited" : "Restricted") ? "" : __t, __p += '</td>--\x3e<td style="position: relative;"><a data-toggle="tooltip" data-trigger="click" data-html="true" data-placement="bottom" title="" href="javascript:;" item-index="' + (null == (__t = t) ? "" : __t) + '" class="tax-details" >' + (null == (__t = e.taxTotal) ? "" : __t) + '</a></td><td style="width: 120px;">', _.isEmpty(e.images) ? __p += "&nbsp;" : _.each(e.images, function (e, t) { __p += (null == (__t = t + 1) ? "" : __t) + ':<a image-src="' + (null == (__t = e.imageNameGw) ? "" : __t) + '" href="javascript:;" class="tax-images">' + (null == (__t = e.imageName) ? "" : __t) + "</a><br>" }), __p += "</td>\x3c!--<td>" + (null == (__t = e.remark) ? "" : __t) + "</td>--\x3e</tr>" }); return __p }, this.JST.location = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<span class="input-group-addon"><span class="sfi sfi-flag"></span></span><input type="text" class="form-control location-input" placeholder="' + (null == (__t = placeholder) ? "" : __t) + '"><div class="location-overlay"></div><span class="input-group-addon toggle-location-picker"><span class="sfi sfi-th"></span></span>'; return __p }, this.JST.locationLiveSearch = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<p data-code="' + (null == (__t = code) ? "" : __t) + '">' + (null == (__t = name) ? "" : __t) + "</p>"; return __p }, this.JST.locationPicker = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="region">', _.each(areas, function (e, t) { __p += '<span><a href="#" ', t == currentIndex && (__p += ' class="current" '), __p += ' data-index="' + (null == (__t = t) ? "" : __t) + '">' + (null == (__t = region.name) ? "" : __t) + "</a></span>" }), __p += "</div>"; return __p }, this.JST.locationQuery = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="arrow sfi sfi-chevron-right"></div><button class="rate-search primary-button">' + (null == (__t = searchText) ? "" : __t) + '</button><div class="error"></div>'; return __p }, this.JST.loginWindow = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="loginWindow"><ul class="sf-nav-tabs" role="tablist">', logtype.QRcode && (__p += '<li role="presentation" class="qrcode-tab active maidian" data-md-name="点击扫码登录"  data-md-id="106004"><a href="#QRcodeLogin" aria-controls="QRcodeLogin" role="tab" data-toggle="tab">' + (null == (__t = _l("扫码登录")) ? "" : __t) + "</a></li>"), logtype.verification && (__p += '<li role="presentation" class="' + (null == (__t = logtype.QRcode ? "" : "active") ? "" : __t) + '"><a href="#verificationLogin" aria-controls="verificationLogin" role="tab" data-toggle="tab" class="verifiCationLogin maidian" data-md-name="点击帐号登录"  data-md-id="106003">' + (null == (__t = _l("帐号登录")) ? "" : __t) + "</a></li>"), logtype.password && (__p += '<li role="presentation" class="' + (null == (__t = logtype.verification || logtype.QRcode ? "" : "active") ? "" : __t) + '"><a href="#passwordLogin" aria-controls="passwordLogin" role="tab" data-toggle="tab">' + (null == (__t = _l("密码登录")) ? "" : __t) + "</a></li>"), __p += '</ul><div class="tab-content">', logtype.QRcode && (__p += '<div role="tabpanel" class="tab-pane qrcode-pane active" id="QRcodeLogin"><h5>' + (null == (__t = _l("登录后即可免验证快速下单与查件")) ? "" : __t) + '</h5><img class="scan-img" src="" alt="' + (null == (__t = _l("扫码登录")) ? "" : __t) + '"><div class="scan-success"><img src="' + (null == (__t = Helper.getResourceURL("images/login/scan-success.png")) ? "" : __t) + '"/><span>' + (null == (__t = _l("扫描成功")) ? "" : __t) + '</span></div><div class="scan-abate"><img class="refresh-btn" src="' + (null == (__t = Helper.getResourceURL("images/login/refresh.png")) ? "" : __t) + '" /></div><h4 class="text-center QRinfo">' + (null == (__t = _l("请使用微信扫描二维码")) ? "" : __t) + '</h4><h5 class="text-center remember"><input type="checkbox" checked="checked"  id="QRremember"/><label for="QRremember">' + (null == (__t = _l("自动登录")) ? "" : __t) + "</label></h5></div>"), logtype.verification && (__p += '<div role="tabpanel" class="tab-pane ' + (null == (__t = logtype.QRcode ? "" : "active") ? "" : __t) + '" id="verificationLogin"><h5>' + (null == (__t = _l("登录后即可免验证快速下单与查件")) ? "" : __t) + '</h5><form class="quick_login_form"><div class="form-group"><input type="text" class="form-control" id="login_mobile" name="login_mobile" placeholder="' + (null == (__t = _l("请输入手机号")) ? "" : __t) + '"></div><div class="form-group"><div class="row"><div class="col-xs-7"><input type="text" class="form-control" id="login_code" name="login_code" autocomplete="off" placeholder="' + (null == (__t = _l("请输入验证码")) ? "" : __t) + '"></div><div class="col-xs-5"><button type="button" class="primary-button login_validation_code count-down-button maidian" data-md-name="获取验证码"  data-md-id="106001" data-count-down-time="60" data-count-down-title="' + (null == (__t = _l("重新获取%s")) ? "" : __t) + '">' + (null == (__t = _l("获取验证码")) ? "" : __t) + '</button></div></div></div><div class="form-group error telNO-err">' + (null == (__t = _l("手机号错误")) ? "" : __t) + '</div><div class="form-group error login-err">' + (null == (__t = _l("登录失败")) ? "" : __t) + '</div><div class="form-group error limit-send-sms">' + (null == (__t = _l("该手机号本日已达到发送短信上限")) ? "" : __t) + '</div><div class="form-group error get-validation-code-failed">' + (null == (__t = _l("获取验证码失败")) ? "" : __t) + '</div><div class="form-group error validation-code-param-error">' + (null == (__t = _l("验证码参数错误")) ? "" : __t) + '</div><div class="form-group error validation-code-expired">' + (null == (__t = _l("验证码已过期")) ? "" : __t) + '</div><div class="form-group error validation-code-count-expired">' + (null == (__t = _l("验证码超次数，请重新获取")) ? "" : __t) + '</div><div class="form-group error validation-code-error">' + (null == (__t = _l("验证码错误")) ? "" : __t) + '</div><div class="form-group error validation-not-send">\t' + (null == (__t = _l("验证码未发送")) ? "" : __t) + '</div><div class="form-group error validation-code-network-error">' + (null == (__t = _l("网络错误")) ? "" : __t) + '</div><div class="bot-wrapper"><p class="text-center verification_tips">' + (null == (__t = _l("未注册用户登录默认注册顺丰会员")) ? "" : __t) + '</p><div class="text-center remember"><input type="checkbox" id="pwdRemeber" checked="checked" class="login_term" name="login_term" /><label for="pwdRemeber">' + (null == (__t = _l("自动登录")) ? "" : __t) + '</label></div><button type="button" class="primary-btn big verification_quick_login disabled maidian" data-md-name="点击快速登录"  data-md-id="106005" data-loading-text="' + (null == (__t = _l("登录中...")) ? "" : __t) + '">' + (null == (__t = _l("快速登录")) ? "" : __t) + '</button><a href="' + (null == (__t = memberUrl) ? "" : __t) + '" target="_blank" class="primary-btn big white maidian" data-md-name="点击进入会员系统"  data-md-id="106006">' + (null == (__t = _l("进入会员系统")) ? "" : __t) + '</a><h5 class="text-center error term_tips">' + (null == (__t = _l("请勾选服务条款")) ? "" : __t) + "</h5></div></form></div>"), logtype.password && (__p += '<div role="tabpanel" class="tab-pane ' + (null == (__t = logtype.verification || logtype.QRcode ? "" : "active") ? "" : __t) + '" id="passwordLogin">3</div>'), __p += "</div></div>"; return __p }, this.JST.modal = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '\x3c!-- Modal --\x3e<div class="modal' + (null == (__t = fade ? " fade" : "") ? "" : __t) + '" id=' + (null == (__t = id) ? "" : __t) + ' tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"><div class="modal-dialog"' + (null == (__t = width ? ' style="width:' + width + 'px"' : "") ? "" : __t) + '><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button><h4 class="modal-title" id="myModalLabel">' + (null == (__t = title) ? "" : __t) + '</h4></div><div class="modal-body">' + (null == (__t = body) ? "" : __t) + "</div></div>\x3c!-- /.modal-content --\x3e</div>\x3c!-- /.modal-dialog --\x3e</div>\x3c!-- /.modal --\x3e"; return __p }, this.JST.modalNoHeader = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '\x3c!-- Modal --\x3e<div class="modal' + (null == (__t = fade ? " fade" : "") ? "" : __t) + '" id=' + (null == (__t = id) ? "" : __t) + " data-backdrop=" + (null == (__t = backdrop) ? "" : __t) + ' tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"><div class="modal-dialog"' + (null == (__t = width ? ' style="width:' + width + 'px"' : "") ? "" : __t) + '><div class="modal-content"><div class="modal-body">' + (null == (__t = body) ? "" : __t) + "</div></div>\x3c!-- /.modal-content --\x3e</div>\x3c!-- /.modal-dialog --\x3e</div>\x3c!-- /.modal --\x3e"; return __p }, this.JST.moreWeight = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="weight-panel toggle-plugins"><div class="arrow"></div><form class="detail-search form-horizontal"><div class="form-group"><div class="row"><label for="weight-value" class="col-sm-3 control-label">' + (null == (__t = _l("快件重量")) ? "" : __t) + '</label><div class="col-sm-9 input-container input-group"><input placeholder="' + (null == (__t = _l("请输入大于0.1的重量")) ? "" : __t) + '" id="weight-value" type="text"class="form-control weight-value no-right-border"><span id=\'unitWeight\' class="input-group-addon no-left-border">kg</span></div></div></div><div class="form-group"><div class="description">' + (null == (__t = _l("或输入快件体积进行查询")) ? "" : __t) + '</div><div class="row"><label for="length-value" class="control-label col-sm-1 locale-fix">' + (null == (__t = _l("长")) ? "" : __t) + '</label><div class="col-sm-3 input-container locale-fix"><input id="length-value" type="text" class="form-control length-value" placeholder="cm"></div><label for="width-value" class="control-label col-sm-1 locale-fix">' + (null == (__t = _l("宽")) ? "" : __t) + '</label><div class="col-sm-3 input-container locale-fix"><input id="width-value" type="text" class="form-control width-value" placeholder="cm"></div><label for="length-value" class="control-label col-sm-1 locale-fix">' + (null == (__t = _l("高")) ? "" : __t) + '</label><div class="col-sm-3 input-container locale-fix"><input id="height-value" type="text" class="form-control height-value" placeholder="cm"></div></div></div><div class="error"></div><div class="text-center"><button class="weight-search primary-button disabled">' + (null == (__t = _l("计算")) ? "" : __t) + '</button></div><div class="extra-weight-side-note top-gray-gradient"><div class="form-group"><p>' + (null == (__t = _l("香港大件备注", "如您的货件是等同或高于下列重量, 请致电(852) 3123 6826顺丰大货组专线查询或报价")) ? "" : __t) + '</p></div><div class="form-group"><table class="table table-bordered"><thead><tr><th>' + (null == (__t = _l("原寄地")) ? "" : __t) + "</th><th>" + (null == (__t = _l("目的地")) ? "" : __t) + "</th><th>" + (null == (__t = _l("快件重量（kg）")) ? "" : __t) + '</th></tr></thead><tbody><tr><td rowspan="3">' + (null == (__t = _l("香港")) ? "" : __t) + "</td><td>" + (null == (__t = _l("香港／澳门")) ? "" : __t) + "</td><td>" + (null == (__t = _l("香港到香港／澳门大件重量", "200")) ? "" : __t) + "</td></tr><tr><td>" + (null == (__t = _l("台湾")) ? "" : __t) + "</td><td>" + (null == (__t = _l("香港到台湾大件重量", "100")) ? "" : __t) + "</td></tr><tr><td>" + (null == (__t = _l("大陆")) ? "" : __t) + "</td><td>" + (null == (__t = _l("香港到大陆大件重量", "150")) ? "" : __t) + "</td></tr></tbody></table></div></div></form></div>"; return __p }, this.JST.cargoInsure = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="cargo-insure-wrapper"><div class="clearfix"><img src="' + __e(imgUrl) + '" alt="保价服务图片" class="fl"><div class="fr"><p class="top-tip not-select" style="display: ' + __e(showNotSelectTip ? "block" : "none") + '">' + __e(notSelectTip) + '</p><p class="top-tip select" style="display: ' + __e(showSelectTip ? "block" : "none") + '">', "hk" == Helper.getSiteLocation() || "tw" == Helper.getSiteLocation() ? __p += __e(_l("感谢您使用顺丰保价服务")) : __p += __e(_l("温馨提示：感谢您使用顺丰保价服务，我们将竭诚保护您的货物安全，若在寄递过程中发生丢损，您最高可获得声明价值")) + "" + __e(currencyCode) + '<span class="number">' + __e(supportVal) + "</span>" + __e(_l("赔偿")), __p += '</p><form class="row">', "hk" == Helper.getSiteLocation() || "tw" == Helper.getSiteLocation() ? __p += '<div class="" style="width: 60%;margin-left: 15px;margin-top: 10px;"><span >' + __e(_l("请填写快件价值:")) + '</span><input style="    width: 150px;float: right;margin-top: -8px;" type="text" class="form-control" name="supportVal" placeholder="' + __e(_l("保价金额")) + '" value="' + __e(supportVal) + '"></div><div class="support-prise-wrapper" style="width: 30%;float: right;margin-top: -20px;">' + __e(_l("保费") + currencyCode) + ' <span class="supportPrise">' + __e(supportPrise) + "</span></div>" : __p += '<div class="col-xs-6"><input type="text" class="form-control" name="supportVal" placeholder="' + __e(_l("保价金额")) + '" value="' + __e(supportVal) + '"></div><div class="col-xs-6 support-prise-wrapper">' + __e(_l("保费") + currencyCode) + ' <span class="supportPrise">' + __e(supportPrise) + "</span></div>", __p += '</form><p class="bottom-tip">' + __e(exceedTip) + '</p></div></div><div class="text-right"><button type="button" class="primary-btn autowidth save">' + __e(_l("保存")) + "</button></div></div>"; return __p }, this.JST.cargoItems = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<ul class="sf-capsule">', _.each(list, function (e, t) { __p += '<li><a href="javascript:void(0)" data-index="' + __e(t) + '" class="' + __e(e.select ? "active" : "") + '"><span class="aicon-' + __e(e.icon) + '"></span>' + (null == (__t = e.name) ? "" : __t) + "</a></li>" }), __p += '</ul><form><div class="medicine-content " style="display: ' + __e(list[medciIndex].select ? "block" : "none") + '"><div class="form-group"><textarea class="form-control" name="medicine" rows="2" placeholder="' + (null == (__t = _l("请输入药品名称、数量、单位，保健品类请选择食品。&#10;例如：阿莫西林颗粒，2盒")) ? "" : __t) + '">' + __e(medci) + '</textarea></div><div class="form-group"><p class="tip">' + __e(_l("温馨提示：由于药品属于特殊托寄物，请确保收寄人信息准确无误，顺丰速运竭诚为您服务")) + '</p></div></div><div class="form-group other-content" style="display: ' + __e(list[otherIndex].select ? "block" : "none") + '"><input type="text" class="form-control" name="other" placeholder="' + __e(_l("请输入其他物品 *")) + '" value="' + __e(otherItem) + '"></div></form>'; return __p }, this.JST.cargoMsg = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="cargo-msg-wrapper"><h5>' + __e(_l("备注选项")) + '</h5><ul class="sf-capsule">', _.each(initMsgArr, function (e) { __p += '<li><a href="javascript:void(0)" ' + (null == (__t = _.contains(choosedMsgArr, e) ? ' class="active"' : "") ? "" : __t) + ">" + __e(e) + "</a></li>" }), __p += '</ul><form><input type="text" class="form-control" name="msg" placeholder="' + __e(_l("其他想对小哥说的话（如：物品体积较大）")) + '" value="' + __e(otherMsg) + '"></form><div class="text-right"><button class="primary-btn autowidth save">' + __e(_l("保存")) + "</button></div></div>"; return __p }, this.JST.cargoPayType = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="pay-type-wrapper"><h5>' + __e(_l("付款方式")) + '</h5><ul class="sf-capsule">', _.each(types, function (e) { __p += '<li><a href="javascript:void(0)" data-type="' + __e(e) + '" class="' + __e(e == chooseType ? "active" : "") + '"><span class="aicon-pay-type-' + __e(e) + '"></span>' + __e(_l(Helper.getPayType(e))) + "</a></li>" }), __p += '</ul><form class="form-horizontal"><div class="form-group month-account" style="display: ' + __e(4 == chooseType ? "block" : "none") + '"><div class="col-xs-8"><input type="text" class="form-control" name="account" placeholder="' + __e(_l("月结卡号 *")) + '"value="' + __e(monthAccount) + '"></div></div></form><button type="button" class="primary-btn autowidth save">' + __e(_l("保存")) + "</button></div>"; return __p }, this.JST.declareItems = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="declare-items"><div class="top-info clearfix"><button type="button" class="primary-btn square white add fl"><span class="aicon-zengjia-01 sficon"></span>' + __e(_l("新增物品")) + '</button><p class="fr value-wrapper">' + __e(_l("申报总值")) + '<span class="total-declare-value"></span><span class="total-declare-currency"></span></p></div><ul class="table-title clearfix"><li style="width: 17%">' + __e(_l("名称")) + '</li><li style="width: 12%">' + __e(_l("物品单价")) + '</li><li style="width: 13%">' + __e(_l("价格单位")) + '</li><li style="width: 12%">' + __e(_l("物品数量")) + '</li><li style="width: 12%">' + __e(_l("数量单位")) + '</li><li style="width: 17%">' + __e(_l("物品总价值")) + '</li><li style="width: 17%">' + __e(_l("操作")) + '</li></ul><div class="scroll"><table class="table table-striped table-hover">', _.each(list, function (e) { __p += '<tr data-id="' + __e(e.id) + '"><td style="width: 17%"><p>' + __e(isSc ? e.name || e.englishName : e.englishName || e.name) + '</p></td><td style="width: 12%"><p>' + __e(e.price) + '</p></td><td style="width: 13%"><p>' + __e(e.currency) + '</p></td><td style="width: 12%"><p>' + __e(e.quantity) + '</p></td><td style="width: 12%"><p>' + __e(e.uom) + '</p></td><td style="width: 17%"><p>' + __e(e.price * e.quantity + e.currency) + '</p></td><td style="width: 17%" class="options"><p><a href="javascript:void(0)" class="aicon-bianji edit"></a><a href="javascript:void(0)" class="aicon-delete2 delete"></a></p></td></tr>' }), __p += '</table></div><div class="text-right"><button type="button" class="primary-btn autowidth save">' + __e(_l("保存")) + "</button></div></div>"; return __p }, this.JST.declareType = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="cargo-declare-type"><h5>' + __e(_l("报关方式")) + '</h5><ul class="sf-capsule"><li><a href="javascript:void(0)" data-type="0" class="' + __e(0 == clearanceType ? "active" : "") + '">' + __e(_l("非正式报关")) + '</a></li><li><a href="javascript:void(0)" data-type="1" class="' + __e(1 == clearanceType ? "active" : "") + '">' + __e(_l("正式报关")) + '</a></li></ul><div class="declare-note" style="display:' + __e(1 == clearanceType ? "block" : "none") + '"><p class="declare-fee">' + __e(_l("正式报关费用：200元")) + '</p><p class="title">《' + __e(_l("正式报关须知")) + "》</p><p>" + __e(_l("除简易报关类以外，涉及出口收汇、出口退税、加工贸易手册、出口许可证管理、出口关税的；涉及进口付汇、加工贸易手册核销、增值税抵扣及进口许可证管理的货物。或申报价值超过5000元人民币、重量超过海关规定的货物。")) + "</p><p>" + __e(_l("注：需贵公司有进出口经营权，需准备的报关资料有“商业发票、装箱单、 报关委托书、合同、报关单，其他许可证件等”，且会产生正式报关相关费用。")) + '</p></div><div class="text-right"><button class="primary-btn autowidth save">' + __e(_l("保存")) + "</button></div></div>"; return __p }, this.JST.itemsAndWeight = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="weight-items"><h5 class="gray">' + __e(_l("托寄物类型")) + '</h5><div class="receiver-items-wrapper"></div><h5 class="gray">' + __e(_l("托寄物重量")) + '</h5><div class="normal-weight-wrapper"></div>', "hk" != Helper.getSiteLocation() && "tw" != Helper.getSiteLocation() || (__p += '<p class="weight-wrapper-tips">' + __e(_l("计费重量按收派员录入为准")) + "</p>"), __p += '<div class="text-right"><button type="button" class="primary-btn autowidth save">' + __e(_l("保存")) + "</button></div></div>"; return __p }, this.JST.itemsWeightAndVol = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="weight-items"><h5 class="gray">' + __e(_l("托寄物类型")) + '</h5><div class="receiver-items-wrapper"></div><h5 class="gray">' + __e(_l("具体规格")) + '</h5><div class="weight-vol-wrapper"></div><div class="text-right"><button type="button" class="primary-btn autowidth save">' + __e(_l("保存")) + "</button></div></div>"; return __p }, this.JST.newWeightAndVol = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<form class="form-horizontal"><div class="form-group"><div class="col-xs-4"><label class="control-label">' + __e(_l("预估重量")) + '：</label><div class="input-wrapper-aft"><input type="text" class="form-control weight" name="weight" value="' + __e(weight) + '" placeholder="' + __e(_l("请输入重量")) + '"><span class="sficon">kg</span></div></div><div class="col-xs-4"><label class="control-label">' + __e(_l("件数")) + '：</label><div class="input-wrapper-aft"><input type="text" class="form-control piece" name="piece" value="' + __e(quantity) + '" placeholder="' + __e(_l("请输入件数")) + '"><span class="sficon">' + __e(_l("件")) + '</span></div></div></div><div class="form-group weight-vol-tip"><div class="col-xs-12">' + __e(_l("提示：如有多个货物请填写总的重量与体积，最终实际收费以收派员实际上门秤量为准")) + '</div></div><div class="form-group"><div class="col-xs-4 cubic-meter-wrapper" ' + __e(lwh ? "style=display:none" : "") + '><label class="control-label">' + __e(_l("预估体积")) + '：</label><div class="input-wrapper-aft"><input type="text" class="form-control cubic-meter" name="cubic-meter" value="' + __e(volume) + '" placeholder="' + __e(_l("请输入体积")) + '"><span class="sficon">m³</span></div></div><div class="col-xs-12 l-w-h" ' + __e(lwh ? "" : "style=display:none") + '><label class="control-label">' + __e(_l("预估体积")) + '：</label><div class="row"><div class="col-xs-4"><div class="input-wrapper-aft"><input type="text" class="form-control v-length" name="length" value="' + __e(length) + '" placeholder="' + __e(_l("长")) + '"><span class="sficon">cm</span></div></div><div class="col-xs-4"><div class="input-wrapper-aft"><input type="text" class="form-control v-width" name="width" value="' + __e(width) + '" placeholder="' + __e(_l("宽")) + '"><span class="sficon">cm</span></div></div><div class="col-xs-4"><div class="input-wrapper-aft"><input type="text" class="form-control v-height" name="height" value="' + __e(height) + '" placeholder="' + __e(_l("高")) + '"><span class="sficon">cm</span></div></div></div></div></div><div class="form-group"><div class="col-xs-12"><div class="btn-group volToggle"><button type="button" class="btn primary-btn white cubicMeter' + __e(lwh ? "" : " active") + '">' + __e(_l("立方米")) + '</button><button type="button" class="btn primary-btn white lwh' + __e(lwh ? " active" : "") + '">' + __e(_l("长宽高")) + "</button></div></div></div></form>"; return __p }, this.JST.noDeclareItems = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="no-declare-items"><p class="tip">' + __e(_l("还未添加海关申报物品，请点击下面按钮新增")) + '</p><button type="button" class="primary-btn square white add"><span class="aicon-zengjia-01 sficon"></span>' + __e(_l("新增物品")) + "</button></div>"; return __p }, this.JST.onlyCargoWeight = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="normal-weight-wrapper"></div><div class="text-right"><button type="button" class="primary-btn autowidth save">' + __e(_l("保存")) + "</button></div>"; return __p }, this.JST.showBillDetail = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<li class="gray">' + __e(_l("包裹")) + "</li><li>" + __e(info.cargo) + '</li><li class="gray">' + __e(_l("保价")) + "</li><li>" + __e(info.declaredValue) + "</li>", hideCargoService || (__p += '<li class="gray">' + __e(_l("增值服务")) + "</li><li>" + __e(info.additionalText) + "</li>"), __p += '<li class="gray">' + __e(_l("付款方式")) + "</li><li>" + __e(info.payType) + '</li><li class="gray">' + __e(_l("重量")) + "</li><li>" + __e(info.weight) + '</li><li class="gray">' + __e(_l("预估运费")) + "</li><li>" + __e(info.metaPrice) + "</li>"; return __p }, this.JST.notIndustryResult = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<table class="table"><thead><tr><th>' + (null == (__t = _l("香港18区")) ? "" : __t) + "</th><th>" + (null == (__t = _l("细分区")) ? "" : __t) + "</th><th>" + (null == (__t = _l("街道名称")) ? "" : __t) + "</th><th>" + (null == (__t = _l("大厦名称")) ? "" : __t) + "</th><th>" + (null == (__t = _l("地址属性")) ? "" : __t) + "</th></tr></thead><tbody>", _.each(results, function (e, t) { __p += "<tr><td>" + (null == (__t = e.area) ? "" : __t) + "</td><td>" + (null == (__t = e.town) ? "" : __t) + "</td>", "A" != e.road ? __p += "<td>" + (null == (__t = e.road) ? "" : __t) + "</td>" : __p += "<td></td>", __p += "<td>" + (null == (__t = e.address) ? "" : __t) + "</td><td>" + (null == (__t = e.businessType) ? "" : __t) + "</td></tr>" }), __p += "</tbody></table>"; return __p }, this.JST.autocompleteAddressBook = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += "<p><span>" + __e(item.contactName) + "</span>", item.companyName && (__p += "<span>" + __e(item.companyName) + "</span>"), item.contactTel && (__p += "<span>" + __e(item.contactTel) + "</span>"), item.contactPhone && (__p += "<span>" + __e(item.contactPhone) + "</span>"), item.customerId && (__p += "<span>" + __e(item.customerId) + "</span>"), __p += "</p><p><span>" + __e(_.uniq(_.compact([item.province, item.city, item.county, item.address]), !0).join("")) + "</span></p>"; return __p }, this.JST.billInfoCommon = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<ul class="bill-options-list clearfix">', hasCargoItems && (__p += '<li><a href="javascript:void(0)" class="items-weight"><dl><dt><span class="aicon-document"></span></dt><dd class="items-show">' + __e(_l("未选择托寄物")) + '</dd><dd class="weight-show"></dd></dl></a><p class="title require">' + __e(_l("托寄物信息")) + "</p></li>"), hasDeclareItems && (__p += '<li><a href="javascript:void(0)" class="add-items"><dl><dt><span class="aicon-other"></span></dt><dd class="items-show">' + __e(_l("未添加申报物品")) + '</dd></dl></a><p class="title require">' + __e(_l("申报物品")) + "</p></li>"), __p += '<li><a href="javascript:void(0)" class="cargo-pay-type"><dl><dt><span class="aicon-pay-type-1"></span></dt><dd class="pay-type-show">' + __e(_l(Helper.getPayType(payType))) + '</dd></dl></a><p class="title">' + __e(_l("付款方式")) + "</p></li>", hasTaxPayType && (__p += '<li><a href="javascript:void(0)" class="tax-pay-type"><dl><dt><span class="aicon-pay-type-1"></span></dt><dd class="tax-pay-type-show">' + __e(_l("到付")) + '</dd></dl></a><p class="title">' + __e(_l("税金") + _l("付款方式")) + "</p></li>"), hasOnlyWeight && (__p += '<li><a href="javascript:void(0)" class="cargo-weight"><dl><dt><span class="aicon-3kg"></span></dt><dd class="cargo-weight-show">1kg</dd></dl></a><p class="title">' + __e(_l("预估重量")) + "</p></li>"), hasCargoService && (__p += '<li><a href="javascript:void(0)" class="cargo-service"><dl><dt><span class="aicon-diamond"></span></dt><dd class="servive-show">' + __e(_l("无增值服务")) + '</dd></dl></a><p class="title">' + __e(_l("增值服务")) + "</p></li>"), __p += '<li><a href="javascript:void(0)" class="cargo-insure"><dl><dt><span class="aicon-umbrella"></span></dt><dd class="cargo-insure-show">' + __e(_l("未选择保价")) + '</dd><dd class="cargo-insure-price-show"></dd></dl></a><p class="title">' + __e(_l("保价服务")) + "</p></li>", hasMsg && (__p += '<li><a href="javascript:void(0)" class="cargo-msg"><dl><dt><span class="aicon-msg"></span></dt><dd class="cargo-msg-show">' + __e(_l("无")) + '</dd></dl></a><p class="title">' + __e(_l("备注信息")) + "</p></li>"), hasDeclareType && (__p += '<li><a href="javascript:void(0)" class="cargo-declare-type"><dl><dt><span class="aicon-declare-type"></span></dt><dd class="cargo-declare-show">' + __e(_l("非正式报关")) + '</dd></dl></a><p class="title">' + __e(_l("报关方式")) + "</p></li>"), __p += '<li class="cargo-self-pick-wrapper"><a href="javascript:void(0)" class="cargo-self-pick"><dl><dt><span class="aicon-self-pick"></span></dt><dd class="self-pick-show">' + __e(_l("不自取")) + '</dd></dl></a><p class="title">' + __e(_l("自取服务")) + "</p></li></ul>"; return __p }, this.JST.clearanceItemForm = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<form class="form-horizontal clearance-item-form" autocomplete="off" data-parsley-validate>', fromAcs || (__p += '<div class="form-group"><label class="control-label col-xs-3">' + __e(_l("选择类型")) + '：</label><div class="col-xs-9"><div class="radio-inline"><label><input type="radio" class="itemType" name="itemType" value="file" ' + __e("file" != data.declareType && data.declareType ? "" : "checked") + ">" + __e(_l("文件")) + '</label></div><div class="radio-inline"><label><input type="radio" class="itemType" name="itemType" value="goods" ' + __e("goods" == data.declareType ? "checked" : "") + ">" + __e(_l("物品")) + "</label></div></div></div>"), __p += '<div class="form-group hidediv goods-input-required"><label class="control-label col-xs-3">' + __e(_l("物品名称")) + '：</label><div class="col-xs-8"><input type="text" class="form-control goodsName" value="' + __e("file" != data.declareType && data.declareType ? data.name : "") + '" data-value="' + __e(data.en) + '" data-parsley-required data-parsley-maxlength="50"data-parsley-trigger="change" placeholder="' + __e(_l("请填写物品名称")) + '"><ul class="dropdown-menu dropdown-menu-align goodsName-hint"></ul></div></div><div class="form-group error goodsName-contraband"><div class="col-xs-9 col-xs-offset-3">' + __e(_l("请按“品名+材质+规格型号”填写，如：男士棉衬衫")) + '</div></div><div class="form-group error goodsName-fuzzy"><div class="col-xs-9 col-xs-offset-3">' + __e(_l("此物品为违禁品，请重新选择")) + '</div></div><div class="form-group hidediv goods-input-required"><label class="control-label col-xs-3">' + __e(_l("物品单价")) + '：</label><div class="col-xs-3"><input type="text" class="form-control price" value="' + __e(data.price) + '" data-parsley-required data-parsley-pattern="^(?:[1-9][0-9]*\\.[0-9]+|0\\.(?!0+$)[0-9]+|[1-9]+\\d*)$" data-parsley-maxlength="10" data-parsley-pattern-message="' + __e(_l("请输入正整数或正小数")) + '" data-parsley-trigger="change"placeholder="' + __e(_l("请填写")) + '"></div><div class="col-xs-3"><select class="form-control currency"></select></div></div><div class="form-group hidediv goods-input-required"><label class="control-label col-xs-3">' + __e(_l("物品数量")) + '：</label><div class="col-xs-3">', fromAcs ? __p += '<input type="text" class="form-control goodsQuantity" value="1" readonly>' : __p += '<input type="text" class="form-control goodsQuantity" value="' + __e(data.quantity) + '" data-parsley-required data-parsley-pattern="^[1-9]\\d*$" data-parsley-maxlength="10" data-parsley-pattern-message="' + __e(_l("请输入正整数")) + '"  data-parsley-trigger="change" placeholder="' + __e(_l("请填写")) + '">', __p += '</div><div class="col-xs-3"><select class="form-control unit"></select></div><div class="col-xs-3"><input type="text" class="form-control hidediv otherUnit" placeholder="' + __e(_l("请填写")) + '"></div></div><div class="form-group error unit-error"><div class="col-xs-9 col-xs-offset-3">' + __e(_l("您输入的单位不存在，请重新输入")) + "</div></div>", "tw" == Helper.getSiteLocation() && (__p += '<div class="form-horizontal countryOfOrigin"><div class="form-group hidediv goods-input-required"><label class="control-label col-xs-3">' + __e(_l("原产地")) + '：</label><div class="col-xs-3"><select class="form-control" id="recommendCountrys"></select></div><div class="col-xs-3 orther-contry" style="display: none"><input type="text" class="form-control" placeholder="' + __e(_l("请选择原产地")) + '"></div></div><div class="form-group error country-err"><div class="col-xs-3 col-xs-offset-6">' + __e(_l("请输入正确原产地名称")) + '</div></div><div class="form-group error network-err"><div class="col-xs-3 col-xs-offset-6">' + __e(_l("网络故障，请稍后重试")) + '</div></div><div class="form-group error country-empty"><div class="col-xs-3 col-xs-offset-6">' + __e(_l("必填项")) + "</div></div></div>"), fromAcs || (__p += '<div class="form-group submit"><button type="button" class="primary-button clearanceItemSubmitBtn">' + __e(_l("确定")) + "</button></div>"), __p += "</form>"; return __p }, this.JST.heavyCargo = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="heavy-cargo-wrapper"><a target="_blank" href="' + __e(_l("order.heavy.cargo.image.link")) + '"><img class="banner" src="' + __e(imgUrl) + '" alt="寄大件顶部图片"></a><div class="sender-wrapper"></div><div class="receiver-wrapper"></div><div class="form-group"><div class="clearfix"><a href="javascript:void(0)" class="aicon-circle-check save-address-check checked maidian fr" data-md-name="点击收件人保存到地址簿" data-md-id="111007">' + __e(_l("保存到地址簿")) + '</a></div></div><div class="other-info-wrapper"><div class="sftitle">' + __e(_l("预约信息")) + '</div><label class="control-label required">' + __e(_l("上门时间")) + '：</label><div class="pickup-time aicon-time"><input type="text" class="form-control readonly" placeholder="' + __e(_l("请选择您适合的时间")) + '" readonly id="date"name="date"/></div><div class="product-type-content"><label class="control-label required">' + __e(_l("快递产品")) + '：</label><ul class="product-type-wrapper"></ul></div><div class="clearfix other-info-title"><div class="sftitle fl">' + __e(_l("完善快件信息")) + '</div><p class="fr predict">' + __e(_l("预计价格")) + ' <span class="sficon aicon-money red"></span><span class="predict-money red">--</span><span class="red">' + __e(_l("起")) + '</span></p></div><div class="bill-options-list-wrapper"></div></div><div class="text-center"><a href="javascript:void(0)" class="aicon-circle-check" id="agree-term-content">' + __e(_l("我同意")) + '</a><a class="term" href="javascript:void(0)">《' + __e(_l("电子运单契约条款")) + '》</a></div><div class="text-center"><button type="button" class="primary-btn submit-order big disabled">' + __e(_l("下单")) + "</button></div></div>"; return __p }, this.JST.hkOrderService = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="order-service ui-front"><div class="order-wrapper clearfix"></div></div>'; return __p }, this.JST.orderService = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="order-service ui-front"><div class="receiver-areas" role="radiogroup"><a href="javascript:void(0)" class="toggle-tab" role="radio" data-tab="normalCargo">' + __e(_l("寄快递")) + '</a><a href="javascript:void(0)" class="toggle-tab" role="radio" data-tab="heavyCargo">' + __e(_l("寄大件")) + '</a><a href="javascript:void(0)" class="toggle-tab" role="radio" data-tab="qrCode">' + __e(_l("二维码寄件")) + '</a></div><div class="order-wrapper clearfix"></div></div>'; return __p }, this.JST.orderSuccess = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="order-success">', isQr ? __p += '<div class="bill-head"><h3>' + __e(_l("运单填写成功")) + "</h3><h4>" + __e(_l("温馨提示：请把“顺丰联”粘贴在包裹上，并交由快递员揽收")) + "</h4><p>" + __e(_l("运单号")) + "： " + __e(waybillNo) + "</p></div>" : __p += "<h3>" + __e(_l("下单成功！")) + "</h3>", null != data ? (isQr || (__p += '<button class="primary-btn white small fr cancel"><span class="aicon-bs-refused"></span>' + __e(_l("取消寄件")) + "</button>"), isSelfSend && (__p += '<p class="certificate-prompt">' + __e("tw" !== Helper.getSiteLocation() ? _l("下单后可打印电子运单二维码，向收派员或到顺丰服务点出示二维码，扫码后快速寄件") : _l("請列印電子運單二維碼，向收派員或到順豐服務點出示二維碼，掃碼後快速寄件")) + "</p>"), "cn" === Helper.getSiteLocation() && (__p += '<p class="certificate-prompt">' + __e(_l("温馨提示：根据《中华人民共和国反恐怖主义法》《邮件快件实名收寄管理办法》相关要求，寄件时需出示身份证等有效身份证件进行实名登记，请勿寄递禁寄物品，谢谢配合；")) + "</p>"), isQr || isSelfSend || (__p += '<div class="delivery-brother clearfix"><div class="fl"><span class="fl bill-man-head"></span><div class="fl man-info"><div><span class="man-name">' + __e(data.resoure.resourceName || _l("顺丰小哥")) + '</span><div class="star"><span class="gray"><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span></span><span class="red' + __e(data.resoure.resourceName ? "" : " none") + '"><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span></span><span class="number">' + __e(data.resoure.resourceName ? data.resoure.grade : 0) + "</span></div></div><div><span>" + __e(_l("联系电话")) + " </span><span>" + __e(data.resoure.telphone || "") + '</span></div></div></div><div class="fr clearfix" style="margin-top:5px; text-align: right;"><div><span class="gray">' + __e(_l("预计上门时间")) + "</span></div><div>" + __e(relativeDate) + '<span class="delivery-time">' + __e(relativeHour) + "</span></div></div></div>"), __p += '<div class="sfcard pad"><table class="sender-table"><tr><td class="send-badge"><span class="sfbadge black">' + __e(_l("寄")) + '</span><span class="aicon-v-dot"></span></td><td class="express-info"><p class="bold">' + __e(sender.contactName) + "</p><p>" + __e(sender.contactTel || sender.contactPhone) + '</p></td><td colspan="2"><p>' + __e(_.uniq(_.compact([sender.province, sender.city, sender.county]), !0).join("")) + "</p><p>" + __e(sender.address) + '</p></td></tr></table><p class="line"></p><table><tr><td><span class="sfbadge red">' + __e(_l("收")) + '</span></td><td class="express-info"><p class="bold">' + __e(receiver.contactName) + "</p><p>" + __e(receiver.contactTel || receiver.contactPhone) + '</p></td><td colspan="2"><p>' + __e(_.uniq(_.compact([receiver.province, receiver.city, receiver.county]), !0).join("")) + "</p><p>" + __e(receiver.address) + '</p></td></tr><tr><td></td><td colspan="3"><p>' + __e(_l("预约号")) + "： " + __e(data.appointmentNo) + '</p></td></tr></table><ul class="bill-other-info"><li><p class="gray">' + __e(_l("托寄物品信息")) + "</p><p>" + __e(info.cargo) + '</p></li><li><p class="gray">' + __e(_l("付款方式")) + "</p><p>" + __e(info.payType) + "</p></li>", hasCargoInsure && (__p += '<li><p class="gray">' + __e(_l("保价")) + "</p><p>" + __e(info.declaredValue) + "</p></li>"), hasCargoService && (__p += '<li><p class="gray">' + __e(_l("增值服务")) + "</p><p>" + __e(info.additionalText) + "</p></li>"), __p += "</ul></div>") : __p += '<img src="' + __e(imgUrl) + '" alt="下单成功图片">', __p += '<div class="clearfix options"><a href="' + __e(waybillUrl) + '" class="primary-btn white square fl go-waybill"><span class="aicon-intellect-address"></span>' + __e(_l("查看订单列表")) + "</a>", null != data && (isQr ? __p += '<button class="primary-btn big order-again fr maidian" data-md-name="再下一单" data-md-id="125002">' + __e(_l("再下一单")) + "</button>" : (isSelfSend && (__p += '<button class="primary-btn white square fl download"><span class="aicon-i-down"></span>' + __e(_l("下载电子运单")) + "</button>"), __p += '<button class="primary-btn big fill-bill fr">' + __e(_l("完善快件信息")) + "</button>")), __p += "</div></div>"; return __p }, this.JST.qrCode = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="qr-code"><h3 class="title">' + __e(_l("有扫码寄件")) + '<a href="javascript:void(0)" class="paper-bill">' + __e(_l("纸质运单")) + '<span class="aicon-ask"></span></a></h3><ul class="step" flex="cross:stretch"><li><span>01</span><p>' + __e(_l("输入纸质二维码上的运单号")) + "</p></li><li><span>02</span><p>" + __e(_l("填写寄件信息")) + "</p></li><li><span>03</span><p>" + __e(_l("将包裹与二维码交给收派员")) + '</p></li></ul><form class="clearfix"><input type="text" class="fl" name="billNumber" placeholder="' + __e(_l("请输入运单号以开始")) + '"><button class="fl primary-btn square big" type="submit">' + __e(_l("下一步")) + '</button></form><p class="tip">' + __e(_l("温馨提示：此方式下单不会通知快递员上门取件。如需快递员及时上门收件，请使用“寄快递”下单或联系快递员。")) + '</p><img src="' + __e(imgUrl) + '" alt="二维码下单图片" class="qr-order-img"></div>'; return __p }, this.JST.qrCodeCloud = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="qr-code-cloud"><ul class="step" flex="cross:stretch"><li class="active"><strong>01</strong><i></i><p>' + __e(_l("扫描纸质运单二维码")) + "</p></li><li><strong>02</strong><i></i><p>" + __e(_l("填写寄件信息")) + "</p></li><li><strong>03</strong><i></i><p>" + __e(_l("将包裹与二维码交给收派员")) + '</p></li></ul><h3 class="title">' + __e(_l("请用手机微信扫描")) + '<a href="javascript:void(0)" class="paper-bill">' + __e(_l("纸质运单")) + '<span class="aicon-ask"></span></a>' + __e(_l("上的二维码")) + '</h3><form class="clearfix"><input type="text" class="fl" name="billNumber" placeholder="' + __e(_l("待补充运单号")) + '"><button class="fl primary-btn square big" type="submit">' + __e(_l("下一步")) + '</button></form><p class="tip">' + __e(_l("温馨提示：")) + "<br>" + __e(_l("1. 如扫描二维码后无法自动识别出运单号，请检查您的顺丰速运微信公众号是否用同一账号登录；")) + "<br>" + __e(_l("2. 此方式下单不会通知快递员上门取件。如需快递员及时上门收件，请使用“寄快递”下单或联系快递员。")) + '</p><img src="' + __e(imgUrl) + '" alt="' + __e(_l("二维码下单图片")) + '" class="qr-order-img"></div>'; return __p }, this.JST.qrCodeCloudTip = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="qr-code-cloud-tip"><span class="gray">' + __e(_l("运单号")) + "：" + __e(billNum) + " </span><p>" + __e(_l("获取运单号成功，您可直接在官网页面填写并提交运单信息，无需在手机端界面重复填写。")) + "</p></div>"; return __p }, this.JST.qrOrder = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="qr-order"><p class="waybill-no">' + __e(_l("运单号：")) + " " + __e(waybillNo) + '</p><div class="sender-wrapper"></div><div class="receiver-wrapper"></div><div class="form-group"><div class="clearfix"><a href="javascript:void(0)" class="aicon-circle-check save-address-check checked maidian fr" data-md-name="点击收件人保存到地址簿" data-md-id="111007">' + __e(_l("保存到地址簿")) + '</a></div></div><div class="other-info-wrapper"><div class="sftitle">' + __e(_l("预约信息")) + '</div><label class="control-label required time-compo">' + __e(_l("上门时间")) + '：</label><div class="pickup-time aicon-time time-compo"><input type="text" class="form-control readonly" placeholder="' + __e(_l("请选择您适合的时间")) + '" readonly id="date"name="date"/></div><div class="product-type-content"><label class="control-label required">' + __e(_l("快递产品")) + '：</label><ul class="product-type-wrapper"></ul></div><div class="clearfix other-info-title"><div class="sftitle fl">' + __e(_l("完善快件信息")) + '</div><p class="fr predict">' + __e(_l("预计价格")) + ' <span class="sficon aicon-money red"></span><span class="predict-money red">--</span><span class="red">' + __e(_l("起")) + '</span></p><a href="' + __e(acceptUrl) + '" class="fr accept">' + __e(_l("违禁品查询")) + '</a></div><div class="bill-options-list-wrapper"></div></div><div class="text-center"><a href="javascript:void(0)" class="aicon-circle-check" id="agree-term-content">' + __e(_l("我同意")) + '</a><a class="term" href="javascript:void(0)">《' + __e(_l("电子运单契约条款")) + '》</a></div><div class="text-center"><button type="button" class="primary-btn submit-order big disabled">' + __e(_l("下单")) + "</button></div></div>"; return __p }, this.JST.smartFilling = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<p class="intellect-fill-prompt">' + __e(_l("粘贴整段地址，自动识别姓名、电话和地址")) + '</p><div class="intellect-fill"><textarea class="intellect-order-addr" placeholder="' + __e(_l("例如：顺小哥，13200000000，广东省深圳市南山区某某街道某某大厦001号")) + '"></textarea><p class="intellect-fill-num"><span class="intellect-fill-input">0</span>/<span>100</span></p></div><div class="text-center"><button type="button" class="primary-btn autowidth intellect-fill-btn disabled">' + __e(_l("提交")) + "</button></div>"; return __p }, this.JST.orderProductTypeList = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) data.showErr ? __p += '<li><a href="javascript:void(0)" data-value="' + __e(data.limitTypeCode) + '" class="active"><span class="aicon-right"></span><span class="angle"></span><dl><dt>' + __e(data.totalFreight) + "</dt><dd><p>" + __e(data.deliverTime) + "</p></dd></dl></a></li>" : _.each(data, function (e) { __p += '<li><a href="javascript:void(0)" data-value="' + __e(e.limitTypeCode) + '" class="' + __e(e.limitTypeCode == defaultProduct.limitTypeCode ? "active" : "") + '"><span class="aicon-right"></span><span class="angle"></span><dl><dt><span class="currency">' + __e(currencyCode) + '</span><span class="rate">' + __e(parseFloat(e.totalFreight) || 0) + '</span><span class="up">' + __e(_l("起")) + "</span></dt><dd><p>" + __e(e.deliverTime ? e.deliverTime : _l(e.limitTypeName + "时效")) + "</p></dd><dd><p>" + __e(_l("截单时间")) + "： " + __e(e.closedTime ? e.closedTime : "") + "</p></dd></dl></a></li>" }); return __p }, this.JST.graphValidate = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<form><div class="form-group"><div><img src="" alt="图形验证码图片" class="graph-validate-img" tabindex="0"></div></div><div class="form-group"><input type="text" class="form-control graph-validate-input" placeholder="' + (null == (__t = _l("请输入图片中的验证码")) ? "" : __t) + '" autocomplete="off"></div><div class="form-group text-center"><button type="submit" class="primary-btn autowidth">' + (null == (__t = _l("确定")) ? "" : __t) + "</button></div></form>"; return __p }, this.JST.modal = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="modal" id=' + (null == (__t = id) ? "" : __t) + ' tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>', title && (__p += '<h4 class="modal-title" id="myModalLabel">' + __e(title) + "</h4>"), __p += '</div><div class="modal-body"></div></div></div></div>'; return __p }, this.JST.otherService = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) _.each(otherServices, function (e, t) { __p += '<a target="_blank" href="' + (null == (__t = e.get("link")) ? "" : __t) + '" class="other-service clearfix" ' + (null == (__t = e.isExternal ? 'target="_blank"' : "") ? "" : __t) + '><div class="service-info col-xs-8"><div class="service-title ' + (null == (__t = e.get("isPromotion") ? "promote" : "") ? "" : __t) + '"><span class="overflow-text" title="' + (null == (__t = e.get("name")) ? "" : __t) + '">' + (null == (__t = e.get("name")) ? "" : __t) + '</span></div><div class="service-description"><span title="' + (null == (__t = e.get("description")) ? "" : __t) + '">' + (null == (__t = e.get("description")) ? "" : __t) + '</span></div></div><div class="col-xs-4"><div class="hot"><div class="hot-tag" title="' + (null == (__t = e.get("sale")) ? "" : __t) + '"><span class="overflow-text" title="' + (null == (__t = e.get("sale")) ? "" : __t) + '">' + (null == (__t = e.get("sale")) ? "" : __t) + '</span></div><div class="hot-text" title="' + (null == (__t = e.get("client")) ? "" : __t) + '">' + (null == (__t = e.get("client")) ? "" : __t) + "</div></div></div></a>" }); return __p }, this.JST.pagination = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) { if (__p += '<ul class="pagination"><li class="prevPage ' + (null == (__t = pageIndex <= 1 ? "disable" : "") ? "" : __t) + '"><a href="#page=' + (null == (__t = 1 < pageIndex ? pageIndex - 1 : pageIndex) ? "" : __t) + '"class= "' + (null == (__t = 1 < pageIndex ? "news_month_pagination" : "") ? "" : __t) + '"data-pageindex="' + (null == (__t = 1 < pageIndex ? pageIndex - 1 : pageIndex) ? "" : __t) + '"><<</a></li>', pageIndex < 20) for (var i = 1; i <= pageCount - 1; i++)i <= 20 && (__p += '<li class="' + (null == (__t = pageIndex === i ? "current" : "") ? "" : __t) + '"><a href="#page=' + (null == (__t = i) ? "" : __t) + '" class= "' + (null == (__t = pageIndex != i ? "news_month_pagination" : "") ? "" : __t) + '"data-pageindex="' + (null == (__t = i) ? "" : __t) + '">' + (null == (__t = i) ? "" : __t) + "</a></li>"); else if (20 <= pageIndex && pageIndex < pageCount) for (var i = pageIndex - 20 + 2; i <= pageIndex + 1; i++)__p += '<li class="' + (null == (__t = pageIndex === i ? "current" : "") ? "" : __t) + '"><a href="#page=' + (null == (__t = i) ? "" : __t) + '" class= "' + (null == (__t = pageIndex != i ? "news_month_pagination" : "") ? "" : __t) + '"data-pageindex="' + (null == (__t = i) ? "" : __t) + '">' + (null == (__t = i) ? "" : __t) + "</a></li>"; else if (pageIndex == pageCount) for (var i = pageCount - 19; i <= pageCount; i++)__p += '<li class="' + (null == (__t = pageIndex === i ? "current" : "") ? "" : __t) + '"><a href="#page=' + (null == (__t = i) ? "" : __t) + '" class= "' + (null == (__t = pageIndex != i ? "news_month_pagination" : "") ? "" : __t) + '"data-pageindex="' + (null == (__t = i) ? "" : __t) + '">' + (null == (__t = i) ? "" : __t) + "</a></li>"; 20 < pageCount && (__p += '<li class=""><a href="#" class="">...</a></li>'), __p += '<li class="' + (null == (__t = pageIndex == pageCount ? "current" : "") ? "" : __t) + '"><a href="#page=' + (null == (__t = pageCount) ? "" : __t) + '"class= "' + (null == (__t = pageIndex != pageCount ? "news_month_pagination" : "") ? "" : __t) + '"data-pageindex="' + (null == (__t = pageCount) ? "" : __t) + '">' + (null == (__t = pageCount) ? "" : __t) + '</a></li><li class="nextPage ' + (null == (__t = pageIndex >= pageCount ? "disable" : "") ? "" : __t) + '">', pageIndex != pageCount ? __p += '<a href="#page=' + (null == (__t = pageIndex + 1) ? "" : __t) + '"class= "' + (null == (__t = pageIndex < pageCount ? "news_month_pagination" : "") ? "" : __t) + '"data-pageindex="' + (null == (__t = pageIndex + 1) ? "" : __t) + '">>></a>' : __p += '<a href="#page=' + (null == (__t = pageIndex) ? "" : __t) + '>" class="" data-pageindex = "' + (null == (__t = pageIndex) ? "" : __t) + '">>></a>', __p += "</li></ul>" } return __p }, this.JST.paginationPro = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) if (1 < pageCount) { if (__p += '<div class="content-page-hk-pages"><ul class="pagination"><li class="' + (null == (__t = 1 == pageIndex ? "current" : "") ? "" : __t) + '"><a href="#page= ' + (null == (__t = 1) ? "" : __t) + '"class= "' + (null == (__t = 1 != pageIndex ? "goToPage" : "") ? "" : __t) + '"data-pageindex="' + (null == (__t = 1) ? "" : __t) + '">' + (null == (__t = _l("第一页")) ? "" : __t) + '</a></li><li class="prevPage ' + (null == (__t = pageIndex <= 1 ? "disable" : "") ? "" : __t) + '">', 1 < pageIndex ? __p += '<a href="#page= ' + (null == (__t = pageIndex - 1) ? "" : __t) + '"class= "' + (null == (__t = 1 < pageIndex ? "goToPage" : "") ? "" : __t) + '"data-pageindex="' + (null == (__t = pageIndex - 1) ? "" : __t) + '" ><<</a>' : __p += '<a href="#" onclick="return false;">&lt;&lt;</a>', __p += "</li>", 10 < pageCount) for (var i = Number(pageIndex); i <= Number(pageIndex) + Number(9); i++)Number(pageIndex) + Number(9) < pageCount ? __p += '<li class="' + (null == (__t = pageIndex == i ? "current" : "") ? "" : __t) + '"><a href="#page= ' + (null == (__t = i) ? "" : __t) + '"class= "' + (null == (__t = pageIndex != i ? "goToPage" : "") ? "" : __t) + '"data-pageindex="' + (null == (__t = i) ? "" : __t) + '">' + (null == (__t = i) ? "" : __t) + "</a></li>" : __p += '<li class="' + (null == (__t = pageIndex == i - 9 ? "current" : "") ? "" : __t) + '"><a href="#page= ' + (null == (__t = i - 9) ? "" : __t) + '"class= "' + (null == (__t = pageIndex != i - 9 ? "goToPage" : "") ? "" : __t) + '"data-pageindex="' + (null == (__t = i - 9) ? "" : __t) + '">' + (null == (__t = i - 9) ? "" : __t) + "</a></li>"; else for (var i = 1; i <= pageCount; i++)__p += '<li class="' + (null == (__t = pageIndex == i ? "current" : "") ? "" : __t) + '"><a href="#page= ' + (null == (__t = i) ? "" : __t) + '"class= "' + (null == (__t = pageIndex != i ? "goToPage" : "") ? "" : __t) + '"data-pageindex="' + (null == (__t = i) ? "" : __t) + '">' + (null == (__t = i) ? "" : __t) + "</a></li>"; __p += '<li class="nextPage ' + (null == (__t = pageIndex >= pageCount ? "disable" : "") ? "" : __t) + '">', pageIndex < pageCount ? __p += '<a href="#page= ' + (null == (__t = Number(pageIndex) + Number(1)) ? "" : __t) + '"class= "' + (null == (__t = pageIndex < pageCount ? "goToPage" : "") ? "" : __t) + '"data-pageindex="' + (null == (__t = Number(pageIndex) + Number(1)) ? "" : __t) + '">>></a>' : __p += '<a href="#" onclick="return false;">&gt;&gt;</a>', __p += '</li><li class="' + (null == (__t = pageIndex == pageCount ? "current" : "") ? "" : __t) + '"><a href="#page= ' + (null == (__t = pageCount) ? "" : __t) + '"class= "' + (null == (__t = pageIndex != pageCount ? "goToPage" : "") ? "" : __t) + '"data-pageindex="' + (null == (__t = pageCount) ? "" : __t) + '">' + (null == (__t = _l("最后一页")) ? "" : __t) + "</a></li></ul></div>" } return __p }, this.JST.promptDialogTemplate = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) itemList.length && _.each(itemList, function (e) { var t; t = "EN" == e.lang ? e.enTxt : e.txt + (e.enTxt ? "&nbsp;&nbsp;(" + e.enTxt + ")" : ""), __p += '<li><a href="javascript:void(0);" class="text-muted-1"><span class="' + (null == (__t = e.selectable ? "text-muted-1" : "text-muted") ? "" : __t) + '"  data-unit="' + (null == (__t = e.unit) ? "" : __t) + '" data-selectable="' + (null == (__t = e.selectable) ? "" : __t) + '" data-sc= "' + (null == (__t = e.value) ? "" : __t) + '" data-en="' + (null == (__t = e.enTxt) ? "" : __t) + '">' + (null == (__t = t) ? "" : __t) + "</span>" + (null == (__t = e.selectable ? "" : '<span class="text-muted-2">违禁品</span>') ? "" : __t) + "</a></li>" }); return __p }, this.JST.storePoint = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="store"><ul class="promotions">', store.selfPickupDiscount && (__p += "<li>" + (null == (__t = _l("自取")) ? "" : __t) + '<div class="price">', 3 == store.storeType ? __p += null == (__t = _p(_l("赠%f元积分"), store.selfSendDiscount)) ? "" : __t : __p += null == (__t = _p(_l("省%f元"), store.selfSendDiscount)) ? "" : __t, __p += "</div></li>"), store.selfSendDiscount && (__p += "<li>" + (null == (__t = _l("自寄")) ? "" : __t) + '<div class="price">', 3 == store.storeType ? __p += null == (__t = _p(_l("赠%f元积分"), store.selfSendDiscount)) ? "" : __t : __p += null == (__t = _p(_l("省%f元"), store.selfSendDiscount)) ? "" : __t, __p += "</div></li>"), __p += "</ul>", store.services && 0 < store.services.length && (__p += '<ul class="services">', _.each(store.services, function (e) { __p += '<li class="' + (null == (__t = e.flag) ? "" : __t) + '">' + (null == (__t = e.name) ? "" : __t) + "</li>" }), __p += "</ul>"), __p += '<div class="store-head"><img src="' + (null == (__t = store.tipImageUrl) ? "" : __t) + '"><div class="title">' + (null == (__t = store.name) ? "" : __t), store.nameEN && (__p += "(" + (null == (__t = store.nameEN) ? "" : __t) + ")"), __p += '</div><div class="description">' + (null == (__t = label.type) ? "" : __t), label.code ? __p += null == (__t = label.code) ? "" : __t : __p += null == (__t = store.code) ? "" : __t, __p += '</div></div><div class="store-address"><div class="detail">' + (null == (__t = store.address) ? "" : __t), store.addressEN && (__p += "(" + (null == (__t = store.addressEN) ? "" : __t) + ")"), __p += '</div></div><ul class="extra-info">', store.linkman && (__p += '<li class="contact-name">' + (null == (__t = store.linkman) ? "" : __t) + "</li>"), store.tel && (__p += '<li class="phone">' + (null == (__t = store.tel) ? "" : __t) + "</li>"), store.serviceTime6 ? (__p += "<br>", store.serviceTime && (__p += '<li class="time">' + (null == (__t = _l("工作日:")) ? "" : __t) + (null == (__t = store.serviceTime) ? "" : __t) + "</li>"), store.serviceTime6 && (__p += '<li class="time">' + (null == (__t = _l("周六:")) ? "" : __t) + (null == (__t = store.serviceTime6) ? "" : __t) + "<br></li>"), store.serviceTime0 && (__p += '<li class="time">' + (null == (__t = _l("节假日:")) ? "" : __t) + (null == (__t = store.serviceTime0) ? "" : __t) + "</li>"), store.serviceTime7 && (__p += '<li class="time">' + (null == (__t = _l("周日:")) ? "" : __t) + (null == (__t = store.serviceTime7) ? "" : __t) + "</li>")) : store.serviceTime && (__p += '<li class="time">' + (null == (__t = store.serviceTime) ? "" : __t) + "</li>"), __p += '</ul><div class="close"><span class="sfi sfi-close"></span></div></div>'; return __p }, this.JST.subRegions = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) _.each(subRegions, function (e, t) { t % 6 == 0 && (__p += '<div class="sub-region-row">'), __p += '<span><a data-code="' + (null == (__t = e.code) ? "" : __t) + '" href="#">' + (null == (__t = e.name.substr(0, 4)) ? "" : __t) + "</a></span>", t % 6 == 5 && (__p += "</div>") }); return __p }, this.JST.taiwanStoresTable = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<table class="services"><tbody>', _.each(stores, function (e) { $.isEmptyObject(e) || (__p += '<tr><td><div class="name">' + (null == (__t = e.name) ? "" : __t) + '<span class="code">' + (null == (__t = e.virtual_addr) ? "" : __t) + '</span></div><div class="address">' + (null == (__t = _l("地址")) ? "" : __t) + "<span>" + (null == (__t = e.address) ? "" : __t) + '</span></div><div class="phone">' + (null == (__t = _l("电话")) ? "" : __t) + "<span>" + (null == (__t = e.telephone) ? "" : __t) + "</span></div></td><td>" + (null == (__t = e.service_content_type) ? "" : __t) + "</td></tr>") }), __p += "</tbody></table>"; return __p }, this.JST.tooltipsTable = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '\x3c!--关务进出口规则显示结果的模板文件-内容表格 --\x3e<table class="table table-striped table-bordered table-hover src-table"><thead><tr><td colspan="3" style="text-align:center">' + (null == (__t = "en" === Helper.getSiteLanguage() ? "Tax Rate" : "税率") ? "" : __t) + "</td></tr></thead><tbody><tr>", _.each(taxs, function (e, t) { __p += "<td>" + (null == (__t = e.taxName) ? "" : __t) + "</td>" }), __p += "</tr><tr>", _.each(taxs, function (e, t) { __p += "<td>" + (null == (__t = e.taxRate) ? "" : __t) + "</td>" }), __p += "</tr></tbody></table>"; return __p }, this.JST.topBarUtils = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<li data-tab="weight" class="services_20150709"><span>' + (null == (__t = _l("重量换算器")) ? "" : __t) + '</span><a href="javascript:void(0);" class="more-info"><i class="sfi sfi-calculator"></i>' + (null == (__t = _l("更多")) ? "" : __t) + "</a></li><li><span>" + (null == (__t = _l("预计时效")) ? "" : __t) + '</span></li><li data-tab="price-toggle" class="services_20150709 head-price"><span>' + (null == (__t = showDestCurrency ? _l("到付价") : _l("寄付价")) ? "" : __t) + '</span><a href="#" class="refresh-switch"><i class="sfi sfi-repay"></i>' + (null == (__t = showDestCurrency ? _l("寄付货币换算") : _l("到付货币换算")) ? "" : __t) + '</a></li><div class="more-weight-wrapper"></div>'; return __p }, this.JST.upLoadAddressBookContent = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) _.each(addressBooksArr, function (e, t) { __p += '<tr data-addId="' + __e(e.addressId) + '"><td><input type="radio" name="addressBook" class="accessible-click"></td><td>' + __e(e.contactName) + "</td><td>" + __e(e.companyName ? e.companyName : _l("无")) + "</td><td>" + __e(_.uniq(_.compact([e.province, e.city, e.county, e.address]), !0).join("-")) + "</td><td>" + __e(e.contactTel ? e.contactTel : e.contactPhone) + '</td><td><a href="javascript:void(0)" class="aicon-bianji edit">' + __e(_l("编辑")) + '</a> <a href="javascript:void(0)" class="aicon-shanchu delete">' + __e(_l("删除")) + "</a></td></tr>" }); return __p }, this.JST.latestWaybills = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) _.each(waybills, function (e) { __p += '<li class="fl express-status-item"><a class="bill-detail" href="javascript:void(0)"data-status="' + __e(e.waybillStatus) + '"data-appointment-statue="' + __e(e.appointmentStatue) + '"data-bill-type="' + (null == (__t = e.billType) ? "" : __t) + '"data-id="' + (null == (__t = e.waybillno) ? "" : __t) + '"data-appointmentno="' + (null == (__t = e.appointmentNo) ? "" : __t) + '"><p class="bill-no clearfix"><span class="gray fl">' + __e(_l("运单号")) + '：</span><span class="fl">' + __e(e.billNum) + ' </span><span class="fr arrow">' + __e(_l("运单详情")) + '</span></p><div class="flow-detail clearfix"><div class="sender fl"><p class="address"title="' + __e(e.originateCityName || _l("寄")) + '">' + __e(e.originateCityName || _l("寄")) + '</p><p class="user gray" title="' + __e(e.originateContacts) + '">' + __e(e.originateContacts) + '</p></div><div class="bill-status fl"><p><i class="progress ' + __e(e.statusIcon) + '"></i></p><p class="status-text">' + __e(_l(e.statusTxt)) + '</p></div><div class="receiver fl"><p class="address"title="' + __e(e.destinationCityName || _l("收")) + '">' + __e(e.destinationCityName || _l("收")) + '</p><p class="user gray" title="' + __e(e.destinationContacts) + '">' + __e(e.destinationContacts) + "</p></div></div>", e.time && e.timeTxt && "3" != e.pickupType && (__p += '    \x3c!--扫码单不显示时间（预约上门，取消时间）--\x3e<p class="bill-time gray">' + __e(_l(e.timeTxt)) + "：" + __e(moment(e.time).format("YYYY-MM-DD HH:mm")) + "</p>"), __p += "</a></li>" }); return __p }, this.JST.latestWaybillsEmpty = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<li class="latest-waybill-empty"><img src="' + __e(imgUrl) + '" alt="运单为空图片"><h5>' + (null == (__t = _l("暂无运单信息")) ? "" : __t) + '</h5><a class="primary-btn autowidth maidian" data-md-name="马上下单" data-md-id="115006" href="' + __e(orderUrl) + '">' + (null == (__t = _l("马上下单")) ? "" : __t) + "</a></li>"; return __p }, this.JST.latestWaybillsErr = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<li class="latest-waybill-err"><img src="' + __e(imgUrl) + '" alt="网络错误图片"><h5>' + __e(_l("加载异常，请刷新重试")) + '</h5><button class="primary-btn autowidth try-again">' + __e(_l("重试")) + "</button></li>"; return __p }, this.JST.setPersonal = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="personal-setting-wrapper"><div class="personal-setting"><a href="javascript:void(0)" class="aicon-back-setting back-button go-back"></a><div class="setting-panel"><div class="user-img-container"><span class="user-img"><img class="head-photo" src="' + __e(headPhotoUrl) + '" alt="会员头像"></span></div><div class="user-phone"><span>' + __e(brief.mobile) + '</span></div><div class="info-setting"><div href="javascript:void(0)" class="setting-item dropdown gender-select"><label for="gender">' + __e(_l("性别")) + '</label><input name="gender" class="input-text gender" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" value="' + __e(genderVal) + '" placeholder="' + __e(_l("未设置")) + '" readonly><span class="right-arrows"></span><ul class="dropdown-menu" aria-labelledby="dLabel"><li class="select-title-content"><span href="javascript:void(0)" class="select-title">' + __e(_l("请选择")) + '</span></li><li><a href="javascript:void(0)" class="select-item" data-type="M">' + __e(_l("男")) + '</a></li><li><a href="javascript:void(0)" class="select-item" data-type="W">' + __e(_l("女")) + '</a></li></ul></div><div href="javascript:void(0)" class="setting-item"><label for="birthday">' + __e(_l("生日")) + '</label><div class="detail-date-input"><input type="text" class="input-text" id="birthday" placeholder="' + __e(_l("未设置")) + '" value="' + __e(brief.birthday) + '" readonly><span class="right-arrows"></span></div></div><div href="javascript:void(0)" class="setting-item"><label for="region">' + __e(_l("地区")) + '</label><div class="detail-location-input" data-max-level="4" data-hide-globe="true" data-hide-hkmctw="true"><input class="input-text region" placeholder="' + __e(_l("未设置")) + '" value="' + __e(_.uniq(_.compact([brief.province, brief.city]), !0).join("-")) + '" readonly><span class="right-arrows"></span></div></div><div href="javascript:void(0)" class="setting-item"><label for="user-mobile">' + __e(_l("绑定手机")) + '</label><input class="input-text user-mobile" placeholder="' + __e(_l("未设置")) + '" value="' + __e(brief.mobile) + '" readonly><span class="right-arrows"></span></div></div></div></div></div>'; return __p }, this.JST.userCenter = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="main-view"><div class="user-maininfo"><div class="user-head"><div class="user-img-container"><span class="user-img"><img class="head-photo" src="' + __e(headPhotoUrl) + '" alt="会员头像"></span></div><div class="member-level-container"><span class="member-level"><img class="level-photo" src="' + __e(memberLevelImg) + '" alt="会员等级">' + __e(memberLevelName) + '</span></div><div class="user-phone"><span>' + __e(mobile) + '</span></div><div class="action-container"><a href="javascript:void(0)" class="action set-personal"><span class="icon aicon-settings"></span>' + __e(_l("个人信息")) + '</a><a href="javascript:void(0)" class="action logout"><span class="icon aicon-logout"></span>' + __e(_l("退出登录")) + '</a></div><ul class="user-action clearfix"><li class="fl user-action-item"><a href="javascript:void(0)" style="cursor:default"><span class="aicon aicon-membership"></span><p class="desc-text">' + __e(_l("会员积分")) + '</p><p class="desc-text-tips">' + __e(usablePoint) + '</p></a></li><li class="fl user-action-item invisible"><a href="javascript:void(0)"><span class="aicon aicon-coupons"></span><p class="desc-text">' + __e(_l("优惠券")) + '</p><p class="desc-text-tips">' + __e(_l("剩余")) + " 3 " + __e(_l("张")) + '</p></a></li><li class="fl user-action-item"><a href="javascript:void(0)" class="address-book"><span class="aicon aicon-address-book"></span><p class="desc-text">' + __e(_l("地址簿")) + '</p></a></li><li class="fl user-action-item invisible"><a href="javascript:void(0)"><span class="aicon aicon-my-application"></span><p class="desc-text">' + __e(_l("我的申请")) + '</p></a></li><li class="fl user-action-item"><a href="' + __e(Helper.getOnlineServiceUrl()) + '" target="_blank"><span class="aicon aicon-CSV"></span><p class="desc-text">' + __e(_l("联系客服")) + '</p></a></li></ul></div><div class="express-status"><h3>' + __e(_l("最新快件动态")) + '</h3><ul class="express-status-list clearfix"></ul><div class="search-more"><a href="' + __e(waybillUrl) + '" class="click-item">' + __e(_l("查看更多")) + '<span class="chevron-right-outlined"></span></a></div></div></div></div><div class="minor-view"></div>'; return __p }, this.JST.validateNewMobile = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="change-mobile"><p class="top-tip">' + __e(_l("更换新的绑定手机后，可以使用新的手机号进行登录。")) + '</p><p class="top-tip">' + __e(_l("原会员账号下的会员积分、优惠券、地址簿正常使用。")) + '</p><form class="form-group"><label for="mobile" class="control-label">' + __e(_l("请输入新手机号")) + '</label><input type="text" name="mobile" class="form-control" autocomplete="off"></form><div class="form-group"><label for="code" class="control-label code-hide">' + __e(_l("请输入发送至手机的验证码")) + '</label><div class="clearfix submit-wrapper"><div class="fl code-hide"><input type="text" name="code" class="validation-code" autocomplete="off" maxlength="6"><ul class="clearfix"><li></li><li></li><li></li><li></li><li></li><li></li></ul></div><div class="fr"><button type="button" class="primary-btn autowidth count-down-button" data-count-down-time="60" data-count-down-title="' + (null == (__t = _l("重新获取%s")) ? "" : __t) + '">' + __e(_l("获取验证码")) + "</button></div></div></div></div>"; return __p }, this.JST.validateOldMobile = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="change-mobile"><p class="top-tip">' + __e(_l("为保证您的账号安全，")) + '</p><p class="top-tip">' + __e(_l("请验证身份成功后进行下一步操作")) + '</p><div class="form-group"><label for="mobile" class="control-label">' + __e(_l("当前手机号")) + '</label><input type="text" name="mobile" class="form-control" value="' + __e(mobile) + '" readonly></div><div class="form-group"><label for="code" class="control-label code-hide">' + __e(_l("请输入发送至手机的验证码")) + '</label><div class="clearfix submit-wrapper"><div class="fl code-hide"><input type="text" name="code" class="validation-code" autocomplete="off" maxlength="6"><ul class="clearfix"><li></li><li></li><li></li><li></li><li></li><li></li></ul></div><div class="fr"><button type="button" class="primary-btn autowidth count-down-button" data-count-down-time="60" data-count-down-title="' + (null == (__t = _l("重新获取%s")) ? "" : __t) + '">' + __e(_l("获取验证码")) + "</button></div></div></div></div>"; return __p }, this.JST.billInfoNoData = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<dl class="text-center"><dt class="img"><span class="aicon-emptybox"></span></dt><dd><p class="text-center">' + (null == (__t = _l("暂无数据")) ? "" : __t) + "</p></dd></dl>"; return __p }, this.JST.billInfoWaybillDetail = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) result.originOld && result.destinationOld && (__p += '<h1 class="text-center">' + (null == (__t = result.originOld) ? "" : __t) + '<span class="aicon-arrow-right"></span>' + (null == (__t = result.destinationOld) ? "" : __t) + "</h1>"), !1 === result.signed && result.dynamicExpectedDeliveryTm && result.destination && "hk" !== Helper.getSiteLocation() && ("en" === Helper.getSiteLanguage() ? !1 === result.delay ? __p += '<p class="timeTip">' + (null == (__t = _l("Estimated to arrive before:") + moment(result.dynamicExpectedDeliveryTm.substring(0, 0 <= result.dynamicExpectedDeliveryTm.indexOf("+") ? result.dynamicExpectedDeliveryTm.indexOf("+") : result.dynamicExpectedDeliveryTm.length)).format("YYYY.MM.DD HH:mm")) ? "" : __t) + '</p><p class="timeTip">' + (null == (__t = _l("(For reference only,and the actual time prevails)")) ? "" : __t) + "</p>" : __p += '<p class="timeTip">' + (null == (__t = _l("Recalculating the expected delivery time…")) ? "" : __t) + "</p>" : "sc" === Helper.getSiteLanguage() && (!1 === result.delay ? __p += '<p class="timeTip">' + (null == (__t = _l("预计") + moment(result.dynamicExpectedDeliveryTm.substring(0, 0 <= result.dynamicExpectedDeliveryTm.indexOf("+") ? result.dynamicExpectedDeliveryTm.indexOf("+") : result.dynamicExpectedDeliveryTm.length)).format("YYYY.MM.DD HH:mm")) ? "" : __t) + (null == (__t = _l("前")) ? "" : __t) + (null == (__t = _l("到达")) ? "" : __t) + '</p><p class="timeTip">' + (null == (__t = _l("(仅供参考，具体时效以实际派送时间为准)")) ? "" : __t) + "</p>" : __p += '<p class="timeTip">' + (null == (__t = _l("预计派送时间重新计算中")) ? "" : __t) + "</p>")), result.routes.length && (__p += '<p class="timeTip"><span>' + (null == (__t = moment(result.routes[0].scanDateTime).format("YYYY-MM-DD HH:mm")) ? "" : __t) + "</span><span>", result.routes[0].remark && (result.routes[0].remark = result.routes[0].remark.replace('id="opr_phone"', 'class="route-phone"'), "ru" === Helper.getSiteLocation() && ("T13" === result.limitTypeCode && 31 == result.routes[0].opCode && _.contains(T13_virtualAddressCodeList, result.routes[0].zoneCode) ? result.routes[0].remark += _l("Tip31") : "T14" === result.limitTypeCode && 204 == result.routes[0].opCode && _.contains(T14_virtualAddressCodeList, result.routes[0].zoneCode) && (result.routes[0].remark = _l("Tip204")))), __p += (null == (__t = result.routes[0].remark) ? "" : __t) + "</span></p>"), __p += '<dl><dt class="pos"><span class="big text-center">' + (null == (__t = _l("寄方")) ? "" : __t) + "</span><p>" + (null == (__t = data.consignorContName) ? "" : __t) + "&nbsp&nbsp&nbsp&nbsp" + (null == (__t = data.consignorPhone) ? "" : __t) + "</p><p>" + (null == (__t = data.consignorAddr) ? "" : __t) + '</p></dt><dt class="pos"><span class="big text-center receiver">' + (null == (__t = _l("收方")) ? "" : __t) + "</span><p>" + (null == (__t = data.addresseeContName) ? "" : __t) + "&nbsp&nbsp&nbsp&nbsp" + (null == (__t = data.addresseePhone) ? "" : __t) + "</p><p>" + (null == (__t = data.addresseeAddr) ? "" : __t) + "</p></dt></dl>"; return __p }, this.JST.cancelAppointBill = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="title-wrapper"><img src="' + __e(Helper.getResourceURL("images/waybill/sf-box.png")) + '" class="title-img"/><h1 class="title-text">' + __e(_l("是否暂不寄件？")) + '</h1></div><div class="cancel-content"><div class="cancel-tips"><span class="big">' + __e(_l("请告诉我们原因")) + '</span><span class="small">' + __e(_l("我们会努力为您提供更好的服务")) + '</span></div><ul class="reason-items ' + __e("en" === Helper.getSiteLanguage() ? "reason-items-en" : "") + '"><li><a href="javascript:void(0);"><span class="radio-btn aicon-circle-check checked"></span><span class="item-text">' + __e(_l("计划有变，暂时不需要寄件了")) + '</span></a></li><li><a href="javascript:void(0);"><span class="radio-btn aicon-circle-check"></span><span class="item-text">' + __e(_l("赶时间，更改为其他寄件方式")) + '</span></a></li><li><a href="javascript:void(0);"><span class="radio-btn aicon-circle-check"></span><span class="item-text">' + __e(_l("预约信息有误，需要修改")) + '</span></a></li><li><a href="javascript:void(0);"><span class="radio-btn aicon-circle-check"></span><span class="item-text">' + __e(_l("误发预约")) + '</span></a></li><li><a href="javascript:void(0);"><span class="radio-btn aicon-circle-check"></span><span class="item-text">' + __e(_l("其他")) + '</span></a></li></ul></div><div class="btn-wrapper"><button type="button" class="primary-btn select-confirm border">' + __e(_l("确认")) + '</button><button type="button" class="primary-btn select-cancel">' + __e(_l("取消")) + "</button></div>"; return __p }, this.JST.detailSendOut = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="delivery-item send-out-item ' + __e(mapModel ? "" : "brief-model") + '">\x3c!-- 地图 --\x3e<div class="delivery-map" id="map"></div>\x3c!-- 快递简介 --\x3e<div class="delivery-brief"><div class="brief-content clearfix">', certifiedShippingImgUrl && (__p += '<img class="certifiedImg" src="' + __e(certifiedShippingImgUrl) + '" alt="" title="' + (null == (__t = _l("SF.InternationalExpress.Tips")) ? "" : __t) + '">'), __p += '<div class="wrapper_left"><div class="bill-num"><span class="gray">' + __e(_l("运单号")) + ' </span><span class="number">' + __e(result.id) + '</span>\x3c!-- 苹果客服专线 --\x3e<span class="apple-hotline">', Helper.isAppleWaybill(result.id) && ("SINGAPORE" == result.destinationOld.toUpperCase() || "新加坡" == result.destinationOld ? __p += __e(_l("苹果客服专线：1800-3111-111（限新加坡）")) : "HONG KONG" == result.destinationOld.toUpperCase() || "香港" == result.destinationOld ? __p += __e(_l("苹果客服专线：852-27300273（限香港）")) : "TAIWAN" == result.destinationOld.toUpperCase() || "台湾" == result.destinationOld || "台灣" == result.destinationOld ? __p += __e(_l("苹果客服专线：0800-088830（限台湾座机）02-21926063（台湾座机以外）")) : __p += __e(_l("苹果客服专线", "客服专线：4006 635 333"))), __p += "</span></div>", "delivery" !== statusObj.type && "signed" !== statusObj.type || !Helper.isSender(result.billType) && !Helper.isReceiver(result.billType) ? __p += '\x3c!-- 寄件城市与收件城市 --\x3e<div class="locations">' + __e(result.originOld) + '<i class="aicon-arrow-right"></i>' + __e(result.destinationOld) + "</div>" : __p += '\x3c!-- 快递小哥和上门信息 --\x3e<div class="delivery-brother clearfix"><div class="info fl"><span class="fl bill-man-head"></span><div class="fl man-info"><div class="courier-info"><span class="man-name"></span><div class="star"><span class="gray"><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span></span><span class="red none"><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span></span></div><span class="number"></span></div><div class="courier-tel"><span>' + __e(_l("联系电话")) + ' </span><span class="contact-phone"></span></div><div class="not-assign">' + __e(_l("分配小哥中")) + "</div></div></div></div>", __p += '</div><div class="status-details fr">', "signed" === statusObj.type || "invalid" === statusObj.type ? __p += '<div class="cancel-time">' + __e(statusObj.date) + " " + __e(statusObj.time) + "<span>" + __e(_l(statusObj.name.substring(1))) + '</span></div><span class="express-state ' + __e(statusObj.type) + '">' + __e(_l(statusObj.name)) + "</span>" : deliveryTm ? __p += '<div class="status-name">' + __e(_l(statusObj.name)) + '</div><div class="status-date-time"><div class="time fr"><span class="delivery-time">' + __e(deliveryTm.time) + '</span></div><div class="date fr"><p class="gray">' + __e(_l("预计送达")) + '</p><p class="bold">' + __e(deliveryTm.date) + "</p></div></div>" : __p += '<div style="line-height:73px;">' + __e(_l(statusObj.name)) + "</div>", __p += '</div></div></div>\x3c!-- 营运异常事件提醒 --\x3e<div class="warm-reminder"></div>\x3c!-- 操作按钮 --\x3e', (Helper.isSender(result.billType) || Helper.isReceiver(result.billType)) && isRootMenu && (__p += '<div class="operates-wrapper"><a href="javascript:void(0);" class="show-details-btn primary-btn white square" id="waybill-' + __e(result.id) + '"><span class="aicon-file-outlined"></span>' + __e(_l("查看运单详情")) + '</a><div class="btn-wrap">', canChangeDelivery && (__p += '<a href="javascript:void(0);" class="btn-tip changeDelivery-btn" data-tip="更改派送"><span class="aicon-change-deliver"></span></a>'), canEvaluate && (__p += '<a href="javascript:void(0);" class="btn-tip evaluate-btn" data-tip="服务评价"><span class="aicon-agree red"></span></a>'), __p += "</div></div>"), __p += '\x3c!-- 地图标注信息 --\x3e<div class="delivery-map-hide hide"><div class="map-win-info"></div></div>\x3c!-- 路由详细信息 --\x3e<div class="routes-wrapper"></div>', isRootMenu && hasChildSet && (__p += '<div class="child-details"><div class="title toggle"><a href="javascript:void(0)" class="info-toggle">' + __e(_l("子单详情")) + '<span class="aicon-chevron-double-down fr"></span></a></div><div class="route-details"></div><div class="bottom toggle"><a href="javascript:void(0)" class="info-toggle">' + __e(_l("收起子单详情")) + '<span class="aicon-chevron-double-up"></span></a></div></div>'), __p += "\x3c!-- 登录按钮 --\x3e", isRootMenu && showLogin && (__p += '<div class="login-btn"><button class="primary-btn big a_link_login" >' + __e(_l("登录")) + '</button><br/><span class="gray">' + __e(_l("如是您的包裹可登录查询更详细信息")) + "</span></div>"), __p += '\x3c!-- 分隔线 --\x3e<div class="separation-line"></div></div>'; return __p }, this.JST.evaluateBill = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="delivery-brother clearfix"><span class="fl bill-man-head"></span><div class="fl man-info"><div class="courier-info"><span class="man-name">' + __e(empName || _l("顺丰小哥")) + '</span></div><div class="star-score clearfix"><span class="red-star aicon-star fl"></span><span class="score fl">' + __e(grade || "4.90") + '</span></div></div><div class="courier-tel fr"><p class="tel-label">' + __e(_l("联系电话")) + ' </p><p class="contact-phone">' + __e(telPhone || "95338") + '</p></div></div><div class="evaluate-courier"><div class="title">' + __e(_l("评价小哥")) + '</div><div class="star"><span class="gray"><a href="javascript:void(0);" class="item"><span class="aicon-star"></span></a><a href="javascript:void(0);" class="item"><span class="aicon-star"></span></a><a href="javascript:void(0);" class="item"><span class="aicon-star"></span></a><a href="javascript:void(0);" class="item"><span class="aicon-star"></span></a><a href="javascript:void(0);" class="item"><span class="aicon-star"></span></a></span></div><div class="star-label"></div><ul class="tag-wrapper"></ul><div class="other-evaluate"><textarea class="fill-content" placeholder="' + __e(_l("其他建议与评价")) + '"></textarea><p class="fill-tip"><span class="filled-num">0</span>/<span>200</span></p></div><p class="error-tip">' + __e(_l("输入内容不能大于200字")) + '</p><div class="button-wrapper"><button type="button" class="primary-btn select-confirm">' + __e(_l("匿名提交")) + '</button></div></div><div class="evaluate-SF"><img src="' + __e(Helper.getResourceURL("images/waybill/sf-logo.png")) + '" class="sf-logo"><div class="title">' + __e(_l("评价顺丰")) + '</div><div class="star"><span class="gray"><a href="javascript:void(0);" class="item"><span class="aicon-star"></span></a><a href="javascript:void(0);" class="item"><span class="aicon-star"></span></a><a href="javascript:void(0);" class="item"><span class="aicon-star"></span></a><a href="javascript:void(0);" class="item"><span class="aicon-star"></span></a><a href="javascript:void(0);" class="item"><span class="aicon-star"></span></a></span></div><div class="star-label"></div><ul class="tag-wrapper"></ul><div class="other-evaluate"><textarea class="fill-content" placeholder="' + __e(_l("其他建议与评价")) + '"></textarea><p class="fill-tip"><span class="filled-num">0</span>/<span>200</span></p></div><p class="error-tip">' + __e(_l("输入内容不能大于200字")) + '</p><div class="button-wrapper"><button type="button" class="primary-btn select-confirm">' + __e(_l("匿名提交")) + "</button></div></div>"; return __p }, this.JST.nearlyBillNOList = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<ul class="nearly-records clearfix">', _.each(billArr, function (e) { __p += '<li><a class="bill" href="javascript:void(0)" data-bill="' + (null == (__t = e) ? "" : __t) + '">' + (null == (__t = e) ? "" : __t) + '</a><span class="remove">×</span></li>' }), __p += "</ul>"; return __p }, this.JST.resourceInfo = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) resource && (__p += '<div class="fl dt-head"><span class="fl bill-man-head"></span><div class="fl man-info"><div><span class="man-name">' + __e(resource.empName || _l("顺丰小哥")) + '</span><div class="star"><span class="gray"><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span></span><span class="red' + __e(resource.empName ? "" : " none") + '"><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span></span></div><span class="number">' + __e(resource.empName ? resource.grade : 0) + "</span></div><div><span>" + __e(_l("联系电话")) + " </span><span>" + __e(resource.telPhone || "") + '</span></div></div></div><div class="fr dt-wrap clearfix" style="margin-top:5px; text-align: right">', resource.date && resource.time && (__p += '<div><span class="gray">' + __e(_l("预计上门时间")) + "</span></div><div>" + __e(resource.date) + '<span class="delivery-time">' + __e(resource.time) + "</span></div>"), __p += "</div>"); return __p }, this.JST.routesDetail = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="route-list"><div class="dashed-line"></div>', _.each(routes, function (e, t) { __p += '<ul class="route ' + __e(0 === t ? "first" : "") + " " + __e(t === routes.length - 1 ? "last" : "") + '"><li class="route-status-text"><span class="' + __e("signed" === e.opState.type ? "signed" : "") + '">' + __e(_l(e.opState.name)) + '</span></li><li class="route-status-icon"><img src="' + __e(e.img) + '"/></li><li class="route-date-time"><span>' + __e(e.scanDateTime) + '</span></li><li class="route-desc"><span>' + __e(e.remark) + "</span></li></ul>" }), __p += "</div>"; return __p }, this.JST.waybillChildQuery = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="verification-code"><div class="input-group"  style="width: 300px;"><input type="text" class="form-control" style="width:300px" placeholder=\'' + (null == (__t = _l("请输入验证码")) ? "" : __t) + '\'><img id="validation-image-child" style="height:31px;margin-left:25px;margin-top: -3px;position:relative;top:-28px;left:147px"></div></div><button type="button" class="primary-button child-waybill disabled" style="margin-left:15px" data-loading-text="查询中...">' + (null == (__t = _l("查询")) ? "" : __t) + '</button><div class="error validation-code-error" style="margin-top: 10px;">' + (null == (__t = _l("您输入的验证码有误，请重新输入")) ? "" : __t) + '</div><div class="error" data-error="server-network">' + (null == (__t = _l("服务器暂不可用，请稍后再试")) ? "" : __t) + "</div>"; return __p }, this.JST.waybillChildRouteTab = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<li data-tab="waybill-childRoute" class="childRoute"><span class="sfi sfi-list"></span><span>' + (null == (__t = _l("子单资料")) ? "" : __t) + "</span></li>"; return __p }, this.JST.waybillDetailRouteTab = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<li data-tab="waybill-status"><span class="sfi sfi-trace"></span><span>' + (null == (__t = _l("运单动态")) ? "" : __t) + "</span></li>"; return __p }, this.JST.waybillNotFound = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="delivery"><div class="delivery-brief not-found">', Helper.isAppleWaybill(billNumber) ? __p += null == (__t = _p(_l("未查到此苹果运单%s信息", "抱歉！未查到此运单%s信息，请确认运单号码是否正确，或致电顺丰客服热线4006 635 333"), billNumber)) ? "" : __t : __p += null == (__t = _p(_l("未查到此运单%s信息", "抱歉！未查到此运单%s信息，请确认运单号码是否正确，或致电顺丰客服热线4008 111 111"), billNumber)) ? "" : __t, __p += '</div>\x3c!-- 分隔线 --\x3e<div class="separation-line"></div></div>'; return __p }, this.JST.waybillResult2 = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="delivery-brief ' + (null == (__t = (Helper.isSender(result.billType) || Helper.isReceiver(result.billType)) && isCNlocation && isRootMenu ? "mybill" : "") ? "" : __t) + '" id="waybill-' + (null == (__t = result.id) ? "" : __t) + '"><div class="wrapper_left">', result.originOld && result.destinationOld && (__p += '<div class="locations">' + (null == (__t = result.originOld) ? "" : __t) + '<span class="location-arrow"></span>' + (null == (__t = result.destinationOld) ? "" : __t) + "</div>"), __p += '<div class="delivery-content">\x3c!-- 运单号 --\x3e<span class="number">' + (null == (__t = result.id) ? "" : __t) + "</span>", Helper.isAppleWaybill(result.id) || (__p += '\x3c!-- 产品名称 --\x3e<span class="product-name">' + __e(result.productCode && "tc" != Helper.getSiteLanguage() ? _l(result.productName) : "") + "</span>\x3c!-- 预计送达时间 --\x3e" + (null == (__t = deliveryTm) ? "" : __t)), __p += "</div>\x3c!-- 最近一次站点信息 --\x3e", latestInfo && (__p += '<div class="last-update"><span class="time">' + __e(latestInfo.scanDateTime) + '</span><span class="status">' + (null == (__t = latestInfo.remark) ? "" : __t) + "</span></div>"), __p += "\x3c!-- 苹果客服专线 --\x3e", Helper.isAppleWaybill(result.id) && ("SINGAPORE" == result.destinationOld.toUpperCase() || "新加坡" == result.destinationOld ? __p += '<div class="customer-services">' + (null == (__t = _l("苹果客服专线：1800-3111-111（限新加坡）")) ? "" : __t) + "</div>" : "HONG KONG" == result.destinationOld.toUpperCase() || "香港" == result.destinationOld ? __p += '<div class="customer-services">' + (null == (__t = _l("苹果客服专线：852-27300273（限香港）")) ? "" : __t) + "</div>" : "TAIWAN" == result.destinationOld.toUpperCase() || "台湾" == result.destinationOld || "台灣" == result.destinationOld ? __p += '<div class="customer-services">' + (null == (__t = _l("苹果客服专线：0800-088830（限台湾座机）02-21926063（台湾座机以外）")) ? "" : __t) + "</div>" : __p += '<div class="customer-services">' + (null == (__t = _l("苹果客服专线", "客服专线：4006 635 333")) ? "" : __t) + "</div>"), __p += "\x3c!-- 登陆提示或查看更多 --\x3e", isCNlocation && isRootMenu && (Helper.isLogout(result.billType) && ("sc" === Helper.getSiteLanguage() ? __p += '<div class="brief_tip">如果是你的包裹, <a href="javascript:void(0)" class="a_link_login">登录</a>后可查看更多运单信息</div>' : __p += '<div class="brief_tip">View more waybill information after <a href="javascript:void(0)" class="a_link_login">login on</a></div>'), (Helper.isSender(result.billType) || Helper.isReceiver(result.billType)) && (__p += '<div class="brief_tip">' + (null == (__t = _l("点击可查看更多")) ? "" : __t) + ' <a href="javascript:void(0)">' + (null == (__t = _l("运单详情")) ? "" : __t) + '</a></div><div class="arrow_right"></div>')), __p += '</div>\x3c!-- 快递状态 --\x3e<span class="status-icon ' + (null == (__t = expressState.className) ? "" : __t) + '">' + (null == (__t = _l(expressState.txt)) ? "" : __t) + "</span>\x3c!-- 国际速递图片 --\x3e", certifiedShippingImgUrl && (__p += '<img class="certifiedImg" src="' + (null == (__t = certifiedShippingImgUrl) ? "" : __t) + '" alt="" title="' + (null == (__t = _l("SF.InternationalExpress.Tips")) ? "" : __t) + '">'), __p += '</div><div class="delivery-detail">\x3c!-- tabs --\x3e<ul class="tabs-wrapper display-none" role="tablist"><div class="tabs"><li data-tab="waybill-status"><span class="sfi sfi-trace"></span><span>' + (null == (__t = _l("运单动态")) ? "" : __t) + '</span></li><li data-tab="waybill-childRoute" class="childRoute"><span class="sfi sfi-list"></span><span>' + (null == (__t = _l("子单资料")) ? "" : __t) + '</span></li></div></ul>\x3c!-- 营运事件提醒 --\x3e<p class="warm-reminder" style="display: none"></p>\x3c!-- 详细信息 --\x3e<ul class="tab-details display-none">\x3c!-- 路由信息 --\x3e<li data-detail="waybill-status" class="status-updates" style="display: none;">', 0 < groupRoute.length ? _.each(groupRoute, function (e, t) { __p += '<div data-toggle="status-toggle" class="status-update-box ', 0 === t && (__p += " open  "), __p += ' "><div class="status-update-tab">' + (null == (__t = moment(e[0]).format("YYYY-MM-DD dddd")) ? "" : __t) + '<b class="arrow"></b></div><table><tbody>', _.each(e[1], function (e) { __p += '<tr class="status-update"><td class="time">' + (null == (__t = moment(e.scanDateTime).format("HH:mm:ss")) ? "" : __t) + '</td><td class="update">' + (null == (__t = e.remark) ? "" : __t) + "</td></tr>" }), __p += "</tbody></table></div>" }) : __p += '<p class="text-center">' + (null == (__t = _l("该运单目前还没有路由信息，请耐心等待。")) ? "" : __t) + "</p>", __p += '</li>\x3c!-- 子单信息--\x3e<li data-detail="waybill-childRoute" class="childRoute-update" ></li></ul></div>'; return __p }, this.JST.waybillAbroad = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '\x3c!-- 海外运单查询 --\x3e<div class="shipping-search-detail">', "ru" != region && (__p += '<ul class="navigation-tabs" ><li data-tab="bill-number" class="current">' + __e(_l("按照单号")) + '</li><li class="link"><a href="' + __e(Helper.getDynamicURLWithContext("/more/track/")) + '">' + __e(_l("按参考号")) + "</a></li></ul>"), __p += '\x3c!-- 查询表单 --\x3e<div class="bill-number-wrapper"><div class="clearfix"><div class="input-group"><input type="text" class="form-control tokenfield bill-number-input" placeholder="' + __e(_l("输入运单号进行查询，单次最多查询20条。请以逗号、空格或回车键隔开")) + '"><label class="input-group-addon clear-inputs"><span class="sfi sfi-trash"></span></label><span id="queryBill" type="button" class="primary-button maidian" data-md-name="点击查询" data-md-id="115002" data-loading-text="' + __e(_l("查询中...")) + '">' + __e(_l("查询")) + '</span></div></div>\x3c!-- 最近查询记录 --\x3e<div class="bill-number-list-content"><ul class="nearly-records clearfix"></ul></div><div><div id="TCaptcha" style="width:310px;height:40px;display: none"  ></div><div class="verification-code"><div class="input-group"><input type="text" class="form-control no-right-border" placeholder="' + __e(_l("请输入验证码")) + '"><span class="input-group-addon refresh no-left-border"><span class="sfi sfi-refresh"></span></span></div><img id="validation-image"><div class="error validation-code-error">' + __e(_l("*验证码有误。")) + '</div></div><div class="error" data-error="bill-number-format">' + __e(_l("*运单号错误或重复。")) + '</div><div class="error" data-error="limit-exceeded">' + __e(_l("*您已输入超过20条运单号，系统将自动截取并显示前20条运单号的追踪信息")) + '</div><div class="error" data-error="server-network">' + __e(_l("服务器暂不可用，请稍后再试")) + '</div></div></div></div>\x3c!-- 运单路由信息 --\x3e<div class="route-result"><div class="delivery-wrapper"></div></div>'; return __p }, this.JST.address_form = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<form class="form-horizontal">', warmReminder && (__p += '<p class="warm-reminder warm-red">' + __e(_l(warmReminder)) + "</p>"), __p += '<p class="intellect-reminder">' + __e(_l("请检查拆分地址信息是否准确，如有遗漏请及时补充")) + '</p><div class="sftitle">' + __e("sender" == fillOption ? _l("寄方信息") : _l("收方信息")), rIndex && (__p += '<span class="r-index"></span>'), __p += '<span class="small">' + __e(_l("标 * 为必填项")) + "</span>", "en" !== Helper.getSiteLanguage() && (__p += '<a href="javascript:void(0)" class="aicon-intellect-address addIntellectFill">' + __e(_l("智能地址填写")) + "</a>"), __p += '<a href="javascript:void(0)" class="aicon-address-book address-book">' + __e(_l("使用地址簿")) + "</a>", hasCalc && (__p += '<a href="' + __e(priceUrl) + '" target="_blank" class="aicon-calculator">' + __e(_l("价格计算")) + "</a>"), __p += '</div><p class="warm-reminder"></p><div class="form-group"><div class="col-xs-5 autoAddPicker"><label class="control-label required" for="contactName">' + __e(_l("姓名")) + '</label><input type="text" class="form-control" name="contactName" placeholder="' + __e(_l("请填写联系人姓名")) + '"></div><div class="col-xs-5 col-xs-offset-2 autoAddPicker"><label class="control-label" for="companyName">' + __e(_l("公司名称")) + '</label><input type="text" class="form-control" name="companyName" placeholder="' + __e(_l("请填写公司名称")) + '"></div></div><div class="form-group"><div class="col-xs-5 autoAddPicker"><label class="control-label" for="contactTel">' + __e(_l("手机号码")) + '</label><input type="text" class="form-control" name="contactTel" placeholder="' + __e(_l("请填写手机号码")) + '"></div><div class="col-xs-5 col-xs-offset-2"><label class="control-label" for="contactPhone">' + __e(_l("固话")) + '</label><input type="text" class="form-control" name="contactPhone" placeholder="' + __e(_l("请填写固话号码")) + '"></div></div><div class="form-group"><div class="col-xs-10"><label class="control-label required" for="location">' + __e("hk" === Helper.getSiteLocation() ? _l("城市/区域") : _l("省市区")) + '</label><div class="detail-location-input" data-max-level="4" data-hide-globe="true"><input type="text" class="form-control ' + __e("sender" == fillOption ? "origins" : "dests") + '" name="location" placeholder="' + __e(_l(location.placeholder)) + '"></div></div>', nearBy && (__p += '<a class="getNearbyAddress aicon-location maidian" data-md-name="点击省市区后地标" data-md-id="OWF010103" href="javascript:void(0)"></a>'), __p += '</div><div class="form-group"><div class="col-xs-10"><label class="control-label required" for="address">' + __e(_l("详细地址")) + '</label><input type="text" class="form-control" name="address" placeholder="' + __e(_l("请填写所在街道以及详细地址")) + '"></div></div><div class="form-group error error-sender-address-detail"><div class="col-xs-10">' + __e(_l("亲，您的寄件地址我司暂无法上门收件，您可修改为其它地址")) + "</div></div>", "receiver" == fillOption && (__p += '<div class="form-group error error-receiver-address-detail"><div class="col-xs-12">' + __e(_l("亲，您的收件地址不在我司派送范围内，可选择自取服务")) + "</div></div>"), customID && (__p += '<div class="form-group customID ' + __e(customID.hide ? "hidden" : "") + '"><div class="col-xs-10"><label for="customerId" class="control-label">' + __e(_l(customID.text)) + '</label><input type="text" class="form-control" name="customerId" placeholder="' + __e(_l(customID.placeholder)) + '"></div></div>'), __p += '\x3c!--\t<div class="form-group TWlicenseInput"><div class="col-xs-10"><label for="customerId" class="required control-label">' + __e(_l("收件统编")) + '</label><input type="text" class="form-control" name="customerId" placeholder="' + __e(_l("如收件方为公司请填写营业执照，个人请填写身份证号")) + '"></div></div>--\x3e</form>'; return __p }, this.JST.auto_match = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += "<p><span>" + __e(item.contactName) + "</span>", item.companyName && (__p += "<span>" + __e(item.companyName) + "</span>"), item.contactTel && (__p += "<span>" + __e(item.contactTel) + "</span>"), item.contactPhone && (__p += "<span>" + __e(item.contactPhone) + "</span>"), item.customerId && (__p += "<span>" + __e(item.customerId) + "</span>"), __p += "</p><p><span>" + __e(_.uniq(_.compact([item.province, item.city, item.county, item.address]), !0).join("")) + "</span></p>"; return __p }, this.JST.bulkChangeAppointBill = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="modify-bill"><ul class="bill-options-list clearfix"><li><a href="javascript:void(0)" class="items-weight"><dl><dt><span class="aicon-document"></span></dt><dd class="items-show">' + __e(_l("文件")) + '</dd><dd class="weight-show">1kg</dd></dl></a><p class="title require">' + __e(_l("托寄物信息")) + '</p></li><li><a href="javascript:void(0)" class="cargo-pay-type"><dl><dt><span class="aicon-pay-type-1"></span></dt><dd class="pay-type-show">' + __e(_l("寄付现结")) + '</dd></dl></a><p class="title">' + __e(_l("付款方式")) + "</p></li>", hasCargoService && (__p += '<li><a href="javascript:void(0)" class="cargo-service"><dl><dt><span class="aicon-diamond"></span></dt><dd class="servive-show">' + __e(_l("无增值服务")) + '</dd></dl></a><p class="title">' + __e(_l("增值服务")) + "</p></li>"), hasCargoInsure && (__p += '<li><a href="javascript:void(0)" class="cargo-insure"><dl><dt><span class="aicon-umbrella"></span></dt><dd class="cargo-insure-show">' + __e(_l("未选择保价")) + '</dd><dd class="cargo-insure-price-show"></dd></dl></a><p class="title">' + __e(_l("保价服务")) + "</p></li>"), hasCargoMsg && (__p += '<li><a href="javascript:void(0)" class="cargo-msg"><dl><dt><span class="aicon-msg"></span></dt><dd class="cargo-msg-show">' + __e(_l("无")) + '</dd></dl></a><p class="title">' + __e(_l("备注信息")) + "</p></li>"), __p += '</ul><div class="text-right"><button type="button" class="primary-btn autowidth confirm-change">' + __e(_l("确认")) + "</button></div></div>"; return __p }, this.JST.changeAppointBill = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="modify-bill"><div class="top-info clearfix"><ul class="clearfix shipper fl"><li class="sfbadge black">' + __e(_l("寄")) + '<span class="sficon aicon-v-dot"></span></li><li class="address"><p><span class="name">' + __e(sender.contactName) + "</span><span>" + __e(sender.contactTel || sender.contactPhone) + '</span></p><p class="gray">' + __e(_.uniq(_.compact([sender.province, sender.city, sender.county]), !0).join("") + sender.address) + '</p></li></ul><p class="fr right predict">' + __e(_l("预计价格")) + ' <span class="sficon red">' + __e(currencyCode) + '</span><span class="predict-money red"></span><span class="red">' + __e(_l("起")) + '</span></p><ul class="clearfix receiver-info fl shipper"></ul>', hideModifyReceiver || (__p += '<p class="fr right"><button type="button" class="primary-btn small white square aicon-address-book address-book">' + __e(_l("地址簿")) + '</button><button type="button" class="primary-btn small white square aicon-bianji receiver-modify">' + __e(_l("编辑")) + "</button></p>"), __p += '</div><p class="out-range-tip">' + __e(_l("亲，您的收件地址不在我司派送范围内，可选择自取服务")) + '</p><p class="list-title">' + __e(_l("快件信息")) + '</p><ul class="bill-options-list clearfix"><li><a href="javascript:void(0)" class="items-weight"><dl><dt><span class="aicon-document"></span></dt><dd class="items-show"></dd><dd class="weight-show"></dd></dl></a><p class="title require">' + __e(_l("托寄物信息")) + '</p></li><li><a href="javascript:void(0)" class="cargo-pay-type"><dl><dt><span class="aicon-pay-type-1"></span></dt><dd class="pay-type-show"></dd></dl></a><p class="title">' + __e(_l("付款方式")) + "</p></li>", hasCargoService && (__p += '<li><a href="javascript:void(0)" class="cargo-service"><dl><dt><span class="aicon-diamond"></span></dt><dd class="servive-show"></dd></dl></a><p class="title">' + __e(_l("增值服务")) + "</p></li>"), hasCargoInsure && (__p += '<li><a href="javascript:void(0)" class="cargo-insure"><dl><dt><span class="aicon-umbrella"></span></dt><dd class="cargo-insure-show"></dd><dd class="cargo-insure-price-show"></dd></dl></a><p class="title">' + __e(_l("保价服务")) + "</p></li>"), hasCargoMsg && (__p += '<li><a href="javascript:void(0)" class="cargo-msg"><dl><dt><span class="aicon-msg"></span></dt><dd class="cargo-msg-show"></dd></dl></a><p class="title">' + __e(_l("备注信息")) + "</p></li>"), __p += '<li class="cargo-self-pick-wrapper"><a href="javascript:void(0)" class="cargo-self-pick"><dl><dt><span class="aicon-self-pick"></span></dt><dd class="self-pick-show"></dd></dl></a><p class="title">' + __e(_l("自取服务")) + '</p></li></ul><div class="text-right"><button type="button" class="primary-btn autowidth confirm-change">' + __e(_l("保存")) + "</button></div></div>"; return __p }, this.JST.changeAppointBillHmt = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="modify-bill"><div class="top-info clearfix"><ul class="clearfix shipper fl"><li class="sfbadge black">' + __e(_l("寄")) + '<span class="sficon aicon-v-dot"></span></li><li class="address"><p><span class="name">' + __e(sender.contactName) + "</span><span>" + __e(sender.contactTel || sender.contactPhone) + '</span></p><p class="gray">' + __e(_.uniq(_.compact([sender.province, sender.city, sender.county]), !0).join("") + sender.address) + '</p></li></ul><p class="fr right predict">' + __e(_l("预计价格")) + ' <span class="sficon red">' + __e(currencyCode) + '</span><span class="predict-money red"></span><span class="red">' + __e(_l("起")) + '</span></p><ul class="clearfix receiver-info fl shipper"></ul></div><p class="out-range-tip">' + __e(_l("亲，您的收件地址不在我司派送范围内，可选择自取服务")) + '</p><p class="list-title">' + __e(_l("报关信息")) + '</p><ul class="bill-options-list clearfix"><li><a href="javascript:void(0)" class="add-items"><dl><dt><span class="aicon-other"></span></dt><dd class="items-show"></dd></dl></a><p class="title require">' + __e(_l("申报物品")) + '</p></li><li><a href="javascript:void(0)" class="fee-pay-type"><dl><dt><span class="aicon-pay-type-1"></span></dt><dd class="fee-pay-type-show"></dd></dl></a><p class="title">' + __e(_l("运费") + _l("付款方式")) + "</p></li>", isTW && (__p += '<li><a href="javascript:void(0)" class="tax-pay-type"><dl><dt><span class="aicon-pay-type-1"></span></dt><dd class="tax-pay-type-show"></dd></dl></a><p class="title">' + __e(_l("税金") + _l("付款方式")) + "</p></li>"), hideCargoWeight || (__p += '<li><a href="javascript:void(0)" class="cargo-weight"><dl><dt><span class="aicon-3kg"></span></dt><dd class="cargo-weight-show"></dd></dl></a><p class="title">' + __e(_l("预估重量")) + "</p></li>"), hasCargoService && (__p += '<li><a href="javascript:void(0)" class="cargo-service"><dl><dt><span class="aicon-diamond"></span></dt><dd class="servive-show"></dd></dl></a><p class="title">' + __e(_l("增值服务")) + "</p></li>"), hasCargoInsure && (__p += '<li><a href="javascript:void(0)" class="cargo-insure"><dl><dt><span class="aicon-umbrella"></span></dt><dd class="cargo-insure-show"></dd><dd class="cargo-insure-price-show"></dd></dl></a><p class="title">' + __e(_l("保价服务")) + "</p></li>"), hideCargoDeclare || (__p += '<li><a href="javascript:void(0)" class="cargo-declare-type"><dl><dt><span class="aicon-declare-type"></span></dt><dd class="cargo-declare-show"></dd></dl></a><p class="title">' + __e(_l("报关方式")) + "</p></li>"), hasCargoMsg && (__p += '<li><a href="javascript:void(0)" class="cargo-msg"><dl><dt><span class="aicon-msg"></span></dt><dd class="cargo-msg-show"></dd></dl></a><p class="title">' + __e(_l("备注信息")) + "</p></li>"), __p += '<li class="cargo-self-pick-wrapper"><a href="javascript:void(0)" class="cargo-self-pick"><dl><dt><span class="aicon-self-pick"></span></dt><dd class="self-pick-show"></dd></dl></a><p class="title">' + __e(_l("自取服务")) + '</p></li></ul><div class="text-right"><button type="button" class="primary-btn autowidth confirm-change">' + __e(_l("保存")) + "</button></div></div>"; return __p }, this.JST.changeAppointBillReceiver = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<li class="sfbadge red">' + __e(_l("收")) + '</li><li class="address"><p><span class="name">' + __e(receiver.contactName) + "</span><span>" + __e(receiver.contactTel || receiver.contactPhone) + '</span></p><p class="gray">' + __e(_.uniq(_.compact([receiver.province, receiver.city, receiver.county]), !0).join("") + receiver.address) + "</p></li>"; return __p }, this.JST.digitalWaybill = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<p class="clearfix title"><img src="' + __e(sfLogoUrl) + '" class="fl" alt="顺丰logo"><img src="' + __e(sfTelUrl) + '" class="fl" alt="顺丰tel"><a href="javascript:void(0)" class="aicon-printer print fr"></a><a href="javascript:void(0)" class="aicon-i-down download fr"></a></p><div class="operate-wrapper">', _.each(infoList, function (e) { __p += '<div class="item" style="background:white"><table><tr><td><span class="sfbadge red">' + __e(_l("收")) + '</span></td><td><p class="contact-name">' + __e(e.appointmentDetail.appointmentDestDetail.contactName) + '</p><p class="gray contact-tel">' + __e(numberToSensitive(e.appointmentDetail.appointmentDestDetail.contactTel || e.appointmentDetail.appointmentDestDetail.contactPhone)) + '</p></td><td><p class="appoint-region">' + __e(_.uniq(_.compact([e.appointmentDetail.appointmentDestDetail.province, e.appointmentDetail.appointmentDestDetail.city, e.appointmentDetail.appointmentDestDetail.county]), !0).join("")) + '</p><p class="appoint-address">' + __e(e.appointmentDetail.appointmentDestDetail.address) + "</p></td></tr></table>", hasPaymethodAndCargoMsg && e.appointmentDetail.paymentMethod && (__p += '<div class="appoint-payment"><span>' + __e(_l("付款方式：")) + __e(_l(Helper.getPayType(e.appointmentDetail.paymentMethod))) + "</span></div>"), __p += '<div class="qr-code-wrapper" data-no="' + __e(e.appointmentDetail.waybillNo) + '"></div><p class="text-center bill-no">' + __e(_l("运单号")) + " " + __e(e.appointmentDetail.waybillNo) + "</p>", hasPaymethodAndCargoMsg && e.appointmentDetail.remark && (__p += '<p class="text-center bill-msg"><span>' + __e(e.appointmentDetail.remark) + "</span></p>"), __p += "</div>" }), __p += '</div><div class="hide"><div class="print-hide"></div></div>'; return __p }, this.JST.cargoService = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="cargo-service-wrapper">', hasSignedBack && (__p += "<h5>" + __e(_l("签单返还")) + '</h5><ul class="sf-capsule signed-back">', _.each(list, function (e) { __p += '<li><a href="javascript:void(0)" data-index="' + __e(e.index) + '" class="' + __e(e.select ? "active" : "") + '"><span class="aicon-' + __e(e.icon) + '"></span>' + __e(e.name) + "</a></li>" }), __p += '</ul><p class="tip">' + __e(signedBackTip) + "</p>"), hasCod && (__p += "<h5>" + __e(_l("代收货款")) + '</h5><ul class="sf-capsule cod"><li><a href="javascript:void(0)" class="' + __e(codCustid ? "" : "active") + '"><span class="aicon-bs-refused"></span>' + __e(_l("不需要")) + '</a></li><li><a href="javascript:void(0)" class="' + __e(codCustid ? "active " : "") + 'need"><span class="aicon-right"></span>' + __e(_l("需要")) + '</a></li></ul><form class="form-horizontal" style="display:' + __e(codCustid ? "block" : "none") + '"><div class="form-group"><div class="col-xs-4"><input type="text" class="form-control" name="customerCode" value="' + __e(codCustid) + '" placeholder="' + __e(_l("代收卡号")) + '"></div><div class="col-xs-4 col-xs-offset-1"><input type="text" class="form-control" name="amount" value="' + __e(codAmt || "") + '" placeholder="' + __e(_l("代收金额")) + '"></div></div></form>'), __p += '<div class="text-right"><button type="button" class="primary-btn autowidth save">' + __e(_l("保存")) + "</button></div></div>"; return __p }, this.JST.confirmCodInfo = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="confirm-cod-info"><div class="title">' + __e(_l("确认代收卡信息")) + "</div><div><label>" + __e(_l("代收卡号")) + "：</label><span>" + __e(customerCode) + "</span></div><div><label>" + __e(_l("开户名")) + "：</label><span>" + __e(customerName) + "</span></div></div>"; return __p }, this.JST.smartFill = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<p class="intellect-fill-prompt">' + __e(_l("粘贴整段地址，自动识别姓名、电话和地址")) + '</p><div class="intellect-fill"><textarea class="intellect-order-addr" placeholder="' + __e(smartFill.placeholder) + '"></textarea><p class="intellect-fill-num"><span class="intellect-fill-input">0</span>/<span>100</span></p></div><div class="text-center"><button type="button" class="primary-btn autowidth intellect-fill-btn disabled">' + __e(_l("提交")) + "</button></div>"; return __p }, this.JST.billInfoElectronicStub = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="electronicStub"><table class="borderrb"><tr><td colspan="3" rowspan="2" class="borderlt" style="text-align: center"><canvas id="barcode"></canvas></td><td class="borderlt">' + (null == (__t = _l("目的地")) ? "" : __t) + '：</td></tr><tr><td class="borderl">' + (null == (__t = data.destZoneCode) ? "" : __t) + '</td></tr><tr><td colspan="4" class="borderlt">' + (null == (__t = _l("寄件方")) ? "" : __t) + "：" + (null == (__t = data.consignorCompName) ? "" : __t) + '</td></tr><tr><td colspan="2" class="borderl">' + (null == (__t = data.consignorContName) ? "" : __t) + '</td><td colspan="2">' + (null == (__t = data.consignorPhone) ? "" : __t) + '</td></tr><tr><td colspan="4" class="borderl">' + (null == (__t = data.consignorAddr) ? "" : __t) + '</td></tr><tr><td colspan="4" class="borderlt">' + (null == (__t = _l("收件方")) ? "" : __t) + "：" + (null == (__t = data.addresseeCompName) ? "" : __t) + '</td></tr><tr><td colspan="2" class="borderl">' + (null == (__t = data.addresseeContName) ? "" : __t) + '</td><td colspan="2">' + (null == (__t = data.addresseePhone) ? "" : __t) + '</td></tr><tr><td colspan="4" class="borderl">' + (null == (__t = data.addresseeAddr) ? "" : __t) + '</td></tr><tr><td colspan="2" class="borderlt">' + (null == (__t = _l("托寄物")) ? "" : __t) + "：" + (null == (__t = data.innerWaybillConsigns) ? "" : __t) + '</td><td class="borderlt">' + (null == (__t = _l("产品类型")) ? "" : __t) + '：</td><td class="borderlt">' + (null == (__t = _l(data.limitTypeName)) ? "" : __t) + '</td></tr><tr><td colspan="2" class="borderl">' + (null == (__t = _l("数量")) ? "" : __t) + "：" + (null == (__t = data.totalShipment) ? "" : __t) + '</td><td class="borderlt">' + (null == (__t = _l("付款方式")) ? "" : __t) + '：</td><td class="borderlt">' + (null == (__t = _l(payType)) ? "" : __t) + '</td></tr><tr><td class="borderlt">' + (null == (__t = _l("实际重量")) ? "" : __t) + '：</td><td class="borderlt">' + (null == (__t = data.realWeightQty) ? "" : __t) + '</td><td class="borderlt">' + (null == (__t = _l("件数")) ? "" : __t) + '：</td><td class="borderlt">' + (null == (__t = data.waybillTotal) ? "" : __t) + '</td></tr><tr><td class="borderlt">' + (null == (__t = _l("计费重量")) ? "" : __t) + '：</td><td class="borderlt">' + (null == (__t = data.meterageWeightQty) ? "" : __t) + '</td><td class="borderlt">' + (null == (__t = _l("运费")) ? "" : __t) + '：</td><td class="borderlt">' + (null == (__t = data.waybillFee) ? "" : __t) + '</td></tr><tr class="borderlt"><td colspan="4">' + (null == (__t = _l("附加费用")) ? "" : __t) + "：</td></tr>", _.each(feeListWidthoutTotalFee, function (e) { __p += '<tr class="borderl"><td colspan="4">' + (null == (__t = _l(e.feeName)) ? "" : __t) + "：" + (null == (__t = e.feeAmt) ? "" : __t) + "</td></tr>" }), __p += '<tr><td colspan="4" class="borderlt">' + (null == (__t = _l("费用合计")) ? "" : __t) + "：" + (null == (__t = data.totalWaybillFee) ? "" : __t) + '</td></tr><tr><td colspan="4" class="borderlt">' + (null == (__t = _l("备注")) ? "" : __t) + "：" + (null == (__t = data.remark) ? "" : __t) + '</td></tr><tr><td class="borderlt" colspan="2">' + (null == (__t = _l("收件员")) ? "" : __t) + "：" + (null == (__t = data.consigneeEmpCode) ? "" : __t) + '</td><td colspan="2" class="bordert" style="text-align: right">' + (null == (__t = _l("收件时间")) ? "" : __t) + "：" + (null == (__t = data.consignedTm) ? "" : __t) + '</td></tr></table></div><div class="options">', Helper.isLtOrEqIe10() || (__p += '<a href="javascript:void(0)" class="download-stub"><span class="aicon-i-down"></span>' + __e(_l("下载")) + "</a>"), __p += '<a href="javascript:void(0)" class="print-stub"><span class="aicon-printer"></span>' + __e(_l("打印")) + "</a></div>"; return __p }, this.JST.billInfoSignedBill = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="signing-receipt"><a href="javascript:void(0)" class="aicon-28 rotate"></a></div><div class="options">', Helper.isLtOrEqIe10() || (__p += '<a href="javascript:void(0)" class="download-receipt"><span class="aicon-i-down"></span>' + __e(_l("下载")) + "</a>"), __p += '<a href="javascript:void(0)" class="print-receipt"><span class="aicon-printer"></span>' + __e(_l("打印")) + "</a></div>"; return __p }, this.JST.changeDeliverRecored = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) (contact || timeAndAddr) && (__p += '<h4 class="change-title">' + __e(_l("变更记录")) + "</h4>"), __p += "\x3c!-- 收件人信息更改 --\x3e", contact && (__p += '<p class="change-content clearfix"><span class="change-time">' + __e(contact.createTime.split(" ")[0]) + '</span><span class="change-detail"><span class="change-subtitle">' + __e(_l("收方把收件人信息更改为")) + '</span><span class="contact-name"> ' + __e(contact.name) + " " + __e(contact.phone) + "</span></span></p>"), __p += "\x3c!-- 派件方式修改 --\x3e", timeAndAddr && (__p += '<p class="change-content clearfix"><span class="change-time">' + __e(timeAndAddr.createTime.split(" ")[0]) + '</span><span class="change-detail">', timeAndAddr.deliverDate ? __p += '<span class="change-subtitle">' + __e(_l("收方把派件时间更改为")) + "</span><span> " + __e(timeAndAddr.deliverDate) + " " + __e(timeAndAddr.deliverTimeMin) + "-" + __e(timeAndAddr.deliverTimeMax) + "</span>" : __p += '<span class="change-subtitle">' + __e(_l("收方把快件更改为代收点自取")) + "</span><br><span>" + __e(timeAndAddr.networkStoreName) + "</span><br><span>" + __e(timeAndAddr.networkStoreAddress) + "</span><br>", __p += "</span></p>"); return __p }, this.JST.moreInfo = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="waybill-stub"><ul class="sf-nav-tabs" role="tablist"><li role="presentation" class="active"><a href="#waybillDetail" aria-controls="waybillDetail" role="tab" data-toggle="tab" class="waybillDetail maidian" data-md-name="登录成功后点击运单详情" data-md-id="115009">' + (null == (__t = _l("运单详情")) ? "" : __t) + '</a></li><li role="presentation"><a href="#signedBill" aria-controls="signedBill" role="tab" data-toggle="tab" class="signedBill maidian" data-md-name="登录成功后点击签收底单" data-md-id="115010">' + (null == (__t = _l("签收底单")) ? "" : __t) + '</a></li><li role="presentation"><a href="#electronicStub" aria-controls="electronicStub" role="tab" data-toggle="tab" class="electronicStub maidian" data-md-name="登录成功后点击电子存根" data-md-id="115011">' + (null == (__t = _l("电子存根")) ? "" : __t) + '</a></li></ul><div class="tab-content">\x3c!-- 详情 --\x3e<div role="tabpanel" class="tab-pane text-center active" id="waybillDetail"><dl class="text-center"><dt class="img"><span class="aicon-emptybox"></span></dt><dd><p class="text-center">' + (null == (__t = _l("暂无数据")) ? "" : __t) + '</p></dd></dl></div>\x3c!-- 签收底单--\x3e<div role="tabpanel" class="tab-pane" id="signedBill"><dl class="text-center"><dt class="img"><span class="aicon-emptybox"></span></dt><dd><p class="text-center">' + (null == (__t = _l("暂无数据")) ? "" : __t) + '</p></dd></dl></div>\x3c!-- 电子存根 --\x3e<div role="tabpanel" class="tab-pane" id="electronicStub"><dl class="text-center"><dt class="img"><span class="aicon-emptybox"></span></dt><dd><p class="text-center">' + (null == (__t = _l("暂无数据")) ? "" : __t) + "</p></dd></dl></div></div></div>"; return __p }, this.JST.moreInfoDetail = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="waybill-detail"><div style="width: 100%">', result.originOld && result.destinationOld && (__p += '<div class="title">' + (null == (__t = result.originOld) ? "" : __t) + '<span class="sf-arrow-right"></span>' + (null == (__t = result.destinationOld) ? "" : __t) + "</div>"), __p += "\x3c!-- 预计送达时间 --\x3e", deliveryTm && (__p += "<p>" + (null == (__t = _p(_l("预计<i>%(deliveryTime)s前</i>到达"), { deliveryTime: deliveryTm.datetime })) ? "" : __t) + '</p><p class="product-time-p">', _l("(仅供参考，具体时效以实际派送时间为准)"), __p += "</p>"), __p += "\x3c!-- 最近一次路由信息 --\x3e", latestInfo && (__p += '<p class="timeTip"><span>' + __e(latestInfo.scanDateTime) + "</span><span>" + (null == (__t = latestInfo.remark) ? "" : __t) + "</span></p>"), __p += '<dl><dt class="pos"><span class="big text-center">' + (null == (__t = _l("寄方")) ? "" : __t) + "</span><p>" + (null == (__t = data.consignorContName) ? "" : __t) + "&nbsp&nbsp&nbsp&nbsp" + (null == (__t = data.consignorPhone) ? "" : __t) + "</p><p>" + (null == (__t = data.consignorAddr) ? "" : __t) + '</p></dt><dt class="pos"><span class="big text-center receiver">' + (null == (__t = _l("收方")) ? "" : __t) + "</span><p>" + (null == (__t = data.addresseeContName) ? "" : __t) + "&nbsp&nbsp&nbsp&nbsp" + (null == (__t = data.addresseePhone) ? "" : __t) + "</p><p>" + (null == (__t = data.addresseeAddr) ? "" : __t) + '</p></dt></dl>\x3c!-- 改派变更记录 --\x3e<div id="changeRecord"></div></div></div>'; return __p }, this.JST.usOrder = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="us_order_pop"><div class="content_wrapper">' + __e(_l("立即下单，享受价美质优的顺丰国际物流服务")) + '</div><div class="btn_nav clearfix"><button type="button" class="primary-btn white enterprise">' + __e(_l("企业用户登录")) + '</button><button type="button" class="primary-btn white personal">' + __e(_l("个人用户登录")) + "</button></div></div>"; return __p }, this.JST.acceptCriteriaOther = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += "\x3c!--收寄标准查询结果的模板文件 国际 --\x3e", _.isEmpty(results) ? __p += '<tr><td colspan="8">' + (null == (__t = _l("请精简“物品名称”关键字进行检索。")) ? "" : __t) + "</td><tr>" : _.each(results, function (e, t) { __p += "<tr><td>" + (null == (__t = e.goodsBigType) ? "" : __t) + "</td><td>" + (null == (__t = e.goodsName) ? "" : __t) + "</td><td>" + (null == (__t = "1" == e.receiptType ? _l("允许收寄") : "2" == e.receiptType ? _l("禁止收寄") : _l("限制收寄")) ? "" : __t) + "</td><td>" + (null == (__t = e.remark) ? "" : __t) + "</td></tr>" }); return __p }, this.JST.acceptCriteriaResultCN = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += "\x3c!--收寄标准查询结果的模板文件 中国大陆 --\x3e", _.isEmpty(results) ? __p += '<tr><td colspan="8">请精简“物品名称”关键字进行检索。</td><tr>' : _.each(results, function (e, t) { __p += "<tr><td>" + (null == (__t = e.goodsBigType) ? "" : __t) + "</td><td>" + (null == (__t = e.goodsName) ? "" : __t) + "</td><td>" + (null == (__t = e.landTransport) ? "" : __t) + "</td><td>" + (null == (__t = e.flightTransport) ? "" : __t) + "</td><td>" + (null == (__t = e.remark) ? "" : __t) + "</td></tr>" }); return __p }, this.JST.acceptCriteriaResultHMT = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += "\x3c!--收寄标准查询结果的模板文件 港澳台同城 --\x3e", _.isEmpty(results) ? __p += '<tr><td colspan="8">请精简“物品名称”关键字进行检索。</td><tr>' : _.each(results, function (e, t) { __p += "<tr><td>" + (null == (__t = e.goodsBigType) ? "" : __t) + "</td><td>" + (null == (__t = e.goodsName) ? "" : __t) + "</td><td>" + (null == (__t = e.landTransport) ? "" : __t) + "</td><td>" + (null == (__t = e.remark) ? "" : __t) + "</td></tr>" }); return __p }, this.JST.dropdownAcceptDestCountry = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) dropdownItems.length ? _.each(dropdownItems, function (e) { __p += '<li><a href="#" onclick="return false;" data-code="' + (null == (__t = e.destCode) ? "" : __t) + '" data-tip="' + (null == (__t = e.info) ? "" : __t) + '">' + (null == (__t = e.name) ? "" : __t) + "</a></li>" }) : __p += '<div class="text-center loading-text">' + (null == (__t = _l("正在加载数据...")) ? "" : __t) + "</div>"; return __p }, this.JST.dropdownAcceptSrcCountry = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) dropdownItems.length ? _.each(dropdownItems, function (e) { __p += '<li><a href="#" onclick="return false;" data-code="' + (null == (__t = e.shortName) ? "" : __t) + '">' + (null == (__t = "en" == Helper.getSiteLanguage() || "vi" == Helper.getSiteLanguage() || "th" == Helper.getSiteLanguage() || "ru" == Helper.getSiteLanguage() || "fr" == Helper.getSiteLanguage() || "de" == Helper.getSiteLanguage() ? e.enName : e.cnName) ? "" : __t) + "</a></li>" }) : __p += '<div class="text-center loading-text">' + (null == (__t = _l("正在加载数据...")) ? "" : __t) + "</div>"; return __p }, this.JST.claims = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<p>请确认您的理赔登记信息</p><div style="overflow: hidden"><table class="table table-bordered col-xs-7"><tr><td class="cel-key col-xs-5">运单号</td><td class="cel-value">' + (null == (__t = data.carryId) ? "" : __t) + '</td></tr><tr><td class="cel-key">赔款金额</td><td class="cel-value">' + (null == (__t = data.endClaimMoney) ? "" : __t) + '</td></tr><tr><td class="cel-key">转账金额</td><td class="cel-value">' + (null == (__t = data.compensateAmt) ? "" : __t) + '</td></tr><tr><td class="cel-key">收款方银行</td><td class="cel-value">' + (null == (__t = data.bankCodeTxt) ? "" : __t) + '</td></tr><tr><td class="cel-key">收款方开户行分/支行</td><td class="cel-value">' + (null == (__t = data.bankName) ? "" : __t) + '</td></tr><tr><td class="cel-key">收款方户</td><td class="cel-value">' + (null == (__t = data.countName) ? "" : __t) + '</td></tr><tr><td class="cel-key">收款方账号</td><td class="cel-value">' + (null == (__t = data.customerBankCard) ? "" : __t) + '</td></tr><tr><td class="cel-key">收款方地址</td><td class="cel-value">' + (null == (__t = data.countProvince) ? "" : __t) + '</td></tr><tr><td class="cel-key">是否对公账号</td><td class="cel-value">' + (null == (__t = "01" == data.ctgyPurp ? "是" : "否") ? "" : __t) + '</td></tr></table></div><div><button type="button" class="primary-button" id="confirmBtn">确定</button>&nbsp;&nbsp;&nbsp;<button type="button" class="primary-button modify" id="backModifyBtn">修改</button></div>'; return __p }, this.JST.clearanceImgUpload = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += "<h3>" + __e(_l("清关证件图片上传")) + '</h3><div class="bill-no"><span>' + __e(_l("运单号")) + '</span><form class="waybill-no"><input type="text" class="form-control" name="waybillNo" placeholder="' + __e(_l("请输入12位数字运单号或“SF”开头的15位运单号")) + '" autocomplete="off"></form></div><div class="tab-head">', _.each(data, function (e, t) { __p += '<a href="#' + __e(t) + '"' + __e("picture" === t ? " class=active" : "") + ' data-clearance-type="' + __e(e.clearanceType) + '">' + __e(_l(e.name)) + "</a>" }), __p += "</div>", _.each(data, function (i, e) { __p += '<div class="tab-content' + __e("picture" === e ? " active" : "") + '" id="' + __e(e) + '"><ul class="sf-capsule">', _.each(i.type, function (e, t) { __p += '<li><a href="#' + __e(t) + '"' + __e("idCard" === t || "invoice" === t ? " class=active " : "") + ">" + __e(_l(e.name)) + "</a></li>" }), __p += "</ul>", _.each(i.type, function (e, t) { __p += '<div class="upload-wrapper' + __e("invoice" === t || "idCard" === t ? " active" : "") + '" id="' + __e(t) + '">', _.each(e.upload, function (e, t) { __p += '<div class="file-input-wrapper" data-surface="' + __e(t) + '"><div class="upload"><div class="normal"><span class="aicon-1 icon"></span><p>' + __e(_l(e.name)) + '</p></div><div class="success-mask"></div><div class="success-mark"><a href="javascript:void(0)" class="aicon-shanchu delete"></a><span class="' + __e(e.icon) + ' card-icon"></span><div class="round-wrapper"><p class="round"><span class="aicon-right"></span></p><p class="text">' + __e(_l("上传成功")) + "</p></div></div></div>", "1" == i.clearanceType ? __p += '<input type="file" name="' + __e("front" == t ? "idcardFront" : "idcardBack") + '">' : __p += '<input type="file" name="' + __e("front" == t ? "clearanceImage" : "idcardBack") + '">', __p += "</div>" }), "idCard" === t && (__p += '<div class="row id-card-form"><div class="col-xs-3 fl"><label class="control-label">' + __e(_l("姓名")) + '</label><input type="text" class="form-control" placeholder="' + __e(_l("请填写姓名")) + '" id="ocr-name"></div><div class="col-xs-4 fl"><label class="control-label">' + __e(_l("身份证号")) + '</label><input type="text" class="form-control" placeholder="' + __e(_l("请填写身份证号")) + '" id="ocr-id"></div><div class="col-xs-2 end fr"><input type="text" class="form-control" placeholder="YYYY.MM.DD" id="ocr-end-date"></div><div class="col-xs-1 split fr">-</div><div class="col-xs-2 fr"><label class="control-label">' + __e(_l("有效日期")) + '</label><input type="text" class="form-control" placeholder="YYYY.MM.DD" id="ocr-start-date"></div></div>'), __p += '<div class="submit-wrapper">', "idCard" === t && (__p += '<p class="agree"><a href="javascript:void(0)" class="aicon-check term-toggle"></a><span>' + __e(_l("我已查看并同意")) + '</span><a href="javascript:void(0)" class="show-term">《' + __e(_l("消费者实名备案协议条款")) + "》</a><span>" + __e(_l("及顺丰留存证件信息用于清关服务")) + "</span></p>"), __p += '<button class="primary-btn autowidth submit" type="button">' + __e(_l("提交")) + "</button></div></div>" }), __p += "</div>" }), __p += '<div class="tips"><h4>' + __e(_l("温馨提示：")) + "</h4><p>" + __e(_l("为确保您的货物顺利清关，请按以下类型上传真实有效的资料，相关说明如下：")) + "</p><p>" + __e(_l("1.公司件：可提供“发票”、“合同”、“装箱单”、“委托书”、“货物异常情况说明”（需加盖公司公章）等资料；")) + "</p><p>" + __e(_l("2.个人件：可提供“购物小票或发票”、“货物异常情况说明”；")) + "</p><p>" + __e(_l("3.身份证、护照、士官证、回乡证、台胞证等证照类的需上传至“证照单位”，发票、合同、装箱单、许可证等资料需上传至“清关单证”部分；")) + "</p></div>"; return __p }, this.JST.clearanceImgUploadSucc = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += "<h3>" + __e(_l("清关证件图片上传")) + '</h3><div class="success-wrapper"><img src="' + __e(imgUrl) + '" alt="提交成功图片"><h2>' + __e(_l("提交成功")) + "</h2><h3>" + __e(_l("您已成功提交清关信息，感谢您的配合")) + '</h3><a href="' + __e(sfCareUrl) + '" class="primary-btn border autowidth">' + __e(_l("返回")) + "</a></div>"; return __p }, this.JST.ocrConfirmInfo = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="ocr-confirm-info"><h3>' + __e(_l("请确认您的证件信息")) + '</h3><p class="gray">' + __e(_l("为保证您的物品顺利清关，请确保以下信息与证件一致")) + '</p><div class="gray-wrapper"><table><tr><td class="gray">' + __e(_l("姓名")) + "</td><td>" + __e(name) + '</td></tr><tr><td class="gray">' + __e(_l("身份证号")) + "</td><td>" + __e(id) + '</td></tr><tr><td class="gray">' + __e(_l("有效期限")) + "</td><td>" + __e(date) + '</td></tr></table></div><p><button class="primary-btn autowidth border cancel">' + __e(_l("返回修改")) + '</button><button class="primary-btn autowidth confirm">' + __e(_l("确认无误")) + "</button></p></div>"; return __p }, this.JST.consignResult = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<table class="table table-bordered"><thead><tr><th>' + (null == (__t = _l("运单号")) ? "" : __t) + "</th><th>" + (null == (__t = _l("海关货运编号(CCRN)")) ? "" : __t) + "</th><th>" + (null == (__t = _l("主提单号")) ? "" : __t) + "</th><th>" + (null == (__t = _l("航班号")) ? "" : __t) + "</th><th>" + (null == (__t = _l("香港车牌编号")) ? "" : __t) + "</th><th>" + (null == (__t = _l("离港/到港日期")) ? "" : __t) + "</th><th>" + (null == (__t = _l("卸货港口")) ? "" : __t) + "</th></tr></thead><tbody>", _.each(codes, function (i, n) { _.each(results, function (e, t) { n == t && (null == e.get("bno") ? (1 == type && (__p += "<td>" + (null == (__t = i) ? "" : __t) + "</td><td>-</td>"), 2 == type && (__p += "<td>-</td><td>" + (null == (__t = i) ? "" : __t) + "</td>"), __p += "<td colspan=5>" + (null == (__t = _l("很抱歉！您搜寻的数据不存在。如有任何查询，请致电客户服务热线 (852) 273 00 273")) ? "" : __t) + "</td></tr>") : __p += "<tr><td>" + (null == (__t = e.get("bno")) ? "" : __t) + "</td>\x3c!--運單號--\x3e<td>" + (null == (__t = e.get("ccrn")) ? "" : __t) + "</td>\x3c!--海關貨物編號（CCRN）--\x3e<td>" + (null == (__t = e.get("awbNo")) ? "" : __t) + "</td>\x3c!--主提单号 --\x3e<td>" + (null == (__t = e.get("flightNo")) ? "" : __t) + "</td>\x3c!--航班号--\x3e<td>" + (null == (__t = e.get("vrn")) ? "" : __t) + "</td>\x3c!--香港车牌编号--\x3e<td>" + (null == (__t = e.get("scheDate")) ? "" : __t) + "</td>\x3c!--离岗到港日期--\x3e<td>" + (null == (__t = e.get("port")) ? "" : __t) + "</td>\x3c!--卸货港口--\x3e</tr>") }) }), __p += "</tbody></table>"; return __p }, this.JST.feedbackImgWrapper = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="img-wrapper"><a href="javascript:void(0)" class="delete" data-id="' + __e(id) + '"><span class="aicon-shanchu "></span></a><img class="img" src="' + __e(imgUrl) + '" alt="意见反馈用户添加的图片"><img src="' + __e(imgUrl) + '" alt="意见反馈用户添加的图片" style="display: none"></div>'; return __p }, this.JST.feedbackIndex = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<nav><a href="javascript:void(0)" class="suggestion"><span class="aicon-suggestion"></span><p>我有建议</p></a><a href="javascript:void(0)" class="question"><span class="aicon-function"></span><p>遇到问题</p></a><a href="' + __e(Helper.getOnlineServiceUrl()) + '" target="_blank"><span class="aicon-CSV"></span><p>在线客服</p></a></nav><section class="first"></section><section class="second"></section><section class="third"></section><section class="fourth"></section>'; return __p }, this.JST.feedbackSucc = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<section class="feedback-succ"><img src="' + __e(imgUrl) + '" alt="建议成功图片"><h3 class="h3-title">提交成功</h3><h4 class="h4-title">您的反馈我们都会认真对待，</h4><h4 class="h4-title">感谢您对顺丰速运的支持</h4><div class="back-wrapper"><a href="' + __e(indexUrl) + '" class="primary-btn autowidth">返回</a></div></section>'; return __p }, this.JST.questionSubmit = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<a href="javascript:void(0)" class="back aicon-back-setting"></a><div class="question-submit feedback-submit"><h3 class="h3-title">请描述您遇到的具体问题</h3><p class="gray">我们期待为您带来最好的服务</p><form><div class="textarea-wrapper"><textarea name="textarea" placeholder="请详细描述<' + __e(typeThree) + '>的问题，我们会努力改进的哦（必填）"></textarea><span class="no-tip">0/200</span></div><p class="gray input-notice">反馈页面截图，最多五张（选填）</p><div class="pic-wrapper"><div class="file-wrapper"><p><span class="aicon-camera-2"></span></p><input type="file" name="file"></div></div><div class="info-wrapper"><input type="text" placeholder="姓名（选填）" name="name"><input type="text" placeholder="联系方式（选填）" name="contact"></div></form><aside><p class="gray">若有问题需要咨询或解决，请联系<a href="' + __e(Helper.getOnlineServiceUrl()) + '" target="_blank">在线客服</a></p></aside><button type="button" class="primary-btn autowidth disabled submit">提交</button></div>'; return __p }, this.JST.questionType = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<a href="javascript:void(0)" class="back aicon-back-setting"></a><div class="feedback-questionType"><h3 class="h3-title">请选择问题类型</h3><p class="gray">我们期待为您带来最好的服务</p>', _.each(questionTypeList, function (e) { __p += '<a href="javascript:void(0)" data-type="' + __e(e.type) + '"><div class="left"><span class="aicon-' + __e(e.icon) + '"></span><div><h4 class="h4-title">' + __e(e.title) + '</h4><p class="gray">' + __e(e.remarks) + '</p></div></div><span class="aicon-chevron_right right"></span></a>' }), __p += "</div>"; return __p }, this.JST.subdivisionQuestion = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<a href="javascript:void(0)" class="back aicon-back-setting"></a><div class="subdivision-question"><h3 class="h3-title">请选择问题类型</h3><p class="gray">我们期待为您带来最好的服务</p>', _.each(subdivision, function (e, t) { __p += '<a href="javascript:void(0)" data-index="' + __e(t) + '">' + __e(e) + "</a>" }), __p += "</div>"; return __p }, this.JST.suggestionSubmit = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<a href="javascript:void(0)" class="back aicon-back-setting"></a><div class="suggestion-submit feedback-submit"><h3 class="h3-title">您的建议是？</h3><p class="gray">我们期待为您带来最好的服务</p><p class="gray input-notice">请选择您要建议的功能</p><div class="sf-new-capsule">', _.each(suggestFunctions, function (e) { __p += '<a href="javascript:void(0)"><span class="aicon-' + __e(e.icon) + '"></span>' + __e(e.title) + "</a>" }), __p += '</div><form><div class="textarea-wrapper"><textarea name="textarea" placeholder="欢迎您反馈对顺丰官网的使用建议，帮助我们做的更好（必填）"></textarea><span class="no-tip">0/200</span></div><p class="gray input-notice">反馈页面截图，最多五张（选填）</p><div class="pic-wrapper"><div class="file-wrapper"><p><span class="aicon-camera-2"></span></p><input type="file" name="file"></div></div><div class="info-wrapper"><input type="text" placeholder="姓名（选填）" name="name"><input type="text" placeholder="联系方式（选填）" name="contact"></div></form><aside><p class="gray">若有问题需要咨询或解决，请联系<a href="' + __e(Helper.getOnlineServiceUrl()) + '" target="_blank">在线客服</a></p></aside><button type="button" class="primary-btn autowidth disabled submit">提交</button></div>'; return __p }, this.JST.topAnswers = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<a href="javascript:void(0)" class="back aicon-back-setting"></a><div class="top-answers"><h4 class="h4-title">' + __e(data.title) + '</h4><div class="content">', _.each(data.content, function (e) { __p += "<p>" + __e(e) + "</p>" }), __p += '</div><aside class="tip gray">若以上信息没有解决您的问题，您可以使用<a href="' + __e(Helper.getOnlineServiceUrl()) + '" target="_blank">在线客服</a>为您解决</aside><footer class="options"><a href="javascript:void(0)" class="agree" data-name="' + __e(data.gather.disagree.name) + '" data-id="' + __e(data.gather.disagree.id) + '"><span class="aicon-face-serious"></span>没有用</a><a href="javascript:void(0)" class="disagree" data-name="' + __e(data.gather.agree.name) + '" data-id="' + __e(data.gather.agree.id) + '"><span class="aicon-face-smile"></span>很有用</a></footer></div>'; return __p }, this.JST.topQuestions = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="top-questions"><h3 class="h3-title">热门问题</h3><div class="wrapper">', _.each(QAContent, function (e, t) { __p += '<a href="javascript:void(0)" data-index="' + __e(t) + '"><p>' + __e(e.title) + '</p><span class="aicon-chevron_right"></span></a>' }), __p += '</div><p class="see-more"><a href="javascript:void(0)"><span>查看更多</span><span class="aicon-down"></span></a></p></div>'; return __p }, this.JST.invoicesResult = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<table class="table"><thead><tr><th>' + (null == (__t = _l("运单号码")) ? "" : __t) + "</th><th>" + (null == (__t = _l("开具日期")) ? "" : __t) + "</th><th>" + (null == (__t = _l("发票号")) ? "" : __t) + "</th><th>" + (null == (__t = _l("发票代码")) ? "" : __t) + "</th><th>" + (null == (__t = _l("金额")) ? "" : __t) + "</th><th>" + (null == (__t = _l("运单状态")) ? "" : __t) + "</th><th>" + (null == (__t = _l("发票状态")) ? "" : __t) + "</th></tr></thead><tbody>", _.each(results, function (e, t) { __p += "<tr><td>" + (null == (__t = e.billId) ? "" : __t) + "</td>", 0 == t && (__p += '<td rowspan="' + (null == (__t = results.length) ? "" : __t) + '">' + (null == (__t = e.date) ? "" : __t) + '</td><td rowspan="' + (null == (__t = results.length) ? "" : __t) + '">' + (null == (__t = e.invoiceID) ? "" : __t) + '</td><td rowspan="' + (null == (__t = results.length) ? "" : __t) + '">' + (null == (__t = e.code) ? "" : __t) + '</td><td rowspan="' + (null == (__t = results.length) ? "" : __t) + '">' + (null == (__t = _p("%.2f", e.amount)) ? "" : __t) + "</td>"), __p += "<td>" + (null == (__t = e.billStatus) ? "" : __t) + "</td><td>" + (null == (__t = e.status) ? "" : __t) + "</td></tr>" }), __p += "</tbody></table>"; return __p }, this.JST.order_normal_booking = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="booking-info-wrapper"><div class="top clearfix"><h3 class="fl">' + __e(_l("预约信息")) + "</h3>", showToggle && (__p += '<p class="fl pick-type"><a href="javascript:void(0)" class="on-door">', "hk" == Helper.getSiteLocation() ? __p += '<span class="aicon-radio icon"></span>' : __p += '<span class="aicon-radio-active icon"></span>', __p += "<span>" + __e(_l("快递员上门取件")) + '</span></a><a href="javascript:void(0)" class="by-self"><span class="aicon-radio icon"></span><span>' + __e(_l("自行联系快递员或自寄")) + "</span></a></p>"), __p += '</div><div class="form-horizontal"><div class="show-on-door"><label class="control-label required">' + __e(_l("上门时间")) + '：</label><div class="pickup-time aicon-time"><input type="text" class="form-control readonly sing-vote" placeholder="' + __e(_l("请选择您适合的时间")) + '" readonly id="date" name="date"/></div></div><div class="show-by-self warm-reminder">' + __e(_l("下单后可打印电子运单二维码，向收派员或到顺丰服务点出示二维码，扫码后快速寄件")) + '</div><div class="warm-reminder shipper-warm-reminder"></div><div class="warm-reminder consignee-warm-reminder"></div><div class="warm-reminder-wrapper"></div>', "single" === type ? __p += '<label class="control-label required">' + __e(_l("快递产品")) + '</label><ul class="product-type-wrapper"></ul>' : __p += '<div class="receiver-wrapper booking-list-wrapper"></div><div class="form-group show-on-door"><div class="col-xs-12"><label class="control-label">' + __e(_l("捎话给快递员")) + '</label><a href="javascript:void(0)" class="aicon-msg cargo-msg">' + __e(_l("无")) + "</a></div></div>", __p += '<div class="information"></div><div class="form-group text-center"><a href="javascript:void(0)" class="aicon-circle-check" id="agree-term-content"></a>' + __e(_l("我同意")) + '<a class="term" href="javascript:void(0)">《' + __e(_l("电子运单契约条款")) + '》</a></div></div><div class="btn_nav clearfix"><button type="button" class="primary-btn white big prev fl">' + __e(_l("上一步")) + '</button><button type="button" class="primary-btn big next fr disabled">' + __e(_l("下一步")) + '<span class="aicon-to-right"></span></button></div></div>'; return __p }, this.JST.order_normal_receiver_list = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="receiver-list"><div class="sftitle">' + __e(_l("收方信息")), showOnlyIssues && (__p += '<a href="javascript:void(0)" class="' + __e(onlyIssues ? "aicon-check" : "aicon-uncheck") + ' only-issues">' + __e(_l("仅显示错误的地址")) + "</a>"), __p += '</div><ul class="table-title"><li style="width: 27%">' + __e(_l("收件人")) + '</li><li style="width: 27%">' + __e(_l("地址")) + '</li><li style="width: 27%">' + __e(_l("公司名称")) + '</li></ul><div class="height-scroll"><table class="table table-hover table-striped">', _.each(rList, function (e, t) { __p += '<tr data-rid="' + __e(t) + '" class="' + __e(!1 === e.normal ? "unNormal" : "normal") + '"><td style="width: 27%"><p>' + __e(e.contactName) + "</p>", e.contactTel ? __p += '<p class="gray">' + __e(e.contactTel) + "</p>" : e.contactPhone && (__p += '<p class="gray">' + __e(e.contactPhone) + "</p>"), __p += '</td><td style="width: 27%"><p>' + __e(_.uniq(_.compact([e.province, e.city, e.county]), !0).join("")) + '</p><p class="gray">' + __e(e.address) + '</p></td><td style="width: 27%"><p>' + __e(e.companyName ? e.companyName : _l("无")) + '</p></td><td class="option" style="width: 19%"><a href="javascript:void(0)" class="btn-tip l-modify aicon-bianji" data-tip="修改"></a><a href="javascript:void(0)" class="btn-tip l-delete aicon-delete2" data-tip="删除"></a></td></tr>' }), __p += "</table></div></div>"; return __p }, this.JST.order_normal_receiver = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="drop-down-wrapper"><div class="dropdown"><button class="primary-btn small square white aicon-zengjia-01 add-more" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">' + __e(_l("多个收件人")) + '</button><ul class="dropdown-menu" aria-labelledby="dLabel"><li><a href="javascript:void(0)" class="add-one">' + __e(_l("添加一个收件人")) + '</a></li><li><a href="javascript:void(0)" class="add-from-addressBook">' + __e(_l("从地址簿添加")) + "</a></li>", "en" !== Helper.getSiteLanguage() && (__p += '<li><a href="javascript:void(0)" class="add-from-excel">' + __e(_l("从Excel表格添加")) + "</a></li>"), __p += '</ul></div></div><div class="receiver-container"></div><div class="form-group"><div class="clearfix"><a href="javascript:void(0)" class="aicon-circle-check save-address-check checked  fr">' + __e(_l("保存到地址簿")) + '</a></div></div><div class="btn_nav clearfix"><div class="dropdown"><button class="primary-btn small square white aicon-zengjia-01 add-more" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">' + __e(_l("多个收件人")) + '</button><ul class="dropdown-menu" aria-labelledby="dLabel"><li><a href="javascript:void(0)" class="add-one">' + __e(_l("添加一个收件人")) + '</a></li><li><a href="javascript:void(0)" class="add-from-addressBook">' + __e(_l("从地址簿添加")) + "</a></li>", "en" !== Helper.getSiteLanguage() && (__p += '<li><a href="javascript:void(0)" class="add-from-excel">' + __e(_l("从Excel表格添加")) + "</a></li>"), __p += '</ul></div><button type="button" class="primary-btn white big prev fl">' + __e(_l("上一步")) + '</button><button type="button" class="primary-btn big next fr">' + __e(_l("下一步")) + '<span class="aicon-to-right"></span></button></div>'; return __p }, this.JST.order_normal_sender = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="sender"></div><div class="btn_nav clearfix"><button type="button" class="primary-btn big next fr">' + __e(_l("下一步")) + '<span class="aicon-to-right"></span></button></div>'; return __p }, this.JST.order_normal_success = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="order-success">', isQr ? __p += '<div class="bill-head"><h3>' + __e(_l("运单填写成功")) + "</h3><h4>" + __e(_l("温馨提示：请把“顺丰联”粘贴在包裹上，并交由快递员揽收")) + "</h4><p>" + __e(_l("运单号")) + "： " + __e(waybillNo) + "</p></div>" : __p += "<h3>" + __e(_l("下单成功！")) + "</h3>", null != data ? (isQr || (__p += '<button class="primary-btn white small fr cancel"><span class="aicon-bs-refused"></span>' + __e(_l("取消寄件")) + "</button>"), isSelfSend && (__p += '<p class="certificate-prompt">' + __e("tw" === Helper.getSiteLocation() ? _l("請列印電子運單二維碼，向收派員或到順豐服務點出示二維碼，掃碼後快速寄件") : _l("下单后可打印电子运单二维码，向收派员或到顺丰服务点出示二维码，扫码后快速寄件")) + "</p>"), "cn" === Helper.getSiteLocation() && (__p += '<p class="certificate-prompt">' + __e(_l("温馨提示：根据《中华人民共和国反恐怖主义法》《邮件快件实名收寄管理办法》相关要求，寄件时需出示身份证等有效身份证件进行实名登记，请勿寄递禁寄物品，谢谢配合；")) + "</p>"), isQr || isSelfSend || (__p += '<div class="delivery-brother clearfix"><div class="fl"><span class="fl bill-man-head"></span><div class="fl man-info"><div><span class="man-name">' + __e(data.resoure.resourceName || _l("顺丰小哥")) + '</span><div class="star"><span class="gray"><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span></span><span class="red' + __e(data.resoure.resourceName ? "" : " none") + '"><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span></span><span class="number">' + __e(data.resoure.resourceName ? data.resoure.grade : 0) + "</span></div></div><div><span>" + __e(_l("联系电话")) + " </span><span>" + __e(data.resoure.telphone || "") + '</span></div></div></div><div class="fr clearfix" style="margin-top:5px; text-align: right;"><div><span class="gray">' + __e(_l("预计上门时间")) + "</span></div><div>" + __e(relativeDate) + '<span class="delivery-time">' + __e(relativeHour) + "</span></div></div></div>"), __p += '<div class="sfcard pad"><table class="sender-table"><tr><td class="send-badge"><span class="sfbadge black">' + __e(_l("寄")) + '</span><span class="aicon-v-dot"></span></td><td class="express-info"><p class="bold">' + __e(sender.contactName) + "</p><p>" + __e(sender.contactTel || sender.contactPhone) + '</p></td><td colspan="2"><p>' + __e(_.uniq(_.compact([sender.province, sender.city, sender.county]), !0).join("")) + "</p><p>" + __e(sender.address) + '</p></td></tr></table><p class="line"></p><table><tr><td><span class="sfbadge red">' + __e(_l("收")) + '</span></td><td class="express-info"><p class="bold">' + __e(receiver.contactName) + "</p><p>" + __e(receiver.contactTel || receiver.contactPhone) + '</p></td><td colspan="2"><p>' + __e(_.uniq(_.compact([receiver.province, receiver.city, receiver.county]), !0).join("")) + "</p><p>" + __e(receiver.address) + '</p></td></tr><tr><td></td><td colspan="3"><p>' + __e(_l("预约号")) + "： " + __e(data.appointmentNo) + '</p></td></tr></table><ul class="bill-other-info"><li><p class="gray">' + __e(_l("托寄物品信息")) + "</p><p>" + __e(info.cargo) + '</p></li><li><p class="gray">' + __e(_l("付款方式")) + "</p><p>" + __e(info.payType) + "</p></li>", hasCargoInsure && (__p += '<li><p class="gray">' + __e(_l("保价")) + "</p><p>" + __e(info.declaredValue) + "</p></li>"), hasCargoService && (__p += '<li><p class="gray">' + __e(_l("增值服务")) + "</p><p>" + __e(info.additionalText) + "</p></li>"), __p += "</ul></div>") : __p += '<img src="' + __e(imgUrl) + '" alt="下单成功图片">', __p += '<div class="clearfix options"><a href="' + __e(waybillUrl) + '" class="primary-btn white square fl go-waybill"><span class="aicon-intellect-address"></span>' + __e(_l("查看订单列表")) + "</a>", null != data && (isQr ? __p += '<button class="primary-btn big order-again fr maidian" data-md-name="再下一单" data-md-id="125002">' + __e(_l("再下一单")) + "</button>" : (isSelfSend && (__p += '<button class="primary-btn white square fl download"><span class="aicon-i-down"></span>' + __e(_l("下载电子运单")) + "</button>"), __p += '<button class="primary-btn big fill-bill fr">' + __e(_l("完善快件信息")) + "</button>")), __p += "</div></div>"; return __p }, this.JST.order_normal = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="order-service ui-front"><div class="receiver-areas" role="radiogroup"><a href="javascript:void(0)" class="toggle-tab" role="radio" data-tab="normalCargo">' + __e(_l("寄快递")) + '</a><a href="javascript:void(0)" class="toggle-tab" role="radio" data-tab="heavyCargo">' + __e(_l("寄大件")) + '</a><a href="javascript:void(0)" class="toggle-tab" role="radio" data-tab="qrCode">' + __e(_l("二维码寄件")) + '</a></div><div class="order-wrapper clearfix"><div class="bulkShipping"><ul class="step clearfix"><li class="active"><strong>01</strong><i></i><p>' + __e(_l("寄件人信息")) + "</p></li><li><strong>02</strong><i></i><p>" + __e(_l("收件人信息")) + "</p></li><li><strong>03</strong><i></i><p>" + __e(_l("预约信息")) + "</p></li><li><strong>04</strong><i></i><p>" + __e(_l("完成下单")) + '</p></li></ul><div class="items clearfix"><div class="page active"><div class="page-wrapper"><div class="sender-info"></div></div></div><div class="page"><div class="page-wrapper"><div class="receiver-info"></div></div></div><div class="page"><div class="page-wrapper"><div class="booking-info"></div></div></div><div class="page"><div class="page-wrapper"><div class="booking-succ"></div></div></div></div></div></div></div>'; return __p }, this.JST.booking_list = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<ul class="table-title"><li style="width: 25%"><a href="javascript:void(0)" class="aicon-uncheck check-box select-all"></a>' + __e(_l("收件人")) + '</li><li style="width: 35%">' + __e(_l("地址")) + '</li><li style="width: 40%">' + __e(_l("快递产品")) + '</li></ul><div class="height-scroll"><table class="table table-hover table-striped">', _.each(rList, function (e) { __p += '<tr data-rid="' + __e(e.rid) + '" data-code="' + __e(e.destRateCode) + '"><td style="width: 25%"><a href="javascript:void(0)" class="aicon-uncheck check-box select-one"></a><p>' + __e(e.contactName) + '</p><p class="gray">' + __e(e.contactTel || e.contactPhone) + '</p><p class="consignee-warm-reminder"></p></td><td style="width: 35%"><p>' + __e(_.uniq(_.compact([e.province, e.city, e.county]), !0).join("")) + '</p><p class="gray">' + __e(e.address) + '</p></td><td style="width: 30%" class="rate-cell"></td>', "hk" != Helper.getSiteLocation() && (__p += '<td style="width: 10%" class="option"><a href="javascript:void(0)" class="modify aicon-bianji"></a></td>'), __p += "</tr>" }), __p += '</table></div><div class="form-group predict-price-content">', "hk" != Helper.getSiteLocation() && (__p += '<div class="col-xs-12"><button type="button" class="primary-btn white square bulk-modify-select">' + __e(_l("批量修改快递产品")) + '</button><button type="button" class="primary-btn square bulk-modify-confirm">' + __e(_l("确认选择")) + '</button><button type="button" class="primary-btn white square bulk-modify-cancel">' + __e(_l("取消选择")) + "</button></div>"), __p += '<div class="predict-price"><p class="text">' + __e(_l("预计总运费")) + '</p><p class="number"><span class="currency">' + __e(currencyCode) + '</span><span class="price"></span></p></div></div>'; return __p }, this.JST.payFee = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<td class="payFee-info" ><div class="service-info-wrapper">', showDefaultService ? __p += "<a href='javascript:void(0)'><div title=\"" + (null == (__t = service.limitTypeName) ? "" : __t) + '" class="service-info-title"><span class="limit-type-name" >' + (null == (__t = service.limitTypeName) ? "" : __t) + "</span></div></a>" : ("#" !== service.link && (__p += "<a href='" + (null == (__t = service.link) ? "" : __t) + '\' target="_blank">'), __p += '<div title="' + (null == (__t = service.limitTypeName) ? "" : __t) + '" class="service-info-title ' + (null == (__t = service.isPromotion ? "promotion" : "") ? "" : __t) + '"><span class="limit-type-name" >' + (null == (__t = service.limitTypeName) ? "" : __t) + "</span>", service.cargoTypeName && " " != service.cargoTypeName && service.shouldShowCargoType && (__p += '<span class="cargo-type"  title="' + (null == (__t = service.cargoTypeName) ? "" : __t) + '">(' + (null == (__t = service.cargoTypeName) ? "" : __t) + ")</span>"), _.each(service.additionalPayFees, function (e) { ("overdue-refund" === e.code || "earlier-shipping-lower-price" === e.code && 0 != service.regionFreight) && (__p += '<img src="' + (null == (__t = e.icon) ? "" : __t) + '" alt="' + (null == (__t = e.name) ? "" : __t) + '"class="additional-service-icon" />') }), __p += "</div>", "#" !== service.link && (__p += "</a>")), __p += '</div></td><td class="weight-info">', showDefaultService ? __p += '<div class="weight">1kg</div>' : service.showDestCurrencyPrice ? __p += '<div class="weight">' + (null == (__t = service.destWeightUnit ? service.destWeight : service.weight) ? "" : __t) + (null == (__t = "en" === Helper.getSiteLanguage() ? " " : "") ? "" : __t) + (null == (__t = service.destWeightUnit ? service.destWeightUnit : service.weightUnit) ? "" : __t) + '\x3c!-- _l("公斤") --\x3e</div>' : __p += '<div class="weight">' + (null == (__t = service.weight) ? "" : __t) + (null == (__t = "en" === Helper.getSiteLanguage() ? " " : "") ? "" : __t) + (null == (__t = service.weightUnit) ? "" : __t) + "</div>", __p += '</td><td class="time-info">', showDefaultService ? __p += '<div class="time first">' + (null == (__t = service.deliverTime) ? "" : __t) + "</div>" : service.deliverTime ? (__p += '<div class="time first">', service.internet ? __p += (null == (__t = service.deliverTime) ? "" : __t) + "" + (null == (__t = _l("天")) ? "" : __t) + "\x3c!--港澳台地区互寄显示时效为具体时间--\x3e" : "2" === service.destView && "2" === service.orgionView ? __p += null == (__t = moment.isMoment(moment(service.deliverTime).toString()) ? moment(service.deliverTime).format("YYYY-MM-DD") : service.deliverTime + _l("前")) ? "" : __t : service.addTime ? (moment(service.addTime).isBefore(moment(service.deliverTime)) ? __p += (null == (__t = service.addTime) ? "" : __t) + "<br/>" + (null == (__t = _l("偏远区域加时")) ? "" : __t) : moment.isMoment(moment(service.deliverTime).toString()) ? __p += null == (__t = moment(service.deliverTime).format("YYYY-MM-DD")) ? "" : __t : "sc" != Helper.getSiteLanguage() && "tc" != Helper.getSiteLanguage() ? "次日" === service.deliverTime.substr(0, 2) ? __p += null == (__t = service.deliverTime.replace("次日", "Next day ")) ? "" : __t : "工商" === service.deliverTime.substr(0, 2) ? __p += null == (__t = service.deliverTime.replace("工商区:", "Commercial and Industrial area: ").replace(/次日/g, "before Next day ").replace("住宅区:", "Residential area: ").replace("非工商区:", "Residential area: ")) ? "" : __t : __p += (null == (__t = service.deliverTime) ? "" : __t) + '<span class="timeBefore">' + (null == (__t = _l("前")) ? "" : __t) + "</span>" : "Invalid date" == moment(service.deliverTime).format("YYYY-MM-DD HH:mm") ? __p += null == (__t = service.deliverTime) ? "" : __t : __p += (null == (__t = service.deliverTime) ? "" : __t) + '<span class="timeBefore">' + (null == (__t = _l("前")) ? "" : __t) + "</span>", __p += "\x3c!--" + (null == (__t = moment.isMoment(moment(service.deliverTime).toString()) ? moment(service.deliverTime).format("YYYY-MM-DD") : service.deliverTime) ? "" : __t) + "--\x3e") : (__p += "\x3c!--" + (null == (__t = moment.isMoment(moment(service.deliverTime).toString()) ? moment(service.deliverTime).format("YYYY-MM-DD") : service.deliverTime) ? "" : __t) + "--\x3e", moment.isMoment(moment(service.deliverTime).toString()) ? __p += null == (__t = moment(service.deliverTime).format("YYYY-MM-DD")) ? "" : __t : "sc" != Helper.getSiteLanguage() && "tc" != Helper.getSiteLanguage() ? "次日" === service.deliverTime.substr(0, 2) ? __p += null == (__t = service.deliverTime.replace("次日", "Next day ")) ? "" : __t : "工商" === service.deliverTime.substr(0, 2) ? __p += null == (__t = service.deliverTime.replace("工商区:", "Commercial and Industrial area: ").replace(/次日/g, "before Next day ").replace("住宅区:", "Residential area: ").replace("非工商区:", "Residential area: ")) ? "" : __t : __p += (null == (__t = service.deliverTime) ? "" : __t) + '<span class="timeBefore">' + (null == (__t = _l("前")) ? "" : __t) + "</span>" : "Invalid date" == moment(service.deliverTime).format("YYYY-MM-DD HH:mm") ? __p += null == (__t = service.deliverTime) ? "" : __t : __p += (null == (__t = service.deliverTime) ? "" : __t) + '<span class="timeBefore">' + (null == (__t = _l("前")) ? "" : __t) + "</span>"), __p += '</div>\x3c!--  <span class="time">' + (null == (__t = moment.isMoment(moment(service.deliverTime).toString()) ? service.deliverDate : "") ? "" : __t) + "&nbsp;&nbsp;" + (null == (__t = moment.isMoment(moment(service.deliverTime).toString()) ? service.deliverMomentTime : "") ? "" : __t) + "</span>--\x3e") : service.deliverTimeForType && (__p += '<div class="time first">' + (null == (__t = service.deliverTimeForType) ? "" : __t) + "</div>"), __p += '</td><td class="rate-info">', showDefaultService ? __p += null == (__t = service.totalFreight) ? "" : __t : service.showDestCurrencyPrice ? "coldChain" === rateType ? "sc" == Helper.getSiteLanguage() ? (__p += null == (__t = service.destCurrencyName) ? "" : __t, service.destPickupFreight && (__p += (null == (__t = _l("提货费：")) ? "" : __t) + "" + (null == (__t = service.destPickupFreight) ? "" : __t) + "</br>"), __p += (null == (__t = _l("运输费：")) ? "" : __t) + "" + (null == (__t = service.destTransportFreight) ? "" : __t) + "</br>", service.destDistributionFreight && (__p += (null == (__t = _l("配送费：")) ? "" : __t) + "" + (null == (__t = service.destDistributionFreight) ? "" : __t))) : (service.destPickupFreight && (__p += (null == (__t = _l("提货费：")) ? "" : __t) + "" + (null == (__t = service.destCurrencyName) ? "" : __t) + (null == (__t = service.destPickupFreight) ? "" : __t) + "</br>"), __p += (null == (__t = _l("运输费：")) ? "" : __t) + "" + (null == (__t = service.destCurrencyName) ? "" : __t) + (null == (__t = service.destTransportFreight) ? "" : __t) + "</br>", service.destDistributionFreight && (__p += (null == (__t = _l("配送费：")) ? "" : __t) + "" + (null == (__t = service.destCurrencyName) ? "" : __t) + (null == (__t = service.destDistributionFreight) ? "" : __t))) : (__p += null == (__t = service.destCurrencyName) ? "" : __t, "1" === service.orgionView && "1" === service.destView ? __p += null == (__t = service.totalFreight) ? "" : __t : __p += null == (__t = service.destFreight) ? "" : __t) : "coldChain" === rateType ? "sc" == Helper.getSiteLanguage() ? (__p += null == (__t = service.currencyName) ? "" : __t, service.pickupFreight && (__p += (null == (__t = _l("提货费：")) ? "" : __t) + "" + (null == (__t = service.pickupFreight) ? "" : __t) + "</br>"), __p += (null == (__t = _l("运输费：")) ? "" : __t) + "" + (null == (__t = service.transportFreight) ? "" : __t) + "</br>", service.distributionFreight && (__p += (null == (__t = _l("配送费：")) ? "" : __t) + "" + (null == (__t = service.distributionFreight) ? "" : __t))) : (service.pickupFreight && (__p += (null == (__t = _l("提货费：")) ? "" : __t) + "" + (null == (__t = service.currencyName) ? "" : __t) + (null == (__t = service.pickupFreight) ? "" : __t) + "</br>"), __p += (null == (__t = _l("运输费：")) ? "" : __t) + "" + (null == (__t = service.currencyName) ? "" : __t) + (null == (__t = service.transportFreight) ? "" : __t) + "</br>", service.distributionFreight && (__p += (null == (__t = _l("配送费：")) ? "" : __t) + "" + (null == (__t = service.currencyName) ? "" : __t) + (null == (__t = service.distributionFreight) ? "" : __t))) : (__p += null == (__t = service.currencyName) ? "" : __t, "1" === service.orgionView && "3" !== service.destView || "2" === service.orgionView && "1" === service.destView ? __p += null == (__t = service.totalFreight) ? "" : __t : __p += null == (__t = service.freight) ? "" : __t), __p += '<div class="additional-services-link"></div></td>'; return __p }, this.JST.payFeeComments = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) _.each(comments, function (e) { e.shouldShow && (__p += '<div class="service-comment">' + (null == (__t = e.detail) ? "" : __t) + "</div>") }); return __p }, this.JST.payFeeContainer = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="service-switch"><a href="javascript:void(0)" data-type="normal" class="active maidian" data-md-name="点击快递"  data-md-id="117002">' + (null == (__t = _l("快递")) ? "" : __t) + "</a>", "cn" == Helper.getSiteLocation() && (__p += '<a href="javascript:void(0)" data-type="heavyCargo" class="maidian" data-md-name="点击大件"  data-md-id="117003">' + (null == (__t = _l("大件")) ? "" : __t) + '</a><a href="javascript:void(0)" data-type="coldChain" class="maidian"  data-md-name="点击冷运"  data-md-id="117004">' + (null == (__t = _l("冷运")) ? "" : __t) + "</a>"), __p += '</div><div class="service-heavyCargo-weight-tip sfi sfi-bell">' + (null == (__t = _l("重货速运产品根据寄件流向会有最低计价重量及最低收费，请知悉")) ? "" : __t) + '</div><div class="services-top-bar"><h5 class="pull-left">' + (null == (__t = _l("我们的产品")) ? "" : __t) + '</h5><ul class="utils pull-right"></ul></div><div class="service-wrapper top-gray-gradient"><span id="not-support-flow-control">' + (null == (__t = _l("暂不支持流向控制")) ? "" : __t) + '</span></div><div class="service-clodchain-tips coldChain-tips"><span><h5>' + (null == (__t = _l("温馨提示：")) ? "" : __t) + "</h5></span><br/><span>" + (null == (__t = _l("一、冷运零担")) ? "" : __t) + "</span><br/><span>" + (null == (__t = _l("a) 寄付价=提货费+运输费+送货费：当查询结果未显示提货或送货费用时，请您选择自送至冷库或到冷库自提。")) ? "" : __t) + "</span><br/><span>" + (null == (__t = _l("b) 关于时效：“如需提、送服务，时效在此基础上慢0到2天”。")) ? "" : __t) + "</span><br/><span>" + (null == (__t = _l("c) 如需自助下单请关注【顺丰冷运】微信公众号或登录http://p.sf-express.com。")) ? "" : __t) + "</span><br/><span>" + (null == (__t = _l("二、冷运到家")) ? "" : __t) + "</span><br/><span>" + (null == (__t = _l("a) 如使用EPP箱，加收6元/票的收费。")) ? "" : __t) + '</span></div><div class="service-internet-wrapper"><div id="internet"></div></div><div class="services-bottom-bar"><div class="additional-services-link"></div></div>'; return __p }, this.JST.payFeeInitial = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<td class="service-info">', "#" !== link && (__p += "<a href='" + (null == (__t = link) ? "" : __t) + '\' target="_blank">'), __p += '<div class="service-info-wrapper service-popover-container"><div class="service-info-title ' + (null == (__t = isPromotion ? "promotion" : "") ? "" : __t) + '"><span class="circle"></span><div class="limit-type-name">' + (null == (__t = limitTypeName) ? "" : __t) + "</div></div>", "#" !== link && (__p += "</a>"), __p += '</div></td><td class="promotion-info"><p title="' + (null == (__t = promotionMessage) ? "" : __t) + '">' + (null == (__t = promotionMessage) ? "" : __t) + "</p></td>"; return __p }, this.JST.payFeeInternet = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="service-internet"><table  style="width: 100%;"><tbody>', service.internet && (service.expectArriveTm || service.otherService) && (__p += '<tr><td style="width: 25%;text-align:right;font-size:16px;"> ' + (null == (__t = _l("派件服务时间")) ? "" : __t) + ' </td><td style="width:75%;text-align:left;padding:20px;">' + (null == (__t = service.expectArriveTm.replace(/;/g, "<br/>")) ? "" : __t) + "</td></tr>"), __p += "</tbody></table></div>"; return __p }, this.JST.rangeResult = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="main-content-row range-result-brief no-padding"><div class="range-result-brief-content"><span class="location-name">' + (null == (__t = locationName) ? "" : __t) + '</span><dl class="location-type">', "ALL_REGION" === type ? __p += "<dt>" + (null == (__t = _l("全境配送")) ? "" : __t) + "</dt>" : "PART_REGION" === type ? __p += "<dt>" + (null == (__t = _l("部分地区提供服务")) ? "" : __t) + "</dt>" : __p += "<dt>" + (null == (__t = _l("本地区不配送")) ? "" : __t) + "</dt>", __p += "</dl>", unavailableRegions.length && (__p += '<dl class="unavailable-ranges"><dt>' + (null == (__t = _l("不服务的地区为：")) ? "" : __t) + "</dt><dd>" + (null == (__t = _.pluck(unavailableRegions, "name").join("、")) ? "" : __t) + "</dd></dl>"), isHongKongAddress && (__p += '<p class="side-note">' + (null == (__t = _l("备注：") + _l("非工商附加费", "1. 非工商附加费：寄出或派送的快件，须收取HKD18服务费。")) ? "" : __t) + "<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;" + (null == (__t = _l("偏远地区附加费", "2. 偏远地区附加费：寄出或派送的快件，须收取HKD30服务费。")) ? "" : __t) + "</p>"), isTaiWanAddress && (__p += '<p class="side-note">' + (null == (__t = _l("台湾偏远地区范围备注", "备注: 偏远地区需另收取每票NTD150，请<a href='tw_remote_area.html'>按此</a>查询详细台湾偏远地区范围。")) ? "" : __t) + "</p>"), __p += "</div>", "sc" === lang && "cn" === region && (__p += '<div class="find-corresponding-store top-gray-gradient"><a href="' + (null == (__t = storeLinkURL) ? "" : __t) + '">' + (null == (__t = _l("查看全部网点")) ? "" : __t) + '<span class="sfi sfi-chevron-circle-right"></span></a></div>'), __p += "</div>", (normalRegions.length || abnormalRegions.length) && (__p += '<div class="main-content-row range-result-detail"><div class="detail-title">' + (null == (__t = _l("服务地区详情")) ? "" : __t) + '</div><div class="detail-content">', normalRegions.length && (__p += '<div class="region-results-wrapper"><div class="regions-title"><i class="sfi sfi-clipboard"></i><span>' + (null == (__t = _l("正常派送地区：")) ? "" : __t) + '</span></div><ul class="result-regions">', _.each(normalRegions, function (e, t) { t % 6 == 0 && (__p += '<div class="result-regions-row">'), __p += '<li data-normal-region="true" data-code="' + (null == (__t = e.code) ? "" : __t) + '"><span title="' + (null == (__t = e.name) ? "" : __t) + '">' + (null == (__t = e.name) ? "" : __t) + "</span></li>", t % 6 == 5 && (__p += "</div>") }), normalRegions.length % 6 == 0 && (__p += "</div>"), __p += "</ul></div>"), abnormalRegions.length && (__p += '<div class="region-results-wrapper"><div class="regions-title"><i class="sfi sfi-clipboard"></i><span>' + (null == (__t = _l("部分收送地区：")) ? "" : __t) + '</span></div><ul class="result-regions">', _.each(abnormalRegions, function (e, t) { t % 6 == 0 && (__p += '<div class="result-regions-row">'), __p += '<li data-code="' + (null == (__t = e.code) ? "" : __t) + '"><span title="' + (null == (__t = e.name) ? "" : __t) + '">' + (null == (__t = e.name) ? "" : __t) + "</span></li>", t % 6 == 5 && (__p += "</div>") }), abnormalRegions.length % 6 == 0 && (__p += "</div>"), __p += "</ul></div>"), __p += "</div></div>"); return __p }, this.JST.rangeResultInternational = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="main-content-row range-result-brief no-padding"><div class="range-result-brief-content"><span class="location-name">' + (null == (__t = name) ? "" : __t) + " - " + (null == (__t = zipCodeInputed) ? "" : __t) + '</span><p class="side-note">', "A000001000" === locationCountryCode ? __p += null == (__t = _l("美国")) ? "" : __t : __p += null == (__t = _l("其他国家")) ? "" : __t, __p += "</p></div></div>"; return __p }, this.JST.rangeResultPopover = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="result-region-detail-wrapper"><div class="result-region-detail">', isNormalRegion ? (__p += '<p class="store-description clearfix" style="margin-bottom: 10px;">', _.each(childrenReg, function (e, t) { __p += '<span style="width:33%; text-align:center; float:left;"> ' + (null == (__t = e.name) ? "" : __t) + "</span>" }), __p += '</p><p class="store-description">' + (null == (__t = _p(_l("前往%s的网点，到点自寄自取，享方便优惠"), '<span class="location-name">' + region.name + "</span>")) ? "" : __t) + '<a href="' + (null == (__t = linkURL) ? "" : __t) + '" class="redirect">' + (null == (__t = _l("查看网点")) ? "" : __t) + "</a></p>") : (__p += '<div class="result-region-detail-content pull-left"><div class="location-name"><i class="icon-gray-map"></i><span>' + (null == (__t = region.name) ? "" : __t) + '</span><span class="description">' + (null == (__t = _l("服务地区")) ? "" : __t) + "</span></div>", _.each(availableDescription, function (e) { __p += '<div class="detail-descript"><span class="litter-tag">' + (null == (__t = e.litterTag) ? "" : __t) + "</span><span>" + (null == (__t = e.remark) ? "" : __t) + "</span>", showRemarkFromEnd && null != e && null != e.remark_content && "" != e.remark_content && (__p += '<br/><span style="display: inline-grid;width: 100px;display: inline-block;width: 290px;padding-left: 25px;padding-top: 5px;word-break: break-word;word-wrap: break-word;">' + (null == (__t = _l("备注：")) ? "" : __t) + (null == (__t = e.remark_content) ? "" : __t) + "</span>"), __p += "</div>" }), region.remark && showRemark && (__p += '<div class="location-name"><i class="icon-gray-map"></i><span style="font-size:12px">' + (null == (__t = region.remark) ? "" : __t) + "</span></div>"), __p += '</div><a href="' + (null == (__t = linkURL) ? "" : __t) + '"><img class="pull-right" src="' + (null == (__t = _l("selfpickupsalesimg")) ? "" : __t) + '" alt=""></a>'), __p += "</div></div>"; return __p }, this.JST.regulationResult = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<table class="table table-bordered"><tbody>', _.each(results, function (e) { __p += "<tr><td>" + (null == (__t = e.get("goodsName")) ? "" : __t) + "</td><td>" + (null == (__t = e.get("goodsDetails")) ? "" : __t) + "</td></tr>" }), __p += "</tbody></table>"; return __p }, this.JST.serviceInsideNav = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="all-support-container"><ul class="clearfix">', _.each(allService, function (e) { (void 0 !== e.show && !0 === e.show() || void 0 === e.show) && (e.dropdown ? (__p += '<li class="fl all-support-item has-dropdown"><a href="javascript:void(0)" class="wrapper"><span class="aicon aicon-' + __e(e.icon) + '"></span><span class="desc-text">' + __e(e.name) + '<span class="chevron-down-outlined"></span></span></a><ul class="dropdown-menu">', _.each(e.dropdown, function (e) { __p += '<li><a href="' + __e(e.url) + '">' + __e(e.name) + "</a></li>" }), __p += "</ul></li>") : __p += '<li class="fl all-support-item"><a href="' + __e(e.url) + '" class="wrapper"><span class="aicon aicon-' + __e(e.icon) + '"></span><span class="desc-text">' + __e(e.name) + "</span></a></li>") }), __p += "</ul></div>"; return __p }, this.JST.sfCare = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="often-support"><div><span class="often-use">' + __e(_l("常用功能")) + '</span></div><div class="often-use-container"><ul class="clearfix">', _.each(topService, function (e) { __p += '<li class="fl often-use-item"><a href="' + __e(e.url) + '"><span class="aicon aicon-' + __e(e.icon) + '"></span><p class="desc-text">' + __e(e.name) + "</p></a></li>" }), __p += '</ul></div><div class="toggle-more"><a href="javascript:void(0)" class="toggle-service-list"><span class="open-toggle-txt">' + __e(_l("展开更多服务")) + '<span class="chevron-down-outlined"></span></span><span class="close-toggle-txt" style="display: none">' + __e(_l("收起更多服务")) + '<span class="chevron-up-outlined"></span></span></a></div></div><ul class="more-support clearfix">', _.each(bottomService, function (e) { (void 0 !== e.show && !0 === e.show() || void 0 === e.show) && (e.dropdown ? (__p += '<li class="fl more-support-item has-dropdown"><a href="javascript:void(0)" class="wrapper"><span class="aicon aicon-' + __e(e.icon) + '"></span><p class="desc-text">' + __e(e.name) + '<span class="chevron-down-outlined"></span></p></a><ul class="dropdown-menu">', _.each(e.dropdown, function (e) { __p += '<li><a href="' + __e(e.url) + '">' + __e(e.name) + "</a></li>" }), __p += "</ul></li>") : __p += '<li class="fl more-support-item"><a href="' + __e(e.url) + '" class="wrapper"><span class="aicon aicon-' + __e(e.icon) + '"></span><p class="desc-text">' + __e(e.name) + "</p></a></li>") }), __p += "</ul>"; return __p }, this.JST.taxBorderDetail = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="sfi sfi-times close"></div><h2>中华人民共和国海关</h2><h2>跨境直邮/保税进口税款电子回执</h2><h3>(仅供对账之用)</h3><h4>&nbsp;</h4><div style="padding:5px 10px;overflow:hidden"><div style="float:left;">纳税人姓名（地址）：<span style="color:black;">' + (null == (__t = result.details[0].sfpname) ? "" : __t) + '</span></div><div style="float:right;width:200px;display:inline-block;text-align:right;">申报日期：<span>' + (null == (__t = result.taxDate) ? "" : __t) + '</span></div></div><table class="table"><tbody><tr><th>序号</th><th>分运单号码</th><th>货物名称</th><th>申报价值</th><th>关税税额</th><th>增值税税额</th><th>消费税额</th><th>税金合计(CNY)</th></tr>', _.forEach(result.details, function (e, t) { __p += "<tr><td>" + (null == (__t = t + 1) ? "" : __t) + "</td><td>" + (null == (__t = e.bno) ? "" : __t) + "</td><td>" + (null == (__t = e.gdesc) ? "" : __t) + "</td><td>" + (null == (__t = e.value) ? "" : __t) + "</td><td>" + (null == (__t = e.traiffval) ? "" : __t) + "</td><td>" + (null == (__t = e.vatval) ? "" : __t) + "</td><td>" + (null == (__t = e.payval) ? "" : __t) + "</td><td>" + (null == (__t = e.totalval) ? "" : __t) + "</td></tr>" }), __p += '<tr><td colspan="8" class="text-left">进口税金合计：人民币（大写）  <span>' + (null == (__t = result.totalTax) ? "" : __t) + '</span>\t</td></tr></tbody></table><div class="remark"><div>说明:</div><div class="inline-block">' + (null == (__t = _l("税金计算公式")) ? "" : __t) + ':</div><div class="inline-table"><div>' + (null == (__t = _l("总税计算", "税金合计=关税税额 + 增值税税额 + 消费税税额")) ? "" : __t) + "</div><div>" + (null == (__t = _l("应征关税计算", "应征关税=完税价格*关税税率")) ? "" : __t) + "</div><div>" + (null == (__t = _l("关税税额计算", "关税税额=价值(CIF) * 关税税率")) ? "" : __t) + "</div><div>" + (null == (__t = _l("增值税税额计算", "增值税税额=(价值(CIF) + 关税税额 + 消费税税额) * 增值税税率")) ? "" : __t) + "</div><div>" + (null == (__t = _l("消费税税额计算", "消费税税额=(价值(CID) + 关税税额) / (1 - 消费税税额) * 消费税税率")) ? "" : __t) + '</div><br/><div>备注:</div><div><ul><li>1.根据跨境电商进口税收新政策的说明，跨境电商零售进口商品单次交易总额在限值内的，进口环节增值税、消费税暂按法定应纳税额的70%征收。</li><li>2.税金合计栏四舍五入保留整数.</li><li>3.此为海关电子审单放行回执，仅供对账之用.</li></ul></div></div><div class="row"><div class="verification-code"><div class="input-group col-xs-offset-2 col-xs-3"><input type="text" id="validation-download-code" class="form-control no-right-border" placeholder="请输入验证码下载文件"><span class="input-group-addon refresh no-left-border" id="refresh-download-code"><span class="sfi sfi-refresh"></span></span></div><div class="col-xs-2 no-left-padding"><img class="validation-image" id="validation-download-image" src="/sf-service-web/service/captcha/kj3tax?force=true&amp;time=1407399546971"></div><div class="col-xs-2"><button class="primary-button download disabled fileDownloadPromise">下载</button></div></div></div>'; return __p }, this.JST.taxDetail = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="sfi sfi-times close"></div><h2>' + (null == (__t = _l("进境快件中国海关EDI电子审单放行回执")) ? "" : __t) + "</h2><h3>" + (null == (__t = _l("(仅供企业对账之用)")) ? "" : __t) + "</h3><p>" + (null == (__t = _l("报关单编号")) ? "" : __t) + ":" + (null == (__t = result.taxNO) ? "" : __t) + '</p><table class="table"><tr><th colspan="9" class="text-left">' + (null == (__t = _l("运营人名称")) ? "" : __t) + ": " + (null == (__t = result.operatorName) ? "" : __t) + " &nbsp;&nbsp;&nbsp;\x3c!-- " + (null == (__t = _l("进/出口岸")) ? "" : __t) + ": " + (null == (__t = result.deptCode) ? "" : __t) + " &nbsp;&nbsp;&nbsp;--\x3e" + (null == (__t = _l("运输工具航次")) ? "" : __t) + ": " + (null == (__t = result.flightNO) ? "" : __t) + " &nbsp;&nbsp;&nbsp;" + (null == (__t = _l("进/出境日期")) ? "" : __t) + ": " + (null == (__t = result.taxDate) ? "" : __t) + " &nbsp;&nbsp;&nbsp;" + (null == (__t = _l("总运单号码")) ? "" : __t) + ": " + (null == (__t = result.tWaybillno) ? "" : __t) + " &nbsp;&nbsp;&nbsp;</th></tr><tr><th>" + (null == (__t = _l("序号")) ? "" : __t) + "</th><th>" + (null == (__t = _l("分运单号码")) ? "" : __t) + "</th><th>" + (null == (__t = _l("货物名称")) ? "" : __t) + "</th>\x3c!--<th>" + (null == (__t = _l("价值(CNY)")) ? "" : __t) + "</th>--\x3e<th>" + (null == (__t = _l("重量(KG)")) ? "" : __t) + "</th><th>" + (null == (__t = _l("件数")) ? "" : __t) + "</th>\x3c!-- <th>" + (null == (__t = _l("商品编码(HS)")) ? "" : __t) + "</th><th>" + (null == (__t = _l("关税速率")) ? "" : __t) + "</th> --\x3e<th>" + (null == (__t = _l("关税税额")) ? "" : __t) + "</th>\x3c!-- <th>" + (null == (__t = _l("增值税税率")) ? "" : __t) + "</th>--\x3e<th>" + (null == (__t = _l("增值税税额")) ? "" : __t) + "</th>\x3c!-- <th>" + (null == (__t = _l("消费税税率")) ? "" : __t) + "</th>--\x3e<th>" + (null == (__t = _l("消费税税额")) ? "" : __t) + "</th><th>" + (null == (__t = _l("税金合计(CNY)")) ? "" : __t) + "</th>\x3c!--  <th>" + (null == (__t = _l("收/发件人名称")) ? "" : __t) + "</th>--\x3e</tr>", _.forEach(result.details, function (e, t) { __p += "<tr><td>" + (null == (__t = t + 1) ? "" : __t) + "</td><td>" + (null == (__t = e.bno) ? "" : __t) + "</td><td>" + (null == (__t = e.gdesc) ? "" : __t) + "</td>\x3c!-- <td>" + (null == (__t = e.value) ? "" : __t) + "</td>--\x3e<td>" + (null == (__t = e.weight) ? "" : __t) + "</td><td>" + (null == (__t = e.pcs) ? "" : __t) + "</td>\x3c!-- <td>" + (null == (__t = e.hscode) ? "" : __t) + "</td><td>" + (null == (__t = e.traiff) ? "" : __t) + "</td>--\x3e<td>" + (null == (__t = e.traiffval) ? "" : __t) + "</td>\x3c!-- <td>" + (null == (__t = e.vat) ? "" : __t) + "</td>--\x3e<td>" + (null == (__t = e.vatval) ? "" : __t) + "</td>\x3c!-- <td>" + (null == (__t = e.pay) ? "" : __t) + "</td>--\x3e<td>" + (null == (__t = e.payval) ? "" : __t) + "</td><td>" + (null == (__t = e.totalval) ? "" : __t) + "</td>\x3c!-- <td>" + (null == (__t = e.sfpname) ? "" : __t) + "</td>--\x3e</tr>" }), __p += '<tr><td colspan="9">&nbsp;</td></tr><tr>\x3c!--<td class="no-left-border no-right-border no-bottom-border">' + (null == (__t = result.totalVal) ? "" : __t) + '</td><td class="no-left-border no-right-border no-bottom-border">' + (null == (__t = result.totalWeight) ? "" : __t) + '</td>--\x3e<td colspan="7"></td><td  >' + (null == (__t = _l("总税")) ? "" : __t) + " </td><td >" + (null == (__t = result.totalTax) ? "" : __t) + '</td></tr><tr><td colspan="9" class="text-left">' + (null == (__t = _l("本运营人保证")) ? "" : __t) + ": " + (null == (__t = result.taxDate) ? "" : __t) + " " + (null == (__t = _l("向")) ? "" : __t) + " " + (null == (__t = result.portName) ? "" : __t) + (null == (__t = _l("海关申报", "海关申报的上述货物为《中华人民共和国海关对进出境快件监管办法》中的应予征税的进境货样，广告品，并就申报的真实行和合法性向你关负法律责任。")) ? "" : __t) + '</td></tr><tr><td colspan="5" class="text-left">\x3c!-- ' + (null == (__t = _l("运营人报关专用章", "(运营人报关专用章)报关员")) ? "" : __t) + ':--\x3e</td><td colspan="4" class="text-left">' + (null == (__t = _l("申报日期")) ? "" : __t) + ": " + (null == (__t = result.taxDate) ? "" : __t) + '</td></tr>\x3c!--<tr><td colspan="9">' + (null == (__t = _l("以下由海关填写")) ? "" : __t) + '</td></tr><tr><td colspan="3" class="text-left no-bottom-border no-top-border no-right-border no-bottom-border">' + (null == (__t = _l("海关签章")) ? "" : __t) + ':</td><td colspan="3" class="text-left no-right-border no-left-border">' + (null == (__t = _l("经办关员")) ? "" : __t) + ':</td><td colspan="3" class="text-left no-right-border no-left-border">' + (null == (__t = _l("日期")) ? "" : __t) + ':</td><td colspan="3" class="text-left no-right-border no-left-border">' + (null == (__t = _l("查验关员")) ? "" : __t) + ':</td><td colspan="3" class="text-left no-left-border ">' + (null == (__t = _l("日期")) ? "" : __t) + ':</td></tr>--\x3e</table><div class="remark"><div class="inline-block">' + (null == (__t = _l("备注")) ? "" : __t) + ':</div><div>\x3c!--class="inline-table"--\x3e<div>' + (null == (__t = _l("备注1", "1.总税=关税税额 + 增值税税额 + 消费税税额")) ? "" : __t) + "</div><div>" + (null == (__t = _l("备注2", "2.税金合计栏四舍五入保留整数")) ? "" : __t) + "</div><div>" + (null == (__t = _l("备注3", "3.根据海关相关规定要求征收进出口货物税费，此为海关电子审单放行回执，仅供企业对账之用")) ? "" : __t) + '</div></div><div class="row"><div class="verification-code"><div class="input-group col-xs-offset-2 col-xs-3"><input type="text" id="validation-download-code" class="form-control no-right-border" placeholder="请输入验证码下载文件"><span class="input-group-addon refresh no-left-border" id="refresh-download-code"><span class="sfi sfi-refresh"></span></span></div><div class="col-xs-2 no-left-padding"><img class="validation-image" id="validation-download-image"></div><div class="col-xs-2"><button class="primary-button download disabled fileDownloadPromise">' + (null == (__t = _l("下载")) ? "" : __t) + "</button></div></div></div>"; return __p }, this.JST.taxPersonDetail = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="sfi sfi-times close"></div><h2>中华人民共和国\x3c!--<span style="color:black;text-decoration:underline;padding:0 5px;">&nbsp;&nbsp;' + (null == (__t = result.deptCode) ? "" : __t) + '&nbsp;&nbsp;--\x3e</span>海关</h2><h2>旅客行李、个人邮递物品进口税款电子回执</h2><h3>(仅供对账之用)</h3><h4>&nbsp;</h4><div style="padding:5px 10px;overflow:hidden"><div style="float:left;">纳税人姓名（地址）：<span style="color:black;">' + (null == (__t = result.details[0].sfpname) ? "" : __t) + '</span></div><div style="float:right;width:200px;display:inline-block;text-align:right;">日期：<span>' + (null == (__t = result.taxDate) ? "" : __t) + '</span></div></div><table class="table"><tbody><tr><th>序号</th><th>分运单号码</th><th>货物名称</th><th>完税价格</th><th>税 率%</th><th>关税税额(CNY)</th></tr>', _.forEach(result.details, function (e, t) { __p += "<tr><td>" + (null == (__t = t + 1) ? "" : __t) + "</td><td>" + (null == (__t = e.bno) ? "" : __t) + "</td><td>" + (null == (__t = e.gdesc) ? "" : __t) + "(" + (null == (__t = e.hscode) ? "" : __t) + ")</td><td>" + (null == (__t = e.value) ? "" : __t) + "</td><td>" + (null == (__t = e.traiff) ? "" : __t) + "</td><td>" + (null == (__t = e.totalval) ? "" : __t) + "</td></tr>" }), __p += '<tr><td colspan="6" class="text-left">进口税金合计：人民币（大写）  <span>' + (null == (__t = result.totalTax) ? "" : __t) + '</span>\t</td></tr></tbody></table><div class="remark"><div>说明:</div><div><ul><li>1.税金计算公式：关税税额=完税价格*税率（“完税价格”为海关认定价格，会出现“完税价格≠申报价值”的情况）</li>\x3c!-- <li>2.此为运单号  <span style="text-decoration:underline;">' + (null == (__t = result.waybillNO) ? "" : __t) + '</span>  快件海关进口税款电子回执，仅供参考。如需海关开具的正式《个人邮递物品进口税款缴纳证》，请在快件签收之日起7天内致电顺丰速运客户服务热线：95338</li>--\x3e</ul></div><br/><div>备注:</div><div><ul><li>1.对个人物品税金的计算，海关会根据物品的实际情况对计税价格进行判定，“完税价格”的取值以海关实际计税标准而定</li><li>2.税金合计栏四舍五入保留整数</li><li>3.此为海关电子审单放行回执，仅供对账之用</li></ul></div></div><div class="row"><div class="verification-code"><div class="input-group col-xs-offset-2 col-xs-3"><input type="text" id="validation-download-code" class="form-control no-right-border" placeholder="请输入验证码下载文件"><span class="input-group-addon refresh no-left-border" id="refresh-download-code"><span class="sfi sfi-refresh"></span></span></div><div class="col-xs-2 no-left-padding"><img class="validation-image" id="validation-download-image" src="/sf-service-web/service/captcha/kj3tax?force=true&amp;time=1407399546971"></div><div class="col-xs-2"><button class="primary-button download disabled fileDownloadPromise">下载</button></div></div></div>'; return __p }, this.JST.trackResult = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) 0 != results.length ? (__p += '<table class="table table-bordered"><thead><tr><th>' + (null == (__t = _l("运单号")) ? "" : __t) + "</th><th>" + (null == (__t = _l("帐户号码")) ? "" : __t) + "</th><th>" + (null == (__t = _l("收件人公司名")) ? "" : __t) + "</th></tr></thead><tbody>", _.each(results, function (e, t) { __p += '<td><a style="color:red;text-decoration:underline;" target= _blank href="' + (null == (__t = patch + e.get("waybillNo")) ? "" : __t) + '">  <font color="red">' + (null == (__t = e.get("waybillNo")) ? "" : __t) + "</font> </a></td>\x3c!--运单号--\x3e<td>" + (null == (__t = e.get("customerCode")) ? "" : __t) + "</td>\x3c!--帐户号码--\x3e<td>" + (null == (__t = e.get("addresseeComp")) ? "" : __t) + "</td>\x3c!--收件人公司名 --\x3e</tr>" }), __p += "</tbody></table>") : __p += '<p class="text-center">' + (null == (__t = _l("很抱歉，暂未查询到与您提供的信息相匹配的运单号码")) ? "" : __t) + (null == (__t = _l("如需要获得更多的信息，请致电客户服务热线 080 393 1111。")) ? "" : __t) + "</p>"; return __p }, this.JST.query_detail_appoint_closed = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="delivery-item closed-item">\x3c!-- 地图 --\x3e<div class="delivery-map" id="map1"></div>\x3c!-- 快递简介 --\x3e<div class="delivery-brief"><div class="brief-content clearfix"><div class="wrapper_left"><div class="bill-num"><span class="gray">' + __e(_l("运单号")) + ' </span><span class="number">' + __e(_l("无")) + '</span></div><div class="locations">' + __e(originOld) + '<i class="aicon-arrow-right"></i>' + __e(destinationOld) + '</div></div><div class="fr" style="text-align:right;"><div class="cancel-time">' + __e(modifyDate) + " " + __e(modifyTime) + "<span>" + __e(_l(statusText.substring(1))) + '</span></div><span class="express-state">' + (null == (__t = _l(statusText)) ? "" : __t) + '</span></div></div></div>\x3c!-- 快递附加信息 --\x3e<div class="delivery-addition"><ul class="show-bill-detail"></ul></div>\x3c!-- 操作按钮 --\x3e<div class="delivery-btn-wrap"><a href="javascript:void(0)" onclick="jumpOrder()" class="primary-btn big">' + __e(_l("重新下单")) + '</a></div>\x3c!-- 地图标注信息 --\x3e<div class="delivery-map-hide hide"><div class="map-win-info"><div><span class="cancel-txt">' + __e(_l(statusText)) + "</span></div></div></div></div>"; return __p }, this.JST.query_detail_appoint_normal = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="delivery-item normal-appoint-item">\x3c!-- 地图 --\x3e<div class="delivery-map" id="map1"></div>\x3c!-- 快递简介 --\x3e<div class="delivery-brief"><div class="brief-content clearfix"><div class="wrapper_left"><div class="locations">' + __e(originOld) + '<i class="aicon-arrow-right"></i>' + __e(destinationOld) + '</div></div><div class="fr" style="text-align:right;"><p class="gray">' + __e(_l("预约号")) + "</p><p>" + __e(appointmentNo) + '</p></div></div></div>\x3c!-- 快递小哥和上门信息 --\x3e<div class="delivery-brother clearfix"><div class="fl"><span class="fl bill-man-head"></span><div class="fl man-info">', resoure.resourceCode ? __p += '<div><span class="man-name">' + __e(resoure.resourceName || _l("顺丰小哥")) + '</span><div class="star"><span class="gray"><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span></span><span class="red' + __e(resoure.resourceName ? "" : " none") + '"><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span><span class="aicon-star"></span></span><span class="number">4.8</span></div></div><div><span>' + __e(_l("联系电话")) + " </span><span>" + __e(resoure.telphone || "") + "</span></div>" : __p += '<div class="not-assign">' + __e(_l("分配小哥中")) + "</div>", __p += '</div></div><div class="fr clearfix" style="margin-top:5px; text-align: right;"><div><span class="gray">' + __e(_l("预计上门时间")) + "</span></div><div>" + __e(date) + '<span class="delivery-time">' + __e(time) + '</span></div></div></div>\x3c!-- 快递附加信息 --\x3e<div class="delivery-addition"><ul class="show-bill-detail"></ul></div>\x3c!-- 操作按钮 --\x3e<div class="delivery-btn-wrap">', canCancel && (__p += '<button class="primary-btn big white cancel-btn maidian" data-id="115007" data-name="取消预约">' + __e(_l("取消寄件")) + "</button>"), canPerfect && (__p += '<button class="primary-btn big modify-btn" style="margin-left:30px;">' + __e(_l("完善快件信息")) + "</button>"), __p += '</div>\x3c!-- 地图标注信息 --\x3e<div class="delivery-map-hide hide"><div class="map-win-info"><div class="line1">' + __e(_l("预约成功")) + '</div><div class="line2"><span>' + __e(_l("等待上门")) + "</span><i></i></div></div></div></div>"; return __p }, this.JST.query_detail_appoint_scan = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) __p += '<div class="delivery-item scan-appoint-item">\x3c!-- 地图 --\x3e<div class="delivery-map" id="map1"></div>\x3c!-- 快递简介 --\x3e<div class="delivery-brief"><div class="brief-content clearfix"><div class="wrapper_left"><div class="bill-num"><span class="gray">' + __e(_l("运单号")) + ' </span><span class="number">' + __e(waybillNo) + '</span></div><div class="locations">' + __e(originOld) + '<i class="aicon-arrow-right"></i>' + __e(destinationOld) + '</div></div><div class="fr" style="text-align:right;"><span class="express-state">' + (null == (__t = _l("待寄出")) ? "" : __t) + '</span></div></div></div>\x3c!-- 快递附加信息 --\x3e<div class="delivery-addition"><div class="scan-bill-tip">' + __e(_l("温馨提示：请把“顺丰联”粘贴在包裹上，并交由快递员揽收")) + '</div><ul class="show-bill-detail"></ul></div>\x3c!-- 操作按钮 --\x3e<div class="delivery-btn-wrap">', canCancel && (__p += '<button class="primary-btn big white cancel-btn">' + __e(_l("取消寄件")) + "</button>"), canPerfect && (__p += '<button class="primary-btn big modify-btn" style="margin-left:30px;">' + __e(_l("完善快件信息")) + "</button>"), __p += '</div>\x3c!-- 地图标注信息 --\x3e<div class="delivery-map-hide hide"><div class="map-win-info"><div><span class="scan-txt">' + __e(_l("待寄出")) + "</span></div></div></div></div>"; return __p }, this.JST.query_exception = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) "noAppointmentInfo" === type ? __p += '<div class="no-appointment-info"><div class="error-info"><div class="error-bg"></div><div class="error-txt">' + __e(_l("网络异常，请稍后再试")) + '</div><a class="reload-btn">' + __e(_l("重试")) + "</a></div></div>" : (type = "noLogin") && (__p += '\x3c!--<div class="no-login"><button class="primary-btn big login-btn">' + __e(_l("登录")) + "</button> </div>--\x3e"); return __p }, this.JST.query_list_batch = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) list && list.length ? _.each(list, function (e) { __p += '<li class="item clearfix" data-primaryNo="' + (null == (__t = e.primaryNo) ? "" : __t) + '"><div class="col-1"><div class="bill-no"><span class="order-no">' + (null == (__t = _l("订单号")) ? "" : __t) + "</span><span>" + (null == (__t = e.primaryNo) ? "" : __t) + '</span></div><div class="address" title="' + __e(e.sourceCityName) + '">' + (null == (__t = e.sourceCityName) ? "" : __t) + '<i class="aicon-arrow-right"></i></div><div class="user" title="' + __e(e.appointmentName) + '">' + (null == (__t = e.appointmentName) ? "" : __t) + '</div><div class="bill-status"></div></div><div class="col-2"><div class="bill-time">', e.appointmentTime && (__p += '<span class="order-time">' + (null == (__t = _l("下单时间")) ? "" : __t) + "</span><span>" + (null == (__t = moment(e.appointmentTime).format("YYYY-MM-DD HH:mm")) ? "" : __t) + "</span>"), __p += '<div class="address">' + (null == (__t = _l("多个收件地")) ? "" : __t) + '</div></div><div class="childs">' + __e(_l("共${childs}票快件")._p({ childs: e.childs })) + '</div></div><div class="col-3"><div class="bill-btn-wrap"><span class="btn-tip bill-btn download digital-img aicon-qrcode" data-primaryNo="' + (null == (__t = e.primaryNo) ? "" : __t) + '" data-tip="查看电子运单" ></span></div></div></li><li class="batch-child"><div class="resource-info-' + (null == (__t = e.primaryNo) ? "" : __t) + ' child-list-head clearfix"></div><div class="child-list-' + (null == (__t = e.primaryNo) ? "" : __t) + ' child-list-content" ></div><div class="child-up"></div></li>' }) : __p += '<li class="empty-list-wrap"><div class="empty-img"></div><div class="empty-info">' + (null == (__t = _l("暂无运单信息")) ? "" : __t) + '</div><a class="empty-btn accessible-click maidian" data-md-name="马上下单" data-md-id="115006" onclick="jumpOrder()">' + (null == (__t = _l("马上下单")) ? "" : __t) + "</a></li>"; return __p }, this.JST.query_list_simple = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) list && list.length ? (__p += '<ul class="list-wrap">', _.each(list, function (e) { __p += '<li class="item clearfix canSelect ' + (null == (__t = null != e.status ? "appointBill" : "waybill") ? "" : __t) + '"data-id="' + (null == (__t = e.waybillno) ? "" : __t) + '" data-pickup-type="' + (null == (__t = e.pickupType) ? "" : __t) + '" data-appointmentno="' + (null == (__t = e.appointmentNo) ? "" : __t) + '" data-bill-type="' + (null == (__t = e.billType) ? "" : __t) + '"data-appointment-statue="' + __e(e.appointmentStatue) + '" data-status="' + __e(e.waybillStatus) + '" data-end-time="' + __e(e.time) + '"data-emp-code="' + __e(e.empCode) + '" data-rec-emp-code="' + __e(e.recEmpCode) + '" data-send-evaluate="' + __e(e.sendEvaluate) + '"data-rec-evaluate="' + __e(e.recEvaluate) + '"><div class="col-1"><div class="bill-no">' + (null == (__t = _l("运单号")) ? "" : __t) + "：" + (null == (__t = e.billNum) ? "" : __t) + '</div><div class="address" title="' + __e(e.originateCityName || _l("寄")) + '">' + (null == (__t = e.originateCityName || _l("寄")) ? "" : __t) + '</div><div class="user" title="' + __e(e.originateContacts) + '">' + (null == (__t = e.originateContacts) ? "" : __t) + '</div><div class="bill-status"><div><i class="progress ' + (null == (__t = e.statusIcon) ? "" : __t) + '"></i></div><div class="status-text">' + (null == (__t = _l(e.statusTxt)) ? "" : __t) + '</div></div></div><div class="col-2"><div class="bill-time">', e.time && e.timeTxt && "3" != e.pickupType && (__p += "\t\x3c!--扫码单不显示时间（预约上门，取消时间）--\x3e" + (null == (__t = _l(e.timeTxt)) ? "" : __t) + "：" + (null == (__t = moment(e.time).format("YYYY-MM-DD HH:mm")) ? "" : __t)), __p += '</div><div class="address" title="' + __e(e.destinationCityName || _l("收")) + '">' + (null == (__t = e.destinationCityName || _l("收")) ? "" : __t) + '</div><div class="user" title="' + __e(e.destinationContacts) + '">' + (null == (__t = e.destinationContacts) ? "" : __t) + '</div></div><div class="col-3 status' + (null == (__t = e.status || e.waybillStatus || "none") ? "" : __t) + '">' + (null == (__t = e.cancel ? '<div class="bill-btn-wrap"><span class="btn-tip bill-btn cancel-img aicon-bs-refused maidian" data-md-name="点击取消预约" data-md-id="115007" data-tip="取消预约"></span></div>' : "") ? "" : __t) + (null == (__t = e.delete ? '<div class="bill-btn-wrap"><span class="btn-tip bill-btn remove-img aicon-bs-delete" data-tip="删除"></span></div>' : "") ? "" : __t) + (null == (__t = e.modify ? '<div class="bill-btn-wrap"><span class="btn-tip bill-btn modify-img aicon-bs-edit" data-tip="完善信息"></span></div>' : "") ? "" : __t) + (null == (__t = e.changeDelivery ? '<div class="bill-btn-wrap"><span class="btn-tip bill-btn changeDelivery-img aicon-change-deliver" data-tip="更改派送"></span></div>' : "") ? "" : __t) + (null == (__t = e.digital ? '<div class="bill-btn-wrap"><span class="btn-tip bill-btn digital-img aicon-qrcode" data-tip="查看电子运单"></span></div>' : "") ? "" : __t) + (null == (__t = e.evaluate ? '<div class="bill-btn-wrap"><span class="btn-tip bill-btn evaluate-img aicon-agree ' + (isSender && "1" == e.sendEvaluate || !isSender && "1" == e.recEvaluate ? "" : "red") + '" data-tip="服务评价"></span></div>' : "") ? "" : __t) + "<div></div></div></li>" }), __p += "</ul>", "batch" !== type && (__p += '<div class="bootstrap-pagination"><ul class="pagination"></ul></div> ')) : (__p += '<ul class="list-wrap"><li class="empty-list-wrap"><div class="empty-img"></div><div class="empty-info">' + (null == (__t = _l("暂无运单信息")) ? "" : __t) + "</div>", "batch" !== type && (__p += '<a class="empty-btn accessible-click maidian" data-md-name="马上下单" data-md-id="115006" onclick="jumpOrder()">' + (null == (__t = _l("马上下单")) ? "" : __t) + "</a>"), __p += "</li></ul>"); return __p }, this.JST.query_list_simple2 = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape, __j = Array.prototype.join; function print() { __p += __j.call(arguments, "") } with (obj) list && list.length ? (__p += '<ul class="list-wrap">', _.each(list, function (e, t) { __p += '<li class="item clearfix" data-index="' + __e(t) + '"><div class="col-1"><div class="bill-no">' + __e(e.no) + '</div><div class="address" title="' + __e(e.origCity) + '">' + __e(e.origCity) + '</div><div class="user" title="' + __e(e.origName) + '">' + __e(e.origName) + '</div><div class="bill-status"><div><i class="progress ' + (null == (__t = e.irate) ? "" : __t) + '"></i></div><div class="status-text">' + (null == (__t = _l(e.text)) ? "" : __t) + '</div></div></div><div class="col-2"><div class="bill-time">' + __e(e.time) + '</div><div class="address" title="' + __e(e.destCity) + '">' + __e(e.destCity) + '</div><div class="user" title="' + __e(e.destName) + '">' + __e(e.destName) + '</div></div><div class="col-3 status' + (null == (__t = e.status || e.waybillStatus || "none") ? "" : __t) + '">', _.each(e.operateArr, function (e) { __p += '<div class="bill-btn-wrap"><span class="btn-tip bill-btn ' + __e(e.className) + '" data-tip="' + __e(e.text) + '"data-operator="' + __e(e.name) + '"', e.maidian && (__p += 'data-md-name="点击' + __e(e.text) + '" data-md-id="' + __e(e.maidian) + '"'), __p += "></span></div>" }), __p += "</div></li>" }), __p += "</ul>", "batch" !== type && (__p += '<div class="bootstrap-pagination"><ul class="pagination"></ul></div> ')) : (__p += '<ul class="list-wrap"><li class="empty-list-wrap"><div class="empty-img"></div><div class="empty-info">' + (null == (__t = _l("暂无运单信息")) ? "" : __t) + "</div>", "batch" !== type && (__p += '<a class="empty-btn accessible-click maidian" data-md-name="马上下单" data-md-id="115006" onclick="jumpOrder()">' + (null == (__t = _l("马上下单")) ? "" : __t) + "</a>"), __p += "</li></ul>"); return __p }, this.JST.query = function (obj) { obj || (obj = {}); var __t, __p = "", __e = _.escape; with (obj) __p += '<div class="shipping-search-detail">\x3c!-- 查询表单 --\x3e<div class="bill-number-wrapper"><div class="input-group"><input type="text" class="form-control tokenfield bill-number-input" placeholder="' + __e(_l("输入运单号进行查询，单次最多查询20条。请以逗号、空格或回车键隔开")) + '"><label class="input-group-addon clear-inputs"><span class="sfi sfi-trash"></span></label><span id="queryBill" type="button" class="primary-button maidian" data-md-name="点击查询" data-md-id="115002" data-loading-text="' + __e(_l("查询中...")) + '">' + __e(_l("查询")) + '</span></div>\x3c!-- 最近查询记录 --\x3e<div class="bill-number-list-content"><ul class="nearly-records clearfix"></ul></div><div><div id="TCaptcha" style="width:310px;height:40px;display: none"  ></div><div class="verification-code"><div class="input-group"><input type="text" class="form-control no-right-border" placeholder="' + __e(_l("请输入验证码")) + '"><span class="input-group-addon refresh no-left-border"><span class="sfi sfi-refresh"></span></span></div><img id="validation-image"><div class="error validation-code-error">' + __e(_l("*验证码有误。")) + '</div></div><div class="error" data-error="bill-number-format">' + __e(_l("*运单号错误或重复。")) + '</div><div class="error" data-error="limit-exceeded">' + __e(_l("*您已输入超过20条运单号，系统将自动截取并显示前20条运单号的追踪信息")) + '</div><div class="error" data-error="server-network">' + __e(_l("服务器暂不可用，请稍后再试")) + '</div></div></div></div>\x3c!-- 中国大陆运单查询 --\x3e<div class="delivery-view">\x3c!-- 我的运单列表 --\x3e<div class="my-bills"><div class="bill-title">' + __e(_l("我的包裹")) + '</div><div class="bill-tab"><span class="send-tab maidian" data-type="send" data-md-name="点击我寄的" data-md-id="115003">' + __e(_l("我寄的")) + '</span><span class="receive-tab maidian" data-type="receive" data-md-name="点击我收的" data-md-id="115004">' + __e(_l("我收的")) + '</span><span class="batch-tab maidian" data-type="batch">' + __e(_l("批量订单")) + '</span></div><div class="no-login-wrap"><div class="no-login-tip"><span>' + __e(_l("暂无运单，登录/注册会员可查询更多运单")) + '</span></div><div class="login-btn maidian" data-md-name="点击登录/注册" data-md-id="115005"><span>' + __e(_l("登录/注册")) + '</span></div></div><div class="bill-list send-list"></div><div class="bill-list receive-list"></div><div class="bill-list batch-list"></div></div>\x3c!-- 运单路由信息 --\x3e<div class="route-result clearfix" style="display:none;"><div class="bill-title"><a href="javascript:void(0)" class="go-to-bill-list"><span class="aicon-to-left"></span>' + __e(_l("返回运单列表")) + '</a><div class="fr openMapModel"><span>' + __e(_l("开启地图模式")) + '</span><input type="checkbox" /></div></div><div class="delivery-wrapper"></div></div></div>'; return __p }, this.JST }), define("bus/query/index", ["const"], function (t) { return { isWaybill: function (e) { return e.waybillno && 2 <= e.waybillStatus }, isIntraCity: function (e) { return !e.waybillno && "18" === e.pickupType }, isAppointment: function (e) { return !this.isWaybill(e) && !this.isIntraCity(e) }, isReceiver: function (e) { return 2 === e || 3 === e }, isSender: function (e) { return 1 === e || 3 === e }, isLogout: function (e) { return 0 === e }, isMyBill: function (e) { return 1 === e || 3 === e || 3 === e }, isNotMyWaybill: function (e) { return 4 === e }, isSecurityExpress: function (e) { return e.pickupType === t.SHUN_XIN_JI || e.waybillType === t.SHUN_XIN_JI }, isAppleWaybill: function (e) { return "960" == e.toString().substr(0, 3) || "SF960" == e.toString().substr(0, 5) }, isHuaweiWaybill: function (e) { return "962" == e.toString().substr(0, 3) || "SF962" == e.toString().substr(0, 5) }, isUntreadBill: function (e) { return -1 < e.indexOf("16") || -1 < e.indexOf("17") } } }), define("bus/address/index", ["const"], function (t) { return { isHK: function (e) { return e == t.RATE_OF_HK }, isMC: function (e) { return e == t.RATE_OF_MACAO }, isTW: function (e) { return e == t.RATE_OF_TW }, isHK_MC: function (e) { return this.isHK(e) || this.isMC(e) }, isHK_MC_TW: function (e) { return this.isHK_MC(e) || this.isTW(e) }, isInternational: function (e) { return new RegExp("[A-Za-z]+").test(e) }, isMainland: function (e) { return !this.isHK_MC_TW(e) && !this.isInternational(e) }, isDirectCity: function (t) { return null != _.find(["010", "021", "022", "023"], function (e) { return e == t }) }, isInArea: function (e, t) { for (var i, n = { ML: this.isMainland, HK: this.isHK, MC: this.isMC, TW: this.isTW }, a = 0, s = e.split("_"); a < s.length; a++)if ((i = n[s[a]]) && i.call(this, t)) return !0 }, getAddressCode: function (e) { return this.isHK_MC_TW(e.locationCode) ? e.cityCode : e.countyCode } } }), define("bus/order/index", ["helper", "../address/index"], function (e, t) { var i, n, a = e.getSiteLanguage(); return { setSLocationCode: function (e) { i = e }, setRLocationCode: function (e) { n = e }, getSLocationCode: function () { return i }, getRLocationCode: function () { return n }, hasCargoInsure: function () { return !t.isMC(i) }, hasCargoService: function () { return t.isMainland(i) && t.isMainland(n) || t.isHK(i) && !t.isTW(n) || t.isTW(i) && t.isTW(n) }, hasSignedBack: function () { return !(t.isHK(i) && !t.isHK(n) || t.isTW(i) && t.isTW(n)) }, hasCod: function () { return !t.isHK(i) || !t.isTW(n) }, getRevealCurrency: function () { return t.isMainland(i) ? "en" === a ? "RMB" : "元" : e.getCurrencyByCode(i) }, hasCargoMsg: function (e) { return t.isMainland(i) || t.isMC(i) ? 3 != e : !!t.isHK(i) || (!!t.isTW(i) || void 0) }, batchHasCargoMsg: function () { return t.isHK(i) }, hasPickTypeToggle: function () { return t.isMainland(i) && t.isMainland(n) || t.isHK(i) || t.isMC(i) }, getPickType: function (e) { return e ? 2 : t.isHK(i) || t.isMC(i) ? null : 1 } } }), define("bus/index", ["./query/index", "./address/index", "./order/index"], function (e, t, i) { return _.extend({ query: e, address: t, order: i }, e, t, i) }), define("views/pages/order/cn/orderCommon", ["baseView", "helper", "event", "bus/index", "sflayer"], function (e, n, t, a) { return e.extend({ events: { "click #agree-term-content": "agreeTermToggle", "click .term": "showTerm", "click .submit-order": "checkTermToOrder", "click .save-address-check": "toggleSaveAddress" }, senderLocationChange: function (e, t, i, n) { this.senderLocationRateCode = e, this.senderLocationCountyCode = t, this.cityWorkingTime.getServerCurrentTime(), this.cityWorkingTime.getCityWorkingTime({ cityCode: e, address: i, addressType: n }), this.pickupTimePicker.setServerTime(this.cityWorkingTime.get("synServerTim")).setDateTimes(this.cityWorkingTime.get("dateTimes")).render(), this.fetchPriceAndTimes(), this.sender.queryAddressRange(), a.setSLocationCode(e) }, getBookingTime: function () { var e = this.pickupTimePicker.getDateTime(); return e.start ? e.start : this.cityWorkingTime.get("synServerTim").format() }, agreeTermToggle: function (e) { this.$(e.currentTarget).toggleClass("active") }, showTerm: function (t) { $(window).resize(function () { $("iframe").css("height", $(this).height() - 200) }); var e = n.getURLWithContext("other/modal/order_terms.html"), i = this; layer.open({ title: _l("电子运单契约条款"), type: 2, area: ["960px"], offset: "40px", content: [e, "no"], btn: _l("我已阅读该条款，同意遵守"), yes: function (e) { i.$("#agree-term-content").addClass("active"), t || i.validateSender(), layer.close(e) } }), $(window).resize() }, checkTermToOrder: function () { this.$("#agree-term-content").hasClass("active") ? this.validateSender() : this.showTerm() }, toggleSaveAddress: function (e) { this.$(e.currentTarget).toggleClass("checked"), this.$(e.currentTarget).hasClass("checked") ? this.saveAddressBook = !0 : this.saveAddressBook = !1, "hk" === n.getSiteLocation() ? sfgather.trackClicks("点击保存到地址簿单选按钮", "XWF010203") : sfgather.trackClicks("点击保存到地址簿单选按钮", "OWF010203") }, getWarmReminder: function () { var t = this; sfAjax.bpsQueryOrderExceptionInfo({ params: this.getControlUrlParams(), data: this.getControlPostParams(), success: function (e) { t.$(".warm-reminder").hide(), 0 === e.code && e.result && 4 == e.result.controlStrategy && t.receiver.showReminder(e.result.notificationMsg) } }) }, toggleSelfPick: function () { this.receiver.notOutRange ? (this.$(".cargo-self-pick-wrapper").hide(), this.otherBillInfo.selfPick = !1, this.$(".self-pick-show").text(_l("不自取"))) : this.$(".cargo-self-pick-wrapper").show() }, validateSender: function () { this.sender.validateshipper() && (this.sender.notOutRange ? this.validateReceiver() : layer.alert(_l("亲，您的寄件地址我司暂无法上门收件，您可修改为其它地址。"))) }, validateReceiver: function () { this.receiver.validateshipper() && (this.receiver.notOutRange ? this.validateOthers() : this.otherBillInfo.selfPick ? this.validateOthers() : layer.alert(_l("亲，您的收件地址不在我司派送范围内，可选择自取服务"))) }, getControlUrlParams: function () { return { srcCityCode: this.sender.getShipperData().cityCode, destCityCode: this.receiver.getShipperData().cityCode } }, getControlPostParams: function () { var e = this.sender.getShipperData(), t = this.receiver.getShipperData(); return { customerType: 1, customerCode: this.sender.getFormDataObj().contactTel || this.sender.getFormDataObj().contactPhone, channelCode: "PC.OWF", srcZoneCode: e.locationCode, destZoneCode: t.locationCode, srcAddress: n.getFullAddress(e.locationCode, e), destAddress: n.getFullAddress(t.locationCode, t), srcDivisionCode: e.countyCode ? e.countyCode : e.cityCode, destDivisionCode: t.countyCode ? t.countyCode : t.cityCode, productCode: "", limitTypeCode: this.limitTypeCode, cargoTypeCode: this.cargoTypeCode, expressTypeCode: this.expressTypeCode, consignedTm: moment(this.getBookingTime()).format("YYYY-MM-DD HH:mm:ss") } }, resetPeakControlInfo: function () { this.notificationMsg = "", this.controlStrategy = "" }, queryPeakControl: function () { var t = this; if (this.resetPeakControlInfo(), _webConfig.openPeakControl) { var e = layer.load(); sfAjax.queryCustomerControlStrategy({ params: this.getControlUrlParams(), data: this.getControlPostParams(), success: function (e) { if (e && 0 === e.code) if (e.result) switch (t.controlStrategy = e.result.controlStrategy, t.notificationMsg = e.result.notificationMsg || "", t.controlStrategy) { case 0: t.validateLogin(); break; case 1: layer.alert(t.notificationMsg); break; case 2: case 3: case 4: layer.confirm(t.notificationMsg, { btn: [_l("是"), _l("否")] }, function (e) { t.validateLogin(), layer.close(e) }, function (e) { layer.close(e) }); break; default: t.validateLogin() } else t.validateLogin(); else t.validateLogin() }, error: function () { t.validateLogin() }, complete: function () { layer.close(e) } }) } else this.validateLogin() }, validateLogin: function () { $.cookie("loginUser") ? this.submitOrder() : t.trigger(t.Needlogin, { succCallback: this.submitOrder.bind(this), cancelCallback: null }) }, getAjaxFuncData: function () { return { data: this.getSubmitPostData(), success: function (e) { if (e && 0 == e.code) { var t = e.result; this.options.orderSuccess(t, this.waybillNo), this.setAddressToStore(), this.saveToAddressBook() } else this.renderFail(e) }.bind(this), error: function () { layer.msg(_l("网络异常，请重新提交订单")) }, login: { succCallback: this.submitOrder.bind(this), cancelCallback: null }, complete: function () { layer.close(this.submitLoadIndex) }.bind(this) } }, renderFail: function (e) { 1 == e.code ? layer.msg(_l("运单号无效或已使用")) : 654 == e.code ? layer.msg(_l("月结账号无效")) : 651 == e.code ? layer.msg(_l("预约失败：下单时间不在服务时间范围内。")) : 652 == e.code ? layer.msg(_l("暂时不能为您提供收派件的服务，如有疑问请咨询我司热线95338。")) : 653 == e.code ? layer.msg(_l("账号异常！")) : 653 == e.code ? layer.msg(_l("系统繁忙，请重试！")) : layer.msg(_l("预约失败：信息校验不通过，请检查必填项。")) }, getSenderSaveData: function () { return _.extend({ memType: 0, isDefault: 0 }, _.omit(this.sender.getShipperData(), "setMark")) }, setAddressToStore: function () { var e = JSON.stringify(this.getSenderSaveData()); localStorage.setItem(n.getLatestSenderKey() + $.cookie("loginUser"), e) }, saveToAddressBook: function () { var e = []; this.sender.getShipperData().setMark && e.push(this.getSenderSaveData()), this.receiver.getShipperData().setMark && this.saveAddressBook && e.push(_.extend({ memType: 1, isDefault: 0 }, _.omit(this.receiver.getShipperData(), "setMark", "selfPick"))), 0 < e.length && sfAjax.bulkSaveOrUpdateAddress({ data: e }) } }) }), define("verify", [], function () { var t = { tel_cn: /^1\d{10}$/, tel_cn_hmt: /^1\d{10}$|^((\+?00852[-]?)|(\+?852[-]?))?[5689]{1}\d{7}$|^((\+?00853[-]?)|(\+?853[-]?))?6\d{6,7}$|^((\+?886[-]?))?[0]?[9]\d{8}$/, mobile: /^((\d{7,8})|(0\d{2,3})-?(\d{7,8})|(0\d{2,3})-?(\d{7,8})-?(\d{0,7})|(\d{7,8})-?(\d{0,7}))$/, twIdCardNo: /^[a-zA-Z0-9]{10}$/, twComLicenseNo: /^[a-zA-Z0-9]{8}$/, monthlyCardNo: /^\d{10}$/, captcha: /^[A-Za-z0-9]{5}$/, email: /^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/, postcode: /^[0-9]{6}$/, waybillNo: /^[0-9]{12}$|^sf[0-9]{13}$/i }; return { reg: t, isTelCn: function (e) { return t.tel_cn.test(e) }, isTelCnHmt: function (e) { return t.tel_cn_hmt.test(e) }, isMobile: function (e) { return t.mobile.test(e) }, isTwIdCardNo: function (e) { return t.twIdCardNo.test(e) }, isTwComLicenseNo: function (e) { return t.twComLicenseNo.test(e) }, isMonthlyCardNo: function (e) { return t.monthlyCardNo.test(e) }, isCaptcha: function (e) { return t.captcha.test(e) }, isEmail: function (e) { return t.email.test(e) }, isPostcode: function (e) { return t.postcode.test(e) }, isWaybillNo: function (e) { return t.waybillNo.test(e) }, isRegularExtension: function (e, t) { var i = "\\.(" + e.join("|") + ")$"; return new RegExp(i, "i").test(t) } } }), function (e) { "function" == typeof define && define.amd ? define("jquery-validate", ["jquery"], e) : "object" == typeof module && module.exports ? module.exports = e(require("jquery")) : e(jQuery) }(function (d) { d.extend(d.fn, { validate: function (e) { if (this.length) { var n = d.data(this[0], "validator"); return n || (this.attr("novalidate", "novalidate"), n = new d.validator(e, this[0]), d.data(this[0], "validator", n), n.settings.onsubmit && (this.on("click.validate", ":submit", function (e) { n.submitButton = e.currentTarget, d(this).hasClass("cancel") && (n.cancelSubmit = !0), void 0 !== d(this).attr("formnovalidate") && (n.cancelSubmit = !0) }), this.on("submit.validate", function (i) { function e() { var e, t; return n.submitButton && (n.settings.submitHandler || n.formSubmitted) && (e = d("<input type='hidden'/>").attr("name", n.submitButton.name).val(d(n.submitButton).val()).appendTo(n.currentForm)), !n.settings.submitHandler || (t = n.settings.submitHandler.call(n, n.currentForm, i), e && e.remove(), void 0 !== t && t) } return n.settings.debug && i.preventDefault(), n.cancelSubmit ? (n.cancelSubmit = !1, e()) : n.form() ? n.pendingRequest ? !(n.formSubmitted = !0) : e() : (n.focusInvalid(), !1) })), n) } e && e.debug && window.console }, valid: function () { var e, t, i; return d(this[0]).is("form") ? e = this.validate().form() : (i = [], e = !0, t = d(this[0].form).validate(), this.each(function () { (e = t.element(this) && e) || (i = i.concat(t.errorList)) }), t.errorList = i), e }, rules: function (e, t) { var i, n, a, s, r, o, l = this[0]; if (null != l && (!l.form && l.hasAttribute("contenteditable") && (l.form = this.closest("form")[0], l.name = this.attr("name")), null != l.form)) { if (e) switch (n = (i = d.data(l.form, "validator").settings).rules, a = d.validator.staticRules(l), e) { case "add": d.extend(a, d.validator.normalizeRule(t)), delete a.messages, n[l.name] = a, t.messages && (i.messages[l.name] = d.extend(i.messages[l.name], t.messages)); break; case "remove": return t ? (o = {}, d.each(t.split(/\s/), function (e, t) { o[t] = a[t], delete a[t] }), o) : (delete n[l.name], a) }return (s = d.validator.normalizeRules(d.extend({}, d.validator.classRules(l), d.validator.attributeRules(l), d.validator.dataRules(l), d.validator.staticRules(l)), l)).required && (r = s.required, delete s.required, s = d.extend({ required: r }, s)), s.remote && (r = s.remote, delete s.remote, s = d.extend(s, { remote: r })), s } } }), d.extend(d.expr.pseudos || d.expr[":"], { blank: function (e) { return !d.trim("" + d(e).val()) }, filled: function (e) { var t = d(e).val(); return null !== t && !!d.trim("" + t) }, unchecked: function (e) { return !d(e).prop("checked") } }), d.validator = function (e, t) { this.settings = d.extend(!0, {}, d.validator.defaults, e), this.currentForm = t, this.init() }, d.validator.format = function (i, e) { return 1 === arguments.length ? function () { var e = d.makeArray(arguments); return e.unshift(i), d.validator.format.apply(this, e) } : (void 0 === e || (2 < arguments.length && e.constructor !== Array && (e = d.makeArray(arguments).slice(1)), e.constructor !== Array && (e = [e]), d.each(e, function (e, t) { i = i.replace(new RegExp("\\{" + e + "\\}", "g"), function () { return t }) })), i) }, d.extend(d.validator, { defaults: { messages: {}, groups: {}, rules: {}, errorClass: "error", pendingClass: "pending", validClass: "valid", errorElement: "label", focusCleanup: !1, focusInvalid: !0, errorContainer: d([]), errorLabelContainer: d([]), onsubmit: !0, ignore: ":hidden", ignoreTitle: !1, onfocusin: function (e) { this.lastActive = e, this.settings.focusCleanup && (this.settings.unhighlight && this.settings.unhighlight.call(this, e, this.settings.errorClass, this.settings.validClass), this.hideThese(this.errorsFor(e))) }, onfocusout: function (e) { this.checkable(e) || !(e.name in this.submitted) && this.optional(e) || this.element(e) }, onkeyup: function (e, t) { 9 === t.which && "" === this.elementValue(e) || -1 !== d.inArray(t.keyCode, [16, 17, 18, 20, 35, 36, 37, 38, 39, 40, 45, 144, 225]) || (e.name in this.submitted || e.name in this.invalid) && this.element(e) }, onclick: function (e) { e.name in this.submitted ? this.element(e) : e.parentNode.name in this.submitted && this.element(e.parentNode) }, highlight: function (e, t, i) { "radio" === e.type ? this.findByName(e.name).addClass(t).removeClass(i) : d(e).addClass(t).removeClass(i) }, unhighlight: function (e, t, i) { "radio" === e.type ? this.findByName(e.name).removeClass(t).addClass(i) : d(e).removeClass(t).addClass(i) } }, setDefaults: function (e) { d.extend(d.validator.defaults, e) }, messages: { required: "This field is required.", remote: "Please fix this field.", email: "Please enter a valid email address.", url: "Please enter a valid URL.", date: "Please enter a valid date.", dateISO: "Please enter a valid date (ISO).", number: "Please enter a valid number.", digits: "Please enter only digits.", equalTo: "Please enter the same value again.", maxlength: d.validator.format("Please enter no more than {0} characters."), minlength: d.validator.format("Please enter at least {0} characters."), rangelength: d.validator.format("Please enter a value between {0} and {1} characters long."), range: d.validator.format("Please enter a value between {0} and {1}."), max: d.validator.format("Please enter a value less than or equal to {0}."), min: d.validator.format("Please enter a value greater than or equal to {0}."), step: d.validator.format("Please enter a multiple of {0}.") }, autoCreateRanges: !1, prototype: { init: function () { this.labelContainer = d(this.settings.errorLabelContainer), this.errorContext = this.labelContainer.length && this.labelContainer || d(this.currentForm), this.containers = d(this.settings.errorContainer).add(this.settings.errorLabelContainer), this.submitted = {}, this.valueCache = {}, this.pendingRequest = 0, this.pending = {}, this.invalid = {}, this.reset(); var i, n = this.groups = {}; function e(e) { !this.form && this.hasAttribute("contenteditable") && (this.form = d(this).closest("form")[0], this.name = d(this).attr("name")); var t = d.data(this.form, "validator"), i = "on" + e.type.replace(/^validate/, ""), n = t.settings; n[i] && !d(this).is(n.ignore) && n[i].call(t, this, e) } d.each(this.settings.groups, function (i, e) { "string" == typeof e && (e = e.split(/\s/)), d.each(e, function (e, t) { n[t] = i }) }), i = this.settings.rules, d.each(i, function (e, t) { i[e] = d.validator.normalizeRule(t) }), d(this.currentForm).on("focusin.validate focusout.validate keyup.validate", ":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'], [type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'], [type='radio'], [type='checkbox'], [contenteditable], [type='button']", e).on("click.validate", "select, option, [type='radio'], [type='checkbox']", e), this.settings.invalidHandler && d(this.currentForm).on("invalid-form.validate", this.settings.invalidHandler) }, form: function () { return this.checkForm(), d.extend(this.submitted, this.errorMap), this.invalid = d.extend({}, this.errorMap), this.valid() || d(this.currentForm).triggerHandler("invalid-form", [this]), this.showErrors(), this.valid() }, checkForm: function () { this.prepareForm(); for (var e = 0, t = this.currentElements = this.elements(); t[e]; e++)this.check(t[e]); return this.valid() }, element: function (e) { var t, i, n = this.clean(e), a = this.validationTargetFor(n), s = this, r = !0; return void 0 === a ? delete this.invalid[n.name] : (this.prepareElement(a), this.currentElements = d(a), (i = this.groups[a.name]) && d.each(this.groups, function (e, t) { t === i && e !== a.name && (n = s.validationTargetFor(s.clean(s.findByName(e)))) && n.name in s.invalid && (s.currentElements.push(n), r = s.check(n) && r) }), t = !1 !== this.check(a), r = r && t, this.invalid[a.name] = !t, this.numberOfInvalids() || (this.toHide = this.toHide.add(this.containers)), this.showErrors(), d(e).attr("aria-invalid", !t)), r }, showErrors: function (t) { if (t) { var i = this; d.extend(this.errorMap, t), this.errorList = d.map(this.errorMap, function (e, t) { return { message: e, element: i.findByName(t)[0] } }), this.successList = d.grep(this.successList, function (e) { return !(e.name in t) }) } this.settings.showErrors ? this.settings.showErrors.call(this, this.errorMap, this.errorList) : this.defaultShowErrors() }, resetForm: function () { d.fn.resetForm && d(this.currentForm).resetForm(), this.invalid = {}, this.submitted = {}, this.prepareForm(), this.hideErrors(); var e = this.elements().removeData("previousValue").removeAttr("aria-invalid"); this.resetElements(e) }, resetElements: function (e) { var t; if (this.settings.unhighlight) for (t = 0; e[t]; t++)this.settings.unhighlight.call(this, e[t], this.settings.errorClass, ""), this.findByName(e[t].name).removeClass(this.settings.validClass); else e.removeClass(this.settings.errorClass).removeClass(this.settings.validClass) }, numberOfInvalids: function () { return this.objectLength(this.invalid) }, objectLength: function (e) { var t, i = 0; for (t in e) void 0 !== e[t] && null !== e[t] && !1 !== e[t] && i++; return i }, hideErrors: function () { this.hideThese(this.toHide) }, hideThese: function (e) { e.not(this.containers).text(""), this.addWrapper(e).hide() }, valid: function () { return 0 === this.size() }, size: function () { return this.errorList.length }, focusInvalid: function () { if (this.settings.focusInvalid) try { d(this.findLastActive() || this.errorList.length && this.errorList[0].element || []).filter(":visible").focus().trigger("focusin") } catch (e) { } }, findLastActive: function () { var t = this.lastActive; return t && 1 === d.grep(this.errorList, function (e) { return e.element.name === t.name }).length && t }, elements: function () { var t = this, i = {}; return d(this.currentForm).find("input, select, textarea, [contenteditable]").not(":submit, :reset, :image, :disabled").not(this.settings.ignore).filter(function () { var e = this.name || d(this).attr("name"); return !e && t.settings.debug && window.console, this.hasAttribute("contenteditable") && (this.form = d(this).closest("form")[0], this.name = e), !(e in i || !t.objectLength(d(this).rules())) && (i[e] = !0) }) }, clean: function (e) { return d(e)[0] }, errors: function () { var e = this.settings.errorClass.split(" ").join("."); return d(this.settings.errorElement + "." + e, this.errorContext) }, resetInternals: function () { this.successList = [], this.errorList = [], this.errorMap = {}, this.toShow = d([]), this.toHide = d([]) }, reset: function () { this.resetInternals(), this.currentElements = d([]) }, prepareForm: function () { this.reset(), this.toHide = this.errors().add(this.containers) }, prepareElement: function (e) { this.reset(), this.toHide = this.errorsFor(e) }, elementValue: function (e) { var t, i, n = d(e), a = e.type; return "radio" === a || "checkbox" === a ? this.findByName(e.name).filter(":checked").val() : "number" === a && void 0 !== e.validity ? e.validity.badInput ? "NaN" : n.val() : (t = e.hasAttribute("contenteditable") ? n.text() : n.val(), "file" === a ? "C:\\fakepath\\" === t.substr(0, 12) ? t.substr(12) : 0 <= (i = t.lastIndexOf("/")) ? t.substr(i + 1) : 0 <= (i = t.lastIndexOf("\\")) ? t.substr(i + 1) : t : "string" == typeof t ? t.replace(/\r/g, "") : t) }, check: function (t) { t = this.validationTargetFor(this.clean(t)); var e, i, n, a, s = d(t).rules(), r = d.map(s, function (e, t) { return t }).length, o = !1, l = this.elementValue(t); if ("function" == typeof s.normalizer ? a = s.normalizer : "function" == typeof this.settings.normalizer && (a = this.settings.normalizer), a) { if ("string" != typeof (l = a.call(t, l))) throw new TypeError("The normalizer should return a string value."); delete s.normalizer } for (i in s) { n = { method: i, parameters: s[i] }; try { if ("dependency-mismatch" === (e = d.validator.methods[i].call(this, l, t, n.parameters)) && 1 === r) { o = !0; continue } if (o = !1, "pending" === e) return void (this.toHide = this.toHide.not(this.errorsFor(t))); if (!e) return this.formatAndAdd(t, n), !1 } catch (e) { throw this.settings.debug && window.console, e instanceof TypeError && (e.message += ".  Exception occurred when checking element " + t.id + ", check the '" + n.method + "' method."), e } } if (!o) return this.objectLength(s) && this.successList.push(t), !0 }, customDataMessage: function (e, t) { return d(e).data("msg" + t.charAt(0).toUpperCase() + t.substring(1).toLowerCase()) || d(e).data("msg") }, customMessage: function (e, t) { var i = this.settings.messages[e]; return i && (i.constructor === String ? i : i[t]) }, findDefined: function () { for (var e = 0; e < arguments.length; e++)if (void 0 !== arguments[e]) return arguments[e] }, defaultMessage: function (e, t) { "string" == typeof t && (t = { method: t }); var i = this.findDefined(this.customMessage(e.name, t.method), this.customDataMessage(e, t.method), !this.settings.ignoreTitle && e.title || void 0, d.validator.messages[t.method], "<strong>Warning: No message defined for " + e.name + "</strong>"), n = /\$?\{(\d+)\}/g; return "function" == typeof i ? i = i.call(this, t.parameters, e) : n.test(i) && (i = d.validator.format(i.replace(n, "{$1}"), t.parameters)), i }, formatAndAdd: function (e, t) { var i = this.defaultMessage(e, t); this.errorList.push({ message: i, element: e, method: t.method }), this.errorMap[e.name] = i, this.submitted[e.name] = i }, addWrapper: function (e) { return this.settings.wrapper && (e = e.add(e.parent(this.settings.wrapper))), e }, defaultShowErrors: function () { var e, t, i; for (e = 0; this.errorList[e]; e++)i = this.errorList[e], this.settings.highlight && this.settings.highlight.call(this, i.element, this.settings.errorClass, this.settings.validClass), this.showLabel(i.element, i.message); if (this.errorList.length && (this.toShow = this.toShow.add(this.containers)), this.settings.success) for (e = 0; this.successList[e]; e++)this.showLabel(this.successList[e]); if (this.settings.unhighlight) for (e = 0, t = this.validElements(); t[e]; e++)this.settings.unhighlight.call(this, t[e], this.settings.errorClass, this.settings.validClass); this.toHide = this.toHide.not(this.toShow), this.hideErrors(), this.addWrapper(this.toShow).show() }, validElements: function () { return this.currentElements.not(this.invalidElements()) }, invalidElements: function () { return d(this.errorList).map(function () { return this.element }) }, showLabel: function (e, t) { var i, n, a, s, r = this.errorsFor(e), o = this.idOrName(e), l = d(e).attr("aria-describedby"); r.length ? (r.removeClass(this.settings.validClass).addClass(this.settings.errorClass), r.html(t)) : (i = r = d("<" + this.settings.errorElement + ">").attr("id", o + "-error").addClass(this.settings.errorClass).html(t || ""), this.settings.wrapper && (i = r.hide().show().wrap("<" + this.settings.wrapper + "/>").parent()), this.labelContainer.length ? this.labelContainer.append(i) : this.settings.errorPlacement ? this.settings.errorPlacement.call(this, i, d(e)) : i.insertAfter(e), r.is("label") ? r.attr("for", o) : 0 === r.parents("label[for='" + this.escapeCssMeta(o) + "']").length && (a = r.attr("id"), l ? l.match(new RegExp("\\b" + this.escapeCssMeta(a) + "\\b")) || (l += " " + a) : l = a, d(e).attr("aria-describedby", l), (n = this.groups[e.name]) && (s = this, d.each(s.groups, function (e, t) { t === n && d("[name='" + s.escapeCssMeta(e) + "']", s.currentForm).attr("aria-describedby", r.attr("id")) })))), !t && this.settings.success && (r.text(""), "string" == typeof this.settings.success ? r.addClass(this.settings.success) : this.settings.success(r, e)), this.toShow = this.toShow.add(r) }, errorsFor: function (e) { var t = this.escapeCssMeta(this.idOrName(e)), i = d(e).attr("aria-describedby"), n = "label[for='" + t + "'], label[for='" + t + "'] *"; return i && (n = n + ", #" + this.escapeCssMeta(i).replace(/\s+/g, ", #")), this.errors().filter(n) }, escapeCssMeta: function (e) { return e.replace(/([\\!"#$%&'()*+,./:;<=>?@\[\]^`{|}~])/g, "\\$1") }, idOrName: function (e) { return this.groups[e.name] || (this.checkable(e) ? e.name : e.id || e.name) }, validationTargetFor: function (e) { return this.checkable(e) && (e = this.findByName(e.name)), d(e).not(this.settings.ignore)[0] }, checkable: function (e) { return /radio|checkbox/i.test(e.type) }, findByName: function (e) { return d(this.currentForm).find("[name='" + this.escapeCssMeta(e) + "']") }, getLength: function (e, t) { switch (t.nodeName.toLowerCase()) { case "select": return d("option:selected", t).length; case "input": if (this.checkable(t)) return this.findByName(t.name).filter(":checked").length }return e.length }, depend: function (e, t) { return !this.dependTypes[typeof e] || this.dependTypes[typeof e](e, t) }, dependTypes: { boolean: function (e) { return e }, string: function (e, t) { return !!d(e, t.form).length }, function: function (e, t) { return e(t) } }, optional: function (e) { var t = this.elementValue(e); return !d.validator.methods.required.call(this, t, e) && "dependency-mismatch" }, startRequest: function (e) { this.pending[e.name] || (this.pendingRequest++ , d(e).addClass(this.settings.pendingClass), this.pending[e.name] = !0) }, stopRequest: function (e, t) { this.pendingRequest-- , this.pendingRequest < 0 && (this.pendingRequest = 0), delete this.pending[e.name], d(e).removeClass(this.settings.pendingClass), t && 0 === this.pendingRequest && this.formSubmitted && this.form() ? (d(this.currentForm).submit(), this.submitButton && d("input:hidden[name='" + this.submitButton.name + "']", this.currentForm).remove(), this.formSubmitted = !1) : !t && 0 === this.pendingRequest && this.formSubmitted && (d(this.currentForm).triggerHandler("invalid-form", [this]), this.formSubmitted = !1) }, previousValue: function (e, t) { return t = "string" == typeof t && t || "remote", d.data(e, "previousValue") || d.data(e, "previousValue", { old: null, valid: !0, message: this.defaultMessage(e, { method: t }) }) }, destroy: function () { this.resetForm(), d(this.currentForm).off(".validate").removeData("validator").find(".validate-equalTo-blur").off(".validate-equalTo").removeClass("validate-equalTo-blur") } }, classRuleSettings: { required: { required: !0 }, email: { email: !0 }, url: { url: !0 }, date: { date: !0 }, dateISO: { dateISO: !0 }, number: { number: !0 }, digits: { digits: !0 }, creditcard: { creditcard: !0 } }, addClassRules: function (e, t) { e.constructor === String ? this.classRuleSettings[e] = t : d.extend(this.classRuleSettings, e) }, classRules: function (e) { var t = {}, i = d(e).attr("class"); return i && d.each(i.split(" "), function () { this in d.validator.classRuleSettings && d.extend(t, d.validator.classRuleSettings[this]) }), t }, normalizeAttributeRule: function (e, t, i, n) { /min|max|step/.test(i) && (null === t || /number|range|text/.test(t)) && (n = Number(n), isNaN(n) && (n = void 0)), n || 0 === n ? e[i] = n : t === i && "range" !== t && (e[i] = !0) }, attributeRules: function (e) { var t, i, n = {}, a = d(e), s = e.getAttribute("type"); for (t in d.validator.methods) "required" === t ? ("" === (i = e.getAttribute(t)) && (i = !0), i = !!i) : i = a.attr(t), this.normalizeAttributeRule(n, s, t, i); return n.maxlength && /-1|2147483647|524288/.test(n.maxlength) && delete n.maxlength, n }, dataRules: function (e) { var t, i, n = {}, a = d(e), s = e.getAttribute("type"); for (t in d.validator.methods) i = a.data("rule" + t.charAt(0).toUpperCase() + t.substring(1).toLowerCase()), this.normalizeAttributeRule(n, s, t, i); return n }, staticRules: function (e) { var t = {}, i = d.data(e.form, "validator"); return i.settings.rules && (t = d.validator.normalizeRule(i.settings.rules[e.name]) || {}), t }, normalizeRules: function (n, a) { return d.each(n, function (e, t) { if (!1 !== t) { if (t.param || t.depends) { var i = !0; switch (typeof t.depends) { case "string": i = !!d(t.depends, a.form).length; break; case "function": i = t.depends.call(a, a) }i ? n[e] = void 0 === t.param || t.param : (d.data(a.form, "validator").resetElements(d(a)), delete n[e]) } } else delete n[e] }), d.each(n, function (e, t) { n[e] = d.isFunction(t) && "normalizer" !== e ? t(a) : t }), d.each(["minlength", "maxlength"], function () { n[this] && (n[this] = Number(n[this])) }), d.each(["rangelength", "range"], function () { var e; n[this] && (d.isArray(n[this]) ? n[this] = [Number(n[this][0]), Number(n[this][1])] : "string" == typeof n[this] && (e = n[this].replace(/[\[\]]/g, "").split(/[\s,]+/), n[this] = [Number(e[0]), Number(e[1])])) }), d.validator.autoCreateRanges && (null != n.min && null != n.max && (n.range = [n.min, n.max], delete n.min, delete n.max), null != n.minlength && null != n.maxlength && (n.rangelength = [n.minlength, n.maxlength], delete n.minlength, delete n.maxlength)), n }, normalizeRule: function (e) { if ("string" == typeof e) { var t = {}; d.each(e.split(/\s/), function () { t[this] = !0 }), e = t } return e }, addMethod: function (e, t, i) { d.validator.methods[e] = t, d.validator.messages[e] = void 0 !== i ? i : d.validator.messages[e], t.length < 3 && d.validator.addClassRules(e, d.validator.normalizeRule(e)) }, methods: { required: function (e, t, i) { if (!this.depend(i, t)) return "dependency-mismatch"; if ("select" === t.nodeName.toLowerCase()) { var n = d(t).val(); return n && 0 < n.length } return this.checkable(t) ? 0 < this.getLength(e, t) : 0 < e.length }, email: function (e, t) { return this.optional(t) || /^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(e) }, url: function (e, t) { return this.optional(t) || /^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/i.test(e) }, date: function (e, t) { return this.optional(t) || !/Invalid|NaN/.test(new Date(e).toString()) }, dateISO: function (e, t) { return this.optional(t) || /^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/.test(e) }, number: function (e, t) { return this.optional(t) || /^(?:-?\d+|-?\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(e) }, digits: function (e, t) { return this.optional(t) || /^\d+$/.test(e) }, minlength: function (e, t, i) { var n = d.isArray(e) ? e.length : this.getLength(e, t); return this.optional(t) || i <= n }, maxlength: function (e, t, i) { var n = d.isArray(e) ? e.length : this.getLength(e, t); return this.optional(t) || n <= i }, rangelength: function (e, t, i) { var n = d.isArray(e) ? e.length : this.getLength(e, t); return this.optional(t) || n >= i[0] && n <= i[1] }, min: function (e, t, i) { return this.optional(t) || i <= e }, max: function (e, t, i) { return this.optional(t) || e <= i }, range: function (e, t, i) { return this.optional(t) || e >= i[0] && e <= i[1] }, step: function (e, t, i) { var n, a = d(t).attr("type"), s = "Step attribute on input type " + a + " is not supported.", r = new RegExp("\\b" + a + "\\b"), o = function (e) { var t = ("" + e).match(/(?:\.(\d+))?$/); return t && t[1] ? t[1].length : 0 }, l = function (e) { return Math.round(e * Math.pow(10, n)) }, c = !0; if (a && !r.test(["text", "number", "range"].join())) throw new Error(s); return n = o(i), (o(e) > n || l(e) % l(i) != 0) && (c = !1), this.optional(t) || c }, equalTo: function (e, t, i) { var n = d(i); return this.settings.onfocusout && n.not(".validate-equalTo-blur").length && n.addClass("validate-equalTo-blur").on("blur.validate-equalTo", function () { d(t).valid() }), e === n.val() }, remote: function (s, r, e, o) { if (this.optional(r)) return "dependency-mismatch"; o = "string" == typeof o && o || "remote"; var l, t, i, c = this.previousValue(r, o); return this.settings.messages[r.name] || (this.settings.messages[r.name] = {}), c.originalMessage = c.originalMessage || this.settings.messages[r.name][o], this.settings.messages[r.name][o] = c.message, e = "string" == typeof e && { url: e } || e, i = d.param(d.extend({ data: s }, e.data)), c.old === i ? c.valid : (c.old = i, (l = this).startRequest(r), (t = {})[r.name] = s, d.ajax(d.extend(!0, { mode: "abort", port: "validate" + r.name, dataType: "json", data: t, context: l.currentForm, success: function (e) { var t, i, n, a = !0 === e || "true" === e; l.settings.messages[r.name][o] = c.originalMessage, a ? (n = l.formSubmitted, l.resetInternals(), l.toHide = l.errorsFor(r), l.formSubmitted = n, l.successList.push(r), l.invalid[r.name] = !1, l.showErrors()) : (t = {}, i = e || l.defaultMessage(r, { method: o, parameters: s }), t[r.name] = c.message = i, l.invalid[r.name] = !0, l.showErrors(t)), c.valid = a, l.stopRequest(r, a) } }, e)), "pending") } } }); var n, a = {}; return d.ajaxPrefilter ? d.ajaxPrefilter(function (e, t, i) { var n = e.port; "abort" === e.mode && (a[n] && a[n].abort(), a[n] = i) }) : (n = d.ajax, d.ajax = function (e) { var t = ("mode" in e ? e : d.ajaxSettings).mode, i = ("port" in e ? e : d.ajaxSettings).port; return "abort" === t ? (a[i] && a[i].abort(), a[i] = n.apply(this, arguments), a[i]) : n.apply(this, arguments) }), d }), define("sf-validate", ["helper", "verify", "sflayer", "jquery-validate"], function (e, n) { return "sc" == e.getSiteLanguage() ? $.extend($.validator.messages, { required: "这是必填字段", remote: "请修正此字段", email: "请输入有效的电子邮件地址", url: "请输入有效的网址", date: "请输入有效的日期", dateISO: "请输入有效的日期 (YYYY-MM-DD)", number: "请输入有效的数字", digits: "只能输入正整数", creditcard: "请输入有效的信用卡号码", equalTo: "你的输入不相同", extension: "请输入有效的后缀", maxlength: $.validator.format("最多可以输入 {0} 个字符"), minlength: $.validator.format("最少要输入 {0} 个字符"), rangelength: $.validator.format("请输入长度在 {0} 到 {1} 之间的字符串"), range: $.validator.format("请输入范围在 {0} 到 {1} 的数值"), max: $.validator.format("请输入不大于 {0} 的数值"), min: $.validator.format("请输入不小于 {0} 的数值") }) : "tc" == e.getSiteLanguage() && $.extend($.validator.messages, { required: "這是必填字段", remote: "請修正此字段", email: "請輸入有效的電子郵件地址", url: "請輸入有效的網址", date: "請輸入有效的日期", dateISO: "請輸入有效的日期 (YYYY-MM-DD)", number: "請輸入有效的數字", digits: "只能輸入正整數", creditcard: "請輸入有效的信用卡號碼", equalTo: "你的輸入不相同", extension: "請輸入有效的後綴", maxlength: $.validator.format("最多可以輸入 {0} 個字符"), minlength: $.validator.format("最少要輸入 {0} 個字符"), rangelength: $.validator.format("請輸入長度在 {0} 到 {1} 之間的字符串"), range: $.validator.format("請輸入範圍在 {0} 到 {1} 的數值"), max: $.validator.format("請輸入不大于 {0} 的數值"), min: $.validator.format("請輸入不小于 {0} 的數值") }), $.validator.addMethod("maxCharacterLength", function (e, t, i) { var n = e.gblen(); return this.optional(t) || n <= i }, _l("格式错误")), $.validator.addMethod("regex", function (e, t, i) { return this.optional(t) || n[i](e) }, _l("格式错误")), $.validator.addMethod("rangeMargin", function (e, t, i) { return this.optional(t) || i[0] < e && e < i[1] }, $.validator.format(_l("请输入范围在 {0} 到 {1} 之间的数值"))), function (e, t) { var i = _.extend({ onfocusout: !1, onkeyup: !1, focusInvalid: !1 }, t); i.showErrors = function (e, t) { 0 < t.length && (layer.tips(t[0].message, t[0].element, { tips: 3, anim: 5, time: 2e3, tipsMore: !1, isOutAnim: !1 }), t[0].element.focus()) }, e.validate(i) } }), define("views/pages/order/cn/bulkShipping/shipper/validateShipper", ["baseView", "sf-validate", "helper"], function (e, t) { return e.extend({ addFormValidate: function () { var e = this; t(this.$("form"), { rules: { contactName: { required: !0, maxlength: 20 }, companyName: { maxlength: 20 }, contactTel: { required: function () { return "" == e.$('[name="contactPhone"]').val() }, regex: e.formatTel }, contactPhone: { required: function () { return "" == e.$('[name="contactTel"]').val() }, regex: "isMobile" }, location: { required: !0 }, address: { required: !0 }, customerId: { required: !0, regex: function () { return "" == e.$('[name="companyName"]').val() ? "isTwIdCardNo" : "isTwComLicenseNo" } } }, messages: { contactTel: { required: _l("手机号码、固话号码请至少填写一项"), regex: _l("您输入的手机号码格式不正确，请重新输入。") }, contactPhone: { required: _l("手机号码、固话号码请至少填写一项"), regex: _l("您输入的固话号码格式不正确，请重新输入。") }, customerId: { regex: function () { return "" == e.$('[name="companyName"]').val() ? _l("请填写正确的台湾个人身份证号") : _l("请填写正确的台湾公司营业执照号") } } } }) }, validateshipper: function () { return this.$("form").validate().form() }, getFormDataObj: function () { var e = this.$("form").serializeArray(); return _.object(_.pluck(e, "name"), _.pluck(e, "value")) } }) }), define("models/detailRegion", ["backbone"], function (e) { return e.Model.extend({}) }), define("collections/detailRegions", ["backbone", "models/detailRegion", "helper", "const"], function (e, t, r, i) { var n = "A000810000", a = "A000820000", s = "A000710000", o = "A000086000"; return e.Collection.extend({ model: t, initialize: function (e) { this.customURL = e.customURL }, relativeURLOnRegion: function (e) { return "POPULAR" === e.code ? "region/popularRegions" : "HKMCTW" === e.code || "GLOBAL" === e.code ? this.subRegionURL("A000000000", -1) : this.subRegionURL(e.code, e.level) }, subRegionURL: function (e, t) { var i = this.customURL() || "region/%s/subRegions?level=%s"; return 0 < $(".range-page").length && "international" === $(".range-page .detail-location-picker li.current").data("tab") && (i = "region/%s/subRegions/origins?level=%s"), 0 < $(".range-page").length && "hk-mc-tw" === $(".range-page .detail-location-picker li.current").data("tab") && (i = "region/%s/subRegions?level=%s"), null == t && (t = -1), _.sprintf(i, e, t) }, parse: function (e) { return e = _.filter(e, function (e) { return e.name }), _.each(e, function (e) { -1 !== _.indexOf([n, a, s], e.parentCode) && (e.countryCode = e.parentCode), e.name = e.name.replace("印度尼西亚", "印尼").replace("印度尼西亞", "印尼"), "hk" === r.getSiteLocation() && ("澳大利亚" !== e.name && "澳大利亞" !== e.name || (e.name = e.name.replace("澳大利亚", "澳洲").replace("澳大利亞", "澳洲"))), e.name = e.name.replace(/( Province)|( City)|( District)|( County)/g, "") }), e }, parseHKTWMCAndGlobal: function (e) { if ("HKMCTW" === e || "GLOBAL" === e) { var i = "HKMCTW" === e, t = _.filter(this.models, function (e) { if (e.get("code") === o) return !1; var t = -1 !== _.indexOf([n, a, s], e.get("code")); return i ? t : !t }); this.set(t) } }, fetchRegions: function (e, i) { this.fetchingRegionLevel = e.level, this.fetchingRegionCode = e.code, this.fetchedRegionsBackup = this.fetchedRegionsBackup || {}; var t = this.fetchedRegionsBackup[e.code]; if (t && t.relativeURLOnRegion === this.relativeURLOnRegion(e)) return this.reset().set(t.data), this.isFetchingData = !1, this.errorLoadingData = !1, i && i(t.respond, t.status), void this.trigger("dataFetched"); this.isFetchingData = !0, this.errorLoadingData = !1; var n = this; this.trigger("dataFetched"); var a = this.relativeURLOnRegion(e); this.url = r.getRESTfulDomain(a); var s = e.code; this.fetch({ cache: !0, complete: function (e, t) { "success" === t && (n.fetchedRegionsBackup[s] = { respond: e, status: t, data: n.toJSON(), relativeURLOnRegion: a }), i && n.fetchingRegionCode === s && (n.fetchingRegionCode = null, i(e, t)) }, success: function () { n.parseHKTWMCAndGlobal(s), n.fetchingRegionCode === s && (n.isFetchingData = !1, n.errorLoadingData = !1, n.trigger("dataFetched")) }, error: function () { n.fetchingRegionCode === e.code && (n.isFetchingData = !1, n.errorLoadingData = !0, n.trigger("dataFetched")) } }) } }, { isChinaMainland: function (e) { return e === o }, isNotAboard: function (e) { return e === n || e === a || e === s || e === o }, isNotAboardForRate: function (e) { return e == i.RATE_OF_HK || e == i.RATE_OF_MACAO || e == i.RATE_OF_TW } }) }), define("models/regionTabs", ["backbone", "helper", "const"], function (e, n, a) { return e.Model.extend({ initialize: function (e) { this.getSelectedArea = e.getSelectedArea, this.getMaxLevel = e.getMaxLevel, this.getMinLevel = e.getMinLevel, this.setSelectedArea = e.setSelectedArea, this.datasource = { "main-land-provinces": [{ displayName: _l("省/直辖市"), pinToLeft: !0, parentRegion: { name: _l("省/直辖市"), code: "A000086000" }, selected: !0 }], "main-land": [{ displayName: _l("常用市"), alwaysDisplayName: !0, pinToLeft: !0, parentRegion: { name: _l("常用市"), code: "POPULAR" }, selected: !0 }, { displayName: _l("省/直辖市"), pinToLeft: !0, parentRegion: { name: _l("省/直辖市"), code: "A000086000" }, selected: !1 }], "hk-mc-tw": [{ pinToLeft: !0, displayName: _l("港澳台"), parentRegion: { name: _l("港澳台"), code: "HKMCTW" }, selected: !0 }], international: [{ displayName: _l("海外"), parentRegion: { name: _l("海外"), code: "GLOBAL" }, selected: !0 }], hongkong: [{ displayName: _l("香港"), parentRegion: { name: _l("香港"), code: "HKMCTW" }, selected: !0 }] } }, getAreaDefaultRegionTab: function (e) { return this.datasource[e] }, saveStateToCookie: function () { Modernizr.localstorage && (localStorage.setItem(a.CURRENT_SELECTED_AREA, this.getSelectedArea()), localStorage.setItem(this.getSelectedArea() + n.assemabledLocationAndLanguageQureyString(), JSON.stringify(this.regionTabs))) }, restoreStateFromCookie: function (e) { if (Modernizr.localstorage) { var t; t = e ? this.getSelectedArea() : localStorage.getItem(a.CURRENT_SELECTED_AREA) || this.getSelectedArea(); var i = JSON.parse(localStorage.getItem(t + n.assemabledLocationAndLanguageQureyString())); _.isEmpty(i) ? this.resetRegionTab() : (this.regionTabs = this.trimSavedStateIfNeeded(i), this.setSelectedArea(t), this.trigger("regionTabUpdated")) } }, trimSavedStateIfNeeded: function (e) { var i = this; (e = _.filter(e, function (e) { var t; return t = e.selectedRegion ? i.getMaxLevel(e.selectedRegion.code, e.selectedRegion.countryCode) : i.getMaxLevel(), !e.parentRegion.level || e.parentRegion.level < t }), this.getCurrentSelectedTab()) || (_.last(_.filter(e, function (e) { return e.selectedRegion })).selected = !0); return e }, resetRegionTab: function () { this.regionTabs = this.getAreaDefaultRegionTab(this.getSelectedArea()), this.trigger("regionTabUpdated") }, getRegionTabs: function () { return this.regionTabs }, cleanRegionTabsSelectedStatus: function () { _.each(this.regionTabs, function (e) { e.selected = !1 }) }, activeTabByParentCode: function (t) { this.cleanRegionTabsSelectedStatus(); var e = _.find(this.regionTabs, function (e) { return e.parentRegion.code === t }); e && (e.selected = !0), this.trimTabsAfterCurrentIndex(), this.trigger("regionTabUpdated") }, getCurrentSelectedTab: function () { var e = _.findWhere(this.regionTabs, { selected: !0 }) || _.first(this.regionTabs); return e && (e.selected = !0), e }, hasReachedMaxLevel: function () { var e = this.getCurrentSelectedTab().selectedRegion; return e.level >= this.getMaxLevel(e.code, e.countryCode, e.rateCode) }, hasReachedMinLevel: function () { var e = this.getCurrentSelectedTab().selectedRegion; return e.level >= this.getMinLevel(e.code, e.countryCode, e.rateCode) }, updateCurrentTabWithSelectedRegion: function (e) { var t = this.getCurrentSelectedTab(); t && t.pinToLeft && _.each(this.regionTabs, function (e) { e.pinToLeft && (e.selectedRegion = null) }), t && (t.selectedRegion = e) }, trimTabsAfterCurrentIndex: function () { var i; _.each(this.regionTabs, function (e, t) { (e.pinToLeft || !0 === e.selected) && (i = t) }), this.regionTabs = _.first(this.regionTabs, i + 1) }, getSelectedLocationDescription: function () { var e = _.map(this.regionTabs, function (e) { return e.selectedRegion ? e.selectedRegion.title : "" }); return (e = _.filter(e, function (e) { return e && 0 < e.length })).join("-") }, appendSelectedRegionToTabs: function (e) { this.cleanRegionTabsSelectedStatus(), this.regionTabs.push({ parentRegion: e, selected: !0 }) }, handleNewChoosedRegion: function (e) { this.trimTabsAfterCurrentIndex(), this.updateCurrentTabWithSelectedRegion(e) } }) }), define("components/detailedLocationPicker/picker", ["backbone", "templates", "collections/detailRegions", "models/regionTabs", "sflayer", "jquery-ui"], function (e, n, t, a, o) { return e.View.extend({ events: { "click .input-group-addon": "toggleLocationPicker", "click input": "handleInputClick", "click .detail-location-picker": "stopPropagation", mouseout: "stopPropagation", "click .area-level-tabs li": "areaTabSwitch", "click .region-level-tabs li": "regionTabClicked", "click .regions li a": "regionChanged", "click .pages-switch li": "pageSwitcherClicked", "change input": "selectedRegionChanged", toggle: "toggleLocationPicker", "click .hide-picker": "clearCurrentSelection", "keydown input": "hideLocationPicker", "blur input": "checkInputChanged" }, data: { regionTabs: [] }, initialize: function (e, t) { this.$el.unbind(), _.bindAll(this, "getMaxLevel"), _.bindAll(this, "getMinLevel"), _.bindAll(this, "getSelectedArea"), _.bindAll(this, "getCustomURL"), _.bindAll(this, "setSelectedArea"), this.data = _.extend({}, this.data, t), this.regionTabsModel = new a({ getMaxLevel: this.getMaxLevel, getMinLevel: this.getMinLevel, getSelectedArea: this.getSelectedArea, setSelectedArea: this.setSelectedArea }), this.setupLocationPicker(), this.setupDetailRegions(), this.restoreLocationPickerState(), this.primaryButton = $(".location-inputs .primary-button"), this.destInput = $("input.dests").last(), this.originInput = $("input.origins").last(), this.DUTCG = ["A311000000", "A111000000", "A591100000", "A121000000", "A000830000", "A00084", "A00720000", "A000252001", "A000356001", "C000000374", "C000001091", "C000002920", "C000005726", "001", "0001", "0052", "0056", "007", "030", "031", "032", "033", "034", "0351", "0352", "0353", "0356", "0357", "0358", "0359", "0370", "0371", "0372", "0385", "0386", "036", "039", "040", "0420", "0421", "043", "044", "045", "046", "048", "049", "055", "056", "060", "061", "062", "063", "064", "065", "066", "081", "082", "084", "085", "091", "092", "094", "095", "097", "0971", "673", "880", "976"], this.DUTCGLength = this.DUTCG.length, this.isDests = this.$input.hasClass("dests"), this.originReqUrl = "", this.destReqUrl = "", this.bindAutoComplete(); var i = this.$(".detail-location-input.origin-price").data("selected-area"), n = this.$(".detail-location-input.dest-price").data("selected-area"); "hk-mc-tw" === i && this.$(".detail-location-input.origin-price").data("max-level", 1), "hk-mc-tw" === n && this.$(".detail-location-input.origin-price").data("max-level", 1) }, bindAutoComplete: function () { var r = this; r.$("input").autocomplete({ minLength: 1, delay: 300, select: function (e, t) { if (e.stopPropagation(), r.removePickerTip(), r.$input.val(t.item.value), r.$el.hasClass("origin-price") || r.$el.hasClass("dest-price")) r.handleInputedRegion(t.item); else { var i = _.values(t.item); r.setLocation(_.without(i, _.last(i))) } $(e.target).hasClass("dests") && !_.isEmpty(r.originInput.val()) && r.primaryButton.removeClass("disabled") }, open: function () { r.hideLocationPicker() }, source: function (e, n) { var a = e.term; if (0 < r.$el.find("input.origins").length || 0 < r.$el.find("input.dests").length) { if (r.$el.hasClass("origin-price") || r.$el.hasClass("dest-price")) { if (a in cache && (n(cache[a]), !r.isDests)) return; r.originReqUrl = "region/live/origin", r.destReqUrl = "region/live/origin/" + r.originInput.data("code") + "/dests" } else { if (a && "sc" === Helper.getSiteLanguage() && !(a = a.replace(/(^\s+)|(\s+$)/g, "")).match(/^[\u4e00-\u9fa5]{2,}$/)) return; if (r.originReqUrl = "region/live/order/origin", r.destReqUrl = "region/live/order/origin/" + r.originInput.data("code") + "/dests", r.isDests && !r.originInput.data("code")) return void o.alert(_l("请先选择寄件人的上门地址")) } var t = [], i = r.areaTabs(); i.showAreaTab ? (i.showMainLand && t.push("main-land"), i.showHKMCTW && t.push("hk-mc-tw"), i.showGlobe && t.push("international")) : t.push(r.getSelectedArea()); var s = { query: e.term, limit: 100, level: 3, areaTab: t.join(",") }; $.getJSON(Helper.getRESTfulDomain(r.isDests ? r.destReqUrl : r.originReqUrl), s, function (e, t, i) { if (e && 0 == e.length) return r.$("input").autocomplete("close"), void (0 == r.$el.find(".picker-tip").length && r.$el.append('<span class="picker-tip" style="color:red;margin-top: 20px;">' + _l("未找到您所在的地区信息，请重新选择") + "</span>")); r.removePickerTip(), r.$el.hasClass("origin-price") || r.$el.hasClass("dest-price") ? cache[a] = _.chain(e).filter(function (e) { for (var t = 0; t < r.DUTCGLength; t++)if (e.code === r.DUTCG[t]) return !1; return !0 }).map(function (e) { return e.title = e.value = e.label = e.name, e }).value() : cache[a] = e, cache[a] && 0 == cache[a].length ? 0 == r.$el.find(".picker-tip").length && r.$el.append('<span class="picker-tip" style="color:red;margin-top: 20px;">' + _l("未找到您所在的地区信息，请重新选择") + "</span>") : n(cache[a]) }) } } }).autocomplete("instance")._renderItem = function (e, t) { return r.$el.hasClass("origin-price") || r.$el.hasClass("dest-price") ? $("<li>").append(t.label + "<br></li>").appendTo(e) : (t.value = _.pluck(t, "name").join("-"), $("<li>").append(t.value + "<br></li>").appendTo(e)) } }, handleInputClick: function (e) { this.bindAutoComplete(), this.toggleLocationPicker(e) }, removePickerTip: function () { 0 < this.$el.find(".picker-tip").length && this.$(".picker-tip").remove() }, saveLocationPickerState: function () { this.$el.data("do-save-state") && "international" !== this.getSelectedArea() && this.regionTabsModel.saveStateToCookie() }, checkInputChanged: function (e) { var t = $(e.target), i = this.regionTabsModel.getSelectedLocationDescription(); i && t.val() === i || this.$detailedLocationPicker.is(":visible") || (this.regionTabsModel.resetRegionTab(), 0 < navigator.userAgent.indexOf("MSIE 8.0") ? t.val(t.attr("placeholder")).addClass("placeholder").trigger("blur.placeholder") : t.val("").data("code", ""), this.primaryButton.addClass("disable")) }, restoreLocationPickerState: function () { var e = this; if (e.$el.data("do-restore-state")) { this.regionTabsModel.restoreStateFromCookie(this.$el.data("only-current-tab")), setTimeout(function () { e.$("input.origins").trigger("change") }); var t = _.last(_.filter(this.regionTabsModel.getRegionTabs(), function (e) { return e.selectedRegion })); if (!t) return; if (this.$input.data("code") && this.$input.data("code") !== t.selectedRegion.code) return void this.regionTabsModel.resetRegionTab(); t && t.selectedRegion.level >= this.getMinLevel(t.selectedRegion.code, t.selectedRegion.countryCode, t.selectedRegion.rateCode) && (this.updateLocationPickerSelectionToInput(t.selectedRegion), this.triggerRegionModelUpdated()) } else this.regionTabsModel.resetRegionTab() }, resetLocationPicker: function () { this.regionTabsModel.resetRegionTab(), this.$input.val(""), this.$input.data("code", "") }, getMaxLevel: function (e, t, i) { return t && this.$el.data("max-" + t) ? this.$el.data("max-" + t) : i && this.$el.data("max-" + i) ? this.$el.data("max-" + i) : this.$el.data("max-level") || 5 }, getMinLevel: function (e, t, i) { return t && this.$el.data("min-" + t) ? this.$el.data("min-" + t) : this.$el.data("min-level") || this.getMaxLevel(e, t, i) }, getSelectedArea: function () { if (this.$el.data("selected-area")) return this.$el.data("selected-area"); window._cmsConfig && window._cmsConfig.language; var e = window._cmsConfig && window._cmsConfig.region || "cn"; return "hk" === e || "tw" === e ? "hk-mc-tw" : "cn" === e ? "main-land" : "international" }, setSelectedArea: function (e) { this.$el.data("selected-area", e) }, getCustomURL: function () { return this.$el.data("custom-url") }, setupLocationPicker: function () { this.$detailedLocationPicker = $('<div class="detail-location-picker toggle-plugins"></div>'), this.$el.append(this.$detailedLocationPicker), this.$input = this.$("input") }, setupDetailRegions: function () { this.regions = new t({ customURL: this.getCustomURL }), this.listenTo(this.regions, "dataFetched", this.render); var e = this; this.listenTo(this.regionTabsModel, "regionTabUpdated", function () { e.$detailedLocationPicker.is(":visible") ? (e.regions.fetchRegions(e.regionTabsModel.getCurrentSelectedTab().parentRegion), e.regionTabDirty = !1) : e.regionTabDirty = !0 }) }, availableRegions: function () { return !0 === this.$el.data("show-all-region") ? this.regions.models : this.regions.where({ availableAsOrigin: !0 }) }, unavailableRegions: function () { return !0 === this.$el.data("show-all-region") ? [] : this.regions.where({ availableAsOrigin: !1 }) }, areaTabs: function () { return { showAreaTab: !this.$el.data("hide-area-tab"), showMainLand: !this.$el.data("hide-main-land"), showHKMCTW: !this.$el.data("hide-hkmctw"), showGlobe: !this.$el.data("hide-globe"), currentTab: this.getSelectedArea() || this.selectedAreaTab } }, getFilterRegions: function () { var e = this.availableRegions(); return this.$el.data("hide-hk") && (e = e.filter(function (e) { return "A000810000" != e.get("code") })), this.$el.data("hide-macao") && (e = e.filter(function (e) { return "A000820000" != e.get("code") })), this.$el.data("hide-tw") && (e = e.filter(function (e) { return "A000710000" != e.get("code") })), e }, render: function () { var e = this.regionTabsModel.getCurrentSelectedTab(), t = this.getFilterRegions(), i = n.detailedLocationPicker({ availableRegions: t, unavailableRegions: this.unavailableRegions(), regionTabs: this.regionTabsModel.getRegionTabs(), areaTabs: this.areaTabs(), pageLimit: 52, shouldShowFussySelection: this.shouldShowFussySelection(), currentSelectedRegionCode: e.selectedRegion ? e.selectedRegion.code : void 0, isLoading: this.regions.isFetchingData, showNotAvailable: 0 === t.length, errorLoading: this.regions.errorLoadingData }); this.$detailedLocationPicker.html(i) }, shouldShowFussySelection: function () { return !this.$el.data("hide-fussy-selector") && this.regionTabsModel.getCurrentSelectedTab().parentRegion.level + 1 > this.getMinLevel() }, showPicker: function () { $(".toggle-plugins").hide(), this.regionTabDirty && this.regions.fetchRegions(this.regionTabsModel.getCurrentSelectedTab().parentRegion), this.$detailedLocationPicker.show() }, clearCurrentSelection: function () { $(".toggle-plugins").hide(); var e = this.regionTabsModel.getCurrentSelectedTab(); e.selectedRegion = null, this.updateLocationPickerSelectionToInput(e.parentRegion), this.render(), this.triggerRegionModelUpdated() }, toggleLocationPicker: function (e) { if (this.removePickerTip(), this.$detailedLocationPicker.is(":visible")) this.$detailedLocationPicker.hide(); else { if (e && e.stopPropagation(), $(".ui-autocomplete").is(":visible") && $(".ui-autocomplete").hide(), _.isEmpty(this.$input.val())) { this.regionTabsModel.resetRegionTab(); var t = this.regionTabsModel.regionTabs[0]; t.selected = !0, t.selectedRegion = null } else this.$input.select(); this.$input.attr("disabled") || this.showPicker() } }, hideLocationPicker: function (e) { e && 9 != e.keyCode && this.$detailedLocationPicker.is(":visible") && this.$detailedLocationPicker.hide() }, stopPropagation: function (e) { e.stopPropagation() }, selectedRegionChanged: function (e) { var t = $(e.currentTarget); _.isEmpty(t.data("code")) && _.isEmpty(t.val()) && (this.$el.data("selected-area", ""), this.resetLocationPicker()) }, setLocationCodeInInput: function (e, t, i, n, a) { this.$input.data("code", e), this.$input.data("parentCode", t), this.$input.data("rateCode", i), this.$input.data("country-code", n), this.$input.data("level", a) }, pageSwitcherClicked: function (e) { this.$(".pages-switch li").removeClass("current"); var t = $(e.currentTarget); t.addClass("current"), this.$(".regions-page").removeClass("current"), this.$(".regions-page[data-page=" + t.text() + "]").addClass("current") }, areaTabSwitch: function (e) { this.selectedAreaTab = $(e.currentTarget).data("tab"), this.$el.data("selected-area", this.selectedAreaTab), this.regionTabsModel.resetRegionTab(), this.render() }, regionTabClicked: function (e) { var t = $(e.currentTarget).data("code"); this.regionTabsModel.activeTabByParentCode(t) }, updateLocationPickerSelectionToInput: function (e) { this.render(), this.setLocationCodeInInput(e.code, e.parentCode, e.rateCode, e.countryCode, e.level); var t = this.regionTabsModel.getSelectedLocationDescription(); this.$input.val() !== t && (this.$input.trigger("blur.placeholder").val(t).attr("title", t).trigger("change"), 0 < $(".dest-price input").length && $(".dest-price input").removeAttr("disabled")) }, triggerRegionModelUpdated: function () { this.$el.trigger("regionModelUpdate", [{ regionTabs: this.regionTabsModel.getRegionTabs() }]), this.regionTabsModel.hasReachedMaxLevel() && this.$el.trigger("locationChanged", this.getLocationData()) }, preProcessInput: function (e) { var t = {}; switch (e.countryCode) { case "A000086000": this.$el.data("selected-area", "main-land"), t.activeTab = { code: "A000086000" }, t.handleRegon = { code: e.parentCode }; break; case "A000710000": case "A000810000": case "A000820000": this.$el.data("selected-area", "hk-mc-tw"), t.activeTab = t.handleRegon = { code: "HKMCTW" }; break; default: this.$el.data("selected-area", "international"), t.handleRegon = t.activeTab = { code: "GLOBAL" } }return t }, handleInputedRegion: function (e) { var t = this.preProcessInput(e); this.regionTabsModel.resetRegionTab(), this.regionTabsModel.activeTabByParentCode(t.activeTab.code), this.regionTabsModel.handleNewChoosedRegion(t.handleRegon), this.regionTabsModel.appendSelectedRegionToTabs(t.handleRegon); var i = { code: e.code, countryCode: e.countryCode, rateCode: null, name: e.name, level: e.level, title: e.name, provinceRateCode: null, provinceName: null }; this.renderRengionChanged(i) }, regionChanged: function (e) { var t; e.preventDefault(); var i = $(e.currentTarget); t = { id: i.data("id"), code: i.data("code"), countryCode: i.data("country-code"), rateCode: i.data("rate-code"), name: i.text().trim(), level: i.data("level"), title: i.prop("title"), provinceRateCode: i.data("province-rate-code"), provinceName: i.data("province-name"), provinceCode: i.data("province-code"), parentId: i.data("parent-id"), parentCode: i.data("parent-code"), distId: i.data("dist-id") }, this.renderRengionChanged(t) }, renderRengionChanged: function (i) { this.regionTabsModel.handleNewChoosedRegion(i), this.triggerRegionModelUpdated(); var n = this; this.regionTabsModel.hasReachedMinLevel() && (n.updateLocationPickerSelectionToInput(i), this.saveLocationPickerState()), this.triggerRegionModelUpdated(), this.regionTabsModel.hasReachedMaxLevel() ? this.$detailedLocationPicker.hide() : this.regions.fetchRegions(i, function (e, t) { if ("success" === t && 0 < n.availableRegions().length) n.regionTabsModel.appendSelectedRegionToTabs(i), n.render(); else { if ("success" === t && 0 === n.availableRegions().length) return n.updateLocationPickerSelectionToInput(i), n.regionTabsModel.trigger("regionTabUpdated"), void n.$detailedLocationPicker.hide(); 404 !== e.status && 0 !== n.availableRegions().length || (n.updateLocationPickerSelectionToInput(i), n.regionTabsModel.trigger("regionTabUpdated")) } n.$detailedLocationPicker.show() }) }, getInputValue: function () { return this.$("input").val() }, setLocation: function (e) { if (e.length) { this.$("input").val(""), Helper.isHK_MC_TW(e[0].rateCode) ? this.setSelectedArea("hk-mc-tw") : Helper.isInternational(e[0].rateCode) ? (this.$el.data("max-level", 1), this.setSelectedArea("international")) : this.setSelectedArea("main-land"), this.regionTabsModel.resetRegionTab(), Helper.isHK_MC_TW(e[0].rateCode) || Helper.isInternational(e[0].rateCode) || this.regionTabsModel.activeTabByParentCode("A000086000"), this.$detailedLocationPicker.show(); for (var t = 0; t < e.length; t++) { var i = e[t]; if (i.title = i.name, this.setRegionTab(i)) { this.regionTabDirty = !0; break } t == e.length - 1 && this.regions.fetchRegions(e[t]) } } }, setLocationData: function (e) { var t = [], i = e.locationCode + ""; if (e.provinceCode) { if (t.push({ distId: e.provinceId, code: e.provinceCode, rateCode: i, name: e.province, level: 2 }), !e.cityCode) return this.setLocation(t); if (Helper.isDirectCity(i) || t.push({ distId: e.cityId, code: e.cityCode, rateCode: i, name: e.city, level: -1 != ["852", "853", "886"].indexOf(i) ? 4 : 3 }), !e.countyCode) return this.setLocation(t); t.push({ distId: e.countyId, code: e.countyCode, rateCode: i, name: e.county, level: -1 != ["852", "886"].indexOf(i) ? 5 : 4 }), this.setLocation(t) } }, getLocationData: function () { var e, t = this.regionTabsModel.getRegionTabs(), i = t[0].parentRegion.code; e = "HKMCTW" === i ? 2 : "GLOBAL" === i ? 3 : 1; var n, a = _.filter(t, function (e) { return e.selectedRegion }); return n = 3 === e ? this.getGlobalLocation(a) : 2 === e ? this.getHMTLocation(a) : this.getMainlandLocation(a), _.extend({}, n, { regionType: e }) }, getMainlandLocation: function (e) { var t, i, n, a, s, r, o, l, c, d; return 2 === e.length ? (t = e[0].selectedRegion.provinceId || e[0].selectedRegion.distId, i = e[0].selectedRegion.provinceCode || e[0].selectedRegion.code, n = e[0].selectedRegion.provinceName || e[0].selectedRegion.name, a = e[0].selectedRegion.distId, s = e[0].selectedRegion.code, r = e[0].selectedRegion.name, o = e[1].selectedRegion.distId, l = e[1].selectedRegion.code, c = e[1].selectedRegion.name, d = e[0].selectedRegion.rateCode) : 3 === e.length && (t = e[0].selectedRegion.distId, i = e[0].selectedRegion.code, n = e[0].selectedRegion.name, a = e[1].selectedRegion.distId, s = e[1].selectedRegion.code, r = e[1].selectedRegion.name, o = e[2].selectedRegion.distId, l = e[2].selectedRegion.code, c = e[2].selectedRegion.name, d = e[1].selectedRegion.rateCode), { provinceId: t, provinceCode: i, province: n, cityId: a, cityCode: s, city: r, countyId: o, countyCode: l, county: c, locationCode: d } }, getHMTLocation: function (e) { var t, i, n, a, s, r = "", o = ""; return t = e[0].selectedRegion.code, i = e[0].selectedRegion.name, n = e[1].selectedRegion.code, a = e[1].selectedRegion.name, s = e[1].selectedRegion.rateCode, 3 === e.length && (r = e[2].selectedRegion.code, o = e[2].selectedRegion.name), { provinceCode: t, province: i, cityCode: n, city: a, countyCode: r, county: o, locationCode: s } }, getGlobalLocation: function (e) { var t, i, n, a, s, r, o, l, c; return 0 < e.length && (n = e[0].selectedRegion.code, t = e[0].selectedRegion.name, i = e[0].selectedRegion.rateCode, o = e[0].selectedRegion.rateCode, a = r = l = t, s = c = n), 2 === e.length && (s = e[1].selectedRegion.code, a = e[1].selectedRegion.name, o = e[1].selectedRegion.rateCode, r = l = a, c = s), { country: t, countryRateCode: i, countryCode: n, province: a, provinceCode: s, city: r, county: l, countyCode: c, locationCode: o } }, setRegionTab: function (e) { return this.regionTabsModel.handleNewChoosedRegion(e), this.regionTabsModel.hasReachedMinLevel() && (this.updateLocationPickerSelectionToInput(e), this.saveLocationPickerState()), this.regionTabsModel.hasReachedMaxLevel() ? (this.triggerRegionModelUpdated(), this.$detailedLocationPicker.hide(), !0) : (this.regionTabsModel.appendSelectedRegionToTabs(e), !1) } }) }), define("components/detailedLocationPicker/amapPicker", ["backbone", "templates", "sflayer", "helper", "jquery-ui"], function (e, t, a, n) { return e.View.extend({ initialize: function () { var n = this; this.$("input").autocomplete({ minLength: 0, source: function (e, t) { var i = n.options.location.getInputValue(); 2 < i.split("-").length ? (n.city = i.split("-")[1], n.district = i.split("-")[2]) : (n.city = i.split("-")[0], n.district = i.split("-")[1]), sfAjax.getDetailAddList({ data: { q: encodeURIComponent(e.term), city: encodeURIComponent(n.city), district: encodeURIComponent(n.district), ak: _webConfig.gisKey }, success: function (e) { 0 == e.status && 0 < e.result.POISum && t(e.result.POISet) }, error: function () { a.msg(_l("获取失败")) } }) }, select: function (e, t) { return e.stopPropagation(), n.addressSelected(t.item), !1 } }).autocomplete("instance")._renderItem = function (e, t) { return $("<li>").append(t.name + " <span>" + t.detail_addr + "</span>").appendTo(e) }, this.$("input").unbind("input") }, addressSelected: function (e) { this.$("input").val(e.name), e.regcode && (void 0 === this.options.allowHkMaCao ? n.isHK_MC_TW(e.regcode) || this.checkAddressSame(e) : !0 === this.options.allowHkMaCao && n.isHK_MC(e.regcode) && this.checkAddressSame(e)) }, checkAddressSame: function (e) { var t = this; if (e.adname[1] && e.adname[1] != this.city) var i = _p(_l("是否切换城市?详细地址与选择的省市区不一致，是否需要切换到%(city)s"), { city: e.adname[1] }), n = a.confirm(i, { title: _l("温馨提示!"), btn: [_l("切换城市"), _l("重新输入")] }, function () { t.queryAddrDistIdByName(e), a.close(n) }, function () { t.$("input").val(""), a.close(n) }); else if (e.adname[2] && e.adname[2] != t.district) i = _p(_l("您选择的地址可能属于%(city)s%(district)s，是否切换？"), { city: e.adname[1], district: e.adname[2] }), n = a.confirm(i, { title: _l("温馨提示!"), btn: [_l("是"), _l("否")] }, function () { t.queryAddrDistIdByName(e), a.close(n) }, function () { a.close(n) }) }, queryAddrDistIdByName: function (e) { var t = ""; t = n.isDirectCity(e.regcode) ? e.adname[0].substring(0, 2) : e.adname[0]; var i = this; sfAjax.getAddrDistIdByName({ data: { provinceName: t, cityName: e.adname[1], districtName: e.adname[2] }, success: function (e) { e ? i.options.location.setLocation(e) : a.msg(_l("获取失败")) }, error: function () { a.msg(_l("获取失败")) } }) } }) }), define("views/pages/order/innerViews/autoAddPicker", ["backbone", "templates", "helper", "sflayer"], function (e, n, a) { return e.View.extend({ initialize: function (i) { this.$("input").autocomplete({ minLength: 0, delay: 300, select: function (e, t) { return e.stopPropagation(), void 0 === i.allowHkMaCao ? a.isHK_MC_TW(t.item.locationCode) && i.noHmt ? layer.msg(_l("暂不支持该地区下单")) : i.callback(i.addressBookFillOption, t.item) : !0 === i.allowHkMaCao && (a.isHK_MC(t.item.locationCode) ? i.callback(i.addressBookFillOption, t.item) : layer.msg(_l("暂不支持该地区下单"))), !1 }, source: function (e, t) { $.cookie("loginUser") ? sfAjax.compoundQueryAddressBook({ data: { contact: encodeURIComponent(i.paramData().name), telPhone: encodeURIComponent(i.paramData().mobile), companyName: encodeURIComponent(i.paramData().company), memType: encodeURIComponent("sender" == i.addressBookFillOption ? 0 : 1) }, success: function (e) { 0 === e.code && e.result && t(e.result.slice(0, 9)) } }) : t([]) } }).autocomplete("instance")._renderItem = function (e, t) { return $("<li>").append($(n.autocompleteAddressBook({ item: t }))).appendTo(e) }, this.$("input").unbind("input") } }) }), define("views/pages/order/innerViews/smartFilling", ["baseView", "helper", "const", "sflayer"], function (e, a, s) { return e.extend({ init: function (e) { this.location = e.location, this.target = e.target, this.viewOption = e.viewOption }, render: function () { }, events: { "click .intellect-fill-btn": "orderAddrSplitSubmit", "input .intellect-order-addr": "isValidIntellectAddr" }, isValidIntellectAddr: function (e) { var t = this.$(".intellect-order-addr").val().trim(); this.$(".intellect-fill-input").text(t.length); var i = this.$(".intellect-fill-btn"); 0 == t.length ? i.addClass("disabled") : 100 < t.length ? (i.addClass("disabled"), this.tipIndex = layer.tips(_l("输入内容不能大于100字"), e.currentTarget, { tips: 3, anim: 5, time: !1, tipsMore: !1, isOutAnim: !1 })) : (i.removeClass("disabled"), this.tipIndex && layer.close(this.tipIndex)) }, orderAddrSplitSubmit: function () { var n = this; sfAjax.addressSplit({ data: { address: this.$(".intellect-order-addr").val().trim() }, success: function (e) { if (0 === e.code) { var t, i = e.result || {}; if ("cn" === a.getSiteLocation()) { if (n.options.onlyCnAdd && 1 === i.hmtareaType) return void layer.msg(_l("暂不支持该地区下单")); if ("sender" === n.target && 1 === i.hmtareaType) return void layer.msg(_l("暂不支持该地区下单")); if ("receiver" === n.target && 1 === i.hmtareaType && "heavyCargo" == n.viewOption) return void layer.msg(_l("暂不支持该地区下单")) } if ("hk" === a.getSiteLocation() && "sender" === n.target) { if (2 === i.hmtareaType) return void layer.msg(_l("暂不支持该地区下单")); if (i.originDestRegions[0] && i.originDestRegions[0].rateCode == s.RATE_OF_TW) return void layer.msg(_l("暂不支持该地区下单")) } 1 == i.splitType ? t = _l("未找到对应的省份，请您手动进行选择哦！") : 2 == i.splitType ? t = _l("未找到对应的城市，请您手动进行选择哦！") : 3 == i.splitType && (t = _l("未找到对应的行政区，请您手动进行选择哦！")), n.options.callback(i), t ? layer.confirm(t, { btn: [_l("我知道了")] }, function (e) { layer.close(e), n.location.setLocation(i.originDestRegions) }) : n.location.setLocation(i.originDestRegions), n.closeView() } }, error: function () { layer.msg(_l("网络异常，请稍后再试")) } }) }, closeView: function () { } }) }), define("components/addressBook/addressBookAdd", ["views/pages/order/cn/bulkShipping/shipper/validateShipper", "templates", "components/detailedLocationPicker/picker", "components/detailedLocationPicker/amapPicker", "views/pages/order/innerViews/smartFilling", "helper", "const", "sflayer"], function (e, t, i, n, a, s, r) { return e.extend({ layerOpts: { title: _l("新增联系人"), area: "680px", skin: "line", offset: "70px", fixed: !1 }, template: t.addressBookEdit, init: function () { this.addressBook = null, this.hasCustomerId = !1, this.formatTel = "isTelCnHmt" }, render: function () { this.$el.html(this.template({ addressBook: this.addressBook, hasCustomerId: this.hasCustomerId, showSelfRaising: this.showSelfRaising })), this.$(".detail-location-input").data("max-A000710000", 5).data("max-886", 5).data("max-A000810000", 5).data("max-852", 5), this.setLocationAttr(), this.location = new i({ el: this.$(".detail-location-input") }), this.addressBook && this.location.setLocationData(this.addressBook), "en" !== s.getSiteLanguage() && new a({ el: this.$(".smart-fill"), location: this.location, callback: this.fillBack.bind(this), onlyCnAdd: this.onlyCnAdd }), new n({ el: this.$("input[name='address']").parent(), location: this.location }), this.addFormValidate() }, events: { "change .detail-location-input input": "onLocationChanged", "locationChanged .detail-location-input": "regionModelUpdate", "click .save-address": "saveAddress" }, setLocationAttr: function () { }, onLocationChanged: function (e) { this.$(e.currentTarget).data("rate-code") == r.RATE_OF_TW ? this.$(".TWlicenseInput").show() : this.$(".TWlicenseInput").hide() }, fillBack: function (e) { this.$("input[name='contactName']").val(e.personalName), this.$("input[name='address']").val(e.site), e.mobile && this.$("input[name='contactTel']").val(e.mobile), e.telephone && this.$("input[name='contactPhone']").val(e.telephone), this.$(".intellect-warm-reminder").show() }, regionModelUpdate: function (e, t) { this.addLocation = t }, saveAddress: function () { if (this.validateshipper()) { var e = _.omit(this.getFormDataObj(), "location"), i = this, t = layer.load(); sfAjax.saveToAddressBook({ data: _.extend(e, { addressId: "", locationCode: this.addLocation.locationCode, country: "中国", countryCode: "A000086000", province: this.addLocation.province, provinceCode: this.addLocation.provinceCode, city: this.addLocation.city, cityCode: this.addLocation.cityCode, county: this.addLocation.county, countyCode: this.addLocation.countyCode, longitude: "", latitude: "", isDefault: 0, memType: 2 }), success: function (e) { if (e && 0 == e.code) var t = layer.confirm(_l("保存成功"), { noStop: !0, btn: _l("确定"), yes: function () { layer.close(t), i.options.callback(), i.close() } }); else i.saveErr() }, error: function () { i.saveErr() }, login: { succCallback: this.saveAddress.bind(this), cancelCallback: this.saveErr.bind(this) }, complete: function () { layer.close(t) } }) } }, saveErr: function () { layer.msg(_l("保存失败，请重试")) } }) }), define("components/addressBook/addressBookModify", ["./addressBookAdd", "helper", "const", "sflayer"], function (e, s, t) { return e.extend({ layerOpts: { title: _l("修改联系人"), area: "680px", skin: "line", offset: "70px", fixed: !1 }, init: function (e) { this.addressBook = e.addressBook, this.hasCustomerId = this.addressBook.locationCode == t.RATE_OF_TW, this.formatTel = "isTelCnHmt" }, getLocation: function () { return this.addLocation ? { locationCode: this.addLocation.locationCode, province: this.addLocation.province, provinceCode: this.addLocation.provinceCode, city: this.addLocation.city, cityCode: this.addLocation.cityCode, county: this.addLocation.county, countyCode: this.addLocation.countyCode } : { locationCode: this.addressBook.locationCode, province: this.addressBook.province, provinceCode: this.addressBook.provinceCode, city: this.addressBook.city, cityCode: this.addressBook.cityCode, county: this.addressBook.county, countyCode: this.addressBook.countyCode } }, getAjaxData: function () { return _.extend(this.addressBook, _.omit(this.getFormDataObj(), "location"), this.getLocation()) }, saveAddress: function () { if (this.validateshipper()) { var e = this.getAjaxData(), t = e.locationCode, i = e.isDefault; if (s.isInternational(t) && "1" == i) return void layer.msg(_l("国际地址不支持默认地址设置")); var n = this, a = layer.load(); sfAjax.saveToAddressBook({ data: e, success: function (e) { if (e && 0 == e.code) var t = layer.confirm(_l("保存成功"), { noStop: !0, btn: _l("确定"), yes: function () { layer.close(t), n.options.callback(), n.close() } }); else n.saveErr() }, error: function () { n.saveErr() }, login: { succCallback: this.saveAddress.bind(this), cancelCallback: this.saveErr.bind(this) }, complete: function () { layer.close(a) } }) } } }) }), function (h) { "use strict"; var o = function (e, t) { this.init(e, t) }; o.prototype = { init: function (e, t) { this.$element = h(e); var i = t && t.bootstrapMajorVersion ? t.bootstrapMajorVersion : h.fn.bootstrapPaginator.defaults.bootstrapMajorVersion; this.$element.attr("id"); if (2 === i && !this.$element.is("div")) throw "in Bootstrap version 2 the pagination must be a div element. Or if you are using Bootstrap pagination 3. Please specify it in bootstrapMajorVersion in the option"; if (2 < i && !this.$element.is("ul")) throw "in Bootstrap version 3 the pagination root item must be an ul element."; this.currentPage = 1, this.lastPage = 1, this.setOptions(t), this.initialized = !0 }, setOptions: function (e) { this.options = h.extend({}, this.options || h.fn.bootstrapPaginator.defaults, e), this.totalPages = parseInt(this.options.totalPages, 10), this.numberOfPages = parseInt(this.options.numberOfPages, 10), e && void 0 !== e.currentPage && this.setCurrentPage(e.currentPage), this.listen(), this.render(), this.initialized || this.lastPage === this.currentPage || this.$element.trigger("page-changed", [this.lastPage, this.currentPage]) }, listen: function () { this.$element.off("page-clicked"), this.$element.off("page-changed"), "function" == typeof this.options.onPageClicked && this.$element.bind("page-clicked", this.options.onPageClicked), "function" == typeof this.options.onPageChanged && this.$element.on("page-changed", this.options.onPageChanged), this.$element.bind("page-clicked", this.onPageClicked) }, destroy: function () { this.$element.off("page-clicked"), this.$element.off("page-changed"), this.$element.removeData("bootstrapPaginator"), this.$element.empty() }, show: function (e) { this.setCurrentPage(e), this.render(), this.lastPage !== this.currentPage && this.$element.trigger("page-changed", [this.lastPage, this.currentPage]) }, showNext: function () { var e = this.getPages(); e.next && this.show(e.next) }, showPrevious: function () { var e = this.getPages(); e.prev && this.show(e.prev) }, showFirst: function () { var e = this.getPages(); e.first && this.show(e.first) }, showLast: function () { var e = this.getPages(); e.last && this.show(e.last) }, onPageItemClicked: function (e) { var t = e.data.type, i = e.data.page; this.$element.trigger("page-clicked", [e, t, i]) }, onPageClicked: function (e, t, i, n) { var a = h(e.currentTarget); switch (i) { case "first": a.bootstrapPaginator("showFirst"); break; case "prev": a.bootstrapPaginator("showPrevious"); break; case "next": a.bootstrapPaginator("showNext"); break; case "last": a.bootstrapPaginator("showLast"); break; case "page": a.bootstrapPaginator("show", n) } }, render: function () { var e = this.getValueFromOption(this.options.containerClass, this.$element), t = this.options.size || "normal", i = this.options.alignment || "left", n = this.getPages(), a = 2 === this.options.bootstrapMajorVersion ? h("<ul></ul>") : this.$element, s = 2 === this.options.bootstrapMajorVersion ? this.getValueFromOption(this.options.listContainerClass, a) : null, r = null, o = null, l = null, c = null, d = null, u = 0; switch (this.$element.prop("class", ""), this.$element.addClass("pagination"), t.toLowerCase()) { case "large": case "small": case "mini": this.$element.addClass(h.fn.bootstrapPaginator.sizeArray[this.options.bootstrapMajorVersion][t.toLowerCase()]) }if (2 === this.options.bootstrapMajorVersion) switch (i.toLowerCase()) { case "center": this.$element.addClass("pagination-centered"); break; case "right": this.$element.addClass("pagination-right") }for (this.$element.addClass(e), this.$element.empty(), 2 === this.options.bootstrapMajorVersion && (this.$element.append(a), a.addClass(s)), this.pageRef = [], n.first && (r = this.buildPageItem("first", n.first)) && a.append(r), n.prev && (o = this.buildPageItem("prev", n.prev)) && a.append(o), u = 0; u < n.length; u += 1)(d = this.buildPageItem("page", n[u])) && a.append(d); n.next && (l = this.buildPageItem("next", n.next)) && a.append(l), n.last && (c = this.buildPageItem("last", n.last)) && a.append(c) }, buildPageItem: function (e, t) { var i = h("<li></li>"), n = h("<a></a>"), a = "", s = "", r = this.options.itemContainerClass(e, t, this.currentPage), o = this.getValueFromOption(this.options.itemContentClass, e, t, this.currentPage), l = null; switch (e) { case "first": case "last": case "prev": case "next": case "page": if (!this.getValueFromOption(this.options.shouldShowPage, e, t, this.currentPage)) return; a = this.options.itemTexts(e, t, this.currentPage), s = this.options.tooltipTitles(e, t, this.currentPage) }return i.addClass(r).append(n), n.addClass(o).html(a).on("click", null, { type: e, page: t }, h.proxy(this.onPageItemClicked, this)), this.options.pageUrl && n.attr("href", this.getValueFromOption(this.options.pageUrl, e, t, this.currentPage)), this.options.useBootstrapTooltip ? (l = h.extend({}, this.options.bootstrapTooltipOptions, { title: s }), n.tooltip(l)) : n.attr("title", s), i }, setCurrentPage: function (e) { if (e > this.totalPages || e < 1) throw "Page out of range"; this.lastPage = this.currentPage, this.currentPage = parseInt(e, 10) }, getPages: function () { var e = this.totalPages, t = this.currentPage % this.numberOfPages == 0 ? (parseInt(this.currentPage / this.numberOfPages, 10) - 1) * this.numberOfPages + 1 : parseInt(this.currentPage / this.numberOfPages, 10) * this.numberOfPages + 1, i = [], n = 0, a = 0; for (n = t = t < 1 ? 1 : t, a = 0; a < this.numberOfPages && n <= e; n += 1, a += 1)i.push(n); return (i.first = 1) < this.currentPage ? i.prev = this.currentPage - 1 : i.prev = 1, this.currentPage < e ? i.next = this.currentPage + 1 : i.next = e, i.last = e, i.current = this.currentPage, i.total = e, i.numberOfPages = this.options.numberOfPages, i }, getValueFromOption: function (e) { var t = Array.prototype.slice.call(arguments, 1); return "function" == typeof e ? e.apply(this, t) : e } }, h.fn.bootstrapPaginator, h.fn.bootstrapPaginator = function (a) { var s = arguments, r = null; return h(this).each(function (e, t) { var i = h(t), n = i.data("bootstrapPaginator"); if (!n) return n = new o(this, "object" != typeof a ? null : a), void (i = h(n.$element)).data("bootstrapPaginator", n); if ("string" == typeof a) { if (!n[a]) throw "Method " + a + " does not exist"; r = n[a].apply(n, Array.prototype.slice.call(s, 1)) } else r = n.setOptions(a) }), r }, h.fn.bootstrapPaginator.sizeArray = { 2: { large: "pagination-large", small: "pagination-small", mini: "pagination-mini" }, 3: { large: "pagination-lg", small: "pagination-sm", mini: "" } }, h.fn.bootstrapPaginator.defaults = { containerClass: "", size: "normal", alignment: "left", bootstrapMajorVersion: 2, listContainerClass: "", itemContainerClass: function (e, t, i) { return t === i ? "active" : "" }, itemContentClass: function (e, t, i) { return "" }, currentPage: 1, numberOfPages: 5, totalPages: 1, pageUrl: function (e, t, i) { return null }, onPageClicked: null, onPageChanged: null, useBootstrapTooltip: !1, shouldShowPage: function (e, t, i) { var n = !0; switch (e) { case "first": case "prev": n = 1 !== i; break; case "next": case "last": n = i !== this.totalPages; break; case "page": n = !0 }return n }, itemTexts: function (e, t, i) { switch (e) { case "first": return "&lt;&lt;"; case "prev": return "&lt;"; case "next": return "&gt;"; case "last": return "&gt;&gt;"; case "page": return t } }, tooltipTitles: function (e, t, i) { switch (e) { case "first": return "Go to first page"; case "prev": return "Go to previous page"; case "next": return "Go to next page"; case "last": return "Go to last page"; case "page": return t === i ? "Current page is " + t : "Go to page " + t } }, bootstrapTooltipOptions: { animation: !0, html: !0, placement: "top", selector: !1, title: "", container: !1 } }, h.fn.bootstrapPaginator.Constructor = o }(window.jQuery), define("bootstrapPagination", function () { }), define("views/others/bootstrapPagination", ["backbone", "bootstrapPagination"], function (e) { return e.View.extend({ initialize: function () { this.currentPage = this.options.currentPage, this.numberOfPages = this.options.numberOfPages, this.totalPages = this.options.totalPages, this.initPagination() }, initPagination: function () { var a = this; this.$(".pagination").bootstrapPaginator({ currentPage: a.currentPage, numberOfPages: a.numberOfPages, totalPages: a.totalPages, size: "normal", bootstrapMajorVersion: 3, alignment: "center", itemTexts: function (e, t, i) { switch (e) { case "first": return _l("首页"); case "prev": return _l("上一页"); case "next": return _l("下一页"); case "last": return _l("末页"); case "page": return t } }, itemContainerClass: function (e, t, i) { return t === i ? "active" : "pointer-cursor" }, onPageClicked: function (e, t, i, n) { n != a.currentPage && a.$el.trigger("pageClicked", n) } }) } }) }), define("components/addressBook/addressBook", ["baseView", "templates", "helper", "./addressBookAdd", "./addressBookModify", "views/others/bootstrapPagination", "sf-validate", "sflayer"], function (e, i, n, t, a, s, r) { return e.extend({ layerOpts: { title: _l("从地址簿选择"), area: "680px", skin: "line" }, template: i.addressBook, init: function (e) { this.addressBooks = e.addressBooks }, events: { "submit .search-form": "submitForm", "click .address_success tr": "selectAdd", "dblclick .address_success tr": "preDblclickToConform", "click .try-again": "fetchAddressBookAgain", "click .select-confirm": "confirmAddress", "click .add": "addOneAddress", "mouseenter .modify": "showModifyTip", "mouseleave .modify": "hideModifyTip", "click .modify": "modifyAddress", "mouseenter .set-default": "showSetDefaultTip", "mouseleave .set-default": "hideSetDefaultTip", "click .set-default": "setDefault", "mouseenter .delete": "showDeleteTip", "mouseleave .delete": "hideDeleteTip", "click .delete": "deleteAddress", "pageClicked .bootstrap-pagination": "jumpPage", "click .selectAll": "selectAllList" }, render: function () { this.$el.html(this.template({ loadingImg: n.getResourceURL("images/order/loading.gif"), hasSelectAll: this.hasSelectAll })), this.activeEV = "init", this.page = this.options.page, this.totalPage = this.options.totalPage, this.addFormValidate(), this.renderAddBooKList(), this.dealTips() }, dealTips: function () { var e = this; $(window).scroll(function () { layer.close(e.modifyTip), layer.close(e.setDefaultTip), layer.close(e.deleteTip) }), this.$(".height-scroll").scroll(function () { layer.close(e.modifyTip), layer.close(e.setDefaultTip), layer.close(e.deleteTip) }), $(window).resize(function () { e.$(".height-scroll").css("height", $(this).height() - 300), $(this).scroll() }), $(window).resize() }, renderAddBooKList: function () { var e = this.addressBooks; if (this.$(".add").toggleClass("disabled", !1), this.$(".address_success").remove(), this.$("dl").hide(), e && 0 < e.length) { var t = i.addressSuccessBody({ addressBookList: e }); this.$(".table-wrapper").append(t), new s({ el: this.$(".bootstrap-pagination"), totalPages: this.totalPage, currentPage: this.page, numberOfPages: 3 }), this.$(".address_success p").each(function () { $(this).attr("title", $(this).text()) }), this.$(".hide-in-loading").show() } else 1 < this.page ? (this.page -= 1, this.getAddBooKList()) : "init" == this.activeEV ? this.$(".address_fetch_null").show() : this.$(".address_search_null").show(); this.emptySelectAll() }, addFormValidate: function () { r(this.$(".search-form"), { rules: { searchParm: { maxlength: 20 } } }) }, emptySelectAll: function () { }, getAddBooKList: function (e) { this.page = e || this.page; var t = this; sfAjax.fetchAddressBookList({ data: { condition: encodeURI(this.searchParm || ""), pageNo: this.page, rowCount: "8" }, success: function (e) { e && 0 == e.code ? (t.addressBooks = e.result.content, t.page = e.result.pageNo, t.totalPage = e.result.totalPage, t.renderAddBooKList()) : t.showNetworkError() }, error: function () { t.showNetworkError() }, login: { succCallback: this.getAddBooKList.bind(this), cancelCallback: this.showNetworkError.bind(this) } }) }, submitForm: function (e) { if (e.preventDefault(), this.activeEV = "search", this.$(e.currentTarget).validate().form()) { this.showLoading(); var t = $.trim(this.$(".search-input").val()); this.searchParm = t, this.getAddBooKList(1) } }, jumpPage: function (e, t) { this.showLoading(), this.getAddBooKList(t) }, showNetworkError: function () { this.$(".add").toggleClass("disabled", !0), this.$("dl").hide(), this.$(".address_networkErr").show() }, showLoading: function () { this.$(".hide-in-loading").hide(), this.$("dl").hide(), this.$(".address_loading").show() }, selectAdd: function (e) { this.$(e.target).hasClass("address-check") ? (this.$(".address-check").removeClass("aicon-check").addClass("aicon-uncheck"), this.$(e.target).removeClass("aicon-uncheck").addClass("aicon-check"), e.stopPropagation()) : this.$(e.currentTarget).find(".address-check").trigger("click") }, confirmAddress: function () { 1 == this.$(".address-check.aicon-check").length ? this.dblclickToConform() : layer.msg(_l("请选择其中的一条数据")) }, preDblclickToConform: function (e) { 0 < this.$(e.target).closest(".modify,.set-default,.delete").length || this.dblclickToConform() }, dblclickToConform: function () { var i = this, e = this.$(".address-check.aicon-check").closest("tr").data("addid"); sfAjax.getAddressById({ data: { id: e }, success: function (e) { if (e && 0 == e.code && e.result) { var t = e.result[0].locationCode; if (void 0 === i.options.allowHkMaCao) { if (n.isInternational(t)) return void i.locationNotSupport(); if (n.isHK_MC_TW(t) && "receiver" == i.options.fillOption && "heavyCargo" == i.options.viewOption) return void i.locationNotSupport(); if (n.isHK_MC_TW(t) && "sender" == i.options.fillOption) return void i.locationNotSupport(); if (i.options.noHmt && n.isHK_MC_TW(t)) return void i.locationNotSupport() } else if (!0 === i.options.allowHkMaCao && !n.isHK_MC(t)) return void i.locationNotSupport(); e.result[0].countryCode = e.result[0].countryCode || "A000086000", i.options.callback(e.result[0]), i.close() } }, error: function () { layer.msg(_l("网络错误")) }, login: { succCallback: this.dblclickToConform.bind(this), cancelCallback: null } }) }, locationNotSupport: function () { layer.msg(_l("暂不支持该地区下单")) }, fetchAddressBookAgain: function () { this.showLoading(), this.getAddBooKList() }, addOneAddress: function () { new t({ callback: this.getAddBooKList.bind(this) }) }, showModifyTip: function (e) { this.modifyTip = layer.tips(_l("修改"), e.currentTarget, { tips: [1, "#333"], time: !1 }) }, hideModifyTip: function () { layer.close(this.modifyTip) }, modifyAddress: function (e) { e && e.stopPropagation(), this.modifyAddressId = e ? this.$(e.currentTarget).closest("tr").data("addid") : this.modifyAddressId; var t = this; this.isLocked(e) || sfAjax.getAddressById({ data: { id: this.modifyAddressId }, success: function (e) { e && 0 == e.code && e.result && new a({ addressBook: e.result[0], callback: t.getAddBooKList.bind(t) }) }, complete: function () { t.unlock(e) }, error: function () { layer.msg(_l("网络错误")) }, login: { succCallback: this.modifyAddress.bind(this), cancelCallback: null } }) }, showSetDefaultTip: function (e) { var t = this.$(e.currentTarget).hasClass("active") ? _l("已为默认地址") : _l("设为默认地址"); this.setDefaultTip = layer.tips(t, e.currentTarget, { tips: [1, "#333"], time: !1 }) }, hideSetDefaultTip: function () { layer.close(this.setDefaultTip) }, setDefault: function (e) { if (e && e.stopPropagation(), this.hideSetDefaultTip(), this.setDefaultTarget = e ? this.$(e.currentTarget) : this.setDefaultTarget, !this.setDefaultTarget.hasClass("active")) { var t = this.setDefaultTarget.closest("tr").data("addid"); if (!this.setDefaultTarget.hasClass("disabled")) { this.setDefaultTarget.toggleClass("disabled", !0); var i = this; sfAjax.setDefaultAddress({ data: { addressId: t, isDefault: 1 }, success: function (e) { e && 0 == e.code && e.result ? i.setDefaultAddressSuccess(i.setDefaultTarget) : i.setDefaultAddressFail() }, error: function () { i.setDefaultAddressFail() }, complete: function () { i.setDefaultTarget.toggleClass("disabled", !1) }, login: { succCallback: this.setDefault.bind(this), cancelCallback: this.setDefaultAddressFail.bind(this) } }) } } }, setDefaultAddressSuccess: function (t) { var e; layer.msg(_l("已设为默认寄件地址")), e = 0 < this.$(".default-tip").length ? this.$(".default-tip") : $('<span class="default-tip">' + _l("默认") + "</span>"), t.closest("tr").find(".contact-name").append(e), this.$(".set-default.active").removeClass("active aicon-fill-star").addClass("aicon-stroke-star"), t.addClass("active aicon-fill-star").removeClass("aicon-stroke-star"), _.each(this.addressBooks, function (e) { "1" == e.isDefault && (e.isDefault = "0"), e.addressId == t.closest("tr").data("addid") && (e.isDefault = "1") }) }, setDefaultAddressFail: function () { layer.msg(_l("设置默认寄件地址失败")) }, showDeleteTip: function (e) { this.deleteTip = layer.tips(_l("删除"), e.currentTarget, { tips: [1, "#333"], time: !1 }) }, hideDeleteTip: function () { layer.close(this.deleteTip) }, deleteAddress: function (e) { e.stopPropagation(), this.deleteAddressId = this.$(e.target).closest("tr").data("addid"); var t = _.findWhere(this.addressBooks, { addressId: this.deleteAddressId }), i = _l("您真的要删除") + (t.contactTel || t.contactPhone) + "(" + t.contactName + ")" + _l("这个地址吗") + "？", n = this, a = layer.confirm(i, { noStop: !0, btn: [_l("确定"), _l("取消")] }, function () { layer.close(a), n.confirmDelete() }, function () { layer.close(a) }) }, confirmDelete: function () { var e = this; sfAjax.deleteOneAddress({ data: { id: this.deleteAddressId }, success: function () { layer.msg(_l("删除成功")), e.getAddBooKList() }, error: function () { layer.msg(_l("删除失败")) }, login: { succCallback: this.confirmDelete.bind(this), cancelCallback: function () { layer.msg(_l("删除失败")) } } }) } }) }), define("views/pages/order/innerViews/popSmartFilling", ["templates", "./smartFilling"], function (e, t) { return t.extend({ template: e.smartFilling, layerOpts: { title: _l("智能地址填写"), area: "580px", skin: "line" }, render: function () { this.$el.html(this.template(this.options.config)) }, closeView: function () { this.close() } }) }), define("views/pages/order/cn/bulkShipping/shipper/shipper", ["./validateShipper", "templates", "event", "components/detailedLocationPicker/picker", "components/detailedLocationPicker/amapPicker", "../../../innerViews/autoAddPicker", "components/addressBook/addressBook", "../../../innerViews/popSmartFilling", "helper", "const", "sflayer"], function (e, t, i, n, a, s, r, o, l, c) { return e.extend({ template: t.shipper, events: { "click .address-book": "showAddressBookContent", "click .addIntellectFill": "showAddIntellectFillContent", "locationChanged .detail-location-input": "regionModelUpdate", 'change [name="address"]': "queryAddressRange" }, render: function () { this.$el.html(this.template({ shipperType: this.shipperType, rIndex: this.rIndex, rDelete: this.rDelete, hasCalc: this.hasCalc, hasNearBy: this.hasNearBy, priceUrl: l.getDynamicURLWithContext("/price/") })); var e = this; this.$(".autoAddPicker").each(function () { new s({ el: this, paramData: e.getInputVal.bind(e), addressBookFillOption: e.shipperType, noHmt: e.noHmt, allowHkMaCao: e.allowHkMaCao, callback: e.autoAddFillAddress.bind(e) }) }), this.location = new n({ el: this.$(".detail-location-input") }), new a({ el: this.$("input[name='address']").parent(), location: this.location, allowHkMaCao: this.allowHkMaCao }), this.addFormValidate() }, showAddressBookContent: function (e) { $.cookie("loginUser") ? this.showAddressBook(e) : i.trigger(i.Needlogin, { succCallback: this.showAddressBook.bind(this), cancelCallback: null }), "sender" === this.shipperType ? "hk" === l.getSiteLocation() ? sfgather.trackClicks("点击寄件人信息使用地址簿", "XWF010101") : sfgather.trackClicks("点击寄件人信息使用地址簿", "OWF010101") : "receiver" === this.shipperType && ("hk" === l.getSiteLocation() ? sfgather.trackClicks("点击收件人信息使用地址簿", "XWF010201") : sfgather.trackClicks("点击收件人信息使用地址簿", "OWF010201")) }, showAddressBook: function (e) { var t = this; this.isLocked(e) || sfAjax.fetchAddressBookList({ data: { pageNo: 1, rowCount: "8", condition: "" }, success: function (e) { e && 0 === e.code ? t.newAddressBookView(e) : layer.msg(_l("网络错误")) }, error: function () { layer.msg(_l("网络错误")) }, complete: function () { t.unlock(e) }, login: { succCallback: this.showAddressBook.bind(this), cancelCallback: null } }) }, newAddressBookView: function (e) { new r({ addressBooks: e.result.content, fillOption: this.shipperType, viewOption: this.viewOption, totalPage: e.result.totalPage, page: e.result.pageNo, allowHkMaCao: this.allowHkMaCao, callback: this.fillBackInfo.bind(this) }) }, fillBackInfo: function (e) { l.isDirectCity(e.locationCode) && (e.province = e.city), this.$("input[name='contactName']").val(e.contactName), this.$("input[name='companyName']").val(e.companyName), this.$("input[name='location']").data("code", e.countyCode).data("rate-code", e.locationCode).data("parent-code", e.cityCode), this.$("input[name='address']").val(e.address), this.location.setLocationData(e), this.$("input[name='contactTel']").val(e.contactTel), this.$("input[name='contactPhone']").val(e.contactPhone), e.locationCode === c.RATE_OF_TW ? this.$("input[name='customerId']").val(e.customerId) : this.$("input[name='customerId']").val(""), this.addressId = e.addressId, this.preFormDataObj = this.getFormDataObj() }, showAddIntellectFillContent: function () { new o({ location: this.location, callback: this.fillOrderItemInfo.bind(this), target: this.shipperType, viewOption: this.viewOption }); var e = this.shipperType; "sender" === e ? "hk" === l.getSiteLocation() ? sfgather.trackClicks("点击寄件人智能地址填写", "XWF010102") : sfgather.trackClicks("点击寄件人智能地址填写", "OWF010102") : "receiver" === e && ("hk" === l.getSiteLocation() ? sfgather.trackClicks("点击收件人智能地址填写", "XWF010202") : sfgather.trackClicks("点击收件人智能地址填写", "OWF010202")) }, fillOrderItemInfo: function (e) { this.$("input[name='contactName']").val(e.personalName), this.$("input[name='address']").val(e.site), e.mobile && this.$("input[name='contactTel']").val(e.mobile), e.telephone && this.$("input[name='contactPhone']").val(e.telephone), this.$(".intellect-warm-reminder").show() }, getInputVal: function () { return { name: this.$("input[name='contactName']").val(), company: this.$("input[name='companyName']").val(), mobile: this.$("input[name='contactTel']").val() } }, autoAddFillAddress: function (e, t) { this.fillBackInfo(t) }, getShipperData: function () { var e = _.omit(this.getFormDataObj(), "location"); return _.extend(e, { addressId: this.addressId || "", locationCode: this.addLocation.locationCode, country: "中国", countryCode: "A000086000", province: this.addLocation.province, provinceCode: this.addLocation.provinceCode, city: this.addLocation.city, cityCode: this.addLocation.cityCode, county: this.addLocation.county, countyCode: this.addLocation.countyCode, postalCode: "", longitude: "", latitude: "", setMark: this.judgeSetMark(), selfPick: this.selfPick || !1, distId: this.addLocation.countyId }) }, queryAddressRange: function () { this.notOutRange = !0; var e = this.$("[name=location]").val(), t = this.$("[name=address]").val(); if (e && t) { e = e.replace(/-/g, ""); var i = this; sfAjax.queryAddressRange({ data: { address: e + t, dataType: this.dataType }, success: function (e) { e && 710 == e.code ? i.addressOutRangeTip() : i.addressInRangeTip() }, error: function () { i.addressInRangeTip() } }) } }, judgeSetMark: function () { var e = !0; return null != this.addressId && _.isEqual(this.preFormDataObj, this.getFormDataObj()) && (e = !1), e }, showReminder: function (e) { this.$(".warm-reminder").text(e).slideDown("fast") } }) }), define("views/pages/order/innerViews/nearbyAddress", ["backbone", "templates", "helper", "sflayer", "jquery-ui"], function (e, t, n, i) { return e.View.extend({ initialize: function () { this.loadMapJs(), this.mapJsAlreadyLoad = !1 }, loadMapJs: function () { if (this.$(".network-err").hide(), this.mapJsAlreadyLoad) this.getLatitudeAndLongitude(); else { var e = this; sfAjax.getScript({ url: _cmsConfig.mapSrc, success: function () { e.mapJsAlreadyLoad = !0, e.getLatitudeAndLongitude() }, error: function () { e.networkErr() } }) } }, getLatitudeAndLongitude: function () { var t = this; AMap.plugin("AMap.Geolocation", function () { var e = new AMap.Geolocation({ enableHighAccuracy: !0, timeout: 1e4 }); e.getCurrentPosition(), AMap.event.addListener(e, "complete", t.locateSucc.bind(t)), AMap.event.addListener(e, "error", t.locateErr.bind(t)) }) }, locateErr: function () { i.msg(_l("暂无附近地址可供选择")) }, networkErr: function () { this.$(".network-err").show() }, locateSucc: function (e) { var i = this; sfAjax.getNearbyAddress({ data: { x: e.position.lng, y: e.position.lat, cc: "1", ak: _webConfig.gisKey }, success: function (e) { if (0 == e.status) { var t = _.reject(e.result.pois, function (e) { return n.isHK_MC_TW(e.regcode) || n.isInternational(e.regcode) || !e.regcode }); 0 < t.length ? i.fillPoisToDropdown(t) : i.locateErr() } else i.locateErr() }, error: function () { i.networkErr() } }) }, fillPoisToDropdown: function (e) { var i = this; i.options.targetEL.autocomplete({ minLength: 0, source: e, select: function (e, t) { return e.stopPropagation(), i.queryAddrDistIdByName(t.item), !1 } }).autocomplete("instance")._renderItem = function (e, t) { return $("<li>").append(t.name + " <span>" + t.province + t.city + t.district + "</span>").appendTo(e) }, i.options.targetEL.autocomplete("search", "").focus() }, queryAddrDistIdByName: function (t) { var i = this; sfAjax.getAddrDistIdByName({ data: { provinceName: t.province, cityName: t.city, districtName: t.district }, success: function (e) { e ? (i.options.senderLocation.setLocation(e), i.options.detailAdd.val(t.name)) : i.networkErr() }, error: function () { i.networkErr() } }) } }) }), define("views/pages/order/cn/bulkShipping/shipper/sender", ["./shipper", "../../../innerViews/nearbyAddress", "helper"], function (t, e, i) { var n = i.getSiteLocation(), a = { init: function (e) { t.prototype.init.apply(this, arguments), this.formatTel = "isTelCn", this.shipperType = "sender", this.hasNearBy = !0, this.dataType = "s01", this.hasCalc = e.hasCalc }, render: function () { t.prototype.render.apply(this, arguments), this.initSenderDefaultAddressItem() }, events: _.extend({ "click .getNearbyAddress": "showNearbyAddressDropdown", "change [name=location]": "addressInRangeTip", "input [name=address]": "addressInRangeTip" }, t.prototype.events), initSenderDefaultAddressItem: function () { var t = this; if ($.cookie("loginUser")) { var i = !1; sfAjax.fetchDefaultAndFirstAddress({ success: function (e) { e && 0 === e.code && (_.isEmpty(e.result) || (i = !0, t.judgeInfo(e.result))) }, complete: function () { if (!i) { var e = t.getAddressFromStore(); e && t.judgeInfo(e) } } }) } }, judgeInfo: function (e) { this.fillBackInfo(e) }, getAddressFromStore: function () { var t = localStorage.getItem(i.getLatestSenderKey() + $.cookie("loginUser")); try { t = JSON.parse(t) } catch (e) { t = null } return t }, showNearbyAddressDropdown: function () { this.sender_nearby_address ? this.sender_nearby_address.loadMapJs() : this.sender_nearby_address = new e({ el: this.$(".nearbyAddressWrapper"), targetEL: this.$("input[name='location']"), senderLocation: this.location, detailAdd: this.$("input[name='address']") }) }, regionModelUpdate: function (e, t) { this.addLocation = t; var i = $(".sender-wrapper").find("input[name=address]").val(); this.queryAddressRange(), this.options.locationChange(t.locationCode, t.countyCode, i, 1) }, addressOutRangeTip: function () { this.notOutRange = !1 }, addressInRangeTip: function () { this.notOutRange = !0 } }, s = { init: function (e) { t.prototype.init.apply(this, arguments), this.shipperType = "sender", this.dataType = "s01", this.hasCalc = e.hasCalc, this.hasNearBy = !1, this.allowHkMaCao = !0, this.formatTel = "isTelCnHmt" }, render: function () { t.prototype.render.apply(this, arguments), this.initSenderDefaultAddressItem(), this.$(".detail-location-input").attr("data-hide-hkmctw", "false").attr("hide-main-land", "true").attr("data-hide-area-tab", "true").attr("data-hide-tw", "true").data("max-A000810000", 5).data("max-852", 5) }, judgeInfo: function (e) { i.isHK_MC(e.locationCode) && this.fillBackInfo(e) } }; return "cn" === n ? t.extend(a) : "hk" === n ? t.extend(_.extend(a, s)) : void 0 }), define("views/pages/order/cn/bulkShipping/shipper/receiver", ["./shipper", "const", "sflayer"], function (t, n) { return t.extend({ init: function (e) { t.prototype.init.apply(this, arguments), this.formatTel = "isTelCnHmt", this.shipperType = "receiver", this.hasNearBy = !1, this.dataType = "r01", this.rDelete = e.rDelete, this.rIndex = e.rIndex, this.noHmt = e.noHmt, this.viewOption = e.viewOption }, render: function () { t.prototype.render.apply(this, arguments), !this.noHmt && this.$(".detail-location-input").attr("data-hide-hkmctw", "false").data("max-A000710000", 5).data("max-886", 5).data("max-A000810000", 5).data("max-852", 5) }, events: _.extend({ "click .delete": "deleteReceiver" }, t.prototype.events), showIndex: function (e) { null == e ? this.$(".r-index").text("") : this.$(".r-index").text("- " + (e + 1)) }, hideDelete: function () { this.$(".delete").remove() }, deleteReceiver: function () { var e = _l("您确定要删除该收件人？"), t = this, i = layer.confirm(e, { noStop: !0, btn: [_l("确定"), _l("取消")] }, function () { t.options.deleteCallback(t.cid), t.$el.slideUp("fast", function () { $(this).remove() }), layer.close(i) }, function () { layer.close(i) }) }, regionModelUpdate: function (e, t) { var i = (this.addLocation = t).locationCode; i == n.RATE_OF_TW ? this.$(".TWlicenseInput").show() : this.$(".TWlicenseInput").hide(), this.queryAddressRange(), this.options.locationChange(i, t.countyCode, t.cityCode) }, isAllNull: function () { return 0 == _.compact(_.pluck(this.$("form").serializeArray(), "value")).length }, addressOutRangeTip: function () { }, addressInRangeTip: function () { } }) }), define("views/pages/order/cn/receiver", ["./bulkShipping/shipper/receiver"], function (e) { return e.extend({ addressOutRangeTip: function () { this.$(".error-receiver-address-detail").show(), this.notOutRange = !1 }, addressInRangeTip: function () { this.$(".error-receiver-address-detail").hide(), this.notOutRange = !0 } }) }), define("utils/time", ["moment"], function (a) { return { relativeDate: function (e, t) { var i = e.clone().startOf("day"), n = t || a(); return i.isSame(n.clone().add("days", -1), "day") ? _l("昨天") : i.isSame(n, "day") ? _l("今天") : i.isSame(n.clone().add("days", 1), "day") ? _l("明天") : i.isSame(n, "week") ? _l("本") + i.format("ddd") : i.isSame(n.clone().add(7, "d"), "week") ? _l("下") + i.format("ddd") : i.isSame(n.clone().add(-7, "d"), "week") ? _l("上") + i.format("ddd") : i.diff(n, "days") + _l("天") } } }), define("components/detailDateTimePicker/pickupTimePicker", ["backbone", "templates", "moment", "utils/time", "helper"], function (e, t, o, a) { var l = "YYYY-MM-DD HH:mm", i = "YYYY-MM-DD", c = "HH:mm"; return e.View.extend({ data: { serverTime: null, dateTimes: [] }, events: { "click .date-wrapper li": "selectDate", "click .time-wrapper li.item": "selectTime", "click input": "toggle" }, initialize: function (e) { var t = this; this.$picker = $('<div class="pickup-time-picker" style="display:none"></div>'), this.$el.addClass("time-picker-pk").append(this.$picker), this.data.serverTime = (e.serverTime || o()).startOf("minutes"), e.dateTimes && this.setDateTimes(e.dateTimes), $("body").click(function (e) { $(e.target).parents(".time-picker-pk").length || t.$picker.hide() }) }, toggle: function () { this.dates.length && (this.handlerSelectedDateTime(), this.$picker.toggle()) }, selectDate: function (e) { var t = $(e.currentTarget); this.showDate = t.data("value"), this.render(), e.stopPropagation() }, selectTime: function (e) { var t = $(e.currentTarget), i = this.$("input"); this.showTime = t.data("value"), "within_an_hour" === this.showTime ? (i.val(_l("一小时内")), this.selectedDateTime = null) : (i.val(this.showDate + " " + t.text()), this.selectedDateTime = o(this.showTime)), this.$picker.hide(), i.trigger("change") }, calculateDates: function () { var n = this, e = this.data.dateTimes; this.dates = [], e && e.forEach(function (e) { var t = e.workingTime.split("-"), i = { text: a.relativeDate(o(e.date), n.data.serverTime), date: e.date, start: n.getNextHourSharp(o(e.date + " " + t[0])), end: o(e.date + " " + t[1]).startOf("hour") }; i.times = n.calculateTimes(i), n.dates.push(i) }) }, calculateTimes: function (e) { var t = [], i = o(e.date), n = this.handlerWithinOneHour(e.start, e.end); n && t.push(n); for (var a = 0; a < 24; a++) { var s = i.clone().add(a, "hour"), r = s.clone().add(1, "hour"); s >= e.start && r <= e.end && s >= this.data.serverTime && t.push({ text: s.format(c) + "~" + r.format(c), start: s.format(l) }) } return t }, handlerWithinOneHour: function (e, t) { var i = this.data.serverTime, n = this.getNextHourSharp(i); if (e < n && n < t) return { text: _l("一小时内"), start: "within_an_hour" } }, getNextHourSharp: function (e) { return e.clone().add(59, "minute").startOf("hour") }, handlerSelectedDateTime: function () { this.selectedDateTime ? (this.showDate = this.selectedDateTime.format(i), this.showTime = this.selectedDateTime.format(l)) : this.dates.length && (this.data.serverTime <= this.dates[0].start ? (this.showDate = this.dates[0].date, this.showTime = this.dates[0].times[0].start) : this.data.serverTime > this.dates[0].end.clone().add(-1, "hour") ? (this.showDate = this.dates[1].date, this.showTime = this.dates[1].times[0].start) : (this.showDate = this.data.serverTime.format(i), this.showTime = "within_an_hour")), this.render() }, getTimes: function (e) { for (var t = 0; t < this.dates.length; t++) { var i = this.dates[t]; if (i.date === e) return i.times } }, setInputValue: function (e) { e = e || this.showTime, this.showTime && "within_an_hour" !== e && void 0 !== this.data.dateTimes ? (this.$("input").val(e + "~" + o(e).add(1, "hour").format(c)), this.selectedDateTime = o(this.showTime)) : (this.$("input").val(_l("一小时内")), this.selectedDateTime = null), this.$("input").trigger("change") }, render: function () { var e = t.pickupTimePicker({ dates: this.dates, times: this.getTimes(this.showDate), showDate: this.showDate, showTime: this.showTime }); this.$picker.html(e) }, setServerTime: function (e) { return this.data.serverTime = e || o(), this.calculateDates(), this }, setDateTimes: function (e) { return this.data.dateTimes = e || [], this.calculateDates(), this.handlerSelectedDateTime(), this.setInputValue(), this }, getDateTime: function () { var e, t = this.selectedDateTime; return t ? e = { start: t.format(), finish: t.clone().add(1, "hour").format() } : null === t && (e = { start: "", finish: "" }), e } }) }), define("models/payFee", ["backbone", "helper", "utils/time", "initialSetups", "collections/detailRegions"], function (e, t, i, n, s) { var a = ["A000001000", "A000092000", "A000063000", "A000066000", "A000061000", "A000007000", "A000052000", "A000011000", "A000095000", "A000049000", "A000033000", "A000043000", "A000032000", "A000359000", "A000385000", "A000045000", "A000034000", "A000372000", "A000030000", "A000036000", "A000353000", "A000039000", "A000358000", "A000371000", "A000370000", "A000352000", "A000031000", "A000048000", "A000351000", "A000420000", "A000040000", "A000044000", "A000421000", "A000386000", "A000046000", "A000356000", "A000357000", "A000055000", "A000673000", "A000971000", "A000164000", "A000062000", "A000091000", "A000855000", "A000880000", "A000094000", "A000056000"], r = { A000066000: ["A000086000"] }, o = ["#EF7D00", "#E30413", "#FFED00", "#009440"]; return e.Model.extend({ defaults: { link: "#", isPromotion: !1 }, notContainIntro: function () { var e = this.get("intro"); return !e || 0 === e.length || 1 === e.length && "" === e[0] } }, { parse: function (e, t, i) { return this.replaceCurrencyName(e), this.appendAddtionalPayFee(e, t, i), this.appendShouldShowCargoType(e, t, i), this.roundPayFeeWeight(e), this.deliverDate(e), this.setColor(e), this.filterPrice(e, t, i), this.mergeRemoteDataWithOpenCMS(e) }, deliverDate: function (e) { return e.deliverTime && !e.internet && (e.deliverDate = i.relativeDate(moment(e.deliverTime)), e.deliverMomentTime = moment(e.deliverTime).format("HH:mm")), this }, setColor: function (e) { return e.limitTypeCode && (e.serTextColor = "white", "T104" == e.limitTypeCode ? e.serviceColor = o[0] : "T801" == e.limitTypeCode ? e.serviceColor = o[1] : "T4" == e.limitTypeCode ? (e.serviceColor = o[2], e.serTextColor = "black") : "T6" == e.limitTypeCode && (e.serviceColor = o[3])), this }, roundPayFeeWeight: function (e) { e.weight = Math.max(e.weight, .1) }, additionalPayFeeAvailableAtLocation: function (e, t, i) { var n = 0 <= _.indexOf(e.originLocations.split(","), t), a = 0 <= _.indexOf(e.destsLocations.split(","), i); return e.bothRequired ? n && a : n || a }, appendAddtionalPayFee: function (t, i, n) { var a = this; t.additionalPayFees = _.filter(window.additionalServiceList, function (e) { return !!a.additionalPayFeeAvailableAtLocation(e, i, n) && ("overdue-refund" === e.code ? -1 !== _.indexOf(e.availableService, t.limitTypeCode) : "earlier-shipping-lower-price" === e.code && 0 != t.regionFreight) }) }, mergeRemoteDataWithOpenCMS: function (t) { if ("SP636" == t.cargoTypeCode || "SP635" == t.cargoTypeCode) return t; var e = _.filter(window.serviceList, function (e) { return e.limitTypeCode == t.limitTypeCode && e.limitTypeName == t.limitTypeName }); return _.extend(t, 0 == e.length ? {} : e[0]) }, replaceCurrencyName: function (e) { return e.totalPrice = e.totalFreight, "人民币" === e.currencyName ? (e.currencyName = "", e.freight = Number(t.toFixed(e.freight + e.fuelCost, 2)) + "元", e.totalFreight = e.totalFreight + "元", e.pickupFreight = e.pickupFreight && e.pickupFreight + "元", e.transportFreight = e.transportFreight + "元", e.distributionFreight = e.distributionFreight && e.distributionFreight + "元") : e.freight = Number(t.toFixed(e.freight + e.fuelCost, 2)), "人民币" === e.destCurrencyName ? (e.destCurrencyName = "", e.destFreight = Number(t.toFixed(e.destFreight + e.destFuelCost, 2)) + "元", e.destPickupFreight = e.destPickupFreight && e.destPickupFreight + "元", e.destTransportFreight = e.destTransportFreight + "元", e.destDistributionFreight = e.destDistributionFreight && e.destDistributionFreight + "元") : e.destFreight = Number(t.toFixed(e.destFreight + e.destFuelCost, 2)), this }, appendShouldShowCargoType: function (e, t, i) { return e.shouldShowCargoType = this.shouldShowCargoType(e, t, i), this }, filterPrice: function (e, t, i) { var n = -1 !== _.indexOf(r[i], t); return -1 === _.indexOf(a, i) || n || (e.destFreight = "", e.destCurrencyName = _l("暂未开通")), this }, shouldShowCargoType: function (e, t, i) { var n = s.isChinaMainland(t), a = s.isNotAboard(i); return !(n && a) } }) }), define("collections/payFee", ["backbone", "underscore", "event", "helper", "models/payFee"], function (e, i, t, n, a) { var s = 1; return e.Collection.extend({ model: a, comparator: "order", url: function () { if ("heavyCargo" == this.rateType) { var e = "queryType=" + this.queryType + "&origin=" + this.originCode + "&dest=" + this.destCode + "&time=" + encodeURIComponent(this.time) + "&weight=" + this.weight + "&volume=" + this.volume; return n.getRESTfulDomain("rate/ratesByHeavyCargo?" + e) } if ("coldChain" == this.rateType) { e = "queryType=" + this.queryType + "&coolQueryType=1&origin=" + this.originCode + "&dest=" + this.destCode + "&time=" + encodeURIComponent(this.time) + "&weight=" + this.weight + "&volume=" + this.volume; return n.getRESTfulDomain("rate/ratesByColdTransport?" + e) } if ("toMainland" == this.rateType) { e = "origin=" + this.originCode + "&dest=" + this.destCode + "&weight=" + this.weight + "&time=" + encodeURIComponent(this.time) + "&queryType=" + this.queryType; return n.getRESTfulDomain("rate?" + e) } e = "origin=" + this.originCode + "&dest=" + this.destCode + "&weight=" + this.weight + "&time=" + encodeURIComponent(this.time) + "&volume=" + this.volume; return i.isBlank(this.queryType) || 0 == this.queryType || (e += "&queryType=" + this.queryType), n.getRESTfulDomain("rate/newRates?" + e) }, initialize: function (e) { this.rateType = "normal", this.initialPayFees = i(e), this.listenTo(t, t.RateSearch, this.rateSearch) }, withoutOutskirts: function () { return this.filter(function (e) { return "R10202" !== e.get("distanceTypeCode") }) }, withOutskirts: function () { return this.where({ distanceTypeCode: "R10202" }) }, withPromotion: function () { return this.filter(function (e) { return e.has("promotionMessage") && "" !== e.get("promotionMessage") }) }, isChinaRegion: function (e) { return "A000086000" === e || "A000820000" === e || "A000810000" === e || "A000710000" === e }, rateSearch: function (e) { if (this.rateType = e.rateType ? e.rateType : this.rateType, this.originCountryCode = e.originCountryCode || this.originCountryCode, this.destsCountryCode = e.destsCountryCode || this.destsCountryCode, this.originCode = e.originCode ? e.originCode : this.originCode, this.destCode = e.destCode ? e.destCode : this.destCode, this.time = e.time ? e.time : i.isBlank(this.time) ? moment(new Date).format() : this.time, this.queryType = e.queryType ? e.queryType : this.queryType, this.flag = !!e.flag && e.flag, this.originCode && this.destCode && this.time) { s = this.isChinaRegion(this.originCountryCode) && this.isChinaRegion(this.destsCountryCode) ? "1.0" : "0.5"; var t = $("input.weight").val(); this.flag ? this.weight = "" != t && null != t ? t : s : this.weight = isNaN(Number(e.weight)) ? s : Number(e.weight), this.volume = e.volume ? e.volume : e.height && e.length && e.width ? e.height * e.length * e.width : 0, this.checkCondition(e), this.fetchPayfee() } }, fetchPayfee: function () { var i = this; this.fetch({ beforeSend: function () { if (null != i.checkResult && !i.checkResult.canSearch) return i.trigger("outOfRange"), !1 }, error: function (e, t) { i.renderErr(t) } }) }, parse: function (e) { var t = this; return e = i.map(e, function (e) { return a.parse(e, t.originCountryCode, t.destsCountryCode) }), t.uniqueSevices(e) }, renderErr: function () { this.trigger("showDefault", { limitTypeName: "heavyCargo" == this.rateType ? _l("重货包裹") : _l("顺丰标快"), deliverTime: _l("约2-4天"), totalFreight: _l("以收派员巴枪价格为准"), limitTypeCode: "heavyCargo" == this.rateType ? "T6" : "T4", cargoTypeCode: "heavyCargo" == this.rateType ? "SP635" : "C201", expressTypeCode: "heavyCargo" == this.rateType ? "B2" : "B1", closedTime: null }) }, uniqueSevices: function (e) { return i.uniq(e, function (e) { return e.cargoTypeCode + e.limitTypeCode + e.distanceTypeCode }) }, availableAdditionalServices: function () { return i.chain(this.pluck("additionalPayFees")).flatten().union().compact().value() }, checkCondition: function (e) { var t = new Object; t.canSearch = !0, t.errs = [], this.checkResult = t } }, { setupOrderSymbol: function (e) { i.each(e, function (e, t) { e.set("orderSymbol", window.ORDER_SYMBOLS[t]) }) } }) }), define("views/pages/order/innerViews/priceAndTime", ["baseView", "templates", "event", "collections/payFee", "helper", "bus/address/index", "sflayer"], function (e, g, t, i, v, y) { return e.extend({ init: function (e) { this.collection = new i, this.listenTo(this.collection, "sync", this.renderProductTypeList), this.listenTo(this.collection, "showDefault", this.renderProductTypeDefault), this.choosedProductType = [], this.currencyCode = v.getCurrencyByCode(e.sLocationCode) }, render: function () { }, events: { "click a": "chooseProductType" }, fetchTimeAndRate: function (e) { this.bookingTime = e.time, this.loadingIndex = layer.load(0, { shade: [.2, "#000"] }), this.collection.rateSearch(e) }, renderProductTypeList: function () { layer.close(this.loadingIndex), 1 == this.options.type ? this.renderNormalProductTypeList() : 2 == this.options.type && this.renderHeavyCargoProductTypeList() }, renderNormalProductTypeList: function () { var e = this.collection.toJSON(); if ("tw" === v.getSiteLocation() && 0 === e.length) { var t = { limitTypeCode: "T4", limitTypeName: "顺丰标快", deliverTime: moment().add(2, "day").format("YYYY-MM-DD 18:00") }; y.isHK(this.options.dLocationCode) ? t.totalFreight = 100 : y.isMC(this.options.dLocationCode) ? t.totalFreight = 125 : y.isTW(this.options.dLocationCode) ? (t.totalFreight = 80, t.deliverTime = moment().add(1, "day").format("YYYY-MM-DD 18:00")) : y.isMainland(this.options.dLocationCode) && (t.totalFreight = 126), e.push(t) } _.reject(e, function (e) { return null === e.deliverTime }), _.each(e, function (e) { e.closedTime && (e.closedTime = moment(e.closedTime, "HHmm").format("HH:mm")), "Invalid date" != moment(e.deliverTime).format() && (e.deliverTime = _l("预计") + " " + moment(e.deliverTime).format("ddd HH:mm") + " " + _l("前")) }); var i, n = _.groupBy(e, "limitTypeCode"), a = _.first(n.T1 || n.T104), s = _.first(n.T8 || n.T801), r = _.first(n.T4), o = _.first(n.T6), l = moment(this.bookingTime).clone(); if (this.options.orderModel.get("firstPickedEndDateTime")) { var c = this.options.orderModel.get("firstPickedEndDateTime").clone(), d = this.options.orderModel.get("secondPickedEndDateTime").clone(), u = this.options.orderModel.get("thirdPickedEndDateTime").clone(); i = _.find([c, d, u], function (e) { return l.get("date") === e.get("date") }) } i && (a && a.closedTime && moment(i.format("YYYY-MM-DD") + " " + a.closedTime, "YYYY-MM-DD HH:mm").isAfter(i) && (a.closedTime = i.format("HH:mm")), s && s.closedTime && moment(i.format("YYYY-MM-DD") + " " + s.closedTime, "YYYY-MM-DD HH:mm").isAfter(i) && (s.closedTime = i.format("HH:mm")), r && (r.closedTime = i.format("HH:mm")), o && (o.closedTime = i.format("HH:mm"))); var h = { t1: a, t8: s, t4: r, t6: o, sendTime: l }, p = this.filterProductType(h); if (0 < p.length) { this.choosedProductType = p; var f = _.sortBy(p, function (e) { return -parseFloat(e.totalFreight) }), m = f[0]; this.$el.html(g.orderProductTypeList({ data: f, defaultProduct: m, currencyCode: this.currencyCode })), this.options.callback(m) } else this.collection.renderErr() }, renderHeavyCargoProductTypeList: function () { if (0 != this.collection.toJSON().length) { var e = this.collection.toJSON()[0]; e.closedTime && (e.closedTime = moment(e.closedTime, "HHmm").format("HH:mm")), e.deliverTime && "Invalid date" != moment(e.deliverTime).format() && (e.deliverTime = _l("预计") + " " + moment(e.deliverTime).format("ddd HH:mm") + " " + _l("前")); var t = moment(this.bookingTime).clone(); if (this.options.orderModel.get("firstPickedEndDateTime")) var i = this.options.orderModel.get("firstPickedEndDateTime").clone(), n = this.options.orderModel.get("secondPickedEndDateTime").clone(), a = this.options.orderModel.get("thirdPickedEndDateTime").clone(), s = _.find([i, n, a], function (e) { return t.get("date") === e.get("date") }); s && (e.closedTime = s.format("HH:mm")), this.choosedProductType = [e], this.$el.html(g.orderProductTypeList({ data: [e], defaultProduct: e, currencyCode: this.currencyCode })), this.options.callback(e) } else this.collection.renderErr() }, filterProductType: function (e) { var t = []; return !_.isUndefined(e.t1) && e.t1.closedTime && e.sendTime.isBefore(moment(e.t1.closedTime, "HH:mm")) && t.push(e.t1), !_.isUndefined(e.t8) && e.t8.closedTime && e.sendTime.isBefore(moment(e.t8.closedTime, "HH:mm")) && t.push(e.t8), _.isUndefined(e.t4) || "1" === e.t4.destView && "1" === e.t4.orgionView && !e.t4.deliverTime || t.push(e.t4), _.isUndefined(e.t6) || t.push(e.t6), t }, renderProductTypeDefault: function (e) { layer.close(this.loadingIndex), this.choosedProductType = [e], e.showErr = !0, this.$el.html(g.orderProductTypeList({ data: e, currencyCode: this.currencyCode })), this.options.callback(e) }, chooseProductType: function (e) { var t = this.$(e.currentTarget); this.$("a").removeClass("active"), t.addClass("active"); var i = t.data("value"), n = _.find(this.choosedProductType, function (e) { return e.limitTypeCode == i }); this.options.callback(n) } }) }), define("components/newBillOptions/cargoItems", ["baseView", "templates", "sf-validate", "sflayer"], function (e, t, i) { return e.extend({ items: [{ name: _l("文件"), icon: "document" }, { name: _l("数码产品"), icon: "camera" }, { name: _l("服饰"), icon: "clothes" }, { name: _l("食品"), icon: "food" }, { name: _l("医药类产品"), icon: "medicine" }, { name: _l("其他"), icon: "other" }], template: t.cargoItems, init: function (e) { _.each(this.items, function (e) { e.select = !1 }), this.medciIndex = 4, this.otherIndex = 5, this.choosedItem = e.choosedItem, this.choosedMedci = e.choosedMedci }, render: function () { this.judgeSelect(), this.$el.html(this.template({ list: this.items, medci: this.choosedMedci, otherItem: this.otherItem, medciIndex: this.medciIndex, otherIndex: this.otherIndex })), this.addFormValidate() }, events: { "click .sf-capsule a": "chooseItem" }, judgeSelect: function () { var e = _.compact(this.choosedItem.split(",")); "" != this.choosedMedci && e.push(this.items[this.medciIndex].name), this.otherItem = _.difference(e, _.pluck(this.items, "name")).join(), "" != this.otherItem && e.push(this.items[this.otherIndex].name), e = _.uniq(e); var i = this; _.each(e, function (t) { _.each(i.items, function (e) { e.name == t && (e.select = !0) }) }) }, chooseItem: function (e) { var t = this.$(e.currentTarget); if (3 == this.$(".sf-capsule a.active").length) { if (!t.hasClass("active")) return void layer.msg(_l("最多可选择三项")); t.removeClass("active"), this.items[t.data("index")].select = !1 } else if (1 == this.$(".sf-capsule a.active").length) { if (t.hasClass("active")) return; t.addClass("active"), this.items[t.data("index")].select = !0 } else t.toggleClass("active"), this.items[t.data("index")].select = t.hasClass("active"); t.data("index") == this.medciIndex && (t.hasClass("active") ? this.$(".medicine-content").slideDown("fast") : this.$(".medicine-content").slideUp("fast")), t.data("index") == this.otherIndex && (t.hasClass("active") ? this.$(".other-content").slideDown("fast") : this.$(".other-content").slideUp("fast")) }, addFormValidate: function () { i(this.$("form"), { rules: { medicine: { maxlength: 50 }, other: { required: !0, maxlength: 20 } } }) }, formValidate: function () { return this.$("form").validate().form() }, getFormDataObj: function () { var e = this.$("form").serializeArray(); return _.object(_.pluck(e, "name"), _.pluck(e, "value")) }, getChoosedItem: function () { var t = []; _.each(this.items, function (e) { e.select && t.push(e.name) }); var e = t.join(","); return this.items[this.otherIndex].select && (e = e.replace(this.items[this.otherIndex].name, this.getFormDataObj().other)), e }, getMedicine: function () { var e = ""; return this.items[this.medciIndex].select && (e = this.getFormDataObj().medicine), e } }) }), define("components/newBillOptions/heavyCargoItems", ["./cargoItems"], function (t) { return t.extend({ items: [{ name: _l("医药卫生"), icon: "medicine" }, { name: _l("汽车配件"), icon: "car" }, { name: _l("快消品"), icon: "fmcg" }, { name: _l("机具仪器"), icon: "mechine" }, { name: _l("化工橡塑"), icon: "chemical" }, { name: _l("服装鞋帽"), icon: "clothes" }, { name: _l("电子产品"), icon: "camera" }, { name: _l("家电"), icon: "household" }, { name: _l("家具"), icon: "furniture" }, { name: _l("其他"), icon: "other" }], init: function (e) { t.prototype.init.apply(this, arguments), this.medciIndex = 0, this.otherIndex = 9 } }) }), define("components/newBillOptions/weightAndVol", ["baseView", "templates", "sf-validate", "helper"], function (e, t, i, n) { return e.extend({ template: t.newWeightAndVol, init: function (e) { this.weight = e.weight || 20, this.quantity = e.quantity || 1, this.lwh = !1, this.length = "", this.width = "", this.height = "", void 0 === e.width ? this.volume = "" : (0 === e.width || null === e.width || (this.lwh = !0, this.length = e.length, this.width = e.width, this.height = e.height), this.volume = e.volume) }, render: function () { this.$el.html(this.template({ weight: this.weight, quantity: this.quantity, lwh: this.lwh, length: this.length, width: this.width, height: this.height, volume: this.volume / 1e6 })), this.addFormValidate() }, events: { "click .volToggle button": "toggleVol" }, toggleVol: function (e) { this.$(e.currentTarget).hasClass("active") || (this.$(e.currentTarget).addClass("active").siblings().removeClass("active"), this.$(e.currentTarget).hasClass("lwh") ? (this.lwh = !0, this.$(".l-w-h").show(), this.$(".cubic-meter-wrapper").hide()) : (this.lwh = !1, this.$(".l-w-h").hide(), this.$(".cubic-meter-wrapper").show())) }, addFormValidate: function () { i(this.$("form"), { rules: { weight: { required: !0, number: !0, min: 20, max: 9999 }, piece: { required: !0, digits: !0, min: 1, max: 9999 }, "cubic-meter": { number: !0, min: 0, max: 9999 }, length: { digits: !0, range: [1, 999999] }, width: { digits: !0, range: [1, 999999] }, height: { digits: !0, range: [1, 999999] } }, messages: { weight: { required: _l("快件重量不能为空"), number: _l("请输入有效的快件重量，最大9999"), min: _l("包裹总重量不能低于20kg"), max: _l("请输入有效的快件重量，最大9999") }, piece: { required: _l("快件件数不能为空"), min: _l("包裹总件数不能低于1"), max: _l("请输入有效的快件件数，最大9999") }, "cubic-meter": _l("请输入有效的快件体积，最大9999") } }) }, formValidate: function () { return this.$("form").validate().form() }, getRateVolume: function () { return this.lwh ? n.toFixed(this.$(".v-length").val() * this.$(".v-width").val() * this.$(".v-height").val(), 2) : 1e6 * n.toFixed(this.$(".cubic-meter").val(), 2) }, getData: function () { var e, t = { weight: n.toFixed(this.$(".weight").val(), 2), quantity: this.$(".piece").val(), volume: 1e6 * n.toFixed(this.$(".cubic-meter").val(), 2) }; return e = "" == this.$(".v-length").val() || "" == this.$(".v-width").val() || "" == this.$(".v-height").val() ? { length: 0, width: 0, height: 0 } : { length: n.toFixed(this.$(".v-length").val(), 2), width: n.toFixed(this.$(".v-width").val(), 2), height: n.toFixed(this.$(".v-height").val(), 2) }, _.extend(t, e) } }) }), define("components/newBillOptions/itemsWeightAndVol", ["baseView", "templates", "./heavyCargoItems", "./weightAndVol"], function (e, t, i, n) { return e.extend({ layerOpts: { title: _l("托寄物信息"), area: "680px", skin: "line" }, template: t.itemsWeightAndVol, render: function () { this.$el.html(this.template()), this.receiverItems = new i({ el: this.$(".receiver-items-wrapper"), choosedItem: this.options.choosedItem, choosedMedci: this.options.choosedMedci }), this.weightAndVolView = new n({ el: this.$(".weight-vol-wrapper"), weight: this.options.weight, length: this.options.length, width: this.options.width, height: this.options.height, volume: this.options.volume, quantity: this.options.quantity }) }, events: { "click .save": "save" }, save: function () { if (this.receiverItems.formValidate() && this.weightAndVolView.formValidate()) { var e = { items: this.receiverItems.getChoosedItem(), medci: this.receiverItems.getMedicine(), rateVolume: this.weightAndVolView.getRateVolume() }; this.options.callback(_.extend(e, this.weightAndVolView.getData())), this.close() } } }) }), define("components/newBillOptions/cargoPayType", ["baseView", "templates", "sf-validate", "sflayer"], function (e, t, i) { return e.extend({ types: [1, 4, 2], layerOpts: { title: _l("付款方式"), area: ["680px", "268px"], skin: "line" }, template: t.cargoPayType, init: function (e) { this.types = e.types || this.types, this.chooseType = e.chooseType, this.monthAccount = e.monthAccount }, render: function () { this.$el.html(this.template({ types: this.types, chooseType: this.chooseType, monthAccount: this.monthAccount })), this.addFormValidate() }, events: { "click .sf-capsule a": "choosePayType", "click .save": "save" }, choosePayType: function (e) { var t = this.$(e.currentTarget); if (this.chooseType = this.$(t).data("type"), this.options.whetherCollect && 4 != this.chooseType) return layer.alert(_l("代收货款暂时只支持寄付月结付款")), !1; this.$(".sf-capsule a").removeClass("active"), this.$(t).addClass("active"), 4 == this.chooseType ? this.$(".month-account").slideDown("fast") : this.$(".month-account").slideUp("fast") }, addFormValidate: function () { i(this.$("form"), { rules: { account: { required: !0, regex: "isMonthlyCardNo" } }, messages: { account: { required: _l("未填写月结账号"), regex: _l("月结账号无效") } } }) }, save: function (e) { if (4 == this.chooseType) { if (this.$("form").validate().form()) { var t = this.$('[name="account"]').val(); if (this.isLocked(e)) return; var i = this; sfAjax.checkMonthAccount({ data: { account: t }, success: function (e) { e.code && 654 == e.code ? layer.msg(_l("月结账号无效")) : (i.monthAccount = t, i.goBack()) }, error: function () { i.monthAccount = t, i.goBack() }, complete: function () { i.unlock(e) } }) } } else this.monthAccount = "", this.goBack() }, goBack: function () { this.options.callback({ chooseType: this.chooseType, monthAccount: this.monthAccount }), this.close() } }) }), define("components/newBillOptions/cargoService/internation", [], function () { return { hk: { signedBackFee: 10, items: [{ index: 0, name: _l("不需要"), icon: "bs-refused" }, { index: 1, name: _l("签名"), icon: "sign" }, { index: 2, name: _l("盖章"), icon: "stamp" }, { index: 3, name: _l("登记身份证"), icon: "id-card" }, { index: 4, name: _l("收取派件存根"), icon: "id-card-copy" }] } } }), define("components/newBillOptions/cargoService/index", ["baseView", "templates", "sf-validate", "helper", "bus/index", "./internation", "sflayer"], function (e, r, t, i, n, a) { return e.extend({ internation: a, signedBackFee: 5, items: [{ index: 0, name: _l("不需要"), icon: "bs-refused" }, { index: 1, name: _l("签名"), icon: "sign" }, { index: 2, name: _l("盖章"), icon: "stamp" }, { index: 3, name: _l("登记身份证"), icon: "id-card" }, { index: 4, name: _l("身份证复印件"), icon: "id-card-copy" }], layerOpts: { title: _l("增值服务"), area: "680px", skin: "line" }, template: r.cargoService, init: function (e) { if (this.initSignedBackTip(), _.each(this.items, function (e) { e.select = !1 }), "" == e.signedBackBillIndex) this.items[0].select = !0, this.signedBackBillIndexArr = null; else { this.signedBackBillIndexArr = e.signedBackBillIndex.split(","); var i = this; _.each(this.items, function (t) { _.each(i.signedBackBillIndexArr, function (e) { e == t.index && (t.select = !0) }) }) } this.codAmt = e.codAmt, this.codCustid = e.codCustid }, initSignedBackTip: function () { var e = _l("提示：签单返还需收取${fee}${currency}增值服务费"); this.signedBackTip = e._p({ fee: this.signedBackFee, currency: n.getRevealCurrency() }) }, render: function () { this.$el.html(this.template({ hasSignedBack: n.hasSignedBack(), hasCod: n.hasCod(), list: this.items, signedBackTip: this.signedBackTip, codAmt: this.codAmt, codCustid: this.codCustid })), this.addFormValidate() }, events: { "click .signed-back a": "chooseService", "click .cod a": "chooseCod", "click .save": "save" }, chooseService: function (e) { var t = this.$(e.currentTarget); if (0 == this.$(t).data("index")) this.$(".signed-back a").removeClass("active"), this.$(t).addClass("active"), this.signedBackBillIndexArr = null; else { this.$('.signed-back a[data-index="0"]').removeClass("active"), this.$(t).toggleClass("active"); var i = []; _.each(this.$(".signed-back a"), function (e) { $(e).hasClass("active") && i.push($(e).data("index")) }), this.signedBackBillIndexArr = i } }, chooseCod: function (e) { this.$(".cod a").removeClass("active"), this.$(e.currentTarget).addClass("active"), this.$(".need").hasClass("active") ? this.$("form").slideDown("fast") : this.$("form").slideUp("fast") }, addFormValidate: function () { t(this.$("form"), { rules: { customerCode: { required: !0, digits: !0, maxlength: 10 }, amount: { required: !0, number: !0, rangeMargin: [0, 1e7] } }, messages: { customerCode: { required: _l("信息填写不完整") }, amount: { required: _l("信息填写不完整") } } }) }, getFormDataObj: function () { var e = this.$("form").serializeArray(); return _.object(_.pluck(e, "name"), _.pluck(e, "value")) }, save: function () { var i, n; if (null === this.signedBackBillIndexArr || 0 == this.signedBackBillIndexArr.length) n = i = ""; else { var a = [], s = this; _.each(this.items, function (t) { _.each(s.signedBackBillIndexArr, function (e) { e == t.index && a.push(t.name) }) }), i = this.signedBackBillIndexArr.join(","), n = a.join(",") } if (this.$(".need").hasClass("active")) { if (this.$("form").validate().form()) { s = this; sfAjax.verifyCodAccount({ data: this.getFormDataObj(), success: function (t) { 0 === t.code ? layer.open({ closeBtn: 0, title: "", area: "450px", content: r.confirmCodInfo({ customerCode: t.result.customerCode, customerName: t.result.customerName }), btn: [_l("确认无误"), _l("重新填写")], btn1: function (e) { layer.close(e), s.close(), s.options.callback(_.extend({ signedBackBillIndex: i, signedBackBillName: n, isScatterCod: t.result.isScatterCod }, s.getFormDataObj())) }, btn2: function (e) { layer.close(e) } }) : 655 === t.code ? layer.msg(_l("金额超过上限，请重新输入")) : 656 === t.code ? layer.msg(_l("卡号不正确，请重新输入")) : layer.msg(_l("网络异常，暂无法支持该服务")) }, error: function () { layer.msg(_l("网络异常，暂无法支持该服务")) } }) } } else this.options.callback({ signedBackBillIndex: i, signedBackBillName: n }), this.close() } }) }), define("components/newBillOptions/cargoInsure", ["baseView", "templates", "sf-validate", "helper", "const", "sflayer"], function (e, t, n, i, a) { var s = i.getSiteLocation(), r = { notSelectTip: "温馨提示：您当前未选择保价服务，若在寄递过程中发生丢损，您最高可获得${times}倍运费的赔偿。", exceedTip: "声明价值最高上限为50万元，如货物价值大于50万，请咨询上门收件员或95338。", maxP: 5e5, layerOpts: { title: _l("保价服务"), area: "680px", skin: "line" }, template: t.cargoInsure, init: function (e) { this.notSelectTip = this.notSelectTip._p({ times: e.times }), this.supportVal = e.supportVal, this.supportPrise = e.supportPrise, this.showNotSelectTip = 0 == this.supportVal }, render: function () { this.$el.html(this.template({ notSelectTip: _l(this.notSelectTip), exceedTip: _l(this.exceedTip), supportVal: this.supportVal, supportPrise: this.supportPrise, showNotSelectTip: this.showNotSelectTip, showSelectTip: !this.showNotSelectTip, imgUrl: i.getResourceURL("images/billOptions/cargoInsure.png"), currencyCode: this.options.currencyCode || a.CUR_CN })), this.addFormValidate() }, events: { "click .save": "save" }, showSelect: function () { var e = this; this.$(".not-select").fadeOut("fast", function () { e.$(".select").fadeIn("fast") }) }, addFormValidate: function () { var i = this; n(this.$("form"), { onkeyup: function (e) { if (i.formValidate()) { var t = i.$(e).val(); "0" === t || "" === t ? (i.$(".select").fadeOut("fast", function () { i.$(".not-select").fadeIn() }), i.$(".supportPrise").text(""), i.$(".bottom-tip").slideUp("fast")) : (t > i.maxP ? i.$(".bottom-tip").slideDown("fast") : (i.$(".bottom-tip").slideUp("fast"), i.$(".supportPrise").text(i.calcSupportPrise(t)), i.$(".select .number").text(t)), i.showSelect()) } }, rules: { supportVal: { digits: !0 } } }) }, calcSupportPrise: function (e) { return 1e3 < e && e <= this.maxP ? i.toFixed(.005 * e, 0) : 500 < e && e <= 1e3 ? 2 : 0 < e && e <= 500 ? 1 : 0 }, formValidate: function () { return this.$("form").validate().form() }, save: function () { var e = this.$('[name="supportVal"]').val(); "" === e && (e = 0), this.formValidate() && e <= this.maxP && (this.options.callback({ supportVal: e, supportPrise: this.calcSupportPrise(e) }), this.close()) } }, o = { notSelectTip: "温馨提示：您当前未选择保价服务，若在寄递过程中发生丢损，将按照运单条款及细则的规定赔偿。", exceedTip: "声明价值最高上限为100万港币，如货物价值大于100万港币，请咨询上门收件员或95338。", maxP: 1e6, calcSupportPrise: function (e) { var t = this.options.sLocationCode == this.options.rLocationCode; return 2e3 < e && e <= this.maxP ? i.toFixed(.006 * e, 0) : 1e3 < e && e <= 2e3 ? t ? 8 : 11 : 0 < e && e <= 1e3 ? t ? 5 : 7 : 0 } }, l = { notSelectTip: "温馨提示：您当前未选择保价服务，若在寄递过程中发生丢损，将按照运单条款及细则的规定赔偿。", exceedTip: "保价金额不能超过400万新台币，如有需要可致电客服0800-088-830。", maxP: 4e6, calcSupportPrise: function (e) { return e <= 6e3 && 0 < e ? 10 : 6e3 < e && e <= this.maxP ? i.toFixed(.005 * e, 0) < 40 ? 40 : i.toFixed(.005 * e, 0) : 0 } }; return "cn" === s ? e.extend(r) : "hk" === s ? e.extend(_.extend(r, o)) : "tw" === s ? e.extend(_.extend(r, l)) : void 0 }), define("views/pages/order/cn/billInfoCommon", ["baseView", "templates", "components/newBillOptions/itemsWeightAndVol", "components/newBillOptions/cargoPayType", "components/newBillOptions/cargoService/index", "components/newBillOptions/cargoInsure", "helper"], function (e, t, i, n, a, s, r) { return e.extend({ template: t.billInfoCommon, init: function () { this.payType = 1, this.supportPrise = 0, this.supportVal = 0, this.selfPick = !1, this.insureTimes = 7, this.hasCargoItems = !0, this.hasMsg = !1, this.hasDeclareItems = !1, this.hasTaxPayType = !1, this.hasCargoService = !0, this.hasOnlyWeight = !1, this.hasDeclareType = !1 }, render: function () { this.$el.html(this.template({ hasMsg: this.hasMsg, hasCargoItems: this.hasCargoItems, hasDeclareItems: this.hasDeclareItems, hasTaxPayType: this.hasTaxPayType, hasCargoService: this.hasCargoService, hasOnlyWeight: this.hasOnlyWeight, hasDeclareType: this.hasDeclareType, payType: this.payType })), this.setElement(this.$(".bill-options-list")) }, events: { "click .cargo-pay-type": "popCargoPayType", "click .cargo-self-pick": "selfPickToggle" }, popCargoPayType: function () { var t = this; new n({ chooseType: this.payType, monthAccount: this.monthAccount, callback: function (e) { t.payType = e.chooseType, t.monthAccount = e.monthAccount, t.showPayType() } }) }, showPayType: function () { this.$(".pay-type-show").text(_l(r.getPayType(this.payType))) }, popCargoService: function () { var t = this; new a({ signedBackBillIndex: this.signedBackBillIndex, codAmt: this.codAmt, codCustid: this.codCustid, callback: function (e) { t.signedBackBillIndex = e.signedBackBillIndex, t.signedBackBillName = e.signedBackBillName, void 0 === e.customerCode ? (t.codAmt = "", t.codCustid = "", t.codType = null) : (t.codAmt = e.amount, t.codCustid = e.customerCode, t.codType = e.isScatterCod), t.showService(), t.options.changePredictPrice() } }) }, showService: function () { var e = this.signedBackBillIndex ? this.signedBackBillName : this.codCustid ? _l("代收货款") : _l("无增值服务"); this.$(".servive-show").text(e) }, popCargoInsure: function () { var t = this; new s({ supportPrise: this.supportPrise, supportVal: this.supportVal, times: this.insureTimes, callback: function (e) { t.supportPrise = e.supportPrise, t.supportVal = e.supportVal, t.showInsure(), t.options.changePredictPrice() } }) }, unitChange: function (e) { return "sc" == r.getSiteLanguage() ? e + "元" : "RMB" + e }, showInsure: function () { this.$(".cargo-insure-show").text(this.supportVal ? _l("保价") + this.unitChange(this.supportVal) : _l("未选择保价")), this.$(".cargo-insure-price-show").text(this.supportVal ? _l("保费") + this.unitChange(this.supportPrise) : "") }, selfPickToggle: function (e) { this.$(e.currentTarget).toggleClass("active"), this.$(e.currentTarget).hasClass("active") ? this.selfPick = !0 : this.selfPick = !1, this.showSelfPick() }, showSelfPick: function () { this.$(".self-pick-show").text(this.selfPick ? _l("自取") : _l("不自取")) } }) }), define("components/newBillOptions/cargoMsg", ["baseView", "templates", "sf-validate", "sflayer"], function (e, t, i) { return e.extend({ msgArr: [_l("带文件封"), _l("带包装袋"), _l("带防水袋"), _l("带纸箱"), _l("要爬楼"), _l("上门前请先联系"), _l("如收方住宅偏远，附加费由寄方支付"), _l("其他")], layerOpts: { title: _l("备注信息"), area: "680px", skin: "line" }, template: t.cargoMsg, init: function (i) { this.initMsgArr = _.filter(this.msgArr, function (e, t) { return _.contains(i.initMsgsIndex, t) }), this.choosedMsg = i.choosedMsg }, render: function () { var e = _.compact(this.choosedMsg.split(",")), t = _.difference(e, this.initMsgArr).join(); this.$el.html(this.template({ initMsgArr: this.initMsgArr, choosedMsgArr: e, otherMsg: t })), this.addFormValidate() }, events: { "click .sf-capsule a": "chooseMsg", "click .save": "save" }, addFormValidate: function () { i(this.$("form"), { rules: { msg: { maxlength: 20 } }, messages: { msg: { maxlength: _l("其他捎话最多可输入20个字符") } } }) }, chooseMsg: function (e) { var t = this.$(e.currentTarget); if (3 == this.$(".sf-capsule a.active").length) { if (!t.hasClass("active")) return void layer.msg(_l("最多可选择三项")); t.removeClass("active") } else t.toggleClass("active") }, save: function () { var t = []; this.$("form").validate().form() && (_.each(this.$(".sf-capsule a.active"), function (e) { t.push($(e).text()) }), t.push(this.$('[name="msg"]').val()), this.options.callback({ msg: _.compact(t).join(",") }), this.close()) } }) }), define("views/pages/order/cn/heavyCargo/heavyCargoBillInfo", ["../billInfoCommon", "templates", "components/newBillOptions/itemsWeightAndVol", "components/newBillOptions/cargoMsg"], function (e, t, i, n) { return e.extend({ init: function () { e.prototype.init.apply(this, arguments), this.cargoItems = "", this.cargoMedci = "", this.cargoWeight = 20, this.volume = "", this.quantity = 1, this.length = "", this.width = "", this.height = "", this.monthAccount = this.options.monthAccount || "", this.payType = this.options.monthAccount ? 4 : 1, this.signedBackBillIndex = "", this.signedBackBillName = "", this.codAmt = "", this.codCustid = "", this.codType = null, this.insureTimes = 5, this.msgsIndex = [3, 4, 5], this.choosedMsg = "", this.hasMsg = !0 }, events: _.extend({ "click .items-weight": "popItemsAndWeight", "click .cargo-service": "popCargoService", "click .cargo-insure": "popCargoInsure", "click .cargo-msg": "popCargoMsgView" }, e.prototype.events), popItemsAndWeight: function () { var t = this; new i({ choosedItem: this.cargoItems, choosedMedci: this.cargoMedci, weight: this.cargoWeight, volume: this.volume, quantity: this.quantity, length: this.length, width: this.width, height: this.height, callback: function (e) { t.cargoItems = e.items, t.cargoMedci = e.medci, t.cargoWeight = e.weight, t.volume = e.volume, t.quantity = e.quantity, t.length = e.length, t.width = e.width, t.height = e.height, t.rateVolume = e.rateVolume, t.showItemsAndWeight(), t.options.fetchPriceAndTimes() } }) }, showItemsAndWeight: function () { this.$(".items-show").text(this.cargoItems), this.$(".weight-show").text(this.cargoWeight + "kg") }, popCargoMsgView: function () { var t = this; new n({ initMsgsIndex: this.msgsIndex, choosedMsg: this.choosedMsg, callback: function (e) { t.choosedMsg = e.msg, t.showMsg() } }) }, showMsg: function () { this.$(".cargo-msg-show").text(this.choosedMsg || _l("无")) } }) }), define("views/pages/order/cn/heavyCargo/heavyCargo", ["../orderCommon", "templates", "helper", "../bulkShipping/shipper/sender", "../receiver", "components/detailDateTimePicker/pickupTimePicker", "../../innerViews/priceAndTime", "./heavyCargoBillInfo", "bus/index", "sflayer"], function (e, t, i, n, a, s, r, o, l) { return e.extend({ template: t.heavyCargo, init: function (e) { this.cityWorkingTime = e.cityWorkingTime, this.medciName = _l("医药卫生"), this.ratePrice = null, this.saveAddressBook = !0, this.resetPeakControlInfo() }, render: function () { this.$el.html(this.template({ imgUrl: i.getResourceURL("images/order/heavyCargo_") + i.getSiteLanguage() + ".png" })), this.sender = new n({ el: this.$(".sender-wrapper"), hasCalc: !0, locationChange: this.senderLocationChange.bind(this) }), this.receiver = new a({ el: this.$(".receiver-wrapper"), noHmt: !0, viewOption: "heavyCargo", locationChange: this.receiverLocationChange.bind(this) }), this.pickupTimePicker = new s({ el: this.$(".pickup-time") }), this.priceAndTime = new r({ el: this.$(".product-type-wrapper"), orderModel: this.cityWorkingTime, callback: this.resetDefaultProduct.bind(this), type: 2 }), this.otherBillInfo = new o({ el: this.$(".bill-options-list-wrapper"), monthAccount: this.options.monthAccount, fetchPriceAndTimes: this.fetchPriceAndTimes.bind(this), changePredictPrice: this.changePredictPrice.bind(this) }), this.setElement(this.$(".heavy-cargo-wrapper")) }, events: _.extend({ "change #date": "onSelectDateChange" }, e.prototype.events), resetDefaultProduct: function (e) { this.limitTypeCode = e.limitTypeCode, this.cargoTypeCode = e.cargoTypeCode, this.expressTypeCode = e.expressTypeCode, this.productName = e.limitTypeName, this.$(".submit-order").removeClass("disabled"); var t = parseFloat(e.totalFreight); isNaN(t) ? this.ratePrice = null : this.ratePrice = t, this.changePredictPrice(), this.getWarmReminder() }, getProductTypeValue: function (e) { return "SP636" == e ? "SE0101" : "SE0100" }, receiverLocationChange: function (e, t) { this.receiverLocationRateCode = e, this.receiverLocationCountyCode = t, this.fetchPriceAndTimes(), this.getWarmReminder(), this.receiver.queryAddressRange(), this.toggleSelfPick(), l.setRLocationCode(e) }, onSelectDateChange: function () { this.receiverLocationCountyCode && this.fetchPriceAndTimes() }, fetchPriceAndTimes: function () { if (this.senderLocationCountyCode && this.receiverLocationCountyCode) { var e = { originCode: this.senderLocationCountyCode, destCode: this.receiverLocationCountyCode, time: this.getBookingTime(), weight: this.otherBillInfo.cargoWeight, volume: this.otherBillInfo.rateVolume || 0, queryType: "1", rateType: "heavyCargo" }; this.priceAndTime.fetchTimeAndRate(e), this.$(".product-type-content").slideDown("fast"), this.$(".other-info-wrapper").slideDown("fast") } }, changePredictPrice: function () { var e, t = "" === this.otherBillInfo.signedBackBillIndex ? 0 : 5; null === this.ratePrice ? (e = "--", this.metaPrice = 0) : (e = this.ratePrice + this.otherBillInfo.supportPrise + t, this.metaPrice = e), this.$(".predict-money").text(e) }, validateOthers: function () { if ("" !== this.otherBillInfo.cargoItems) { var e = !1; (this.otherBillInfo.cargoMedci || _.contains(this.otherBillInfo.cargoItems.split(","), this.medciName)) && (e = !0), e && this.otherBillInfo.selfPick ? layer.alert(_l("医药类产品不能选择自取服务")) : 1 != this.otherBillInfo.codType || 2 != this.otherBillInfo.payType ? this.queryPeakControl() : layer.alert(_l("非月结客户的代收货款服务暂不支持“到付”")) } else layer.alert(_l("未选择托寄物")) }, getSubmitPostData: function () { var e = this.pickupTimePicker.getDateTime(); return { expectStartTm: e.start && moment(e.start).format("YYYY-MM-DD HH:mm:ss"), expectFinishTm: e.finish && moment(e.finish).format("YYYY-MM-DD HH:mm:ss"), originateAddress: _.omit(this.sender.getShipperData(), "setMark", "selfPick"), destinationInfo: [{ destinationAddress: _.omit(this.receiver.getShipperData(), "setMark", "selfPick"), remark: this.otherBillInfo.choosedMsg, productCode: this.getProductTypeValue(this.cargoTypeCode), productName: this.productName.substring(0, 20), metaWeight: this.otherBillInfo.cargoWeight, metaPrice: this.metaPrice, cargoList: [{ name: this.otherBillInfo.cargoItems.substring(0, 10), uom: "", desc: this.otherBillInfo.cargoMedci, price: "0", quantity: this.otherBillInfo.quantity, length: this.otherBillInfo.length, width: this.otherBillInfo.width, height: this.otherBillInfo.height, volume: this.otherBillInfo.volume }], custom: null, paymethod: this.otherBillInfo.payType, custid: this.otherBillInfo.monthAccount, supportValue: this.otherBillInfo.supportVal, premium: this.otherBillInfo.supportPrise, controlStrategy: this.controlStrategy, notificationMsg: this.notificationMsg, signedBackFlg: "" === this.otherBillInfo.signedBackBillIndex ? "0" : "1", signedBackSop: this.otherBillInfo.signedBackBillIndex, signedBackName: this.otherBillInfo.signedBackBillName, codAmt: this.otherBillInfo.codAmt, codCustid: this.otherBillInfo.codCustid, selfPickUpFlag: this.otherBillInfo.selfPick }] } }, submitOrder: function () { this.submitLoadIndex = layer.load(0, { shade: [.2, "#000"] }), this.waybillNo = null, sfAjax.submitNewOrder(this.getAjaxFuncData()) } }) }), define("utils/checkUtils", [], function () { return { billNumber: function (e) { return /^\d{12}$|^SF\d{13}$/.test(e.trim()) }, billNumbers: function (e) { var t = this, i = !0; return _.each(e, function (e) { e.length && !t.billNumber(e) && (i = !1) }), i } } }), function (i) { "use strict"; var I = i.setTimeout, D = i.clearTimeout, P = i.XMLHttpRequest, j = i.XDomainRequest, t = i.EventSource, n = i.document, d = i.Promise, u = i.fetch, e = i.Response, h = i.TextDecoder, a = i.TextEncoder, p = i.AbortController; if (null == Object.create && (Object.create = function (e) { function t() { } return t.prototype = e, new t }), null != d && null == d.prototype.finally && (d.prototype.finally = function (t) { return this.then(function (e) { return d.resolve(t()).then(function () { return e }) }, function (e) { return d.resolve(t()).then(function () { throw e }) }) }), null != u) { var s = u; u = function (e, t) { return d.resolve(s(e, t)) } } function r() { this.bitsNeeded = 0, this.codePoint = 0 } null == p && (p = function () { this.signal = null, this.abort = function () { } }), r.prototype.decode = function (e) { function t(e, t, i) { if (1 === i) return 128 >> t <= e && e << t <= 2047; if (2 === i) return 2048 >> t <= e && e << t <= 55295 || 57344 >> t <= e && e << t <= 65535; if (3 === i) return 65536 >> t <= e && e << t <= 1114111; throw new Error } function i(e, t) { if (6 === e) return 15 < t >> 6 ? 3 : 31 < t ? 2 : 1; if (12 === e) return 15 < t ? 3 : 2; if (18 === e) return 3; throw new Error } for (var n = "", a = this.bitsNeeded, s = this.codePoint, r = 0; r < e.length; r += 1) { var o = e[r]; 0 !== a && (o < 128 || 191 < o || !t(s << 6 | 63 & o, a - 6, i(a, s))) && (a = 0, s = 65533, n += String.fromCharCode(s)), 0 === a ? (0 <= o && o <= 127 ? (a = 0, s = o) : 192 <= o && o <= 223 ? (a = 6, s = 31 & o) : 224 <= o && o <= 239 ? (a = 12, s = 15 & o) : 240 <= o && o <= 247 ? (a = 18, s = 7 & o) : (a = 0, s = 65533), 0 === a || t(s, a, i(a, s)) || (a = 0, s = 65533)) : (a -= 6, s = s << 6 | 63 & o), 0 === a && (s <= 65535 ? n += String.fromCharCode(s) : (n += String.fromCharCode(55296 + (s - 65535 - 1 >> 10)), n += String.fromCharCode(56320 + (s - 65535 - 1 & 1023)))) } return this.bitsNeeded = a, this.codePoint = s, n }; null != h && null != a && function () { try { return "test" === (new h).decode((new a).encode("test"), { stream: !0 }) } catch (e) { } return !1 }() || (h = r); var f = function () { }; function L(e) { this.withCredentials = !1, this.responseType = "", this.readyState = 0, this.status = 0, this.statusText = "", this.responseText = "", this.onprogress = f, this.onreadystatechange = f, this._contentType = "", this._xhr = e, this._sendTimeout = 0, this._abort = f } function o(e) { return e.replace(/[A-Z]/g, function (e) { return String.fromCharCode(e.charCodeAt(0) + 32) }) } function c(e) { for (var t = Object.create(null), i = e.split("\r\n"), n = 0; n < i.length; n += 1) { var a = i[n].split(": "), s = a.shift(), r = a.join(": "); t[o(s)] = r } this._map = t } function M() { } function m(e) { this._headers = e } function R() { } function l() { this._listeners = Object.create(null) } function O(e) { I(function () { throw e }, 0) } function E(e) { this.type = e, this.target = void 0 } function N(e, t) { E.call(this, e), this.data = t.data, this.lastEventId = t.lastEventId } function B(e, t) { E.call(this, e), this.status = t.status, this.statusText = t.statusText, this.headers = t.headers } L.prototype.open = function (e, t) { this._abort(!0); var a = this, s = this._xhr, r = 1, i = 0; this._abort = function (e) { 0 !== a._sendTimeout && (D(a._sendTimeout), a._sendTimeout = 0), 1 !== r && 2 !== r && 3 !== r || (r = 4, s.onload = f, s.onerror = f, s.onabort = f, s.onprogress = f, s.onreadystatechange = f, s.abort(), 0 !== i && (D(i), i = 0), e || (a.readyState = 4, a.onreadystatechange())), r = 0 }; var n = function () { if (1 === r) { var t = 0, i = "", n = void 0; if ("contentType" in s) t = 200, i = "OK", n = s.contentType; else try { t = s.status, i = s.statusText, n = s.getResponseHeader("Content-Type") } catch (e) { i = "", n = void (t = 0) } 0 !== t && (r = 2, a.readyState = 2, a.status = t, a.statusText = i, a._contentType = n, a.onreadystatechange()) } }, o = function () { if (n(), 2 === r || 3 === r) { r = 3; var e = ""; try { e = s.responseText } catch (e) { } a.readyState = 3, a.responseText = e, a.onprogress() } }, l = function () { o(), 1 !== r && 2 !== r && 3 !== r || (r = 4, 0 !== i && (D(i), i = 0), a.readyState = 4, a.onreadystatechange()) }, c = function () { i = I(function () { c() }, 500), 3 === s.readyState && o() }; s.onload = l, s.onerror = l, s.onabort = l, "sendAsBinary" in P.prototype || "mozAnon" in P.prototype || (s.onprogress = o), s.onreadystatechange = function () { null != s && (4 === s.readyState ? l() : 3 === s.readyState ? o() : 2 === s.readyState && n()) }, "contentType" in s && (t += (-1 === t.indexOf("?") ? "?" : "&") + "padding=true"), s.open(e, t, !0), "readyState" in s && (i = I(function () { c() }, 0)) }, L.prototype.abort = function () { this._abort(!1) }, L.prototype.getResponseHeader = function (e) { return this._contentType }, L.prototype.setRequestHeader = function (e, t) { var i = this._xhr; "setRequestHeader" in i && i.setRequestHeader(e, t) }, L.prototype.getAllResponseHeaders = function () { return null != this._xhr.getAllResponseHeaders ? this._xhr.getAllResponseHeaders() : "" }, L.prototype.send = function () { if ("ontimeout" in P.prototype || null == n || null == n.readyState || "complete" === n.readyState) { var e = this._xhr; e.withCredentials = this.withCredentials, e.responseType = this.responseType; try { e.send(void 0) } catch (e) { throw e } } else { var t = this; t._sendTimeout = I(function () { t._sendTimeout = 0, t.send() }, 4) } }, c.prototype.get = function (e) { return this._map[o(e)] }, M.prototype.open = function (a, s, t, r, e, i, n) { a.open("GET", e); var o = 0; for (var l in a.onprogress = function () { var e = a.responseText.slice(o); o += e.length, t(e) }, a.onreadystatechange = function () { if (2 === a.readyState) { var e = a.status, t = a.statusText, i = a.getResponseHeader("Content-Type"), n = a.getAllResponseHeaders(); s(e, t, i, new c(n), function () { a.abort() }) } else 4 === a.readyState && r() }, a.withCredentials = i, a.responseType = "text", n) Object.prototype.hasOwnProperty.call(n, l) && a.setRequestHeader(l, n[l]); a.send() }, m.prototype.get = function (e) { return this._headers.get(e) }, R.prototype.open = function (e, t, s, i, n, a, r) { var o = new p, l = o.signal, c = new h; u(n, { headers: r, credentials: a ? "include" : "same-origin", signal: l, cache: "no-store" }).then(function (e) { var a = e.body.getReader(); return t(e.status, e.statusText, e.headers.get("Content-Type"), new m(e.headers), function () { o.abort(), a.cancel() }), new d(function (i, t) { var n = function () { a.read().then(function (e) { if (e.done) i(void 0); else { var t = c.decode(e.value, { stream: !0 }); s(t), n() } }).catch(function (e) { t(e) }) }; n() }) }).finally(function () { i() }) }, l.prototype.dispatchEvent = function (e) { var t = (e.target = this)._listeners[e.type]; if (null != t) for (var i = t.length, n = 0; n < i; n += 1) { var a = t[n]; try { "function" == typeof a.handleEvent ? a.handleEvent(e) : a.call(this, e) } catch (e) { O(e) } } }, l.prototype.addEventListener = function (e, t) { e = String(e); var i = this._listeners, n = i[e]; null == n && (n = [], i[e] = n); for (var a = !1, s = 0; s < n.length; s += 1)n[s] === t && (a = !0); a || n.push(t) }, l.prototype.removeEventListener = function (e, t) { e = String(e); var i = this._listeners, n = i[e]; if (null != n) { for (var a = [], s = 0; s < n.length; s += 1)n[s] !== t && a.push(n[s]); 0 === a.length ? delete i[e] : i[e] = a } }, N.prototype = Object.create(E.prototype), B.prototype = Object.create(E.prototype); var F = -1, q = 0, U = 1, H = 2, W = -1, V = 0, z = 1, Y = 2, G = 3, Q = /^text\/event\-stream;?(\s*charset\=utf\-8)?$/i, J = function (e, t) { var i = parseInt(e, 10); return i != i && (i = t), K(i) }, K = function (e) { return Math.min(Math.max(e, 1e3), 18e6) }, X = function (e, t, i) { try { "function" == typeof t && t.call(e, i) } catch (e) { O(e) } }; function g(e, t) { l.call(this), this.onopen = void 0, this.onmessage = void 0, this.onerror = void 0, this.url = void 0, this.readyState = void 0, this.withCredentials = void 0, this._close = void 0, function (c, n, e) { n = String(n); var a = null != e && Boolean(e.withCredentials), d = K(1e3), u = null != e && null != e.heartbeatTimeout ? J(e.heartbeatTimeout, 45e3) : K(45e3), h = "", p = d, f = !1, s = null != e && null != e.headers ? JSON.parse(JSON.stringify(e.headers)) : void 0, t = null != e && null != e.Transport ? e.Transport : null != P && "withCredentials" in P.prototype || null == j ? P : j, r = !Z || null != e && null != e.Transport ? new L(new t) : void 0, o = null == r ? new R : new M, l = void 0, m = 0, g = F, _ = "", v = "", y = "", b = "", w = V, C = 0, x = 0, k = function (e, t, i, n, a) { if (g === q) if (l = a, 200 === e && null != i && Q.test(i)) { g = U, f = !0, p = d, c.readyState = U; var s = new B("open", { status: e, statusText: t, headers: n }); c.dispatchEvent(s), X(c, c.onopen, s) } else { var r = ""; 200 !== e ? (t && (t = t.replace(/\s+/g, " ")), r = "EventSource's response has a status " + e + " " + t + " that is not 200. Aborting the connection.") : r = "EventSource's response has a Content-Type specifying an unsupported type: " + (null == i ? "-" : i.replace(/\s+/g, " ")) + ". Aborting the connection.", O(new Error(r)), $(); var s = new B("error", { status: e, statusText: t, headers: n }); c.dispatchEvent(s), X(c, c.onerror, s) } }, T = function (e) { if (g === U) { for (var t = -1, i = 0; i < e.length; i += 1) { var n = e.charCodeAt(i); n !== "\n".charCodeAt(0) && n !== "\r".charCodeAt(0) || (t = i) } var a = (-1 !== t ? b : "") + e.slice(0, t + 1); b = (-1 === t ? b : "") + e.slice(t + 1), "" !== a && (f = !0); for (var s = 0; s < a.length; s += 1) { var n = a.charCodeAt(s); if (w === W && n === "\n".charCodeAt(0)) w = V; else if (w === W && (w = V), n === "\r".charCodeAt(0) || n === "\n".charCodeAt(0)) { if (w !== V) { w === z && (x = s + 1); var r = a.slice(C, x - 1), o = a.slice(x + (x < s && a.charCodeAt(x) === " ".charCodeAt(0) ? 1 : 0), s); "data" === r ? (_ += "\n", _ += o) : "id" === r ? v = o : "event" === r ? y = o : "retry" === r ? (d = J(o, d), p = d) : "heartbeatTimeout" === r && (u = J(o, u), 0 !== m && (D(m), m = I(function () { A() }, u))) } if (w === V) { if ("" !== _) { h = v, "" === y && (y = "message"); var l = new N(y, { data: _.slice(1), lastEventId: v }); if (c.dispatchEvent(l), "message" === y && X(c, c.onmessage, l), g === H) return } y = _ = "" } w = n === "\r".charCodeAt(0) ? W : V } else w === V && (C = s, w = z), w === z ? n === ":".charCodeAt(0) && (x = s + 1, w = Y) : w === Y && (w = G) } } }, S = function () { if (g === U || g === q) { g = F, 0 !== m && (D(m), m = 0), m = I(function () { A() }, p), p = K(Math.min(16 * d, 2 * p)), c.readyState = q; var e = new E("error"); c.dispatchEvent(e), X(c, c.onerror, e) } }, $ = function () { g = H, null != l && (l(), l = void 0), 0 !== m && (D(m), m = 0), c.readyState = H }, A = function () { if (m = 0, g === F) { f = !1, m = I(function () { A() }, u), g = q, v = h, b = y = _ = "", x = C = 0, w = V; var e = n; "data:" !== n.slice(0, 5) && "blob:" !== n.slice(0, 5) && "" !== h && (e += (-1 === n.indexOf("?") ? "?" : "&") + "lastEventId=" + encodeURIComponent(h)); var t = { Accept: "text/event-stream" }; if (null != s) for (var i in s) Object.prototype.hasOwnProperty.call(s, i) && (t[i] = s[i]); try { o.open(r, k, T, S, e, a, t) } catch (e) { throw $(), e } } else f || null == l ? (f = !1, m = I(function () { A() }, u)) : (O(new Error("No activity within " + u + " milliseconds. Reconnecting.")), l(), l = void 0) }; c.url = n, c.readyState = q, c.withCredentials = a, c._close = $, A() }(this, e, t) } var Z = null != u && null != e && "body" in e.prototype; (g.prototype = Object.create(l.prototype)).CONNECTING = q, g.prototype.OPEN = U, g.prototype.CLOSED = H, g.prototype.close = function () { this._close() }, g.CONNECTING = q, g.OPEN = U, g.CLOSED = H, g.prototype.withCredentials = void 0, function (e) { if ("object" == typeof module && "object" == typeof module.exports) { var t = e(exports); void 0 !== t && (module.exports = t) } else "function" == typeof define && define.amd ? define("eventSource", ["exports"], e) : e(i) }(function (e) { e.EventSourcePolyfill = g, e.NativeEventSource = t, null == P || null != t && "withCredentials" in t.prototype || (e.EventSource = g) }) }("undefined" != typeof window ? window : this), function (e) { "function" == typeof define && (define.amd || define.cmd) ? define("plugins/sfCloud", ["eventSource"], e) : e(window) }(function (t) { function i(e) { this.push_url = e.push_url, this.pull_url = e.pull_url, this.sse_url = e.sse_url, this.device = e.device || "pc", this.token = e.token || "", this.isLogin = e.isLogin || function () { return !0 }, this.debug = e.debug || !1, this.disabled = e.disabled || !1, this.events = {}, this.version = i.version } return i.version = "v1.0", i.prototype = { constructor: i, setToken: function (e) { this.token = e }, openSSE: function () { if (!this.disabled) { if (!this.isLogin()) return this._log("未登录"); if (!this.sse_url) return this._log("未获取到sse_url"); var i = this, e = t.EventSourcePolyfill; e ? (this.sse = new e(this.sse_url, { headers: { "X-Accel-Buffering": "no", "Cache-Control": "no-cache", token: this.token } }), this.sse.addEventListener("message", function (e) { i._log("监听到事件：" + e.data); var t = JSON.parse(e.data); t.device !== i.device && (i._setEventVersion(t.eventId, t.version), i._callback(t)) }), this.sse.addEventListener("open", function () { i._log("sse连接打开.") }, !1), this.sse.addEventListener("error", function (e) { e.readyState === window.EventSource.CLOSED ? i._log("sse连接关闭") : i._log(e.readyState) }, !1)) : i._log("不支持EventSourcePolyfill对象，请下载相应包") } }, closeSSE: function () { this.sse && this.sse.close(), this._log("sse连接关闭") }, pull: function (e, t) { if (!this.disabled) { if (!this.isLogin()) return this._log("未登录"); var a = this; this._request(this.pull_url, void 0, function (e) { if (0 === e.code) for (var t = e.result, i = 0; i < t.length; i++) { var n = t[i]; if (n.device === a.device) break; a._setEventVersion(n.eventId, n.version), a._callback(n) } else a._log(e.detailMessage) }, t) } }, push: function (e, t, i) { if (!this.disabled) { if (!this.isLogin()) return this._log("未登录"); e.device = this.device, e.version = this._getEventVersion(e.eventId), this._request(this.push_url, e, t, i) } }, subscribe: function (e, t) { this.events[e] = this.events[e] || { version: 1 }, this.events[e].callback = t }, _callback: function (e) { var t = this.events[e.eventId]; t && t.callback ? t.callback(e) : this._log("没有注册" + e.eventId + "事件回调") }, _log: function (e) { this.debug }, _getEventVersion: function (e) { if (this.events[e]) return this.events[e].version + 1 }, _setEventVersion: function (e, t) { this.events[e] = this.events[e] || {}, this.events[e].version = t }, _request: function (e, t, i, n) { var a = window.XMLHttpRequest ? new window.XMLHttpRequest : new window.ActiveXObject("Microsoft.XMLHTTP"); a.open("POST", e, !0), a.setRequestHeader("Content-type", "application/json; charset=utf-8"), a.setRequestHeader("token", this.token), a.onreadystatechange = function () { 4 === this.readyState && 200 <= this.status && this.status < 500 ? "function" == typeof i && i(this.responseText) : 4 === this.readyState && "function" == typeof n && n(this.responseText) }, a.send(JSON.stringify(t)) } }, "undefined" != typeof module && "object" == typeof exports && (module.exports = i), i }), define("plugins/cloudMessage", ["./sfCloud", "api/ajax"], function (e) { var t = new e({ disabled: !_webConfig.useCloud, push_url: _cmsConfig.sfCloudDomain + "/owf-message-notification/service/event/push", pull_url: _cmsConfig.sfCloudDomain + "/owf-message-notification/service/event/pull", sse_url: _cmsConfig.sfCloudDomain + "/owf-message-notification/service/event/message", device: "owf_pc", debug: !0, isLogin: function () { return !!$.cookie("loginUser") } }); return t.login = function () { _webConfig.useCloud && sfAjax.getCloudToken({ success: function (e) { 0 === e.code && (t.setToken(e.result), t.openSSE()) } }) }, t }), define("views/pages/order/cn/qrCode/qrCode", ["baseView", "templates", "helper", "utils/checkUtils", "event", "plugins/cloudMessage", "sflayer", "const"], function (e, a, t, i, s, r, o) { return e.extend({ template: a.qrCode, events: { "click .paper-bill": "showPaperBill", "submit form": "submitToOrder" }, init: function () { this.$el.off(); var i, n = this; s.trigger(s.RegisterLoginCallback, [function () { n.render() }, function () { }]), r.subscribe("SCAN", function (e) { var t = e.data.waybillNo.toUpperCase(); n.$(".fl").val(t), n.$(".qr-code-cloud").length && (localStorage.getItem(o.AGREE_QRCODE_CLOUD) ? n.submitToOrder() : (i && layer.close(i), i = layer.open({ title: _l("温馨提示"), content: a.qrCodeCloudTip({ billNum: t }), btn: _l("我知道了"), yes: function (e) { localStorage.setItem(o.AGREE_QRCODE_CLOUD, 1), n.submitToOrder(), layer.close(e) } }))) }) }, render: function () { var t = this; _webConfig.useCloud ? sfAjax.isGrayUser({ data: { type: "24" }, success: function (e) { 0 === e.code && !0 === e.result ? t.grayRender() : t.normalRender() }, error: function () { t.normalRender() } }) : t.normalRender() }, normalRender: function () { this.$el.html(this.template({ imgUrl: t.getResourceURL("images/order/qr-paper-bill.png") })), this.setElement(this.$(".qr-code")) }, grayRender: function () { this.$el.html(a.qrCodeCloud({ imgUrl: t.getResourceURL("images/order/qr-paper-bill.png") })), r.login() }, showPaperBill: function () { layer.open({ title: " ", area: ["516px", "590px"], skin: "qr-order-paper", shadeClose: !0, content: this.$(".qr-order-img") }) }, submitToOrder: function (e) { if (e && e.preventDefault(), this.waybillNo = this.$("input").val().toUpperCase(), this.waybillNo && i.billNumber(this.waybillNo)) { var t = this; sfAjax.validBillNo({ data: { waybillNo: t.waybillNo }, success: function (e) { e ? 0 === e.code ? t.options.showQrOrder(t.waybillNo) : 610 === e.code ? layer.msg(_l("运单号已使用")) : 611 === e.code ? layer.msg(_l("运单号无效")) : t.showNetworkErr() : t.showNetworkErr() }, error: function () { t.showNetworkErr() } }) } else layer.tips(_l("请输入12位数字运单号或“SF”开头的15位运单号"), this.$("input"), { tips: [3, "#333"], time: 2e3 }) }, showNetworkErr: function () { layer.msg(_l("网络故障，请稍后重试。")) } }) }), define("components/billOptions/normalWeight", ["baseView", "templates", "event"], function (e, t, i) { return e.extend({ template: t.normalWeight, init: function (e) { this.initWeightArr(), this.normalWeight = e.initWeight }, render: function () { this.$el.html(this.template({ weightArr: this.weightArr, initWeight: this.normalWeight })) }, events: { "click .normal-weight a": "chooseWeight" }, initWeightArr: function () { this.weightArr = -1 < ["hk", "tw"].indexOf(Helper.getSiteLocation()) ? [.5, 1, 3, 5, 10, 20] : [1, 3, 5, 10, 20] }, chooseWeight: function (e) { this.$(".normal-weight a").removeClass("active"), this.$(e.currentTarget).addClass("active"), this.normalWeight = this.$(e.currentTarget).data("value") }, getNormalWeight: function () { return this.normalWeight } }) }), define("components/newBillOptions/cargoWeight", ["components/billOptions/normalWeight"], function (e) { return e.extend({ chooseWeight: function (e) { this.$(".normal-weight a").removeClass("active"), this.$(e.currentTarget).addClass("active"), this.normalWeight = this.$(e.currentTarget).data("value") } }) }), define("components/newBillOptions/itemsAndWeight", ["baseView", "templates", "./cargoItems", "./cargoWeight"], function (e, t, i, n) { return e.extend({ layerOpts: { title: _l("托寄物信息"), area: "680px", skin: "line" }, template: t.itemsAndWeight, render: function () { this.$el.html(this.template()), this.receiverItems = new i({ el: this.$(".receiver-items-wrapper"), choosedItem: this.options.choosedItem, choosedMedci: this.options.choosedMedci }), this.weight = new n({ el: this.$(".normal-weight-wrapper"), initWeight: this.options.weight }) }, events: { "click .save": "save" }, save: function () { if (this.receiverItems.formValidate()) { var e = { items: this.receiverItems.getChoosedItem(), medci: this.receiverItems.getMedicine(), weight: this.weight.getNormalWeight() }; this.options.callback(e), this.close() } } }) }), define("views/pages/order/cn/qrCode/mlBillInfo", ["../billInfoCommon", "components/newBillOptions/itemsAndWeight"], function (e, i) { return e.extend({ init: function () { e.prototype.init.apply(this, arguments), this.cargoItems = _l("文件"), this.cargoMedci = "", this.cargoWeight = 1, this.monthAccount = "", this.signedBackBillIndex = "", this.signedBackBillName = "", this.codAmt = "", this.codCustid = "", this.codType = null }, render: function () { e.prototype.render.apply(this, arguments), this.showItemsAndWeight() }, events: _.extend({ "click .items-weight": "popItemsAndWeight", "click .cargo-service": "popCargoService", "click .cargo-insure": "popCargoInsure", "click .cargo-msg": "popCargoMsgView" }, e.prototype.events), popItemsAndWeight: function () { var t = this; new i({ choosedItem: this.cargoItems, choosedMedci: this.cargoMedci, weight: this.cargoWeight, callback: function (e) { t.cargoItems = e.items, t.cargoMedci = e.medci, t.cargoWeight = e.weight, t.showItemsAndWeight(), t.options.fetchPriceAndTimes() } }) }, showItemsAndWeight: function () { var e; this.$(".items-show").text(this.cargoItems), e = 20 == this.cargoWeight ? ">20kg" : this.cargoWeight + "kg", this.$(".weight-show").text(e) } }) }), define("components/newBillOptions/hmtOptions/addDeclareItems", ["baseView", "templates", "helper", "bus/index"], function (e, s, n, t) { return e.extend({ layerOpts: { title: _l("新增申报物品"), area: "680px", skin: "line" }, template: s.clearanceItemForm, init: function (e) { this.lang = n.getSiteLanguage().toUpperCase(), this.other = "OTHER", this.isGoodsNameLegal = !1, this.isUnitLegal = !1, this.goodsName = "", this.data = e.data, this.isRightOtherCountry = !0, this.hkRecommendCountries = null, this.declareCountryName = "" }, render: function () { this.$el.html(this.template({ data: this.data || {}, fromAcs: this.options.fromAcsOrder })), this.LoadHKRecommendCountry(), this.fillViewData(this.data) }, events: { "change .itemType": "itemTypeChangeEvent", "keyup .goodsName": "goodsNameKeyupEvent", "blur .goodsName": "goodsNameBlurEvent", "mousedown .goodsName-hint": "clearanceItemFormClickEvent", "change .unit": "unitChangeEvent", "blur .otherUnit": "otherUnitBlurEvent", "click .clearanceItemSubmitBtn": "clearanceItemSubmitEvent", "change #recommendCountrys": "changeCountry", "blur .orther-contry input": "validCountry", click: "closeSelect" }, closeSelect: function (e) { $(e.target).data("selectable") || this.$(".goodsName-hint").hide(), e.stopPropagation() }, fillViewData: function (e) { this.$(".currency").html(s.dropdownSelectTemplate({ type: 1, itemList: this.getCurrencyList() })), this.options.fromAcsOrder && this.$(".currency").val("HKD"), this.$(".unit").html(s.dropdownSelectTemplate({ type: 2, itemList: this.getUnitList() })), e ? (this.selectedID = e.id, this.itemTypeChangeEvent(), this.$(".currency").val(e.currency), this.$(".goodsQuantity").val(e.quantity), this.checkUnit(e.uom) ? this.$(".unit").val(e.uom) : (this.$(".unit").val(this.other), this.unitChangeEvent(), this.$(".otherUnit").val(e.uom))) : this.selectedID = null }, getCurrencyList: function () { var e = [{ value: "CNY", scTxt: "人民币", tcTxt: "人民幣", enTxt: "CNY" }, { value: "USD", scTxt: "美元", tcTxt: "美圓", enTxt: "USD" }, { value: "MOP", scTxt: "澳门元", tcTxt: "澳門圓", enTxt: "MOP" }, { value: "SGD", scTxt: "新元", tcTxt: "新圓", enTxt: "SGD" }, { value: "JPY", scTxt: "日元", tcTxt: "日圓", enTxt: "JPY" }, { value: "KRW", scTxt: "韩元", tcTxt: "韓圓", enTxt: "KRW" }, { value: "MYR", scTxt: "马币", tcTxt: "馬幣", enTxt: "MYR" }, { value: "NTD", scTxt: "新台币", tcTxt: "新台幣", enTxt: "NTD" }, { value: "HKD", scTxt: "港币", tcTxt: "港幣", enTxt: "HKD" }]; return t.isHK_MC(t.getSLocationCode()) ? e.unshift(e.splice(8)[0]) : t.isTW(t.getSLocationCode()) && e.unshift(e.splice(1, 1)[0]), e }, getUnitList: function () { return "EN" == this.lang ? [{ value: "PCS", enTxt: "PCS" }, { value: "BOX", enTxt: "BOX" }, { value: "ROLL", enTxt: "ROLL" }, { value: "METER", enTxt: "METER" }, { value: "PAIR", enTxt: "PAIR" }, { value: "KG", enTxt: "KG" }, { value: "SETB", enTxt: "SETB" }, { value: "UNCH", enTxt: "UNCH" }, { value: "CAN", enTxt: "CAN" }, { value: "OTHER", enTxt: "OTHER" }] : "TC" == this.lang ? [{ value: "個", tcTxt: "個" }, { value: "份", tcTxt: "份" }, { value: "件", tcTxt: "件" }, { value: "條", tcTxt: "條" }, { value: "隻", tcTxt: "隻" }, { value: "台", tcTxt: "台" }, { value: "張", tcTxt: "張" }, { value: "盒", tcTxt: "盒" }, { value: "雙", tcTxt: "雙" }, { value: "OTHER", tcTxt: "其他" }] : [{ value: "个", scTxt: "个" }, { value: "份", scTxt: "份" }, { value: "件", scTxt: "件" }, { value: "条", scTxt: "条" }, { value: "只", scTxt: "只" }, { value: "双", scTxt: "双" }, { value: "台", scTxt: "台" }, { value: "张", scTxt: "张" }, { value: "盒", scTxt: "盒" }, { value: "OTHER", scTxt: "其他" }] }, checkUnit: function (t) { var e = "EN" == this.lang ? ["PCS", "BOX", "ROLL", "METER", "PAIR", "KG", "SETB", "UNCH", "CAN"] : "TC" == this.lang ? ["個", "份", "件", "條", "隻", "雙", "台", "張", "盒"] : ["个", "份", "件", "条", "只", "双", "台", "张", "盒"], i = !1; return _.forEach(e, function (e) { t == e && (i = !0) }), i }, checkAllUnit: function (t) { var e = "EN" == this.lang ? ["PCS", "BOX", "ROLL", "METER", "PAIR", "KG", "SETB", "UNCH", "CAN", "BOTTLE", "BAG", "YARD"] : "TC" == this.lang ? ["個", "份", "件", "條", "隻", "雙", "台", "張", "盒", "千克", "支", "座", "輛", "艘", "架", "套", "頭", "枝", "根", "把", "塊", "卷", "副", "片", "組", "幅", "對", "棵", "株", "井", "米", "盤", "平方米", "立方米", "筒", "克", "盆", "萬個", "具", "百副", "百支", "百把", "百個", "百片", "刀", "疋", "公擔", "扇", "百枝", "仟隻", "仟塊", "仟盒", "仟枝", "仟個", "億支", "億個", "萬套", "仟張", "萬張", "仟伏安", "仟瓦", "仟瓦時", "仟升", "英呎", "噸", "長噸", "短噸", "司馬擔", "司馬斤", "斤", "磅", "擔", "英擔", "短擔", "兩", "市擔", "盎司", "克拉", "市尺", "碼", "英吋", "吋", "升", "毫升", "英加侖", "美加侖", "立方英尺", "立方尺", "平方碼", "平方英尺", "平方尺", "英製馬力", "公製馬力", "令", "箱", "批", "罐", "桶", "扎", "包", "籮", "打", "筐", "羅", "匹", "冊", "本", "發", "枚", "捆", "袋", "粒", "合", "瓶", "仟支", "萬雙", "萬粒", "仟粒", "仟米", "仟英尺", "百萬贝可", "部", "封", "KG", "公斤"] : ["个", "份", "件", "条", "只", "双", "台", "张", "盒", "千克", "支", "座", "辆", "艘", "架", "套", "头", "枝", "根", "把", "块", "卷", "副", "片", "组", "幅", "对", "棵", "株", "井", "米", "盘", "平方米", "立方米", "筒", "克", "盆", "万个", "具", "百副", "百支", "百把", "百个", "百片", "刀", "疋", "公担", "扇", "百枝", "千只", "千块", "千盒", "千枝", "千个", "亿支", "亿个", "万套", "千张", "万张", "千伏安", "千瓦", "千瓦时", "千升", "英尺", "吨", "长吨", "短吨", "司马担", "司马斤", "斤", "磅", "担", "英担", "短担", "两", "市担", "盎司", "克拉", "市尺", "码", "英寸", "寸", "升", "毫升", "英加仑", "美加仑", "立方英尺", "立方尺", "平方码", "平方英尺", "平方尺", "英制马力", "公制马力", "令", "箱", "批", "罐", "桶", "扎", "包", "箩", "打", "筐", "罗", "匹", "册", "本", "发", "枚", "捆", "袋", "粒", "合", "瓶", "千支", "万双", "万粒", "千粒", "千米", "千英尺", "百万贝可", "部", "封", "KG", "公斤"], i = !1; return _.forEach(e, function (e) { t == e && (i = !0) }), i }, formCheck: function () { return "file" == (this.options.fromAcsOrder ? "goods" : this.$(".itemType:checked").val()) || (this.goodsNameCheck(), this.otherUnitBlurCheck(), this.$(".clearance-item-form").parsley().validate() && this.isGoodsNameLegal && this.isUnitLegal && this.isRightOtherCountry) }, itemTypeChangeEvent: function () { var e = this.options.fromAcsOrder ? "goods" : this.$(".itemType:checked").val(); "file" == e ? this.$(".goods-input-required").hide() : "goods" == e && this.$(".goods-input-required").show() }, goodsNameKeyupEvent: function () { var e = this.$(".goodsName").val(), a = this.lang, t = { goodsName: encodeURI(e) }; e.trim() && sfAjax.goodsNameAssociate({ data: t, success: function (e) { var t = e.result, n = []; _.each(t, function (e) { var t = "EN" == a ? e.englishUnit : e.matchUnit, i = t && t.split(",")[0]; n.push({ value: e.matchName, txt: e.matchName, unit: i, enTxt: e.englishName, selectable: "Y" != e.isBlackList, lang: a }) }), n.length && (this.$(".goodsName-hint").html(s.promptDialogTemplate({ itemList: n })), this.$(".goodsName-hint").show()) }, error: function () { this.$(".goodsName-hint").hide() } }) }, goodsNameCheck: function () { var i = this, e = this.$(".goodsName").val(), t = { goodsName: e }; e && sfAjax.goodsNameCheck({ data: t, success: function (e) { var t = e.code; 700 == t ? (i.$(".goodsName-fuzzy").show(), i.$(".goodsName-contraband").hide(), i.isGoodsNameLegal = !1) : 701 == t ? (i.$(".goodsName-contraband").show(), i.$(".goodsName-fuzzy").hide(), i.isGoodsNameLegal = !1) : 0 == t && (i.$(".goodsName-fuzzy").hide(), i.$(".goodsName-contraband").hide(), i.isGoodsNameLegal = !0) }, error: function () { this.$(".goodsName-fuzzy").hide(), this.$(".goodsName-contraband").hide() } }) }, goodsNameHintClickEvent: function (e) { if ($(e.target).data("selectable")) { var t = $(e.target).data("sc"), i = $(e.target).data("en"), n = "EN" == this.lang ? i : t, a = $(e.target).data("unit"); n && (this.$(".goodsName").val(n), this.goodsName = n, this.$(".goodsName").data("sc", t), this.$(".goodsName").data("en", i), this.checkUnit(a) ? (this.$(".unit").val(a), this.unitChangeEvent()) : (this.$(".unit").val(this.other), this.unitChangeEvent(), this.$(".otherUnit").val(a)), this.$(".goodsName-hint").hide()) } }, unitChangeEvent: function () { this.$(".unit").find("option:selected").val() == this.other ? (this.$(".otherUnit").val(""), this.$(".otherUnit").show()) : this.$(".otherUnit").hide() }, goodsNameBlurEvent: function () { var e = this.$(".goodsName").val(); this.goodsName != e && this.$(".goodsName").data("en", "") }, clearanceItemFormClickEvent: function (e) { this.$(".goodsName-hint").find(e.target).length ? (this.goodsNameHintClickEvent(e), this.goodsNameCheck()) : "goodsName" != this.$(e.target).attr("name") && (this.$(".clearance-item-form").find(".goodsName-hint").hide(), this.goodsNameCheck()), "unit" != this.$(e.target).attr("name") && "otherUnit" != this.$(e.target).attr("name") && this.otherUnitBlurCheck() }, otherUnitBlurCheck: function () { var e = this.$(".unit").val(), t = this.$(".otherUnit").val(), i = e == this.other ? t : e; this.checkAllUnit(i) ? (this.$(".unit-error").hide(), this.isUnitLegal = !0) : (this.$(".unit-error").show(), this.isUnitLegal = !1) }, getData: function () { var e, t, i = this.options.fromAcsOrder ? "goods" : this.$(".itemType:checked").val(); "EN" == this.lang ? (e = this.$(".goodsName").data("sc") || this.$(".goodsName").val(), t = this.$(".goodsName").val() || this.$(".goodsName").data("en")) : (e = this.$(".goodsName").val() || this.$(".goodsName").data("sc"), t = this.$(".goodsName").data("en") || this.$(".goodsName").val()); var n = this.$(".price").val(), a = this.$(".currency").find("option:selected").val(), s = this.$(".currency").find("option:selected").html(), r = this.$(".goodsQuantity").val(), o = this.$(".unit").val(), l = this.$(".otherUnit").val(), c = o == this.other ? l : o; return { id: this.selectedID, name: e, uom: c, quantity: r, price: n, englishName: t || "", currency: a, currencyCn: s, declareType: i, origin: this.declareCountryName } }, validCountry: function (e) { this.isRightOtherCountry = !1, this.$(".countryOfOrigin .error").hide(); var t = $.trim(this.$(e.currentTarget).val()); if ("" == t) this.$(".country-empty").show(); else { var i = this; sfAjax.validACSCountry({ data: { country: t }, success: function (e) { 0 == e.code && 1 == e.result ? (i.isRightOtherCountry = !0, i.declareCountryName = t) : i.$(".country-err").show() }, error: function () { i.$(".network-err").show() } }) } }, LoadHKRecommendCountry: function () { if (!this.hkRecommendCountries) { var i = this; sfAjax.getJson({ url: n.getResourceURL("data/hk-recommend-country.json"), success: function (e) { if (e && 0 < e.length) { if (i.hkRecommendCountries = e, i.data && i.data.origin) for (var t = 0; t < e.length; t++)i.data.origin != e[t].scName && i.data.origin != e[t].enName && i.data.origin != e[t].tcName || i.hkRecommendCountries.unshift(i.hkRecommendCountries.splice(t, 1)[0]); else "tw" == n.getSiteLocation() && (i.hkRecommendCountries.unshift(i.hkRecommendCountries.splice(6, 1)[0]), i.$("#recommendCountrys").trigger("change")); i.$("#recommendCountrys").append(s.dropdownRecommendCountrys({ dropdownItems: i.hkRecommendCountries })) } else layer.msg("json文件数据不正确！") }, error: function () { layer.msg("json文件不存在！") } }) } }, changeCountry: function (e) { var t = this.$(e.currentTarget); "ORTHERS" == t.val() ? (this.$(".orther-contry input").val("").trigger("blur"), this.$(".orther-contry").show()) : (this.isRightOtherCountry = !0, this.$(".orther-contry").hide(), this.$(".countryOfOrigin .error").hide(), this.declareCountryName = t.find("option:selected").text()) }, clearanceItemSubmitEvent: function (e) { e.preventDefault(), this.formCheck() && (this.options.callback(this.getData()), this.close()) } }) }), define("components/newBillOptions/hmtOptions/declareItems", ["baseView", "templates", "helper", "./addDeclareItems", "sflayer"], function (e, t, a, n) { return e.extend({ layerOpts: { title: _l("申报物品"), area: "680px", skin: "line" }, template: { noItems: t.noDeclareItems, hasItems: t.declareItems }, init: function (e) { this.declareGoodsLists = e.declareGoodsLists, _.each(this.declareGoodsLists, function (e, t) { e.id = t }), this.declareValue = e.declareValue, this.originCurrency = e.originCurrency, this.iscurrencySame = !0 }, render: function () { 0 == this.declareGoodsLists.length ? this.$el.html(this.template.noItems()) : (this.$el.html(this.template.hasItems({ list: this.declareGoodsLists, isSc: "sc" == a.getSiteLanguage() || "tc" == a.getSiteLanguage() })), this.validateGoodLists()), $(window).resize() }, events: { "click .add": "addItem", "click .edit": "editItem", "click .delete": "deleteItem", "click .save": "save" }, addItem: function () { 10 == this.declareGoodsLists.length ? layer.msg(_l("提示：申报物品数量不能大于10条")) : new n({ data: null, fromAcsOrder: !1, callback: this.fillGoods.bind(this) }) }, editItem: function (e) { var t = this.$(e.currentTarget).parents("tr").data("id"), i = _.find(this.declareGoodsLists, function (e) { return e.id == t }); new n({ data: i, fromAcsOrder: !1, callback: this.fillGoods.bind(this) }) }, deleteItem: function (e) { var t = _l("您确定要删除该申报物品？"), i = this, n = layer.confirm(t, { noStop: !0, btn: [_l("确定"), _l("取消")] }, function () { var t = i.$(e.currentTarget).parents("tr").data("id"); i.declareGoodsLists = _.reject(i.declareGoodsLists, function (e) { return e.id == t }), _.each(i.declareGoodsLists, function (e, t) { e.id = t }), i.render(), layer.close(n) }, function () { layer.close(n) }) }, fillGoods: function (i) { if ("file" == i.declareType && (i.name = "文件", i.uom = "sc" == a.getSiteLanguage() ? "个" : "tc" == a.getSiteLanguage() ? "個" : "PCS", i.quantity = "1", i.price = "0", i.englishName = "document"), null === i.id) i.id = this.declareGoodsLists.length, this.declareGoodsLists.push(i); else { var n = this; _.each(this.declareGoodsLists, function (e, t) { t == i.id && (n.declareGoodsLists[t] = i) }) } this.render() }, validateGoodLists: function () { var e = _.filter(this.declareGoodsLists, function (e) { return "goods" == e.declareType }); if (this.$(".total-declare-value").text("--"), this.$(".total-declare-currency").text(""), 0 < e.length) if (1 < _.union(_.pluck(e, "currency")).length) this.iscurrencySame = !1; else { this.iscurrencySame = !0; var t, i = 0; _.each(e, function (e) { i += e.quantity * e.price }), this.declareValue = i, this.originCurrency = _.union(_.pluck(e, "currency"))[0], t = "sc" == a.getSiteLanguage() ? _.union(_.pluck(e, "currencyCn"))[0] : this.originCurrency, this.$(".total-declare-value").text(this.declareValue), this.$(".total-declare-currency").text(t) } else this.originCurrency = this.declareGoodsLists[0].currency, this.declareValue = 0, this.iscurrencySame = !0 }, save: function () { this.iscurrencySame ? (this.options.callback({ declareValue: this.declareValue, declareGoodsLists: this.declareGoodsLists, originCurrency: this.originCurrency }), this.close()) : layer.alert(_l("提示：物品的申报币种需要保持一致")) } }) }), define("components/newBillOptions/hmtOptions/onlyCargoWeight", ["baseView", "templates", "components/newBillOptions/cargoWeight"], function (e, t, i) { return e.extend({ layerOpts: { title: _l("预估重量"), area: "680px", skin: "line" }, template: t.onlyCargoWeight, render: function () { this.$el.html(this.template()), this.weight = new i({ el: this.$(".normal-weight-wrapper"), initWeight: this.options.weight }) }, events: { "click .save": "save" }, save: function () { this.options.callback({ weight: this.weight.getNormalWeight() }), this.close() } }) }), define("components/newBillOptions/hmtOptions/hmtCargoInsure", ["../cargoInsure", "helper"], function (e, t) { return e.extend({ init: function () { e.prototype.init.apply(this, arguments), this.showNotSelectTip = !0 }, showSelect: function () { }, calcSupportPrise: function (e) { return 1600 < e && e <= this.maxP ? t.toFixed(.005 * e, 0) : 0 < e && e <= 1600 ? 8 : 0 } }) }), define("components/newBillOptions/hmtOptions/declareType", ["baseView", "templates"], function (e, t) { return e.extend({ layerOpts: { title: _l("报关方式"), area: "680px", skin: "line" }, template: t.declareType, init: function (e) { this.clearanceType = e.clearanceType }, render: function () { this.$el.html(this.template({ clearanceType: this.clearanceType })) }, events: { "click .sf-capsule a": "chooseMsg", "click .save": "save" }, chooseMsg: function (e) { this.$(".sf-capsule a").removeClass("active"), this.$(e.currentTarget).addClass("active"), this.clearanceType = this.$(e.currentTarget).data("type"), 1 == this.clearanceType ? this.$(".declare-note").fadeIn("fast") : this.$(".declare-note").fadeOut("fast") }, save: function () { this.options.callback({ clearanceType: this.clearanceType }), this.close() } }) }), define("views/pages/order/cn/qrCode/hmtBillInfo", ["../billInfoCommon", "components/newBillOptions/hmtOptions/declareItems", "components/newBillOptions/cargoPayType", "components/newBillOptions/hmtOptions/onlyCargoWeight", "components/newBillOptions/hmtOptions/hmtCargoInsure", "components/newBillOptions/hmtOptions/declareType", "helper"], function (e, i, n, a, s, r, t) { return e.extend({ init: function () { e.prototype.init.apply(this, arguments), this.cargoWeight = 1, this.monthAccount = "", this.declareGoodsLists = [], this.declareValue = 0, this.taxPaymethod = 2, this.taxMonthAccount = "", this.clearanceType = 0, this.originCurrency = null, this.hasCargoItems = !1, this.hasDeclareItems = !0, this.hasTaxPayType = this.options.isTW, this.hasCargoService = !1, this.hasOnlyWeight = !0, this.hasDeclareType = !0 }, events: _.extend({ "click .add-items": "addItems", "click .tax-pay-type": "popTaxPayType", "click .cargo-weight": "popCargoWeight", "click .cargo-insure": "popCargoInsure", "click .cargo-declare-type": "popDeclareType" }, e.prototype.events), addItems: function () { var t = this; new i({ declareValue: this.declareValue, declareGoodsLists: this.declareGoodsLists, originCurrency: this.originCurrency, callback: function (e) { t.declareValue = e.declareValue, t.originCurrency = e.originCurrency, t.declareGoodsLists = e.declareGoodsLists, t.showItems() } }) }, showItems: function () { var e; 0 < this.declareGoodsLists.length ? (e = "en" == t.getSiteLanguage() ? _.pluck(this.declareGoodsLists, "englishName").join(",") : _.pluck(this.declareGoodsLists, "name").join(","), this.$(".items-show").text(e)) : this.$(".items-show").text(_l("未添加申报物品")) }, popTaxPayType: function () { var t = this; new n({ types: [4, 2], chooseType: this.taxPaymethod, monthAccount: this.taxMonthAccount, callback: function (e) { t.taxPaymethod = e.chooseType, t.taxMonthAccount = e.monthAccount, t.showTaxPayType() } }) }, showTaxPayType: function () { this.$(".tax-pay-type-show").text(_l(t.getPayType(this.taxPaymethod))) }, popCargoWeight: function () { var t = this; new a({ weight: this.cargoWeight, callback: function (e) { t.cargoWeight = e.weight, t.showWeight(), t.options.fetchPriceAndTimes() } }) }, showWeight: function () { var e; e = 20 == this.cargoWeight ? ">20kg" : this.cargoWeight + "kg", this.$(".cargo-weight-show").text(e) }, popCargoInsure: function () { var t = this; new s({ supportPrise: this.supportPrise, supportVal: this.supportVal, times: this.insureTimes, callback: function (e) { t.supportPrise = e.supportPrise, t.supportVal = e.supportVal, t.showInsure(), t.options.changePredictPrice() } }) }, showInsure: function () { this.$(".cargo-insure-show").text(this.supportVal ? _l("保价") + this.unitChange(this.supportVal) : _l("未选择保价")), this.$(".cargo-insure-price-show").text(this.supportVal ? _l("保费") + this.unitChange(this.supportPrise) : "") }, popDeclareType: function () { var t = this; new r({ clearanceType: this.clearanceType, callback: function (e) { t.clearanceType = e.clearanceType, t.showDeclareType() } }) }, showDeclareType: function () { this.$(".cargo-declare-show").text(0 == this.clearanceType ? _l("非正式报关") : _l("正式报关")) } }) }), define("views/pages/order/cn/qrCode/qrOrder", ["../orderCommon", "templates", "../bulkShipping/shipper/sender", "../receiver", "components/detailDateTimePicker/pickupTimePicker", "../../innerViews/priceAndTime", "./mlBillInfo", "./hmtBillInfo", "helper", "const", "bus/index"], function (e, t, i, n, a, s, r, o, l, c, d) { return e.extend({ template: t.qrOrder, init: function (e) { this.cityWorkingTime = e.cityWorkingTime, this.medciName = _l("医药类产品"), this.waybillNo = e.waybillNo, this.ratePrice = null, this.saveAddressBook = !0, this.resetPeakControlInfo() }, render: function () { this.$el.html(this.template({ waybillNo: this.waybillNo, acceptUrl: l.getDynamicURLWithContext("/accept/") })), this.sender = new i({ el: this.$(".sender-wrapper"), locationChange: this.senderLocationChange.bind(this) }), this.receiver = new n({ el: this.$(".receiver-wrapper"), locationChange: this.receiverLocationChange.bind(this) }), this.pickupTimePicker = new a({ el: this.$(".pickup-time") }), this.priceAndTime = new s({ el: this.$(".product-type-wrapper"), orderModel: this.cityWorkingTime, callback: this.resetDefaultProduct.bind(this), type: 1 }), this.setElement(this.$(".qr-order")) }, resetDefaultProduct: function (e) { this.limitTypeCode = e.limitTypeCode, this.cargoTypeCode = e.cargoTypeCode, this.expressTypeCode = e.expressTypeCode, this.productName = e.limitTypeName, this.$(".submit-order").removeClass("disabled"); var t = parseFloat(e.totalFreight); isNaN(t) ? this.ratePrice = null : this.ratePrice = t, this.changePredictPrice(), this.getWarmReminder() }, receiverLocationChange: function (e, t, i) { this.receiverLocationRateCode = e, this.receiverLocationCountyCode = t, this.receiverLocationCityCode = i, this.isML = this.isHK = this.isTW = this.isMACAO = this.isSendML = this.isSendGAT = !1, e == c.RATE_OF_HK ? this.isHK = !0 : e == c.RATE_OF_TW ? this.isTW = !0 : e == c.RATE_OF_MACAO ? this.isMACAO = !0 : this.isML = !0, l.isHK_MC_TW(this.senderLocationRateCode) ? this.isSendGAT = !0 : this.isSendML = !0, this.billInfoToggle(), this.fetchPriceAndTimes(), this.getWarmReminder(), this.receiver.queryAddressRange(), this.toggleSelfPick(), d.setRLocationCode(e) }, fetchPriceAndTimes: function () { var e = {}; this.isML && this.senderLocationCountyCode && this.receiverLocationCountyCode ? (e.destCode = this.receiverLocationCountyCode, this.showPriceAndTimes(e)) : (this.isHK || this.isTW || this.isMACAO) && this.senderLocationCountyCode && this.receiverLocationCityCode && (e.destCode = this.receiverLocationCityCode, this.showPriceAndTimes(e)) }, showPriceAndTimes: function (e) { _.extend(e, { originCode: this.senderLocationCountyCode, time: this.getBookingTime(), weight: this.otherBillInfo.cargoWeight, queryType: this.isML ? "2" : "3", rateType: "toMainland" }), this.priceAndTime.fetchTimeAndRate(e), this.$(".product-type-content").slideDown("fast"), this.$(".other-info-wrapper").slideDown("fast") }, changePredictPrice: function () { var e, t; t = this.isML ? "" === this.otherBillInfo.signedBackBillIndex ? 0 : 5 : 0, null === this.ratePrice ? (e = "--", this.metaPrice = 0) : (e = this.ratePrice + this.otherBillInfo.supportPrise + t, this.metaPrice = e), this.$(".predict-money").text(e) }, billInfoToggle: function () { this.isML ? this.otherBillInfo = new r({ el: this.$(".bill-options-list-wrapper"), fetchPriceAndTimes: this.fetchPriceAndTimes.bind(this), changePredictPrice: this.changePredictPrice.bind(this) }) : this.otherBillInfo = new o({ el: this.$(".bill-options-list-wrapper"), isTW: this.isTW, fetchPriceAndTimes: this.fetchPriceAndTimes.bind(this), changePredictPrice: this.changePredictPrice.bind(this) }) }, validateOthers: function () { if (this.isML) { if ("" === this.otherBillInfo.cargoItems) return void layer.alert(_l("未选择托寄物")); var e = !1; if ((this.otherBillInfo.cargoMedci || _.contains(this.otherBillInfo.cargoItems.split(","), this.medciName)) && (e = !0), e && this.otherBillInfo.selfPick) return void layer.alert(_l("医药类产品不能选择自取服务")); if (1 == this.otherBillInfo.codType && 2 == this.otherBillInfo.payType) return void layer.alert(_l("非月结客户的代收货款服务暂不支持“到付”")); this.queryPeakControl() } else this.validateGoods() }, validateGoods: function () { if (0 != this.otherBillInfo.declareGoodsLists.length) if (0 == _.filter(this.otherBillInfo.declareGoodsLists, function (e) { return "goods" == e.declareType }).length && 0 < this.otherBillInfo.supportVal) var e = this, t = layer.confirm(_l("当前物品不支持保价,是否取消保价"), { btn: [_l("是"), _l("否")] }, function () { e.otherBillInfo.supportPrise = 0, e.otherBillInfo.supportVal = 0, e.otherBillInfo.showInsure(), e.changePredictPrice(), e.validateValue(), layer.close(t) }, function () { layer.close(t) }); else this.validateValue(); else layer.alert(_l("未添加申报物品")) }, validateValue: function () { var a = this, e = layer.load(0, { shade: [.2, "#000"] }); sfAjax.getexrate({ data: { time: encodeURIComponent(moment().format()), originCode: this.otherBillInfo.originCurrency, destCode: "CNY" }, success: function (e) { var t = l.toFixed(a.otherBillInfo.declareValue * e, 3); if (a.otherBillInfo.supportVal > t) layer.alert(_l("保价金额不能超过申报总值，当前申报总值为") + t + _l("元")); else if (5e3 < t && 0 == a.otherBillInfo.clearanceType) var i = _l("申报价值超过5000元人民币的物品，需要正式报关"), n = layer.confirm(i, { btn: [_l("正式报关"), _l("修改申报物品")] }, function () { a.otherBillInfo.clearanceType = 1, a.otherBillInfo.showDeclareType(), layer.close(n), a.queryPeakControl() }, function () { layer.close(n), a.$(".add-items").trigger("click") }); else a.queryPeakControl() }, error: function () { layer.msg(_l("网络错误")) }, complete: function () { layer.close(e) } }) }, getFlowCode: function () { return this.isSendML && this.isML ? "ZH_ZH" : this.isSendML && (this.isHK || this.isTW || this.isMACAO) ? "ZH_GAT" : this.isSendGAT && (this.isHK || this.isTW || this.isMACAO) ? "GAT_GAT" : this.isSendGAT && this.isML ? "GAT_ZH" : "" }, getfinalDeclareGoodsLists: function () { return _.map(this.otherBillInfo.declareGoodsLists, function (e) { return _.omit(e, "id", "currency", "declareType", "currencyCn") }) }, getSubmitPostData: function () { var e, t; this.isML ? (e = [{ name: this.otherBillInfo.cargoItems.substring(0, 10), uom: "", desc: this.otherBillInfo.cargoMedci, price: "0" }], t = null) : (e = this.getfinalDeclareGoodsLists(), t = { currency: this.otherBillInfo.originCurrency, weight: this.otherBillInfo.cargoWeight, declareType: this.otherBillInfo.clearanceType, paymethod: this.otherBillInfo.taxPaymethod, settlementCode: this.otherBillInfo.taxMonthAccount, declareValue: this.otherBillInfo.declareValue }); var i = this.pickupTimePicker.getDateTime(), n = { expectStartTm: i.start && moment(i.start).format("YYYY-MM-DD HH:mm:ss"), expectFinishTm: i.finish && moment(i.finish).format("YYYY-MM-DD HH:mm:ss"), originateAddress: _.omit(this.sender.getShipperData(), "setMark", "selfPick"), destinationInfo: [{ destinationAddress: _.omit(this.receiver.getShipperData(), "setMark", "selfPick"), remark: "", productCode: this.limitTypeCode, productName: this.productName.substring(0, 20), metaWeight: this.otherBillInfo.cargoWeight, metaPrice: this.metaPrice, cargoList: e, custom: t, paymethod: this.otherBillInfo.payType, custid: this.otherBillInfo.monthAccount, supportValue: this.otherBillInfo.supportVal, premium: this.otherBillInfo.supportPrise, controlStrategy: this.controlStrategy, notificationMsg: this.notificationMsg, selfPickUpFlag: this.otherBillInfo.selfPick, waybillNo: this.options.waybillNo, appointFlow: this.getFlowCode() }] }; return this.isML && _.extend(n.destinationInfo[0], { signedBackFlg: "" === this.otherBillInfo.signedBackBillIndex ? "0" : "1", signedBackSop: this.otherBillInfo.signedBackBillIndex, signedBackName: this.otherBillInfo.signedBackBillName, codAmt: this.otherBillInfo.codAmt, codCustid: this.otherBillInfo.codCustid }), n }, submitOrder: function () { this.submitLoadIndex = layer.load(0, { shade: [.2, "#000"] }), sfAjax.submitQrNewOrder(this.getAjaxFuncData()) } }) }), function (e) { "function" == typeof define && define.amd ? define("jQuery.XDomainRequest", ["jquery"], e) : "object" == typeof exports ? module.exports = e(require("jquery")) : e(jQuery) }(function (o) { if (o.support.cors || !o.ajaxTransport || !window.XDomainRequest) return o; var t = /^(https?:)?\/\//i, a = /^get|post$/i, s = new RegExp("^(//|" + location.protocol + ")", "i"); return o.ajaxTransport("* text html xml json", function (i, n, e) { if (i.crossDomain && i.async && a.test(i.type) && t.test(i.url) && s.test(i.url)) { var r = null; return { send: function (e, a) { var t = "", s = (n.dataType || "").toLowerCase(); r = new XDomainRequest, /^\d+$/.test(n.timeout) && (r.timeout = n.timeout), r.ontimeout = function () { a(500, "timeout") }, r.onload = function () { var e = "Content-Length: " + r.responseText.length + "\r\nContent-Type: " + r.contentType, t = { code: 200, message: "success" }, i = { text: r.responseText }; try { if ("html" === s || /text\/html/i.test(r.contentType)) i.html = r.responseText; else if ("json" === s || "text" !== s && /\/json/i.test(r.contentType)) try { i.json = o.parseJSON(r.responseText) } catch (e) { t.code = 500, t.message = "parseerror" } else if ("xml" === s || "text" !== s && /\/xml/i.test(r.contentType)) { var n = new ActiveXObject("Microsoft.XMLDOM"); n.async = !1; try { n.loadXML(r.responseText) } catch (e) { n = void 0 } if (!n || !n.documentElement || n.getElementsByTagName("parsererror").length) throw t.code = 500, t.message = "parseerror", "Invalid XML: " + r.responseText; i.xml = n } } catch (e) { throw e } finally { a(t.code, t.message, i, e) } }, r.onprogress = function () { }, r.onerror = function () { a(500, "error", { text: r.responseText }) }, n.data && (t = "string" === o.type(n.data) ? n.data : o.param(n.data)), r.open(i.type, i.url), r.send(t) }, abort: function () { r && r.abort() } } } }), o }), define("models/cityWorkingTime", ["backbone", "helper", "jQuery.XDomainRequest", "sflayer"], function (e, t) { var i = "HH:mm", s = "YYYY-MM-DD HH:mm:ss"; return e.Model.extend({ getCityWorkingTime: function (e) { var t = this; sfAjax.getCityWorkingTime({ data: { cityCode: e.cityCode ? e.cityCode : "", address: e.address ? encodeURIComponent(e.address) : "", addressType: e.addressType ? e.addressType : 1, bookingTime: e.bookingTime ? e.bookingTime : "", dayNum: e.dayNum ? e.dayNum : 3 }, success: function (e) { e && 0 === e.code && 0 < e.result.length ? (t.set("dateTimes", e.result), t.setFirstDateTime(e.result), t.setSecondDateTime(e.result), t.setThirdDateTime(e.result)) : layer.msg(_l("网络错误")) }, error: function () { layer.msg(_l("网络错误")) } }) }, setFirstDateTime: function (e) { var t = e[0], i = t.workingTime.split("-"), n = moment(t.date + " " + i[0], s), a = moment(t.date + " " + i[1], s); this.setFirstPickedStartDateTime(n), this.setFirstPickedEndDateTime(a) }, setSecondDateTime: function (e) { var t = e[1], i = t.workingTime.split("-"), n = moment(t.date + " " + i[0], s), a = moment(t.date + " " + i[1], s); this.setSecondPickedStartDateTime(n), this.setSecondPickedEndDateTime(a) }, setThirdDateTime: function (e) { var t = e[2], i = t.workingTime.split("-"), n = moment(t.date + " " + i[0], s), a = moment(t.date + " " + i[1], s); this.setThirdPickedStartDateTime(n), this.setThirdPickedEndDateTime(a) }, setFirstPickedStartDateTime: function (e) { e = this.resetStartTime(e), this.set("firstPickedStartDateTime", e) }, setFirstPickedEndDateTime: function (e) { e = this.resetEndTime(e), this.set("firstPickedEndDateTime", e) }, setSecondPickedStartDateTime: function (e) { e = this.resetStartTime(e), this.set("secondPickedStartDateTime", e) }, setSecondPickedEndDateTime: function (e) { e = this.resetEndTime(e), this.set("secondPickedEndDateTime", e) }, setThirdPickedStartDateTime: function (e) { e = this.resetStartTime(e), this.set("thirdPickedStartDateTime", e) }, setThirdPickedEndDateTime: function (e) { e = this.resetEndTime(e), this.set("thirdPickedEndDateTime", e) }, resetStartTime: function (e) { return 0 !== (e = moment(e, i)).minutes() && e.add(1, "hour").startOf("hour"), e }, resetEndTime: function (e) { return (e = "24:00" === (e = moment(e, i)) ? moment("00:00", i).add(1, "day") : moment(e, i)).minutes() < 30 ? e.minutes(0) : e.minutes(30), e }, getServerCurrentTime: function () { var t = this; sfAjax.getServerCurrentTime({ success: function (e) { t.set("synServerTim", moment(e, s)) }, error: function () { t.set("synServerTim", moment()) } }) } }) }), define("views/pages/order/cn/bulkShipping/receiverInfo/excelTemplate", ["baseView", "templates", "helper"], function (e, t, i) { return e.extend({ template: t.excelTemplate, layerOpts: { title: _l("从excel文件导入收件人"), area: "760px" }, events: { "click .file-btn": "selectFile", "change .choose-file": "fileChanged", "click .upload": "upload" }, init: function (e) { this.callback = e.callback }, render: function () { this.$el.html(this.template({ templateUrl: i.getResourceURL("file/Batch-Template-" + i.getSiteLocation() + "-" + i.getSiteLanguage() + ".xlsx") })) }, selectFile: function () { this.$(".choose-file").click() }, fileChanged: function () { var e = this.$(".choose-file").val(); if (e) return e.endsWith("xls") || e.endsWith("xlsx") ? void this.$(".file-input").val(this.$(".choose-file").val()) : (this.$(".file-input").val(""), void layer.msg(_l("请选择格式为.xls或.xlsx的文件"))) }, upload: function () { var n = this; if (this.$(".file-input").val()) { var e = layer.load(), t = new FormData; t.append("importedExcel", $("input[name=importedExcel]")[0].files[0]), sfAjax.analysisExcel({ type: "POST", dataType: "json", data: t, contentType: !1, cache: !1, processData: !1, success: function (e) { if (0 === e.code) { var t = e.result, i = _.filter(t, function (e) { return !1 === e.normal }); layer.open({ closeBtn: 0, title: _l("上传结果"), content: _l("<p>成功添加${dataNum}条数据，其中${unnormalNum}条数据异常</p>")._p({ dataNum: t.length, unnormalNum: i.length }) + _l("<p>您可以在结果列表中重新更改</p>"), btn: [_l("确定")], btn1: function (e) { n.callback && n.callback(t), layer.close(e), n.close() } }) } else 661 === e.code ? layer.msg(_l("文件太大")) : 662 === e.code ? layer.msg(_l("excel模板格式不正确，请下载正确的模板。")) : 663 === e.code ? layer.msg(_l("excel模板数据不能为空")) : 664 === e.code ? layer.msg(_l("excel模板数据不能超过100条")) : layer.msg(_l("上传失败")) }, error: function () { layer.msg(_l("上传失败")) }, complete: function () { layer.close(e) } }), "hk" === i.getSiteLocation() ? sfgather.trackClicks("点击上传excel文件按钮", "XWF010208") : sfgather.trackClicks("点击上传excel文件按钮", "OWF010208") } else layer.msg(_l("请选择要上传的文件")) } }) }), define("components/addressBook/bulkShippingAddressBook", ["./addressBook", "helper", "sflayer"], function (e, a) { return e.extend({ init: function (e) { this.addressBooks = e.addressBooks, this.hasSelectAll = !0 }, emptySelectAll: function () { this.$(".selectAll").removeClass("aicon-check").addClass("aicon-uncheck") }, selectAdd: function (e) { this.$(e.target).hasClass("address-check") ? (this.$(e.target).hasClass("aicon-check") ? this.$(e.target).removeClass("aicon-check").addClass("aicon-uncheck") : this.$(e.target).removeClass("aicon-uncheck").addClass("aicon-check"), e.stopPropagation()) : this.$(e.currentTarget).find(".address-check").trigger("click") }, preDblclickToConform: function () { }, confirmAddress: function () { 0 < this.$(".address-check.aicon-check").length ? this.conformSelect() : layer.msg(_l("请选择其中的一条数据")) }, selectAllList: function (e) { this.$(e.currentTarget).hasClass("aicon-check") ? (this.$(e.currentTarget).removeClass("aicon-check").addClass("aicon-uncheck"), this.$(".address-check").removeClass("aicon-check").addClass("aicon-uncheck")) : (this.$(e.currentTarget).removeClass("aicon-uncheck").addClass("aicon-check"), this.$(".address-check").removeClass("aicon-uncheck").addClass("aicon-check")) }, conformSelect: function () { var t = []; _.each(this.$(".address-check.aicon-check"), function (e) { t.push($(e).closest("tr").data("addid")) }); var n = this, e = layer.load(); sfAjax.getAddressById({ data: { id: t.join(",") }, success: function (e) { if (e && 0 == e.code && e.result) { var i = !0; _.each(e.result, function (e) { var t = e.locationCode; if (a.isInternational(t)) return n.locationNotSupport(), i = !1 }), i && (_.each(e.result, function (e) { e.countryCode = e.countryCode || "A000086000" }), n.options.callback(e.result), n.close()) } else layer.msg(_l("网络错误")) }, error: function () { layer.msg(_l("网络错误")) }, login: { succCallback: this.conformSelect.bind(this), cancelCallback: null }, complete: function () { layer.close(e) } }) } }) }), define("views/pages/order/cn/bulkShipping/bulkShippingPriceAndTime", ["baseView", "templates", "../../innerViews/priceAndTime", "sflayer"], function (e, t, i) { return e.extend({ template: t.bulkShippingRate, layerOpts: { title: _l("选择快递产品"), area: "680px" }, init: function () { this.times = 1 }, render: function () { this.$el.html(this.template()), this.priceAndTime = new i({ el: this.$(".product-type-wrapper"), orderModel: this.model, callback: this.resetDefaultProduct.bind(this), type: 1, sLocationCode: this.options.sLocationCode, dLocationCode: this.options.dLocationCode }), this.priceAndTime.fetchTimeAndRate(this.options.data), this.$(".product-type-content").slideDown() }, events: { "click .confirm": "confirmSelect" }, resetDefaultProduct: function (e) { 1 == this.times && ($(window).resize(), this.$(".confirm").removeClass("disabled")), this.times += 1, this.rateData = e }, confirmSelect: function () { this.close(), this.options.callback(this.rateData) } }) }), define("components/changeAppointBill/changeAppointBillCommon", ["baseView", "templates", "components/newBillOptions/cargoMsg", "collections/payFee", "helper", "bus/index", "sflayer"], function (e, t, i, n, a, s) { return e.extend({ layerOpts: { title: _l("设置快件信息"), area: "680px", skin: "line" }, init: function (e) { this.billInfo = e.billInfo, this.destinationAddress = this.billInfo.appointmentDestDetail, this.sLocationCode = this.billInfo.appointmentOriginDetail.locationCode, this.rLocationCode = this.destinationAddress.locationCode, s.setSLocationCode(this.sLocationCode), s.setRLocationCode(this.rLocationCode), this.msgsIndex = this.initmsgIndex(), this.currencyCode = a.getCurrencyByCode(this.sLocationCode), this.rateCollection = new n, this.listenTo(this.rateCollection, "sync", this.getRatePrice), this.listenTo(this.rateCollection, "showDefault", this.getRatePrice) }, initmsgIndex: function () { return s.isHK_MC(this.sLocationCode) ? [0, 1, 3, 4, 5, 6] : s.isTW(this.sLocationCode) ? [0, 2, 3, 4, 5, 7] : [0, 1, 3, 4, 5] }, showReceiver: function () { this.$(".receiver-info").html(t.changeAppointBillReceiver({ receiver: this.destinationAddress })) }, getRatePrice: function () { layer.close(this.loadIndex); var e = this.rateCollection.toJSON(); if (0 == e.length || 1 == e.length && isNaN(parseFloat(e[0].totalFreight))) this.ratePrice = null; else { var t = this, i = _.find(e, function (e) { return e.limitTypeCode == t.billInfo.productInfo.code }); this.ratePrice = i ? i.totalFreight : null } this.changePredictPrice() }, showInsure: function () { this.$(".cargo-insure-show").text(this.supportVal ? _l("保价") + this.currencyCode + this.supportVal : _l("未选择保价")), this.$(".cargo-insure-price-show").text(this.supportVal ? _l("保费") + this.currencyCode + this.supportPrise : "") }, popCargoMsgView: function () { var t = this; new i({ initMsgsIndex: this.msgsIndex, choosedMsg: this.choosedMsg, callback: function (e) { t.choosedMsg = e.msg, t.showMsg() } }) }, showMsg: function () { this.$(".cargo-msg-show").text(this.choosedMsg || _l("无")) }, selfPickToggle: function (e) { this.$(e.currentTarget).toggleClass("active"), this.$(e.currentTarget).hasClass("active") ? this.selfPick = !0 : this.selfPick = !1, this.showSelfPick() }, showSelfPick: function () { this.$(".self-pick-show").text(this.selfPick ? _l("自取") : _l("不自取")) }, queryAddressRange: function () { var e = this.destinationAddress.province + this.destinationAddress.city + this.destinationAddress.county + this.destinationAddress.address, t = this; sfAjax.queryAddressRange({ data: { address: e, dataType: "r01" }, success: function (e) { e && 0 == e.code ? t.queryRangeSucc() : (t.isNotRangeOut = !1, t.showSelfPick(), t.$(".cargo-self-pick-wrapper,.out-range-tip").show()) }, error: function () { t.queryRangeSucc() } }) }, queryRangeSucc: function () { this.isNotRangeOut = !0, this.$(".cargo-self-pick-wrapper,.out-range-tip").hide(), this.selfPick = !1 }, getProductTypeName: function () { var e = this.billInfo.productInfo.code; return "T1" == e || "T104" == e ? "顺丰即日" : "T8" == e || "T801" == e ? "顺丰次晨" : "T4" == e ? "顺丰标快" : "T6" == e ? "顺丰特惠" : "" }, unitChange: function (e) { return "sc" == a.getSiteLanguage() ? e + "元" : "RMB" + e } }) }), define("components/changeAppointBill/bulkChangeAppointBill", ["./changeAppointBillCommon", "templates", "components/newBillOptions/itemsAndWeight", "components/newBillOptions/cargoPayType", "components/newBillOptions/cargoService/index", "components/newBillOptions/cargoInsure", "helper", "const", "bus/index", "sflayer"], function (e, t, n, i, a, s, o, r, l) { var c = o.getSiteLocation(), d = { layerOpts: { title: _l("批量完善快件信息"), area: "680px", skin: "line" }, template: t.bulkChangeAppointBill, init: function (e) { this.cargoMedci = "", this.cargoWeight = 1, this.payType = 1, this.monthAccount = "", this.codCustid = "", this.codAmt = "", this.codType = null, this.signedBackBillIndex = "", this.signedBackBillName = "", this.supportVal = 0, this.supportPrise = 0, this.choosedMsg = "", this.billInfoList = e.billInfoList, this.sLocationCode = this.billInfoList[0].appointmentDetail.appointmentOriginDetail.locationCode, this.rLocationCode = this.billInfoList[0].appointmentDetail.appointmentDestDetail.locationCode, l.setSLocationCode(this.sLocationCode), l.setRLocationCode(this.rLocationCode), this.currencyCode = o.getCurrencyByCode(this.sLocationCode), this.initAttributes() }, initAttributes: function () { this.cargoItems = _l("文件"), this.msgsIndex = [0, 1, 3, 4, 5] }, render: function () { this.$el.html(this.template({ hasCargoMsg: l.batchHasCargoMsg(), hasCargoService: l.hasCargoService(), hasCargoInsure: l.hasCargoInsure() })), this.fetchPriceAndTimes() }, events: { "click .items-weight": "popItemsAndWeightView", "click .cargo-pay-type": "popCargoPayTypeView", "click .cargo-service": "popCargoServiceView", "click .cargo-insure": "popCargoInsureView", "click .cargo-msg": "popCargoMsgView", "click .confirm-change": "submitChange" }, popItemsAndWeightView: function () { var i = this; new n({ choosedItem: this.cargoItems, choosedMedci: this.cargoMedci, weight: this.cargoWeight, callback: function (e) { var t; i.$(".items-show").text(e.items), t = 20 == e.weight ? ">20kg" : e.weight + "kg", i.$(".weight-show").text(t), i.cargoItems = e.items, i.cargoMedci = e.medci, i.cargoWeight = e.weight, i.fetchPriceAndTimes() } }) }, popCargoPayTypeView: function () { var t = this; new i({ chooseType: this.sLocationCode == r.RATE_OF_TW && this.codCustid ? 4 : this.payType, monthAccount: this.monthAccount, whetherCollect: !!this.codCustid, callback: function (e) { t.payType = e.chooseType, t.monthAccount = e.monthAccount, t.$(".pay-type-show").text(_l(o.getPayType(e.chooseType))) } }) }, popCargoServiceView: function () { var i = this; new a({ signedBackBillIndex: this.signedBackBillIndex, codAmt: this.codAmt, codCustid: this.codCustid, callback: function (e) { i.signedBackBillIndex = e.signedBackBillIndex, i.signedBackBillName = e.signedBackBillName, void 0 === e.customerCode ? (i.codAmt = "", i.codCustid = "", i.codType = null) : (i.codAmt = e.amount, i.codCustid = e.customerCode, i.codType = e.isScatterCod); var t = i.signedBackBillIndex ? i.signedBackBillName : i.codCustid ? _l("代收货款") : _l("无增值服务"); i.$(".servive-show").text(t), _.forEach(i.billInfoList, function (e) { i.changePredictPrice(e) }) } }) }, popCargoInsureView: function () { var t = this; this.cargoInsure = new s({ supportPrise: this.supportPrise, supportVal: this.supportVal, times: 7, currencyCode: this.currencyCode, sLocationCode: this.sLocationCode, rLocationCode: this.rLocationCode, callback: function (e) { t.supportPrise = e.supportPrise, t.supportVal = e.supportVal, t.$(".cargo-insure-show").text(t.supportVal ? _l("保价") + t.currencyCode + t.supportVal : _l("未选择保价")), t.$(".cargo-insure-price-show").text(t.supportVal ? _l("保费") + t.currencyCode + t.supportPrise : ""), _.forEach(t.billInfoList, function (e) { t.changePredictPrice(e) }) } }) }, changePredictPrice: function (e) { var t = isNaN(parseFloat(this.supportPrise)) ? 0 : parseFloat(this.supportPrise), i = "" === this.signedBackBillIndex ? 0 : 5; e.appointmentDetail.metaPrice = parseFloat(e.appointmentDetail.ratePrice) + t + i || "--" }, getBookingTime: function (e) { var t; return t = e.expectStartTm ? e.expectStartTm : e.appointmentTime, moment(t, "YYYY-MM-DD HH:mm:ss").format() }, getPriceAndTimesParams: function () { var t = [], i = this; this.locationCodes = []; var e = _.uniq(_.map(this.billInfoList, function (e) { var t = e.appointmentDetail.appointmentDestDetail; return i.locationCodes.push(t.locationCode), e.appointmentDetail.appointmentDestDetail.countyCode })); return _.forEach(e, function (e) { t.push({ dest: e, weight: i.cargoWeight, queryType: "2", volume: 1 }) }), { origin: this.billInfoList[0].appointmentDetail.appointmentOriginDetail.countyCode, time: moment().format(), payFeeRates: t } }, fetchPriceAndTimes: function () { var r = this, e = layer.load(0, { shade: !1 }); sfAjax.bulkGetPayFee({ data: this.getPriceAndTimesParams(), success: function (e) { e && 0 < e.length && _.forEach(e, function (t, e) { var i = _.filter(r.billInfoList, function (e) { return e.appointmentDetail.appointmentDestDetail.countyCode === t.destCode || e.appointmentDetail.appointmentDestDetail.cityCode === t.destCode }); if ("tw" === o.getSiteLocation() && !t.success) { t.success = !0; var n = { limitTypeCode: "T4", limitTypeName: _l("顺丰标快"), deliverTime: moment().add(2, "day").format("YYYY-MM-DD 18:00"), closedTime: null, totalFreight: _l("以收派员巴枪价格为准") }; o.isHK(r.locationCodes[e]) ? n.totalFreight = 100 : o.isMC(r.locationCodes[e]) ? n.totalFreight = 125 : o.isTW(r.locationCodes[e]) ? (n.totalFreight = 80, n.deliverTime = moment().add(1, "day").format("YYYY-MM-DD 18:00")) : n.totalFreight = 126, t.rate = [], t.rate.push(n) } if (t.success && t.rate) { var a = t.rate; if (0 < a.length && 0 < i.length) { var s = _.find(a, function (e) { return e.limitTypeCode === i[0].appointmentDetail.productInfo.code }); s && _.forEach(i, function (e) { e.appointmentDetail.ratePrice = s.totalFreight, r.changePredictPrice(e) }) } } else i && 0 < i.length && _.forEach(i, function (e) { e.appointmentDetail.ratePrice = 0, r.changePredictPrice(e) }) }) }, error: function () { layer.msg(_l("批量获取运费时效产品失败！")) }, complete: function () { layer.close(e) } }) }, getProductTypeName: function (e) { return "T1" === e || "T104" === e ? "顺丰即日" : "T8" === e || "T801" === e ? "顺丰次晨" : "T4" === e ? "顺丰标快" : "T6" === e ? "顺丰特惠" : "SE0100" === e ? "重货包裹" : "SE0101" === e ? "小票零担" : "" }, validatePayType: function () { return 1 == this.codType && 2 == this.payType ? (layer.msg(_l("非月结客户的代收货款服务暂不支持“到付”")), !1) : !this.codCustid || 4 == this.payType || (layer.alert(_l("代收货款暂时只支持寄付月结付款")), !1) }, submitChange: function () { if (this.validatePayType()) { var i = [], r = this; _.forEach(this.billInfoList, function (e, t) { i.push({ index: t, appointmentNo: e.appointmentNo, appointmentTime: e.appointmentDetail.appointmentTime, pickupType: e.appointmentDetail.pickupType, destinationAddress: e.appointmentDetail.appointmentDestDetail, remark: l.batchHasCargoMsg() ? r.choosedMsg : e.appointmentDetail.remark, productCode: e.appointmentDetail.productInfo.code, productName: r.getProductTypeName(e.appointmentDetail.productInfo.code), metaWeight: r.cargoWeight, metaPrice: "--" === e.appointmentDetail.metaPrice ? 0 : e.appointmentDetail.metaPrice, cargoList: [{ name: r.cargoItems.substring(0, 10), uom: "", desc: r.cargoMedci, price: "0" }], freightFeeCode: e.appointmentDetail.freightFee.code || 1, freightFeeAmt: e.appointmentDetail.freightFee.amt, paymethod: r.payType, custid: r.monthAccount, supportValue: l.hasCargoInsure() ? r.supportVal : e.appointmentDetail.declaredValue, premium: l.hasCargoInsure() ? r.supportPrise : e.appointmentDetail.inSurance, notificationMsg: l.hasCargoService() ? r.signedBackBillName : e.appointmentDetail.signedBackDetail.signedBackName, signedBackFlg: l.hasCargoService() ? "" === r.signedBackBillIndex ? 0 : 1 : e.appointmentDetail.signedBackDetail.signedBackFlg, signedBackName: l.hasCargoService() ? r.signedBackBillName : e.appointmentDetail.signedBackDetail.signedBackName, signedBackSop: l.hasCargoService() ? r.signedBackBillIndex : e.appointmentDetail.signedBackDetail.signedBackSop, codAmt: l.hasCargoService() ? r.codAmt : e.appointmentDetail.codAmt, codCustid: l.hasCargoService() ? r.codCustid : e.appointmentDetail.codCustid }) }); var e = layer.load(0, { shade: [.2, "#000"] }); sfAjax.bulkUpdateAppointBill({ data: i, success: function (e) { if (e && 0 === e.code) { var t = e.result; if (t && 0 < t.length) { var i = _.filter(t, function (e) { return e.success }), n = _.filter(t, function (e) { return !e.success }), a = { succ: i.length, fail: n.length }; if (0 == a.succ) layer.msg(_l("修改失败")); else { var s = _l("修改成功${succ}条，失败${fail}条"); layer.alert(s._p(a), function (e) { layer.close(e), r.options.callback(), r.close() }) } } else layer.msg(_l("修改失败")) } else layer.msg(_l("修改失败")) }, error: function () { layer.msg(_l("修改失败")) }, complete: function () { layer.close(e) }, login: { succCallback: r.submitChange.bind(this), cancelCallback: function () { layer.msg(_l("修改失败")) } } }) } } }, u = { initAttributes: function () { this.cargoItems = "", this.msgsIndex = [0, 1, 3, 4, 5, 6] }, getPriceAndTimesParams: function () { var t = [], i = this; this.locationCodes = []; var e = _.uniq(_.map(this.billInfoList, function (e) { var t = e.appointmentDetail.appointmentDestDetail; return i.locationCodes.push(t.locationCode), o.isHK_MC_TW(t.locationCode) ? t.cityCode : t.countyCode })); _.forEach(e, function (e) { t.push({ dest: e, weight: i.cargoWeight, queryType: "12", volume: 1 }) }); var n = this.billInfoList[0].appointmentDetail.appointmentOriginDetail; return { origin: o.isHK_MC_TW(n.locationCode) ? n.cityCode : n.countyCode, time: moment().format(), payFeeRates: t } } }; return "cn" === c ? e.extend(d) : "hk" === c ? e.extend(_.extend(d, u)) : "tw" === c ? e.extend(_.extend(d, u, {})) : void 0 }), function (e, t) { "object" == typeof exports && "undefined" != typeof module ? module.exports = t() : "function" == typeof define && define.amd ? define("jspdf", t) : e.jsPDF = t() }(this, function () { "use strict"; var e, v, t, S, a, s, r, l, $, A, p, f, I, i, n, o, c, D, P, j, m, g, _, d, y, b, w, C, u, x, k, h, T, L, M, R, O, E, N, B, F, q, U, H, W, V, z, Y, G, Q, J, K, X, ye = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (e) { return typeof e } : function (e) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e }, Z = function (fe) { var me = "1.3", ge = { a0: [2383.94, 3370.39], a1: [1683.78, 2383.94], a2: [1190.55, 1683.78], a3: [841.89, 1190.55], a4: [595.28, 841.89], a5: [419.53, 595.28], a6: [297.64, 419.53], a7: [209.76, 297.64], a8: [147.4, 209.76], a9: [104.88, 147.4], a10: [73.7, 104.88], b0: [2834.65, 4008.19], b1: [2004.09, 2834.65], b2: [1417.32, 2004.09], b3: [1000.63, 1417.32], b4: [708.66, 1000.63], b5: [498.9, 708.66], b6: [354.33, 498.9], b7: [249.45, 354.33], b8: [175.75, 249.45], b9: [124.72, 175.75], b10: [87.87, 124.72], c0: [2599.37, 3676.54], c1: [1836.85, 2599.37], c2: [1298.27, 1836.85], c3: [918.43, 1298.27], c4: [649.13, 918.43], c5: [459.21, 649.13], c6: [323.15, 459.21], c7: [229.61, 323.15], c8: [161.57, 229.61], c9: [113.39, 161.57], c10: [79.37, 113.39], dl: [311.81, 623.62], letter: [612, 792], "government-letter": [576, 756], legal: [612, 1008], "junior-legal": [576, 360], ledger: [1224, 792], tabloid: [792, 1224], "credit-card": [153, 243] }; function _e(s) { var r = {}; this.subscribe = function (e, t, i) { if ("function" != typeof t) return !1; r.hasOwnProperty(e) || (r[e] = {}); var n = Math.random().toString(35); return r[e][n] = [t, !!i], n }, this.unsubscribe = function (e) { for (var t in r) if (r[t][e]) return delete r[t][e], !0; return !1 }, this.publish = function (e) { if (r.hasOwnProperty(e)) { var t = Array.prototype.slice.call(arguments, 1), i = []; for (var n in r[e]) { var a = r[e][n]; try { a[0].apply(s, t) } catch (e) { fe.console } a[1] && i.push(n) } i.length && i.forEach(this.unsubscribe) } } } function ve(e, t, i, n) { var a = {}; "object" === (void 0 === e ? "undefined" : ye(e)) && (e = (a = e).orientation, t = a.unit || t, i = a.format || i, n = a.compress || a.compressPdf || n), t = t || "mm", i = i || "a4", e = ("" + (e || "P")).toLowerCase(); ("" + i).toLowerCase(); var J, _, v, s, u, y, r, o, l, c, d, h = !!n && "function" == typeof Uint8Array, K = a.textColor || "0 g", p = a.drawColor || "0 G", X = a.fontSize || 16, Z = a.charSpace || 0, ee = a.R2L || !1, te = a.lineHeight || 1.15, f = a.lineWidth || .200025, m = "00000000000000000000000000000000", g = 2, b = !1, w = [], ie = {}, C = {}, x = 0, k = [], T = [], S = [], $ = [], A = [], I = 0, D = 0, P = 0, j = { title: "", subject: "", author: "", keywords: "", creator: "" }, L = {}, ne = new _e(L), M = a.hotfixes || [], R = function (e) { var t, i = e.ch1, n = e.ch2, a = e.ch3, s = e.ch4, r = (e.precision, "draw" === e.pdfColorType ? ["G", "RG", "K"] : ["g", "rg", "k"]); if ("string" == typeof i && "#" !== i.charAt(0)) { var o = new RGBColor(i); o.ok && (i = o.toHex()) } if ("string" == typeof i && /^#[0-9A-Fa-f]{3}$/.test(i) && (i = "#" + i[1] + i[1] + i[2] + i[2] + i[3] + i[3]), "string" == typeof i && /^#[0-9A-Fa-f]{6}$/.test(i)) { var l = parseInt(i.substr(1), 16); i = l >> 16 & 255, n = l >> 8 & 255, a = 255 & l } if (void 0 === n || void 0 === s && i === n && n === a) if ("string" == typeof i) t = i + " " + r[0]; else switch (e.precision) { case 2: t = F(i / 255) + " " + r[0]; break; case 3: default: t = q(i / 255) + " " + r[0] } else if (void 0 === s || "object" === (void 0 === s ? "undefined" : ye(s))) { if ("string" == typeof i) t = [i, n, a, r[1]].join(" "); else switch (e.precision) { case 2: t = [F(i / 255), F(n / 255), F(a / 255), r[1]].join(" "); break; default: case 3: t = [q(i / 255), q(n / 255), q(a / 255), r[1]].join(" ") }s && 0 === s.a && (t = ["255", "255", "255", r[1]].join(" ")) } else if ("string" == typeof i) t = [i, n, a, s, r[2]].join(" "); else switch (e.precision) { case 2: t = [F(i), F(n), F(a), F(s), r[2]].join(" "); break; case 3: default: t = [q(i), q(n), q(a), q(s), r[2]].join(" ") }return t }, O = function (e) { var t = function (e) { return ("0" + parseInt(e)).slice(-2) }, i = e.getTimezoneOffset(), n = i < 0 ? "+" : "-", a = Math.floor(Math.abs(i / 60)), s = Math.abs(i % 60), r = [n, t(a), "'", t(s), "'"].join(""); return ["D:", e.getFullYear(), t(e.getMonth() + 1), t(e.getDate()), t(e.getHours()), t(e.getMinutes()), t(e.getSeconds()), r].join("") }, E = function (e) { var t; return void 0 === (void 0 === e ? "undefined" : ye(e)) && (e = new Date), t = "object" === (void 0 === e ? "undefined" : ye(e)) && "[object Date]" === Object.prototype.toString.call(e) ? O(e) : /^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|\-0[0-9]|\-1[0-1])\'(0[0-9]|[1-5][0-9])\'?$/.test(e) ? e : O(new Date), c = t }, N = function (e) { var t = c; return "jsDate" === e && (t = function (e) { var t = parseInt(e.substr(2, 4), 10), i = parseInt(e.substr(6, 2), 10) - 1, n = parseInt(e.substr(8, 2), 10), a = parseInt(e.substr(10, 2), 10), s = parseInt(e.substr(12, 2), 10), r = parseInt(e.substr(14, 2), 10); parseInt(e.substr(16, 2), 10), parseInt(e.substr(20, 2), 10); return new Date(t, i, n, a, s, r, 0) }(c)), t }, B = function (e) { return e = e || "12345678901234567890123456789012".split("").map(function () { return "ABCDEF0123456789".charAt(Math.floor(16 * Math.random())) }).join(""), m = e }, F = function (e) { return e.toFixed(2) }, q = function (e) { return e.toFixed(3) }, ae = function (e) { e = "string" == typeof e ? e : e.toString(), b ? k[s].push(e) : (P += e.length + 1, $.push(e)) }, U = function () { return w[++g] = P, ae(g + " 0 obj"), g }, H = function (e) { ae("stream"), ae(e), ae("endstream") }, W = function () { for (var e in ae("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"), ae("/Font <<"), ie) ie.hasOwnProperty(e) && ae("/" + e + " " + ie[e].objectNumber + " 0 R"); ae(">>"), ae("/XObject <<"), ne.publish("putXobjectDict"), ae(">>") }, V = function () { !function () { for (var e in ie) ie.hasOwnProperty(e) && (t = ie[e], ne.publish("putFont", { font: t, out: ae, newObject: U }), !0 !== t.isAlreadyPutted && (t.objectNumber = U(), ae("<<"), ae("/Type /Font"), ae("/BaseFont /" + t.postScriptName), ae("/Subtype /Type1"), "string" == typeof t.encoding && ae("/Encoding /" + t.encoding), ae("/FirstChar 32"), ae("/LastChar 255"), ae(">>"), ae("endobj"))); var t }(), ne.publish("putResources"), w[2] = P, ae("2 0 obj"), ae("<<"), W(), ae(">>"), ae("endobj"), ne.publish("postPutResources") }, z = function (e, t, i) { C.hasOwnProperty(t) || (C[t] = {}), C[t][i] = e }, Y = function (e, t, i, n) { var a = "F" + (Object.keys(ie).length + 1).toString(10), s = ie[a] = { id: a, postScriptName: e, fontName: t, fontStyle: i, encoding: n, metadata: {} }; return z(a, t, i), ne.publish("addFont", s), a }, se = function (e, t) { return function (e, t) { var i, n, a, s, r, o, l, c, d; if (a = (t = t || {}).sourceEncoding || "Unicode", r = t.outputEncoding, (t.autoencode || r) && ie[J].metadata && ie[J].metadata[a] && ie[J].metadata[a].encoding && (s = ie[J].metadata[a].encoding, !r && ie[J].encoding && (r = ie[J].encoding), !r && s.codePages && (r = s.codePages[0]), "string" == typeof r && (r = s[r]), r)) { for (l = !1, o = [], i = 0, n = e.length; i < n; i++)(c = r[e.charCodeAt(i)]) ? o.push(String.fromCharCode(c)) : o.push(e[i]), o[i].charCodeAt(0) >> 8 && (l = !0); e = o.join("") } for (i = e.length; void 0 === l && 0 !== i;)e.charCodeAt(i - 1) >> 8 && (l = !0), i--; if (!l) return e; for (o = t.noBOM ? [] : [254, 255], i = 0, n = e.length; i < n; i++) { if ((d = (c = e.charCodeAt(i)) >> 8) >> 8) throw new Error("Character at position " + i + " of string '" + e + "' exceeds 16bits. Cannot be encoded into UCS-2 BE"); o.push(d), o.push(c - (d << 8)) } return String.fromCharCode.apply(void 0, o) }(e, t).replace(/\\/g, "\\\\").replace(/\(/g, "\\(").replace(/\)/g, "\\)") }, G = function () { (function (e, t) { var i = "string" == typeof t && t.toLowerCase(); if ("string" == typeof e) { var n = e.toLowerCase(); ge.hasOwnProperty(n) && (e = ge[n][0] / _, t = ge[n][1] / _) } if (Array.isArray(e) && (t = e[1], e = e[0]), i) { switch (i.substr(0, 1)) { case "l": e < t && (i = "s"); break; case "p": t < e && (i = "s") }"s" === i && (v = e, e = t, t = v) } b = !0, k[++x] = [], S[x] = { width: Number(e) || u, height: Number(t) || y }, T[x] = {}, Q(x) }).apply(this, arguments), ae(F(f * _) + " w"), ae(p), 0 !== I && ae(I + " J"), 0 !== D && ae(D + " j"), ne.publish("addPage", { pageNumber: x }) }, Q = function (e) { 0 < e && e <= x && (u = S[s = e].width, y = S[e].height) }, re = function (e, t, i) { var n, a = void 0; return i = i || {}, e = void 0 !== e ? e : ie[J].fontName, t = void 0 !== t ? t : ie[J].fontStyle, n = e.toLowerCase(), void 0 !== C[n] && void 0 !== C[n][t] ? a = C[n][t] : void 0 !== C[e] && void 0 !== C[e][t] ? a = C[e][t] : i.disableWarning, a || i.noFallback || null == (a = C.times[t]) && (a = C.times.normal), a }, oe = function () { b = !1, g = 2, P = 0, $ = [], w = [], A = [], ne.publish("buildDocument"), ae("%PDF-" + me), ae("%ºß¬à"), function () { var e, t, i, n, a, s, r, o, l, c = []; for (r = fe.adler32cs || ve.API.adler32cs, h && void 0 === r && (h = !1), e = 1; e <= x; e++) { if (c.push(U()), o = (u = S[e].width) * _, l = (y = S[e].height) * _, ae("<</Type /Page"), ae("/Parent 1 0 R"), ae("/Resources 2 0 R"), ae("/MediaBox [0 0 " + F(o) + " " + F(l) + "]"), ne.publish("putPage", { pageNumber: e, page: k[e] }), ae("/Contents " + (g + 1) + " 0 R"), ae(">>"), ae("endobj"), t = k[e].join("\n"), U(), h) { for (i = [], n = t.length; n--;)i[n] = t.charCodeAt(n); s = r.from(t), (a = new Deflater(6)).append(new Uint8Array(i)), t = a.flush(), (i = new Uint8Array(t.length + 6)).set(new Uint8Array([120, 156])), i.set(t, 2), i.set(new Uint8Array([255 & s, s >> 8 & 255, s >> 16 & 255, s >> 24 & 255]), t.length + 2), t = String.fromCharCode.apply(null, i), ae("<</Length " + t.length + " /Filter [/FlateDecode]>>") } else ae("<</Length " + t.length + ">>"); H(t), ae("endobj") } w[1] = P, ae("1 0 obj"), ae("<</Type /Pages"); var d = "/Kids ["; for (n = 0; n < x; n++)d += c[n] + " 0 R "; ae(d + "]"), ae("/Count " + x), ae(">>"), ae("endobj"), ne.publish("postPutPages") }(), function () { ne.publish("putAdditionalObjects"); for (var e = 0; e < A.length; e++) { var t = A[e]; w[t.objId] = P, ae(t.objId + " 0 obj"), ae(t.content), ae("endobj") } g += A.length, ne.publish("postPutAdditionalObjects") }(), V(), U(), ae("<<"), function () { for (var e in ae("/Producer (jsPDF " + ve.version + ")"), j) j.hasOwnProperty(e) && j[e] && ae("/" + e.substr(0, 1).toUpperCase() + e.substr(1) + " (" + se(j[e]) + ")"); ae("/CreationDate (" + c + ")") }(), ae(">>"), ae("endobj"), U(), ae("<<"), function () { switch (ae("/Type /Catalog"), ae("/Pages 1 0 R"), o || (o = "fullwidth"), o) { case "fullwidth": ae("/OpenAction [3 0 R /FitH null]"); break; case "fullheight": ae("/OpenAction [3 0 R /FitV null]"); break; case "fullpage": ae("/OpenAction [3 0 R /Fit]"); break; case "original": ae("/OpenAction [3 0 R /XYZ null null 1]"); break; default: var e = "" + o; "%" === e.substr(e.length - 1) && (o = parseInt(o) / 100), "number" == typeof o && ae("/OpenAction [3 0 R /XYZ null null " + F(o) + "]") }switch (l || (l = "continuous"), l) { case "continuous": ae("/PageLayout /OneColumn"); break; case "single": ae("/PageLayout /SinglePage"); break; case "two": case "twoleft": ae("/PageLayout /TwoColumnLeft"); break; case "tworight": ae("/PageLayout /TwoColumnRight") }r && ae("/PageMode /" + r), ne.publish("putCatalog") }(), ae(">>"), ae("endobj"); var e, t = P, i = "0000000000"; for (ae("xref"), ae("0 " + (g + 1)), ae(i + " 65535 f "), e = 1; e <= g; e++) { var n = w[e]; ae("function" == typeof n ? (i + w[e]()).slice(-10) + " 00000 n " : (i + w[e]).slice(-10) + " 00000 n ") } return ae("trailer"), ae("<<"), ae("/Size " + (g + 1)), ae("/Root " + g + " 0 R"), ae("/Info " + (g - 1) + " 0 R"), ae("/ID [ <" + m + "> <" + m + "> ]"), ae(">>"), ae("startxref"), ae("" + t), ae("%%EOF"), b = !0, $.join("\n") }, le = function (e) { var t = "S"; return "F" === e ? t = "f" : "FD" === e || "DF" === e ? t = "B" : "f" !== e && "f*" !== e && "B" !== e && "B*" !== e || (t = e), t }, ce = function () { for (var e = oe(), t = e.length, i = new ArrayBuffer(t), n = new Uint8Array(i); t--;)n[t] = e.charCodeAt(t); return i }, de = function () { return new Blob([ce()], { type: "application/pdf" }) }, ue = ((d = function (e, t) { var i = "dataur" === ("" + e).substr(0, 6) ? "data:application/pdf;base64," + btoa(oe()) : 0; switch (e) { case void 0: return oe(); case "save": if ("object" === ("undefined" == typeof navigator ? "undefined" : ye(navigator)) && navigator.getUserMedia && (void 0 === fe.URL || void 0 === fe.URL.createObjectURL)) return L.output("dataurlnewwindow"); be(de(), t), "function" == typeof be.unload && fe.setTimeout && setTimeout(be.unload, 911); break; case "arraybuffer": return ce(); case "blob": return de(); case "bloburi": case "bloburl": return fe.URL && fe.URL.createObjectURL(de()) || void 0; case "datauristring": case "dataurlstring": return i; case "dataurlnewwindow": var n = fe.open(i); if (n || "undefined" == typeof safari) return n; case "datauri": case "dataurl": return fe.document.location.href = i; default: throw new Error('Output type "' + e + '" is not supported.') } }).foo = function () { try { return d.apply(this, arguments) } catch (e) { var t = e.stack || ""; ~t.indexOf(" at ") && (t = t.split(" at ")[1]); var i = "Error in function " + t.split("\n")[0].split("<")[0] + ": " + e.message; if (!fe.console) throw new Error(i); fe.console.error(i, e), fe.alert && alert(i) } }, (d.foo.bar = d).foo), he = function (e) { return !0 === Array.isArray(M) && -1 < M.indexOf(e) }; switch (t) { case "pt": _ = 1; break; case "mm": _ = 72 / 25.4; break; case "cm": _ = 72 / 2.54; break; case "in": _ = 72; break; case "px": _ = 1 == he("px_scaling") ? .75 : 96 / 72; break; case "pc": case "em": _ = 12; break; case "ex": _ = 6; break; default: throw "Invalid unit: " + t }for (var pe in E(), B(), L.internal = { pdfEscape: se, getStyle: le, getFont: function () { return ie[re.apply(L, arguments)] }, getFontSize: function () { return X }, getCharSpace: function () { return Z }, getTextColor: function () { var e = K.split(" "); if (2 === e.length && "g" === e[1]) { var t = parseFloat(e[0]); e = [t, t, t, "r"] } for (var i = "#", n = 0; n < 3; n++)i += ("0" + Math.floor(255 * parseFloat(e[n])).toString(16)).slice(-2); return i }, getLineHeight: function () { return X * te }, write: function (e) { ae(1 === arguments.length ? e : Array.prototype.join.call(arguments, " ")) }, getCoordinateString: function (e) { return F(e * _) }, getVerticalCoordinateString: function (e) { return F((y - e) * _) }, collections: {}, newObject: U, newAdditionalObject: function () { var e = 2 * k.length + 1, t = { objId: e += A.length, content: "" }; return A.push(t), t }, newObjectDeferred: function () { return w[++g] = function () { return P }, g }, newObjectDeferredBegin: function (e) { w[e] = P }, putStream: H, events: ne, scaleFactor: _, pageSize: { getWidth: function () { return u }, getHeight: function () { return y } }, output: function (e, t) { return ue(e, t) }, getNumberOfPages: function () { return k.length - 1 }, pages: k, out: ae, f2: F, getPageInfo: function (e) { return { objId: 2 * (e - 1) + 3, pageNumber: e, pageContext: T[e] } }, getCurrentPageInfo: function () { return { objId: 2 * (s - 1) + 3, pageNumber: s, pageContext: T[s] } }, getPDFVersion: function () { return me }, hasHotfix: he }, L.addPage = function () { return G.apply(this, arguments), this }, L.setPage = function () { return Q.apply(this, arguments), this }, L.insertPage = function (e) { return this.addPage(), this.movePage(s, e), this }, L.movePage = function (e, t) { if (t < e) { for (var i = k[e], n = S[e], a = T[e], s = e; t < s; s--)k[s] = k[s - 1], S[s] = S[s - 1], T[s] = T[s - 1]; k[t] = i, S[t] = n, T[t] = a, this.setPage(t) } else if (e < t) { for (i = k[e], n = S[e], a = T[e], s = e; s < t; s++)k[s] = k[s + 1], S[s] = S[s + 1], T[s] = T[s + 1]; k[t] = i, S[t] = n, T[t] = a, this.setPage(t) } return this }, L.deletePage = function () { return function (e) { 0 < e && e <= x && (k.splice(e, 1), S.splice(e, 1), --x < s && (s = x), this.setPage(s)) }.apply(this, arguments), this }, L.setCreationDate = function (e) { return E(e), this }, L.getCreationDate = function (e) { return N(e) }, L.setFileId = function (e) { return B(e), this }, L.getFileId = function () { return m }, L.setDisplayMode = function (e, t, i) { if (o = e, l = t, -1 == [void 0, null, "UseNone", "UseOutlines", "UseThumbs", "FullScreen"].indexOf(r = i)) throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "' + i + '" is not recognized.'); return this }, L.text = function (e, t, i, a) { var n, s, r = "", o = te, l = this; function c(e) { for (var t, i = e.concat(), n = [], a = i.length; a--;)"string" == typeof (t = i.shift()) ? n.push(t) : "[object Array]" === Object.prototype.toString.call(e) && 1 === t.length ? n.push(t[0]) : n.push([t[0], t[1], t[2]]); return n } function d(e, t) { var i; if ("string" == typeof e) i = t(e)[0]; else if ("[object Array]" === Object.prototype.toString.call(e)) { for (var n, a, s = e.concat(), r = [], o = s.length; o--;)"string" == typeof (n = s.shift()) ? r.push(t(n)[0]) : "[object Array]" === Object.prototype.toString.call(n) && "string" === n[0] && (a = t(n[0], n[1], n[2]), r.push([a[0], a[1], a[2]])); i = r } return i } "number" == typeof e && (s = i, i = t, t = e, e = s); var u = a, h = arguments[4], p = arguments[5]; "object" === (void 0 === u ? "undefined" : ye(u)) && null !== u || ("string" == typeof h && (p = h, h = null), "string" == typeof u && (p = u, u = null), "number" == typeof u && (h = u, u = null), a = { flags: u, angle: h, align: p }); var f = !1, m = !0; if ("string" == typeof e) f = !0; else if ("[object Array]" === Object.prototype.toString.call(e)) { for (var g, _ = e.concat(), v = [], y = _.length; y--;)("string" != typeof (g = _.shift()) || "[object Array]" === Object.prototype.toString.call(g) && "string" != typeof g[0]) && (m = !1); f = m } if (!1 === f) throw new Error('Type of text must be string or Array. "' + e + '" is not recognized.'); var b = ie[J].encoding; "WinAnsiEncoding" !== b && "StandardEncoding" !== b || (e = d(e, function (e, t, i) { return [(n = e, n = n.split("\t").join(Array(a.TabLen || 9).join(" ")), se(n, u)), t, i]; var n })), "string" == typeof e && (e = e.match(/[\r?\n]/) ? e.split(/\r\n|\r|\n/g) : [e]), 0 < (O = a.maxWidth || 0) && ("string" == typeof e ? e = l.splitTextToSize(e, O) : "[object Array]" === Object.prototype.toString.call(e) && (e = l.splitTextToSize(e.join(" "), O))); var w = { text: e, x: t, y: i, options: a, mutex: { pdfEscape: se, activeFontKey: J, fonts: ie, activeFontSize: X } }; ne.publish("preProcessText", w), e = w.text; h = (a = w.options).angle; var C = l.internal.scaleFactor, x = (l.internal.pageSize.getHeight(), []); if (h) { h *= Math.PI / 180; var k = Math.cos(h), T = Math.sin(h), S = function (e) { return e.toFixed(2) }; x = [S(k), S(T), S(-1 * T), S(k)] } void 0 !== (R = a.charSpace) && (r += R + " Tc\n"); a.lang; var $ = -1, A = a.renderingMode || a.stroke, I = l.internal.getCurrentPageInfo().pageContext; switch (A) { case 0: case !1: case "fill": $ = 0; break; case 1: case !0: case "stroke": $ = 1; break; case 2: case "fillThenStroke": $ = 2; break; case 3: case "invisible": $ = 3; break; case 4: case "fillAndAddForClipping": $ = 4; break; case 5: case "strokeAndAddPathForClipping": $ = 5; break; case 6: case "fillThenStrokeAndAddToPathForClipping": $ = 6; break; case 7: case "addToPathForClipping": $ = 7 }var D = I.usedRenderingMode || -1; -1 !== $ ? r += $ + " Tr\n" : -1 !== D && (r += "0 Tr\n"), -1 !== $ && (I.usedRenderingMode = $); p = a.align || "left"; var P = X * o, j = l.internal.pageSize.getHeight(), L = l.internal.pageSize.getWidth(), M = (C = l.internal.scaleFactor, ie[J]), R = a.charSpace || Z, O = a.maxWidth || 0, E = (u = {}, []); if ("[object Array]" === Object.prototype.toString.call(e)) { var N, B; v = c(e); "left" !== p && (B = v.map(function (e) { return l.getStringUnitWidth(e, { font: M, charSpace: R, fontSize: X }) * X / C })); var F, q = Math.max.apply(Math, B), U = 0; if ("right" === p) { t -= B[0], e = []; var H = 0; for (y = v.length; H < y; H++)q - B[H], 0 === H ? (F = t * C, N = (j - i) * C) : (F = (U - B[H]) * C, N = -P), e.push([v[H], F, N]), U = B[H] } else if ("center" === p) { t -= B[0] / 2, e = []; for (H = 0, y = v.length; H < y; H++)(q - B[H]) / 2, 0 === H ? (F = t * C, N = (j - i) * C) : (F = (U - B[H]) / 2 * C, N = -P), e.push([v[H], F, N]), U = B[H] } else if ("left" === p) { e = []; for (H = 0, y = v.length; H < y; H++)N = 0 === H ? (j - i) * C : -P, F = 0 === H ? t * C : 0, e.push(v[H]) } else { if ("justify" !== p) throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".'); e = []; for (O = 0 !== O ? O : L, H = 0, y = v.length; H < y; H++)N = 0 === H ? (j - i) * C : -P, F = 0 === H ? t * C : 0, H < y - 1 && E.push(((O - B[H]) / (v[H].split(" ").length - 1) * C).toFixed(2)), e.push([v[H], F, N]) } } !0 === ("boolean" == typeof a.R2L ? a.R2L : ee) && (e = d(e, function (e, t, i) { return [e.split("").reverse().join(""), t, i] })); w = { text: e, x: t, y: i, options: a, mutex: { pdfEscape: se, activeFontKey: J, fonts: ie, activeFontSize: X } }; ne.publish("postProcessText", w), e = w.text, n = w.mutex.isHex; v = c(e); e = []; var W, V, z, Y = 0, G = (y = v.length, ""); for (H = 0; H < y; H++)G = "", "[object Array]" !== Object.prototype.toString.call(v[H]) ? (W = parseFloat(t * C).toFixed(2), V = parseFloat((j - i) * C).toFixed(2), z = (n ? "<" : "(") + v[H] + (n ? ">" : ")")) : "[object Array]" === Object.prototype.toString.call(v[H]) && (W = parseFloat(v[H][1]).toFixed(2), V = parseFloat(v[H][2]).toFixed(2), z = (n ? "<" : "(") + v[H][0] + (n ? ">" : ")"), Y = 1), void 0 !== E && void 0 !== E[H] && (G = E[H] + " Tw\n"), 0 !== x.length && 0 === H ? e.push(G + x.join(" ") + " " + W + " " + V + " Tm\n" + z) : 1 === Y || 0 === Y && 0 === H ? e.push(G + W + " " + V + " Td\n" + z) : e.push(G + z); e = 0 === Y ? e.join(" Tj\nT* ") : e.join(" Tj\n"), e += " Tj\n"; var Q = "BT\n/" + J + " " + X + " Tf\n" + (X * o).toFixed(2) + " TL\n" + K + "\n"; return Q += r, Q += e, ae(Q += "ET"), l }, L.lstext = function (e, t, i, n) { for (var a = 0, s = e.length; a < s; a++ , t += n)this.text(e[a], t, i); return this }, L.line = function (e, t, i, n) { return this.lines([[i - e, n - t]], e, t) }, L.clip = function () { ae("W"), ae("S") }, L.clip_fixed = function (e) { ae("evenodd" === e ? "W*" : "W"), ae("n") }, L.lines = function (e, t, i, n, a, s) { var r, o, l, c, d, u, h, p, f, m, g; for ("number" == typeof e && (v = i, i = t, t = e, e = v), n = n || [1, 1], ae(q(t * _) + " " + q((y - i) * _) + " m "), r = n[0], o = n[1], c = e.length, m = t, g = i, l = 0; l < c; l++)2 === (d = e[l]).length ? (m = d[0] * r + m, g = d[1] * o + g, ae(q(m * _) + " " + q((y - g) * _) + " l")) : (u = d[0] * r + m, h = d[1] * o + g, p = d[2] * r + m, f = d[3] * o + g, m = d[4] * r + m, g = d[5] * o + g, ae(q(u * _) + " " + q((y - h) * _) + " " + q(p * _) + " " + q((y - f) * _) + " " + q(m * _) + " " + q((y - g) * _) + " c")); return s && ae(" h"), null !== a && ae(le(a)), this }, L.rect = function (e, t, i, n, a) { le(a); return ae([F(e * _), F((y - t) * _), F(i * _), F(-n * _), "re"].join(" ")), null !== a && ae(le(a)), this }, L.triangle = function (e, t, i, n, a, s, r) { return this.lines([[i - e, n - t], [a - i, s - n], [e - a, t - s]], e, t, [1, 1], r, !0), this }, L.roundedRect = function (e, t, i, n, a, s, r) { var o = 4 / 3 * (Math.SQRT2 - 1); return this.lines([[i - 2 * a, 0], [a * o, 0, a, s - s * o, a, s], [0, n - 2 * s], [0, s * o, -a * o, s, -a, s], [2 * a - i, 0], [-a * o, 0, -a, -s * o, -a, -s], [0, 2 * s - n], [0, -s * o, a * o, -s, a, -s]], e + a, t, [1, 1], r), this }, L.ellipse = function (e, t, i, n, a) { var s = 4 / 3 * (Math.SQRT2 - 1) * i, r = 4 / 3 * (Math.SQRT2 - 1) * n; return ae([F((e + i) * _), F((y - t) * _), "m", F((e + i) * _), F((y - (t - r)) * _), F((e + s) * _), F((y - (t - n)) * _), F(e * _), F((y - (t - n)) * _), "c"].join(" ")), ae([F((e - s) * _), F((y - (t - n)) * _), F((e - i) * _), F((y - (t - r)) * _), F((e - i) * _), F((y - t) * _), "c"].join(" ")), ae([F((e - i) * _), F((y - (t + r)) * _), F((e - s) * _), F((y - (t + n)) * _), F(e * _), F((y - (t + n)) * _), "c"].join(" ")), ae([F((e + s) * _), F((y - (t + n)) * _), F((e + i) * _), F((y - (t + r)) * _), F((e + i) * _), F((y - t) * _), "c"].join(" ")), null !== a && ae(le(a)), this }, L.circle = function (e, t, i, n) { return this.ellipse(e, t, i, i, n) }, L.setProperties = function (e) { for (var t in j) j.hasOwnProperty(t) && e[t] && (j[t] = e[t]); return this }, L.setFontSize = function (e) { return X = e, this }, L.setFont = function (e, t) { return J = re(e, t), this }, L.setFontStyle = L.setFontType = function (e) { return J = re(void 0, e), this }, L.getFontList = function () { var e, t, i, n = {}; for (e in C) if (C.hasOwnProperty(e)) for (t in n[e] = i = [], C[e]) C[e].hasOwnProperty(t) && i.push(t); return n }, L.addFont = function (e, t, i, n) { Y(e, t, i, n = n || "Identity-H") }, L.setLineWidth = function (e) { return ae((e * _).toFixed(2) + " w"), this }, L.setDrawColor = function (e, t, i, n) { return ae(R({ ch1: e, ch2: t, ch3: i, ch4: n, pdfColorType: "draw", precision: 2 })), this }, L.setFillColor = function (e, t, i, n) { return ae(R({ ch1: e, ch2: t, ch3: i, ch4: n, pdfColorType: "fill", precision: 2 })), this }, L.setTextColor = function (e, t, i, n) { return K = R({ ch1: e, ch2: t, ch3: i, ch4: n, pdfColorType: "text", precision: 3 }), this }, L.setCharSpace = function (e) { return Z = e, this }, L.setR2L = function (e) { return ee = e, this }, L.CapJoinStyles = { 0: 0, butt: 0, but: 0, miter: 0, 1: 1, round: 1, rounded: 1, circle: 1, 2: 2, projecting: 2, project: 2, square: 2, bevel: 2 }, L.setLineCap = function (e) { var t = this.CapJoinStyles[e]; if (void 0 === t) throw new Error("Line cap style of '" + e + "' is not recognized. See or extend .CapJoinStyles property for valid styles"); return ae((I = t) + " J"), this }, L.setLineJoin = function (e) { var t = this.CapJoinStyles[e]; if (void 0 === t) throw new Error("Line join style of '" + e + "' is not recognized. See or extend .CapJoinStyles property for valid styles"); return ae((D = t) + " j"), this }, L.output = ue, L.save = function (e) { L.output("save", e) }, ve.API) ve.API.hasOwnProperty(pe) && ("events" === pe && ve.API.events.length ? function (e, t) { var i, n, a; for (a = t.length - 1; -1 !== a; a--)i = t[a][0], n = t[a][1], e.subscribe.apply(e, [i].concat("function" == typeof n ? [n] : n)) }(ne, ve.API.events) : L[pe] = ve.API[pe]); return function () { for (var e = "helvetica", t = "times", i = "courier", n = "normal", a = "italic", s = "bolditalic", r = [["Helvetica", e, n, "WinAnsiEncoding"], ["Helvetica-Bold", e, "bold", "WinAnsiEncoding"], ["Helvetica-Oblique", e, a, "WinAnsiEncoding"], ["Helvetica-BoldOblique", e, s, "WinAnsiEncoding"], ["Courier", i, n, "WinAnsiEncoding"], ["Courier-Bold", i, "bold", "WinAnsiEncoding"], ["Courier-Oblique", i, a, "WinAnsiEncoding"], ["Courier-BoldOblique", i, s, "WinAnsiEncoding"], ["Times-Roman", t, n, "WinAnsiEncoding"], ["Times-Bold", t, "bold", "WinAnsiEncoding"], ["Times-Italic", t, a, "WinAnsiEncoding"], ["Times-BoldItalic", t, s, "WinAnsiEncoding"], ["ZapfDingbats", "zapfdingbats", n, null], ["Symbol", "symbol", n, null]], o = 0, l = r.length; o < l; o++) { var c = Y(r[o][0], r[o][1], r[o][2], r[o][3]), d = r[o][0].split("-"); z(c, d[0], d[1] || "") } ne.publish("addFonts", { fonts: ie, dictionary: C }) }(), J = "F1", G(i, e), ne.publish("initialized"), L } return ve.API = { events: [] }, ve.version = "0.0.0", "function" == typeof define && define.amd ? define("jsPDF", function () { return ve }) : "undefined" != typeof module && module.exports ? (module.exports = ve, module.exports.jsPDF = ve) : fe.jsPDF = ve, ve }("undefined" != typeof self && self || "undefined" != typeof window && window || "undefined" != typeof global && global || Function('return typeof this === "object" && this.content')() || Function("return this")()); !function (i, e) { var d, r, t = 1, n = function (e, t) { e.prototype = Object.create(t.prototype), e.prototype.constructor = e }, o = function (e) { return e * (t / 1) }, l = function (e) { var t = new S, i = F.internal.getHeight(e) || 0, n = F.internal.getWidth(e) || 0; return t.BBox = [0, 0, n.toFixed(2), i.toFixed(2)], t }, a = function (e, t, i) { e = e || 0; var n = 1; if (n <<= t - 1, 1 == (i = i || 1)) e = e | n; else e = e & ~n; return e }, s = function (e, t, i) { i = i || 1.3, e = e || 0; return 1 == t.readOnly && (e = a(e, 1)), 1 == t.required && (e = a(e, 2)), 1 == t.noExport && (e = a(e, 3)), 1 == t.multiline && (e = a(e, 13)), t.password && (e = a(e, 14)), t.noToggleToOff && (e = a(e, 15)), t.radio && (e = a(e, 16)), t.pushbutton && (e = a(e, 17)), t.combo && (e = a(e, 18)), t.edit && (e = a(e, 19)), t.sort && (e = a(e, 20)), t.fileSelect && 1.4 <= i && (e = a(e, 21)), t.multiSelect && 1.4 <= i && (e = a(e, 22)), t.doNotSpellCheck && 1.4 <= i && (e = a(e, 23)), 1 == t.doNotScroll && 1.4 <= i && (e = a(e, 24)), t.richText && 1.4 <= i && (e = a(e, 25)), e }, u = function (e) { var t = e[0], i = e[1], n = e[2], a = e[3], s = {}; return Array.isArray(t) ? (t[0] = o(t[0]), t[1] = o(t[1]), t[2] = o(t[2]), t[3] = o(t[3])) : (t = o(t), i = o(i), n = o(n), a = o(a)), s.lowerLeft_X = t || 0, s.lowerLeft_Y = o(r) - i - a || 0, s.upperRight_X = t + n || 0, s.upperRight_Y = o(r) - i || 0, [s.lowerLeft_X.toFixed(2), s.lowerLeft_Y.toFixed(2), s.upperRight_X.toFixed(2), s.upperRight_Y.toFixed(2)] }, h = function (e) { if (e.appearanceStreamContent) return e.appearanceStreamContent; if (e.V || e.DV) { var t = [], i = e.V || e.DV, n = c(e, i); t.push("/Tx BMC"), t.push("q"), t.push("/F1 " + n.fontSize.toFixed(2) + " Tf"), t.push("1 0 0 1 0 0 Tm"), t.push("BT"), t.push(n.text), t.push("ET"), t.push("Q"), t.push("EMC"); var a = new l(e); return a.stream = t.join("\n"), a } }, c = function (e, t, a, i) { i = i || 12, a = a || "helvetica"; var n = { text: "", fontSize: "" }, s = (t = ")" == (t = "(" == t.substr(0, 1) ? t.substr(1) : t).substr(t.length - 1) ? t.substr(0, t.length - 1) : t).split(" "), r = i, o = F.internal.getHeight(e) || 0; o = o < 0 ? -o : o; var l = F.internal.getWidth(e) || 0; l = l < 0 ? -l : l; var c = function (e, t, i) { if (e + 1 < s.length) { var n = t + " " + s[e + 1]; return T(n, i + "px", a).width <= l - 4 } return !1 }; r++; e: for (; ;) { t = ""; var d = T("3", --r + "px", a).height, u = e.multiline ? o - r : (o - d) / 2, h = -2, p = u += 2, f = 0, m = 0, g = 0; if (r <= 0) { r = 12, t = "(...) Tj\n", t += "% Width of Text: " + T(t, "1px").width + ", FieldWidth:" + l + "\n"; break } g = T(s[0] + " ", r + "px", a).width; var _ = "", v = 0; for (var y in s) { _ = " " == (_ += s[y] + " ").substr(_.length - 1) ? _.substr(0, _.length - 1) : _; var b = parseInt(y); g = T(_ + " ", r + "px", a).width; var w = c(b, _, r), C = y >= s.length - 1; if (!w || C) { if (w || C) { if (C) m = b; else if (e.multiline && o < (d + 2) * (v + 2) + 2) continue e } else { if (!e.multiline) continue e; if (o < (d + 2) * (v + 2) + 2) continue e; m = b } for (var x = "", k = f; k <= m; k++)x += s[k] + " "; switch (x = " " == x.substr(x.length - 1) ? x.substr(0, x.length - 1) : x, g = T(x, r + "px", a).width, e.Q) { case 2: h = l - g - 2; break; case 1: h = (l - g) / 2; break; case 0: default: h = 2 }t += h.toFixed(2) + " " + p.toFixed(2) + " Td\n", t += "(" + x + ") Tj\n", t += -h.toFixed(2) + " 0 Td\n", p = -(r + 2), g = 0, f = m + 1, v++ , _ = "" } else _ += " " } break } return n.text = t, n.fontSize = r, n }, T = function (e, t, i) { i = i || "helvetica"; var n = d.internal.getFont(i), a = d.getStringUnitWidth(e, { font: n, fontSize: parseFloat(t), charSpace: 0 }) * parseFloat(t); return { height: d.getStringUnitWidth("3", { font: n, fontSize: parseFloat(t), charSpace: 0 }) * parseFloat(t) * 1.5, width: a } }, p = { fields: [], xForms: [], acroFormDictionaryRoot: null, printedOut: !1, internal: null, isInitialized: !1 }, f = function () { for (var e in d.internal.acroformPlugin.acroFormDictionaryRoot.Fields) { var t = d.internal.acroformPlugin.acroFormDictionaryRoot.Fields[e]; t.hasAnnotation && g.call(d, t) } }, m = function (e) { d.internal.acroformPlugin.printedOut && (d.internal.acroformPlugin.printedOut = !1, d.internal.acroformPlugin.acroFormDictionaryRoot = null), d.internal.acroformPlugin.acroFormDictionaryRoot || w.call(d), d.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e) }, g = function (e) { var t = { type: "reference", object: e }; d.annotationPlugin.annotations[d.internal.getPageInfo(e.page).pageNumber].push(t) }, _ = function () { void 0 !== d.internal.acroformPlugin.acroFormDictionaryRoot && d.internal.write("/AcroForm " + d.internal.acroformPlugin.acroFormDictionaryRoot.objId + " 0 R") }, v = function () { d.internal.events.unsubscribe(d.internal.acroformPlugin.acroFormDictionaryRoot._eventID), delete d.internal.acroformPlugin.acroFormDictionaryRoot._eventID, d.internal.acroformPlugin.printedOut = !0 }, y = function (e) { var t = !e; e || (d.internal.newObjectDeferredBegin(d.internal.acroformPlugin.acroFormDictionaryRoot.objId), d.internal.out(d.internal.acroformPlugin.acroFormDictionaryRoot.getString())); e = e || d.internal.acroformPlugin.acroFormDictionaryRoot.Kids; for (var i in e) { var n = e[i], a = n.Rect; n.Rect && (n.Rect = u.call(this, n.Rect)), d.internal.newObjectDeferredBegin(n.objId); var s = n.objId + " 0 obj\n<<\n"; if ("object" === (void 0 === n ? "undefined" : ye(n)) && "function" == typeof n.getContent && (s += n.getContent()), n.Rect = a, n.hasAppearanceStream && !n.appearanceStreamContent) { var r = h.call(this, n); s += "/AP << /N " + r + " >>\n", d.internal.acroformPlugin.xForms.push(r) } if (n.appearanceStreamContent) { for (var o in s += "/AP << ", n.appearanceStreamContent) { var l = n.appearanceStreamContent[o]; if (s += "/" + o + " ", s += "<< ", 1 <= Object.keys(l).length || Array.isArray(l)) for (var i in l) { var c; "function" == typeof (c = l[i]) && (c = c.call(this, n)), s += "/" + i + " " + c + " ", 0 <= d.internal.acroformPlugin.xForms.indexOf(c) || d.internal.acroformPlugin.xForms.push(c) } else "function" == typeof (c = l) && (c = c.call(this, n)), s += "/" + i + " " + c + " \n", 0 <= d.internal.acroformPlugin.xForms.indexOf(c) || d.internal.acroformPlugin.xForms.push(c); s += " >>\n" } s += ">>\n" } s += ">>\nendobj\n", d.internal.out(s) } t && b.call(this, d.internal.acroformPlugin.xForms) }, b = function (e) { for (var t in e) { var i = t, n = e[t]; d.internal.newObjectDeferredBegin(n && n.objId); var a = ""; "object" === (void 0 === n ? "undefined" : ye(n)) && "function" == typeof n.getString && (a = n.getString()), d.internal.out(a), delete e[i] } }, w = function () { if (void 0 !== this.internal && (void 0 === this.internal.acroformPlugin || !1 === this.internal.acroformPlugin.isInitialized)) { if (d = this, A.FieldNum = 0, this.internal.acroformPlugin = JSON.parse(JSON.stringify(p)), this.internal.acroformPlugin.acroFormDictionaryRoot) throw new Error("Exception while creating AcroformDictionary"); t = d.internal.scaleFactor, r = d.internal.pageSize.getHeight(), d.internal.acroformPlugin.acroFormDictionaryRoot = new $, d.internal.acroformPlugin.acroFormDictionaryRoot._eventID = d.internal.events.subscribe("postPutResources", v), d.internal.events.subscribe("buildDocument", f), d.internal.events.subscribe("putCatalog", _), d.internal.events.subscribe("postPutPages", y), d.internal.acroformPlugin.isInitialized = !0 } }, C = function (e) { if (Array.isArray(e)) { var t = " ["; for (var i in e) { t += e[i].toString(), t += i < e.length - 1 ? " " : "" } return t += "]" } }, x = function (e) { return 0 !== (e = e || "").indexOf("(") && (e = "(" + e), ")" != e.substring(e.length - 1) && (e += ")"), e }, k = function () { var e; Object.defineProperty(this, "objId", { get: function () { return e || (e = d.internal.newObjectDeferred()), e }, configurable: !1 }) }; k.prototype.toString = function () { return this.objId + " 0 R" }, k.prototype.getString = function () { var e = this.objId + " 0 obj\n<<"; return e += this.getContent() + ">>\n", this.stream && (e += "stream\n", e += this.stream, e += "\nendstream\n"), e += "endobj\n" }, k.prototype.getContent = function () { var e = ""; return e += function (e) { var t = "", i = Object.keys(e).filter(function (e) { return "content" != e && "appearanceStreamContent" != e && "_" != e.substring(0, 1) }); for (var n in i) { var a = i[n], s = e[a]; s && (Array.isArray(s) ? t += "/" + a + " " + C(s) + "\n" : t += s instanceof k ? "/" + a + " " + s.objId + " 0 R\n" : "/" + a + " " + s + "\n") } return t }(this) }; var S = function () { var t; k.call(this), this.Type = "/XObject", this.Subtype = "/Form", this.FormType = 1, this.BBox, this.Matrix, this.Resources = "2 0 R", this.PieceInfo, Object.defineProperty(this, "Length", { enumerable: !0, get: function () { return void 0 !== t ? t.length : 0 } }), Object.defineProperty(this, "stream", { enumerable: !1, set: function (e) { t = e.trim() }, get: function () { return t || null } }) }; n(S, k); var $ = function () { k.call(this); var e = []; Object.defineProperty(this, "Kids", { enumerable: !1, configurable: !0, get: function () { return 0 < e.length ? e : void 0 } }), Object.defineProperty(this, "Fields", { enumerable: !0, configurable: !0, get: function () { return e } }), this.DA }; n($, k); var A = function e() { var t; k.call(this), Object.defineProperty(this, "Rect", { enumerable: !0, configurable: !1, get: function () { if (t) return t }, set: function (e) { t = e } }); var i, n, a, s, r = ""; Object.defineProperty(this, "FT", { enumerable: !0, set: function (e) { r = e }, get: function () { return r } }), Object.defineProperty(this, "T", { enumerable: !0, configurable: !1, set: function (e) { i = e }, get: function () { if (!i || i.length < 1) { if (this instanceof O) return; return "(FieldObject" + e.FieldNum++ + ")" } return "(" == i.substring(0, 1) && i.substring(i.length - 1) ? i : "(" + i + ")" } }), Object.defineProperty(this, "DA", { enumerable: !0, get: function () { if (n) return "(" + n + ")" }, set: function (e) { n = e } }), Object.defineProperty(this, "DV", { enumerable: !0, configurable: !0, get: function () { if (a) return a }, set: function (e) { a = e } }), Object.defineProperty(this, "V", { enumerable: !0, configurable: !0, get: function () { if (s) return s }, set: function (e) { s = e } }), Object.defineProperty(this, "Type", { enumerable: !0, get: function () { return this.hasAnnotation ? "/Annot" : null } }), Object.defineProperty(this, "Subtype", { enumerable: !0, get: function () { return this.hasAnnotation ? "/Widget" : null } }), this.BG, Object.defineProperty(this, "hasAnnotation", { enumerable: !1, get: function () { return !!(this.Rect || this.BC || this.BG) } }), Object.defineProperty(this, "hasAppearanceStream", { enumerable: !1, configurable: !0, writable: !0 }), Object.defineProperty(this, "page", { enumerable: !1, configurable: !0, writable: !0 }) }; n(A, k); var I = function () { A.call(this), this.FT = "/Ch", this.Opt = [], this.V = "()", this.TI = 0; var t = !1; Object.defineProperty(this, "combo", { enumerable: !1, get: function () { return t }, set: function (e) { t = e } }), Object.defineProperty(this, "edit", { enumerable: !0, set: function (e) { 1 == e ? (this._edit = !0, this.combo = !0) : this._edit = !1 }, get: function () { return !!this._edit && this._edit }, configurable: !1 }), this.hasAppearanceStream = !0 }; n(I, A); var D = function () { I.call(this), this.combo = !1 }; n(D, I); var P = function () { D.call(this), this.combo = !0 }; n(P, D); var j = function () { P.call(this), this.edit = !0 }; n(j, P); var L = function () { A.call(this), this.FT = "/Btn" }; n(L, A); var M = function () { L.call(this); var t = !0; Object.defineProperty(this, "pushbutton", { enumerable: !1, get: function () { return t }, set: function (e) { t = e } }) }; n(M, L); var R = function () { L.call(this); var t = !0; Object.defineProperty(this, "radio", { enumerable: !1, get: function () { return t }, set: function (e) { t = e } }); var i, e = []; Object.defineProperty(this, "Kids", { enumerable: !0, get: function () { if (0 < e.length) return e } }), Object.defineProperty(this, "__Kids", { get: function () { return e } }), Object.defineProperty(this, "noToggleToOff", { enumerable: !1, get: function () { return i }, set: function (e) { i = e } }) }; n(R, L); var O = function (e, t) { A.call(this), this.Parent = e, this._AppearanceType = F.RadioButton.Circle, this.appearanceStreamContent = this._AppearanceType.createAppearanceStream(t), this.F = a(this.F, 3, 1), this.MK = this._AppearanceType.createMK(), this.AS = "/Off", this._Name = t }; n(O, A), R.prototype.setAppearance = function (e) { if ("createAppearanceStream" in e && "createMK" in e) for (var t in this.__Kids) { var i = this.__Kids[t]; i.appearanceStreamContent = e.createAppearanceStream(i._Name), i.MK = e.createMK() } }, R.prototype.createOption = function (e) { this.__Kids.length; var t = new O(this, e); return this.__Kids.push(t), i.addField(t), t }; var E = function () { L.call(this), this.appearanceStreamContent = F.CheckBox.createAppearanceStream(), this.MK = F.CheckBox.createMK(), this.AS = "/On", this.V = "/On" }; n(E, L); var N = function () { var t, i; A.call(this), this.DA = F.createDefaultAppearanceStream(), this.F = 4, Object.defineProperty(this, "V", { get: function () { return t ? x(t) : t }, enumerable: !0, set: function (e) { t = e } }), Object.defineProperty(this, "DV", { get: function () { return i ? x(i) : i }, enumerable: !0, set: function (e) { i = e } }); var n = !1; Object.defineProperty(this, "multiline", { enumerable: !1, get: function () { return n }, set: function (e) { n = e } }); var a = !1; Object.defineProperty(this, "fileSelect", { enumerable: !1, get: function () { return a }, set: function (e) { a = e } }); var s = !1; Object.defineProperty(this, "doNotSpellCheck", { enumerable: !1, get: function () { return s }, set: function (e) { s = e } }); var r = !1; Object.defineProperty(this, "doNotScroll", { enumerable: !1, get: function () { return r }, set: function (e) { r = e } }); var o = !1; Object.defineProperty(this, "MaxLen", { enumerable: !0, get: function () { return o }, set: function (e) { o = e } }), Object.defineProperty(this, "hasAppearanceStream", { enumerable: !1, get: function () { return this.V || this.DV } }) }; n(N, A); var B = function () { N.call(this); var t = !0; Object.defineProperty(this, "password", { enumerable: !1, get: function () { return t }, set: function (e) { t = e } }) }; n(B, N); var F = { CheckBox: { createAppearanceStream: function () { return { N: { On: F.CheckBox.YesNormal }, D: { On: F.CheckBox.YesPushDown, Off: F.CheckBox.OffPushDown } } }, createMK: function () { return "<< /CA (3)>>" }, YesPushDown: function (e) { var t = l(e), i = [], n = d.internal.getFont("zapfdingbats", "normal").id; e.Q = 1; var a = c(e, "3", "ZapfDingbats", 50); return i.push("0.749023 g"), i.push("0 0 " + F.internal.getWidth(e).toFixed(2) + " " + F.internal.getHeight(e).toFixed(2) + " re"), i.push("f"), i.push("BMC"), i.push("q"), i.push("0 0 1 rg"), i.push("/" + n + " " + a.fontSize.toFixed(2) + " Tf 0 g"), i.push("BT"), i.push(a.text), i.push("ET"), i.push("Q"), i.push("EMC"), t.stream = i.join("\n"), t }, YesNormal: function (e) { var t = l(e), i = d.internal.getFont("zapfdingbats", "normal").id, n = []; e.Q = 1; var a = F.internal.getHeight(e), s = F.internal.getWidth(e), r = c(e, "3", "ZapfDingbats", .9 * a); return n.push("1 g"), n.push("0 0 " + s.toFixed(2) + " " + a.toFixed(2) + " re"), n.push("f"), n.push("q"), n.push("0 0 1 rg"), n.push("0 0 " + (s - 1).toFixed(2) + " " + (a - 1).toFixed(2) + " re"), n.push("W"), n.push("n"), n.push("0 g"), n.push("BT"), n.push("/" + i + " " + r.fontSize.toFixed(2) + " Tf 0 g"), n.push(r.text), n.push("ET"), n.push("Q"), t.stream = n.join("\n"), t }, OffPushDown: function (e) { var t = l(e), i = []; return i.push("0.749023 g"), i.push("0 0 " + F.internal.getWidth(e).toFixed(2) + " " + F.internal.getHeight(e).toFixed(2) + " re"), i.push("f"), t.stream = i.join("\n"), t } }, RadioButton: { Circle: { createAppearanceStream: function (e) { var t = { D: { Off: F.RadioButton.Circle.OffPushDown }, N: {} }; return t.N[e] = F.RadioButton.Circle.YesNormal, t.D[e] = F.RadioButton.Circle.YesPushDown, t }, createMK: function () { return "<< /CA (l)>>" }, YesNormal: function (e) { var t = l(e), i = [], n = F.internal.getWidth(e) <= F.internal.getHeight(e) ? F.internal.getWidth(e) / 4 : F.internal.getHeight(e) / 4; n *= .9; var a = F.internal.Bezier_C; return i.push("q"), i.push("1 0 0 1 " + F.internal.getWidth(e) / 2 + " " + F.internal.getHeight(e) / 2 + " cm"), i.push(n + " 0 m"), i.push(n + " " + n * a + " " + n * a + " " + n + " 0 " + n + " c"), i.push("-" + n * a + " " + n + " -" + n + " " + n * a + " -" + n + " 0 c"), i.push("-" + n + " -" + n * a + " -" + n * a + " -" + n + " 0 -" + n + " c"), i.push(n * a + " -" + n + " " + n + " -" + n * a + " " + n + " 0 c"), i.push("f"), i.push("Q"), t.stream = i.join("\n"), t }, YesPushDown: function (e) { var t = l(e), i = [], n = F.internal.getWidth(e) <= F.internal.getHeight(e) ? F.internal.getWidth(e) / 4 : F.internal.getHeight(e) / 4, a = 2 * (n *= .9), s = a * F.internal.Bezier_C, r = n * F.internal.Bezier_C; return i.push("0.749023 g"), i.push("q"), i.push("1 0 0 1 " + (F.internal.getWidth(e) / 2).toFixed(2) + " " + (F.internal.getHeight(e) / 2).toFixed(2) + " cm"), i.push(a + " 0 m"), i.push(a + " " + s + " " + s + " " + a + " 0 " + a + " c"), i.push("-" + s + " " + a + " -" + a + " " + s + " -" + a + " 0 c"), i.push("-" + a + " -" + s + " -" + s + " -" + a + " 0 -" + a + " c"), i.push(s + " -" + a + " " + a + " -" + s + " " + a + " 0 c"), i.push("f"), i.push("Q"), i.push("0 g"), i.push("q"), i.push("1 0 0 1 " + (F.internal.getWidth(e) / 2).toFixed(2) + " " + (F.internal.getHeight(e) / 2).toFixed(2) + " cm"), i.push(n + " 0 m"), i.push(n + " " + r + " " + r + " " + n + " 0 " + n + " c"), i.push("-" + r + " " + n + " -" + n + " " + r + " -" + n + " 0 c"), i.push("-" + n + " -" + r + " -" + r + " -" + n + " 0 -" + n + " c"), i.push(r + " -" + n + " " + n + " -" + r + " " + n + " 0 c"), i.push("f"), i.push("Q"), t.stream = i.join("\n"), t }, OffPushDown: function (e) { var t = l(e), i = [], n = F.internal.getWidth(e) <= F.internal.getHeight(e) ? F.internal.getWidth(e) / 4 : F.internal.getHeight(e) / 4, a = 2 * (n *= .9), s = a * F.internal.Bezier_C; return i.push("0.749023 g"), i.push("q"), i.push("1 0 0 1 " + (F.internal.getWidth(e) / 2).toFixed(2) + " " + (F.internal.getHeight(e) / 2).toFixed(2) + " cm"), i.push(a + " 0 m"), i.push(a + " " + s + " " + s + " " + a + " 0 " + a + " c"), i.push("-" + s + " " + a + " -" + a + " " + s + " -" + a + " 0 c"), i.push("-" + a + " -" + s + " -" + s + " -" + a + " 0 -" + a + " c"), i.push(s + " -" + a + " " + a + " -" + s + " " + a + " 0 c"), i.push("f"), i.push("Q"), t.stream = i.join("\n"), t } }, Cross: { createAppearanceStream: function (e) { var t = { D: { Off: F.RadioButton.Cross.OffPushDown }, N: {} }; return t.N[e] = F.RadioButton.Cross.YesNormal, t.D[e] = F.RadioButton.Cross.YesPushDown, t }, createMK: function () { return "<< /CA (8)>>" }, YesNormal: function (e) { var t = l(e), i = [], n = F.internal.calculateCross(e); return i.push("q"), i.push("1 1 " + (F.internal.getWidth(e) - 2).toFixed(2) + " " + (F.internal.getHeight(e) - 2).toFixed(2) + " re"), i.push("W"), i.push("n"), i.push(n.x1.x.toFixed(2) + " " + n.x1.y.toFixed(2) + " m"), i.push(n.x2.x.toFixed(2) + " " + n.x2.y.toFixed(2) + " l"), i.push(n.x4.x.toFixed(2) + " " + n.x4.y.toFixed(2) + " m"), i.push(n.x3.x.toFixed(2) + " " + n.x3.y.toFixed(2) + " l"), i.push("s"), i.push("Q"), t.stream = i.join("\n"), t }, YesPushDown: function (e) { var t = l(e), i = F.internal.calculateCross(e), n = []; return n.push("0.749023 g"), n.push("0 0 " + F.internal.getWidth(e).toFixed(2) + " " + F.internal.getHeight(e).toFixed(2) + " re"), n.push("f"), n.push("q"), n.push("1 1 " + (F.internal.getWidth(e) - 2).toFixed(2) + " " + (F.internal.getHeight(e) - 2).toFixed(2) + " re"), n.push("W"), n.push("n"), n.push(i.x1.x.toFixed(2) + " " + i.x1.y.toFixed(2) + " m"), n.push(i.x2.x.toFixed(2) + " " + i.x2.y.toFixed(2) + " l"), n.push(i.x4.x.toFixed(2) + " " + i.x4.y.toFixed(2) + " m"), n.push(i.x3.x.toFixed(2) + " " + i.x3.y.toFixed(2) + " l"), n.push("s"), n.push("Q"), t.stream = n.join("\n"), t }, OffPushDown: function (e) { var t = l(e), i = []; return i.push("0.749023 g"), i.push("0 0 " + F.internal.getWidth(e).toFixed(2) + " " + F.internal.getHeight(e).toFixed(2) + " re"), i.push("f"), t.stream = i.join("\n"), t } } }, createDefaultAppearanceStream: function (e) { return "/F1 0 Tf 0 g" } }; F.internal = { Bezier_C: .551915024494, calculateCross: function (e) { var t, i, n = F.internal.getWidth(e), a = F.internal.getHeight(e), s = (i = a) < (t = n) ? i : t; return { x1: { x: (n - s) / 2, y: (a - s) / 2 + s }, x2: { x: (n - s) / 2 + s, y: (a - s) / 2 }, x3: { x: (n - s) / 2, y: (a - s) / 2 }, x4: { x: (n - s) / 2 + s, y: (a - s) / 2 + s } } } }, F.internal.getWidth = function (e) { var t = 0; return "object" === (void 0 === e ? "undefined" : ye(e)) && (t = o(e.Rect[2])), t }, F.internal.getHeight = function (e) { var t = 0; return "object" === (void 0 === e ? "undefined" : ye(e)) && (t = o(e.Rect[3])), t }, i.addField = function (e) { return w.call(this), e instanceof N ? this.addTextField.call(this, e) : e instanceof I ? this.addChoiceField.call(this, e) : e instanceof L ? this.addButton.call(this, e) : e instanceof O ? m.call(this, e) : e && m.call(this, e), e.page = d.internal.getCurrentPageInfo().pageNumber, this }, i.addButton = function (e) { w.call(this); var t = e || new A; t.FT = "/Btn", t.Ff = s(t.Ff, e, d.internal.getPDFVersion()), m.call(this, t) }, i.addTextField = function (e) { w.call(this); var t = e || new A; t.FT = "/Tx", t.Ff = s(t.Ff, e, d.internal.getPDFVersion()), m.call(this, t) }, i.addChoiceField = function (e) { w.call(this); var t = e || new A; t.FT = "/Ch", t.Ff = s(t.Ff, e, d.internal.getPDFVersion()), m.call(this, t) }, "object" == (void 0 === e ? "undefined" : ye(e)) && (e.ChoiceField = I, e.ListBox = D, e.ComboBox = P, e.EditBox = j, e.Button = L, e.PushButton = M, e.RadioButton = R, e.CheckBox = E, e.TextField = N, e.PasswordField = B, e.AcroForm = { Appearance: F }), i.AcroFormChoiceField = I, i.AcroFormListBox = D, i.AcroFormComboBox = P, i.AcroFormEditBox = j, i.AcroFormButton = L, i.AcroFormPushButton = M, i.AcroFormRadioButton = R, i.AcroFormCheckBox = E, i.AcroFormTextField = N, i.AcroFormPasswordField = B, i.AcroForm = { ChoiceField: I, ListBox: D, ComboBox: P, EditBox: j, Button: L, PushButton: M, RadioButton: R, CheckBox: E, TextField: N, PasswordField: B } }(Z.API, "undefined" != typeof window && window || "undefined" != typeof global && global), Z.API.addHTML = function (e, f, m, o, g) { if ("undefined" == typeof html2canvas && "undefined" == typeof rasterizeHTML) throw new Error("You need either https://github.com/niklasvh/html2canvas or https://github.com/cburgmer/rasterizeHTML.js"); "number" != typeof f && (o = f, g = m), "function" == typeof o && (g = o, o = null), "function" != typeof g && (g = function () { }); var t = this.internal, _ = t.scaleFactor, v = t.pageSize.getWidth(), y = t.pageSize.getHeight(); if ((o = o || {}).onrendered = function (l) { f = parseInt(f) || 0, m = parseInt(m) || 0; var e = o.dim || {}, c = Object.assign({ top: 0, right: 0, bottom: 0, left: 0, useFor: "content" }, o.margin), t = e.h || Math.min(y, l.height / _), d = e.w || Math.min(v, l.width / _) - f, u = o.format || "JPEG", h = o.imageCompression || "SLOW"; if (l.height > y - c.top - c.bottom && o.pagesplit) { var p = function (e, t, i, n, a) { var s = document.createElement("canvas"); s.height = a, s.width = n; var r = s.getContext("2d"); return r.mozImageSmoothingEnabled = !1, r.webkitImageSmoothingEnabled = !1, r.msImageSmoothingEnabled = !1, r.imageSmoothingEnabled = !1, r.fillStyle = o.backgroundColor || "#ffffff", r.fillRect(0, 0, n, a), r.drawImage(e, t, i, n, a, 0, 0, n, a), s }, i = function () { for (var e, t, i = 0, n = 0, a = {}, s = !1; ;) { var r; if (n = 0, a.top = 0 !== i ? c.top : m, a.left = 0 !== i ? c.left : f, s = (v - c.left - c.right) * _ < l.width, "content" === c.useFor ? 0 === i ? (e = Math.min((v - c.left) * _, l.width), t = Math.min((y - c.top) * _, l.height - i)) : (e = Math.min(v * _, l.width), t = Math.min(y * _, l.height - i), a.top = 0) : (e = Math.min((v - c.left - c.right) * _, l.width), t = Math.min((y - c.bottom - c.top) * _, l.height - i)), s) for (; ;) { "content" === c.useFor && (0 === n ? e = Math.min((v - c.left) * _, l.width) : (e = Math.min(v * _, l.width - n), a.left = 0)); var o = [r = p(l, n, i, e, t), a.left, a.top, r.width / _, r.height / _, u, null, h]; if (this.addImage.apply(this, o), (n += e) >= l.width) break; this.addPage() } else o = [r = p(l, 0, i, e, t), a.left, a.top, r.width / _, r.height / _, u, null, h], this.addImage.apply(this, o); if ((i += t) >= l.height) break; this.addPage() } g(d, i, null, o) }.bind(this); if ("CANVAS" === l.nodeName) { var n = new Image; n.onload = i, n.src = l.toDataURL("image/png"), l = n } else i() } else { var a = Math.random().toString(35), s = [l, f, m, d, t, u, a, h]; this.addImage.apply(this, s), g(d, t, a, s) } }.bind(this), "undefined" != typeof html2canvas && !o.rstz) return html2canvas(e, o); if ("undefined" != typeof rasterizeHTML) { var i = "drawDocument"; return "string" == typeof e && (i = /^http/.test(e) ? "drawURL" : "drawHTML"), o.width = o.width || v * _, rasterizeHTML[i](e, void 0, o).then(function (e) { o.onrendered(e.image) }, function (e) { g(null, e) }) } return null }, function (b) { var w = "addImage_", l = { PNG: [[137, 80, 78, 71]], TIFF: [[77, 77, 0, 42], [73, 73, 42, 0]], JPEG: [[255, 216, 255, 224, void 0, void 0, 74, 70, 73, 70, 0], [255, 216, 255, 225, void 0, void 0, 69, 120, 105, 102, 0, 0]], JPEG2000: [[0, 0, 0, 12, 106, 80, 32, 32]], GIF87a: [[71, 73, 70, 56, 55, 97]], GIF89a: [[71, 73, 70, 56, 57, 97]], BMP: [[66, 77], [66, 65], [67, 73], [67, 80], [73, 67], [80, 84]] }; b.getImageFileTypeByImageData = function (e, t) { var i, n; t = t || "UNKNOWN"; var a, s, r, o = "UNKNOWN"; for (r in l) for (a = l[r], i = 0; i < a.length; i += 1) { for (s = !0, n = 0; n < a[i].length; n += 1)if (void 0 !== a[i][n] && a[i][n] !== e.charCodeAt(n)) { s = !1; break } if (!0 === s) { o = r; break } } return "UNKOWN" === o && "UNKNOWN" !== t && (o = t), o }; var i = function e(t) { var i = this.internal.newObject(), n = this.internal.write, a = this.internal.putStream; if (t.n = i, n("<</Type /XObject"), n("/Subtype /Image"), n("/Width " + t.w), n("/Height " + t.h), t.cs === this.color_spaces.INDEXED ? n("/ColorSpace [/Indexed /DeviceRGB " + (t.pal.length / 3 - 1) + " " + ("smask" in t ? i + 2 : i + 1) + " 0 R]") : (n("/ColorSpace /" + t.cs), t.cs === this.color_spaces.DEVICE_CMYK && n("/Decode [1 0 1 0 1 0 1 0]")), n("/BitsPerComponent " + t.bpc), "f" in t && n("/Filter /" + t.f), "dp" in t && n("/DecodeParms <<" + t.dp + ">>"), "trns" in t && t.trns.constructor == Array) { for (var s = "", r = 0, o = t.trns.length; r < o; r++)s += t.trns[r] + " " + t.trns[r] + " "; n("/Mask [" + s + "]") } if ("smask" in t && n("/SMask " + (i + 1) + " 0 R"), n("/Length " + t.data.length + ">>"), a(t.data), n("endobj"), "smask" in t) { var l = "/Predictor " + t.p + " /Colors 1 /BitsPerComponent " + t.bpc + " /Columns " + t.w, c = { w: t.w, h: t.h, cs: "DeviceGray", bpc: t.bpc, dp: l, data: t.smask }; "f" in t && (c.f = t.f), e.call(this, c) } t.cs === this.color_spaces.INDEXED && (this.internal.newObject(), n("<< /Length " + t.pal.length + ">>"), a(this.arrayBufferToBinaryString(new Uint8Array(t.pal))), n("endobj")) }, C = function () { var e = this.internal.collections[w + "images"]; for (var t in e) i.call(this, e[t]) }, x = function () { var e, t = this.internal.collections[w + "images"], i = this.internal.write; for (var n in t) i("/I" + (e = t[n]).i, e.n, "0", "R") }, k = function (e) { return "function" == typeof b["process" + e.toUpperCase()] }, T = function (e) { return "object" === (void 0 === e ? "undefined" : ye(e)) && 1 === e.nodeType }, S = function (e, t) { if ("IMG" === e.nodeName && e.hasAttribute("src")) { var i = "" + e.getAttribute("src"); if (0 === i.indexOf("data:image/")) return i; !t && /\.png(?:[?#].*)?$/i.test(i) && (t = "png") } if ("CANVAS" === e.nodeName) var n = e; else { (n = document.createElement("canvas")).width = e.clientWidth || e.width, n.height = e.clientHeight || e.height; var a = n.getContext("2d"); if (!a) throw "addImage requires canvas to be supported by browser."; a.drawImage(e, 0, 0, n.width, n.height) } return n.toDataURL("png" == ("" + t).toLowerCase() ? "image/png" : "image/jpeg") }, $ = function (e, t) { var i; if (t) for (var n in t) if (e === t[n].alias) { i = t[n]; break } return i }; b.color_spaces = { DEVICE_RGB: "DeviceRGB", DEVICE_GRAY: "DeviceGray", DEVICE_CMYK: "DeviceCMYK", CAL_GREY: "CalGray", CAL_RGB: "CalRGB", LAB: "Lab", ICC_BASED: "ICCBased", INDEXED: "Indexed", PATTERN: "Pattern", SEPARATION: "Separation", DEVICE_N: "DeviceN" }, b.decode = { DCT_DECODE: "DCTDecode", FLATE_DECODE: "FlateDecode", LZW_DECODE: "LZWDecode", JPX_DECODE: "JPXDecode", JBIG2_DECODE: "JBIG2Decode", ASCII85_DECODE: "ASCII85Decode", ASCII_HEX_DECODE: "ASCIIHexDecode", RUN_LENGTH_DECODE: "RunLengthDecode", CCITT_FAX_DECODE: "CCITTFaxDecode" }, b.image_compression = { NONE: "NONE", FAST: "FAST", MEDIUM: "MEDIUM", SLOW: "SLOW" }, b.sHashCode = function (e) { return e = e || "", Array.prototype.reduce && e.split("").reduce(function (e, t) { return (e = (e << 5) - e + t.charCodeAt(0)) & e }, 0) }, b.isString = function (e) { return "string" == typeof e }, b.validateStringAsBase64 = function (e) { var t = !0; return (e = e || "").length % 4 != 0 && (t = !1), !1 === /[A-Za-z0-9\/]+/.test(e.substr(0, e.length - 2)) && (t = !1), !1 === /[A-Za-z0-9\/][A-Za-z0-9+\/]|[A-Za-z0-9+\/]=|==/.test(e.substr(-2)) && (t = !1), t }, b.extractInfoFromBase64DataURI = function (e) { return /^data:([\w]+?\/([\w]+?));base64,(.+)$/g.exec(e) }, b.supportsArrayBuffer = function () { return "undefined" != typeof ArrayBuffer && "undefined" != typeof Uint8Array }, b.isArrayBuffer = function (e) { return !!this.supportsArrayBuffer() && e instanceof ArrayBuffer }, b.isArrayBufferView = function (e) { return !!this.supportsArrayBuffer() && ("undefined" != typeof Uint32Array && (e instanceof Int8Array || e instanceof Uint8Array || "undefined" != typeof Uint8ClampedArray && e instanceof Uint8ClampedArray || e instanceof Int16Array || e instanceof Uint16Array || e instanceof Int32Array || e instanceof Uint32Array || e instanceof Float32Array || e instanceof Float64Array)) }, b.binaryStringToUint8Array = function (e) { for (var t = e.length, i = new Uint8Array(t), n = 0; n < t; n++)i[n] = e.charCodeAt(n); return i }, b.arrayBufferToBinaryString = function (e) { if ("function" == typeof atob) return atob(this.arrayBufferToBase64(e)); if ("function" == typeof TextDecoder) { var t = new TextDecoder("ascii"); if ("ascii" === t.encoding) return t.decode(e) } for (var i = this.isArrayBuffer(e) ? e : new Uint8Array(e), n = "", a = Math.ceil(i.byteLength / 20480), s = 0; s < a; s++)n += String.fromCharCode.apply(null, i.slice(20480 * s, 20480 * s + 20480)); return n }, b.arrayBufferToBase64 = function (e) { for (var t, i = "", n = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/", a = new Uint8Array(e), s = a.byteLength, r = s % 3, o = s - r, l = 0; l < o; l += 3)i += n[(16515072 & (t = a[l] << 16 | a[l + 1] << 8 | a[l + 2])) >> 18] + n[(258048 & t) >> 12] + n[(4032 & t) >> 6] + n[63 & t]; return 1 == r ? i += n[(252 & (t = a[o])) >> 2] + n[(3 & t) << 4] + "==" : 2 == r && (i += n[(64512 & (t = a[o] << 8 | a[o + 1])) >> 10] + n[(1008 & t) >> 4] + n[(15 & t) << 2] + "="), i }, b.createImageInfo = function (e, t, i, n, a, s, r, o, l, c, d, u, h) { var p = { alias: o, w: t, h: i, cs: n, bpc: a, i: r, data: e }; return s && (p.f = s), l && (p.dp = l), c && (p.trns = c), d && (p.pal = d), u && (p.smask = u), h && (p.p = h), p }, b.addImage = function (e, t, i, n, a, s, r, o, l) { var c = ""; if ("string" != typeof t) { var d = s; s = a, a = n, n = i, i = t, t = d } if ("object" === (void 0 === e ? "undefined" : ye(e)) && !T(e) && "imageData" in e) { var u = e; e = u.imageData, t = u.format || t, i = u.x || i || 0, n = u.y || n || 0, a = u.w || a, s = u.h || s, r = u.alias || r, o = u.compression || o, l = u.rotation || u.angle || l } if (isNaN(i) || isNaN(n)) throw new Error("Invalid coordinates passed to jsPDF.addImage"); var h, p, f, m, g, _, v, y = function () { var e = this.internal.collections[w + "images"]; return e || (this.internal.collections[w + "images"] = e = {}, this.internal.events.subscribe("putResources", C), this.internal.events.subscribe("putXobjectDict", x)), e }.call(this); if (!(h = $(e, y)) && (T(e) && (e = S(e, t)), (null == (v = r) || 0 === v.length) && (r = "string" == typeof (_ = e) && b.sHashCode(_)), !(h = $(r, y)))) { if (this.isString(e) && ("" !== (c = this.convertStringToImageData(e)) ? e = c : void 0 !== (c = this.loadImageFile(e)) && (e = c)), t = this.getImageFileTypeByImageData(e, t), !k(t)) throw new Error("addImage does not support files of type '" + t + "', please ensure that a plugin for '" + t + "' support is added."); if (this.supportsArrayBuffer() && (e instanceof Uint8Array || (p = e, e = this.binaryStringToUint8Array(e))), !(h = this["process" + t.toUpperCase()](e, (g = 0, (m = y) && (g = Object.keys ? Object.keys(m).length : function (e) { var t = 0; for (var i in e) e.hasOwnProperty(i) && t++; return t }(m)), g), r, ((f = o) && "string" == typeof f && (f = f.toUpperCase()), f in b.image_compression ? f : b.image_compression.NONE), p))) throw new Error("An unkwown error occurred whilst processing the image") } return function (e, t, i, n, a, s, r, o) { var l = function (e, t, i) { return e || t || (t = e = -96), e < 0 && (e = -1 * i.w * 72 / e / this.internal.scaleFactor), t < 0 && (t = -1 * i.h * 72 / t / this.internal.scaleFactor), 0 === e && (e = t * i.w / i.h), 0 === t && (t = e * i.h / i.w), [e, t] }.call(this, i, n, a), c = this.internal.getCoordinateString, d = this.internal.getVerticalCoordinateString; if (i = l[0], n = l[1], r[s] = a, o) { o *= Math.PI / 180; var u = Math.cos(o), h = Math.sin(o), p = function (e) { return e.toFixed(4) }, f = [p(u), p(h), p(-1 * h), p(u), 0, 0, "cm"] } this.internal.write("q"), o ? (this.internal.write([1, "0", "0", 1, c(e), d(t + n), "cm"].join(" ")), this.internal.write(f.join(" ")), this.internal.write([c(i), "0", "0", c(n), "0", "0", "cm"].join(" "))) : this.internal.write([c(i), "0", "0", c(n), c(e), d(t + n), "cm"].join(" ")), this.internal.write("/I" + a.i + " Do"), this.internal.write("Q") }.call(this, i, n, a, s, h, h.i, y, l), this }, b.convertStringToImageData = function (e) { var t, i = ""; this.isString(e) && (null !== (t = this.extractInfoFromBase64DataURI(e)) ? b.validateStringAsBase64(t[3]) && (i = atob(t[3])) : b.validateStringAsBase64(e) && (i = atob(e))); return i }; var c = function (e, t) { return e.subarray(t, t + 5) }; b.processJPEG = function (e, t, i, n, a, s) { var r, o = this.decode.DCT_DECODE; if (!this.isString(e) && !this.isArrayBuffer(e) && !this.isArrayBufferView(e)) return null; if (this.isString(e) && (r = function (e) { var t; if (255 === !e.charCodeAt(0) || 216 === !e.charCodeAt(1) || 255 === !e.charCodeAt(2) || 224 === !e.charCodeAt(3) || !e.charCodeAt(6) === "J".charCodeAt(0) || !e.charCodeAt(7) === "F".charCodeAt(0) || !e.charCodeAt(8) === "I".charCodeAt(0) || !e.charCodeAt(9) === "F".charCodeAt(0) || 0 === !e.charCodeAt(10)) throw new Error("getJpegSize requires a binary string jpeg file"); for (var i = 256 * e.charCodeAt(4) + e.charCodeAt(5), n = 4, a = e.length; n < a;) { if (n += i, 255 !== e.charCodeAt(n)) throw new Error("getJpegSize could not find the size of the image"); if (192 === e.charCodeAt(n + 1) || 193 === e.charCodeAt(n + 1) || 194 === e.charCodeAt(n + 1) || 195 === e.charCodeAt(n + 1) || 196 === e.charCodeAt(n + 1) || 197 === e.charCodeAt(n + 1) || 198 === e.charCodeAt(n + 1) || 199 === e.charCodeAt(n + 1)) return t = 256 * e.charCodeAt(n + 5) + e.charCodeAt(n + 6), [256 * e.charCodeAt(n + 7) + e.charCodeAt(n + 8), t, e.charCodeAt(n + 9)]; n += 2, i = 256 * e.charCodeAt(n) + e.charCodeAt(n + 1) } }(e)), this.isArrayBuffer(e) && (e = new Uint8Array(e)), this.isArrayBufferView(e) && (r = function (e) { if (65496 != (e[0] << 8 | e[1])) throw new Error("Supplied data is not a JPEG"); for (var t, i = e.length, n = (e[4] << 8) + e[5], a = 4; a < i;) { if (n = ((t = c(e, a += n))[2] << 8) + t[3], (192 === t[1] || 194 === t[1]) && 255 === t[0] && 7 < n) return { width: ((t = c(e, a + 5))[2] << 8) + t[3], height: (t[0] << 8) + t[1], numcomponents: t[4] }; a += 2 } throw new Error("getJpegSizeFromBytes could not find the size of the image") }(e), e = a || this.arrayBufferToBinaryString(e)), void 0 === s) switch (r.numcomponents) { case 1: s = this.color_spaces.DEVICE_GRAY; break; case 4: s = this.color_spaces.DEVICE_CMYK; break; default: case 3: s = this.color_spaces.DEVICE_RGB }return this.createImageInfo(e, r.width, r.height, s, 8, o, t, i) }, b.processJPG = function () { return this.processJPEG.apply(this, arguments) }, b.loadImageFile = function (e, t, i) { t = t || !0, i = i || function () { }; Object.prototype.toString.call("undefined" != typeof process ? process : 0); if (void 0 !== ("undefined" == typeof window ? "undefined" : ye(window)) && "object" === ("undefined" == typeof location ? "undefined" : ye(location)) && "http" === location.protocol.substr(0, 4)) return function (e, t, i) { var n = new XMLHttpRequest, a = [], s = 0, r = function (e) { var t = e.length, i = String.fromCharCode; for (s = 0; s < t; s += 1)a.push(i(255 & e.charCodeAt(s))); return a.join("") }; if (n.open("GET", e, !t), n.overrideMimeType("text/plain; charset=x-user-defined"), !1 === t && (n.onload = function () { return r(this.responseText) }), n.send(null), 200 === n.status) return t ? r(n.responseText) : void 0 }(e, t) }, b.getImageProperties = function (e) { var t, i, n = ""; if (T(e) && (e = S(e)), this.isString(e) && ("" !== (n = this.convertStringToImageData(e)) ? e = n : void 0 !== (n = this.loadImageFile(e)) && (e = n)), i = this.getImageFileTypeByImageData(e), !k(i)) throw new Error("addImage does not support files of type '" + i + "', please ensure that a plugin for '" + i + "' support is added."); if (this.supportsArrayBuffer() && (e instanceof Uint8Array || (e = this.binaryStringToUint8Array(e))), !(t = this["process" + i.toUpperCase()](e))) throw new Error("An unkwown error occurred whilst processing the image"); return { fileType: i, width: t.w, height: t.h, colorSpace: t.cs, compressionMode: t.f, bitsPerComponent: t.bpc } } }(Z.API), e = Z.API, v = { annotations: [], f2: function (e) { return e.toFixed(2) }, notEmpty: function (e) { if (void 0 !== e && "" != e) return !0 } }, Z.API.annotationPlugin = v, Z.API.events.push(["addPage", function (e) { this.annotationPlugin.annotations[e.pageNumber] = [] }]), e.events.push(["putPage", function (e) { for (var t = this.annotationPlugin.annotations[e.pageNumber], i = !1, n = 0; n < t.length && !i; n++)switch ((l = t[n]).type) { case "link": if (v.notEmpty(l.options.url) || v.notEmpty(l.options.pageNumber)) { i = !0; break } case "reference": case "text": case "freetext": i = !0 }if (0 != i) { this.internal.write("/Annots ["); var a = this.annotationPlugin.f2, s = this.internal.scaleFactor, r = this.internal.pageSize.getHeight(), o = this.internal.getPageInfo(e.pageNumber); for (n = 0; n < t.length; n++) { var l; switch ((l = t[n]).type) { case "reference": this.internal.write(" " + l.object.objId + " 0 R "); break; case "text": var c = this.internal.newAdditionalObject(), d = this.internal.newAdditionalObject(), u = l.title || "Note"; g = "<</Type /Annot /Subtype /Text " + (p = "/Rect [" + a(l.bounds.x * s) + " " + a(r - (l.bounds.y + l.bounds.h) * s) + " " + a((l.bounds.x + l.bounds.w) * s) + " " + a((r - l.bounds.y) * s) + "] ") + "/Contents (" + l.contents + ")", g += " /Popup " + d.objId + " 0 R", g += " /P " + o.objId + " 0 R", g += " /T (" + u + ") >>", c.content = g; var h = c.objId + " 0 R"; g = "<</Type /Annot /Subtype /Popup " + (p = "/Rect [" + a((l.bounds.x + 30) * s) + " " + a(r - (l.bounds.y + l.bounds.h) * s) + " " + a((l.bounds.x + l.bounds.w + 30) * s) + " " + a((r - l.bounds.y) * s) + "] ") + " /Parent " + h, l.open && (g += " /Open true"), g += " >>", d.content = g, this.internal.write(c.objId, "0 R", d.objId, "0 R"); break; case "freetext": var p = "/Rect [" + a(l.bounds.x * s) + " " + a((r - l.bounds.y) * s) + " " + a(l.bounds.x + l.bounds.w * s) + " " + a(r - (l.bounds.y + l.bounds.h) * s) + "] ", f = l.color || "#000000"; g = "<</Type /Annot /Subtype /FreeText " + p + "/Contents (" + l.contents + ")", g += " /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#" + f + ")", g += " /Border [0 0 0]", g += " >>", this.internal.write(g); break; case "link": if (l.options.name) { var m = this.annotations._nameMap[l.options.name]; l.options.pageNumber = m.page, l.options.top = m.y } else l.options.top || (l.options.top = 0); p = "/Rect [" + a(l.x * s) + " " + a((r - l.y) * s) + " " + a((l.x + l.w) * s) + " " + a((r - (l.y + l.h)) * s) + "] "; var g = ""; if (l.options.url) g = "<</Type /Annot /Subtype /Link " + p + "/Border [0 0 0] /A <</S /URI /URI (" + l.options.url + ") >>"; else if (l.options.pageNumber) switch (g = "<</Type /Annot /Subtype /Link " + p + "/Border [0 0 0] /Dest [" + (e = this.internal.getPageInfo(l.options.pageNumber)).objId + " 0 R", l.options.magFactor = l.options.magFactor || "XYZ", l.options.magFactor) { case "Fit": g += " /Fit]"; break; case "FitH": g += " /FitH " + l.options.top + "]"; break; case "FitV": l.options.left = l.options.left || 0, g += " /FitV " + l.options.left + "]"; break; case "XYZ": default: var _ = a((r - l.options.top) * s); l.options.left = l.options.left || 0, void 0 === l.options.zoom && (l.options.zoom = 0), g += " /XYZ " + l.options.left + " " + _ + " " + l.options.zoom + "]" }"" != g && (g += " >>", this.internal.write(g)) } } this.internal.write("]") } }]), e.createAnnotation = function (e) { switch (e.type) { case "link": this.link(e.bounds.x, e.bounds.y, e.bounds.w, e.bounds.h, e); break; case "text": case "freetext": this.annotationPlugin.annotations[this.internal.getCurrentPageInfo().pageNumber].push(e) } }, e.link = function (e, t, i, n, a) { this.annotationPlugin.annotations[this.internal.getCurrentPageInfo().pageNumber].push({ x: e, y: t, w: i, h: n, options: a, type: "link" }) }, e.textWithLink = function (e, t, i, n) { var a = this.getTextWidth(e), s = this.internal.getLineHeight() / this.internal.scaleFactor; return this.text(e, t, i), i += .2 * s, this.link(t, i - s, a, s, n), a }, e.getTextWidth = function (e) { var t = this.internal.getFontSize(); return this.getStringUnitWidth(e) * t / this.internal.scaleFactor }, e.getLineHeight = function () { return this.internal.getLineHeight() }, function (e) { var r = Object.keys({ ar: "Arabic (Standard)", "ar-DZ": "Arabic (Algeria)", "ar-BH": "Arabic (Bahrain)", "ar-EG": "Arabic (Egypt)", "ar-IQ": "Arabic (Iraq)", "ar-JO": "Arabic (Jordan)", "ar-KW": "Arabic (Kuwait)", "ar-LB": "Arabic (Lebanon)", "ar-LY": "Arabic (Libya)", "ar-MA": "Arabic (Morocco)", "ar-OM": "Arabic (Oman)", "ar-QA": "Arabic (Qatar)", "ar-SA": "Arabic (Saudi Arabia)", "ar-SY": "Arabic (Syria)", "ar-TN": "Arabic (Tunisia)", "ar-AE": "Arabic (U.A.E.)", "ar-YE": "Arabic (Yemen)", fa: "Persian", "fa-IR": "Persian/Iran", ur: "Urdu" }), u = { 1569: [65152], 1570: [65153, 65154, 65153, 65154], 1571: [65155, 65156, 65155, 65156], 1572: [65157, 65158], 1573: [65159, 65160, 65159, 65160], 1574: [65161, 65162, 65163, 65164], 1575: [65165, 65166, 65165, 65166], 1576: [65167, 65168, 65169, 65170], 1577: [65171, 65172], 1578: [65173, 65174, 65175, 65176], 1579: [65177, 65178, 65179, 65180], 1580: [65181, 65182, 65183, 65184], 1581: [65185, 65186, 65187, 65188], 1582: [65189, 65190, 65191, 65192], 1583: [65193, 65194, 65193], 1584: [65195, 65196, 65195], 1585: [65197, 65198, 65197], 1586: [65199, 65200, 65199], 1587: [65201, 65202, 65203, 65204], 1588: [65205, 65206, 65207, 65208], 1589: [65209, 65210, 65211, 65212], 1590: [65213, 65214, 65215, 65216], 1591: [65217, 65218, 65219, 65220], 1592: [65221, 65222, 65223, 65224], 1593: [65225, 65226, 65227, 65228], 1594: [65229, 65230, 65231, 65232], 1601: [65233, 65234, 65235, 65236], 1602: [65237, 65238, 65239, 65240], 1603: [65241, 65242, 65243, 65244], 1604: [65245, 65246, 65247, 65248], 1605: [65249, 65250, 65251, 65252], 1606: [65253, 65254, 65255, 65256], 1607: [65257, 65258, 65259, 65260], 1608: [65261, 65262, 65261], 1609: [65263, 65264, 64488, 64489], 1610: [65265, 65266, 65267, 65268], 1649: [64336, 64337], 1655: [64477], 1657: [64358, 64359, 64360, 64361], 1658: [64350, 64351, 64352, 64353], 1659: [64338, 64339, 64340, 64341], 1662: [64342, 64343, 64344, 64345], 1663: [64354, 64355, 64356, 64357], 1664: [64346, 64347, 64348, 64349], 1667: [64374, 64375, 64376, 64377], 1668: [64370, 64371, 64372, 64373], 1670: [64378, 64379, 64380, 64381], 1671: [64382, 64383, 64384, 64385], 1672: [64392, 64393], 1676: [64388, 64389], 1677: [64386, 64387], 1678: [64390, 64391], 1681: [64396, 64397], 1688: [64394, 64395, 64394], 1700: [64362, 64363, 64364, 64365], 1702: [64366, 64367, 64368, 64369], 1705: [64398, 64399, 64400, 64401], 1709: [64467, 64468, 64469, 64470], 1711: [64402, 64403, 64404, 64405], 1713: [64410, 64411, 64412, 64413], 1715: [64406, 64407, 64408, 64409], 1722: [64414, 64415], 1723: [64416, 64417, 64418, 64419], 1726: [64426, 64427, 64428, 64429], 1728: [64420, 64421], 1729: [64422, 64423, 64424, 64425], 1733: [64480, 64481], 1734: [64473, 64474], 1735: [64471, 64472], 1736: [64475, 64476], 1737: [64482, 64483], 1739: [64478, 64479], 1740: [64508, 64509, 64510, 64511], 1744: [64484, 64485, 64486, 64487], 1746: [64430, 64431], 1747: [64432, 64433] }, h = { 1570: [65269, 65270, 65269, 65270], 1571: [65271, 65272, 65271, 65272], 1573: [65273, 65274, 65273, 65274], 1575: [65275, 65276, 65275, 65276] }, p = { 1570: [65153, 65154, 65153, 65154], 1571: [65155, 65156, 65155, 65156], 1573: [65159, 65160, 65159, 65160], 1575: [65165, 65166, 65165, 65166] }, f = { 1612: 64606, 1613: 64607, 1614: 64608, 1615: 64609, 1616: 64610 }, t = [1570, 1571, 1573, 1575], i = [1569, 1570, 1571, 1572, 1573, 1575, 1577, 1583, 1584, 1585, 1586, 1608, 1688], s = 0, o = 1, l = 2, c = 3; function m(e) { return void 0 !== e && void 0 !== u[e.charCodeAt(0)] } function d(e) { return void 0 !== e && 0 <= i.indexOf(e.charCodeAt(0)) } function g(e) { return void 0 !== e && 0 <= t.indexOf(e.charCodeAt(0)) } function _(e) { return m(e) && 2 <= u[e.charCodeAt(0)].length } function v(e, t, i, n) { return m(e) ? (n = n || {}, u = Object.assign(u, n), !_(e) || !m(t) && !m(i) || !m(i) && d(t) || d(e) && !m(t) || d(e) && g(t) || d(e) && d(t) ? (u = Object.assign(u, p), s) : m(a = e) && 4 == u[a.charCodeAt(0)].length && m(t) && !d(t) && m(i) && _(i) ? (u = Object.assign(u, p), c) : d(e) || !m(i) ? (u = Object.assign(u, p), o) : (u = Object.assign(u, p), l)) : -1; var a } var y = e.processArabic = function (e, t) { e = e || "", t = t || !1; var i, n, a, s = "", r = 0, o = 0, l = "", c = "", d = ""; for (r = 0; r < e.length; r += 1)l = e[r], c = e[r - 1], d = e[r + 1], m(l) ? void 0 !== c && 1604 === c.charCodeAt(0) && g(l) ? (o = v(l, e[r - 2], e[r + 1], h), i = String.fromCharCode(h[l.charCodeAt(0)][o]), s = s.substr(0, s.length - 1) + i) : void 0 !== c && 1617 === c.charCodeAt(0) && (void 0 !== (n = l) && void 0 !== f[n.charCodeAt(0)]) ? (o = v(l, e[r - 2], e[r + 1], p), i = String.fromCharCode(f[l.charCodeAt(0)][o]), s = s.substr(0, s.length - 1) + i) : (o = v(l, c, d, p), s += String.fromCharCode(u[l.charCodeAt(0)][o])) : s += t ? { "(": ")", ")": "(" }[a = l] || a : l; return t ? s.split("").reverse().join("") : s }; e.events.push(["preProcessText", function (e) { var t = e.text, i = (e.x, e.y, e.options || {}), n = (e.mutex, i.lang), a = []; if (0 <= r.indexOf(n)) { if ("[object Array]" === Object.prototype.toString.call(t)) { var s = 0; for (a = [], s = 0; s < t.length; s += 1)"[object Array]" === Object.prototype.toString.call(t[s]) ? a.push([y(t[s][0], !0), t[s][1], t[s][2]]) : a.push([y(t[s], !0)]); e.text = a } else e.text = y(t, !0); void 0 === i.charSpace && (e.options.charSpace = 0), !0 === i.R2L && (e.options.R2L = !1) } }]) }(Z.API), Z.API.autoPrint = function (e) { var t; switch ((e = e || {}).variant = e.variant || "non-conform", e.variant) { case "javascript": this.addJS("print({});"); break; case "non-conform": default: this.internal.events.subscribe("postPutResources", function () { t = this.internal.newObject(), this.internal.out("<<"), this.internal.out("/S /Named"), this.internal.out("/Type /Action"), this.internal.out("/N /Print"), this.internal.out(">>"), this.internal.out("endobj") }), this.internal.events.subscribe("putCatalog", function () { this.internal.out("/OpenAction " + t + " 0 R") }) }return this }, (t = Z.API).events.push(["initialized", function () { this.canvas.pdf = this }]), t.canvas = { getContext: function (e) { return (this.pdf.context2d._canvas = this).pdf.context2d }, childNodes: [] }, Object.defineProperty(t.canvas, "width", { get: function () { return this._width }, set: function (e) { this._width = e, this.getContext("2d").pageWrapX = e + 1 } }), Object.defineProperty(t.canvas, "height", { get: function () { return this._height }, set: function (e) { this._height = e, this.getContext("2d").pageWrapY = e + 1 } }), S = Z.API, $ = { x: void 0, y: void 0, w: void 0, h: void 0, ln: void 0 }, A = 1, p = function (e, t, i, n, a) { $ = { x: e, y: t, w: i, h: n, ln: a } }, f = function () { return $ }, I = { left: 0, top: 0, bottom: 0 }, S.setHeaderFunction = function (e) { l = e }, S.getTextDimensions = function (t) { a = this.internal.getFont().fontName, s = this.table_font_size || this.internal.getFontSize(), r = this.internal.getFont().fontStyle; var e, i, n = 19.049976 / 25.4; (i = document.createElement("font")).id = "jsPDFCell"; try { i.style.fontStyle = r } catch (e) { i.style.fontWeight = r } i.style.fontSize = s + "pt", i.style.fontFamily = a; try { i.textContent = t } catch (e) { i.innerText = t } return document.body.appendChild(i), e = { w: (i.offsetWidth + 1) * n, h: (i.offsetHeight + 1) * n }, document.body.removeChild(i), e }, S.cellAddPage = function () { var e = this.margins || I; this.addPage(), p(e.left, e.top, void 0, void 0), A += 1 }, S.cellInitialize = function () { $ = { x: void 0, y: void 0, w: void 0, h: void 0, ln: void 0 }, A = 1 }, S.cell = function (e, t, i, n, a, s, r) { var o = f(), l = !1; if (void 0 !== o.ln) if (o.ln === s) e = o.x + o.w, t = o.y; else { var c = this.margins || I; o.y + o.h + n + 13 >= this.internal.pageSize.getHeight() - c.bottom && (this.cellAddPage(), l = !0, this.printHeaders && this.tableHeaderRow && this.printHeaderRow(s, !0)), t = f().y + f().h, l && (t = 23) } if (void 0 !== a[0]) if (this.printingHeaderRow ? this.rect(e, t, i, n, "FD") : this.rect(e, t, i, n), "right" === r) { a instanceof Array || (a = [a]); for (var d = 0; d < a.length; d++) { var u = a[d], h = this.getStringUnitWidth(u) * this.internal.getFontSize(); this.text(u, e + i - h - 3, t + this.internal.getLineHeight() * (d + 1)) } } else this.text(a, e + 3, t + this.internal.getLineHeight()); return p(e, t, i, n, s), this }, S.arrayMax = function (e, t) { var i, n, a, s = e[0]; for (i = 0, n = e.length; i < n; i += 1)a = e[i], t ? -1 === t(s, a) && (s = a) : s < a && (s = a); return s }, S.table = function (e, t, i, n, a) { if (!i) throw "No data for PDF table"; var s, r, o, l, c, d, u, h, p, f, m = [], g = [], _ = {}, v = {}, y = [], b = [], w = !1, C = !0, x = 12, k = I; if (k.width = this.internal.pageSize.getWidth(), a && (!0 === a.autoSize && (w = !0), !1 === a.printHeaders && (C = !1), a.fontSize && (x = a.fontSize), a.css && void 0 !== a.css["font-size"] && (x = 16 * a.css["font-size"]), a.margins && (k = a.margins)), this.lnMod = 0, $ = { x: void 0, y: void 0, w: void 0, h: void 0, ln: void 0 }, A = 1, this.printHeaders = C, this.margins = k, this.setFontSize(x), this.table_font_size = x, null == n) m = Object.keys(i[0]); else if (n[0] && "string" != typeof n[0]) for (r = 0, o = n.length; r < o; r += 1)s = n[r], m.push(s.name), g.push(s.prompt), v[s.name] = s.width * (19.049976 / 25.4); else m = n; if (w) for (f = function (e) { return e[s] }, r = 0, o = m.length; r < o; r += 1) { for (_[s = m[r]] = i.map(f), y.push(this.getTextDimensions(g[r] || s).w), u = 0, l = (d = _[s]).length; u < l; u += 1)c = d[u], y.push(this.getTextDimensions(c).w); v[s] = S.arrayMax(y), y = [] } if (C) { var T = this.calculateLineHeight(m, v, g.length ? g : m); for (r = 0, o = m.length; r < o; r += 1)s = m[r], b.push([e, t, v[s], T, String(g.length ? g[r] : s)]); this.setTableHeaderRow(b), this.printHeaderRow(1, !1) } for (r = 0, o = i.length; r < o; r += 1)for (h = i[r], T = this.calculateLineHeight(m, v, h), u = 0, p = m.length; u < p; u += 1)s = m[u], this.cell(e, t, v[s], T, h[s], r + 2, s.align); return this.lastCellPos = $, this.table_x = e, this.table_y = t, this }, S.calculateLineHeight = function (e, t, i) { for (var n, a = 0, s = 0; s < e.length; s++) { i[n = e[s]] = this.splitTextToSize(String(i[n]), t[n] - 3); var r = this.internal.getLineHeight() * i[n].length + 3; a < r && (a = r) } return a }, S.setTableHeaderRow = function (e) { this.tableHeaderRow = e }, S.printHeaderRow = function (e, t) { if (!this.tableHeaderRow) throw "Property tableHeaderRow does not exist."; var i, n, a, s; if (this.printingHeaderRow = !0, void 0 !== l) { var r = l(this, A); p(r[0], r[1], r[2], r[3], -1) } this.setFontStyle("bold"); var o = []; for (a = 0, s = this.tableHeaderRow.length; a < s; a += 1)this.setFillColor(200, 200, 200), i = this.tableHeaderRow[a], t && (this.margins.top = 13, i[1] = this.margins && this.margins.top || 0, o.push(i)), n = [].concat(i), this.cell.apply(this, n.concat(e)); 0 < o.length && this.setTableHeaderRow(o), this.setFontStyle("normal"), this.printingHeaderRow = !1 }, function (e) { e.events.push(["initialized", function () { ((this.context2d.pdf = this).context2d.internal.pdf = this).context2d.ctx = new t, this.context2d.ctxStack = [], this.context2d.path = [] }]), e.context2d = { pageWrapXEnabled: !1, pageWrapYEnabled: !1, pageWrapX: 9999999, pageWrapY: 9999999, ctx: new t, f2: function (e) { return e.toFixed(2) }, fillRect: function (e, t, i, n) { if (!this._isFillTransparent()) { e = this._wrapX(e), t = this._wrapY(t); var a = this._matrix_map_rect(this.ctx._transform, { x: e, y: t, w: i, h: n }); this.pdf.rect(a.x, a.y, a.w, a.h, "f") } }, strokeRect: function (e, t, i, n) { if (!this._isStrokeTransparent()) { e = this._wrapX(e), t = this._wrapY(t); var a = this._matrix_map_rect(this.ctx._transform, { x: e, y: t, w: i, h: n }); this.pdf.rect(a.x, a.y, a.w, a.h, "s") } }, clearRect: function (e, t, i, n) { if (!this.ctx.ignoreClearRect) { e = this._wrapX(e), t = this._wrapY(t); var a = this._matrix_map_rect(this.ctx._transform, { x: e, y: t, w: i, h: n }); this.save(), this.setFillStyle("#ffffff"), this.pdf.rect(a.x, a.y, a.w, a.h, "f"), this.restore() } }, save: function () { this.ctx._fontSize = this.pdf.internal.getFontSize(); var e = new t; e.copy(this.ctx), this.ctxStack.push(this.ctx), this.ctx = e }, restore: function () { this.ctx = this.ctxStack.pop(), this.setFillStyle(this.ctx.fillStyle), this.setStrokeStyle(this.ctx.strokeStyle), this.setFont(this.ctx.font), this.pdf.setFontSize(this.ctx._fontSize), this.setLineCap(this.ctx.lineCap), this.setLineWidth(this.ctx.lineWidth), this.setLineJoin(this.ctx.lineJoin) }, rect: function (e, t, i, n) { this.moveTo(e, t), this.lineTo(e + i, t), this.lineTo(e + i, t + n), this.lineTo(e, t + n), this.lineTo(e, t), this.closePath() }, beginPath: function () { this.path = [] }, closePath: function () { this.path.push({ type: "close" }) }, _getRGBA: function (e) { var t, i, n, a, s = new RGBColor(e); if (!e) return { r: 0, g: 0, b: 0, a: 0, style: e }; if (this.internal.rxTransparent.test(e)) a = n = i = t = 0; else { var r = this.internal.rxRgb.exec(e); null != r ? (t = parseInt(r[1]), i = parseInt(r[2]), n = parseInt(r[3]), a = 1) : null != (r = this.internal.rxRgba.exec(e)) ? (t = parseInt(r[1]), i = parseInt(r[2]), n = parseInt(r[3]), a = parseFloat(r[4])) : (a = 1, "#" != e.charAt(0) && (e = s.ok ? s.toHex() : "#000000"), 4 === e.length ? (t = e.substring(1, 2), t += t, i = e.substring(2, 3), i += i, n = e.substring(3, 4), n += n) : (t = e.substring(1, 3), i = e.substring(3, 5), n = e.substring(5, 7)), t = parseInt(t, 16), i = parseInt(i, 16), n = parseInt(n, 16)) } return { r: t, g: i, b: n, a: a, style: e } }, setFillStyle: function (e) { var t = this._getRGBA(e); this.ctx.fillStyle = e, this.ctx._isFillTransparent = 0 === t.a, this.ctx._fillOpacity = t.a, this.pdf.setFillColor(t.r, t.g, t.b, { a: t.a }), this.pdf.setTextColor(t.r, t.g, t.b, { a: t.a }) }, setStrokeStyle: function (e) { var t = this._getRGBA(e); this.ctx.strokeStyle = t.style, this.ctx._isStrokeTransparent = 0 === t.a, this.ctx._strokeOpacity = t.a, 0 === t.a ? this.pdf.setDrawColor(255, 255, 255) : (t.a, this.pdf.setDrawColor(t.r, t.g, t.b)) }, fillText: function (e, t, i, n) { if (!this._isFillTransparent()) { t = this._wrapX(t), i = this._wrapY(i); var a = this._matrix_map_point(this.ctx._transform, [t, i]); t = a[0], i = a[1]; var s = 57.2958 * this._matrix_rotation(this.ctx._transform); if (0 < this.ctx._clip_path.length) { var r; (r = window.outIntercept ? "group" === window.outIntercept.type ? window.outIntercept.stream : window.outIntercept : this.internal.getCurrentPage()).push("q"); var o = this.path; this.path = this.ctx._clip_path, this.ctx._clip_path = [], this._fill(null, !0), this.ctx._clip_path = this.path, this.path = o } var l = 1; try { l = this._matrix_decompose(this._getTransform()).scale[0] } catch (e) { } if (l < .01) this.pdf.text(e, t, this._getBaseline(i), null, s); else { var c = this.pdf.internal.getFontSize(); this.pdf.setFontSize(c * l), this.pdf.text(e, t, this._getBaseline(i), null, s), this.pdf.setFontSize(c) } 0 < this.ctx._clip_path.length && r.push("Q") } }, strokeText: function (e, t, i, n) { if (!this._isStrokeTransparent()) { t = this._wrapX(t), i = this._wrapY(i); var a = this._matrix_map_point(this.ctx._transform, [t, i]); t = a[0], i = a[1]; var s = 57.2958 * this._matrix_rotation(this.ctx._transform); if (0 < this.ctx._clip_path.length) { var r; (r = window.outIntercept ? "group" === window.outIntercept.type ? window.outIntercept.stream : window.outIntercept : this.internal.getCurrentPage()).push("q"); var o = this.path; this.path = this.ctx._clip_path, this.ctx._clip_path = [], this._fill(null, !0), this.ctx._clip_path = this.path, this.path = o } var l = 1; try { l = this._matrix_decompose(this._getTransform()).scale[0] } catch (e) { } if (1 === l) this.pdf.text(e, t, this._getBaseline(i), { stroke: !0 }, s); else { var c = this.pdf.internal.getFontSize(); this.pdf.setFontSize(c * l), this.pdf.text(e, t, this._getBaseline(i), { stroke: !0 }, s), this.pdf.setFontSize(c) } 0 < this.ctx._clip_path.length && r.push("Q") } }, setFont: function (e) { if (this.ctx.font = e, null != (c = /\s*(\w+)\s+(\w+)\s+(\w+)\s+([\d\.]+)(px|pt|em)\s+(.*)?/.exec(e))) { var t = c[1], i = (c[2], c[3]), n = c[4], a = c[5], s = c[6]; n = "px" === a ? Math.floor(parseFloat(n)) : "em" === a ? Math.floor(parseFloat(n) * this.pdf.getFontSize()) : Math.floor(parseFloat(n)), this.pdf.setFontSize(n), "bold" === i || "700" === i ? this.pdf.setFontStyle("bold") : "italic" === t ? this.pdf.setFontStyle("italic") : this.pdf.setFontStyle("normal"), d = "bold" === i || "700" === i ? "italic" === t ? "bolditalic" : "bold" : "italic" === t ? "italic" : "normal"; for (var r = s.toLowerCase().split(/\s*,\s*/), o = "Times", l = 0; l < r.length; l++) { if (void 0 !== this.pdf.internal.getFont(r[l], d, { noFallback: !0, disableWarning: !0 })) { o = r[l]; break } if ("bolditalic" === d && void 0 !== this.pdf.internal.getFont(r[l], "bold", { noFallback: !0, disableWarning: !0 })) o = r[l], d = "bold"; else if (void 0 !== this.pdf.internal.getFont(r[l], "normal", { noFallback: !0, disableWarning: !0 })) { o = r[l], d = "normal"; break } } this.pdf.setFont(o, d) } else { var c = /\s*(\d+)(pt|px|em)\s+([\w "]+)\s*([\w "]+)?/.exec(e); if (null != c) { var d, u = c[1], h = (c[2], c[3]); (d = c[4]) || (d = "normal"), u = "em" === a ? Math.floor(parseFloat(n) * this.pdf.getFontSize()) : Math.floor(parseFloat(u)), this.pdf.setFontSize(u), this.pdf.setFont(h, d) } } }, setTextBaseline: function (e) { this.ctx.textBaseline = e }, getTextBaseline: function () { return this.ctx.textBaseline }, setTextAlign: function (e) { this.ctx.textAlign = e }, getTextAlign: function () { return this.ctx.textAlign }, setLineWidth: function (e) { this.ctx.lineWidth = e, this.pdf.setLineWidth(e) }, setLineCap: function (e) { this.ctx.lineCap = e, this.pdf.setLineCap(e) }, setLineJoin: function (e) { this.ctx.lineJoin = e, this.pdf.setLineJoin(e) }, moveTo: function (e, t) { e = this._wrapX(e), t = this._wrapY(t); var i = this._matrix_map_point(this.ctx._transform, [e, t]), n = { type: "mt", x: e = i[0], y: t = i[1] }; this.path.push(n) }, _wrapX: function (e) { return this.pageWrapXEnabled ? e % this.pageWrapX : e }, _wrapY: function (e) { return this.pageWrapYEnabled ? (this._gotoPage(this._page(e)), (e - this.lastBreak) % this.pageWrapY) : e }, transform: function (e, t, i, n, a, s) { this.ctx._transform = this._matrix_multiply(this.ctx._transform, [e, t, i, n, a, s]) }, setTransform: function (e, t, i, n, a, s) { this.ctx._transform = [e, t, i, n, a, s] }, _getTransform: function () { return this.ctx._transform }, lastBreak: 0, pageBreaks: [], _page: function (e) { if (this.pageWrapYEnabled) { for (var t = this.lastBreak = 0, i = 0, n = 0; n < this.pageBreaks.length; n++)if (e >= this.pageBreaks[n]) { t++ , 0 === this.lastBreak && i++; var a = this.pageBreaks[n] - this.lastBreak; this.lastBreak = this.pageBreaks[n], i += Math.floor(a / this.pageWrapY) } if (0 === this.lastBreak) i += Math.floor(e / this.pageWrapY) + 1; return i + t } return this.pdf.internal.getCurrentPageInfo().pageNumber }, _gotoPage: function (e) { }, lineTo: function (e, t) { e = this._wrapX(e), t = this._wrapY(t); var i = this._matrix_map_point(this.ctx._transform, [e, t]), n = { type: "lt", x: e = i[0], y: t = i[1] }; this.path.push(n) }, bezierCurveTo: function (e, t, i, n, a, s) { var r; e = this._wrapX(e), t = this._wrapY(t), i = this._wrapX(i), n = this._wrapY(n), a = this._wrapX(a), s = this._wrapY(s), a = (r = this._matrix_map_point(this.ctx._transform, [a, s]))[0], s = r[1]; var o = { type: "bct", x1: e = (r = this._matrix_map_point(this.ctx._transform, [e, t]))[0], y1: t = r[1], x2: i = (r = this._matrix_map_point(this.ctx._transform, [i, n]))[0], y2: n = r[1], x: a, y: s }; this.path.push(o) }, quadraticCurveTo: function (e, t, i, n) { var a; e = this._wrapX(e), t = this._wrapY(t), i = this._wrapX(i), n = this._wrapY(n), i = (a = this._matrix_map_point(this.ctx._transform, [i, n]))[0], n = a[1]; var s = { type: "qct", x1: e = (a = this._matrix_map_point(this.ctx._transform, [e, t]))[0], y1: t = a[1], x: i, y: n }; this.path.push(s) }, arc: function (e, t, i, n, a, s) { if (e = this._wrapX(e), t = this._wrapY(t), !this._matrix_is_identity(this.ctx._transform)) { var r = this._matrix_map_point(this.ctx._transform, [e, t]); e = r[0], t = r[1]; var o = this._matrix_map_point(this.ctx._transform, [0, 0]), l = this._matrix_map_point(this.ctx._transform, [0, i]); i = Math.sqrt(Math.pow(l[0] - o[0], 2) + Math.pow(l[1] - o[1], 2)) } var c = { type: "arc", x: e, y: t, radius: i, startAngle: n, endAngle: a, anticlockwise: s }; this.path.push(c) }, drawImage: function (e, t, i, n, a, s, r, o, l) { void 0 !== s && (t = s, i = r, n = o, a = l), t = this._wrapX(t), i = this._wrapY(i); var c, d = this._matrix_map_rect(this.ctx._transform, { x: t, y: i, w: n, h: a }), u = (this._matrix_map_rect(this.ctx._transform, { x: s, y: r, w: o, h: l }), /data:image\/(\w+).*/i.exec(e)); c = null != u ? u[1] : "png", this.pdf.addImage(e, c, d.x, d.y, d.w, d.h) }, _matrix_multiply: function (e, t) { var i = t[0], n = t[1], a = t[2], s = t[3], r = t[4], o = t[5], l = i * e[0] + n * e[2], c = a * e[0] + s * e[2], d = r * e[0] + o * e[2] + e[4]; return n = i * e[1] + n * e[3], s = a * e[1] + s * e[3], o = r * e[1] + o * e[3] + e[5], [i = l, n, a = c, s, r = d, o] }, _matrix_rotation: function (e) { return Math.atan2(e[2], e[0]) }, _matrix_decompose: function (e) { var t = e[0], i = e[1], n = e[2], a = e[3], s = Math.sqrt(t * t + i * i), r = (t /= s) * n + (i /= s) * a; n -= t * r, a -= i * r; var o = Math.sqrt(n * n + a * a); return r /= o, t * (a /= o) < i * (n /= o) && (t = -t, i = -i, r = -r, s = -s), { scale: [s, 0, 0, o, 0, 0], translate: [1, 0, 0, 1, e[4], e[5]], rotate: [t, i, -i, t, 0, 0], skew: [1, 0, r, 1, 0, 0] } }, _matrix_map_point: function (e, t) { var i = e[0], n = e[1], a = e[2], s = e[3], r = e[4], o = e[5], l = t[0], c = t[1]; return [l * i + c * a + r, l * n + c * s + o] }, _matrix_map_point_obj: function (e, t) { var i = this._matrix_map_point(e, [t.x, t.y]); return { x: i[0], y: i[1] } }, _matrix_map_rect: function (e, t) { var i = this._matrix_map_point(e, [t.x, t.y]), n = this._matrix_map_point(e, [t.x + t.w, t.y + t.h]); return { x: i[0], y: i[1], w: n[0] - i[0], h: n[1] - i[1] } }, _matrix_is_identity: function (e) { return 1 == e[0] && (0 == e[1] && (0 == e[2] && (1 == e[3] && (0 == e[4] && 0 == e[5])))) }, rotate: function (e) { var t = [Math.cos(e), Math.sin(e), -Math.sin(e), Math.cos(e), 0, 0]; this.ctx._transform = this._matrix_multiply(this.ctx._transform, t) }, scale: function (e, t) { var i = [e, 0, 0, t, 0, 0]; this.ctx._transform = this._matrix_multiply(this.ctx._transform, i) }, translate: function (e, t) { var i = [1, 0, 0, 1, e, t]; this.ctx._transform = this._matrix_multiply(this.ctx._transform, i) }, stroke: function () { if (0 < this.ctx._clip_path.length) { var e; (e = window.outIntercept ? "group" === window.outIntercept.type ? window.outIntercept.stream : window.outIntercept : this.internal.getCurrentPage()).push("q"); var t = this.path; this.path = this.ctx._clip_path, this.ctx._clip_path = [], this._stroke(!0), this.ctx._clip_path = this.path, this.path = t, this._stroke(!1), e.push("Q") } else this._stroke(!1) }, _stroke: function (e) { if (e || !this._isStrokeTransparent()) { for (var t = [], i = this.path, n = 0; n < i.length; n++) { var a = i[n]; switch (a.type) { case "mt": t.push({ start: a, deltas: [], abs: [] }); break; case "lt": var s = [a.x - i[n - 1].x, a.y - i[n - 1].y]; t[t.length - 1].deltas.push(s), t[t.length - 1].abs.push(a); break; case "bct": s = [a.x1 - i[n - 1].x, a.y1 - i[n - 1].y, a.x2 - i[n - 1].x, a.y2 - i[n - 1].y, a.x - i[n - 1].x, a.y - i[n - 1].y]; t[t.length - 1].deltas.push(s); break; case "qct": var r = i[n - 1].x + 2 / 3 * (a.x1 - i[n - 1].x), o = i[n - 1].y + 2 / 3 * (a.y1 - i[n - 1].y), l = a.x + 2 / 3 * (a.x1 - a.x), c = a.y + 2 / 3 * (a.y1 - a.y), d = a.x, u = a.y; s = [r - i[n - 1].x, o - i[n - 1].y, l - i[n - 1].x, c - i[n - 1].y, d - i[n - 1].x, u - i[n - 1].y]; t[t.length - 1].deltas.push(s); break; case "arc": 0 == t.length && t.push({ start: { x: 0, y: 0 }, deltas: [], abs: [] }), t[t.length - 1].arc = !0, Array.isArray(t[t.length - 1].abs) && t[t.length - 1].abs.push(a) } } for (n = 0; n < t.length; n++) { var h; if (h = n == t.length - 1 ? "s" : null, t[n].arc) for (var p = t[n].abs, f = 0; f < p.length; f++) { var m = p[f], g = 360 * m.startAngle / (2 * Math.PI), _ = 360 * m.endAngle / (2 * Math.PI), v = m.x, y = m.y; this.internal.arc2(this, v, y, m.radius, g, _, m.anticlockwise, h, e) } else { v = t[n].start.x, y = t[n].start.y; e ? (this.pdf.lines(t[n].deltas, v, y, null, null), this.pdf.clip_fixed()) : this.pdf.lines(t[n].deltas, v, y, null, h) } } } }, _isFillTransparent: function () { return this.ctx._isFillTransparent || 0 == this.globalAlpha }, _isStrokeTransparent: function () { return this.ctx._isStrokeTransparent || 0 == this.globalAlpha }, fill: function (e) { if (0 < this.ctx._clip_path.length) { var t; (t = window.outIntercept ? "group" === window.outIntercept.type ? window.outIntercept.stream : window.outIntercept : this.internal.getCurrentPage()).push("q"); var i = this.path; this.path = this.ctx._clip_path, this.ctx._clip_path = [], this._fill(e, !0), this.ctx._clip_path = this.path, this.path = i, this._fill(e, !1), t.push("Q") } else this._fill(e, !1) }, _fill: function (e, t) { if (!this._isFillTransparent()) { var i, n = "function" == typeof this.pdf.internal.newObject2; i = window.outIntercept ? "group" === window.outIntercept.type ? window.outIntercept.stream : window.outIntercept : this.internal.getCurrentPage(); var a = [], s = window.outIntercept; if (n) switch (this.ctx.globalCompositeOperation) { case "normal": case "source-over": break; case "destination-in": case "destination-out": var r = this.pdf.internal.newStreamObject(), o = this.pdf.internal.newObject2(); o.push("<</Type /ExtGState"), o.push("/SMask <</S /Alpha /G " + r.objId + " 0 R>>"), o.push(">>"); var l = "MASK" + o.objId; this.pdf.internal.addGraphicsState(l, o.objId); var c = "/" + l + " gs"; i.splice(0, 0, "q"), i.splice(1, 0, c), i.push("Q"), window.outIntercept = r; break; default: var d = "/" + this.pdf.internal.blendModeMap[this.ctx.globalCompositeOperation.toUpperCase()]; d && this.pdf.internal.out(d + " gs") }var u = this.ctx.globalAlpha; if (this.ctx._fillOpacity < 1 && (u = this.ctx._fillOpacity), n) { var h = this.pdf.internal.newObject2(); h.push("<</Type /ExtGState"), h.push("/CA " + u), h.push("/ca " + u), h.push(">>"); l = "GS_O_" + h.objId; this.pdf.internal.addGraphicsState(l, h.objId), this.pdf.internal.out("/" + l + " gs") } for (var p = this.path, f = 0; f < p.length; f++) { var m = p[f]; switch (m.type) { case "mt": a.push({ start: m, deltas: [], abs: [] }); break; case "lt": var g = [m.x - p[f - 1].x, m.y - p[f - 1].y]; a[a.length - 1].deltas.push(g), a[a.length - 1].abs.push(m); break; case "bct": g = [m.x1 - p[f - 1].x, m.y1 - p[f - 1].y, m.x2 - p[f - 1].x, m.y2 - p[f - 1].y, m.x - p[f - 1].x, m.y - p[f - 1].y]; a[a.length - 1].deltas.push(g); break; case "qct": var _ = p[f - 1].x + 2 / 3 * (m.x1 - p[f - 1].x), v = p[f - 1].y + 2 / 3 * (m.y1 - p[f - 1].y), y = m.x + 2 / 3 * (m.x1 - m.x), b = m.y + 2 / 3 * (m.y1 - m.y), w = m.x, C = m.y; g = [_ - p[f - 1].x, v - p[f - 1].y, y - p[f - 1].x, b - p[f - 1].y, w - p[f - 1].x, C - p[f - 1].y]; a[a.length - 1].deltas.push(g); break; case "arc": 0 === a.length && a.push({ deltas: [], abs: [] }), a[a.length - 1].arc = !0, Array.isArray(a[a.length - 1].abs) && a[a.length - 1].abs.push(m); break; case "close": a.push({ close: !0 }) } } for (f = 0; f < a.length; f++) { var x; if (f == a.length - 1 ? (x = "f", "evenodd" === e && (x += "*")) : x = null, a[f].close) this.pdf.internal.out("h"), x && this.pdf.internal.out(x); else if (a[f].arc) { a[f].start && this.internal.move2(this, a[f].start.x, a[f].start.y); for (var k = a[f].abs, T = 0; T < k.length; T++) { var S = k[T]; if (void 0 !== S.startAngle) { var $ = 360 * S.startAngle / (2 * Math.PI), A = 360 * S.endAngle / (2 * Math.PI), I = S.x, D = S.y; if (0 === T && this.internal.move2(this, I, D), this.internal.arc2(this, I, D, S.radius, $, A, S.anticlockwise, null, t), T === k.length - 1 && a[f].start) { I = a[f].start.x, D = a[f].start.y; this.internal.line2(P, I, D) } } else this.internal.line2(P, S.x, S.y) } } else { I = a[f].start.x, D = a[f].start.y; t ? (this.pdf.lines(a[f].deltas, I, D, null, null), this.pdf.clip_fixed()) : this.pdf.lines(a[f].deltas, I, D, null, x) } } window.outIntercept = s } }, pushMask: function () { if ("function" == typeof this.pdf.internal.newObject2) { var e = this.pdf.internal.newStreamObject(), t = this.pdf.internal.newObject2(); t.push("<</Type /ExtGState"), t.push("/SMask <</S /Alpha /G " + e.objId + " 0 R>>"), t.push(">>"); var i = "MASK" + t.objId; this.pdf.internal.addGraphicsState(i, t.objId); var n = "/" + i + " gs"; this.pdf.internal.out(n) } }, clip: function () { if (0 < this.ctx._clip_path.length) for (var e = 0; e < this.path.length; e++)this.ctx._clip_path.push(this.path[e]); else this.ctx._clip_path = this.path; this.path = [] }, measureText: function (i) { var n = this.pdf; return { getWidth: function () { var e = n.internal.getFontSize(), t = n.getStringUnitWidth(i) * e / n.internal.scaleFactor; return t *= 1.3333 }, get width() { return this.getWidth(i) } } }, _getBaseline: function (e) { var t = parseInt(this.pdf.internal.getFontSize()), i = .25 * t; switch (this.ctx.textBaseline) { case "bottom": return e - i; case "top": return e + t; case "hanging": return e + t - i; case "middle": return e + t / 2 - i; case "ideographic": return e; case "alphabetic": default: return e } } }; var P = e.context2d; function t() { this._isStrokeTransparent = !1, this._strokeOpacity = 1, this.strokeStyle = "#000000", this.fillStyle = "#000000", this._isFillTransparent = !1, this._fillOpacity = 1, this.font = "12pt times", this.textBaseline = "alphabetic", this.textAlign = "start", this.lineWidth = 1, this.lineJoin = "miter", this.lineCap = "butt", this._transform = [1, 0, 0, 1, 0, 0], this.globalCompositeOperation = "normal", this.globalAlpha = 1, this._clip_path = [], this.ignoreClearRect = !1, this.copy = function (e) { this._isStrokeTransparent = e._isStrokeTransparent, this._strokeOpacity = e._strokeOpacity, this.strokeStyle = e.strokeStyle, this._isFillTransparent = e._isFillTransparent, this._fillOpacity = e._fillOpacity, this.fillStyle = e.fillStyle, this.font = e.font, this.lineWidth = e.lineWidth, this.lineJoin = e.lineJoin, this.lineCap = e.lineCap, this.textBaseline = e.textBaseline, this.textAlign = e.textAlign, this._fontSize = e._fontSize, this._transform = e._transform.slice(0), this.globalCompositeOperation = e.globalCompositeOperation, this.globalAlpha = e.globalAlpha, this._clip_path = e._clip_path.slice(0), this.ignoreClearRect = e.ignoreClearRect } } Object.defineProperty(P, "fillStyle", { set: function (e) { this.setFillStyle(e) }, get: function () { return this.ctx.fillStyle } }), Object.defineProperty(P, "strokeStyle", { set: function (e) { this.setStrokeStyle(e) }, get: function () { return this.ctx.strokeStyle } }), Object.defineProperty(P, "lineWidth", { set: function (e) { this.setLineWidth(e) }, get: function () { return this.ctx.lineWidth } }), Object.defineProperty(P, "lineCap", { set: function (e) { this.setLineCap(e) }, get: function () { return this.ctx.lineCap } }), Object.defineProperty(P, "lineJoin", { set: function (e) { this.setLineJoin(e) }, get: function () { return this.ctx.lineJoin } }), Object.defineProperty(P, "miterLimit", { set: function (e) { this.ctx.miterLimit = e }, get: function () { return this.ctx.miterLimit } }), Object.defineProperty(P, "textBaseline", { set: function (e) { this.setTextBaseline(e) }, get: function () { return this.getTextBaseline() } }), Object.defineProperty(P, "textAlign", { set: function (e) { this.setTextAlign(e) }, get: function () { return this.getTextAlign() } }), Object.defineProperty(P, "font", { set: function (e) { this.setFont(e) }, get: function () { return this.ctx.font } }), Object.defineProperty(P, "globalCompositeOperation", { set: function (e) { this.ctx.globalCompositeOperation = e }, get: function () { return this.ctx.globalCompositeOperation } }), Object.defineProperty(P, "globalAlpha", { set: function (e) { this.ctx.globalAlpha = e }, get: function () { return this.ctx.globalAlpha } }), Object.defineProperty(P, "canvas", { get: function () { return { parentNode: !1, style: !1 } } }), Object.defineProperty(P, "ignoreClearRect", { set: function (e) { this.ctx.ignoreClearRect = e }, get: function () { return this.ctx.ignoreClearRect } }), P.internal = {}, P.internal.rxRgb = /rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/, P.internal.rxRgba = /rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d\.]+)\s*\)/, P.internal.rxTransparent = /transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/, P.internal.arc = function (e, t, i, n, a, s, r, o) { for (var l = this.pdf.internal.scaleFactor, c = this.pdf.internal.pageSize.getHeight(), d = this.pdf.internal.f2, u = a * (Math.PI / 180), h = s * (Math.PI / 180), p = this.createArc(n, u, h, r), f = 0; f < p.length; f++) { var m = p[f]; 0 === f ? this.pdf.internal.out([d((m.x1 + t) * l), d((c - (m.y1 + i)) * l), "m", d((m.x2 + t) * l), d((c - (m.y2 + i)) * l), d((m.x3 + t) * l), d((c - (m.y3 + i)) * l), d((m.x4 + t) * l), d((c - (m.y4 + i)) * l), "c"].join(" ")) : this.pdf.internal.out([d((m.x2 + t) * l), d((c - (m.y2 + i)) * l), d((m.x3 + t) * l), d((c - (m.y3 + i)) * l), d((m.x4 + t) * l), d((c - (m.y4 + i)) * l), "c"].join(" ")), e._lastPoint = { x: t, y: i } } null !== o && this.pdf.internal.out(this.pdf.internal.getStyle(o)) }, P.internal.arc2 = function (e, t, i, n, a, s, r, o, l) { var c = t, d = i; l ? (this.arc(e, c, d, n, a, s, r, null), this.pdf.clip_fixed()) : this.arc(e, c, d, n, a, s, r, o) }, P.internal.move2 = function (e, t, i) { var n = this.pdf.internal.scaleFactor, a = this.pdf.internal.pageSize.getHeight(), s = this.pdf.internal.f2; this.pdf.internal.out([s(t * n), s((a - i) * n), "m"].join(" ")), e._lastPoint = { x: t, y: i } }, P.internal.line2 = function (e, t, i) { var n = this.pdf.internal.scaleFactor, a = this.pdf.internal.pageSize.getHeight(), s = this.pdf.internal.f2, r = { x: t, y: i }; this.pdf.internal.out([s(r.x * n), s((a - r.y) * n), "l"].join(" ")), e._lastPoint = r }, P.internal.createArc = function (e, t, i, n) { var a = 2 * Math.PI, s = Math.PI / 2, r = t; for ((r < a || a < r) && (r %= a), r < 0 && (r = a + r); i < t;)t -= a; var o = Math.abs(i - t); o < a && n && (o = a - o); for (var l = [], c = n ? -1 : 1, d = r; 1e-5 < o;) { var u = d + c * Math.min(o, s); l.push(this.createSmallArc(e, d, u)), o -= Math.abs(u - d), d = u } return l }, P.internal.getCurrentPage = function () { return this.pdf.internal.pages[this.pdf.internal.getCurrentPageInfo().pageNumber] }, P.internal.createSmallArc = function (e, t, i) { var n = (i - t) / 2, a = e * Math.cos(n), s = e * Math.sin(n), r = a, o = -s, l = r * r + o * o, c = l + r * a + o * s, d = 4 / 3 * (Math.sqrt(2 * l * c) - c) / (r * s - o * a), u = r - d * o, h = o + d * r, p = u, f = -h, m = n + t, g = Math.cos(m), _ = Math.sin(m); return { x1: e * Math.cos(t), y1: e * Math.sin(t), x2: u * g - h * _, y2: u * _ + h * g, x3: p * g - f * _, y3: p * _ + f * g, x4: e * Math.cos(i), y4: e * Math.sin(i) } } }(Z.API, "undefined" != typeof self && self || "undefined" != typeof window && window || "undefined" != typeof global && global || Function('return typeof this === "object" && this.content')() || Function("return this")()), function (e) { var A, I, a, r, o, l, c, d, D, y, h, u, p, i, P, j, f, m, g, L; A = function () { return function (e) { return t.prototype = e, new t }; function t() { } }(), y = function (e) { var t, i, n, a, s, r, o; for (i = 0, n = e.length, t = void 0, r = a = !1; !a && i !== n;)(t = e[i] = e[i].trimLeft()) && (a = !0), i++; for (i = n - 1; n && !r && -1 !== i;)(t = e[i] = e[i].trimRight()) && (r = !0), i--; for (s = /\s+$/g, o = !0, i = 0; i !== n;)"\u2028" != e[i] && (t = e[i].replace(/\s+/g, " "), o && (t = t.trimLeft()), t && (o = s.test(t)), e[i] = t), i++; return e }, u = function (e) { var t, i, n; for (t = void 0, i = (n = e.split(",")).shift(); !t && i;)t = a[i.trim().toLowerCase()], i = n.shift(); return t }, p = function (e) { var t; return -1 < (e = "auto" === e ? "0px" : e).indexOf("em") && !isNaN(Number(e.replace("em", ""))) && (e = 18.719 * Number(e.replace("em", "")) + "px"), -1 < e.indexOf("pt") && !isNaN(Number(e.replace("pt", ""))) && (e = 1.333 * Number(e.replace("pt", "")) + "px"), void 0, 16, (t = i[e]) ? t : void 0 !== (t = { "xx-small": 9, "x-small": 11, small: 13, medium: 16, large: 19, "x-large": 23, "xx-large": 28, auto: 0 }[e]) ? i[e] = t / 16 : (t = parseFloat(e)) ? i[e] = t / 16 : (t = e.match(/([\d\.]+)(px)/), Array.isArray(t) && 3 === t.length ? i[e] = parseFloat(t[1]) / 16 : i[e] = 1) }, D = function (e) { var t, i, n, a, s; return s = e, a = document.defaultView && document.defaultView.getComputedStyle ? document.defaultView.getComputedStyle(s, null) : s.currentStyle ? s.currentStyle : s.style, i = void 0, (t = {})["font-family"] = u((n = function (e) { return e = e.replace(/-\D/g, function (e) { return e.charAt(1).toUpperCase() }), a[e] })("font-family")) || "times", t["font-style"] = r[n("font-style")] || "normal", t["text-align"] = o[n("text-align")] || "left", "bold" === (i = l[n("font-weight")] || "normal") && ("normal" === t["font-style"] ? t["font-style"] = i : t["font-style"] = i + t["font-style"]), t["font-size"] = p(n("font-size")) || 1, t["line-height"] = p(n("line-height")) || 1, t.display = "inline" === n("display") ? "inline" : "block", i = "block" === t.display, t["margin-top"] = i && p(n("margin-top")) || 0, t["margin-bottom"] = i && p(n("margin-bottom")) || 0, t["padding-top"] = i && p(n("padding-top")) || 0, t["padding-bottom"] = i && p(n("padding-bottom")) || 0, t["margin-left"] = i && p(n("margin-left")) || 0, t["margin-right"] = i && p(n("margin-right")) || 0, t["padding-left"] = i && p(n("padding-left")) || 0, t["padding-right"] = i && p(n("padding-right")) || 0, t["page-break-before"] = n("page-break-before") || "auto", t.float = c[n("cssFloat")] || "none", t.clear = d[n("clear")] || "none", t.color = n("color"), t }, P = function (e, t, i) { var n, a, s, r, o; if (s = !1, r = a = void 0, n = i["#" + e.id]) if ("function" == typeof n) s = n(e, t); else for (a = 0, r = n.length; !s && a !== r;)s = n[a](e, t), a++; if (n = i[e.nodeName], !s && n) if ("function" == typeof n) s = n(e, t); else for (a = 0, r = n.length; !s && a !== r;)s = n[a](e, t), a++; for (o = "string" == typeof e.className ? e.className.split(" ") : [], a = 0; a < o.length; a++)if (n = i["." + o[a]], !s && n) if ("function" == typeof n) s = n(e, t); else for (a = 0, r = n.length; !s && a !== r;)s = n[a](e, t), a++; return s }, L = function (e, t) { var i, n, a, s, r, o, l, c, d; for (i = [], n = [], a = 0, d = e.rows[0].cells.length, l = e.clientWidth; a < d;)c = e.rows[0].cells[a], n[a] = { name: c.textContent.toLowerCase().replace(/\s+/g, ""), prompt: c.textContent.replace(/\r?\n/g, ""), width: c.clientWidth / l * t.pdf.internal.pageSize.getWidth() }, a++; for (a = 1; a < e.rows.length;) { for (o = e.rows[a], r = {}, s = 0; s < o.cells.length;)r[n[s].name] = o.cells[s].textContent.replace(/\r?\n/g, ""), s++; i.push(r), a++ } return { rows: i, headers: n } }; var M = { SCRIPT: 1, STYLE: 1, NOSCRIPT: 1, OBJECT: 1, EMBED: 1, SELECT: 1 }, R = 1; I = function (e, a, t) { var i, n, s, r, o, l, c, d; for (n = e.childNodes, i = void 0, (o = "block" === (s = D(e)).display) && (a.setBlockBoundary(), a.setBlockStyle(s)), r = 0, l = n.length; r < l;) { if ("object" === (void 0 === (i = n[r]) ? "undefined" : ye(i))) { if (a.executeWatchFunctions(i), 1 === i.nodeType && "HEADER" === i.nodeName) { var u = i, h = a.pdf.margins_doc.top; a.pdf.internal.events.subscribe("addPage", function (e) { a.y = h, I(u, a, t), a.pdf.margins_doc.top = a.y + 10, a.y += 10 }, !1) } if (8 === i.nodeType && "#comment" === i.nodeName) ~i.textContent.indexOf("ADD_PAGE") && (a.pdf.addPage(), a.y = a.pdf.margins_doc.top); else if (1 !== i.nodeType || M[i.nodeName]) if (3 === i.nodeType) { var p = i.nodeValue; if (i.nodeValue && "LI" === i.parentNode.nodeName) if ("OL" === i.parentNode.parentNode.nodeName) p = R++ + ". " + p; else { var f = s["font-size"], m = (3 - .75 * f) * a.pdf.internal.scaleFactor, g = .75 * f * a.pdf.internal.scaleFactor, _ = 1.74 * f / a.pdf.internal.scaleFactor; d = function (e, t) { this.pdf.circle(e + m, t + g, _, "FD") } } 16 & i.ownerDocument.body.compareDocumentPosition(i) && a.addText(p, s) } else "string" == typeof i && a.addText(i, s); else { var v; if ("IMG" === i.nodeName) { var y = i.getAttribute("src"); v = j[a.pdf.sHashCode(y) || y] } if (v) { a.pdf.internal.pageSize.getHeight() - a.pdf.margins_doc.bottom < a.y + i.height && a.y > a.pdf.margins_doc.top && (a.pdf.addPage(), a.y = a.pdf.margins_doc.top, a.executeWatchFunctions(i)); var b = D(i), w = a.x, C = 12 / a.pdf.internal.scaleFactor, x = (b["margin-left"] + b["padding-left"]) * C, k = (b["margin-right"] + b["padding-right"]) * C, T = (b["margin-top"] + b["padding-top"]) * C, S = (b["margin-bottom"] + b["padding-bottom"]) * C; void 0 !== b.float && "right" === b.float ? w += a.settings.width - i.width - k : w += x, a.pdf.addImage(v, w, a.y + T, i.width, i.height), v = void 0, "right" === b.float || "left" === b.float ? (a.watchFunctions.push(function (e, t, i, n) { return a.y >= t ? (a.x += e, a.settings.width += i, !0) : !!(n && 1 === n.nodeType && !M[n.nodeName] && a.x + n.width > a.pdf.margins_doc.left + a.pdf.margins_doc.width) && (a.x += e, a.y = t, a.settings.width += i, !0) }.bind(this, "left" === b.float ? -i.width - x - k : 0, a.y + i.height + T + S, i.width)), a.watchFunctions.push(function (e, t, i) { return !(a.y < e && t === a.pdf.internal.getNumberOfPages()) || 1 === i.nodeType && "both" === D(i).clear && (a.y = e, !0) }.bind(this, a.y + i.height, a.pdf.internal.getNumberOfPages())), a.settings.width -= i.width + x + k, "left" === b.float && (a.x += i.width + x + k)) : a.y += i.height + T + S } else if ("TABLE" === i.nodeName) c = L(i, a), a.y += 10, a.pdf.table(a.x, a.y, c.rows, c.headers, { autoSize: !1, printHeaders: t.printHeaders, margins: a.pdf.margins_doc, css: D(i) }), a.y = a.pdf.lastCellPos.y + a.pdf.lastCellPos.h + 20; else if ("OL" === i.nodeName || "UL" === i.nodeName) R = 1, P(i, a, t) || I(i, a, t), a.y += 10; else if ("LI" === i.nodeName) { var $ = a.x; a.x += 20 / a.pdf.internal.scaleFactor, a.y += 3, P(i, a, t) || I(i, a, t), a.x = $ } else "BR" === i.nodeName ? (a.y += s["font-size"] * a.pdf.internal.scaleFactor, a.addText("\u2028", A(s))) : P(i, a, t) || I(i, a, t) } } r++ } if (t.outY = a.y, o) return a.setBlockBoundary(d) }, j = {}, f = function (e, s, t, i) { var r, n = e.getElementsByTagName("img"), a = n.length, o = 0; function l() { s.pdf.internal.events.publish("imagesLoaded"), i(r) } function c(t, i, n) { if (t) { var a = new Image; r = ++o, a.crossOrigin = "", a.onerror = a.onload = function () { if (a.complete && (0 === a.src.indexOf("data:image/") && (a.width = i || a.width || 0, a.height = n || a.height || 0), a.width + a.height)) { var e = s.pdf.sHashCode(t) || t; j[e] = j[e] || a } --o || l() }, a.src = t } } for (; a--;)c(n[a].getAttribute("src"), n[a].width, n[a].height); return o || l() }, m = function (e, s, r) { var o = e.getElementsByTagName("footer"); if (0 < o.length) { o = o[0]; var t = s.pdf.internal.write, i = s.y; s.pdf.internal.write = function () { }, I(o, s, r); var l = Math.ceil(s.y - i) + 5; s.y = i, s.pdf.internal.write = t, s.pdf.margins_doc.bottom += l; for (var n = function (e) { var t = void 0 !== e ? e.pageNumber : 1, i = s.y; s.y = s.pdf.internal.pageSize.getHeight() - s.pdf.margins_doc.bottom, s.pdf.margins_doc.bottom -= l; for (var n = o.getElementsByTagName("span"), a = 0; a < n.length; ++a)-1 < (" " + n[a].className + " ").replace(/[\n\t]/g, " ").indexOf(" pageCounter ") && (n[a].innerHTML = t), -1 < (" " + n[a].className + " ").replace(/[\n\t]/g, " ").indexOf(" totalPages ") && (n[a].innerHTML = "###jsPDFVarTotalPages###"); I(o, s, r), s.pdf.margins_doc.bottom += l, s.y = i }, a = o.getElementsByTagName("span"), c = 0; c < a.length; ++c)-1 < (" " + a[c].className + " ").replace(/[\n\t]/g, " ").indexOf(" totalPages ") && s.pdf.internal.events.subscribe("htmlRenderingFinished", s.pdf.putTotalPages.bind(s.pdf, "###jsPDFVarTotalPages###"), !0); s.pdf.internal.events.subscribe("addPage", n, !1), n(), M.FOOTER = 1 } }, g = function (e, t, i, n, a, s) { if (!t) return !1; var r, o, l, c; "string" == typeof t || t.parentNode || (t = "" + t.innerHTML), "string" == typeof t && (r = t.replace(/<\/?script[^>]*?>/gi, ""), c = "jsPDFhtmlText" + Date.now().toString() + (1e3 * Math.random()).toFixed(0), (l = document.createElement("div")).style.cssText = "position: absolute !important;clip: rect(1px 1px 1px 1px); /* IE6, IE7 */clip: rect(1px, 1px, 1px, 1px);padding:0 !important;border:0 !important;height: 1px !important;width: 1px !important; top:auto;left:-100px;overflow: hidden;", l.innerHTML = '<iframe style="height:1px;width:1px" name="' + c + '" />', document.body.appendChild(l), (o = window.frames[c]).document.open(), o.document.writeln(r), o.document.close(), t = o.document.body); var d, u = new h(e, i, n, a); return f.call(this, t, u, a.elementHandlers, function (e) { m(t, u, a.elementHandlers), I(t, u, a.elementHandlers), u.pdf.internal.events.publish("htmlRenderingFinished"), d = u.dispose(), "function" == typeof s && s(d) }), d || { x: u.x, y: u.y } }, (h = function (e, t, i, n) { return this.pdf = e, this.x = t, this.y = i, this.settings = n, this.watchFunctions = [], this.init(), this }).prototype.init = function () { return this.paragraph = { text: [], style: [] }, this.pdf.internal.write("q") }, h.prototype.dispose = function () { return this.pdf.internal.write("Q"), { x: this.x, y: this.y, ready: !0 } }, h.prototype.executeWatchFunctions = function (e) { var t = !1, i = []; if (0 < this.watchFunctions.length) { for (var n = 0; n < this.watchFunctions.length; ++n)!0 === this.watchFunctions[n](e) ? t = !0 : i.push(this.watchFunctions[n]); this.watchFunctions = i } return t }, h.prototype.splitFragmentsIntoLines = function (e, t) { var i, n, a, s, r, o, l, c, d, u, h, p, f, m; for (12, u = this.pdf.internal.scaleFactor, s = {}, o = l = c = m = r = a = d = n = void 0, p = [h = []], i = 0, f = this.settings.width; e.length;)if (r = e.shift(), m = t.shift(), r) if ((a = s[(n = m["font-family"]) + (d = m["font-style"])]) || (a = this.pdf.internal.getFont(n, d).metadata.Unicode, s[n + d] = a), c = { widths: a.widths, kerning: a.kerning, fontSize: 12 * m["font-size"], textIndent: i }, l = this.pdf.getStringUnitWidth(r, c) * c.fontSize / u, "\u2028" == r) h = [], p.push(h); else if (f < i + l) { for (o = this.pdf.splitTextToSize(r, f, c), h.push([o.shift(), m]); o.length;)h = [[o.shift(), m]], p.push(h); i = this.pdf.getStringUnitWidth(h[0][0], c) * c.fontSize / u } else h.push([r, m]), i += l; if (void 0 !== m["text-align"] && ("center" === m["text-align"] || "right" === m["text-align"] || "justify" === m["text-align"])) for (var g = 0; g < p.length; ++g) { var _ = this.pdf.getStringUnitWidth(p[g][0][0], c) * c.fontSize / u; 0 < g && (p[g][0][1] = A(p[g][0][1])); var v = f - _; if ("right" === m["text-align"]) p[g][0][1]["margin-left"] = v; else if ("center" === m["text-align"]) p[g][0][1]["margin-left"] = v / 2; else if ("justify" === m["text-align"]) { var y = p[g][0][0].split(" ").length - 1; p[g][0][1]["word-spacing"] = v / y, g === p.length - 1 && (p[g][0][1]["word-spacing"] = 0) } } return p }, h.prototype.RenderTextFragment = function (e, t) { var i, n; n = 0, this.pdf.internal.pageSize.getHeight() - this.pdf.margins_doc.bottom < this.y + this.pdf.internal.getFontSize() && (this.pdf.internal.write("ET", "Q"), this.pdf.addPage(), this.y = this.pdf.margins_doc.top, this.pdf.internal.write("q", "BT", this.getPdfColor(t.color), this.pdf.internal.getCoordinateString(this.x), this.pdf.internal.getVerticalCoordinateString(this.y), "Td"), n = Math.max(n, t["line-height"], t["font-size"]), this.pdf.internal.write(0, (-12 * n).toFixed(2), "Td")), i = this.pdf.internal.getFont(t["font-family"], t["font-style"]); var a = this.getPdfColor(t.color); a !== this.lastTextColor && (this.pdf.internal.write(a), this.lastTextColor = a), void 0 !== t["word-spacing"] && 0 < t["word-spacing"] && this.pdf.internal.write(t["word-spacing"].toFixed(2), "Tw"), this.pdf.internal.write("/" + i.id, (12 * t["font-size"]).toFixed(2), "Tf", "(" + this.pdf.internal.pdfEscape(e) + ") Tj"), void 0 !== t["word-spacing"] && this.pdf.internal.write(0, "Tw") }, h.prototype.getPdfColor = function (e) { var t, i, n, a = new RGBColor(e), s = /rgb\s*\(\s*(\d+),\s*(\d+),\s*(\d+\s*)\)/.exec(e); if (null != s ? (t = parseInt(s[1]), i = parseInt(s[2]), n = parseInt(s[3])) : ("#" != e.charAt(0) && (e = a.ok ? a.toHex() : "#000000"), t = e.substring(1, 3), t = parseInt(t, 16), i = e.substring(3, 5), i = parseInt(i, 16), n = e.substring(5, 7), n = parseInt(n, 16)), "string" == typeof t && /^#[0-9A-Fa-f]{6}$/.test(t)) { var r = parseInt(t.substr(1), 16); t = r >> 16 & 255, i = r >> 8 & 255, n = 255 & r } var o = this.f3; return 0 === t && 0 === i && 0 === n || void 0 === i ? o(t / 255) + " g" : [o(t / 255), o(i / 255), o(n / 255), "rg"].join(" ") }, h.prototype.f3 = function (e) { return e.toFixed(3) }, h.prototype.renderParagraph = function (e) { var t, i, n, a, s, r, o, l, c, d, u, h, p; if (n = y(this.paragraph.text), h = this.paragraph.style, t = this.paragraph.blockstyle, this.paragraph.priorblockstyle || {}, this.paragraph = { text: [], style: [], blockstyle: {}, priorblockstyle: t }, n.join("").trim()) { o = this.splitFragmentsIntoLines(n, h), l = r = void 0, i = 12 / this.pdf.internal.scaleFactor, this.priorMarginBottom = this.priorMarginBottom || 0, u = (Math.max((t["margin-top"] || 0) - this.priorMarginBottom, 0) + (t["padding-top"] || 0)) * i, d = ((t["margin-bottom"] || 0) + (t["padding-bottom"] || 0)) * i, this.priorMarginBottom = t["margin-bottom"] || 0, "always" === t["page-break-before"] && (this.pdf.addPage(), this.y = 0, u = ((t["margin-top"] || 0) + (t["padding-top"] || 0)) * i), c = this.pdf.internal.write, s = a = void 0, this.y += u, c("q", "BT 0 g", this.pdf.internal.getCoordinateString(this.x), this.pdf.internal.getVerticalCoordinateString(this.y), "Td"); for (var f = 0; o.length;) { for (a = l = 0, s = (r = o.shift()).length; a !== s;)r[a][0].trim() && (l = Math.max(l, r[a][1]["line-height"], r[a][1]["font-size"]), p = 7 * r[a][1]["font-size"]), a++; var m = 0, g = 0; for (void 0 !== r[0][1]["margin-left"] && 0 < r[0][1]["margin-left"] && (m = (g = this.pdf.internal.getCoordinateString(r[0][1]["margin-left"])) - f, f = g), c(m + Math.max(t["margin-left"] || 0, 0) * i, (-12 * l).toFixed(2), "Td"), a = 0, s = r.length; a !== s;)r[a][0] && this.RenderTextFragment(r[a][0], r[a][1]), a++; if (this.y += l * i, this.executeWatchFunctions(r[0][1]) && 0 < o.length) { var _ = [], v = []; o.forEach(function (e) { for (var t = 0, i = e.length; t !== i;)e[t][0] && (_.push(e[t][0] + " "), v.push(e[t][1])), ++t }), o = this.splitFragmentsIntoLines(y(_), v), c("ET", "Q"), c("q", "BT 0 g", this.pdf.internal.getCoordinateString(this.x), this.pdf.internal.getVerticalCoordinateString(this.y), "Td") } } return e && "function" == typeof e && e.call(this, this.x - 9, this.y - p / 2), c("ET", "Q"), this.y += d } }, h.prototype.setBlockBoundary = function (e) { return this.renderParagraph(e) }, h.prototype.setBlockStyle = function (e) { return this.paragraph.blockstyle = e }, h.prototype.addText = function (e, t) { return this.paragraph.text.push(e), this.paragraph.style.push(t) }, a = { helvetica: "helvetica", "sans-serif": "helvetica", "times new roman": "times", serif: "times", times: "times", monospace: "courier", courier: "courier" }, l = { 100: "normal", 200: "normal", 300: "normal", 400: "normal", 500: "bold", 600: "bold", 700: "bold", 800: "bold", 900: "bold", normal: "normal", bold: "bold", bolder: "bold", lighter: "normal" }, r = { normal: "normal", italic: "italic", oblique: "italic" }, o = { left: "left", right: "right", center: "center", justify: "justify" }, c = { none: "none", right: "right", left: "left" }, d = { none: "none", both: "both" }, i = { normal: 1 }, e.fromHTML = function (e, t, i, n, a, s) { return this.margins_doc = s || { top: 0, bottom: 0 }, n || (n = {}), n.elementHandlers || (n.elementHandlers = {}), g(this, e, isNaN(t) ? 4 : t, isNaN(i) ? 4 : i, n, a) } }(Z.API), Z.API.addJS = function (e) { return o = e, this.internal.events.subscribe("postPutResources", function (e) { i = this.internal.newObject(), this.internal.out("<<"), this.internal.out("/Names [(EmbeddedJS) " + (i + 1) + " 0 R]"), this.internal.out(">>"), this.internal.out("endobj"), n = this.internal.newObject(), this.internal.out("<<"), this.internal.out("/S /JavaScript"), this.internal.out("/JS (" + o + ")"), this.internal.out(">>"), this.internal.out("endobj") }), this.internal.events.subscribe("putCatalog", function () { void 0 !== i && void 0 !== n && this.internal.out("/Names <</JavaScript " + i + " 0 R>>") }), this }, (c = Z.API).events.push(["postPutResources", function () { var e = this, t = /^(\d+) 0 obj$/; if (0 < this.outline.root.children.length) for (var i = e.outline.render().split(/\r\n/), n = 0; n < i.length; n++) { var a = i[n], s = t.exec(a); if (null != s) { var r = s[1]; e.internal.newObjectDeferredBegin(r) } e.internal.write(a) } if (this.outline.createNamedDestinations) { var o = this.internal.pages.length, l = []; for (n = 0; n < o; n++) { var c = e.internal.newObject(); l.push(c); var d = e.internal.getPageInfo(n + 1); e.internal.write("<< /D[" + d.objId + " 0 R /XYZ null null null]>> endobj") } var u = e.internal.newObject(); for (e.internal.write("<< /Names [ "), n = 0; n < l.length; n++)e.internal.write("(page_" + (n + 1) + ")" + l[n] + " 0 R"); e.internal.write(" ] >>", "endobj"), e.internal.newObject(), e.internal.write("<< /Dests " + u + " 0 R"), e.internal.write(">>", "endobj") } }]), c.events.push(["putCatalog", function () { 0 < this.outline.root.children.length && (this.internal.write("/Outlines", this.outline.makeRef(this.outline.root)), this.outline.createNamedDestinations && this.internal.write("/Names " + namesOid + " 0 R")) }]), c.events.push(["initialized", function () { var s = this; s.outline = { createNamedDestinations: !1, root: { children: [] } }, s.outline.add = function (e, t, i) { var n = { title: t, options: i, children: [] }; return null == e && (e = this.root), e.children.push(n), n }, s.outline.render = function () { return this.ctx = {}, this.ctx.val = "", this.ctx.pdf = s, this.genIds_r(this.root), this.renderRoot(this.root), this.renderItems(this.root), this.ctx.val }, s.outline.genIds_r = function (e) { e.id = s.internal.newObjectDeferred(); for (var t = 0; t < e.children.length; t++)this.genIds_r(e.children[t]) }, s.outline.renderRoot = function (e) { this.objStart(e), this.line("/Type /Outlines"), 0 < e.children.length && (this.line("/First " + this.makeRef(e.children[0])), this.line("/Last " + this.makeRef(e.children[e.children.length - 1]))), this.line("/Count " + this.count_r({ count: 0 }, e)), this.objEnd() }, s.outline.renderItems = function (e) { for (var t = 0; t < e.children.length; t++) { var i = e.children[t]; this.objStart(i), this.line("/Title " + this.makeString(i.title)), this.line("/Parent " + this.makeRef(e)), 0 < t && this.line("/Prev " + this.makeRef(e.children[t - 1])), t < e.children.length - 1 && this.line("/Next " + this.makeRef(e.children[t + 1])), 0 < i.children.length && (this.line("/First " + this.makeRef(i.children[0])), this.line("/Last " + this.makeRef(i.children[i.children.length - 1]))); var n = this.count = this.count_r({ count: 0 }, i); if (0 < n && this.line("/Count " + n), i.options && i.options.pageNumber) { var a = s.internal.getPageInfo(i.options.pageNumber); this.line("/Dest [" + a.objId + " 0 R /XYZ 0 " + this.ctx.pdf.internal.pageSize.getHeight() * this.ctx.pdf.internal.scaleFactor + " 0]") } this.objEnd() } for (t = 0; t < e.children.length; t++)i = e.children[t], this.renderItems(i) }, s.outline.line = function (e) { this.ctx.val += e + "\r\n" }, s.outline.makeRef = function (e) { return e.id + " 0 R" }, s.outline.makeString = function (e) { return "(" + s.internal.pdfEscape(e) + ")" }, s.outline.objStart = function (e) { this.ctx.val += "\r\n" + e.id + " 0 obj\r\n<<\r\n" }, s.outline.objEnd = function (e) { this.ctx.val += ">> \r\nendobj\r\n" }, s.outline.count_r = function (e, t) { for (var i = 0; i < t.children.length; i++)e.count++ , this.count_r(e, t.children[i]); return e.count } }]), D = Z.API, P = function () { var e = "function" == typeof Deflater; if (!e) throw new Error("requires deflate.js for compression"); return e }, j = function (e, t, i, n) { var a = 5, s = b; switch (n) { case D.image_compression.FAST: a = 3, s = y; break; case D.image_compression.MEDIUM: a = 6, s = w; break; case D.image_compression.SLOW: a = 9, s = C }e = _(e, t, i, s); var r = new Uint8Array(m(a)), o = g(e), l = new Deflater(a), c = l.append(e), d = l.flush(), u = r.length + c.length + d.length, h = new Uint8Array(u + 4); return h.set(r), h.set(c, r.length), h.set(d, r.length + c.length), h[u++] = o >>> 24 & 255, h[u++] = o >>> 16 & 255, h[u++] = o >>> 8 & 255, h[u++] = 255 & o, D.arrayBufferToBinaryString(h) }, m = function (e, t) { var i = Math.LOG2E * Math.log(32768) - 8 << 4 | 8, n = i << 8; return n |= Math.min(3, (t - 1 & 255) >> 1) << 6, n |= 0, [i, 255 & (n += 31 - n % 31)] }, g = function (e, t) { for (var i, n = 1, a = 0, s = e.length, r = 0; 0 < s;) { for (s -= i = t < s ? t : s; a += n += e[r++], --i;); n %= 65521, a %= 65521 } return (a << 16 | n) >>> 0 }, _ = function (e, t, i, n) { for (var a, s, r, o = e.length / t, l = new Uint8Array(e.length + o), c = x(), d = 0; d < o; d++) { if (r = d * t, a = e.subarray(r, r + t), n) l.set(n(a, i, s), r + d); else { for (var u = 0, h = c.length, p = []; u < h; u++)p[u] = c[u](a, i, s); var f = k(p.concat()); l.set(p[f], r + d) } s = a } return l }, d = function (e, t, i) { var n = Array.apply([], e); return n.unshift(0), n }, y = function (e, t, i) { var n, a = [], s = 0, r = e.length; for (a[0] = 1; s < r; s++)n = e[s - t] || 0, a[s + 1] = e[s] - n + 256 & 255; return a }, b = function (e, t, i) { var n, a = [], s = 0, r = e.length; for (a[0] = 2; s < r; s++)n = i && i[s] || 0, a[s + 1] = e[s] - n + 256 & 255; return a }, w = function (e, t, i) { var n, a, s = [], r = 0, o = e.length; for (s[0] = 3; r < o; r++)n = e[r - t] || 0, a = i && i[r] || 0, s[r + 1] = e[r] + 256 - (n + a >>> 1) & 255; return s }, C = function (e, t, i) { var n, a, s, r, o = [], l = 0, c = e.length; for (o[0] = 4; l < c; l++)n = e[l - t] || 0, a = i && i[l] || 0, s = i && i[l - t] || 0, r = u(n, a, s), o[l + 1] = e[l] - r + 256 & 255; return o }, u = function (e, t, i) { var n = e + t - i, a = Math.abs(n - e), s = Math.abs(n - t), r = Math.abs(n - i); return a <= s && a <= r ? e : s <= r ? t : i }, x = function () { return [d, y, b, w, C] }, k = function (e) { for (var t, i, n, a = 0, s = e.length; a < s;)((t = h(e[a].slice(1))) < i || !i) && (i = t, n = a), a++; return n }, h = function (e) { for (var t = 0, i = e.length, n = 0; t < i;)n += Math.abs(e[t++]); return n }, D.processPNG = function (e, t, i, n, a) { var s, r, o, l, c, d, u = this.color_spaces.DEVICE_RGB, h = this.decode.FLATE_DECODE, p = 8; if (this.isArrayBuffer(e) && (e = new Uint8Array(e)), this.isArrayBufferView(e)) { if ("function" != typeof PNG || "function" != typeof ke) throw new Error("PNG support requires png.js and zlib.js"); if (e = (s = new PNG(e)).imgData, p = s.bits, u = s.colorSpace, l = s.colors, -1 !== [4, 6].indexOf(s.colorType)) { if (8 === s.bits) for (var f, m = (S = 32 == s.pixelBitlength ? new Uint32Array(s.decodePixels().buffer) : 16 == s.pixelBitlength ? new Uint16Array(s.decodePixels().buffer) : new Uint8Array(s.decodePixels().buffer)).length, g = new Uint8Array(m * s.colors), _ = new Uint8Array(m), v = s.pixelBitlength - s.bits, y = 0, b = 0; y < m; y++) { for (w = S[y], f = 0; f < v;)g[b++] = w >>> f & 255, f += s.bits; _[y] = w >>> f & 255 } if (16 === s.bits) { m = (S = new Uint32Array(s.decodePixels().buffer)).length, g = new Uint8Array(m * (32 / s.pixelBitlength) * s.colors), _ = new Uint8Array(m * (32 / s.pixelBitlength)); for (var w, C = 1 < s.colors, x = b = y = 0; y < m;)w = S[y++], g[b++] = w >>> 0 & 255, C && (g[b++] = w >>> 16 & 255, w = S[y++], g[b++] = w >>> 0 & 255), _[x++] = w >>> 16 & 255; p = 8 } n !== D.image_compression.NONE && P() ? (e = j(g, s.width * s.colors, s.colors, n), d = j(_, s.width, 1, n)) : (e = g, d = _, h = null) } if (3 === s.colorType && (u = this.color_spaces.INDEXED, c = s.palette, s.transparency.indexed)) { var k = s.transparency.indexed, T = 0; for (y = 0, m = k.length; y < m; ++y)T += k[y]; if ((T /= 255) == m - 1 && -1 !== k.indexOf(0)) o = [k.indexOf(0)]; else if (T !== m) { var S = s.decodePixels(); for (_ = new Uint8Array(S.length), y = 0, m = S.length; y < m; y++)_[y] = k[S[y]]; d = j(_, s.width, 1) } } var $ = function (e) { var t; switch (e) { case D.image_compression.FAST: t = 11; break; case D.image_compression.MEDIUM: t = 13; break; case D.image_compression.SLOW: t = 14; break; default: t = 12 }return t }(n); return r = h === this.decode.FLATE_DECODE ? "/Predictor " + $ + " /Colors " + l + " /BitsPerComponent " + p + " /Columns " + s.width : "/Colors " + l + " /BitsPerComponent " + p + " /Columns " + s.width, (this.isArrayBuffer(e) || this.isArrayBufferView(e)) && (e = this.arrayBufferToBinaryString(e)), (d && this.isArrayBuffer(d) || this.isArrayBufferView(d)) && (d = this.arrayBufferToBinaryString(d)), this.createImageInfo(e, s.width, s.height, u, p, h, t, i, r, o, c, d, $) } throw new Error("Unsupported PNG image data, try using JPEG instead.") }, (T = Z.API).processGIF89A = function (e, t, i, n, a) { var s = new _e(e), r = s.width, o = s.height, l = []; s.decodeAndBlitFrameRGBA(0, l); var c = { data: l, width: r, height: o }, d = new we(100).encode(c, 100); return T.processJPEG.call(this, d, t, i, n) }, T.processGIF87A = T.processGIF89A, (L = Z.API).processBMP = function (e, t, i, n, a) { var s = new Ce(e, !1), r = s.width, o = s.height, l = { data: s.getData(), width: r, height: o }, c = new we(100).encode(l, 100); return L.processJPEG.call(this, c, t, i, n) }, Z.API.setLanguage = function (e) { return void 0 === this.internal.languageSettings && (this.internal.languageSettings = {}, this.internal.languageSettings.isSubscribed = !1), void 0 !== { af: "Afrikaans", sq: "Albanian", ar: "Arabic (Standard)", "ar-DZ": "Arabic (Algeria)", "ar-BH": "Arabic (Bahrain)", "ar-EG": "Arabic (Egypt)", "ar-IQ": "Arabic (Iraq)", "ar-JO": "Arabic (Jordan)", "ar-KW": "Arabic (Kuwait)", "ar-LB": "Arabic (Lebanon)", "ar-LY": "Arabic (Libya)", "ar-MA": "Arabic (Morocco)", "ar-OM": "Arabic (Oman)", "ar-QA": "Arabic (Qatar)", "ar-SA": "Arabic (Saudi Arabia)", "ar-SY": "Arabic (Syria)", "ar-TN": "Arabic (Tunisia)", "ar-AE": "Arabic (U.A.E.)", "ar-YE": "Arabic (Yemen)", an: "Aragonese", hy: "Armenian", as: "Assamese", ast: "Asturian", az: "Azerbaijani", eu: "Basque", be: "Belarusian", bn: "Bengali", bs: "Bosnian", br: "Breton", bg: "Bulgarian", my: "Burmese", ca: "Catalan", ch: "Chamorro", ce: "Chechen", zh: "Chinese", "zh-HK": "Chinese (Hong Kong)", "zh-CN": "Chinese (PRC)", "zh-SG": "Chinese (Singapore)", "zh-TW": "Chinese (Taiwan)", cv: "Chuvash", co: "Corsican", cr: "Cree", hr: "Croatian", cs: "Czech", da: "Danish", nl: "Dutch (Standard)", "nl-BE": "Dutch (Belgian)", en: "English", "en-AU": "English (Australia)", "en-BZ": "English (Belize)", "en-CA": "English (Canada)", "en-IE": "English (Ireland)", "en-JM": "English (Jamaica)", "en-NZ": "English (New Zealand)", "en-PH": "English (Philippines)", "en-ZA": "English (South Africa)", "en-TT": "English (Trinidad & Tobago)", "en-GB": "English (United Kingdom)", "en-US": "English (United States)", "en-ZW": "English (Zimbabwe)", eo: "Esperanto", et: "Estonian", fo: "Faeroese", fj: "Fijian", fi: "Finnish", fr: "French (Standard)", "fr-BE": "French (Belgium)", "fr-CA": "French (Canada)", "fr-FR": "French (France)", "fr-LU": "French (Luxembourg)", "fr-MC": "French (Monaco)", "fr-CH": "French (Switzerland)", fy: "Frisian", fur: "Friulian", gd: "Gaelic (Scots)", "gd-IE": "Gaelic (Irish)", gl: "Galacian", ka: "Georgian", de: "German (Standard)", "de-AT": "German (Austria)", "de-DE": "German (Germany)", "de-LI": "German (Liechtenstein)", "de-LU": "German (Luxembourg)", "de-CH": "German (Switzerland)", el: "Greek", gu: "Gujurati", ht: "Haitian", he: "Hebrew", hi: "Hindi", hu: "Hungarian", is: "Icelandic", id: "Indonesian", iu: "Inuktitut", ga: "Irish", it: "Italian (Standard)", "it-CH": "Italian (Switzerland)", ja: "Japanese", kn: "Kannada", ks: "Kashmiri", kk: "Kazakh", km: "Khmer", ky: "Kirghiz", tlh: "Klingon", ko: "Korean", "ko-KP": "Korean (North Korea)", "ko-KR": "Korean (South Korea)", la: "Latin", lv: "Latvian", lt: "Lithuanian", lb: "Luxembourgish", mk: "FYRO Macedonian", ms: "Malay", ml: "Malayalam", mt: "Maltese", mi: "Maori", mr: "Marathi", mo: "Moldavian", nv: "Navajo", ng: "Ndonga", ne: "Nepali", no: "Norwegian", nb: "Norwegian (Bokmal)", nn: "Norwegian (Nynorsk)", oc: "Occitan", or: "Oriya", om: "Oromo", fa: "Persian", "fa-IR": "Persian/Iran", pl: "Polish", pt: "Portuguese", "pt-BR": "Portuguese (Brazil)", pa: "Punjabi", "pa-IN": "Punjabi (India)", "pa-PK": "Punjabi (Pakistan)", qu: "Quechua", rm: "Rhaeto-Romanic", ro: "Romanian", "ro-MO": "Romanian (Moldavia)", ru: "Russian", "ru-MO": "Russian (Moldavia)", sz: "Sami (Lappish)", sg: "Sango", sa: "Sanskrit", sc: "Sardinian", sd: "Sindhi", si: "Singhalese", sr: "Serbian", sk: "Slovak", sl: "Slovenian", so: "Somani", sb: "Sorbian", es: "Spanish", "es-AR": "Spanish (Argentina)", "es-BO": "Spanish (Bolivia)", "es-CL": "Spanish (Chile)", "es-CO": "Spanish (Colombia)", "es-CR": "Spanish (Costa Rica)", "es-DO": "Spanish (Dominican Republic)", "es-EC": "Spanish (Ecuador)", "es-SV": "Spanish (El Salvador)", "es-GT": "Spanish (Guatemala)", "es-HN": "Spanish (Honduras)", "es-MX": "Spanish (Mexico)", "es-NI": "Spanish (Nicaragua)", "es-PA": "Spanish (Panama)", "es-PY": "Spanish (Paraguay)", "es-PE": "Spanish (Peru)", "es-PR": "Spanish (Puerto Rico)", "es-ES": "Spanish (Spain)", "es-UY": "Spanish (Uruguay)", "es-VE": "Spanish (Venezuela)", sx: "Sutu", sw: "Swahili", sv: "Swedish", "sv-FI": "Swedish (Finland)", "sv-SV": "Swedish (Sweden)", ta: "Tamil", tt: "Tatar", te: "Teluga", th: "Thai", tig: "Tigre", ts: "Tsonga", tn: "Tswana", tr: "Turkish", tk: "Turkmen", uk: "Ukrainian", hsb: "Upper Sorbian", ur: "Urdu", ve: "Venda", vi: "Vietnamese", vo: "Volapuk", wa: "Walloon", cy: "Welsh", xh: "Xhosa", ji: "Yiddish", zu: "Zulu" }[e] && (this.internal.languageSettings.languageCode = e, !1 === this.internal.languageSettings.isSubscribed && (this.internal.events.subscribe("putCatalog", function () { this.internal.write("/Lang (" + this.internal.languageSettings.languageCode + ")") }), this.internal.languageSettings.isSubscribed = !0)), this }, M = Z.API, R = M.getCharWidthsArray = function (e, t) { var i, n, a, s = (t = t || {}).font || this.internal.getFont(), r = t.fontSize || this.internal.getFontSize(), o = t.charSpace || this.internal.getCharSpace(), l = t.widths ? t.widths : s.metadata.Unicode.widths, c = l.fof ? l.fof : 1, d = t.kerning ? t.kerning : s.metadata.Unicode.kerning, u = d.fof ? d.fof : 1, h = 0, p = l[0] || c, f = []; for (i = 0, n = e.length; i < n; i++)a = e.charCodeAt(i), "function" == typeof s.metadata.widthOfString ? f.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(a)) + o * (1e3 / r) || 0) / 1e3) : f.push((l[a] || p) / c + (d[a] && d[a][h] || 0) / u), h = a; return f }, O = M.getArraySum = function (e) { for (var t = e.length, i = 0; t;)i += e[--t]; return i }, E = M.getStringUnitWidth = function (e, t) { var i = (t = t || {}).fontSize || this.internal.getFontSize(), n = t.font || this.internal.getFont(), a = t.charSpace || this.internal.getCharSpace(); return "function" == typeof n.metadata.widthOfString ? n.metadata.widthOfString(e, i, a) / i : O(R.apply(this, arguments)) }, N = function (e, t, i, n) { for (var a = [], s = 0, r = e.length, o = 0; s !== r && o + t[s] < i;)o += t[s], s++; a.push(e.slice(0, s)); var l = s; for (o = 0; s !== r;)o + t[s] > n && (a.push(e.slice(l, s)), o = 0, l = s), o += t[s], s++; return l !== s && a.push(e.slice(l, s)), a }, B = function (e, t, i) { i || (i = {}); var n, a, s, r, o, l, c = [], d = [c], u = i.textIndent || 0, h = 0, p = 0, f = e.split(" "), m = R.apply(this, [" ", i])[0]; if (l = -1 === i.lineIndent ? f[0].length + 2 : i.lineIndent || 0) { var g = Array(l).join(" "), _ = []; f.map(function (e) { 1 < (e = e.split(/\s*\n/)).length ? _ = _.concat(e.map(function (e, t) { return (t && e.length ? "\n" : "") + e })) : _.push(e[0]) }), f = _, l = E.apply(this, [g, i]) } for (s = 0, r = f.length; s < r; s++) { var v = 0; if (n = f[s], l && "\n" == n[0] && (n = n.substr(1), v = 1), a = R.apply(this, [n, i]), t < u + h + (p = O(a)) || v) { if (t < p) { for (o = N.apply(this, [n, a, t - (u + h), t]), c.push(o.shift()), c = [o.pop()]; o.length;)d.push([o.shift()]); p = O(a.slice(n.length - (c[0] ? c[0].length : 0))) } else c = [n]; d.push(c), u = p + l, h = m } else c.push(n), u += h + p, h = m } if (l) var y = function (e, t) { return (t ? g : "") + e.join(" ") }; else y = function (e) { return e.join(" ") }; return d.map(y) }, M.splitTextToSize = function (e, t, i) { var n, a = (i = i || {}).fontSize || this.internal.getFontSize(), s = function (e) { var t = { 0: 1 }, i = {}; if (e.widths && e.kerning) return { widths: e.widths, kerning: e.kerning }; var n = this.internal.getFont(e.fontName, e.fontStyle), a = "Unicode"; return n.metadata[a] ? { widths: n.metadata[a].widths || t, kerning: n.metadata[a].kerning || i } : { font: n.metadata, fontSize: this.internal.getFontSize(), charSpace: this.internal.getCharSpace() } }.call(this, i); n = Array.isArray(e) ? e : e.split(/\r?\n/); var r = 1 * this.internal.scaleFactor * t / a; s.textIndent = i.textIndent ? 1 * i.textIndent * this.internal.scaleFactor / a : 0, s.lineIndent = i.lineIndent; var o, l, c = []; for (o = 0, l = n.length; o < l; o++)c = c.concat(B.apply(this, [n[o], r, s])); return c }, F = Z.API, U = { codePages: ["WinAnsiEncoding"], WinAnsiEncoding: (q = function (e) { for (var t = "klmnopqrstuvwxyz", i = {}, n = 0; n < t.length; n++)i[t[n]] = "0123456789abcdef"[n]; var a, s, r, o, l, c = {}, d = 1, u = c, h = [], p = "", f = "", m = e.length - 1; for (n = 1; n != m;)l = e[n], n += 1, "'" == l ? s ? (o = s.join(""), s = a) : s = [] : s ? s.push(l) : "{" == l ? (h.push([u, o]), u = {}, o = a) : "}" == l ? ((r = h.pop())[0][r[1]] = u, o = a, u = r[0]) : "-" == l ? d = -1 : o === a ? i.hasOwnProperty(l) ? (p += i[l], o = parseInt(p, 16) * d, d = 1, p = "") : p += l : i.hasOwnProperty(l) ? (f += i[l], u[o] = parseInt(f, 16) * d, d = 1, o = a, f = "") : f += l; return c })("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}") }, H = { Unicode: { Courier: U, "Courier-Bold": U, "Courier-BoldOblique": U, "Courier-Oblique": U, Helvetica: U, "Helvetica-Bold": U, "Helvetica-BoldOblique": U, "Helvetica-Oblique": U, "Times-Roman": U, "Times-Bold": U, "Times-BoldItalic": U, "Times-Italic": U } }, W = { Unicode: { "Courier-Oblique": q("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"), "Times-BoldItalic": q("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"), "Helvetica-Bold": q("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"), Courier: q("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"), "Courier-BoldOblique": q("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"), "Times-Bold": q("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"), Symbol: q("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"), Helvetica: q("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"), "Helvetica-BoldOblique": q("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"), ZapfDingbats: q("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"), "Courier-Bold": q("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"), "Times-Italic": q("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"), "Times-Roman": q("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"), "Helvetica-Oblique": q("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}") } }, F.events.push(["addFont", function (e) { var t, i, n, a = "Unicode"; (t = W[a][e.postScriptName]) && ((i = e.metadata[a] ? e.metadata[a] : e.metadata[a] = {}).widths = t.widths, i.kerning = t.kerning), (n = H[a][e.postScriptName]) && ((i = e.metadata[a] ? e.metadata[a] : e.metadata[a] = {}).encoding = n).codePages && n.codePages.length && (e.encoding = n.codePages[0]) }]), V = Z, "undefined" != typeof self && self || "undefined" != typeof global && global || "undefined" != typeof window && window || Function("return this")(), V.API.events.push(["addFont", function (e) { V.API.existsFileInVFS(e.postScriptName) ? (e.metadata = V.API.TTFFont.open(e.postScriptName, e.fontName, V.API.getFileFromVFS(e.postScriptName), e.encoding), e.metadata.Unicode = e.metadata.Unicode || { encoding: {}, kerning: {}, widths: [] }) : e.id.slice(1) }]), (z = Z.API).addSvg = function (e, t, i, n, a) { if (void 0 === t || void 0 === i) throw new Error("addSVG needs values for 'x' and 'y'"); function s(e) { for (var t = parseFloat(e[1]), i = parseFloat(e[2]), n = [], a = 3, s = e.length; a < s;)"c" === e[a] ? (n.push([parseFloat(e[a + 1]), parseFloat(e[a + 2]), parseFloat(e[a + 3]), parseFloat(e[a + 4]), parseFloat(e[a + 5]), parseFloat(e[a + 6])]), a += 7) : "l" === e[a] ? (n.push([parseFloat(e[a + 1]), parseFloat(e[a + 2])]), a += 3) : a += 1; return [t, i, n] } var r, o, l, c, d, u, h, p, f = (c = document, p = c.createElement("iframe"), d = ".jsPDF_sillysvg_iframe {display:none;position:absolute;}", (h = (u = c).createElement("style")).type = "text/css", h.styleSheet ? h.styleSheet.cssText = d : h.appendChild(u.createTextNode(d)), u.getElementsByTagName("head")[0].appendChild(h), p.name = "childframe", p.setAttribute("width", 0), p.setAttribute("height", 0), p.setAttribute("frameborder", "0"), p.setAttribute("scrolling", "no"), p.setAttribute("seamless", "seamless"), p.setAttribute("class", "jsPDF_sillysvg_iframe"), c.body.appendChild(p), p), m = (r = e, (l = ((o = f).contentWindow || o.contentDocument).document).write(r), l.close(), l.getElementsByTagName("svg")[0]), g = [1, 1], _ = parseFloat(m.getAttribute("width")), v = parseFloat(m.getAttribute("height")); _ && v && (n && a ? g = [n / _, a / v] : n ? g = [n / _, n / _] : a && (g = [a / v, a / v])); var y, b, w, C, x = m.childNodes; for (y = 0, b = x.length; y < b; y++)(w = x[y]).tagName && "PATH" === w.tagName.toUpperCase() && ((C = s(w.getAttribute("d").split(" ")))[0] = C[0] * g[0] + t, C[1] = C[1] * g[1] + i, this.lines.call(this, C[2], C[0], C[1], g)); return this }, z.addSVG = z.addSvg, z.addSvgAsImage = function (e, t, i, n, a, s, r, o) { if (isNaN(t) || isNaN(i)) throw new Error("Invalid coordinates passed to jsPDF.addSvgAsImage"); if (isNaN(n) || isNaN(a)) throw new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage"); var l = document.createElement("canvas"); l.width = n, l.height = a; var c = l.getContext("2d"); return c.fillStyle = "#fff", c.fillRect(0, 0, l.width, l.height), canvg(l, e, { ignoreMouse: !0, ignoreAnimation: !0, ignoreDimensions: !0, ignoreClear: !0 }), this.addImage(l.toDataURL("image/jpeg", 1), t, i, n, a, r, o), this }, Z.API.putTotalPages = function (e) { for (var t = new RegExp(e, "g"), i = 1; i <= this.internal.getNumberOfPages(); i++)for (var n = 0; n < this.internal.pages[i].length; n++)this.internal.pages[i][n] = this.internal.pages[i][n].replace(t, this.internal.getNumberOfPages()); return this }, Z.API.viewerPreferences = function (e, t) { var i; e = e || {}, t = t || !1; var n, a, s = { HideToolbar: { defaultValue: !1, value: !1, type: "boolean", explicitSet: !1, valueSet: [!0, !1], pdfVersion: 1.3 }, HideMenubar: { defaultValue: !1, value: !1, type: "boolean", explicitSet: !1, valueSet: [!0, !1], pdfVersion: 1.3 }, HideWindowUI: { defaultValue: !1, value: !1, type: "boolean", explicitSet: !1, valueSet: [!0, !1], pdfVersion: 1.3 }, FitWindow: { defaultValue: !1, value: !1, type: "boolean", explicitSet: !1, valueSet: [!0, !1], pdfVersion: 1.3 }, CenterWindow: { defaultValue: !1, value: !1, type: "boolean", explicitSet: !1, valueSet: [!0, !1], pdfVersion: 1.3 }, DisplayDocTitle: { defaultValue: !1, value: !1, type: "boolean", explicitSet: !1, valueSet: [!0, !1], pdfVersion: 1.4 }, NonFullScreenPageMode: { defaultValue: "UseNone", value: "UseNone", type: "name", explicitSet: !1, valueSet: ["UseNone", "UseOutlines", "UseThumbs", "UseOC"], pdfVersion: 1.3 }, Direction: { defaultValue: "L2R", value: "L2R", type: "name", explicitSet: !1, valueSet: ["L2R", "R2L"], pdfVersion: 1.3 }, ViewArea: { defaultValue: "CropBox", value: "CropBox", type: "name", explicitSet: !1, valueSet: ["MediaBox", "CropBox", "TrimBox", "BleedBox", "ArtBox"], pdfVersion: 1.4 }, ViewClip: { defaultValue: "CropBox", value: "CropBox", type: "name", explicitSet: !1, valueSet: ["MediaBox", "CropBox", "TrimBox", "BleedBox", "ArtBox"], pdfVersion: 1.4 }, PrintArea: { defaultValue: "CropBox", value: "CropBox", type: "name", explicitSet: !1, valueSet: ["MediaBox", "CropBox", "TrimBox", "BleedBox", "ArtBox"], pdfVersion: 1.4 }, PrintClip: { defaultValue: "CropBox", value: "CropBox", type: "name", explicitSet: !1, valueSet: ["MediaBox", "CropBox", "TrimBox", "BleedBox", "ArtBox"], pdfVersion: 1.4 }, PrintScaling: { defaultValue: "AppDefault", value: "AppDefault", type: "name", explicitSet: !1, valueSet: ["AppDefault", "None"], pdfVersion: 1.6 }, Duplex: { defaultValue: "", value: "none", type: "name", explicitSet: !1, valueSet: ["Simplex", "DuplexFlipShortEdge", "DuplexFlipLongEdge", "none"], pdfVersion: 1.7 }, PickTrayByPDFSize: { defaultValue: !1, value: !1, type: "boolean", explicitSet: !1, valueSet: [!0, !1], pdfVersion: 1.7 }, PrintPageRange: { defaultValue: "", value: "", type: "array", explicitSet: !1, valueSet: null, pdfVersion: 1.7 }, NumCopies: { defaultValue: 1, value: 1, type: "integer", explicitSet: !1, valueSet: null, pdfVersion: 1.7 } }, r = Object.keys(s), o = [], l = 0, c = 0, d = 0, u = !0; function h(e, t) { var i, n = !1; for (i = 0; i < e.length; i += 1)e[i] === t && (n = !0); return n } if (void 0 === this.internal.viewerpreferences && (this.internal.viewerpreferences = {}, this.internal.viewerpreferences.configuration = JSON.parse(JSON.stringify(s)), this.internal.viewerpreferences.isSubscribed = !1), i = this.internal.viewerpreferences.configuration, "reset" === e || !0 === t) { var p = r.length; for (d = 0; d < p; d += 1)i[r[d]].value = i[r[d]].defaultValue, i[r[d]].explicitSet = !1 } if ("object" === (void 0 === e ? "undefined" : ye(e))) for (n in e) if (a = e[n], h(r, n) && void 0 !== a) { if ("boolean" === i[n].type && "boolean" == typeof a) i[n].value = a; else if ("name" === i[n].type && h(i[n].valueSet, a)) i[n].value = a; else if ("integer" === i[n].type && Number.isInteger(a)) i[n].value = a; else if ("array" === i[n].type) { for (l = 0; l < a.length; l += 1)if (u = !0, 1 === a[l].length && "number" == typeof a[l][0]) o.push(String(a[l])); else if (1 < a[l].length) { for (c = 0; c < a[l].length; c += 1)"number" != typeof a[l][c] && (u = !1); !0 === u && o.push(String(a[l].join("-"))) } i[n].value = String(o) } else i[n].value = i[n].defaultValue; i[n].explicitSet = !0 } return !1 === this.internal.viewerpreferences.isSubscribed && (this.internal.events.subscribe("putCatalog", function () { var e, t = []; for (e in i) !0 === i[e].explicitSet && ("name" === i[e].type ? t.push("/" + e + " /" + i[e].value) : t.push("/" + e + " " + i[e].value)); 0 !== t.length && this.internal.write("/ViewerPreferences\n<<\n" + t.join("\n") + "\n>>") }), this.internal.viewerpreferences.isSubscribed = !0), this.internal.viewerpreferences.configuration = i, this }, Y = Z.API, J = Q = G = "", Y.addMetadata = function (e, t) { return Q = t || "http://jspdf.default.namespaceuri/", G = e, this.internal.events.subscribe("postPutResources", function () { if (G) { var e = '<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="' + Q + '"><jspdf:metadata>', t = unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')), i = unescape(encodeURIComponent(e)), n = unescape(encodeURIComponent(G)), a = unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")), s = unescape(encodeURIComponent("</x:xmpmeta>")), r = i.length + n.length + a.length + t.length + s.length; J = this.internal.newObject(), this.internal.write("<< /Type /Metadata /Subtype /XML /Length " + r + " >>"), this.internal.write("stream"), this.internal.write(t + i + n + a + s), this.internal.write("endstream"), this.internal.write("endobj") } else J = "" }), this.internal.events.subscribe("putCatalog", function () { J && this.internal.write("/Metadata " + J + " 0 R") }), this }, function (d, e) { var t = d.API, g = [0]; t.events.push(["putFont", function (e) { !function (e, t, i) { if (e.metadata instanceof d.API.TTFFont && "Identity-H" === e.encoding) { for (var n = e.metadata.Unicode.widths, a = e.metadata.subset.encode(g), s = "", r = 0; r < a.length; r++)s += String.fromCharCode(a[r]); var o = i(); t("<<"), t("/Length " + s.length), t("/Length1 " + s.length), t(">>"), t("stream"), t(s), t("endstream"), t("endobj"); var l = i(); t("<<"), t("/Type /FontDescriptor"), t("/FontName /" + e.fontName), t("/FontFile2 " + o + " 0 R"), t("/FontBBox " + d.API.PDFObject.convert(e.metadata.bbox)), t("/Flags " + e.metadata.flags), t("/StemV " + e.metadata.stemV), t("/ItalicAngle " + e.metadata.italicAngle), t("/Ascent " + e.metadata.ascender), t("/Descent " + e.metadata.decender), t("/CapHeight " + e.metadata.capHeight), t(">>"), t("endobj"); var c = i(); t("<<"), t("/Type /Font"), t("/BaseFont /" + e.fontName), t("/FontDescriptor " + l + " 0 R"), t("/W " + d.API.PDFObject.convert(n)), t("/CIDToGIDMap /Identity"), t("/DW 1000"), t("/Subtype /CIDFontType2"), t("/CIDSystemInfo"), t("<<"), t("/Supplement 0"), t("/Registry (Adobe)"), t("/Ordering (" + e.encoding + ")"), t(">>"), t(">>"), t("endobj"), e.objectNumber = i(), t("<<"), t("/Type /Font"), t("/Subtype /Type0"), t("/BaseFont /" + e.fontName), t("/Encoding /" + e.encoding), t("/DescendantFonts [" + c + " 0 R]"), t(">>"), t("endobj"), e.isAlreadyPutted = !0 } }(e.font, e.out, e.newObject) }]); t.events.push(["putFont", function (e) { !function (e, t, i) { if (e.metadata instanceof d.API.TTFFont && "WinAnsiEncoding" === e.encoding) { e.metadata.Unicode.widths; for (var n = e.metadata.rawData, a = "", s = 0; s < n.length; s++)a += String.fromCharCode(n[s]); var r = i(); t("<<"), t("/Length " + a.length), t("/Length1 " + a.length), t(">>"), t("stream"), t(a), t("endstream"), t("endobj"); var o = i(); for (t("<<"), t("/Descent " + e.metadata.decender), t("/CapHeight " + e.metadata.capHeight), t("/StemV " + e.metadata.stemV), t("/Type /FontDescriptor"), t("/FontFile2 " + r + " 0 R"), t("/Flags 96"), t("/FontBBox " + d.API.PDFObject.convert(e.metadata.bbox)), t("/FontName /" + e.fontName), t("/ItalicAngle " + e.metadata.italicAngle), t("/Ascent " + e.metadata.ascender), t(">>"), t("endobj"), e.objectNumber = i(), s = 0; s < e.metadata.hmtx.widths.length; s++)e.metadata.hmtx.widths[s] = parseInt(e.metadata.hmtx.widths[s] * (1e3 / e.metadata.head.unitsPerEm)); t("<</Subtype/TrueType/Type/Font/BaseFont/" + e.fontName + "/FontDescriptor " + o + " 0 R/Encoding/" + e.encoding + " /FirstChar 29 /LastChar 255 /Widths " + d.API.PDFObject.convert(e.metadata.hmtx.widths) + ">>"), t("endobj"), e.isAlreadyPutted = !0 } }(e.font, e.out, e.newObject) }]); var c = function (e) { var t, i, n = e.text || "", a = e.x, s = e.y, r = e.options || {}, o = e.mutex || {}, l = o.pdfEscape, c = o.activeFontKey, d = o.fonts, u = (o.activeFontSize, ""), h = 0, p = "", f = d[i = c].encoding; if ("Identity-H" !== d[i].encoding) return { text: n, x: a, y: s, options: r, mutex: o }; for (p = n, i = c, "[object Array]" === Object.prototype.toString.call(n) && (p = n[0]), h = 0; h < p.length; h += 1)d[i].metadata.hasOwnProperty("cmap") && (t = d[i].metadata.cmap.unicode.codeMap[p[h].charCodeAt(0)]), t ? u += p[h] : p[h].charCodeAt(0) < 256 && d[i].metadata.hasOwnProperty("Unicode") ? u += p[h] : u += ""; var m = ""; return parseInt(i.slice(1)) < 14 || "WinAnsiEncoding" === f ? m = function (e) { for (var t = "", i = 0; i < e.length; i++)t += "" + e.charCodeAt(i).toString(16); return t }(l(u, i)) : "Identity-H" === f && (m = function (e, t) { for (var i, n = t.metadata.Unicode.widths, a = ["", "0", "00", "000", "0000"], s = [""], r = 0, o = e.length; r < o; ++r) { if (i = t.metadata.characterToGlyph(e.charCodeAt(r)), g.push(i), -1 == n.indexOf(i) && (n.push(i), n.push([parseInt(t.metadata.widthOfGlyph(i), 10)])), "0" == i) return s.join(""); i = i.toString(16), s.push(a[4 - i.length], i) } return s.join("") }(u, d[i])), o.isHex = !0, { text: m, x: a, y: s, options: r, mutex: o } }; t.events.push(["postProcessText", function (e) { var t = e.text || "", i = e.x, n = e.y, a = e.options, s = e.mutex, r = (a.lang, []), o = { text: t, x: i, y: n, options: a, mutex: s }; if ("[object Array]" === Object.prototype.toString.call(t)) { var l = 0; for (l = 0; l < t.length; l += 1)"[object Array]" === Object.prototype.toString.call(t[l]) && 3 === t[l].length ? r.push([c(Object.assign({}, o, { text: t[l][0] })).text, t[l][1], t[l][2]]) : r.push(c(Object.assign({}, o, { text: t[l] })).text); e.text = r } else e.text = c(Object.assign({}, o, { text: t })).text }]) }(Z, "undefined" != typeof self && self || "undefined" != typeof global && global || "undefined" != typeof window && window || Function("return this")()), K = Z.API, X = {}, K.existsFileInVFS = function (e) { return X.hasOwnProperty(e) }, K.addFileToVFS = function (e, t) { return X[e] = t, this }, K.getFileFromVFS = function (e) { return X.hasOwnProperty(e) ? X[e] : null }, function (e) { if (e.URL = e.URL || e.webkitURL, e.Blob && e.URL) try { return new Blob } catch (e) { } var o = e.BlobBuilder || e.WebKitBlobBuilder || e.MozBlobBuilder || function (e) { var o = function (e) { return Object.prototype.toString.call(e).match(/^\[object\s(.*)\]$/)[1] }, t = function () { this.data = [] }, l = function (e, t, i) { this.data = e, this.size = e.length, this.type = t, this.encoding = i }, i = t.prototype, n = l.prototype, c = e.FileReaderSync, d = function (e) { this.code = this[this.name = e] }, a = "NOT_FOUND_ERR SECURITY_ERR ABORT_ERR NOT_READABLE_ERR ENCODING_ERR NO_MODIFICATION_ALLOWED_ERR INVALID_STATE_ERR SYNTAX_ERR".split(" "), s = a.length, r = e.URL || e.webkitURL || e, u = r.createObjectURL, h = r.revokeObjectURL, p = r, f = e.btoa, m = e.atob, g = e.ArrayBuffer, _ = e.Uint8Array, v = /^[\w-]+:\/*\[?[\w\.:-]+\]?(?::[0-9]+)?/; for (l.fake = n.fake = !0; s--;)d.prototype[a[s]] = s + 1; return r.createObjectURL || (p = e.URL = function (e) { var t, i = document.createElementNS("http://www.w3.org/1999/xhtml", "a"); return i.href = e, "origin" in i || ("data:" === i.protocol.toLowerCase() ? i.origin = null : (t = e.match(v), i.origin = t && t[1])), i }), p.createObjectURL = function (e) { var t, i = e.type; return null === i && (i = "application/octet-stream"), e instanceof l ? (t = "data:" + i, "base64" === e.encoding ? t + ";base64," + e.data : "URI" === e.encoding ? t + "," + decodeURIComponent(e.data) : f ? t + ";base64," + f(e.data) : t + "," + encodeURIComponent(e.data)) : u ? u.call(r, e) : void 0 }, p.revokeObjectURL = function (e) { "data:" !== e.substring(0, 5) && h && h.call(r, e) }, i.append = function (e) { var t = this.data; if (_ && (e instanceof g || e instanceof _)) { for (var i = "", n = new _(e), a = 0, s = n.length; a < s; a++)i += String.fromCharCode(n[a]); t.push(i) } else if ("Blob" === o(e) || "File" === o(e)) { if (!c) throw new d("NOT_READABLE_ERR"); var r = new c; t.push(r.readAsBinaryString(e)) } else e instanceof l ? "base64" === e.encoding && m ? t.push(m(e.data)) : "URI" === e.encoding ? t.push(decodeURIComponent(e.data)) : "raw" === e.encoding && t.push(e.data) : ("string" != typeof e && (e += ""), t.push(unescape(encodeURIComponent(e)))) }, i.getBlob = function (e) { return arguments.length || (e = null), new l(this.data.join(""), e, "raw") }, i.toString = function () { return "[object BlobBuilder]" }, n.slice = function (e, t, i) { var n = arguments.length; return n < 3 && (i = null), new l(this.data.slice(e, 1 < n ? t : this.data.length), i, this.encoding) }, n.toString = function () { return "[object Blob]" }, n.close = function () { this.size = 0, delete this.data }, t }(e); e.Blob = function (e, t) { var i = t && t.type || "", n = new o; if (e) for (var a = 0, s = e.length; a < s; a++)Uint8Array && e[a] instanceof Uint8Array ? n.append(e[a].buffer) : n.append(e[a]); var r = n.getBlob(i); return !r.slice && r.webkitSlice && (r.slice = r.webkitSlice), r }; var t = Object.getPrototypeOf || function (e) { return e.__proto__ }; e.Blob.prototype = t(new e.Blob) }("undefined" != typeof self && self || "undefined" != typeof window && window || window.content || window); var ee, te, ie, ne, ae, se, re, oe, le, ce, de, ue, he, pe, fe, me, ge, be = be || function (o) { if (!(void 0 === o || "undefined" != typeof navigator && /MSIE [1-9]\./.test(navigator.userAgent))) { var e = o.document, l = function () { return o.URL || o.webkitURL || o }, c = e.createElementNS("http://www.w3.org/1999/xhtml", "a"), d = "download" in c, u = /constructor/i.test(o.HTMLElement) || o.safari, h = /CriOS\/[\d]+/.test(navigator.userAgent), p = function (e) { (o.setImmediate || o.setTimeout)(function () { throw e }, 0) }, f = function (e) { setTimeout(function () { "string" == typeof e ? l().revokeObjectURL(e) : e.remove() }, 4e4) }, m = function (e) { return /^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type) ? new Blob([String.fromCharCode(65279), e], { type: e.type }) : e }, n = function (e, i, t) { t || (e = m(e)); var n, a = this, s = "application/octet-stream" === e.type, r = function () { !function (e, t, i) { for (var n = (t = [].concat(t)).length; n--;) { var a = e["on" + t[n]]; if ("function" == typeof a) try { a.call(e, i || e) } catch (e) { p(e) } } }(a, "writestart progress write writeend".split(" ")) }; if (a.readyState = a.INIT, d) return n = l().createObjectURL(e), void setTimeout(function () { var e, t; c.href = n, c.download = i, e = c, t = new MouseEvent("click"), e.dispatchEvent(t), r(), f(n), a.readyState = a.DONE }); !function () { if ((h || s && u) && o.FileReader) { var t = new FileReader; return t.onloadend = function () { var e = h ? t.result : t.result.replace(/^data:[^;]*;/, "data:attachment/file;"); o.open(e, "_blank") || (o.location.href = e), e = void 0, a.readyState = a.DONE, r() }, t.readAsDataURL(e), a.readyState = a.INIT } n || (n = l().createObjectURL(e)), s ? o.location.href = n : o.open(n, "_blank") || (o.location.href = n); a.readyState = a.DONE, r(), f(n) }() }, t = n.prototype; return "undefined" != typeof navigator && navigator.msSaveOrOpenBlob ? function (e, t, i) { return t = t || e.name || "download", i || (e = m(e)), navigator.msSaveOrOpenBlob(e, t) } : (t.abort = function () { }, t.readyState = t.INIT = 0, t.WRITING = 1, t.DONE = 2, t.error = t.onwritestart = t.onprogress = t.onwrite = t.onabort = t.onerror = t.onwriteend = null, function (e, t, i) { return new n(e, t || e.name || "download", i) }) } }("undefined" != typeof self && self || "undefined" != typeof window && window || window.content); function _e(w) { var e = 0; if (71 !== w[e++] || 73 !== w[e++] || 70 !== w[e++] || 56 !== w[e++] || 56 != (w[e++] + 1 & 253) || 97 !== w[e++]) throw "Invalid GIF 87a/89a header."; var C = w[e++] | w[e++] << 8, t = w[e++] | w[e++] << 8, i = w[e++], n = i >> 7, a = 1 << (7 & i) + 1; w[e++]; w[e++]; var s = null; n && (s = e, e += 3 * a); var r = !0, o = [], l = 0, c = null, d = 0, u = null; for (this.width = C, this.height = t; r && e < w.length;)switch (w[e++]) { case 33: switch (w[e++]) { case 255: if (11 !== w[e] || 78 == w[e + 1] && 69 == w[e + 2] && 84 == w[e + 3] && 83 == w[e + 4] && 67 == w[e + 5] && 65 == w[e + 6] && 80 == w[e + 7] && 69 == w[e + 8] && 50 == w[e + 9] && 46 == w[e + 10] && 48 == w[e + 11] && 3 == w[e + 12] && 1 == w[e + 13] && 0 == w[e + 16]) e += 14, u = w[e++] | w[e++] << 8, e++; else for (e += 12; ;) { if (0 === (k = w[e++])) break; e += k } break; case 249: if (4 !== w[e++] || 0 !== w[e + 4]) throw "Invalid graphics extension block."; var h = w[e++]; l = w[e++] | w[e++] << 8, c = w[e++], 0 == (1 & h) && (c = null), d = h >> 2 & 7, e++; break; case 254: for (; ;) { if (0 === (k = w[e++])) break; e += k } break; default: throw "Unknown graphic control label: 0x" + w[e - 1].toString(16) }break; case 44: var p = w[e++] | w[e++] << 8, f = w[e++] | w[e++] << 8, m = w[e++] | w[e++] << 8, g = w[e++] | w[e++] << 8, _ = w[e++], v = _ >> 6 & 1, y = s, b = !1; if (_ >> 7) { b = !0; y = e, e += 3 * (1 << (7 & _) + 1) } var x = e; for (e++; ;) { var k; if (0 === (k = w[e++])) break; e += k } o.push({ x: p, y: f, width: m, height: g, has_local_palette: b, palette_offset: y, data_offset: x, data_length: e - x, transparent_index: c, interlaced: !!v, delay: l, disposal: d }); break; case 59: r = !1; break; default: throw "Unknown gif block: 0x" + w[e - 1].toString(16) }this.numFrames = function () { return o.length }, this.loopCount = function () { return u }, this.frameInfo = function (e) { if (e < 0 || e >= o.length) throw "Frame index out of range."; return o[e] }, this.decodeAndBlitFrameBGRA = function (e, t) { var i = this.frameInfo(e), n = i.width * i.height, a = new Uint8Array(n); ve(w, i.data_offset, a, n); var s = i.palette_offset, r = i.transparent_index; null === r && (r = 256); var o = i.width, l = C - o, c = o, d = 4 * (i.y * C + i.x), u = 4 * ((i.y + i.height) * C + i.x), h = d, p = 4 * l; !0 === i.interlaced && (p += 4 * (o + l) * 7); for (var f = 8, m = 0, g = a.length; m < g; ++m) { var _ = a[m]; if (0 === c && (c = o, u <= (h += p) && (p = l + 4 * (o + l) * (f - 1), h = d + (o + l) * (f << 1), f >>= 1)), _ === r) h += 4; else { var v = w[s + 3 * _], y = w[s + 3 * _ + 1], b = w[s + 3 * _ + 2]; t[h++] = b, t[h++] = y, t[h++] = v, t[h++] = 255 } --c } }, this.decodeAndBlitFrameRGBA = function (e, t) { var i = this.frameInfo(e), n = i.width * i.height, a = new Uint8Array(n); ve(w, i.data_offset, a, n); var s = i.palette_offset, r = i.transparent_index; null === r && (r = 256); var o = i.width, l = C - o, c = o, d = 4 * (i.y * C + i.x), u = 4 * ((i.y + i.height) * C + i.x), h = d, p = 4 * l; !0 === i.interlaced && (p += 4 * (o + l) * 7); for (var f = 8, m = 0, g = a.length; m < g; ++m) { var _ = a[m]; if (0 === c && (c = o, u <= (h += p) && (p = l + 4 * (o + l) * (f - 1), h = d + (o + l) * (f << 1), f >>= 1)), _ === r) h += 4; else { var v = w[s + 3 * _], y = w[s + 3 * _ + 1], b = w[s + 3 * _ + 2]; t[h++] = v, t[h++] = y, t[h++] = b, t[h++] = 255 } --c } } } function ve(e, t, i, n) { for (var a = e[t++], s = 1 << a, r = s + 1, o = r + 1, l = a + 1, c = (1 << l) - 1, d = 0, u = 0, h = 0, p = e[t++], f = new Int32Array(4096), m = null; ;) { for (; d < 16 && 0 !== p;)u |= e[t++] << d, d += 8, 1 === p ? p = e[t++] : --p; if (d < l) break; var g = u & c; if (u >>= l, d -= l, g !== s) { if (g === r) break; for (var _ = g < o ? g : m, v = 0, y = _; s < y;)y = f[y] >> 8, ++v; var b = y; if (n < h + v + (_ !== g ? 1 : 0)) return; i[h++] = b; var w = h += v; for (_ !== g && (i[h++] = b), y = _; v--;)y = f[y], i[--w] = 255 & y, y >>= 8; null !== m && o < 4096 && (f[o++] = m << 8 | b, c + 1 <= o && l < 12 && (++l, c = c << 1 | 1)), m = g } else o = r + 1, c = (1 << (l = a + 1)) - 1, m = null } return i } "undefined" != typeof module && module.exports ? module.exports.saveAs = be : "undefined" != typeof define && null !== define && null !== define.amd && define("FileSaver.js", function () { return be }), Z.API.adler32cs = (se = "function" == typeof ArrayBuffer && "function" == typeof Uint8Array, re = null, oe = function () { if (!se) return function () { return !1 }; try { var e = {}; "function" == typeof e.Buffer && (re = e.Buffer) } catch (e) { } return function (e) { return e instanceof ArrayBuffer || null !== re && e instanceof re } }(), le = null !== re ? function (e) { return new re(e, "utf8").toString("binary") } : function (e) { return unescape(encodeURIComponent(e)) }, ce = function (e, t) { for (var i = 65535 & e, n = e >>> 16, a = 0, s = t.length; a < s; a++)i = (i + (255 & t.charCodeAt(a))) % 65521, n = (n + i) % 65521; return (n << 16 | i) >>> 0 }, de = function (e, t) { for (var i = 65535 & e, n = e >>> 16, a = 0, s = t.length; a < s; a++)i = (i + t[a]) % 65521, n = (n + i) % 65521; return (n << 16 | i) >>> 0 }, he = (ue = {}).Adler32 = (((ae = (ne = function (e) { if (!(this instanceof ne)) throw new TypeError("Constructor cannot called be as a function."); if (!isFinite(e = null == e ? 1 : +e)) throw new Error("First arguments needs to be a finite number."); this.checksum = e >>> 0 }).prototype = {}).constructor = ne).from = ((ee = function (e) { if (!(this instanceof ne)) throw new TypeError("Constructor cannot called be as a function."); if (null == e) throw new Error("First argument needs to be a string."); this.checksum = ce(1, e.toString()) }).prototype = ae, ee), ne.fromUtf8 = ((te = function (e) { if (!(this instanceof ne)) throw new TypeError("Constructor cannot called be as a function."); if (null == e) throw new Error("First argument needs to be a string."); var t = le(e.toString()); this.checksum = ce(1, t) }).prototype = ae, te), se && (ne.fromBuffer = ((ie = function (e) { if (!(this instanceof ne)) throw new TypeError("Constructor cannot called be as a function."); if (!oe(e)) throw new Error("First argument needs to be ArrayBuffer."); var t = new Uint8Array(e); return this.checksum = de(1, t) }).prototype = ae, ie)), ae.update = function (e) { if (null == e) throw new Error("First argument needs to be a string."); return e = e.toString(), this.checksum = ce(this.checksum, e) }, ae.updateUtf8 = function (e) { if (null == e) throw new Error("First argument needs to be a string."); var t = le(e.toString()); return this.checksum = ce(this.checksum, t) }, se && (ae.updateBuffer = function (e) { if (!oe(e)) throw new Error("First argument needs to be ArrayBuffer."); var t = new Uint8Array(e); return this.checksum = de(this.checksum, t) }), ae.clone = function () { return new he(this.checksum) }, ne), ue.from = function (e) { if (null == e) throw new Error("First argument needs to be a string."); return ce(1, e.toString()) }, ue.fromUtf8 = function (e) { if (null == e) throw new Error("First argument needs to be a string."); var t = le(e.toString()); return ce(1, t) }, se && (ue.fromBuffer = function (e) { if (!oe(e)) throw new Error("First argument need to be ArrayBuffer."); var t = new Uint8Array(e); return de(1, t) }), ue); try { exports.GifWriter = function (_, e, t, i) { var v = 0, n = void 0 === (i = void 0 === i ? {} : i).loop ? null : i.loop, y = void 0 === i.palette ? null : i.palette; if (e <= 0 || t <= 0 || 65535 < e || 65535 < t) throw "Width/Height invalid."; function b(e) { var t = e.length; if (t < 2 || 256 < t || t & t - 1) throw "Invalid code/color length, must be power of 2 and 2 .. 256."; return t } _[v++] = 71, _[v++] = 73, _[v++] = 70, _[v++] = 56, _[v++] = 57, _[v++] = 97; var a = 0, s = 0; if (null !== y) { for (var r = b(y); r >>= 1;)++a; if (r = 1 << a, --a, void 0 !== i.background) { if (r <= (s = i.background)) throw "Background index out of range."; if (0 === s) throw "Background index explicitly passed as 0." } } if (_[v++] = 255 & e, _[v++] = e >> 8 & 255, _[v++] = 255 & t, _[v++] = t >> 8 & 255, _[v++] = (null !== y ? 128 : 0) | a, _[v++] = s, _[v++] = 0, null !== y) for (var o = 0, l = y.length; o < l; ++o) { var c = y[o]; _[v++] = c >> 16 & 255, _[v++] = c >> 8 & 255, _[v++] = 255 & c } if (null !== n) { if (n < 0 || 65535 < n) throw "Loop count invalid."; _[v++] = 33, _[v++] = 255, _[v++] = 11, _[v++] = 78, _[v++] = 69, _[v++] = 84, _[v++] = 83, _[v++] = 67, _[v++] = 65, _[v++] = 80, _[v++] = 69, _[v++] = 50, _[v++] = 46, _[v++] = 48, _[v++] = 3, _[v++] = 1, _[v++] = 255 & n, _[v++] = n >> 8 & 255, _[v++] = 0 } var w = !1; this.addFrame = function (e, t, i, n, a, s) { if (!0 === w && (--v, w = !1), s = void 0 === s ? {} : s, e < 0 || t < 0 || 65535 < e || 65535 < t) throw "x/y invalid."; if (i <= 0 || n <= 0 || 65535 < i || 65535 < n) throw "Width/Height invalid."; if (a.length < i * n) throw "Not enough pixels for the frame size."; var r = !0, o = s.palette; if (null == o && (r = !1, o = y), null == o) throw "Must supply either a local or global palette."; for (var l = b(o), c = 0; l >>= 1;)++c; l = 1 << c; var d = void 0 === s.delay ? 0 : s.delay, u = void 0 === s.disposal ? 0 : s.disposal; if (u < 0 || 3 < u) throw "Disposal out of range."; var h = !1, p = 0; if (void 0 !== s.transparent && null !== s.transparent && (h = !0, (p = s.transparent) < 0 || l <= p)) throw "Transparent color index."; if ((0 !== u || h || 0 !== d) && (_[v++] = 33, _[v++] = 249, _[v++] = 4, _[v++] = u << 2 | (!0 === h ? 1 : 0), _[v++] = 255 & d, _[v++] = d >> 8 & 255, _[v++] = p, _[v++] = 0), _[v++] = 44, _[v++] = 255 & e, _[v++] = e >> 8 & 255, _[v++] = 255 & t, _[v++] = t >> 8 & 255, _[v++] = 255 & i, _[v++] = i >> 8 & 255, _[v++] = 255 & n, _[v++] = n >> 8 & 255, _[v++] = !0 === r ? 128 | c - 1 : 0, !0 === r) for (var f = 0, m = o.length; f < m; ++f) { var g = o[f]; _[v++] = g >> 16 & 255, _[v++] = g >> 8 & 255, _[v++] = 255 & g } v = function (t, i, e, n) { t[i++] = e; var a = i++, s = 1 << e, r = s - 1, o = s + 1, l = o + 1, c = e + 1, d = 0, u = 0; function h(e) { for (; e <= d;)t[i++] = 255 & u, u >>= 8, d -= 8, i === a + 256 && (t[a] = 255, a = i++) } function p(e) { u |= e << d, d += c, h(8) } var f = n[0] & r, m = {}; p(s); for (var g = 1, _ = n.length; g < _; ++g) { var v = n[g] & r, y = f << 8 | v, b = m[y]; if (void 0 === b) { for (u |= f << d, d += c; 8 <= d;)t[i++] = 255 & u, u >>= 8, d -= 8, i === a + 256 && (t[a] = 255, a = i++); 4096 === l ? (p(s), l = o + 1, c = e + 1, m = {}) : (1 << c <= l && ++c, m[y] = l++), f = v } else f = b } return p(f), p(o), h(1), a + 1 === i ? t[a] = 0 : (t[a] = i - a - 1, t[i++] = 0), i }(_, v, c < 2 ? 2 : c, a) }, this.end = function () { return !1 === w && (_[v++] = 59, w = !0), v } }, exports.GifReader = _e } catch (e) { } function we(e) { var C, x, k, T, t, u = Math.floor, S = new Array(64), $ = new Array(64), A = new Array(64), I = new Array(64), _ = new Array(65535), v = new Array(65535), K = new Array(64), y = new Array(64), D = [], P = 0, j = 7, L = new Array(64), M = new Array(64), R = new Array(64), i = new Array(256), O = new Array(2048), b = [0, 1, 5, 6, 14, 15, 27, 28, 2, 4, 7, 13, 16, 26, 29, 42, 3, 8, 12, 17, 25, 30, 41, 43, 9, 11, 18, 24, 31, 40, 44, 53, 10, 19, 23, 32, 39, 45, 52, 54, 20, 22, 33, 38, 46, 51, 55, 60, 21, 34, 37, 47, 50, 56, 59, 61, 35, 36, 48, 49, 57, 58, 62, 63], E = [0, 0, 1, 5, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0], N = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], B = [0, 0, 2, 1, 3, 3, 2, 4, 3, 5, 5, 4, 4, 0, 0, 1, 125], F = [1, 2, 3, 0, 4, 17, 5, 18, 33, 49, 65, 6, 19, 81, 97, 7, 34, 113, 20, 50, 129, 145, 161, 8, 35, 66, 177, 193, 21, 82, 209, 240, 36, 51, 98, 114, 130, 9, 10, 22, 23, 24, 25, 26, 37, 38, 39, 40, 41, 42, 52, 53, 54, 55, 56, 57, 58, 67, 68, 69, 70, 71, 72, 73, 74, 83, 84, 85, 86, 87, 88, 89, 90, 99, 100, 101, 102, 103, 104, 105, 106, 115, 116, 117, 118, 119, 120, 121, 122, 131, 132, 133, 134, 135, 136, 137, 138, 146, 147, 148, 149, 150, 151, 152, 153, 154, 162, 163, 164, 165, 166, 167, 168, 169, 170, 178, 179, 180, 181, 182, 183, 184, 185, 186, 194, 195, 196, 197, 198, 199, 200, 201, 202, 210, 211, 212, 213, 214, 215, 216, 217, 218, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250], q = [0, 0, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0], U = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11], H = [0, 0, 2, 1, 2, 4, 4, 3, 4, 7, 5, 4, 4, 0, 1, 2, 119], W = [0, 1, 2, 3, 17, 4, 5, 33, 49, 6, 18, 65, 81, 7, 97, 113, 19, 34, 50, 129, 8, 20, 66, 145, 161, 177, 193, 9, 35, 51, 82, 240, 21, 98, 114, 209, 10, 22, 36, 52, 225, 37, 241, 23, 24, 25, 26, 38, 39, 40, 41, 42, 53, 54, 55, 56, 57, 58, 67, 68, 69, 70, 71, 72, 73, 74, 83, 84, 85, 86, 87, 88, 89, 90, 99, 100, 101, 102, 103, 104, 105, 106, 115, 116, 117, 118, 119, 120, 121, 122, 130, 131, 132, 133, 134, 135, 136, 137, 138, 146, 147, 148, 149, 150, 151, 152, 153, 154, 162, 163, 164, 165, 166, 167, 168, 169, 170, 178, 179, 180, 181, 182, 183, 184, 185, 186, 194, 195, 196, 197, 198, 199, 200, 201, 202, 210, 211, 212, 213, 214, 215, 216, 217, 218, 226, 227, 228, 229, 230, 231, 232, 233, 234, 242, 243, 244, 245, 246, 247, 248, 249, 250]; function n(e, t) { for (var i = 0, n = 0, a = new Array, s = 1; s <= 16; s++) { for (var r = 1; r <= e[s]; r++)a[t[n]] = [], a[t[n]][0] = i, a[t[n]][1] = s, n++ , i++; i *= 2 } return a } function V(e) { for (var t = e[0], i = e[1] - 1; 0 <= i;)t & 1 << i && (P |= 1 << j), i-- , --j < 0 && (255 == P ? (z(255), z(0)) : z(P), j = 7, P = 0) } function z(e) { D.push(e) } function Y(e) { z(e >> 8 & 255), z(255 & e) } function G(e, t, i, n, a) { for (var s, r = a[0], o = a[240], l = function (e, t) { var i, n, a, s, r, o, l, c, d, u, h = 0; for (d = 0; d < 8; ++d) { i = e[h], n = e[h + 1], a = e[h + 2], s = e[h + 3], r = e[h + 4], o = e[h + 5], l = e[h + 6]; var p = i + (c = e[h + 7]), f = i - c, m = n + l, g = n - l, _ = a + o, v = a - o, y = s + r, b = s - r, w = p + y, C = p - y, x = m + _, k = m - _; e[h] = w + x, e[h + 4] = w - x; var T = .707106781 * (k + C); e[h + 2] = C + T, e[h + 6] = C - T; var S = .382683433 * ((w = b + v) - (k = g + f)), $ = .5411961 * w + S, A = 1.306562965 * k + S, I = .707106781 * (x = v + g), D = f + I, P = f - I; e[h + 5] = P + $, e[h + 3] = P - $, e[h + 1] = D + A, e[h + 7] = D - A, h += 8 } for (d = h = 0; d < 8; ++d) { i = e[h], n = e[h + 8], a = e[h + 16], s = e[h + 24], r = e[h + 32], o = e[h + 40], l = e[h + 48]; var j = i + (c = e[h + 56]), L = i - c, M = n + l, R = n - l, O = a + o, E = a - o, N = s + r, B = s - r, F = j + N, q = j - N, U = M + O, H = M - O; e[h] = F + U, e[h + 32] = F - U; var W = .707106781 * (H + q); e[h + 16] = q + W, e[h + 48] = q - W; var V = .382683433 * ((F = B + E) - (H = R + L)), z = .5411961 * F + V, Y = 1.306562965 * H + V, G = .707106781 * (U = E + R), Q = L + G, J = L - G; e[h + 40] = J + z, e[h + 24] = J - z, e[h + 8] = Q + Y, e[h + 56] = Q - Y, h++ } for (d = 0; d < 64; ++d)u = e[d] * t[d], K[d] = 0 < u ? u + .5 | 0 : u - .5 | 0; return K }(e, t), c = 0; c < 64; ++c)y[b[c]] = l[c]; var d = y[0] - i; i = y[0], 0 == d ? V(n[0]) : (V(n[v[s = 32767 + d]]), V(_[s])); for (var u = 63; 0 < u && 0 == y[u]; u--); if (0 == u) return V(r), i; for (var h, p = 1; p <= u;) { for (var f = p; 0 == y[p] && p <= u; ++p); var m = p - f; if (16 <= m) { h = m >> 4; for (var g = 1; g <= h; ++g)V(o); m &= 15 } s = 32767 + y[p], V(a[(m << 4) + v[s]]), V(_[s]), p++ } return 63 != u && V(r), i } function Q(e) { if (e <= 0 && (e = 1), 100 < e && (e = 100), t != e) { (function (e) { for (var t = [16, 11, 10, 16, 24, 40, 51, 61, 12, 12, 14, 19, 26, 58, 60, 55, 14, 13, 16, 24, 40, 57, 69, 56, 14, 17, 22, 29, 51, 87, 80, 62, 18, 22, 37, 56, 68, 109, 103, 77, 24, 35, 55, 64, 81, 104, 113, 92, 49, 64, 78, 87, 103, 121, 120, 101, 72, 92, 95, 98, 112, 100, 103, 99], i = 0; i < 64; i++) { var n = u((t[i] * e + 50) / 100); n < 1 ? n = 1 : 255 < n && (n = 255), S[b[i]] = n } for (var a = [17, 18, 24, 47, 99, 99, 99, 99, 18, 21, 26, 66, 99, 99, 99, 99, 24, 26, 56, 99, 99, 99, 99, 99, 47, 66, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99], s = 0; s < 64; s++) { var r = u((a[s] * e + 50) / 100); r < 1 ? r = 1 : 255 < r && (r = 255), $[b[s]] = r } for (var o = [1, 1.387039845, 1.306562965, 1.175875602, 1, .785694958, .5411961, .275899379], l = 0, c = 0; c < 8; c++)for (var d = 0; d < 8; d++)A[l] = 1 / (S[b[l]] * o[c] * o[d] * 8), I[l] = 1 / ($[b[l]] * o[c] * o[d] * 8), l++ })(e < 50 ? Math.floor(5e3 / e) : Math.floor(200 - 2 * e)), t = e } } this.encode = function (e, t) { var i, n; (new Date).getTime(); t && Q(t), D = new Array, P = 0, j = 7, Y(65496), Y(65504), Y(16), z(74), z(70), z(73), z(70), z(0), z(1), z(1), z(0), Y(1), Y(1), z(0), z(0), function () { Y(65499), Y(132), z(0); for (var e = 0; e < 64; e++)z(S[e]); z(1); for (var t = 0; t < 64; t++)z($[t]) }(), i = e.width, n = e.height, Y(65472), Y(17), z(8), Y(n), Y(i), z(3), z(1), z(17), z(0), z(2), z(17), z(1), z(3), z(17), z(1), function () { Y(65476), Y(418), z(0); for (var e = 0; e < 16; e++)z(E[e + 1]); for (var t = 0; t <= 11; t++)z(N[t]); z(16); for (var i = 0; i < 16; i++)z(B[i + 1]); for (var n = 0; n <= 161; n++)z(F[n]); z(1); for (var a = 0; a < 16; a++)z(q[a + 1]); for (var s = 0; s <= 11; s++)z(U[s]); z(17); for (var r = 0; r < 16; r++)z(H[r + 1]); for (var o = 0; o <= 161; o++)z(W[o]) }(), Y(65498), Y(12), z(3), z(1), z(0), z(2), z(17), z(3), z(17), z(0), z(63), z(0); var a = 0, s = 0, r = 0; P = 0, j = 7, this.encode.displayName = "_encode_"; for (var o, l, c, d, u, h, p, f, m, g = e.data, _ = e.width, v = e.height, y = 4 * _, b = 0; b < v;) { for (o = 0; o < y;) { for (h = u = y * b + o, p = -1, m = f = 0; m < 64; m++)h = u + (f = m >> 3) * y + (p = 4 * (7 & m)), v <= b + f && (h -= y * (b + 1 + f - v)), y <= o + p && (h -= o + p - y + 4), l = g[h++], c = g[h++], d = g[h++], L[m] = (O[l] + O[c + 256 >> 0] + O[d + 512 >> 0] >> 16) - 128, M[m] = (O[l + 768 >> 0] + O[c + 1024 >> 0] + O[d + 1280 >> 0] >> 16) - 128, R[m] = (O[l + 1280 >> 0] + O[c + 1536 >> 0] + O[d + 1792 >> 0] >> 16) - 128; a = G(L, A, a, C, k), s = G(M, I, s, x, T), r = G(R, I, r, x, T), o += 32 } b += 8 } if (0 <= j) { var w = []; w[1] = j + 1, w[0] = (1 << j + 1) - 1, V(w) } return Y(65497), new Uint8Array(D) }, function () { (new Date).getTime(); e || (e = 50), function () { for (var e = String.fromCharCode, t = 0; t < 256; t++)i[t] = e(t) }(), C = n(E, N), x = n(q, U), k = n(B, F), T = n(H, W), function () { for (var e = 1, t = 2, i = 1; i <= 15; i++) { for (var n = e; n < t; n++)v[32767 + n] = i, _[32767 + n] = [], _[32767 + n][1] = i, _[32767 + n][0] = n; for (var a = -(t - 1); a <= -e; a++)v[32767 + a] = i, _[32767 + a] = [], _[32767 + a][1] = i, _[32767 + a][0] = t - 1 + a; e <<= 1, t <<= 1 } }(), function () { for (var e = 0; e < 256; e++)O[e] = 19595 * e, O[e + 256 >> 0] = 38470 * e, O[e + 512 >> 0] = 7471 * e + 32768, O[e + 768 >> 0] = -11059 * e, O[e + 1024 >> 0] = -21709 * e, O[e + 1280 >> 0] = 32768 * e + 8421375, O[e + 1536 >> 0] = -27439 * e, O[e + 1792 >> 0] = -5329 * e }(), Q(e), (new Date).getTime() }() } try { module.exports = we } catch (e) { } function Ce(e, t) { if (this.pos = 0, this.buffer = e, this.datav = new DataView(e.buffer), this.is_with_alpha = !!t, this.bottom_up = !0, this.flag = String.fromCharCode(this.buffer[0]) + String.fromCharCode(this.buffer[1]), this.pos += 2, -1 === ["BM", "BA", "CI", "CP", "IC", "PT"].indexOf(this.flag)) throw new Error("Invalid BMP File"); this.parseHeader(), this.parseBGR() } Ce.prototype.parseHeader = function () { if (this.fileSize = this.datav.getUint32(this.pos, !0), this.pos += 4, this.reserved = this.datav.getUint32(this.pos, !0), this.pos += 4, this.offset = this.datav.getUint32(this.pos, !0), this.pos += 4, this.headerSize = this.datav.getUint32(this.pos, !0), this.pos += 4, this.width = this.datav.getUint32(this.pos, !0), this.pos += 4, this.height = this.datav.getInt32(this.pos, !0), this.pos += 4, this.planes = this.datav.getUint16(this.pos, !0), this.pos += 2, this.bitPP = this.datav.getUint16(this.pos, !0), this.pos += 2, this.compress = this.datav.getUint32(this.pos, !0), this.pos += 4, this.rawSize = this.datav.getUint32(this.pos, !0), this.pos += 4, this.hr = this.datav.getUint32(this.pos, !0), this.pos += 4, this.vr = this.datav.getUint32(this.pos, !0), this.pos += 4, this.colors = this.datav.getUint32(this.pos, !0), this.pos += 4, this.importantColors = this.datav.getUint32(this.pos, !0), this.pos += 4, 16 === this.bitPP && this.is_with_alpha && (this.bitPP = 15), this.bitPP < 15) { var e = 0 === this.colors ? 1 << this.bitPP : this.colors; this.palette = new Array(e); for (var t = 0; t < e; t++) { var i = this.datav.getUint8(this.pos++, !0), n = this.datav.getUint8(this.pos++, !0), a = this.datav.getUint8(this.pos++, !0), s = this.datav.getUint8(this.pos++, !0); this.palette[t] = { red: a, green: n, blue: i, quad: s } } } this.height < 0 && (this.height *= -1, this.bottom_up = !1) }, Ce.prototype.parseBGR = function () { this.pos = this.offset; try { var e = "bit" + this.bitPP, t = this.width * this.height * 4; this.data = new Uint8Array(t), this[e]() } catch (e) { } }, Ce.prototype.bit1 = function () { var e = Math.ceil(this.width / 8), t = e % 4, i = 0 <= this.height ? this.height - 1 : -this.height; for (i = this.height - 1; 0 <= i; i--) { for (var n = this.bottom_up ? i : this.height - 1 - i, a = 0; a < e; a++)for (var s = this.datav.getUint8(this.pos++, !0), r = n * this.width * 4 + 8 * a * 4, o = 0; o < 8 && 8 * a + o < this.width; o++) { var l = this.palette[s >> 7 - o & 1]; this.data[r + 4 * o] = l.blue, this.data[r + 4 * o + 1] = l.green, this.data[r + 4 * o + 2] = l.red, this.data[r + 4 * o + 3] = 255 } 0 != t && (this.pos += 4 - t) } }, Ce.prototype.bit4 = function () { for (var e = Math.ceil(this.width / 2), t = e % 4, i = this.height - 1; 0 <= i; i--) { for (var n = this.bottom_up ? i : this.height - 1 - i, a = 0; a < e; a++) { var s = this.datav.getUint8(this.pos++, !0), r = n * this.width * 4 + 2 * a * 4, o = s >> 4, l = 15 & s, c = this.palette[o]; if (this.data[r] = c.blue, this.data[r + 1] = c.green, this.data[r + 2] = c.red, this.data[r + 3] = 255, 2 * a + 1 >= this.width) break; c = this.palette[l], this.data[r + 4] = c.blue, this.data[r + 4 + 1] = c.green, this.data[r + 4 + 2] = c.red, this.data[r + 4 + 3] = 255 } 0 != t && (this.pos += 4 - t) } }, Ce.prototype.bit8 = function () { for (var e = this.width % 4, t = this.height - 1; 0 <= t; t--) { for (var i = this.bottom_up ? t : this.height - 1 - t, n = 0; n < this.width; n++) { var a = this.datav.getUint8(this.pos++, !0), s = i * this.width * 4 + 4 * n; if (a < this.palette.length) { var r = this.palette[a]; this.data[s] = r.red, this.data[s + 1] = r.green, this.data[s + 2] = r.blue, this.data[s + 3] = 255 } else this.data[s] = 255, this.data[s + 1] = 255, this.data[s + 2] = 255, this.data[s + 3] = 255 } 0 != e && (this.pos += 4 - e) } }, Ce.prototype.bit15 = function () { for (var e = this.width % 3, t = parseInt("11111", 2), i = this.height - 1; 0 <= i; i--) { for (var n = this.bottom_up ? i : this.height - 1 - i, a = 0; a < this.width; a++) { var s = this.datav.getUint16(this.pos, !0); this.pos += 2; var r = (s & t) / t * 255 | 0, o = (s >> 5 & t) / t * 255 | 0, l = (s >> 10 & t) / t * 255 | 0, c = s >> 15 ? 255 : 0, d = n * this.width * 4 + 4 * a; this.data[d] = l, this.data[d + 1] = o, this.data[d + 2] = r, this.data[d + 3] = c } this.pos += e } }, Ce.prototype.bit16 = function () { for (var e = this.width % 3, t = parseInt("11111", 2), i = parseInt("111111", 2), n = this.height - 1; 0 <= n; n--) { for (var a = this.bottom_up ? n : this.height - 1 - n, s = 0; s < this.width; s++) { var r = this.datav.getUint16(this.pos, !0); this.pos += 2; var o = (r & t) / t * 255 | 0, l = (r >> 5 & i) / i * 255 | 0, c = (r >> 11) / t * 255 | 0, d = a * this.width * 4 + 4 * s; this.data[d] = c, this.data[d + 1] = l, this.data[d + 2] = o, this.data[d + 3] = 255 } this.pos += e } }, Ce.prototype.bit24 = function () { for (var e = this.height - 1; 0 <= e; e--) { for (var t = this.bottom_up ? e : this.height - 1 - e, i = 0; i < this.width; i++) { var n = this.datav.getUint8(this.pos++, !0), a = this.datav.getUint8(this.pos++, !0), s = this.datav.getUint8(this.pos++, !0), r = t * this.width * 4 + 4 * i; this.data[r] = s, this.data[r + 1] = a, this.data[r + 2] = n, this.data[r + 3] = 255 } this.pos += this.width % 4 } }, Ce.prototype.bit32 = function () { for (var e = this.height - 1; 0 <= e; e--)for (var t = this.bottom_up ? e : this.height - 1 - e, i = 0; i < this.width; i++) { var n = this.datav.getUint8(this.pos++, !0), a = this.datav.getUint8(this.pos++, !0), s = this.datav.getUint8(this.pos++, !0), r = this.datav.getUint8(this.pos++, !0), o = t * this.width * 4 + 4 * i; this.data[o] = s, this.data[o + 1] = a, this.data[o + 2] = n, this.data[o + 3] = r } }, Ce.prototype.getData = function () { return this.data }; try { module.exports = function (e) { var t = new Ce(e); return { data: t.getData(), width: t.width, height: t.height } } } catch (e) { } !function (e) { var f = 15, m = 573, t = [0, 1, 2, 3, 4, 4, 5, 5, 6, 6, 6, 6, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 13, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 14, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 15, 0, 0, 16, 17, 18, 18, 19, 19, 20, 20, 20, 20, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 23, 23, 23, 23, 23, 23, 23, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29]; function ue() { var p = this; function l(e, t) { for (var i = 0; i |= 1 & e, e >>>= 1, i <<= 1, 0 < --t;); return i >>> 1 } p.build_tree = function (e) { var t, i, n, a = p.dyn_tree, s = p.stat_desc.static_tree, r = p.stat_desc.elems, o = -1; for (e.heap_len = 0, e.heap_max = m, t = 0; t < r; t++)0 !== a[2 * t] ? (e.heap[++e.heap_len] = o = t, e.depth[t] = 0) : a[2 * t + 1] = 0; for (; e.heap_len < 2;)a[2 * (n = e.heap[++e.heap_len] = o < 2 ? ++o : 0)] = 1, e.depth[n] = 0, e.opt_len-- , s && (e.static_len -= s[2 * n + 1]); for (p.max_code = o, t = Math.floor(e.heap_len / 2); 1 <= t; t--)e.pqdownheap(a, t); for (n = r; t = e.heap[1], e.heap[1] = e.heap[e.heap_len--], e.pqdownheap(a, 1), i = e.heap[1], e.heap[--e.heap_max] = t, e.heap[--e.heap_max] = i, a[2 * n] = a[2 * t] + a[2 * i], e.depth[n] = Math.max(e.depth[t], e.depth[i]) + 1, a[2 * t + 1] = a[2 * i + 1] = n, e.heap[1] = n++ , e.pqdownheap(a, 1), 2 <= e.heap_len;); e.heap[--e.heap_max] = e.heap[1], function (e) { var t, i, n, a, s, r, o = p.dyn_tree, l = p.stat_desc.static_tree, c = p.stat_desc.extra_bits, d = p.stat_desc.extra_base, u = p.stat_desc.max_length, h = 0; for (a = 0; a <= f; a++)e.bl_count[a] = 0; for (o[2 * e.heap[e.heap_max] + 1] = 0, t = e.heap_max + 1; t < m; t++)u < (a = o[2 * o[2 * (i = e.heap[t]) + 1] + 1] + 1) && (a = u, h++), o[2 * i + 1] = a, i > p.max_code || (e.bl_count[a]++ , s = 0, d <= i && (s = c[i - d]), r = o[2 * i], e.opt_len += r * (a + s), l && (e.static_len += r * (l[2 * i + 1] + s))); if (0 !== h) { do { for (a = u - 1; 0 === e.bl_count[a];)a--; e.bl_count[a]-- , e.bl_count[a + 1] += 2, e.bl_count[u]-- , h -= 2 } while (0 < h); for (a = u; 0 !== a; a--)for (i = e.bl_count[a]; 0 !== i;)(n = e.heap[--t]) > p.max_code || (o[2 * n + 1] != a && (e.opt_len += (a - o[2 * n + 1]) * o[2 * n], o[2 * n + 1] = a), i--) } }(e), function (e, t, i) { var n, a, s, r = [], o = 0; for (n = 1; n <= f; n++)r[n] = o = o + i[n - 1] << 1; for (a = 0; a <= t; a++)0 !== (s = e[2 * a + 1]) && (e[2 * a] = l(r[s]++, s)) }(a, p.max_code, e.bl_count) } } function he(e, t, i, n, a) { this.static_tree = e, this.extra_bits = t, this.extra_base = i, this.elems = n, this.max_length = a } ue._length_code = [0, 1, 2, 3, 4, 5, 6, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 12, 12, 13, 13, 13, 13, 14, 14, 14, 14, 15, 15, 15, 15, 16, 16, 16, 16, 16, 16, 16, 16, 17, 17, 17, 17, 17, 17, 17, 17, 18, 18, 18, 18, 18, 18, 18, 18, 19, 19, 19, 19, 19, 19, 19, 19, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 22, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 28], ue.base_length = [0, 1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 16, 20, 24, 28, 32, 40, 48, 56, 64, 80, 96, 112, 128, 160, 192, 224, 0], ue.base_dist = [0, 1, 2, 3, 4, 6, 8, 12, 16, 24, 32, 48, 64, 96, 128, 192, 256, 384, 512, 768, 1024, 1536, 2048, 3072, 4096, 6144, 8192, 12288, 16384, 24576], ue.d_code = function (e) { return e < 256 ? t[e] : t[256 + (e >>> 7)] }, ue.extra_lbits = [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5, 5, 5, 0], ue.extra_dbits = [0, 0, 0, 0, 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 7, 7, 8, 8, 9, 9, 10, 10, 11, 11, 12, 12, 13, 13], ue.extra_blbits = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 3, 7], ue.bl_order = [16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15], he.static_ltree = [12, 8, 140, 8, 76, 8, 204, 8, 44, 8, 172, 8, 108, 8, 236, 8, 28, 8, 156, 8, 92, 8, 220, 8, 60, 8, 188, 8, 124, 8, 252, 8, 2, 8, 130, 8, 66, 8, 194, 8, 34, 8, 162, 8, 98, 8, 226, 8, 18, 8, 146, 8, 82, 8, 210, 8, 50, 8, 178, 8, 114, 8, 242, 8, 10, 8, 138, 8, 74, 8, 202, 8, 42, 8, 170, 8, 106, 8, 234, 8, 26, 8, 154, 8, 90, 8, 218, 8, 58, 8, 186, 8, 122, 8, 250, 8, 6, 8, 134, 8, 70, 8, 198, 8, 38, 8, 166, 8, 102, 8, 230, 8, 22, 8, 150, 8, 86, 8, 214, 8, 54, 8, 182, 8, 118, 8, 246, 8, 14, 8, 142, 8, 78, 8, 206, 8, 46, 8, 174, 8, 110, 8, 238, 8, 30, 8, 158, 8, 94, 8, 222, 8, 62, 8, 190, 8, 126, 8, 254, 8, 1, 8, 129, 8, 65, 8, 193, 8, 33, 8, 161, 8, 97, 8, 225, 8, 17, 8, 145, 8, 81, 8, 209, 8, 49, 8, 177, 8, 113, 8, 241, 8, 9, 8, 137, 8, 73, 8, 201, 8, 41, 8, 169, 8, 105, 8, 233, 8, 25, 8, 153, 8, 89, 8, 217, 8, 57, 8, 185, 8, 121, 8, 249, 8, 5, 8, 133, 8, 69, 8, 197, 8, 37, 8, 165, 8, 101, 8, 229, 8, 21, 8, 149, 8, 85, 8, 213, 8, 53, 8, 181, 8, 117, 8, 245, 8, 13, 8, 141, 8, 77, 8, 205, 8, 45, 8, 173, 8, 109, 8, 237, 8, 29, 8, 157, 8, 93, 8, 221, 8, 61, 8, 189, 8, 125, 8, 253, 8, 19, 9, 275, 9, 147, 9, 403, 9, 83, 9, 339, 9, 211, 9, 467, 9, 51, 9, 307, 9, 179, 9, 435, 9, 115, 9, 371, 9, 243, 9, 499, 9, 11, 9, 267, 9, 139, 9, 395, 9, 75, 9, 331, 9, 203, 9, 459, 9, 43, 9, 299, 9, 171, 9, 427, 9, 107, 9, 363, 9, 235, 9, 491, 9, 27, 9, 283, 9, 155, 9, 411, 9, 91, 9, 347, 9, 219, 9, 475, 9, 59, 9, 315, 9, 187, 9, 443, 9, 123, 9, 379, 9, 251, 9, 507, 9, 7, 9, 263, 9, 135, 9, 391, 9, 71, 9, 327, 9, 199, 9, 455, 9, 39, 9, 295, 9, 167, 9, 423, 9, 103, 9, 359, 9, 231, 9, 487, 9, 23, 9, 279, 9, 151, 9, 407, 9, 87, 9, 343, 9, 215, 9, 471, 9, 55, 9, 311, 9, 183, 9, 439, 9, 119, 9, 375, 9, 247, 9, 503, 9, 15, 9, 271, 9, 143, 9, 399, 9, 79, 9, 335, 9, 207, 9, 463, 9, 47, 9, 303, 9, 175, 9, 431, 9, 111, 9, 367, 9, 239, 9, 495, 9, 31, 9, 287, 9, 159, 9, 415, 9, 95, 9, 351, 9, 223, 9, 479, 9, 63, 9, 319, 9, 191, 9, 447, 9, 127, 9, 383, 9, 255, 9, 511, 9, 0, 7, 64, 7, 32, 7, 96, 7, 16, 7, 80, 7, 48, 7, 112, 7, 8, 7, 72, 7, 40, 7, 104, 7, 24, 7, 88, 7, 56, 7, 120, 7, 4, 7, 68, 7, 36, 7, 100, 7, 20, 7, 84, 7, 52, 7, 116, 7, 3, 8, 131, 8, 67, 8, 195, 8, 35, 8, 163, 8, 99, 8, 227, 8], he.static_dtree = [0, 5, 16, 5, 8, 5, 24, 5, 4, 5, 20, 5, 12, 5, 28, 5, 2, 5, 18, 5, 10, 5, 26, 5, 6, 5, 22, 5, 14, 5, 30, 5, 1, 5, 17, 5, 9, 5, 25, 5, 5, 5, 21, 5, 13, 5, 29, 5, 3, 5, 19, 5, 11, 5, 27, 5, 7, 5, 23, 5], he.static_l_desc = new he(he.static_ltree, ue.extra_lbits, 257, 286, f), he.static_d_desc = new he(he.static_dtree, ue.extra_dbits, 0, 30, f), he.static_bl_desc = new he(null, ue.extra_blbits, 0, 19, 7); function i(e, t, i, n, a) { this.good_length = e, this.max_lazy = t, this.nice_length = i, this.max_chain = n, this.func = a } var pe = [new i(0, 0, 0, 0, 0), new i(4, 4, 8, 4, 1), new i(4, 5, 16, 8, 1), new i(4, 6, 32, 32, 1), new i(4, 4, 16, 16, 2), new i(8, 16, 32, 32, 2), new i(8, 16, 128, 128, 2), new i(8, 32, 128, 256, 2), new i(32, 128, 258, 1024, 2), new i(32, 258, 258, 4096, 2)], fe = ["need dictionary", "stream end", "", "", "stream error", "data error", "", "buffer error", "", ""]; function me(e, t, i, n) { var a = e[2 * t], s = e[2 * i]; return a < s || a == s && n[t] <= n[i] } function n() { var l, c, d, u, h, p, f, m, a, g, _, v, y, r, b, w, C, x, k, T, S, $, A, I, D, P, j, L, M, R, o, O, E, N, B, F, q, s, U, H, W, V = this, z = new ue, Y = new ue, G = new ue; function Q() { var e; for (e = 0; e < 286; e++)o[2 * e] = 0; for (e = 0; e < 30; e++)O[2 * e] = 0; for (e = 0; e < 19; e++)E[2 * e] = 0; o[512] = 1, V.opt_len = V.static_len = 0, F = s = 0 } function J(e, t) { var i, n, a = -1, s = e[1], r = 0, o = 7, l = 4; for (0 === s && (o = 138, l = 3), e[2 * (t + 1) + 1] = 65535, i = 0; i <= t; i++)n = s, s = e[2 * (i + 1) + 1], ++r < o && n == s || (r < l ? E[2 * n] += r : 0 !== n ? (n != a && E[2 * n]++ , E[32]++) : r <= 10 ? E[34]++ : E[36]++ , a = n, (r = 0) === s ? (o = 138, l = 3) : n == s ? (o = 6, l = 3) : (o = 7, l = 4)) } function K(e) { V.pending_buf[V.pending++] = e } function X(e) { K(255 & e), K(e >>> 8 & 255) } function Z(e, t) { var i, n = t; 16 - n < W ? (X(H |= (i = e) << W & 65535), H = i >>> 16 - W, W += n - 16) : (H |= e << W & 65535, W += n) } function ee(e, t) { var i = 2 * e; Z(65535 & t[i], 65535 & t[i + 1]) } function te(e, t) { var i, n, a = -1, s = e[1], r = 0, o = 7, l = 4; for (0 === s && (o = 138, l = 3), i = 0; i <= t; i++)if (n = s, s = e[2 * (i + 1) + 1], !(++r < o && n == s)) { if (r < l) for (; ee(n, E), 0 != --r;); else 0 !== n ? (n != a && (ee(n, E), r--), ee(16, E), Z(r - 3, 2)) : r <= 10 ? (ee(17, E), Z(r - 3, 3)) : (ee(18, E), Z(r - 11, 7)); a = n, (r = 0) === s ? (o = 138, l = 3) : n == s ? (o = 6, l = 3) : (o = 7, l = 4) } } function ie() { 16 == W ? (X(H), W = H = 0) : 8 <= W && (K(255 & H), H >>>= 8, W -= 8) } function ne(e, t) { var i, n, a; if (V.pending_buf[q + 2 * F] = e >>> 8 & 255, V.pending_buf[q + 2 * F + 1] = 255 & e, V.pending_buf[N + F] = 255 & t, F++ , 0 === e ? o[2 * t]++ : (s++ , e-- , o[2 * (ue._length_code[t] + 256 + 1)]++ , O[2 * ue.d_code(e)]++), 0 == (8191 & F) && 2 < j) { for (i = 8 * F, n = S - C, a = 0; a < 30; a++)i += O[2 * a] * (5 + ue.extra_dbits[a]); if (i >>>= 3, s < Math.floor(F / 2) && i < Math.floor(n / 2)) return !0 } return F == B - 1 } function ae(e, t) { var i, n, a, s, r = 0; if (0 !== F) for (; i = V.pending_buf[q + 2 * r] << 8 & 65280 | 255 & V.pending_buf[q + 2 * r + 1], n = 255 & V.pending_buf[N + r], r++ , 0 === i ? ee(n, e) : (ee((a = ue._length_code[n]) + 256 + 1, e), 0 !== (s = ue.extra_lbits[a]) && Z(n -= ue.base_length[a], s), ee(a = ue.d_code(--i), t), 0 !== (s = ue.extra_dbits[a]) && Z(i -= ue.base_dist[a], s)), r < F;); ee(256, e), U = e[513] } function se() { 8 < W ? X(H) : 0 < W && K(255 & H), W = H = 0 } function re(e, t, i) { var n, a, s; Z(0 + (i ? 1 : 0), 3), n = e, a = t, s = !0, se(), U = 8, s && (X(a), X(~a)), V.pending_buf.set(m.subarray(n, n + a), V.pending), V.pending += a } function t(e, t, i) { var n, a, s = 0; 0 < j ? (z.build_tree(V), Y.build_tree(V), s = function () { var e; for (J(o, z.max_code), J(O, Y.max_code), G.build_tree(V), e = 18; 3 <= e && 0 === E[2 * ue.bl_order[e] + 1]; e--); return V.opt_len += 3 * (e + 1) + 5 + 5 + 4, e }(), n = V.opt_len + 3 + 7 >>> 3, (a = V.static_len + 3 + 7 >>> 3) <= n && (n = a)) : n = a = t + 5, t + 4 <= n && -1 != e ? re(e, t, i) : a == n ? (Z(2 + (i ? 1 : 0), 3), ae(he.static_ltree, he.static_dtree)) : (Z(4 + (i ? 1 : 0), 3), function (e, t, i) { var n; for (Z(e - 257, 5), Z(t - 1, 5), Z(i - 4, 4), n = 0; n < i; n++)Z(E[2 * ue.bl_order[n] + 1], 3); te(o, e - 1), te(O, t - 1) }(z.max_code + 1, Y.max_code + 1, s + 1), ae(o, O)), Q(), i && se() } function oe(e) { t(0 <= C ? C : -1, S - C, e), C = S, l.flush_pending() } function le() { var e, t, i, n; do { if (0 === (n = a - A - S) && 0 === S && 0 === A) n = h; else if (-1 == n) n--; else if (h + h - 262 <= S) { for (m.set(m.subarray(h, h + h), 0), $ -= h, S -= h, C -= h, i = e = y; t = 65535 & _[--i], _[i] = h <= t ? t - h : 0, 0 != --e;); for (i = e = h; t = 65535 & g[--i], g[i] = h <= t ? t - h : 0, 0 != --e;); n += h } if (0 === l.avail_in) return; e = l.read_buf(m, S + A, n), 3 <= (A += e) && (v = ((v = 255 & m[S]) << w ^ 255 & m[S + 1]) & b) } while (A < 262 && 0 !== l.avail_in) } function ce(e) { var t, i, n = D, a = S, s = I, r = h - 262 < S ? S - (h - 262) : 0, o = R, l = f, c = S + 258, d = m[a + s - 1], u = m[a + s]; M <= I && (n >>= 2), A < o && (o = A); do { if (m[(t = e) + s] == u && m[t + s - 1] == d && m[t] == m[a] && m[++t] == m[a + 1]) { a += 2, t++; do { } while (m[++a] == m[++t] && m[++a] == m[++t] && m[++a] == m[++t] && m[++a] == m[++t] && m[++a] == m[++t] && m[++a] == m[++t] && m[++a] == m[++t] && m[++a] == m[++t] && a < c); if (i = 258 - (c - a), a = c - 258, s < i) { if ($ = e, o <= (s = i)) break; d = m[a + s - 1], u = m[a + s] } } } while ((e = 65535 & g[e & l]) > r && 0 != --n); return s <= A ? s : A } function de(e) { return e.total_in = e.total_out = 0, e.msg = null, V.pending = 0, V.pending_out = 0, c = 113, u = 0, z.dyn_tree = o, z.stat_desc = he.static_l_desc, Y.dyn_tree = O, Y.stat_desc = he.static_d_desc, G.dyn_tree = E, G.stat_desc = he.static_bl_desc, W = H = 0, U = 8, Q(), function () { var e; for (a = 2 * h, e = _[y - 1] = 0; e < y - 1; e++)_[e] = 0; P = pe[j].max_lazy, M = pe[j].good_length, R = pe[j].nice_length, D = pe[j].max_chain, x = I = 2, v = T = A = C = S = 0 }(), 0 } V.depth = [], V.bl_count = [], V.heap = [], o = [], O = [], E = [], V.pqdownheap = function (e, t) { for (var i = V.heap, n = i[t], a = t << 1; a <= V.heap_len && (a < V.heap_len && me(e, i[a + 1], i[a], V.depth) && a++ , !me(e, n, i[a], V.depth));)i[t] = i[a], t = a, a <<= 1; i[t] = n }, V.deflateInit = function (e, t, i, n, a, s) { return n || (n = 8), a || (a = 8), s || (s = 0), e.msg = null, -1 == t && (t = 6), a < 1 || 9 < a || 8 != n || i < 9 || 15 < i || t < 0 || 9 < t || s < 0 || 2 < s ? -2 : (e.dstate = V, f = (h = 1 << (p = i)) - 1, b = (y = 1 << (r = a + 7)) - 1, w = Math.floor((r + 3 - 1) / 3), m = new Uint8Array(2 * h), g = [], _ = [], B = 1 << a + 6, V.pending_buf = new Uint8Array(4 * B), d = 4 * B, q = Math.floor(B / 2), N = 3 * B, j = t, L = s, de(e)) }, V.deflateEnd = function () { return 42 != c && 113 != c && 666 != c ? -2 : (V.pending_buf = null, m = g = _ = null, V.dstate = null, 113 == c ? -3 : 0) }, V.deflateParams = function (e, t, i) { var n = 0; return -1 == t && (t = 6), t < 0 || 9 < t || i < 0 || 2 < i ? -2 : (pe[j].func != pe[t].func && 0 !== e.total_in && (n = e.deflate(1)), j != t && (P = pe[j = t].max_lazy, M = pe[j].good_length, R = pe[j].nice_length, D = pe[j].max_chain), L = i, n) }, V.deflateSetDictionary = function (e, t, i) { var n, a = i, s = 0; if (!t || 42 != c) return -2; if (a < 3) return 0; for (h - 262 < a && (s = i - (a = h - 262)), m.set(t.subarray(s, s + a), 0), C = S = a, v = ((v = 255 & m[0]) << w ^ 255 & m[1]) & b, n = 0; n <= a - 3; n++)v = (v << w ^ 255 & m[n + 2]) & b, g[n & f] = _[v], _[v] = n; return 0 }, V.deflate = function (e, t) { var i, n, a, s, r, o; if (4 < t || t < 0) return -2; if (!e.next_out || !e.next_in && 0 !== e.avail_in || 666 == c && 4 != t) return e.msg = fe[4], -2; if (0 === e.avail_out) return e.msg = fe[7], -5; if (l = e, s = u, u = t, 42 == c && (n = 8 + (p - 8 << 4) << 8, 3 < (a = (j - 1 & 255) >> 1) && (a = 3), n |= a << 6, 0 !== S && (n |= 32), c = 113, K((o = n += 31 - n % 31) >> 8 & 255), K(255 & o)), 0 !== V.pending) { if (l.flush_pending(), 0 === l.avail_out) return u = -1, 0 } else if (0 === l.avail_in && t <= s && 4 != t) return l.msg = fe[7], -5; if (666 == c && 0 !== l.avail_in) return e.msg = fe[7], -5; if (0 !== l.avail_in || 0 !== A || 0 != t && 666 != c) { switch (r = -1, pe[j].func) { case 0: r = function (e) { var t, i = 65535; for (d - 5 < i && (i = d - 5); ;) { if (A <= 1) { if (le(), 0 === A && 0 == e) return 0; if (0 === A) break } if (S += A, t = C + i, ((A = 0) === S || t <= S) && (A = S - t, S = t, oe(!1), 0 === l.avail_out)) return 0; if (h - 262 <= S - C && (oe(!1), 0 === l.avail_out)) return 0 } return oe(4 == e), 0 === l.avail_out ? 4 == e ? 2 : 0 : 4 == e ? 3 : 1 }(t); break; case 1: r = function (e) { for (var t, i = 0; ;) { if (A < 262) { if (le(), A < 262 && 0 == e) return 0; if (0 === A) break } if (3 <= A && (v = (v << w ^ 255 & m[S + 2]) & b, i = 65535 & _[v], g[S & f] = _[v], _[v] = S), 0 !== i && (S - i & 65535) <= h - 262 && 2 != L && (x = ce(i)), 3 <= x) if (t = ne(S - $, x - 3), A -= x, x <= P && 3 <= A) { for (x--; v = (v << w ^ 255 & m[++S + 2]) & b, i = 65535 & _[v], g[S & f] = _[v], _[v] = S, 0 != --x;); S++ } else S += x, x = 0, v = ((v = 255 & m[S]) << w ^ 255 & m[S + 1]) & b; else t = ne(0, 255 & m[S]), A-- , S++; if (t && (oe(!1), 0 === l.avail_out)) return 0 } return oe(4 == e), 0 === l.avail_out ? 4 == e ? 2 : 0 : 4 == e ? 3 : 1 }(t); break; case 2: r = function (e) { for (var t, i, n = 0; ;) { if (A < 262) { if (le(), A < 262 && 0 == e) return 0; if (0 === A) break } if (3 <= A && (v = (v << w ^ 255 & m[S + 2]) & b, n = 65535 & _[v], g[S & f] = _[v], _[v] = S), I = x, k = $, x = 2, 0 !== n && I < P && (S - n & 65535) <= h - 262 && (2 != L && (x = ce(n)), x <= 5 && (1 == L || 3 == x && 4096 < S - $) && (x = 2)), 3 <= I && x <= I) { for (i = S + A - 3, t = ne(S - 1 - k, I - 3), A -= I - 1, I -= 2; ++S <= i && (v = (v << w ^ 255 & m[S + 2]) & b, n = 65535 & _[v], g[S & f] = _[v], _[v] = S), 0 != --I;); if (T = 0, x = 2, S++ , t && (oe(!1), 0 === l.avail_out)) return 0 } else if (0 !== T) { if ((t = ne(0, 255 & m[S - 1])) && oe(!1), S++ , A-- , 0 === l.avail_out) return 0 } else T = 1, S++ , A-- } return 0 !== T && (t = ne(0, 255 & m[S - 1]), T = 0), oe(4 == e), 0 === l.avail_out ? 4 == e ? 2 : 0 : 4 == e ? 3 : 1 }(t) }if (2 != r && 3 != r || (c = 666), 0 == r || 2 == r) return 0 === l.avail_out && (u = -1), 0; if (1 == r) { if (1 == t) Z(2, 3), ee(256, he.static_ltree), ie(), 1 + U + 10 - W < 9 && (Z(2, 3), ee(256, he.static_ltree), ie()), U = 7; else if (re(0, 0, !1), 3 == t) for (i = 0; i < y; i++)_[i] = 0; if (l.flush_pending(), 0 === l.avail_out) return u = -1, 0 } } return 4 != t ? 0 : 1 } } function a() { this.next_in_index = 0, this.next_out_index = 0, this.avail_in = 0, this.total_in = 0, this.avail_out = 0, this.total_out = 0 } a.prototype = { deflateInit: function (e, t) { return this.dstate = new n, t || (t = f), this.dstate.deflateInit(this, e, t) }, deflate: function (e) { return this.dstate ? this.dstate.deflate(this, e) : -2 }, deflateEnd: function () { if (!this.dstate) return -2; var e = this.dstate.deflateEnd(); return this.dstate = null, e }, deflateParams: function (e, t) { return this.dstate ? this.dstate.deflateParams(this, e, t) : -2 }, deflateSetDictionary: function (e, t) { return this.dstate ? this.dstate.deflateSetDictionary(this, e, t) : -2 }, read_buf: function (e, t, i) { var n = this.avail_in; return i < n && (n = i), 0 === n ? 0 : (this.avail_in -= n, e.set(this.next_in.subarray(this.next_in_index, this.next_in_index + n), t), this.next_in_index += n, this.total_in += n, n) }, flush_pending: function () { var e = this, t = e.dstate.pending; t > e.avail_out && (t = e.avail_out), 0 !== t && (e.next_out.set(e.dstate.pending_buf.subarray(e.dstate.pending_out, e.dstate.pending_out + t), e.next_out_index), e.next_out_index += t, e.dstate.pending_out += t, e.total_out += t, e.avail_out -= t, e.dstate.pending -= t, 0 === e.dstate.pending && (e.dstate.pending_out = 0)) } }; var s = e.zip || e; s.Deflater = s._jzlib_Deflater = function (e) { var o = new a, l = new Uint8Array(512), t = e ? e.level : -1; void 0 === t && (t = -1), o.deflateInit(t), o.next_out = l, this.append = function (e, t) { var i, n = [], a = 0, s = 0, r = 0; if (e.length) { o.next_in_index = 0, o.next_in = e, o.avail_in = e.length; do { if (o.next_out_index = 0, o.avail_out = 512, 0 != o.deflate(0)) throw new Error("deflating: " + o.msg); o.next_out_index && (512 == o.next_out_index ? n.push(new Uint8Array(l)) : n.push(new Uint8Array(l.subarray(0, o.next_out_index)))), r += o.next_out_index, t && 0 < o.next_in_index && o.next_in_index != a && (t(o.next_in_index), a = o.next_in_index) } while (0 < o.avail_in || 0 === o.avail_out); return i = new Uint8Array(r), n.forEach(function (e) { i.set(e, s), s += e.length }), i } }, this.flush = function () { var e, t, i = [], n = 0, a = 0; do { if (o.next_out_index = 0, o.avail_out = 512, 1 != (e = o.deflate(4)) && 0 != e) throw new Error("deflating: " + o.msg); 0 < 512 - o.avail_out && i.push(new Uint8Array(l.subarray(0, o.next_out_index))), a += o.next_out_index } while (0 < o.avail_in || 0 === o.avail_out); return o.deflateEnd(), t = new Uint8Array(a), i.forEach(function (e) { t.set(e, n), n += e.length }), t } } }("undefined" != typeof self && self || "undefined" != typeof window && window || "undefined" != typeof global && global || Function('return typeof this === "object" && this.content')() || Function("return this")()), function (e) { function h(e) { var t; this.ok = !1, "#" == e.charAt(0) && (e = e.substr(1, 6)), e = (e = e.replace(/ /g, "")).toLowerCase(); var d = { aliceblue: "f0f8ff", antiquewhite: "faebd7", aqua: "00ffff", aquamarine: "7fffd4", azure: "f0ffff", beige: "f5f5dc", bisque: "ffe4c4", black: "000000", blanchedalmond: "ffebcd", blue: "0000ff", blueviolet: "8a2be2", brown: "a52a2a", burlywood: "deb887", cadetblue: "5f9ea0", chartreuse: "7fff00", chocolate: "d2691e", coral: "ff7f50", cornflowerblue: "6495ed", cornsilk: "fff8dc", crimson: "dc143c", cyan: "00ffff", darkblue: "00008b", darkcyan: "008b8b", darkgoldenrod: "b8860b", darkgray: "a9a9a9", darkgreen: "006400", darkkhaki: "bdb76b", darkmagenta: "8b008b", darkolivegreen: "556b2f", darkorange: "ff8c00", darkorchid: "9932cc", darkred: "8b0000", darksalmon: "e9967a", darkseagreen: "8fbc8f", darkslateblue: "483d8b", darkslategray: "2f4f4f", darkturquoise: "00ced1", darkviolet: "9400d3", deeppink: "ff1493", deepskyblue: "00bfff", dimgray: "696969", dodgerblue: "1e90ff", feldspar: "d19275", firebrick: "b22222", floralwhite: "fffaf0", forestgreen: "228b22", fuchsia: "ff00ff", gainsboro: "dcdcdc", ghostwhite: "f8f8ff", gold: "ffd700", goldenrod: "daa520", gray: "808080", green: "008000", greenyellow: "adff2f", honeydew: "f0fff0", hotpink: "ff69b4", indianred: "cd5c5c", indigo: "4b0082", ivory: "fffff0", khaki: "f0e68c", lavender: "e6e6fa", lavenderblush: "fff0f5", lawngreen: "7cfc00", lemonchiffon: "fffacd", lightblue: "add8e6", lightcoral: "f08080", lightcyan: "e0ffff", lightgoldenrodyellow: "fafad2", lightgrey: "d3d3d3", lightgreen: "90ee90", lightpink: "ffb6c1", lightsalmon: "ffa07a", lightseagreen: "20b2aa", lightskyblue: "87cefa", lightslateblue: "8470ff", lightslategray: "778899", lightsteelblue: "b0c4de", lightyellow: "ffffe0", lime: "00ff00", limegreen: "32cd32", linen: "faf0e6", magenta: "ff00ff", maroon: "800000", mediumaquamarine: "66cdaa", mediumblue: "0000cd", mediumorchid: "ba55d3", mediumpurple: "9370d8", mediumseagreen: "3cb371", mediumslateblue: "7b68ee", mediumspringgreen: "00fa9a", mediumturquoise: "48d1cc", mediumvioletred: "c71585", midnightblue: "191970", mintcream: "f5fffa", mistyrose: "ffe4e1", moccasin: "ffe4b5", navajowhite: "ffdead", navy: "000080", oldlace: "fdf5e6", olive: "808000", olivedrab: "6b8e23", orange: "ffa500", orangered: "ff4500", orchid: "da70d6", palegoldenrod: "eee8aa", palegreen: "98fb98", paleturquoise: "afeeee", palevioletred: "d87093", papayawhip: "ffefd5", peachpuff: "ffdab9", peru: "cd853f", pink: "ffc0cb", plum: "dda0dd", powderblue: "b0e0e6", purple: "800080", red: "ff0000", rosybrown: "bc8f8f", royalblue: "4169e1", saddlebrown: "8b4513", salmon: "fa8072", sandybrown: "f4a460", seagreen: "2e8b57", seashell: "fff5ee", sienna: "a0522d", silver: "c0c0c0", skyblue: "87ceeb", slateblue: "6a5acd", slategray: "708090", snow: "fffafa", springgreen: "00ff7f", steelblue: "4682b4", tan: "d2b48c", teal: "008080", thistle: "d8bfd8", tomato: "ff6347", turquoise: "40e0d0", violet: "ee82ee", violetred: "d02090", wheat: "f5deb3", white: "ffffff", whitesmoke: "f5f5f5", yellow: "ffff00", yellowgreen: "9acd32" }; for (var i in d) e == i && (e = d[i]); for (var u = [{ re: /^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/, example: ["rgb(123, 234, 45)", "rgb(255,234,245)"], process: function (e) { return [parseInt(e[1]), parseInt(e[2]), parseInt(e[3])] } }, { re: /^(\w{2})(\w{2})(\w{2})$/, example: ["#00ff00", "336699"], process: function (e) { return [parseInt(e[1], 16), parseInt(e[2], 16), parseInt(e[3], 16)] } }, { re: /^(\w{1})(\w{1})(\w{1})$/, example: ["#fb0", "f0f"], process: function (e) { return [parseInt(e[1] + e[1], 16), parseInt(e[2] + e[2], 16), parseInt(e[3] + e[3], 16)] } }], n = 0; n < u.length; n++) { var a = u[n].re, s = u[n].process, r = a.exec(e); r && (t = s(r), this.r = t[0], this.g = t[1], this.b = t[2], this.ok = !0) } this.r = this.r < 0 || isNaN(this.r) ? 0 : 255 < this.r ? 255 : this.r, this.g = this.g < 0 || isNaN(this.g) ? 0 : 255 < this.g ? 255 : this.g, this.b = this.b < 0 || isNaN(this.b) ? 0 : 255 < this.b ? 255 : this.b, this.toRGB = function () { return "rgb(" + this.r + ", " + this.g + ", " + this.b + ")" }, this.toHex = function () { var e = this.r.toString(16), t = this.g.toString(16), i = this.b.toString(16); return 1 == e.length && (e = "0" + e), 1 == t.length && (t = "0" + t), 1 == i.length && (i = "0" + i), "#" + e + t + i }, this.getHelpXML = function () { for (var e = new Array, t = 0; t < u.length; t++)for (var i = u[t].example, n = 0; n < i.length; n++)e[e.length] = i[n]; for (var a in d) e[e.length] = a; var s = document.createElement("ul"); s.setAttribute("id", "rgbcolor-examples"); for (t = 0; t < e.length; t++)try { var r = document.createElement("li"), o = new h(e[t]), l = document.createElement("div"); l.style.cssText = "margin: 3px; border: 1px solid black; background:" + o.toHex() + "; color:" + o.toHex(), l.appendChild(document.createTextNode("test")); var c = document.createTextNode(" " + e[t] + " -> " + o.toRGB() + " -> " + o.toHex()); r.appendChild(l), r.appendChild(c), s.appendChild(r) } catch (e) { } return s } } "undefined" != typeof define && define.amd ? define("RGBColor", function () { return h }) : "undefined" != typeof module && module.exports && (module.exports = h), e.RGBColor = h }("undefined" != typeof self && self || "undefined" != typeof window && window || "undefined" != typeof global && global || Function('return typeof this === "object" && this.content')() || Function("return this")()), pe = function () { return function s(r, o, l) { function c(i, e) { if (!o[i]) { if (!r[i]) { var t = "function" == typeof require && require; if (!e && t) return t(i, !0); if (d) return d(i, !0); var n = new Error("Cannot find module '" + i + "'"); throw n.code = "MODULE_NOT_FOUND", n } var a = o[i] = { exports: {} }; r[i][0].call(a.exports, function (e) { var t = r[i][1][e]; return c(t || e) }, a, a.exports, s, r, o, l) } return o[i].exports } for (var d = "function" == typeof require && require, e = 0; e < l.length; e++)c(l[e]); return c }({ 1: [function (e, j, L) { (function (P) { !function (e) { var t = "object" == typeof L && L, i = "object" == typeof j && j && j.exports == t && j, n = "object" == typeof P && P; n.global !== n && n.window !== n || (e = n); var a, s, _ = 2147483647, v = 36, y = 1, b = 26, r = 38, o = 700, w = 72, C = 128, x = "-", l = /^xn--/, c = /[^ -~]/, d = /\x2E|\u3002|\uFF0E|\uFF61/g, u = { overflow: "Overflow: input needs wider integers to process", "not-basic": "Illegal input >= 0x80 (not a basic code point)", "invalid-input": "Invalid input" }, h = v - y, k = Math.floor, T = String.fromCharCode; function S(e) { throw RangeError(u[e]) } function p(e, t) { for (var i = e.length; i--;)e[i] = t(e[i]); return e } function f(e, t) { return p(e.split(d), t).join(".") } function $(e) { for (var t, i, n = [], a = 0, s = e.length; a < s;)55296 <= (t = e.charCodeAt(a++)) && t <= 56319 && a < s ? 56320 == (64512 & (i = e.charCodeAt(a++))) ? n.push(((1023 & t) << 10) + (1023 & i) + 65536) : (n.push(t), a--) : n.push(t); return n } function A(e) { return p(e, function (e) { var t = ""; return 65535 < e && (t += T((e -= 65536) >>> 10 & 1023 | 55296), e = 56320 | 1023 & e), t += T(e) }).join("") } function I(e, t) { return e + 22 + 75 * (e < 26) - ((0 != t) << 5) } function D(e, t, i) { var n = 0; for (e = i ? k(e / o) : e >> 1, e += k(e / t); h * b >> 1 < e; n += v)e = k(e / h); return k(n + (h + 1) * e / (e + r)) } function m(e) { var t, i, n, a, s, r, o, l, c, d, u, h = [], p = e.length, f = 0, m = C, g = w; for ((i = e.lastIndexOf(x)) < 0 && (i = 0), n = 0; n < i; ++n)128 <= e.charCodeAt(n) && S("not-basic"), h.push(e.charCodeAt(n)); for (a = 0 < i ? i + 1 : 0; a < p;) { for (s = f, r = 1, o = v; p <= a && S("invalid-input"), u = e.charCodeAt(a++), (v <= (l = u - 48 < 10 ? u - 22 : u - 65 < 26 ? u - 65 : u - 97 < 26 ? u - 97 : v) || l > k((_ - f) / r)) && S("overflow"), f += l * r, !(l < (c = o <= g ? y : g + b <= o ? b : o - g)); o += v)r > k(_ / (d = v - c)) && S("overflow"), r *= d; g = D(f - s, t = h.length + 1, 0 == s), k(f / t) > _ - m && S("overflow"), m += k(f / t), f %= t, h.splice(f++, 0, m) } return A(h) } function g(e) { var t, i, n, a, s, r, o, l, c, d, u, h, p, f, m, g = []; for (h = (e = $(e)).length, t = C, s = w, r = i = 0; r < h; ++r)(u = e[r]) < 128 && g.push(T(u)); for (n = a = g.length, a && g.push(x); n < h;) { for (o = _, r = 0; r < h; ++r)t <= (u = e[r]) && u < o && (o = u); for (o - t > k((_ - i) / (p = n + 1)) && S("overflow"), i += (o - t) * p, t = o, r = 0; r < h; ++r)if ((u = e[r]) < t && ++i > _ && S("overflow"), u == t) { for (l = i, c = v; !(l < (d = c <= s ? y : s + b <= c ? b : c - s)); c += v)m = l - d, f = v - d, g.push(T(I(d + m % f, 0))), l = k(m / f); g.push(T(I(l, 0))), s = D(i, p, n == a), i = 0, ++n } ++i, ++t } return g.join("") } if (a = { version: "1.2.4", ucs2: { decode: $, encode: A }, decode: m, encode: g, toASCII: function (e) { return f(e, function (e) { return c.test(e) ? "xn--" + g(e) : e }) }, toUnicode: function (e) { return f(e, function (e) { return l.test(e) ? m(e.slice(4).toLowerCase()) : e }) } }, t && !t.nodeType) if (i) i.exports = a; else for (s in a) a.hasOwnProperty(s) && (t[s] = a[s]); else e.punycode = a }(this) }).call(this, "undefined" != typeof global ? global : "undefined" != typeof self ? self : "undefined" != typeof window ? window : {}) }, {}], 2: [function (e, t, i) { var a = e("./log"); function u(e, t) { for (var i = 3 === e.nodeType ? document.createTextNode(e.nodeValue) : e.cloneNode(!1), n = e.firstChild; n;)!0 !== t && 1 === n.nodeType && "SCRIPT" === n.nodeName || i.appendChild(u(n, t)), n = n.nextSibling; return 1 === e.nodeType && (i._scrollTop = e.scrollTop, i._scrollLeft = e.scrollLeft, "CANVAS" === e.nodeName ? function (t, e) { try { e && (e.width = t.width, e.height = t.height, e.getContext("2d").putImageData(t.getContext("2d").getImageData(0, 0, t.width, t.height), 0, 0)) } catch (e) { a("Unable to copy canvas content from", t, e) } }(e, i) : "TEXTAREA" !== e.nodeName && "SELECT" !== e.nodeName || (i.value = e.value)), i } t.exports = function (s, e, t, i, r, o, l) { var c = u(s.documentElement, r.javascriptEnabled), d = e.createElement("iframe"); return d.className = "html2canvas-container", d.style.visibility = "hidden", d.style.position = "fixed", d.style.left = "-10000px", d.style.top = "0px", d.style.border = "0", d.width = t, d.height = i, d.scrolling = "no", e.body.appendChild(d), new Promise(function (t) { var e, i, n, a = d.contentWindow.document; d.contentWindow.onload = d.onload = function () { var e = setInterval(function () { 0 < a.body.childNodes.length && (!function e(t) { if (1 === t.nodeType) { t.scrollTop = t._scrollTop, t.scrollLeft = t._scrollLeft; for (var i = t.firstChild; i;)e(i), i = i.nextSibling } }(a.documentElement), clearInterval(e), "view" === r.type && (d.contentWindow.scrollTo(o, l), !/(iPad|iPhone|iPod)/g.test(navigator.userAgent) || d.contentWindow.scrollY === l && d.contentWindow.scrollX === o || (a.documentElement.style.top = -l + "px", a.documentElement.style.left = -o + "px", a.documentElement.style.position = "absolute")), t(d)) }, 50) }, a.open(), a.write("<!DOCTYPE html><html></html>"), i = o, n = l, !(e = s).defaultView || i === e.defaultView.pageXOffset && n === e.defaultView.pageYOffset || e.defaultView.scrollTo(i, n), a.replaceChild(a.adoptNode(c), a.documentElement), a.close() }) } }, { "./log": 13 }], 3: [function (e, t, i) { function n(e) { this.r = 0, this.g = 0, this.b = 0, this.a = null; this.fromArray(e) || this.namedColor(e) || this.rgb(e) || this.rgba(e) || this.hex6(e) || this.hex3(e) } n.prototype.darken = function (e) { var t = 1 - e; return new n([Math.round(this.r * t), Math.round(this.g * t), Math.round(this.b * t), this.a]) }, n.prototype.isTransparent = function () { return 0 === this.a }, n.prototype.isBlack = function () { return 0 === this.r && 0 === this.g && 0 === this.b }, n.prototype.fromArray = function (e) { return Array.isArray(e) && (this.r = Math.min(e[0], 255), this.g = Math.min(e[1], 255), this.b = Math.min(e[2], 255), 3 < e.length && (this.a = e[3])), Array.isArray(e) }; var a = /^#([a-f0-9]{3})$/i; n.prototype.hex3 = function (e) { var t; return null !== (t = e.match(a)) && (this.r = parseInt(t[1][0] + t[1][0], 16), this.g = parseInt(t[1][1] + t[1][1], 16), this.b = parseInt(t[1][2] + t[1][2], 16)), null !== t }; var s = /^#([a-f0-9]{6})$/i; n.prototype.hex6 = function (e) { var t = null; return null !== (t = e.match(s)) && (this.r = parseInt(t[1].substring(0, 2), 16), this.g = parseInt(t[1].substring(2, 4), 16), this.b = parseInt(t[1].substring(4, 6), 16)), null !== t }; var r = /^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/; n.prototype.rgb = function (e) { var t; return null !== (t = e.match(r)) && (this.r = Number(t[1]), this.g = Number(t[2]), this.b = Number(t[3])), null !== t }; var o = /^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d?\.?\d+)\s*\)$/; n.prototype.rgba = function (e) { var t; return null !== (t = e.match(o)) && (this.r = Number(t[1]), this.g = Number(t[2]), this.b = Number(t[3]), this.a = Number(t[4])), null !== t }, n.prototype.toString = function () { return null !== this.a && 1 !== this.a ? "rgba(" + [this.r, this.g, this.b, this.a].join(",") + ")" : "rgb(" + [this.r, this.g, this.b].join(",") + ")" }, n.prototype.namedColor = function (e) { e = e.toLowerCase(); var t = l[e]; if (t) this.r = t[0], this.g = t[1], this.b = t[2]; else if ("transparent" === e) return this.r = this.g = this.b = this.a = 0, !0; return !!t }, n.prototype.isColor = !0; var l = { aliceblue: [240, 248, 255], antiquewhite: [250, 235, 215], aqua: [0, 255, 255], aquamarine: [127, 255, 212], azure: [240, 255, 255], beige: [245, 245, 220], bisque: [255, 228, 196], black: [0, 0, 0], blanchedalmond: [255, 235, 205], blue: [0, 0, 255], blueviolet: [138, 43, 226], brown: [165, 42, 42], burlywood: [222, 184, 135], cadetblue: [95, 158, 160], chartreuse: [127, 255, 0], chocolate: [210, 105, 30], coral: [255, 127, 80], cornflowerblue: [100, 149, 237], cornsilk: [255, 248, 220], crimson: [220, 20, 60], cyan: [0, 255, 255], darkblue: [0, 0, 139], darkcyan: [0, 139, 139], darkgoldenrod: [184, 134, 11], darkgray: [169, 169, 169], darkgreen: [0, 100, 0], darkgrey: [169, 169, 169], darkkhaki: [189, 183, 107], darkmagenta: [139, 0, 139], darkolivegreen: [85, 107, 47], darkorange: [255, 140, 0], darkorchid: [153, 50, 204], darkred: [139, 0, 0], darksalmon: [233, 150, 122], darkseagreen: [143, 188, 143], darkslateblue: [72, 61, 139], darkslategray: [47, 79, 79], darkslategrey: [47, 79, 79], darkturquoise: [0, 206, 209], darkviolet: [148, 0, 211], deeppink: [255, 20, 147], deepskyblue: [0, 191, 255], dimgray: [105, 105, 105], dimgrey: [105, 105, 105], dodgerblue: [30, 144, 255], firebrick: [178, 34, 34], floralwhite: [255, 250, 240], forestgreen: [34, 139, 34], fuchsia: [255, 0, 255], gainsboro: [220, 220, 220], ghostwhite: [248, 248, 255], gold: [255, 215, 0], goldenrod: [218, 165, 32], gray: [128, 128, 128], green: [0, 128, 0], greenyellow: [173, 255, 47], grey: [128, 128, 128], honeydew: [240, 255, 240], hotpink: [255, 105, 180], indianred: [205, 92, 92], indigo: [75, 0, 130], ivory: [255, 255, 240], khaki: [240, 230, 140], lavender: [230, 230, 250], lavenderblush: [255, 240, 245], lawngreen: [124, 252, 0], lemonchiffon: [255, 250, 205], lightblue: [173, 216, 230], lightcoral: [240, 128, 128], lightcyan: [224, 255, 255], lightgoldenrodyellow: [250, 250, 210], lightgray: [211, 211, 211], lightgreen: [144, 238, 144], lightgrey: [211, 211, 211], lightpink: [255, 182, 193], lightsalmon: [255, 160, 122], lightseagreen: [32, 178, 170], lightskyblue: [135, 206, 250], lightslategray: [119, 136, 153], lightslategrey: [119, 136, 153], lightsteelblue: [176, 196, 222], lightyellow: [255, 255, 224], lime: [0, 255, 0], limegreen: [50, 205, 50], linen: [250, 240, 230], magenta: [255, 0, 255], maroon: [128, 0, 0], mediumaquamarine: [102, 205, 170], mediumblue: [0, 0, 205], mediumorchid: [186, 85, 211], mediumpurple: [147, 112, 219], mediumseagreen: [60, 179, 113], mediumslateblue: [123, 104, 238], mediumspringgreen: [0, 250, 154], mediumturquoise: [72, 209, 204], mediumvioletred: [199, 21, 133], midnightblue: [25, 25, 112], mintcream: [245, 255, 250], mistyrose: [255, 228, 225], moccasin: [255, 228, 181], navajowhite: [255, 222, 173], navy: [0, 0, 128], oldlace: [253, 245, 230], olive: [128, 128, 0], olivedrab: [107, 142, 35], orange: [255, 165, 0], orangered: [255, 69, 0], orchid: [218, 112, 214], palegoldenrod: [238, 232, 170], palegreen: [152, 251, 152], paleturquoise: [175, 238, 238], palevioletred: [219, 112, 147], papayawhip: [255, 239, 213], peachpuff: [255, 218, 185], peru: [205, 133, 63], pink: [255, 192, 203], plum: [221, 160, 221], powderblue: [176, 224, 230], purple: [128, 0, 128], rebeccapurple: [102, 51, 153], red: [255, 0, 0], rosybrown: [188, 143, 143], royalblue: [65, 105, 225], saddlebrown: [139, 69, 19], salmon: [250, 128, 114], sandybrown: [244, 164, 96], seagreen: [46, 139, 87], seashell: [255, 245, 238], sienna: [160, 82, 45], silver: [192, 192, 192], skyblue: [135, 206, 235], slateblue: [106, 90, 205], slategray: [112, 128, 144], slategrey: [112, 128, 144], snow: [255, 250, 250], springgreen: [0, 255, 127], steelblue: [70, 130, 180], tan: [210, 180, 140], teal: [0, 128, 128], thistle: [216, 191, 216], tomato: [255, 99, 71], turquoise: [64, 224, 208], violet: [238, 130, 238], wheat: [245, 222, 179], white: [255, 255, 255], whitesmoke: [245, 245, 245], yellow: [255, 255, 0], yellowgreen: [154, 205, 50] }; t.exports = n }, {}], 4: [function (e, t, i) { var f = e("./support"), p = e("./renderers/canvas"), m = e("./imageloader"), g = e("./nodeparser"), n = e("./nodecontainer"), _ = e("./log"), a = e("./utils"), v = e("./clone"), y = e("./proxy").loadUrlDocument, b = a.getBounds, w = "data-html2canvas-node", C = 0; function s(e, t) { var i, n, a = C++; if ((t = t || {}).logging && (_.options.logging = !0, _.options.start = Date.now()), t.async = void 0 === t.async || t.async, t.allowTaint = void 0 !== t.allowTaint && t.allowTaint, t.removeContainer = void 0 === t.removeContainer || t.removeContainer, t.javascriptEnabled = void 0 !== t.javascriptEnabled && t.javascriptEnabled, t.imageTimeout = void 0 === t.imageTimeout ? 1e4 : t.imageTimeout, t.renderer = "function" == typeof t.renderer ? t.renderer : p, t.strict = !!t.strict, "string" == typeof e) { if ("string" != typeof t.proxy) return Promise.reject("Proxy must be used when rendering url"); var s = null != t.width ? t.width : window.innerWidth, r = null != t.height ? t.height : window.innerHeight; return y((i = e, n = document.createElement("a"), n.href = i, n.href = n.href, n), t.proxy, document, s, r, t).then(function (e) { return x(e.contentWindow.document.documentElement, e, t, s, r) }) } var o, l, c, d, u, h = (void 0 === e ? [document.documentElement] : e.length ? e : [e])[0]; return h.setAttribute(w + a, a), (o = h.ownerDocument, l = t, c = h.ownerDocument.defaultView.innerWidth, d = h.ownerDocument.defaultView.innerHeight, u = a, v(o, o, c, d, l, o.defaultView.pageXOffset, o.defaultView.pageYOffset).then(function (e) { _("Document cloned"); var t = w + u, i = "[" + t + "='" + u + "']"; o.querySelector(i).removeAttribute(t); var n = e.contentWindow, a = n.document.querySelector(i), s = "function" == typeof l.onclone ? Promise.resolve(l.onclone(n.document)) : Promise.resolve(!0); return s.then(function () { return x(a, e, l, c, d) }) })).then(function (e) { return "function" == typeof t.onrendered && (_("options.onrendered is deprecated, html2canvas returns a Promise containing the canvas"), t.onrendered(e)), e }) } s.CanvasRenderer = p, s.NodeContainer = n, s.log = _, s.utils = a; var r = "undefined" == typeof document || "function" != typeof Object.create || "function" != typeof document.createElement("canvas").getContext ? function () { return Promise.reject("No canvas support") } : s; function x(i, n, a, e, t) { var s, r, o = n.contentWindow, l = new f(o.document), c = new m(a, l), d = b(i), u = "view" === a.type ? e : (s = o.document, Math.max(Math.max(s.body.scrollWidth, s.documentElement.scrollWidth), Math.max(s.body.offsetWidth, s.documentElement.offsetWidth), Math.max(s.body.clientWidth, s.documentElement.clientWidth))), h = "view" === a.type ? t : (r = o.document, Math.max(Math.max(r.body.scrollHeight, r.documentElement.scrollHeight), Math.max(r.body.offsetHeight, r.documentElement.offsetHeight), Math.max(r.body.clientHeight, r.documentElement.clientHeight))), p = new a.renderer(u, h, c, a, document); return new g(i, p, l, c, a).ready.then(function () { var e, t; return _("Finished rendering"), e = "view" === a.type ? k(p.canvas, { width: p.canvas.width, height: p.canvas.height, top: 0, left: 0, x: 0, y: 0 }) : i === o.document.body || i === o.document.documentElement || null != a.canvas ? p.canvas : k(p.canvas, { width: null != a.width ? a.width : d.width, height: null != a.height ? a.height : d.height, top: d.top, left: d.left, x: 0, y: 0 }), t = n, a.removeContainer && (t.parentNode.removeChild(t), _("Cleaned up container")), e }) } function k(e, t) { var i = document.createElement("canvas"), n = Math.min(e.width - 1, Math.max(0, t.left)), a = Math.min(e.width, Math.max(1, t.left + t.width)), s = Math.min(e.height - 1, Math.max(0, t.top)), r = Math.min(e.height, Math.max(1, t.top + t.height)); i.width = t.width, i.height = t.height; var o = a - n, l = r - s; return _("Cropping canvas at:", "left:", t.left, "top:", t.top, "width:", o, "height:", l), _("Resulting crop with width", t.width, "and height", t.height, "with x", n, "and y", s), i.getContext("2d").drawImage(e, n, s, o, l, t.x, t.y, o, l), i } t.exports = r }, { "./clone": 2, "./imageloader": 11, "./log": 13, "./nodecontainer": 14, "./nodeparser": 15, "./proxy": 16, "./renderers/canvas": 20, "./support": 22, "./utils": 26 }], 5: [function (e, t, i) { var n = e("./log"), a = e("./utils").smallImage; t.exports = function e(t) { if (this.src = t, n("DummyImageContainer for", t), !this.promise || !this.image) { n("Initiating DummyImageContainer"), e.prototype.image = new Image; var i = this.image; e.prototype.promise = new Promise(function (e, t) { i.onload = e, i.onerror = t, i.src = a(), !0 === i.complete && e(i) }) } } }, { "./log": 13, "./utils": 26 }], 6: [function (e, t, i) { var l = e("./utils").smallImage; t.exports = function (e, t) { var i, n, a = document.createElement("div"), s = document.createElement("img"), r = document.createElement("span"), o = "Hidden Text"; a.style.visibility = "hidden", a.style.fontFamily = e, a.style.fontSize = t, a.style.margin = 0, a.style.padding = 0, document.body.appendChild(a), s.src = l(), s.width = 1, s.height = 1, s.style.margin = 0, s.style.padding = 0, s.style.verticalAlign = "baseline", r.style.fontFamily = e, r.style.fontSize = t, r.style.margin = 0, r.style.padding = 0, r.appendChild(document.createTextNode(o)), a.appendChild(r), a.appendChild(s), i = s.offsetTop - r.offsetTop + 1, a.removeChild(r), a.appendChild(document.createTextNode(o)), a.style.lineHeight = "normal", s.style.verticalAlign = "super", n = s.offsetTop - a.offsetTop + 1, document.body.removeChild(a), this.baseline = i, this.lineWidth = 1, this.middle = n } }, { "./utils": 26 }], 7: [function (e, t, i) { var n = e("./font"); function a() { this.data = {} } a.prototype.getMetrics = function (e, t) { return void 0 === this.data[e + "-" + t] && (this.data[e + "-" + t] = new n(e, t)), this.data[e + "-" + t] }, t.exports = a }, { "./font": 6 }], 8: [function (s, e, t) { var r = s("./utils").getBounds, a = s("./proxy").loadUrlDocument; function i(t, e, i) { this.image = null, this.src = t; var n = this, a = r(t); this.promise = (e ? new Promise(function (e) { "about:blank" === t.contentWindow.document.URL || null == t.contentWindow.document.documentElement ? t.contentWindow.onload = t.onload = function () { e(t) } : e(t) }) : this.proxyLoad(i.proxy, a, i)).then(function (e) { return s("./core")(e.contentWindow.document.documentElement, { type: "view", width: e.width, height: e.height, proxy: i.proxy, javascriptEnabled: i.javascriptEnabled, removeContainer: i.removeContainer, allowTaint: i.allowTaint, imageTimeout: i.imageTimeout / 2 }) }).then(function (e) { return n.image = e }) } i.prototype.proxyLoad = function (e, t, i) { var n = this.src; return a(n.src, e, n.ownerDocument, t.width, t.height, i) }, e.exports = i }, { "./core": 4, "./proxy": 16, "./utils": 26 }], 9: [function (e, t, i) { function n(e) { this.src = e.value, this.colorStops = [], this.type = null, this.x0 = .5, this.y0 = .5, this.x1 = .5, this.y1 = .5, this.promise = Promise.resolve(!0) } n.TYPES = { LINEAR: 1, RADIAL: 2 }, n.REGEXP_COLORSTOP = /^\s*(rgba?\(\s*\d{1,3},\s*\d{1,3},\s*\d{1,3}(?:,\s*[0-9\.]+)?\s*\)|[a-z]{3,20}|#[a-f0-9]{3,6})(?:\s+(\d{1,3}(?:\.\d+)?)(%|px)?)?(?:\s|$)/i, t.exports = n }, {}], 10: [function (e, t, i) { t.exports = function (i, n) { this.src = i, this.image = new Image; var a = this; this.tainted = null, this.promise = new Promise(function (e, t) { a.image.onload = e, a.image.onerror = t, n && (a.image.crossOrigin = "anonymous"), a.image.src = i, !0 === a.image.complete && e(a.image) }) } }, {}], 11: [function (e, t, i) { var s = e("./log"), n = e("./imagecontainer"), a = e("./dummyimagecontainer"), r = e("./proxyimagecontainer"), o = e("./framecontainer"), l = e("./svgcontainer"), c = e("./svgnodecontainer"), d = e("./lineargradientcontainer"), u = e("./webkitgradientcontainer"), h = e("./utils").bind; function p(e, t) { this.link = null, this.options = e, this.support = t, this.origin = this.getOrigin(window.location.href) } p.prototype.findImages = function (e) { var t = []; return e.reduce(function (e, t) { switch (t.node.nodeName) { case "IMG": return e.concat([{ args: [t.node.src], method: "url" }]); case "svg": case "IFRAME": return e.concat([{ args: [t.node], method: t.node.nodeName }]) }return e }, []).forEach(this.addImage(t, this.loadImage), this), t }, p.prototype.findBackgroundImage = function (e, t) { return t.parseBackgroundImages().filter(this.hasImageBackground).forEach(this.addImage(e, this.loadImage), this), e }, p.prototype.addImage = function (i, n) { return function (t) { t.args.forEach(function (e) { this.imageExists(i, e) || (i.splice(0, 0, n.call(this, t)), s("Added image #" + i.length, "string" == typeof e ? e.substring(0, 100) : e)) }, this) } }, p.prototype.hasImageBackground = function (e) { return "none" !== e.method }, p.prototype.loadImage = function (e) { if ("url" === e.method) { var t = e.args[0]; return !this.isSVG(t) || this.support.svg || this.options.allowTaint ? t.match(/data:image\/.*;base64,/i) ? new n(t.replace(/url\(['"]{0,}|['"]{0,}\)$/gi, ""), !1) : this.isSameOrigin(t) || !0 === this.options.allowTaint || this.isSVG(t) ? new n(t, !1) : this.support.cors && !this.options.allowTaint && this.options.useCORS ? new n(t, !0) : this.options.proxy ? new r(t, this.options.proxy) : new a(t) : new l(t) } return "linear-gradient" === e.method ? new d(e) : "gradient" === e.method ? new u(e) : "svg" === e.method ? new c(e.args[0], this.support.svg) : "IFRAME" === e.method ? new o(e.args[0], this.isSameOrigin(e.args[0].src), this.options) : new a(e) }, p.prototype.isSVG = function (e) { return "svg" === e.substring(e.length - 3).toLowerCase() || l.prototype.isInline(e) }, p.prototype.imageExists = function (e, t) { return e.some(function (e) { return e.src === t }) }, p.prototype.isSameOrigin = function (e) { return this.getOrigin(e) === this.origin }, p.prototype.getOrigin = function (e) { var t = this.link || (this.link = document.createElement("a")); return t.href = e, t.href = t.href, t.protocol + t.hostname + t.port }, p.prototype.getPromise = function (t) { return this.timeout(t, this.options.imageTimeout).catch(function () { return new a(t.src).promise.then(function (e) { t.image = e }) }) }, p.prototype.get = function (t) { var i = null; return this.images.some(function (e) { return (i = e).src === t }) ? i : null }, p.prototype.fetch = function (e) { return this.images = e.reduce(h(this.findBackgroundImage, this), this.findImages(e)), this.images.forEach(function (t, i) { t.promise.then(function () { s("Succesfully loaded image #" + (i + 1), t) }, function (e) { s("Failed loading image #" + (i + 1), t, e) }) }), this.ready = Promise.all(this.images.map(this.getPromise, this)), s("Finished searching images"), this }, p.prototype.timeout = function (i, n) { var a, e = Promise.race([i.promise, new Promise(function (e, t) { a = setTimeout(function () { s("Timed out loading image", i), t(i) }, n) })]).then(function (e) { return clearTimeout(a), e }); return e.catch(function () { clearTimeout(a) }), e }, t.exports = p }, { "./dummyimagecontainer": 5, "./framecontainer": 8, "./imagecontainer": 10, "./lineargradientcontainer": 12, "./log": 13, "./proxyimagecontainer": 17, "./svgcontainer": 23, "./svgnodecontainer": 24, "./utils": 26, "./webkitgradientcontainer": 27 }], 12: [function (e, t, i) { var a = e("./gradientcontainer"), s = e("./color"); function n(e) { a.apply(this, arguments), this.type = a.TYPES.LINEAR; var t = n.REGEXP_DIRECTION.test(e.args[0]) || !a.REGEXP_COLORSTOP.test(e.args[0]); t ? e.args[0].split(/\s+/).reverse().forEach(function (e, t) { switch (e) { case "left": this.x0 = 0, this.x1 = 1; break; case "top": this.y0 = 0, this.y1 = 1; break; case "right": this.x0 = 1, this.x1 = 0; break; case "bottom": this.y0 = 1, this.y1 = 0; break; case "to": var i = this.y0, n = this.x0; this.y0 = this.y1, this.x0 = this.x1, this.x1 = n, this.y1 = i; break; case "center": break; default: var a = .01 * parseFloat(e, 10); if (isNaN(a)) break; 0 === t ? (this.y0 = a, this.y1 = 1 - this.y0) : (this.x0 = a, this.x1 = 1 - this.x0) } }, this) : (this.y0 = 0, this.y1 = 1), this.colorStops = e.args.slice(t ? 1 : 0).map(function (e) { var t = e.match(a.REGEXP_COLORSTOP), i = +t[2], n = 0 === i ? "%" : t[3]; return { color: new s(t[1]), stop: "%" === n ? i / 100 : null } }), null === this.colorStops[0].stop && (this.colorStops[0].stop = 0), null === this.colorStops[this.colorStops.length - 1].stop && (this.colorStops[this.colorStops.length - 1].stop = 1), this.colorStops.forEach(function (i, n) { null === i.stop && this.colorStops.slice(n).some(function (e, t) { return null !== e.stop && (i.stop = (e.stop - this.colorStops[n - 1].stop) / (t + 1) + this.colorStops[n - 1].stop, !0) }, this) }, this) } n.prototype = Object.create(a.prototype), n.REGEXP_DIRECTION = /^\s*(?:to|left|right|top|bottom|center|\d{1,3}(?:\.\d+)?%?)(?:\s|$)/i, t.exports = n }, { "./color": 3, "./gradientcontainer": 9 }], 13: [function (e, t, i) { var n = function () { n.options.logging && window.console && window.console.log && Function.prototype.bind.call(window.console.log, window.console).apply(window.console, [Date.now() - n.options.start + "ms", "html2canvas:"].concat([].slice.call(arguments, 0))) }; n.options = { logging: !1 }, t.exports = n }, {}], 14: [function (e, t, i) { var s = e("./color"), n = e("./utils"), a = n.getBounds, r = n.parseBackgrounds, o = n.offsetBounds; function l(e, t) { this.node = e, this.parent = t, this.stack = null, this.bounds = null, this.borders = null, this.clip = [], this.backgroundClip = [], this.offsetBounds = null, this.visible = null, this.computedStyles = null, this.colors = {}, this.styles = {}, this.backgroundImages = null, this.transformData = null, this.transformMatrix = null, this.isPseudoElement = !1, this.opacity = null } function c(e) { return -1 !== e.toString().indexOf("%") } function d(e) { return e.replace("px", "") } function u(e) { return parseFloat(e) } l.prototype.cloneTo = function (e) { e.visible = this.visible, e.borders = this.borders, e.bounds = this.bounds, e.clip = this.clip, e.backgroundClip = this.backgroundClip, e.computedStyles = this.computedStyles, e.styles = this.styles, e.backgroundImages = this.backgroundImages, e.opacity = this.opacity }, l.prototype.getOpacity = function () { return null === this.opacity ? this.opacity = this.cssFloat("opacity") : this.opacity }, l.prototype.assignStack = function (e) { (this.stack = e).children.push(this) }, l.prototype.isElementVisible = function () { return this.node.nodeType === Node.TEXT_NODE ? this.parent.visible : "none" !== this.css("display") && "hidden" !== this.css("visibility") && !this.node.hasAttribute("data-html2canvas-ignore") && ("INPUT" !== this.node.nodeName || "hidden" !== this.node.getAttribute("type")) }, l.prototype.css = function (e) { return this.computedStyles || (this.computedStyles = this.isPseudoElement ? this.parent.computedStyle(this.before ? ":before" : ":after") : this.computedStyle(null)), this.styles[e] || (this.styles[e] = this.computedStyles[e]) }, l.prototype.prefixedCss = function (t) { var i = this.css(t); return void 0 === i && ["webkit", "moz", "ms", "o"].some(function (e) { return void 0 !== (i = this.css(e + t.substr(0, 1).toUpperCase() + t.substr(1))) }, this), void 0 === i ? null : i }, l.prototype.computedStyle = function (e) { return this.node.ownerDocument.defaultView.getComputedStyle(this.node, e) }, l.prototype.cssInt = function (e) { var t = parseInt(this.css(e), 10); return isNaN(t) ? 0 : t }, l.prototype.color = function (e) { return this.colors[e] || (this.colors[e] = new s(this.css(e))) }, l.prototype.cssFloat = function (e) { var t = parseFloat(this.css(e)); return isNaN(t) ? 0 : t }, l.prototype.fontWeight = function () { var e = this.css("fontWeight"); switch (parseInt(e, 10)) { case 401: e = "bold"; break; case 400: e = "normal" }return e }, l.prototype.parseClip = function () { var e = this.css("clip").match(this.CLIP); return e ? { top: parseInt(e[1], 10), right: parseInt(e[2], 10), bottom: parseInt(e[3], 10), left: parseInt(e[4], 10) } : null }, l.prototype.parseBackgroundImages = function () { return this.backgroundImages || (this.backgroundImages = r(this.css("backgroundImage"))) }, l.prototype.cssList = function (e, t) { var i = (this.css(e) || "").split(","); return 1 === (i = (i = i[t || 0] || i[0] || "auto").trim().split(" ")).length && (i = [i[0], c(i[0]) ? "auto" : i[0]]), i }, l.prototype.parseBackgroundSize = function (e, t, i) { var n, a, s = this.cssList("backgroundSize", i); if (c(s[0])) n = e.width * parseFloat(s[0]) / 100; else { if (/contain|cover/.test(s[0])) { var r = e.width / e.height, o = t.width / t.height; return r < o ^ "contain" === s[0] ? { width: e.height * o, height: e.height } : { width: e.width, height: e.width / o } } n = parseInt(s[0], 10) } return a = "auto" === s[0] && "auto" === s[1] ? t.height : "auto" === s[1] ? n / t.width * t.height : c(s[1]) ? e.height * parseFloat(s[1]) / 100 : parseInt(s[1], 10), "auto" === s[0] && (n = a / t.height * t.width), { width: n, height: a } }, l.prototype.parseBackgroundPosition = function (e, t, i, n) { var a, s, r = this.cssList("backgroundPosition", i); return a = c(r[0]) ? (e.width - (n || t).width) * (parseFloat(r[0]) / 100) : parseInt(r[0], 10), s = "auto" === r[1] ? a / t.width * t.height : c(r[1]) ? (e.height - (n || t).height) * parseFloat(r[1]) / 100 : parseInt(r[1], 10), "auto" === r[0] && (a = s / t.height * t.width), { left: a, top: s } }, l.prototype.parseBackgroundRepeat = function (e) { return this.cssList("backgroundRepeat", e)[0] }, l.prototype.parseTextShadows = function () { var e = this.css("textShadow"), t = []; if (e && "none" !== e) for (var i = e.match(this.TEXT_SHADOW_PROPERTY), n = 0; i && n < i.length; n++) { var a = i[n].match(this.TEXT_SHADOW_VALUES); t.push({ color: new s(a[0]), offsetX: a[1] ? parseFloat(a[1].replace("px", "")) : 0, offsetY: a[2] ? parseFloat(a[2].replace("px", "")) : 0, blur: a[3] ? a[3].replace("px", "") : 0 }) } return t }, l.prototype.parseTransform = function () { if (!this.transformData) if (this.hasTransform()) { var e = this.parseBounds(), t = this.prefixedCss("transformOrigin").split(" ").map(d).map(u); t[0] += e.left, t[1] += e.top, this.transformData = { origin: t, matrix: this.parseTransformMatrix() } } else this.transformData = { origin: [0, 0], matrix: [1, 0, 0, 1, 0, 0] }; return this.transformData }, l.prototype.parseTransformMatrix = function () { if (!this.transformMatrix) { var e = this.prefixedCss("transform"), t = e ? function (e) { { if (e && "matrix" === e[1]) return e[2].split(",").map(function (e) { return parseFloat(e.trim()) }); if (e && "matrix3d" === e[1]) { var t = e[2].split(",").map(function (e) { return parseFloat(e.trim()) }); return [t[0], t[1], t[4], t[5], t[12], t[13]] } } }(e.match(this.MATRIX_PROPERTY)) : null; this.transformMatrix = t || [1, 0, 0, 1, 0, 0] } return this.transformMatrix }, l.prototype.parseBounds = function () { return this.bounds || (this.bounds = this.hasTransform() ? o(this.node) : a(this.node)) }, l.prototype.hasTransform = function () { return "1,0,0,1,0,0" !== this.parseTransformMatrix().join(",") || this.parent && this.parent.hasTransform() }, l.prototype.getValue = function () { var e, t, i = this.node.value || ""; return "SELECT" === this.node.tagName ? (e = this.node, i = (t = e.options[e.selectedIndex || 0]) && t.text || "") : "password" === this.node.type && (i = Array(i.length + 1).join("•")), 0 === i.length ? this.node.placeholder || "" : i }, l.prototype.MATRIX_PROPERTY = /(matrix|matrix3d)\((.+)\)/, l.prototype.TEXT_SHADOW_PROPERTY = /((rgba|rgb)\([^\)]+\)(\s-?\d+px){0,})/g, l.prototype.TEXT_SHADOW_VALUES = /(-?\d+px)|(#.+)|(rgb\(.+\))|(rgba\(.+\))/g, l.prototype.CLIP = /^rect\((\d+)px,? (\d+)px,? (\d+)px,? (\d+)px\)$/, t.exports = l }, { "./color": 3, "./utils": 26 }], 15: [function (e, t, i) { var o = e("./log"), l = e("punycode"), c = e("./nodecontainer"), h = e("./textcontainer"), p = e("./pseudoelementcontainer"), d = e("./fontmetrics"), u = e("./color"), f = e("./stackingcontext"), n = e("./utils"), m = n.bind, r = n.getBounds, g = n.parseBackgrounds, _ = n.offsetBounds; function a(e, t, i, n, a) { o("Starting NodeParser"), this.renderer = t, this.options = a, this.range = null, this.support = i, this.renderQueue = [], this.stack = new f(!0, 1, e.ownerDocument, null); var s = new c(e, null); if (a.background && t.rectangle(0, 0, t.width, t.height, new u(a.background)), e === e.ownerDocument.documentElement) { var r = new c(s.color("backgroundColor").isTransparent() ? e.ownerDocument.body : e.ownerDocument.documentElement, null); t.rectangle(0, 0, t.width, t.height, r.color("backgroundColor")) } s.visibile = s.isElementVisible(), this.createPseudoHideStyles(e.ownerDocument), this.disableAnimations(e.ownerDocument), this.nodes = U([s].concat(this.getChildren(s)).filter(function (e) { return e.visible = e.isElementVisible() }).map(this.getPseudoElements, this)), this.fontMetrics = new d, o("Fetched nodes, total:", this.nodes.length), o("Calculate overflow clips"), this.calculateOverflowClips(), o("Start fetching images"), this.images = n.fetch(this.nodes.filter(O)), this.ready = this.images.ready.then(m(function () { return o("Images loaded, starting parsing"), o("Creating stacking contexts"), this.createStackingContexts(), o("Sorting stacking contexts"), this.sortStackingContexts(this.stack), this.parse(this.stack), o("Render queue created with " + this.renderQueue.length + " items"), new Promise(m(function (e) { a.async ? "function" == typeof a.async ? a.async.call(this, this.renderQueue, e) : 0 < this.renderQueue.length ? (this.renderIndex = 0, this.asyncRenderer(this.renderQueue, e)) : e() : (this.renderQueue.forEach(this.paint, this), e()) }, this)) }, this)) } function s(e) { return e.parent && e.parent.clip.length } function v() { } a.prototype.calculateOverflowClips = function () { this.nodes.forEach(function (e) { if (O(e)) { E(e) && e.appendToDOM(), e.borders = this.parseBorders(e); var t = "hidden" === e.css("overflow") ? [e.borders.clip] : [], i = e.parseClip(); i && -1 !== ["absolute", "fixed"].indexOf(e.css("position")) && t.push([["rect", e.bounds.left + i.left, e.bounds.top + i.top, i.right - i.left, i.bottom - i.top]]), e.clip = s(e) ? e.parent.clip.concat(t) : t, e.backgroundClip = "hidden" !== e.css("overflow") ? e.clip.concat([e.borders.clip]) : e.clip, E(e) && e.cleanDOM() } else N(e) && (e.clip = s(e) ? e.parent.clip : []); E(e) || (e.bounds = null) }, this) }, a.prototype.asyncRenderer = function (e, t, i) { i = i || Date.now(), this.paint(e[this.renderIndex++]), e.length === this.renderIndex ? t() : i + 20 > Date.now() ? this.asyncRenderer(e, t, i) : setTimeout(m(function () { this.asyncRenderer(e, t) }, this), 0) }, a.prototype.createPseudoHideStyles = function (e) { this.createStyles(e, "." + p.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE + ':before { content: "" !important; display: none !important; }.' + p.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER + ':after { content: "" !important; display: none !important; }') }, a.prototype.disableAnimations = function (e) { this.createStyles(e, "* { -webkit-animation: none !important; -moz-animation: none !important; -o-animation: none !important; animation: none !important; -webkit-transition: none !important; -moz-transition: none !important; -o-transition: none !important; transition: none !important;}") }, a.prototype.createStyles = function (e, t) { var i = e.createElement("style"); i.innerHTML = t, e.body.appendChild(i) }, a.prototype.getPseudoElements = function (e) { var t = [[e]]; if (e.node.nodeType === Node.ELEMENT_NODE) { var i = this.getPseudoElement(e, ":before"), n = this.getPseudoElement(e, ":after"); i && t.push(i), n && t.push(n) } return U(t) }, a.prototype.getPseudoElement = function (e, t) { var i = e.computedStyle(t); if (!i || !i.content || "none" === i.content || "-moz-alt-content" === i.content || "none" === i.display) return null; for (var n, a, s = (n = i.content, (a = n.substr(0, 1)) === n.substr(n.length - 1) && a.match(/'|"/) ? n.substr(1, n.length - 2) : n), r = "url" === s.substr(0, 3), o = document.createElement(r ? "img" : "html2canvaspseudoelement"), l = new p(o, e, t), c = i.length - 1; 0 <= c; c--) { var d = i.item(c).replace(/(\-[a-z])/g, function (e) { return e.toUpperCase().replace("-", "") }); o.style[d] = i[d] } if (o.className = p.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE + " " + p.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER, r) return o.src = g(s)[0].args[0], [l]; var u = document.createTextNode(s); return o.appendChild(u), [l, new h(u, l)] }, a.prototype.getChildren = function (i) { return U([].filter.call(i.node.childNodes, j).map(function (e) { var t = [e.nodeType === Node.TEXT_NODE ? new h(e, i) : new c(e, i)].filter(q); return e.nodeType === Node.ELEMENT_NODE && t.length && "TEXTAREA" !== e.tagName ? t[0].isElementVisible() ? t.concat(this.getChildren(t[0])) : [] : t }, this)) }, a.prototype.newStackingContext = function (e, t) { var i = new f(t, e.getOpacity(), e.node, e.parent); e.cloneTo(i), (t ? i.getParentStack(this) : i.parent.stack).contexts.push(i), e.stack = i }, a.prototype.createStackingContexts = function () { this.nodes.forEach(function (e) { var t, i; O(e) && (this.isRootElement(e) || e.getOpacity() < 1 || (i = (t = e).css("position"), "auto" !== (-1 !== ["absolute", "relative", "fixed"].indexOf(i) ? t.css("zIndex") : "auto")) || this.isBodyWithTransparentRoot(e) || e.hasTransform()) ? this.newStackingContext(e, !0) : O(e) && (L(e) && A(e) || -1 !== ["inline-block", "inline-table"].indexOf(e.css("display")) || M(e)) ? this.newStackingContext(e, !1) : e.assignStack(e.parent.stack) }, this) }, a.prototype.isBodyWithTransparentRoot = function (e) { return "BODY" === e.node.nodeName && e.parent.color("backgroundColor").isTransparent() }, a.prototype.isRootElement = function (e) { return null === e.parent }, a.prototype.sortStackingContexts = function (e) { var i; e.contexts.sort((i = e.contexts.slice(0), function (e, t) { return e.cssInt("zIndex") + i.indexOf(e) / i.length - (t.cssInt("zIndex") + i.indexOf(t) / i.length) })), e.contexts.forEach(this.sortStackingContexts, this) }, a.prototype.parseTextBounds = function (r) { return function (e, t, i) { if ("none" !== r.parent.css("textDecoration").substr(0, 4) || 0 !== e.trim().length) { if (this.support.rangeBounds && !r.parent.hasTransform()) { var n = i.slice(0, t).join("").length; return this.getRangeBounds(r.node, n, e.length) } if (r.node && "string" == typeof r.node.data) { var a = r.node.splitText(e.length), s = this.getWrapperBounds(r.node, r.parent.hasTransform()); return r.node = a, s } } else this.support.rangeBounds && !r.parent.hasTransform() || (r.node = r.node.splitText(e.length)); return {} } }, a.prototype.getWrapperBounds = function (e, t) { var i = e.ownerDocument.createElement("html2canvaswrapper"), n = e.parentNode, a = e.cloneNode(!0); i.appendChild(e.cloneNode(!0)), n.replaceChild(i, e); var s = t ? _(i) : r(i); return n.replaceChild(a, i), s }, a.prototype.getRangeBounds = function (e, t, i) { var n = this.range || (this.range = e.ownerDocument.createRange()); return n.setStart(e, t), n.setEnd(e, t + i), n.getBoundingClientRect() }, a.prototype.parse = function (e) { var t = e.contexts.filter(S), i = e.children.filter(O), n = i.filter(R(M)), a = n.filter(R(L)).filter(R(I)), s = i.filter(R(L)).filter(M), r = n.filter(R(L)).filter(I), o = e.contexts.concat(n.filter(L)).filter(A), l = e.children.filter(N).filter(P), c = e.contexts.filter($); t.concat(a).concat(s).concat(r).concat(o).concat(l).concat(c).forEach(function (e) { this.renderQueue.push(e), D(e) && (this.parse(e), this.renderQueue.push(new v)) }, this) }, a.prototype.paint = function (e) { try { e instanceof v ? this.renderer.ctx.restore() : N(e) ? (E(e.parent) && e.parent.appendToDOM(), this.paintText(e), E(e.parent) && e.parent.cleanDOM()) : this.paintNode(e) } catch (e) { if (o(e), this.options.strict) throw e } }, a.prototype.paintNode = function (e) { D(e) && (this.renderer.setOpacity(e.opacity), this.renderer.ctx.save(), e.hasTransform() && this.renderer.setTransform(e.parseTransform())), "INPUT" === e.node.nodeName && "checkbox" === e.node.type ? this.paintCheckbox(e) : "INPUT" === e.node.nodeName && "radio" === e.node.type ? this.paintRadio(e) : this.paintElement(e) }, a.prototype.paintElement = function (i) { var n = i.parseBounds(); this.renderer.clip(i.backgroundClip, function () { this.renderer.renderBackground(i, n, i.borders.borders.map(F)) }, this), this.renderer.clip(i.clip, function () { this.renderer.renderBorders(i.borders.borders) }, this), this.renderer.clip(i.backgroundClip, function () { switch (i.node.nodeName) { case "svg": case "IFRAME": var e = this.images.get(i.node); e ? this.renderer.renderImage(i, n, i.borders, e) : o("Error loading <" + i.node.nodeName + ">", i.node); break; case "IMG": var t = this.images.get(i.node.src); t ? this.renderer.renderImage(i, n, i.borders, t) : o("Error loading <img>", i.node.src); break; case "CANVAS": this.renderer.renderImage(i, n, i.borders, { image: i.node }); break; case "SELECT": case "INPUT": case "TEXTAREA": this.paintFormValue(i) } }, this) }, a.prototype.paintCheckbox = function (e) { var t = e.parseBounds(), i = Math.min(t.width, t.height), n = { width: i - 1, height: i - 1, top: t.top, left: t.left }, a = [3, 3], s = [a, a, a, a], r = [1, 1, 1, 1].map(function (e) { return { color: new u("#A5A5A5"), width: e } }), o = C(n, s, r); this.renderer.clip(e.backgroundClip, function () { this.renderer.rectangle(n.left + 1, n.top + 1, n.width - 2, n.height - 2, new u("#DEDEDE")), this.renderer.renderBorders(b(r, n, o, s)), e.node.checked && (this.renderer.font(new u("#424242"), "normal", "normal", "bold", i - 3 + "px", "arial"), this.renderer.text("✔", n.left + i / 6, n.top + i - 1)) }, this) }, a.prototype.paintRadio = function (e) { var t = e.parseBounds(), i = Math.min(t.width, t.height) - 2; this.renderer.clip(e.backgroundClip, function () { this.renderer.circleStroke(t.left + 1, t.top + 1, i, new u("#DEDEDE"), 1, new u("#A5A5A5")), e.node.checked && this.renderer.circle(Math.ceil(t.left + i / 4) + 1, Math.ceil(t.top + i / 4) + 1, Math.floor(i / 2), new u("#424242")) }, this) }, a.prototype.paintFormValue = function (t) { var e = t.getValue(); if (0 < e.length) { var i = t.node.ownerDocument, n = i.createElement("html2canvaswrapper");["lineHeight", "textAlign", "fontFamily", "fontWeight", "fontSize", "color", "paddingLeft", "paddingTop", "paddingRight", "paddingBottom", "width", "height", "borderLeftStyle", "borderTopStyle", "borderLeftWidth", "borderTopWidth", "boxSizing", "whiteSpace", "wordWrap"].forEach(function (e) { try { n.style[e] = t.css(e) } catch (e) { o("html2canvas: Parse: Exception caught in renderFormValue: " + e.message) } }); var a = t.parseBounds(); n.style.position = "fixed", n.style.left = a.left + "px", n.style.top = a.top + "px", n.textContent = e, i.body.appendChild(n), this.paintText(new h(n.firstChild, t)), i.body.removeChild(n) } }, a.prototype.paintText = function (i) { i.applyTextTransform(); var e, t = l.ucs2.decode(i.node.data), n = this.options.letterRendering && !/^(normal|none|0px)$/.test(i.parent.css("letterSpacing")) || (e = i.node.data, /[^\u0000-\u00ff]/.test(e)) ? t.map(function (e) { return l.ucs2.encode([e]) }) : function (e) { var t, i = [], n = 0, a = !1; for (; e.length;)s = e[n], -1 !== [32, 13, 10, 9, 45].indexOf(s) === a ? ((t = e.splice(0, n)).length && i.push(l.ucs2.encode(t)), a = !a, n = 0) : n++ , n >= e.length && (t = e.splice(0, n)).length && i.push(l.ucs2.encode(t)); var s; return i }(t), a = i.parent.fontWeight(), s = i.parent.css("fontSize"), r = i.parent.css("fontFamily"), o = i.parent.parseTextShadows(); this.renderer.font(i.parent.color("color"), i.parent.css("fontStyle"), i.parent.css("fontVariant"), a, s, r), o.length ? this.renderer.fontShadow(o[0].color, o[0].offsetX, o[0].offsetY, o[0].blur) : this.renderer.clearShadow(), this.renderer.clip(i.parent.clip, function () { n.map(this.parseTextBounds(i), this).forEach(function (e, t) { e && !1 === /^\s*$/.test(n[t]) && (this.renderer.text(n[t], e.left, e.bottom), this.renderTextDecoration(i.parent, e, this.fontMetrics.getMetrics(r, s))) }, this) }, this) }, a.prototype.renderTextDecoration = function (e, t, i) { switch (e.css("textDecoration").split(" ")[0]) { case "underline": this.renderer.rectangle(t.left, Math.round(t.top + i.baseline + i.lineWidth), t.width, 1, e.color("color")); break; case "overline": this.renderer.rectangle(t.left, Math.round(t.top), t.width, 1, e.color("color")); break; case "line-through": this.renderer.rectangle(t.left, Math.ceil(t.top + i.middle + i.lineWidth), t.width, 1, e.color("color")) } }; var y = { inset: [["darken", .6], ["darken", .1], ["darken", .1], ["darken", .6]] }; function b(r, o, l, c) { return r.map(function (e, t) { if (0 < e.width) { var i = o.left, n = o.top, a = o.width, s = o.height - r[2].width; switch (t) { case 0: s = r[0].width, e.args = k({ c1: [i, n], c2: [i + a, n], c3: [i + a - r[1].width, n + s], c4: [i + r[3].width, n + s] }, c[0], c[1], l.topLeftOuter, l.topLeftInner, l.topRightOuter, l.topRightInner); break; case 1: i = o.left + o.width - r[1].width, a = r[1].width, e.args = k({ c1: [i + a, n], c2: [i + a, n + s + r[2].width], c3: [i, n + s], c4: [i, n + r[0].width] }, c[1], c[2], l.topRightOuter, l.topRightInner, l.bottomRightOuter, l.bottomRightInner); break; case 2: n = n + o.height - r[2].width, s = r[2].width, e.args = k({ c1: [i + a, n + s], c2: [i, n + s], c3: [i + r[3].width, n], c4: [i + a - r[3].width, n] }, c[2], c[3], l.bottomRightOuter, l.bottomRightInner, l.bottomLeftOuter, l.bottomLeftInner); break; case 3: a = r[3].width, e.args = k({ c1: [i, n + s + r[2].width], c2: [i, n], c3: [i + a, n + r[0].width], c4: [i + a, n + s] }, c[3], c[0], l.bottomLeftOuter, l.bottomLeftInner, l.topLeftOuter, l.topLeftInner) } } return e }) } function w(e, t, i, n) { var a = (Math.sqrt(2) - 1) / 3 * 4, s = i * a, r = n * a, o = e + i, l = t + n; return { topLeft: x({ x: e, y: l }, { x: e, y: l - r }, { x: o - s, y: t }, { x: o, y: t }), topRight: x({ x: e, y: t }, { x: e + s, y: t }, { x: o, y: l - r }, { x: o, y: l }), bottomRight: x({ x: o, y: t }, { x: o, y: t + r }, { x: e + s, y: l }, { x: e, y: l }), bottomLeft: x({ x: o, y: l }, { x: o - s, y: l }, { x: e, y: t + r }, { x: e, y: t }) } } function C(e, t, i) { var n = e.left, a = e.top, s = e.width, r = e.height, o = t[0][0] < s / 2 ? t[0][0] : s / 2, l = t[0][1] < r / 2 ? t[0][1] : r / 2, c = t[1][0] < s / 2 ? t[1][0] : s / 2, d = t[1][1] < r / 2 ? t[1][1] : r / 2, u = t[2][0] < s / 2 ? t[2][0] : s / 2, h = t[2][1] < r / 2 ? t[2][1] : r / 2, p = t[3][0] < s / 2 ? t[3][0] : s / 2, f = t[3][1] < r / 2 ? t[3][1] : r / 2, m = s - c, g = r - h, _ = s - u, v = r - f; return { topLeftOuter: w(n, a, o, l).topLeft.subdivide(.5), topLeftInner: w(n + i[3].width, a + i[0].width, Math.max(0, o - i[3].width), Math.max(0, l - i[0].width)).topLeft.subdivide(.5), topRightOuter: w(n + m, a, c, d).topRight.subdivide(.5), topRightInner: w(n + Math.min(m, s + i[3].width), a + i[0].width, m > s + i[3].width ? 0 : c - i[3].width, d - i[0].width).topRight.subdivide(.5), bottomRightOuter: w(n + _, a + g, u, h).bottomRight.subdivide(.5), bottomRightInner: w(n + Math.min(_, s - i[3].width), a + Math.min(g, r + i[0].width), Math.max(0, u - i[1].width), h - i[2].width).bottomRight.subdivide(.5), bottomLeftOuter: w(n, a + v, p, f).bottomLeft.subdivide(.5), bottomLeftInner: w(n + i[3].width, a + v, Math.max(0, p - i[3].width), f - i[2].width).bottomLeft.subdivide(.5) } } function x(o, l, c, d) { var u = function (e, t, i) { return { x: e.x + (t.x - e.x) * i, y: e.y + (t.y - e.y) * i } }; return { start: o, startControl: l, endControl: c, end: d, subdivide: function (e) { var t = u(o, l, e), i = u(l, c, e), n = u(c, d, e), a = u(t, i, e), s = u(i, n, e), r = u(a, s, e); return [x(o, t, a, r), x(r, s, n, d)] }, curveTo: function (e) { e.push(["bezierCurve", l.x, l.y, c.x, c.y, d.x, d.y]) }, curveToReversed: function (e) { e.push(["bezierCurve", c.x, c.y, l.x, l.y, o.x, o.y]) } } } function k(e, t, i, n, a, s, r) { var o = []; return 0 < t[0] || 0 < t[1] ? (o.push(["line", n[1].start.x, n[1].start.y]), n[1].curveTo(o)) : o.push(["line", e.c1[0], e.c1[1]]), 0 < i[0] || 0 < i[1] ? (o.push(["line", s[0].start.x, s[0].start.y]), s[0].curveTo(o), o.push(["line", r[0].end.x, r[0].end.y]), r[0].curveToReversed(o)) : (o.push(["line", e.c2[0], e.c2[1]]), o.push(["line", e.c3[0], e.c3[1]])), 0 < t[0] || 0 < t[1] ? (o.push(["line", a[1].end.x, a[1].end.y]), a[1].curveToReversed(o)) : o.push(["line", e.c4[0], e.c4[1]]), o } function T(e, t, i, n, a, s, r) { 0 < t[0] || 0 < t[1] ? (e.push(["line", n[0].start.x, n[0].start.y]), n[0].curveTo(e), n[1].curveTo(e)) : e.push(["line", s, r]), (0 < i[0] || 0 < i[1]) && e.push(["line", a[0].start.x, a[0].start.y]) } function S(e) { return e.cssInt("zIndex") < 0 } function $(e) { return 0 < e.cssInt("zIndex") } function A(e) { return 0 === e.cssInt("zIndex") } function I(e) { return -1 !== ["inline", "inline-block", "inline-table"].indexOf(e.css("display")) } function D(e) { return e instanceof f } function P(e) { return 0 < e.node.data.trim().length } function j(e) { return e.nodeType === Node.TEXT_NODE || e.nodeType === Node.ELEMENT_NODE } function L(e) { return "static" !== e.css("position") } function M(e) { return "none" !== e.css("float") } function R(e) { var t = this; return function () { return !e.apply(t, arguments) } } function O(e) { return e.node.nodeType === Node.ELEMENT_NODE } function E(e) { return !0 === e.isPseudoElement } function N(e) { return e.node.nodeType === Node.TEXT_NODE } function B(e) { return parseInt(e, 10) } function F(e) { return e.width } function q(e) { return e.node.nodeType !== Node.ELEMENT_NODE || -1 === ["SCRIPT", "HEAD", "TITLE", "OBJECT", "BR", "OPTION"].indexOf(e.node.nodeName) } function U(e) { return [].concat.apply([], e) } a.prototype.parseBorders = function (s) { var n, e = s.parseBounds(), t = (n = s, ["TopLeft", "TopRight", "BottomRight", "BottomLeft"].map(function (e) { var t = n.css("border" + e + "Radius"), i = t.split(" "); return i.length <= 1 && (i[1] = i[0]), i.map(B) })), i = ["Top", "Right", "Bottom", "Left"].map(function (e, t) { var i = s.css("border" + e + "Style"), n = s.color("border" + e + "Color"); "inset" === i && n.isBlack() && (n = new u([255, 255, 255, n.a])); var a = y[i] ? y[i][t] : null; return { width: s.cssInt("border" + e + "Width"), color: a ? n[a[0]](a[1]) : n, args: null } }), a = C(e, t, i); return { clip: this.parseBackgroundClip(s, a, i, t, e), borders: b(i, e, a, t) } }, a.prototype.parseBackgroundClip = function (e, t, i, n, a) { var s = []; switch (e.css("backgroundClip")) { case "content-box": case "padding-box": T(s, n[0], n[1], t.topLeftInner, t.topRightInner, a.left + i[3].width, a.top + i[0].width), T(s, n[1], n[2], t.topRightInner, t.bottomRightInner, a.left + a.width - i[1].width, a.top + i[0].width), T(s, n[2], n[3], t.bottomRightInner, t.bottomLeftInner, a.left + a.width - i[1].width, a.top + a.height - i[2].width), T(s, n[3], n[0], t.bottomLeftInner, t.topLeftInner, a.left + i[3].width, a.top + a.height - i[2].width); break; default: T(s, n[0], n[1], t.topLeftOuter, t.topRightOuter, a.left, a.top), T(s, n[1], n[2], t.topRightOuter, t.bottomRightOuter, a.left + a.width, a.top), T(s, n[2], n[3], t.bottomRightOuter, t.bottomLeftOuter, a.left + a.width, a.top + a.height), T(s, n[3], n[0], t.bottomLeftOuter, t.topLeftOuter, a.left, a.top + a.height) }return s }, t.exports = a }, { "./color": 3, "./fontmetrics": 7, "./log": 13, "./nodecontainer": 14, "./pseudoelementcontainer": 18, "./stackingcontext": 21, "./textcontainer": 25, "./utils": 26, punycode: 1 }], 16: [function (e, t, i) { var r = e("./xhr"), n = e("./utils"), o = e("./log"), l = e("./clone"), c = n.decode64; function d(e, t, i) { var n = "withCredentials" in new XMLHttpRequest; if (!t) return Promise.reject("No proxy configured"); var a = h(n), s = p(t, e, a); return n ? r(s) : u(i, s, a).then(function (e) { return c(e.content) }) } var a = 0; function u(a, s, r) { return new Promise(function (t, i) { var e = a.createElement("script"), n = function () { delete window.html2canvas.proxy[r], a.body.removeChild(e) }; window.html2canvas.proxy[r] = function (e) { n(), t(e) }, e.src = s, e.onerror = function (e) { n(), i(e) }, a.body.appendChild(e) }) } function h(e) { return e ? "" : "html2canvas_" + Date.now() + "_" + ++a + "_" + Math.round(1e5 * Math.random()) } function p(e, t, i) { return e + "?url=" + encodeURIComponent(t) + (i.length ? "&callback=html2canvas.proxy." + i : "") } i.Proxy = d, i.ProxyURL = function (e, t, i) { var n = "crossOrigin" in new Image, a = h(n), s = p(t, e, a); return n ? Promise.resolve(s) : u(i, s, a).then(function (e) { return "data:" + e.type + ";base64," + e.content }) }, i.loadUrlDocument = function (e, t, i, n, a, s) { return new d(e, t, window.document).then((r = e, function (t) { var i, e = new DOMParser; try { i = e.parseFromString(t, "text/html") } catch (e) { o("DOMParser not supported, falling back to createHTMLDocument"), i = document.implementation.createHTMLDocument(""); try { i.open(), i.write(t), i.close() } catch (e) { o("createHTMLDocument write not supported, falling back to document.body.innerHTML"), i.body.innerHTML = t } } var n = i.querySelector("base"); if (!n || !n.href.host) { var a = i.createElement("base"); a.href = r, i.head.insertBefore(a, i.head.firstChild) } return i })).then(function (e) { return l(e, i, n, a, s, 0, 0) }); var r } }, { "./clone": 2, "./log": 13, "./utils": 26, "./xhr": 28 }], 17: [function (e, t, i) { var s = e("./proxy").ProxyURL; t.exports = function (i, n) { var e = document.createElement("a"); e.href = i, i = e.href, this.src = i, this.image = new Image; var a = this; this.promise = new Promise(function (e, t) { a.image.crossOrigin = "Anonymous", a.image.onload = e, a.image.onerror = t, new s(i, n, document).then(function (e) { a.image.src = e }).catch(t) }) } }, { "./proxy": 16 }], 18: [function (e, t, i) { var n = e("./nodecontainer"); function a(e, t, i) { n.call(this, e, t), this.isPseudoElement = !0, this.before = ":before" === i } a.prototype.cloneTo = function (e) { a.prototype.cloneTo.call(this, e), e.isPseudoElement = !0, e.before = this.before }, (a.prototype = Object.create(n.prototype)).appendToDOM = function () { this.before ? this.parent.node.insertBefore(this.node, this.parent.node.firstChild) : this.parent.node.appendChild(this.node), this.parent.node.className += " " + this.getHideClass() }, a.prototype.cleanDOM = function () { this.node.parentNode.removeChild(this.node), this.parent.node.className = this.parent.node.className.replace(this.getHideClass(), "") }, a.prototype.getHideClass = function () { return this["PSEUDO_HIDE_ELEMENT_CLASS_" + (this.before ? "BEFORE" : "AFTER")] }, a.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE = "___html2canvas___pseudoelement_before", a.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER = "___html2canvas___pseudoelement_after", t.exports = a }, { "./nodecontainer": 14 }], 19: [function (e, t, i) { var l = e("./log"); function n(e, t, i, n, a) { this.width = e, this.height = t, this.images = i, this.options = n, this.document = a } n.prototype.renderImage = function (e, t, i, n) { var a = e.cssInt("paddingLeft"), s = e.cssInt("paddingTop"), r = e.cssInt("paddingRight"), o = e.cssInt("paddingBottom"), l = i.borders, c = t.width - (l[1].width + l[3].width + a + r), d = t.height - (l[0].width + l[2].width + s + o); this.drawImage(n, 0, 0, n.image.width || c, n.image.height || d, t.left + a + l[3].width, t.top + s + l[0].width, c, d) }, n.prototype.renderBackground = function (e, t, i) { 0 < t.height && 0 < t.width && (this.renderBackgroundColor(e, t), this.renderBackgroundImage(e, t, i)) }, n.prototype.renderBackgroundColor = function (e, t) { var i = e.color("backgroundColor"); i.isTransparent() || this.rectangle(t.left, t.top, t.width, t.height, i) }, n.prototype.renderBorders = function (e) { e.forEach(this.renderBorder, this) }, n.prototype.renderBorder = function (e) { e.color.isTransparent() || null === e.args || this.drawShape(e.args, e.color) }, n.prototype.renderBackgroundImage = function (s, r, o) { s.parseBackgroundImages().reverse().forEach(function (e, t, i) { switch (e.method) { case "url": var n = this.images.get(e.args[0]); n ? this.renderBackgroundRepeating(s, r, n, i.length - (t + 1), o) : l("Error loading background-image", e.args[0]); break; case "linear-gradient": case "gradient": var a = this.images.get(e.value); a ? this.renderBackgroundGradient(a, r, o) : l("Error loading background-image", e.args[0]); break; case "none": break; default: l("Unknown background-image type", e.args[0]) } }, this) }, n.prototype.renderBackgroundRepeating = function (e, t, i, n, a) { var s = e.parseBackgroundSize(t, i.image, n), r = e.parseBackgroundPosition(t, i.image, n, s); switch (e.parseBackgroundRepeat(n)) { case "repeat-x": case "repeat no-repeat": this.backgroundRepeatShape(i, r, s, t, t.left + a[3], t.top + r.top + a[0], 99999, s.height, a); break; case "repeat-y": case "no-repeat repeat": this.backgroundRepeatShape(i, r, s, t, t.left + r.left + a[3], t.top + a[0], s.width, 99999, a); break; case "no-repeat": this.backgroundRepeatShape(i, r, s, t, t.left + r.left + a[3], t.top + r.top + a[0], s.width, s.height, a); break; default: this.renderBackgroundRepeat(i, r, s, { top: t.top, left: t.left }, a[3], a[0]) } }, t.exports = n }, { "./log": 13 }], 20: [function (e, t, i) { var n = e("../renderer"), a = e("../lineargradientcontainer"), s = e("../log"); function r(e, t) { n.apply(this, arguments), this.canvas = this.options.canvas || this.document.createElement("canvas"), this.options.canvas || (this.canvas.width = e, this.canvas.height = t), this.ctx = this.canvas.getContext("2d"), this.taintCtx = this.document.createElement("canvas").getContext("2d"), this.ctx.textBaseline = "bottom", this.variables = {}, s("Initialized CanvasRenderer with size", e, "x", t) } function o(e) { return 0 < e.length } (r.prototype = Object.create(n.prototype)).setFillStyle = function (e) { return this.ctx.fillStyle = "object" == typeof e && e.isColor ? e.toString() : e, this.ctx }, r.prototype.rectangle = function (e, t, i, n, a) { this.setFillStyle(a).fillRect(e, t, i, n) }, r.prototype.circle = function (e, t, i, n) { this.setFillStyle(n), this.ctx.beginPath(), this.ctx.arc(e + i / 2, t + i / 2, i / 2, 0, 2 * Math.PI, !0), this.ctx.closePath(), this.ctx.fill() }, r.prototype.circleStroke = function (e, t, i, n, a, s) { this.circle(e, t, i, n), this.ctx.strokeStyle = s.toString(), this.ctx.stroke() }, r.prototype.drawShape = function (e, t) { this.shape(e), this.setFillStyle(t).fill() }, r.prototype.taints = function (t) { if (null === t.tainted) { this.taintCtx.drawImage(t.image, 0, 0); try { this.taintCtx.getImageData(0, 0, 1, 1), t.tainted = !1 } catch (e) { this.taintCtx = document.createElement("canvas").getContext("2d"), t.tainted = !0 } } return t.tainted }, r.prototype.drawImage = function (e, t, i, n, a, s, r, o, l) { this.taints(e) && !this.options.allowTaint || this.ctx.drawImage(e.image, t, i, n, a, s, r, o, l) }, r.prototype.clip = function (e, t, i) { this.ctx.save(), e.filter(o).forEach(function (e) { this.shape(e).clip() }, this), t.call(i), this.ctx.restore() }, r.prototype.shape = function (e) { return this.ctx.beginPath(), e.forEach(function (e, t) { "rect" === e[0] ? this.ctx.rect.apply(this.ctx, e.slice(1)) : this.ctx[0 === t ? "moveTo" : e[0] + "To"].apply(this.ctx, e.slice(1)) }, this), this.ctx.closePath(), this.ctx }, r.prototype.font = function (e, t, i, n, a, s) { this.setFillStyle(e).font = [t, i, n, a, s].join(" ").split(",")[0] }, r.prototype.fontShadow = function (e, t, i, n) { this.setVariable("shadowColor", e.toString()).setVariable("shadowOffsetY", t).setVariable("shadowOffsetX", i).setVariable("shadowBlur", n) }, r.prototype.clearShadow = function () { this.setVariable("shadowColor", "rgba(0,0,0,0)") }, r.prototype.setOpacity = function (e) { this.ctx.globalAlpha = e }, r.prototype.setTransform = function (e) { this.ctx.translate(e.origin[0], e.origin[1]), this.ctx.transform.apply(this.ctx, e.matrix), this.ctx.translate(-e.origin[0], -e.origin[1]) }, r.prototype.setVariable = function (e, t) { return this.variables[e] !== t && (this.variables[e] = this.ctx[e] = t), this }, r.prototype.text = function (e, t, i) { this.ctx.fillText(e, t, i) }, r.prototype.backgroundRepeatShape = function (e, t, i, n, a, s, r, o, l) { var c = [["line", Math.round(a), Math.round(s)], ["line", Math.round(a + r), Math.round(s)], ["line", Math.round(a + r), Math.round(o + s)], ["line", Math.round(a), Math.round(o + s)]]; this.clip([c], function () { this.renderBackgroundRepeat(e, t, i, n, l[3], l[0]) }, this) }, r.prototype.renderBackgroundRepeat = function (e, t, i, n, a, s) { var r = Math.round(n.left + t.left + a), o = Math.round(n.top + t.top + s); this.setFillStyle(this.ctx.createPattern(this.resizeImage(e, i), "repeat")), this.ctx.translate(r, o), this.ctx.fill(), this.ctx.translate(-r, -o) }, r.prototype.renderBackgroundGradient = function (e, t) { if (e instanceof a) { var i = this.ctx.createLinearGradient(t.left + t.width * e.x0, t.top + t.height * e.y0, t.left + t.width * e.x1, t.top + t.height * e.y1); e.colorStops.forEach(function (e) { i.addColorStop(e.stop, e.color.toString()) }), this.rectangle(t.left, t.top, t.width, t.height, i) } }, r.prototype.resizeImage = function (e, t) { var i = e.image; if (i.width === t.width && i.height === t.height) return i; var n = document.createElement("canvas"); return n.width = t.width, n.height = t.height, n.getContext("2d").drawImage(i, 0, 0, i.width, i.height, 0, 0, t.width, t.height), n }, t.exports = r }, { "../lineargradientcontainer": 12, "../log": 13, "../renderer": 19 }], 21: [function (e, t, i) { var a = e("./nodecontainer"); function n(e, t, i, n) { a.call(this, i, n), this.ownStacking = e, this.contexts = [], this.children = [], this.opacity = (this.parent ? this.parent.stack.opacity : 1) * t } (n.prototype = Object.create(a.prototype)).getParentStack = function (e) { var t = this.parent ? this.parent.stack : null; return t ? t.ownStacking ? t : t.getParentStack(e) : e.stack }, t.exports = n }, { "./nodecontainer": 14 }], 22: [function (e, t, i) { function n(e) { this.rangeBounds = this.testRangeBounds(e), this.cors = this.testCORS(), this.svg = this.testSVG() } n.prototype.testRangeBounds = function (e) { var t, i, n = !1; return e.createRange && (t = e.createRange()).getBoundingClientRect && ((i = e.createElement("boundtest")).style.height = "123px", i.style.display = "block", e.body.appendChild(i), t.selectNode(i), 123 === t.getBoundingClientRect().height && (n = !0), e.body.removeChild(i)), n }, n.prototype.testCORS = function () { return void 0 !== (new Image).crossOrigin }, n.prototype.testSVG = function () { var e = new Image, t = document.createElement("canvas"), i = t.getContext("2d"); e.src = "data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>"; try { i.drawImage(e, 0, 0), t.toDataURL() } catch (e) { return !1 } return !0 }, t.exports = n }, {}], 23: [function (e, t, i) { var n = e("./xhr"), a = e("./utils").decode64; function s(e) { this.src = e, this.image = null; var i = this; this.promise = this.hasFabric().then(function () { return i.isInline(e) ? Promise.resolve(i.inlineFormatting(e)) : n(e) }).then(function (t) { return new Promise(function (e) { window.html2canvas.svg.fabric.loadSVGFromString(t, i.createCanvas.call(i, e)) }) }) } s.prototype.hasFabric = function () { return window.html2canvas.svg && window.html2canvas.svg.fabric ? Promise.resolve() : Promise.reject(new Error("html2canvas.svg.js is not loaded, cannot render svg")) }, s.prototype.inlineFormatting = function (e) { return /^data:image\/svg\+xml;base64,/.test(e) ? this.decode64(this.removeContentType(e)) : this.removeContentType(e) }, s.prototype.removeContentType = function (e) { return e.replace(/^data:image\/svg\+xml(;base64)?,/, "") }, s.prototype.isInline = function (e) { return /^data:image\/svg\+xml/i.test(e) }, s.prototype.createCanvas = function (n) { var a = this; return function (e, t) { var i = new window.html2canvas.svg.fabric.StaticCanvas("c"); a.image = i.lowerCanvasEl, i.setWidth(t.width).setHeight(t.height).add(window.html2canvas.svg.fabric.util.groupSVGElements(e, t)).renderAll(), n(i.lowerCanvasEl) } }, s.prototype.decode64 = function (e) { return "function" == typeof window.atob ? window.atob(e) : a(e) }, t.exports = s }, { "./utils": 26, "./xhr": 28 }], 24: [function (e, t, i) { var n = e("./svgcontainer"); function a(i, e) { this.src = i, this.image = null; var n = this; this.promise = e ? new Promise(function (e, t) { n.image = new Image, n.image.onload = e, n.image.onerror = t, n.image.src = "data:image/svg+xml," + (new XMLSerializer).serializeToString(i), !0 === n.image.complete && e(n.image) }) : this.hasFabric().then(function () { return new Promise(function (e) { window.html2canvas.svg.fabric.parseSVGDocument(i, n.createCanvas.call(n, e)) }) }) } a.prototype = Object.create(n.prototype), t.exports = a }, { "./svgcontainer": 23 }], 25: [function (e, t, i) { var n = e("./nodecontainer"); function a(e, t) { n.call(this, e, t) } function s(e, t, i) { if (0 < e.length) return t + i.toUpperCase() } (a.prototype = Object.create(n.prototype)).applyTextTransform = function () { this.node.data = this.transform(this.parent.css("textTransform")) }, a.prototype.transform = function (e) { var t = this.node.data; switch (e) { case "lowercase": return t.toLowerCase(); case "capitalize": return t.replace(/(^|\s|:|-|\(|\))([a-z])/g, s); case "uppercase": return t.toUpperCase(); default: return t } }, t.exports = a }, { "./nodecontainer": 14 }], 26: [function (e, t, i) { i.smallImage = function () { return "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" }, i.bind = function (e, t) { return function () { return e.apply(t, arguments) } }, i.decode64 = function (e) { var t, i, n, a, s, r, o, l = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/", c = e.length, d = ""; for (t = 0; t < c; t += 4)s = l.indexOf(e[t]) << 2 | (i = l.indexOf(e[t + 1])) >> 4, r = (15 & i) << 4 | (n = l.indexOf(e[t + 2])) >> 2, o = (3 & n) << 6 | (a = l.indexOf(e[t + 3])), d += 64 === n ? String.fromCharCode(s) : 64 === a || -1 === a ? String.fromCharCode(s, r) : String.fromCharCode(s, r, o); return d }, i.getBounds = function (e) { if (e.getBoundingClientRect) { var t = e.getBoundingClientRect(), i = null == e.offsetWidth ? t.width : e.offsetWidth; return { top: t.top, bottom: t.bottom || t.top + t.height, right: t.left + i, left: t.left, width: i, height: null == e.offsetHeight ? t.height : e.offsetHeight } } return {} }, i.offsetBounds = function (e) { var t = e.offsetParent ? i.offsetBounds(e.offsetParent) : { top: 0, left: 0 }; return { top: e.offsetTop + t.top, bottom: e.offsetTop + e.offsetHeight + t.top, right: e.offsetLeft + t.left + e.offsetWidth, left: e.offsetLeft + t.left, width: e.offsetWidth, height: e.offsetHeight } }, i.parseBackgrounds = function (e) { var t, i, n, a, s, r, o, l = [], c = 0, d = 0, u = function () { t && ('"' === i.substr(0, 1) && (i = i.substr(1, i.length - 2)), i && o.push(i), "-" === t.substr(0, 1) && 0 < (a = t.indexOf("-", 1) + 1) && (n = t.substr(0, a), t = t.substr(a)), l.push({ prefix: n, method: t.toLowerCase(), value: s, args: o, image: null })), o = [], t = n = i = s = "" }; return o = [], t = n = i = s = "", e.split("").forEach(function (e) { if (!(0 === c && -1 < " \r\n\t".indexOf(e))) { switch (e) { case '"': r ? r === e && (r = null) : r = e; break; case "(": if (r) break; if (0 === c) return c = 1, void (s += e); d++; break; case ")": if (r) break; if (1 === c) { if (0 === d) return c = 0, s += e, void u(); d-- } break; case ",": if (r) break; if (0 === c) return void u(); if (1 === c && 0 === d && !t.match(/^url$/i)) return o.push(i), i = "", void (s += e) }s += e, 0 === c ? t += e : i += e } }), u(), l } }, {}], 27: [function (e, t, i) { var n = e("./gradientcontainer"); function a(e) { n.apply(this, arguments), this.type = "linear" === e.args[0] ? n.TYPES.LINEAR : n.TYPES.RADIAL } a.prototype = Object.create(n.prototype), t.exports = a }, { "./gradientcontainer": 9 }], 28: [function (e, t, i) { t.exports = function (n) { return new Promise(function (e, t) { var i = new XMLHttpRequest; i.open("GET", n), i.onload = function () { 200 === i.status ? e(i.responseText) : t(new Error(i.statusText)) }, i.onerror = function () { t(new Error("Network Error")) }, i.send() }) } }, {}] }, {}, [4])(4) }, "object" == typeof exports && "undefined" != typeof module ? module.exports = pe() : ("undefined" != typeof window ? fe = window : "undefined" != typeof global ? fe = global : "undefined" != typeof self && (fe = self), fe.html2canvas = pe()), function (e) { var i = "+".charCodeAt(0), n = "/".charCodeAt(0), a = "0".charCodeAt(0), s = "a".charCodeAt(0), r = "A".charCodeAt(0), o = "-".charCodeAt(0), l = "_".charCodeAt(0), d = function (e) { var t = e.charCodeAt(0); return t === i || t === o ? 62 : t === n || t === l ? 63 : t < a ? -1 : t < a + 10 ? t - a + 26 + 26 : t < r + 26 ? t - r : t < s + 26 ? t - s + 26 : void 0 }; e.API.TTFFont = function () { function a(e, t, i) { var n; if (this.rawData = e, n = this.contents = new G(e), this.contents.pos = 4, "ttcf" === n.readString(4)) { if (!t) throw new Error("Must specify a font name for TTC files."); throw new Error("Font " + t + " not found in TTC file.") } n.pos = 0, this.parse(), this.subset = new A(this), this.registerTTF() } return a.open = function (e, t, i, n) { return new a(function (e) { var t, i, n, a, s, r; if (0 < e.length % 4) throw new Error("Invalid string. Length must be a multiple of 4"); var o = e.length; s = "=" === e.charAt(o - 2) ? 2 : "=" === e.charAt(o - 1) ? 1 : 0, r = new Uint8Array(3 * e.length / 4 - s), n = 0 < s ? e.length - 4 : e.length; var l = 0; function c(e) { r[l++] = e } for (i = t = 0; t < n; t += 4, i += 3)c((16711680 & (a = d(e.charAt(t)) << 18 | d(e.charAt(t + 1)) << 12 | d(e.charAt(t + 2)) << 6 | d(e.charAt(t + 3)))) >> 16), c((65280 & a) >> 8), c(255 & a); return 2 === s ? c(255 & (a = d(e.charAt(t)) << 2 | d(e.charAt(t + 1)) >> 4)) : 1 === s && (c((a = d(e.charAt(t)) << 10 | d(e.charAt(t + 1)) << 4 | d(e.charAt(t + 2)) >> 2) >> 8 & 255), c(255 & a)), r }(i), t, n) }, a.prototype.parse = function () { return this.directory = new t(this.contents), this.head = new p(this), this.name = new b(this), this.cmap = new g(this), this.hhea = new m(this), this.maxp = new w(this), this.hmtx = new C(this), this.post = new v(this), this.os2 = new _(this), this.loca = new $(this), this.glyf = new k(this), this.ascender = this.os2.exists && this.os2.ascender || this.hhea.ascender, this.decender = this.os2.exists && this.os2.decender || this.hhea.decender, this.lineGap = this.os2.exists && this.os2.lineGap || this.hhea.lineGap, this.bbox = [this.head.xMin, this.head.yMin, this.head.xMax, this.head.yMax] }, a.prototype.registerTTF = function () { var a, e, t, i, n; if (this.scaleFactor = 1e3 / this.head.unitsPerEm, this.bbox = function () { var e, t, i, n; for (n = [], e = 0, t = (i = this.bbox).length; e < t; e++)a = i[e], n.push(Math.round(a * this.scaleFactor)); return n }.call(this), this.stemV = 0, this.post.exists ? (t = 255 & (i = this.post.italic_angle), !0 & (e = i >> 16) && (e = -(1 + (65535 ^ e))), this.italicAngle = +(e + "." + t)) : this.italicAngle = 0, this.ascender = Math.round(this.ascender * this.scaleFactor), this.decender = Math.round(this.decender * this.scaleFactor), this.lineGap = Math.round(this.lineGap * this.scaleFactor), this.capHeight = this.os2.exists && this.os2.capHeight || this.ascender, this.xHeight = this.os2.exists && this.os2.xHeight || 0, this.familyClass = (this.os2.exists && this.os2.familyClass || 0) >> 8, this.isSerif = 1 === (n = this.familyClass) || 2 === n || 3 === n || 4 === n || 5 === n || 7 === n, this.isScript = 10 === this.familyClass, this.flags = 0, this.post.isFixedPitch && (this.flags |= 1), this.isSerif && (this.flags |= 2), this.isScript && (this.flags |= 8), 0 !== this.italicAngle && (this.flags |= 64), this.flags |= 32, !this.cmap.unicode) throw new Error("No unicode cmap for font") }, a.prototype.characterToGlyph = function (e) { var t; return (null != (t = this.cmap.unicode) ? t.codeMap[e] : void 0) || 0 }, a.prototype.widthOfGlyph = function (e) { var t; return t = 1e3 / this.head.unitsPerEm, this.hmtx.forGlyph(e).advance * t }, a.prototype.widthOfString = function (e, t, i) { var n, a, s, r, o; for (a = r = s = 0, o = (e = "" + e).length; 0 <= o ? r < o : o < r; a = 0 <= o ? ++r : --r)n = e.charCodeAt(a), s += this.widthOfGlyph(this.characterToGlyph(n)) + i * (1e3 / t) || 0; return s * (t / 1e3) }, a.prototype.lineHeight = function (e, t) { var i; return null == t && (t = !1), i = t ? this.lineGap : 0, (this.ascender + i - this.decender) / 1e3 * e }, a }(); var c, G = function () { function e(e) { this.data = null != e ? e : [], this.pos = 0, this.length = this.data.length } return e.prototype.readByte = function () { return this.data[this.pos++] }, e.prototype.writeByte = function (e) { return this.data[this.pos++] = e }, e.prototype.readUInt32 = function () { return 16777216 * this.readByte() + (this.readByte() << 16) + (this.readByte() << 8) + this.readByte() }, e.prototype.writeUInt32 = function (e) { return this.writeByte(e >>> 24 & 255), this.writeByte(e >> 16 & 255), this.writeByte(e >> 8 & 255), this.writeByte(255 & e) }, e.prototype.readInt32 = function () { var e; return 2147483648 <= (e = this.readUInt32()) ? e - 4294967296 : e }, e.prototype.writeInt32 = function (e) { return e < 0 && (e += 4294967296), this.writeUInt32(e) }, e.prototype.readUInt16 = function () { return this.readByte() << 8 | this.readByte() }, e.prototype.writeUInt16 = function (e) { return this.writeByte(e >> 8 & 255), this.writeByte(255 & e) }, e.prototype.readInt16 = function () { var e; return 32768 <= (e = this.readUInt16()) ? e - 65536 : e }, e.prototype.writeInt16 = function (e) { return e < 0 && (e += 65536), this.writeUInt16(e) }, e.prototype.readString = function (e) { var t, i, n; for (i = [], t = n = 0; 0 <= e ? n < e : e < n; t = 0 <= e ? ++n : --n)i[t] = String.fromCharCode(this.readByte()); return i.join("") }, e.prototype.writeString = function (e) { var t, i, n, a; for (a = [], t = i = 0, n = e.length; 0 <= n ? i < n : n < i; t = 0 <= n ? ++i : --i)a.push(this.writeByte(e.charCodeAt(t))); return a }, e.prototype.readShort = function () { return this.readInt16() }, e.prototype.writeShort = function (e) { return this.writeInt16(e) }, e.prototype.readLongLong = function () { var e, t, i, n, a, s, r, o; return e = this.readByte(), t = this.readByte(), i = this.readByte(), n = this.readByte(), a = this.readByte(), s = this.readByte(), r = this.readByte(), o = this.readByte(), 128 & e ? -1 * (72057594037927940 * (255 ^ e) + 281474976710656 * (255 ^ t) + 1099511627776 * (255 ^ i) + 4294967296 * (255 ^ n) + 16777216 * (255 ^ a) + 65536 * (255 ^ s) + 256 * (255 ^ r) + (255 ^ o) + 1) : 72057594037927940 * e + 281474976710656 * t + 1099511627776 * i + 4294967296 * n + 16777216 * a + 65536 * s + 256 * r + o }, e.prototype.readInt = function () { return this.readInt32() }, e.prototype.writeInt = function (e) { return this.writeInt32(e) }, e.prototype.read = function (e) { var t, i; for (t = [], i = 0; 0 <= e ? i < e : e < i; 0 <= e ? ++i : --i)t.push(this.readByte()); return t }, e.prototype.write = function (e) { var t, i, n, a; for (a = [], i = 0, n = e.length; i < n; i++)t = e[i], a.push(this.writeByte(t)); return a }, e }(), t = function () { var f; function e(e) { var t, i, n; for (this.scalarType = e.readInt(), this.tableCount = e.readShort(), this.searchRange = e.readShort(), this.entrySelector = e.readShort(), this.rangeShift = e.readShort(), this.tables = {}, i = 0, n = this.tableCount; 0 <= n ? i < n : n < i; 0 <= n ? ++i : --i)t = { tag: e.readString(4), checksum: e.readInt(), offset: e.readInt(), length: e.readInt() }, this.tables[t.tag] = t } return e.prototype.encode = function (e) { var t, i, n, a, s, r, o, l, c, d, u, h, p; for (p in u = Object.keys(e).length, r = Math.log(2), c = 16 * Math.floor(Math.log(u) / r), a = Math.floor(c / r), l = 16 * u - c, (i = new G).writeInt(this.scalarType), i.writeShort(u), i.writeShort(c), i.writeShort(a), i.writeShort(l), n = 16 * u, o = i.pos + n, s = null, h = [], e) for (d = e[p], i.writeString(p), i.writeInt(f(d)), i.writeInt(o), i.writeInt(d.length), h = h.concat(d), "head" === p && (s = o), o += d.length; o % 4;)h.push(0), o++; return i.write(h), t = 2981146554 - f(i.data), i.pos = s + 8, i.writeUInt32(t), i.data }, f = function (e) { var t, i, n, a; for (e = x.call(e); e.length % 4;)e.push(0); for (i = new G(e), n = t = 0, a = e.length; n < a; n += 4)t += i.readUInt32(); return 4294967295 & t }, e }(), u = {}.hasOwnProperty, h = function (e, t) { for (var i in t) u.call(t, i) && (e[i] = t[i]); function n() { this.constructor = e } return n.prototype = t.prototype, e.prototype = new n, e.__super__ = t.prototype, e }; c = function () { function e(e) { var t; this.file = e, t = this.file.directory.tables[this.tag], this.exists = !!t, t && (this.offset = t.offset, this.length = t.length, this.parse(this.file.contents)) } return e.prototype.parse = function () { }, e.prototype.encode = function () { }, e.prototype.raw = function () { return this.exists ? (this.file.contents.pos = this.offset, this.file.contents.read(this.length)) : null }, e }(); var p = function (e) { function t() { return t.__super__.constructor.apply(this, arguments) } return h(t, c), t.prototype.tag = "head", t.prototype.parse = function (e) { return e.pos = this.offset, this.version = e.readInt(), this.revision = e.readInt(), this.checkSumAdjustment = e.readInt(), this.magicNumber = e.readInt(), this.flags = e.readShort(), this.unitsPerEm = e.readShort(), this.created = e.readLongLong(), this.modified = e.readLongLong(), this.xMin = e.readShort(), this.yMin = e.readShort(), this.xMax = e.readShort(), this.yMax = e.readShort(), this.macStyle = e.readShort(), this.lowestRecPPEM = e.readShort(), this.fontDirectionHint = e.readShort(), this.indexToLocFormat = e.readShort(), this.glyphDataFormat = e.readShort() }, t }(), f = function () { function e(i, e) { var t, n, a, s, r, o, l, c, d, u, h, p, f, m, g, _, v, y; switch (this.platformID = i.readUInt16(), this.encodingID = i.readShort(), this.offset = e + i.readInt(), d = i.pos, i.pos = this.offset, this.format = i.readUInt16(), this.length = i.readUInt16(), this.language = i.readUInt16(), this.isUnicode = 3 === this.platformID && 1 === this.encodingID && 4 === this.format || 0 === this.platformID && 4 === this.format, this.codeMap = {}, this.format) { case 0: for (o = g = 0; g < 256; o = ++g)this.codeMap[o] = i.readByte(); break; case 4: for (h = i.readUInt16(), u = h / 2, i.pos += 6, a = function () { var e, t; for (t = [], o = e = 0; 0 <= u ? e < u : u < e; o = 0 <= u ? ++e : --e)t.push(i.readUInt16()); return t }(), i.pos += 2, f = function () { var e, t; for (t = [], o = e = 0; 0 <= u ? e < u : u < e; o = 0 <= u ? ++e : --e)t.push(i.readUInt16()); return t }(), l = function () { var e, t; for (t = [], o = e = 0; 0 <= u ? e < u : u < e; o = 0 <= u ? ++e : --e)t.push(i.readUInt16()); return t }(), c = function () { var e, t; for (t = [], o = e = 0; 0 <= u ? e < u : u < e; o = 0 <= u ? ++e : --e)t.push(i.readUInt16()); return t }(), n = (this.length - i.pos + this.offset) / 2, r = function () { var e, t; for (t = [], o = e = 0; 0 <= n ? e < n : n < e; o = 0 <= n ? ++e : --e)t.push(i.readUInt16()); return t }(), o = _ = 0, y = a.length; _ < y; o = ++_)for (m = a[o], t = v = p = f[o]; p <= m ? v <= m : m <= v; t = p <= m ? ++v : --v)0 === c[o] ? s = t + l[o] : 0 !== (s = r[c[o] / 2 + (t - p) - (u - o)] || 0) && (s += l[o]), this.codeMap[t] = 65535 & s }i.pos = d } return e.encode = function (e, t) { var i, n, a, s, r, o, l, c, d, u, h, p, f, m, g, _, v, y, b, w, C, x, k, T, S, $, A, I, D, P, j, L, M, R, O, E, N, B, F, q, U, H, W, V, z, Y; switch (I = new G, s = Object.keys(e).sort(function (e, t) { return e - t }), t) { case "macroman": for (f = 0, m = function () { var e, t; for (t = [], p = e = 0; e < 256; p = ++e)t.push(0); return t }(), _ = { 0: 0 }, a = {}, D = 0, M = s.length; D < M; D++)null == _[W = e[n = s[D]]] && (_[W] = ++f), a[n] = { old: e[n], new: _[e[n]] }, m[n] = _[e[n]]; return I.writeUInt16(1), I.writeUInt16(0), I.writeUInt32(12), I.writeUInt16(0), I.writeUInt16(262), I.writeUInt16(0), I.write(m), { charMap: a, subtable: I.data, maxGlyphID: f + 1 }; case "unicode": for ($ = [], d = [], _ = {}, i = {}, g = l = null, P = v = 0, R = s.length; P < R; P++)null == _[b = e[n = s[P]]] && (_[b] = ++v), i[n] = { old: b, new: _[b] }, r = _[b] - n, null != g && r === l || (g && d.push(g), $.push(n), l = r), g = n; for (g && d.push(g), d.push(65535), $.push(65535), T = 2 * (k = $.length), x = 2 * Math.pow(Math.log(k) / Math.LN2, 2), u = Math.log(x / 2) / Math.LN2, C = 2 * k - x, o = [], w = [], h = [], p = j = 0, O = $.length; j < O; p = ++j) { if (S = $[p], c = d[p], 65535 === S) { o.push(0), w.push(0); break } if (32768 <= S - (A = i[S].new)) for (o.push(0), w.push(2 * (h.length + k - p)), n = L = S; S <= c ? L <= c : c <= L; n = S <= c ? ++L : --L)h.push(i[n].new); else o.push(A - S), w.push(0) } for (I.writeUInt16(3), I.writeUInt16(1), I.writeUInt32(12), I.writeUInt16(4), I.writeUInt16(16 + 8 * k + 2 * h.length), I.writeUInt16(0), I.writeUInt16(T), I.writeUInt16(x), I.writeUInt16(u), I.writeUInt16(C), U = 0, E = d.length; U < E; U++)n = d[U], I.writeUInt16(n); for (I.writeUInt16(0), H = 0, N = $.length; H < N; H++)n = $[H], I.writeUInt16(n); for (V = 0, B = o.length; V < B; V++)r = o[V], I.writeUInt16(r); for (z = 0, F = w.length; z < F; z++)y = w[z], I.writeUInt16(y); for (Y = 0, q = h.length; Y < q; Y++)f = h[Y], I.writeUInt16(f); return { charMap: i, subtable: I.data, maxGlyphID: v + 1 } } }, e }(), g = function (e) { function t() { return t.__super__.constructor.apply(this, arguments) } return h(t, c), t.prototype.tag = "cmap", t.prototype.parse = function (e) { var t, i, n; for (e.pos = this.offset, this.version = e.readUInt16(), i = e.readUInt16(), this.tables = [], this.unicode = null, n = 0; 0 <= i ? n < i : i < n; 0 <= i ? ++n : --n)t = new f(e, this.offset), this.tables.push(t), t.isUnicode && null == this.unicode && (this.unicode = t); return !0 }, t.encode = function (e, t) { var i, n; return null == t && (t = "macroman"), i = f.encode(e, t), (n = new G).writeUInt16(0), n.writeUInt16(1), i.table = n.data.concat(i.subtable), i }, t }(), m = function (e) { function t() { return t.__super__.constructor.apply(this, arguments) } return h(t, c), t.prototype.tag = "hhea", t.prototype.parse = function (e) { return e.pos = this.offset, this.version = e.readInt(), this.ascender = e.readShort(), this.decender = e.readShort(), this.lineGap = e.readShort(), this.advanceWidthMax = e.readShort(), this.minLeftSideBearing = e.readShort(), this.minRightSideBearing = e.readShort(), this.xMaxExtent = e.readShort(), this.caretSlopeRise = e.readShort(), this.caretSlopeRun = e.readShort(), this.caretOffset = e.readShort(), e.pos += 8, this.metricDataFormat = e.readShort(), this.numberOfMetrics = e.readUInt16() }, t }(), _ = function (e) { function t() { return t.__super__.constructor.apply(this, arguments) } return h(t, c), t.prototype.tag = "OS/2", t.prototype.parse = function (i) { if (i.pos = this.offset, this.version = i.readUInt16(), this.averageCharWidth = i.readShort(), this.weightClass = i.readUInt16(), this.widthClass = i.readUInt16(), this.type = i.readShort(), this.ySubscriptXSize = i.readShort(), this.ySubscriptYSize = i.readShort(), this.ySubscriptXOffset = i.readShort(), this.ySubscriptYOffset = i.readShort(), this.ySuperscriptXSize = i.readShort(), this.ySuperscriptYSize = i.readShort(), this.ySuperscriptXOffset = i.readShort(), this.ySuperscriptYOffset = i.readShort(), this.yStrikeoutSize = i.readShort(), this.yStrikeoutPosition = i.readShort(), this.familyClass = i.readShort(), this.panose = function () { var e, t; for (t = [], e = 0; e < 10; ++e)t.push(i.readByte()); return t }(), this.charRange = function () { var e, t; for (t = [], e = 0; e < 4; ++e)t.push(i.readInt()); return t }(), this.vendorID = i.readString(4), this.selection = i.readShort(), this.firstCharIndex = i.readShort(), this.lastCharIndex = i.readShort(), 0 < this.version && (this.ascent = i.readShort(), this.descent = i.readShort(), this.lineGap = i.readShort(), this.winAscent = i.readShort(), this.winDescent = i.readShort(), this.codePageRange = function () { var e, t; for (t = [], e = 0; e < 2; ++e)t.push(i.readInt()); return t }(), 1 < this.version)) return this.xHeight = i.readShort(), this.capHeight = i.readShort(), this.defaultChar = i.readShort(), this.breakChar = i.readShort(), this.maxContext = i.readShort() }, t }(), v = function (e) { function t() { return t.__super__.constructor.apply(this, arguments) } return h(t, c), t.prototype.tag = "post", t.prototype.parse = function (n) { var e, t, i, a; switch (n.pos = this.offset, this.format = n.readInt(), this.italicAngle = n.readInt(), this.underlinePosition = n.readShort(), this.underlineThickness = n.readShort(), this.isFixedPitch = n.readInt(), this.minMemType42 = n.readInt(), this.maxMemType42 = n.readInt(), this.minMemType1 = n.readInt(), this.maxMemType1 = n.readInt(), this.format) { case 65536: break; case 131072: for (t = n.readUInt16(), this.glyphNameIndex = [], i = 0; 0 <= t ? i < t : t < i; 0 <= t ? ++i : --i)this.glyphNameIndex.push(n.readUInt16()); for (this.names = [], a = []; n.pos < this.offset + this.length;)e = n.readByte(), a.push(this.names.push(n.readString(e))); return a; case 151552: return t = n.readUInt16(), this.offsets = n.read(t); case 196608: break; case 262144: return this.map = function () { var e, t, i; for (i = [], e = 0, t = this.file.maxp.numGlyphs; 0 <= t ? e < t : t < e; 0 <= t ? ++e : --e)i.push(n.readUInt32()); return i }.call(this) } }, t }(), y = function (e, t) { this.raw = e, this.length = e.length, this.platformID = t.platformID, this.encodingID = t.encodingID, this.languageID = t.languageID }, b = function (e) { function t() { return t.__super__.constructor.apply(this, arguments) } return h(t, c), t.prototype.tag = "name", t.prototype.parse = function (e) { var t, i, n, a, s, r, o, l, c, d, u, h; for (e.pos = this.offset, e.readShort(), t = e.readShort(), r = e.readShort(), i = [], a = c = 0; 0 <= t ? c < t : t < c; a = 0 <= t ? ++c : --c)i.push({ platformID: e.readShort(), encodingID: e.readShort(), languageID: e.readShort(), nameID: e.readShort(), length: e.readShort(), offset: this.offset + r + e.readShort() }); for (o = {}, a = d = 0, u = i.length; d < u; a = ++d)n = i[a], e.pos = n.offset, l = e.readString(n.length), s = new y(l, n), null == o[h = n.nameID] && (o[h] = []), o[n.nameID].push(s); return this.strings = o, this.copyright = o[0], this.fontFamily = o[1], this.fontSubfamily = o[2], this.uniqueSubfamily = o[3], this.fontName = o[4], this.version = o[5], this.postscriptName = o[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g, ""), this.trademark = o[7], this.manufacturer = o[8], this.designer = o[9], this.description = o[10], this.vendorUrl = o[11], this.designerUrl = o[12], this.license = o[13], this.licenseUrl = o[14], this.preferredFamily = o[15], this.preferredSubfamily = o[17], this.compatibleFull = o[18], this.sampleText = o[19] }, t }(), w = function (e) { function t() { return t.__super__.constructor.apply(this, arguments) } return h(t, c), t.prototype.tag = "maxp", t.prototype.parse = function (e) { return e.pos = this.offset, this.version = e.readInt(), this.numGlyphs = e.readUInt16(), this.maxPoints = e.readUInt16(), this.maxContours = e.readUInt16(), this.maxCompositePoints = e.readUInt16(), this.maxComponentContours = e.readUInt16(), this.maxZones = e.readUInt16(), this.maxTwilightPoints = e.readUInt16(), this.maxStorage = e.readUInt16(), this.maxFunctionDefs = e.readUInt16(), this.maxInstructionDefs = e.readUInt16(), this.maxStackElements = e.readUInt16(), this.maxSizeOfInstructions = e.readUInt16(), this.maxComponentElements = e.readUInt16(), this.maxComponentDepth = e.readUInt16() }, t }(), C = function (e) { function t() { return t.__super__.constructor.apply(this, arguments) } return h(t, c), t.prototype.tag = "hmtx", t.prototype.parse = function (i) { var e, n, a, t, s, r, o; for (i.pos = this.offset, this.metrics = [], t = 0, r = this.file.hhea.numberOfMetrics; 0 <= r ? t < r : r < t; 0 <= r ? ++t : --t)this.metrics.push({ advance: i.readUInt16(), lsb: i.readInt16() }); for (n = this.file.maxp.numGlyphs - this.file.hhea.numberOfMetrics, this.leftSideBearings = function () { var e, t; for (t = [], e = 0; 0 <= n ? e < n : n < e; 0 <= n ? ++e : --e)t.push(i.readInt16()); return t }(), this.widths = function () { var e, t, i, n; for (n = [], e = 0, t = (i = this.metrics).length; e < t; e++)a = i[e], n.push(a.advance); return n }.call(this), e = this.widths[this.widths.length - 1], o = [], s = 0; 0 <= n ? s < n : n < s; 0 <= n ? ++s : --s)o.push(this.widths.push(e)); return o }, t.prototype.forGlyph = function (e) { return e in this.metrics ? this.metrics[e] : { advance: this.metrics[this.metrics.length - 1].advance, lsb: this.leftSideBearings[e - this.metrics.length] } }, t }(), x = [].slice, k = function (e) { function t() { return t.__super__.constructor.apply(this, arguments) } return h(t, c), t.prototype.tag = "glyf", t.prototype.parse = function (e) { return this.cache = {} }, t.prototype.glyphFor = function (e) { var t, i, n, a, s, r, o, l, c, d; return (e = e) in this.cache ? this.cache[e] : (a = this.file.loca, t = this.file.contents, i = a.indexOf(e), 0 === (n = a.lengthOf(e)) ? this.cache[e] = null : (t.pos = this.offset + i, s = (r = new G(t.read(n))).readShort(), l = r.readShort(), d = r.readShort(), o = r.readShort(), c = r.readShort(), this.cache[e] = -1 === s ? new S(r, l, d, o, c) : new T(r, s, l, d, o, c), this.cache[e])) }, t.prototype.encode = function (e, t, i) { var n, a, s, r, o; for (s = [], a = [], r = 0, o = t.length; r < o; r++)n = e[t[r]], a.push(s.length), n && (s = s.concat(n.encode(i))); return a.push(s.length), { table: s, offsets: a } }, t }(), T = function () { function e(e, t, i, n, a, s) { this.raw = e, this.numberOfContours = t, this.xMin = i, this.yMin = n, this.xMax = a, this.yMax = s, this.compound = !1 } return e.prototype.encode = function () { return this.raw.data }, e }(), S = function () { function e(e, t, i, n, a) { var s, r; for (this.raw = e, this.xMin = t, this.yMin = i, this.xMax = n, this.yMax = a, this.compound = !0, this.glyphIDs = [], this.glyphOffsets = [], s = this.raw; r = s.readShort(), this.glyphOffsets.push(s.pos), this.glyphIDs.push(s.readShort()), 32 & r;)s.pos += 1 & r ? 4 : 2, 128 & r ? s.pos += 8 : 64 & r ? s.pos += 4 : 8 & r && (s.pos += 2) } return 1, 8, 32, 64, 128, e.prototype.encode = function (e) { var t, i, n, a, s; for (i = new G(x.call(this.raw.data)), t = n = 0, a = (s = this.glyphIDs).length; n < a; t = ++n)s[t], i.pos = this.glyphOffsets[t]; return i.data }, e }(), $ = function (e) { function t() { return t.__super__.constructor.apply(this, arguments) } return h(t, c), t.prototype.tag = "loca", t.prototype.parse = function (n) { var e; return n.pos = this.offset, e = this.file.head.indexToLocFormat, this.offsets = 0 === e ? function () { var e, t, i; for (i = [], e = 0, t = this.length; e < t; e += 2)i.push(2 * n.readUInt16()); return i }.call(this) : function () { var e, t, i; for (i = [], e = 0, t = this.length; e < t; e += 4)i.push(n.readUInt32()); return i }.call(this) }, t.prototype.indexOf = function (e) { return this.offsets[e] }, t.prototype.lengthOf = function (e) { return this.offsets[e + 1] - this.offsets[e] }, t.prototype.encode = function (e, t) { for (var i = new Uint32Array(this.offsets.length), n = 0, a = 0, s = 0; s < i.length; ++s)if (i[s] = n, a < t.length && t[a] == s) { ++a, i[s] = n; var r = this.offsets[s], o = this.offsets[s + 1] - r; 0 < o && (n += o) } for (var l = new Array(4 * i.length), c = 0; c < i.length; ++c)l[4 * c + 3] = 255 & i[c], l[4 * c + 2] = (65280 & i[c]) >> 8, l[4 * c + 1] = (16711680 & i[c]) >> 16, l[4 * c] = (4278190080 & i[c]) >> 24; return l }, t }(), A = function () { function e(e) { this.font = e, this.subset = {}, this.unicodes = {}, this.next = 33 } return e.prototype.generateCmap = function () { var e, t, i, n, a; for (t in n = this.font.cmap.tables[0].codeMap, e = {}, a = this.subset) i = a[t], e[t] = n[i]; return e }, e.prototype.glyphsFor = function (e) { var t, i, n, a, s, r, o; for (n = {}, s = 0, r = e.length; s < r; s++)n[a = e[s]] = this.font.glyf.glyphFor(a); for (a in t = [], n) (null != (i = n[a]) ? i.compound : void 0) && t.push.apply(t, i.glyphIDs); if (0 < t.length) for (a in o = this.glyphsFor(t)) i = o[a], n[a] = i; return n }, e.prototype.encode = function (e) { var t, i, n, a, s, r, o, l, c, d, u, h, p, f, m; for (i in t = g.encode(this.generateCmap(), "unicode"), a = this.glyphsFor(e), u = { 0: 0 }, m = t.charMap) u[(r = m[i]).old] = r.new; for (h in d = t.maxGlyphID, a) h in u || (u[h] = d++); return l = function (e) { var t, i; for (t in i = {}, e) i[e[t]] = t; return i }(u), c = Object.keys(l).sort(function (e, t) { return e - t }), p = function () { var e, t, i; for (i = [], e = 0, t = c.length; e < t; e++)s = c[e], i.push(l[s]); return i }(), n = this.font.glyf.encode(a, p, u), o = this.font.loca.encode(n.offsets, p), f = { cmap: this.font.cmap.raw(), glyf: n.table, loca: o, hmtx: this.font.hmtx.raw(), hhea: this.font.hhea.raw(), maxp: this.font.maxp.raw(), post: this.font.post.raw(), name: this.font.name.raw(), head: this.font.head.raw() }, this.font.os2.exists && (f["OS/2"] = this.font.os2.raw()), this.font.directory.encode(f) }, e }(); e.API.PDFObject = function () { var s; function r() { } return s = function (e, t) { return (Array(t + 1).join("0") + e).slice(-t) }, r.convert = function (n) { var a, e, t, i; if (Array.isArray(n)) return "[" + function () { var e, t, i; for (i = [], e = 0, t = n.length; e < t; e++)a = n[e], i.push(r.convert(a)); return i }().join(" ") + "]"; if ("string" == typeof n) return "/" + n; if (null != n ? n.isString : void 0) return "(" + n + ")"; if (n instanceof Date) return "(D:" + s(n.getUTCFullYear(), 4) + s(n.getUTCMonth(), 2) + s(n.getUTCDate(), 2) + s(n.getUTCHours(), 2) + s(n.getUTCMinutes(), 2) + s(n.getUTCSeconds(), 2) + "Z)"; if ("[object Object]" === {}.toString.call(n)) { for (e in t = ["<<"], n) i = n[e], t.push("/" + e + " " + r.convert(i)); return t.push(">>"), t.join("\n") } return "" + n }, r }() }(Z), me = "undefined" != typeof self && self || "undefined" != typeof window && window || "undefined" != typeof global && global || Function('return typeof this === "object" && this.content')() || Function("return this")(), ge = function () { var c, i, n; function a(e) { var t, i, n, a, s, r, o, l, c, d, u, h, p, f; for (this.data = e, this.pos = 8, this.palette = [], this.imgData = [], this.transparency = {}, this.animation = null, this.text = {}, r = null; ;) { switch (t = this.readUInt32(), c = function () { var e, t; for (t = [], e = 0; e < 4; ++e)t.push(String.fromCharCode(this.data[this.pos++])); return t }.call(this).join("")) { case "IHDR": this.width = this.readUInt32(), this.height = this.readUInt32(), this.bits = this.data[this.pos++], this.colorType = this.data[this.pos++], this.compressionMethod = this.data[this.pos++], this.filterMethod = this.data[this.pos++], this.interlaceMethod = this.data[this.pos++]; break; case "acTL": this.animation = { numFrames: this.readUInt32(), numPlays: this.readUInt32() || 1 / 0, frames: [] }; break; case "PLTE": this.palette = this.read(t); break; case "fcTL": r && this.animation.frames.push(r), this.pos += 4, r = { width: this.readUInt32(), height: this.readUInt32(), xOffset: this.readUInt32(), yOffset: this.readUInt32() }, s = this.readUInt16(), a = this.readUInt16() || 100, r.delay = 1e3 * s / a, r.disposeOp = this.data[this.pos++], r.blendOp = this.data[this.pos++], r.data = []; break; case "IDAT": case "fdAT": for ("fdAT" === c && (this.pos += 4, t -= 4), e = (null != r ? r.data : void 0) || this.imgData, h = 0; 0 <= t ? h < t : t < h; 0 <= t ? ++h : --h)e.push(this.data[this.pos++]); break; case "tRNS": switch (this.transparency = {}, this.colorType) { case 3: if (n = this.palette.length / 3, this.transparency.indexed = this.read(t), this.transparency.indexed.length > n) throw new Error("More transparent colors than palette size"); if (0 < (d = n - this.transparency.indexed.length)) for (p = 0; 0 <= d ? p < d : d < p; 0 <= d ? ++p : --p)this.transparency.indexed.push(255); break; case 0: this.transparency.grayscale = this.read(t)[0]; break; case 2: this.transparency.rgb = this.read(t) }break; case "tEXt": o = (u = this.read(t)).indexOf(0), l = String.fromCharCode.apply(String, u.slice(0, o)), this.text[l] = String.fromCharCode.apply(String, u.slice(o + 1)); break; case "IEND": return r && this.animation.frames.push(r), this.colors = function () { switch (this.colorType) { case 0: case 3: case 4: return 1; case 2: case 6: return 3 } }.call(this), this.hasAlphaChannel = 4 === (f = this.colorType) || 6 === f, i = this.colors + (this.hasAlphaChannel ? 1 : 0), this.pixelBitlength = this.bits * i, this.colorSpace = function () { switch (this.colors) { case 1: return "DeviceGray"; case 3: return "DeviceRGB" } }.call(this), void (this.imgData = new Uint8Array(this.imgData)); default: this.pos += t }if (this.pos += 4, this.pos > this.data.length) throw new Error("Incomplete or corrupt PNG file") } } a.load = function (e, t, i) { var n; return "function" == typeof t && (i = t), (n = new XMLHttpRequest).open("GET", e, !0), n.responseType = "arraybuffer", n.onload = function () { var e; return e = new a(new Uint8Array(n.response || n.mozResponseArrayBuffer)), "function" == typeof (null != t ? t.getContext : void 0) && e.render(t), "function" == typeof i ? i(e) : void 0 }, n.send(null) }, a.prototype.read = function (e) { var t, i; for (i = [], t = 0; 0 <= e ? t < e : e < t; 0 <= e ? ++t : --t)i.push(this.data[this.pos++]); return i }, a.prototype.readUInt32 = function () { return this.data[this.pos++] << 24 | this.data[this.pos++] << 16 | this.data[this.pos++] << 8 | this.data[this.pos++] }, a.prototype.readUInt16 = function () { return this.data[this.pos++] << 8 | this.data[this.pos++] }, a.prototype.decodePixels = function (P) { var j = this.pixelBitlength / 8, L = new Uint8Array(this.width * this.height * j), M = 0, R = this; if (null == P && (P = this.imgData), 0 === P.length) return new Uint8Array(0); function e(e, t, i, n) { var a, s, r, o, l, c, d, u, h, p, f, m, g, _, v, y, b, w, C, x, k, T = Math.ceil((R.width - e) / i), S = Math.ceil((R.height - t) / n), $ = R.width == T && R.height == S; for (_ = j * T, m = $ ? L : new Uint8Array(_ * S), c = P.length, s = g = 0; g < S && M < c;) { switch (P[M++]) { case 0: for (o = b = 0; b < _; o = b += 1)m[s++] = P[M++]; break; case 1: for (o = w = 0; w < _; o = w += 1)a = P[M++], l = o < j ? 0 : m[s - j], m[s++] = (a + l) % 256; break; case 2: for (o = C = 0; C < _; o = C += 1)a = P[M++], r = (o - o % j) / j, v = g && m[(g - 1) * _ + r * j + o % j], m[s++] = (v + a) % 256; break; case 3: for (o = x = 0; x < _; o = x += 1)a = P[M++], r = (o - o % j) / j, l = o < j ? 0 : m[s - j], v = g && m[(g - 1) * _ + r * j + o % j], m[s++] = (a + Math.floor((l + v) / 2)) % 256; break; case 4: for (o = k = 0; k < _; o = k += 1)a = P[M++], r = (o - o % j) / j, l = o < j ? 0 : m[s - j], 0 === g ? v = y = 0 : (v = m[(g - 1) * _ + r * j + o % j], y = r && m[(g - 1) * _ + (r - 1) * j + o % j]), d = l + v - y, u = Math.abs(d - l), p = Math.abs(d - v), f = Math.abs(d - y), h = u <= p && u <= f ? l : p <= f ? v : y, m[s++] = (a + h) % 256; break; default: throw new Error("Invalid filter algorithm: " + P[M - 1]) }if (!$) { var A = ((t + g * n) * R.width + e) * j, I = g * _; for (o = 0; o < T; o += 1) { for (var D = 0; D < j; D += 1)L[A++] = m[I++]; A += (i - 1) * j } } g++ } } return P = (P = new ke(P)).getBytes(), 1 == R.interlaceMethod ? (e(0, 0, 8, 8), e(4, 0, 8, 8), e(0, 4, 4, 8), e(2, 0, 4, 4), e(0, 2, 2, 4), e(1, 0, 2, 2), e(0, 1, 1, 2)) : e(0, 0, 1, 1), L }, a.prototype.decodePalette = function () { var e, t, i, n, a, s, r, o, l; for (i = this.palette, s = this.transparency.indexed || [], a = new Uint8Array((s.length || 0) + i.length), n = 0, i.length, t = r = e = 0, o = i.length; r < o; t = r += 3)a[n++] = i[t], a[n++] = i[t + 1], a[n++] = i[t + 2], a[n++] = null != (l = s[e++]) ? l : 255; return a }, a.prototype.copyToImageData = function (e, t) { var i, n, a, s, r, o, l, c, d, u, h; if (n = this.colors, d = null, i = this.hasAlphaChannel, this.palette.length && (d = null != (h = this._decodedPalette) ? h : this._decodedPalette = this.decodePalette(), n = 4, i = !0), c = (a = e.data || e).length, r = d || t, s = o = 0, 1 === n) for (; s < c;)l = d ? 4 * t[s / 4] : o, u = r[l++], a[s++] = u, a[s++] = u, a[s++] = u, a[s++] = i ? r[l++] : 255, o = l; else for (; s < c;)l = d ? 4 * t[s / 4] : o, a[s++] = r[l++], a[s++] = r[l++], a[s++] = r[l++], a[s++] = i ? r[l++] : 255, o = l }, a.prototype.decode = function () { var e; return e = new Uint8Array(this.width * this.height * 4), this.copyToImageData(e, this.decodePixels()), e }; try { i = me.document.createElement("canvas"), n = i.getContext("2d") } catch (e) { return -1 } return c = function (e) { var t; return n.width = e.width, n.height = e.height, n.clearRect(0, 0, e.width, e.height), n.putImageData(e, 0, 0), (t = new Image).src = i.toDataURL(), t }, a.prototype.decodeFrames = function (e) { var t, i, n, a, s, r, o, l; if (this.animation) { for (l = [], i = s = 0, r = (o = this.animation.frames).length; s < r; i = ++s)t = o[i], n = e.createImageData(t.width, t.height), a = this.decodePixels(new Uint8Array(t.data)), this.copyToImageData(n, a), t.imageData = n, l.push(t.image = c(n)); return l } }, a.prototype.renderFrame = function (e, t) { var i, n, a; return i = (n = this.animation.frames)[t], a = n[t - 1], 0 === t && e.clearRect(0, 0, this.width, this.height), 1 === (null != a ? a.disposeOp : void 0) ? e.clearRect(a.xOffset, a.yOffset, a.width, a.height) : 2 === (null != a ? a.disposeOp : void 0) && e.putImageData(a.imageData, a.xOffset, a.yOffset), 0 === i.blendOp && e.clearRect(i.xOffset, i.yOffset, i.width, i.height), e.drawImage(i.image, i.xOffset, i.yOffset) }, a.prototype.animate = function (i) { var n, a, s, r, o, e, l = this; return a = 0, e = this.animation, r = e.numFrames, s = e.frames, o = e.numPlays, (n = function () { var e, t; if (e = a++ % r, t = s[e], l.renderFrame(i, e), 1 < r && a / r < o) return l.animation._timeout = setTimeout(n, t.delay) })() }, a.prototype.stopAnimation = function () { var e; return clearTimeout(null != (e = this.animation) ? e._timeout : void 0) }, a.prototype.render = function (e) { var t, i; return e._png && e._png.stopAnimation(), e._png = this, e.width = this.width, e.height = this.height, t = e.getContext("2d"), this.animation ? (this.decodeFrames(t), this.animate(t)) : (i = t.createImageData(this.width, this.height), this.copyToImageData(i, this.decodePixels()), t.putImageData(i, 0, 0)) }, a }(), me.PNG = ge; var xe = function () { function e() { this.pos = 0, this.bufferLength = 0, this.eof = !1, this.buffer = null } return e.prototype = { ensureBuffer: function (e) { var t = this.buffer, i = t ? t.byteLength : 0; if (e < i) return t; for (var n = 512; n < e;)n <<= 1; for (var a = new Uint8Array(n), s = 0; s < i; ++s)a[s] = t[s]; return this.buffer = a }, getByte: function () { for (var e = this.pos; this.bufferLength <= e;) { if (this.eof) return null; this.readBlock() } return this.buffer[this.pos++] }, getBytes: function (e) { var t = this.pos; if (e) { this.ensureBuffer(t + e); for (var i = t + e; !this.eof && this.bufferLength < i;)this.readBlock(); var n = this.bufferLength; n < i && (i = n) } else { for (; !this.eof;)this.readBlock(); i = this.bufferLength } return this.pos = i, this.buffer.subarray(t, i) }, lookChar: function () { for (var e = this.pos; this.bufferLength <= e;) { if (this.eof) return null; this.readBlock() } return String.fromCharCode(this.buffer[this.pos]) }, getChar: function () { for (var e = this.pos; this.bufferLength <= e;) { if (this.eof) return null; this.readBlock() } return String.fromCharCode(this.buffer[this.pos++]) }, makeSubStream: function (e, t, i) { for (var n = e + t; this.bufferLength <= n && !this.eof;)this.readBlock(); return new Stream(this.buffer, e, t, i) }, skip: function (e) { e || (e = 1), this.pos += e }, reset: function () { this.pos = 0 } }, e }(), ke = function () { if ("undefined" != typeof Uint32Array) { var I = new Uint32Array([16, 17, 18, 0, 8, 7, 9, 6, 10, 5, 11, 4, 12, 3, 13, 2, 14, 1, 15]), D = new Uint32Array([3, 4, 5, 6, 7, 8, 9, 10, 65547, 65549, 65551, 65553, 131091, 131095, 131099, 131103, 196643, 196651, 196659, 196667, 262211, 262227, 262243, 262259, 327811, 327843, 327875, 327907, 258, 258, 258]), P = new Uint32Array([1, 2, 3, 4, 65541, 65543, 131081, 131085, 196625, 196633, 262177, 262193, 327745, 327777, 393345, 393409, 459009, 459137, 524801, 525057, 590849, 591361, 657409, 658433, 724993, 727041, 794625, 798721, 868353, 876545]), j = [new Uint32Array([459008, 524368, 524304, 524568, 459024, 524400, 524336, 590016, 459016, 524384, 524320, 589984, 524288, 524416, 524352, 590048, 459012, 524376, 524312, 589968, 459028, 524408, 524344, 590032, 459020, 524392, 524328, 59e4, 524296, 524424, 524360, 590064, 459010, 524372, 524308, 524572, 459026, 524404, 524340, 590024, 459018, 524388, 524324, 589992, 524292, 524420, 524356, 590056, 459014, 524380, 524316, 589976, 459030, 524412, 524348, 590040, 459022, 524396, 524332, 590008, 524300, 524428, 524364, 590072, 459009, 524370, 524306, 524570, 459025, 524402, 524338, 590020, 459017, 524386, 524322, 589988, 524290, 524418, 524354, 590052, 459013, 524378, 524314, 589972, 459029, 524410, 524346, 590036, 459021, 524394, 524330, 590004, 524298, 524426, 524362, 590068, 459011, 524374, 524310, 524574, 459027, 524406, 524342, 590028, 459019, 524390, 524326, 589996, 524294, 524422, 524358, 590060, 459015, 524382, 524318, 589980, 459031, 524414, 524350, 590044, 459023, 524398, 524334, 590012, 524302, 524430, 524366, 590076, 459008, 524369, 524305, 524569, 459024, 524401, 524337, 590018, 459016, 524385, 524321, 589986, 524289, 524417, 524353, 590050, 459012, 524377, 524313, 589970, 459028, 524409, 524345, 590034, 459020, 524393, 524329, 590002, 524297, 524425, 524361, 590066, 459010, 524373, 524309, 524573, 459026, 524405, 524341, 590026, 459018, 524389, 524325, 589994, 524293, 524421, 524357, 590058, 459014, 524381, 524317, 589978, 459030, 524413, 524349, 590042, 459022, 524397, 524333, 590010, 524301, 524429, 524365, 590074, 459009, 524371, 524307, 524571, 459025, 524403, 524339, 590022, 459017, 524387, 524323, 589990, 524291, 524419, 524355, 590054, 459013, 524379, 524315, 589974, 459029, 524411, 524347, 590038, 459021, 524395, 524331, 590006, 524299, 524427, 524363, 590070, 459011, 524375, 524311, 524575, 459027, 524407, 524343, 590030, 459019, 524391, 524327, 589998, 524295, 524423, 524359, 590062, 459015, 524383, 524319, 589982, 459031, 524415, 524351, 590046, 459023, 524399, 524335, 590014, 524303, 524431, 524367, 590078, 459008, 524368, 524304, 524568, 459024, 524400, 524336, 590017, 459016, 524384, 524320, 589985, 524288, 524416, 524352, 590049, 459012, 524376, 524312, 589969, 459028, 524408, 524344, 590033, 459020, 524392, 524328, 590001, 524296, 524424, 524360, 590065, 459010, 524372, 524308, 524572, 459026, 524404, 524340, 590025, 459018, 524388, 524324, 589993, 524292, 524420, 524356, 590057, 459014, 524380, 524316, 589977, 459030, 524412, 524348, 590041, 459022, 524396, 524332, 590009, 524300, 524428, 524364, 590073, 459009, 524370, 524306, 524570, 459025, 524402, 524338, 590021, 459017, 524386, 524322, 589989, 524290, 524418, 524354, 590053, 459013, 524378, 524314, 589973, 459029, 524410, 524346, 590037, 459021, 524394, 524330, 590005, 524298, 524426, 524362, 590069, 459011, 524374, 524310, 524574, 459027, 524406, 524342, 590029, 459019, 524390, 524326, 589997, 524294, 524422, 524358, 590061, 459015, 524382, 524318, 589981, 459031, 524414, 524350, 590045, 459023, 524398, 524334, 590013, 524302, 524430, 524366, 590077, 459008, 524369, 524305, 524569, 459024, 524401, 524337, 590019, 459016, 524385, 524321, 589987, 524289, 524417, 524353, 590051, 459012, 524377, 524313, 589971, 459028, 524409, 524345, 590035, 459020, 524393, 524329, 590003, 524297, 524425, 524361, 590067, 459010, 524373, 524309, 524573, 459026, 524405, 524341, 590027, 459018, 524389, 524325, 589995, 524293, 524421, 524357, 590059, 459014, 524381, 524317, 589979, 459030, 524413, 524349, 590043, 459022, 524397, 524333, 590011, 524301, 524429, 524365, 590075, 459009, 524371, 524307, 524571, 459025, 524403, 524339, 590023, 459017, 524387, 524323, 589991, 524291, 524419, 524355, 590055, 459013, 524379, 524315, 589975, 459029, 524411, 524347, 590039, 459021, 524395, 524331, 590007, 524299, 524427, 524363, 590071, 459011, 524375, 524311, 524575, 459027, 524407, 524343, 590031, 459019, 524391, 524327, 589999, 524295, 524423, 524359, 590063, 459015, 524383, 524319, 589983, 459031, 524415, 524351, 590047, 459023, 524399, 524335, 590015, 524303, 524431, 524367, 590079]), 9], L = [new Uint32Array([327680, 327696, 327688, 327704, 327684, 327700, 327692, 327708, 327682, 327698, 327690, 327706, 327686, 327702, 327694, 0, 327681, 327697, 327689, 327705, 327685, 327701, 327693, 327709, 327683, 327699, 327691, 327707, 327687, 327703, 327695, 0]), 5]; return (e.prototype = Object.create(xe.prototype)).getBits = function (e) { for (var t, i = this.codeSize, n = this.codeBuf, a = this.bytes, s = this.bytesPos; i < e;)void 0 === (t = a[s++]) && M("Bad encoding in flate stream"), n |= t << i, i += 8; return t = n & (1 << e) - 1, this.codeBuf = n >> e, this.codeSize = i -= e, this.bytesPos = s, t }, e.prototype.getCode = function (e) { for (var t = e[0], i = e[1], n = this.codeSize, a = this.codeBuf, s = this.bytes, r = this.bytesPos; n < i;) { var o; void 0 === (o = s[r++]) && M("Bad encoding in flate stream"), a |= o << n, n += 8 } var l = t[a & (1 << i) - 1], c = l >> 16, d = 65535 & l; return (0 == n || n < c || 0 == c) && M("Bad encoding in flate stream"), this.codeBuf = a >> c, this.codeSize = n - c, this.bytesPos = r, d }, e.prototype.generateHuffmanTable = function (e) { for (var t = e.length, i = 0, n = 0; n < t; ++n)e[n] > i && (i = e[n]); for (var a = 1 << i, s = new Uint32Array(a), r = 1, o = 0, l = 2; r <= i; ++r, o <<= 1, l <<= 1)for (var c = 0; c < t; ++c)if (e[c] == r) { var d = 0, u = o; for (n = 0; n < r; ++n)d = d << 1 | 1 & u, u >>= 1; for (n = d; n < a; n += l)s[n] = r << 16 | c; ++o } return [s, i] }, e.prototype.readBlock = function () { function e(e, t, i, n, a) { for (var s = e.getBits(i) + n; 0 < s--;)t[l++] = a } var t = this.getBits(3); if (1 & t && (this.eof = !0), 0 != (t >>= 1)) { var i, n; if (1 == t) i = j, n = L; else if (2 == t) { for (var a = this.getBits(5) + 257, s = this.getBits(5) + 1, r = this.getBits(4) + 4, o = Array(I.length), l = 0; l < r;)o[I[l++]] = this.getBits(3); for (var c = this.generateHuffmanTable(o), d = 0, u = (l = 0, a + s), h = new Array(u); l < u;) { var p = this.getCode(c); 16 == p ? e(this, h, 2, 3, d) : 17 == p ? e(this, h, 3, 3, d = 0) : 18 == p ? e(this, h, 7, 11, d = 0) : h[l++] = d = p } i = this.generateHuffmanTable(h.slice(0, a)), n = this.generateHuffmanTable(h.slice(a, u)) } else M("Unknown block type in flate stream"); for (var f = (S = this.buffer) ? S.length : 0, m = this.bufferLength; ;) { var g = this.getCode(i); if (g < 256) f <= m + 1 && (f = (S = this.ensureBuffer(m + 1)).length), S[m++] = g; else { if (256 == g) return void (this.bufferLength = m); var _ = (g = D[g -= 257]) >> 16; 0 < _ && (_ = this.getBits(_)); d = (65535 & g) + _; g = this.getCode(n), 0 < (_ = (g = P[g]) >> 16) && (_ = this.getBits(_)); var v = (65535 & g) + _; f <= m + d && (f = (S = this.ensureBuffer(m + d)).length); for (var y = 0; y < d; ++y, ++m)S[m] = S[m - v] } } } else { var b, w = this.bytes, C = this.bytesPos; void 0 === (b = w[C++]) && M("Bad block header in flate stream"); var x = b; void 0 === (b = w[C++]) && M("Bad block header in flate stream"), x |= b << 8, void 0 === (b = w[C++]) && M("Bad block header in flate stream"); var k = b; void 0 === (b = w[C++]) && M("Bad block header in flate stream"), (k |= b << 8) != (65535 & ~x) && M("Bad uncompressed block length in flate stream"), this.codeBuf = 0, this.codeSize = 0; var T = this.bufferLength, S = this.ensureBuffer(T + x), $ = T + x; this.bufferLength = $; for (var A = T; A < $; ++A) { if (void 0 === (b = w[C++])) { this.eof = !0; break } S[A] = b } this.bytesPos = C } }, e } function M(e) { throw new Error(e) } function e(e) { var t = 0, i = e[t++], n = e[t++]; -1 != i && -1 != n || M("Invalid header in flate stream"), 8 != (15 & i) && M("Unknown compression method in flate stream"), ((i << 8) + n) % 31 != 0 && M("Bad FCHECK in flate stream"), 32 & n && M("FDICT bit set in flate stream"), this.bytes = e, this.bytesPos = 2, this.codeSize = 0, this.codeBuf = 0, xe.call(this) } }(); return function (e) { if ("object" != typeof e.console) { e.console = {}; for (var t, i, n = e.console, a = function () { }, s = ["memory"], r = "assert,clear,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profiles,profileEnd,show,table,time,timeEnd,timeline,timelineEnd,timeStamp,trace,warn".split(","); t = s.pop();)n[t] || (n[t] = {}); for (; i = r.pop();)n[i] || (n[i] = a) } var o, l, c, d, u = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="; void 0 === e.btoa && (e.btoa = function (e) { var t, i, n, a, s, r = 0, o = 0, l = "", c = []; if (!e) return e; for (; t = (s = e.charCodeAt(r++) << 16 | e.charCodeAt(r++) << 8 | e.charCodeAt(r++)) >> 18 & 63, i = s >> 12 & 63, n = s >> 6 & 63, a = 63 & s, c[o++] = u.charAt(t) + u.charAt(i) + u.charAt(n) + u.charAt(a), r < e.length;); l = c.join(""); var d = e.length % 3; return (d ? l.slice(0, d - 3) : l) + "===".slice(d || 3) }), void 0 === e.atob && (e.atob = function (e) { var t, i, n, a, s, r, o = 0, l = 0, c = []; if (!e) return e; for (e += ""; t = (r = u.indexOf(e.charAt(o++)) << 18 | u.indexOf(e.charAt(o++)) << 12 | (a = u.indexOf(e.charAt(o++))) << 6 | (s = u.indexOf(e.charAt(o++)))) >> 16 & 255, i = r >> 8 & 255, n = 255 & r, c[l++] = 64 == a ? String.fromCharCode(t) : 64 == s ? String.fromCharCode(t, i) : String.fromCharCode(t, i, n), o < e.length;); return c.join("") }), Array.prototype.map || (Array.prototype.map = function (e) { if (null == this || "function" != typeof e) throw new TypeError; for (var t = Object(this), i = t.length >>> 0, n = new Array(i), a = 1 < arguments.length ? arguments[1] : void 0, s = 0; s < i; s++)s in t && (n[s] = e.call(a, t[s], s, t)); return n }), Array.isArray || (Array.isArray = function (e) { return "[object Array]" === Object.prototype.toString.call(e) }), Array.prototype.forEach || (Array.prototype.forEach = function (e, t) { if (null == this || "function" != typeof e) throw new TypeError; for (var i = Object(this), n = i.length >>> 0, a = 0; a < n; a++)a in i && e.call(t, i[a], a, i) }), Object.keys || (Object.keys = (o = Object.prototype.hasOwnProperty, l = !{ toString: null }.propertyIsEnumerable("toString"), d = (c = ["toString", "toLocaleString", "valueOf", "hasOwnProperty", "isPrototypeOf", "propertyIsEnumerable", "constructor"]).length, function (e) { if ("object" != typeof e && ("function" != typeof e || null === e)) throw new TypeError; var t, i, n = []; for (t in e) o.call(e, t) && n.push(t); if (l) for (i = 0; i < d; i++)o.call(e, c[i]) && n.push(c[i]); return n })), "function" != typeof Object.assign && (Object.assign = function (e) { if (null == e) throw new TypeError("Cannot convert undefined or null to object"); e = Object(e); for (var t = 1; t < arguments.length; t++) { var i = arguments[t]; if (null != i) for (var n in i) Object.prototype.hasOwnProperty.call(i, n) && (e[n] = i[n]) } return e }), String.prototype.trim || (String.prototype.trim = function () { return this.replace(/^\s+|\s+$/g, "") }), String.prototype.trimLeft || (String.prototype.trimLeft = function () { return this.replace(/^\s+/g, "") }), String.prototype.trimRight || (String.prototype.trimRight = function () { return this.replace(/\s+$/g, "") }) }("undefined" != typeof self && self || "undefined" != typeof window && window || "undefined" != typeof global && global || Function('return typeof this === "object" && this.content')() || Function("return this")()), Z }), function (o) { o.fn.qrcode = function (d) { var t, i; return "string" == typeof d && (d = { text: d }), d = o.extend({}, { render: "canvas", width: 256, height: 256, imgWidth: d.width / 2.5, imgHeight: d.height / 2.5, typeNumber: -1, correctLevel: QRErrorCorrectLevel.H, background: "#ffffff", foreground: "#000000" }, d), t = function () { var e, t, i, n, a, s, r, o, l, c = new QRCode(d.typeNumber, d.correctLevel); for (c.addData(d.text), c.make(), (e = document.createElement("canvas")).width = d.width, e.height = d.height, t = e.getContext("2d"), d.src && ((i = new Image).src = d.src, i.onload = function () { t.drawImage(i, (d.width - d.imgWidth) / 2, (d.height - d.imgHeight) / 2, d.imgWidth, d.imgHeight) }), n = d.width / c.getModuleCount(), a = d.height / c.getModuleCount(), s = 0; s < c.getModuleCount(); s++)for (r = 0; r < c.getModuleCount(); r++)t.fillStyle = c.isDark(s, r) ? d.foreground : d.background, o = Math.ceil((r + 1) * n) - Math.floor(r * n), l = Math.ceil((s + 1) * n) - Math.floor(s * n), t.fillRect(Math.round(r * n), Math.round(s * a), o, l); return e }, i = function () { var e, t, i, n, a, s, r = new QRCode(d.typeNumber, d.correctLevel); for (r.addData(d.text), r.make(), e = o("<table></table>").css("width", d.width + "px").css("height", d.height + "px").css("border", "0px").css("border-collapse", "collapse").css("background-color", d.background), t = d.width / r.getModuleCount(), i = d.height / r.getModuleCount(), n = 0; n < r.getModuleCount(); n++)for (a = o("<tr></tr>").css("height", i + "px").appendTo(e), s = 0; s < r.getModuleCount(); s++)o("<td></td>").css("width", t + "px").css("background-color", r.isDark(n, s) ? d.foreground : d.background).appendTo(a); return e }, this.each(function () { var e = "canvas" == d.render ? t() : i(); o(e).appendTo(this) }) } }(jQuery), QR8bitByte.prototype = { getLength: function () { return this.data.length }, write: function (e) { for (var t = 0; t < this.data.length; t++)e.put(this.data.charCodeAt(t), 8) } }, QRCode.prototype = { addData: function (e) { var t = new QR8bitByte(e); this.dataList.push(t), this.dataCache = null }, isDark: function (e, t) { if (e < 0 || this.moduleCount <= e || t < 0 || this.moduleCount <= t) throw new Error(e + "," + t); return this.modules[e][t] }, getModuleCount: function () { return this.moduleCount }, make: function () { var e, t, i, n, a, s; if (this.typeNumber < 1) { for (e = e = 1; e < 40; e++) { for (t = QRRSBlock.getRSBlocks(e, this.errorCorrectLevel), i = new QRBitBuffer, a = n = 0; a < t.length; a++)n += t[a].dataCount; for (a = 0; a < this.dataList.length; a++)s = this.dataList[a], i.put(s.mode, 4), i.put(s.getLength(), QRUtil.getLengthInBits(s.mode, e)), s.write(i); if (i.getLengthInBits() <= 8 * n) break } this.typeNumber = e } this.makeImpl(!1, this.getBestMaskPattern()) }, makeImpl: function (e, t) { var i, n; for (this.moduleCount = 4 * this.typeNumber + 17, this.modules = new Array(this.moduleCount), i = 0; i < this.moduleCount; i++)for (this.modules[i] = new Array(this.moduleCount), n = 0; n < this.moduleCount; n++)this.modules[i][n] = null; this.setupPositionProbePattern(0, 0), this.setupPositionProbePattern(this.moduleCount - 7, 0), this.setupPositionProbePattern(0, this.moduleCount - 7), this.setupPositionAdjustPattern(), this.setupTimingPattern(), this.setupTypeInfo(e, t), 7 <= this.typeNumber && this.setupTypeNumber(e), null == this.dataCache && (this.dataCache = QRCode.createData(this.typeNumber, this.errorCorrectLevel, this.dataList)), this.mapData(this.dataCache, t) }, setupPositionProbePattern: function (e, t) { var i, n; for (i = -1; i <= 7; i++)if (!(e + i <= -1 || this.moduleCount <= e + i)) for (n = -1; n <= 7; n++)t + n <= -1 || this.moduleCount <= t + n || (this.modules[e + i][t + n] = 0 <= i && i <= 6 && (0 == n || 6 == n) || 0 <= n && n <= 6 && (0 == i || 6 == i) || 2 <= i && i <= 4 && 2 <= n && n <= 4) }, getBestMaskPattern: function () { var e, t, i = 0, n = 0; for (e = 0; e < 8; e++)this.makeImpl(!0, e), t = QRUtil.getLostPoint(this), (0 == e || t < i) && (i = t, n = e); return n }, createMovieClip: function (e, t, i) { var n, a, s, r, o = e.createEmptyMovieClip(t, i); for (this.make(), n = 0; n < this.modules.length; n++)for (a = 1 * n, s = 0; s < this.modules[n].length; s++)r = 1 * s, this.modules[n][s] && (o.beginFill(0, 100), o.moveTo(r, a), o.lineTo(r + 1, a), o.lineTo(r + 1, a + 1), o.lineTo(r, a + 1), o.endFill()); return o }, setupTimingPattern: function () { var e, t; for (e = 8; e < this.moduleCount - 8; e++)null == this.modules[e][6] && (this.modules[e][6] = 0 == e % 2); for (t = 8; t < this.moduleCount - 8; t++)null == this.modules[6][t] && (this.modules[6][t] = 0 == t % 2) }, setupPositionAdjustPattern: function () { var e, t, i, n, a, s, r = QRUtil.getPatternPosition(this.typeNumber); for (e = 0; e < r.length; e++)for (t = 0; t < r.length; t++)if (i = r[e], n = r[t], null == this.modules[i][n]) for (a = -2; a <= 2; a++)for (s = -2; s <= 2; s++)this.modules[i + a][n + s] = -2 == a || 2 == a || -2 == s || 2 == s || 0 == a && 0 == s }, setupTypeNumber: function (e) { var t, i, n = QRUtil.getBCHTypeNumber(this.typeNumber); for (t = 0; t < 18; t++)i = !e && 1 == (1 & n >> t), this.modules[Math.floor(t / 3)][t % 3 + this.moduleCount - 8 - 3] = i; for (t = 0; t < 18; t++)i = !e && 1 == (1 & n >> t), this.modules[t % 3 + this.moduleCount - 8 - 3][Math.floor(t / 3)] = i }, setupTypeInfo: function (e, t) { var i, n, a = this.errorCorrectLevel << 3 | t, s = QRUtil.getBCHTypeInfo(a); for (i = 0; i < 15; i++)n = !e && 1 == (1 & s >> i), i < 6 ? this.modules[i][8] = n : i < 8 ? this.modules[i + 1][8] = n : this.modules[this.moduleCount - 15 + i][8] = n; for (i = 0; i < 15; i++)n = !e && 1 == (1 & s >> i), i < 8 ? this.modules[8][this.moduleCount - i - 1] = n : i < 9 ? this.modules[8][15 - i - 1 + 1] = n : this.modules[8][15 - i - 1] = n; this.modules[this.moduleCount - 8][8] = !e }, mapData: function (e, t) { var i, n, a, s = -1, r = this.moduleCount - 1, o = 7, l = 0; for (i = this.moduleCount - 1; 0 < i; i -= 2)for (6 == i && i--; ;) { for (n = 0; n < 2; n++)null == this.modules[r][i - n] && (a = !1, l < e.length && (a = 1 == (1 & e[l] >>> o)), QRUtil.getMask(t, r, i - n) && (a = !a), this.modules[r][i - n] = a, -1 == --o && (l++ , o = 7)); if ((r += s) < 0 || this.moduleCount <= r) { r -= s, s = -s; break } } } }, QRCode.PAD0 = 236, QRCode.PAD1 = 17, QRCode.createData = function (e, t, i) { var n, a, s, r = QRRSBlock.getRSBlocks(e, t), o = new QRBitBuffer; for (n = 0; n < i.length; n++)a = i[n], o.put(a.mode, 4), o.put(a.getLength(), QRUtil.getLengthInBits(a.mode, e)), a.write(o); for (n = s = 0; n < r.length; n++)s += r[n].dataCount; if (o.getLengthInBits() > 8 * s) throw new Error("code length overflow. (" + o.getLengthInBits() + ">" + 8 * s + ")"); for (o.getLengthInBits() + 4 <= 8 * s && o.put(0, 4); 0 != o.getLengthInBits() % 8;)o.putBit(!1); for (; !(o.getLengthInBits() >= 8 * s) && (o.put(QRCode.PAD0, 8), !(o.getLengthInBits() >= 8 * s));)o.put(QRCode.PAD1, 8); return QRCode.createBytes(o, r) }, QRCode.createBytes = function (e, t) { var i, n, a, s, r, o, l, c, d, u, h = 0, p = 0, f = 0, m = new Array(t.length), g = new Array(t.length); for (i = 0; i < t.length; i++) { for (n = t[i].dataCount, a = t[i].totalCount - n, p = Math.max(p, n), f = Math.max(f, a), m[i] = new Array(n), s = 0; s < m[i].length; s++)m[i][s] = 255 & e.buffer[s + h]; for (h += n, r = QRUtil.getErrorCorrectPolynomial(a), o = new QRPolynomial(m[i], r.getLength() - 1).mod(r), g[i] = new Array(r.getLength() - 1), s = 0; s < g[i].length; s++)l = s + o.getLength() - g[i].length, g[i][s] = 0 <= l ? o.get(l) : 0 } for (s = c = 0; s < t.length; s++)c += t[s].totalCount; for (d = new Array(c), s = u = 0; s < p; s++)for (i = 0; i < t.length; i++)s < m[i].length && (d[u++] = m[i][s]); for (s = 0; s < f; s++)for (i = 0; i < t.length; i++)s < g[i].length && (d[u++] = g[i][s]); return d }, QRMode = { MODE_NUMBER: 1, MODE_ALPHA_NUM: 2, MODE_8BIT_BYTE: 4, MODE_KANJI: 8 }, QRErrorCorrectLevel = { L: 1, M: 0, Q: 3, H: 2 }, QRMaskPattern = { PATTERN000: 0, PATTERN001: 1, PATTERN010: 2, PATTERN011: 3, PATTERN100: 4, PATTERN101: 5, PATTERN110: 6, PATTERN111: 7 }, QRUtil = { PATTERN_POSITION_TABLE: [[], [6, 18], [6, 22], [6, 26], [6, 30], [6, 34], [6, 22, 38], [6, 24, 42], [6, 26, 46], [6, 28, 50], [6, 30, 54], [6, 32, 58], [6, 34, 62], [6, 26, 46, 66], [6, 26, 48, 70], [6, 26, 50, 74], [6, 30, 54, 78], [6, 30, 56, 82], [6, 30, 58, 86], [6, 34, 62, 90], [6, 28, 50, 72, 94], [6, 26, 50, 74, 98], [6, 30, 54, 78, 102], [6, 28, 54, 80, 106], [6, 32, 58, 84, 110], [6, 30, 58, 86, 114], [6, 34, 62, 90, 118], [6, 26, 50, 74, 98, 122], [6, 30, 54, 78, 102, 126], [6, 26, 52, 78, 104, 130], [6, 30, 56, 82, 108, 134], [6, 34, 60, 86, 112, 138], [6, 30, 58, 86, 114, 142], [6, 34, 62, 90, 118, 146], [6, 30, 54, 78, 102, 126, 150], [6, 24, 50, 76, 102, 128, 154], [6, 28, 54, 80, 106, 132, 158], [6, 32, 58, 84, 110, 136, 162], [6, 26, 54, 82, 110, 138, 166], [6, 30, 58, 86, 114, 142, 170]], G15: 1335, G18: 7973, G15_MASK: 21522, getBCHTypeInfo: function (e) { for (var t = e << 10; 0 <= QRUtil.getBCHDigit(t) - QRUtil.getBCHDigit(QRUtil.G15);)t ^= QRUtil.G15 << QRUtil.getBCHDigit(t) - QRUtil.getBCHDigit(QRUtil.G15); return (e << 10 | t) ^ QRUtil.G15_MASK }, getBCHTypeNumber: function (e) { for (var t = e << 12; 0 <= QRUtil.getBCHDigit(t) - QRUtil.getBCHDigit(QRUtil.G18);)t ^= QRUtil.G18 << QRUtil.getBCHDigit(t) - QRUtil.getBCHDigit(QRUtil.G18); return e << 12 | t }, getBCHDigit: function (e) { for (var t = 0; 0 != e;)t++ , e >>>= 1; return t }, getPatternPosition: function (e) { return QRUtil.PATTERN_POSITION_TABLE[e - 1] }, getMask: function (e, t, i) { switch (e) { case QRMaskPattern.PATTERN000: return 0 == (t + i) % 2; case QRMaskPattern.PATTERN001: return 0 == t % 2; case QRMaskPattern.PATTERN010: return 0 == i % 3; case QRMaskPattern.PATTERN011: return 0 == (t + i) % 3; case QRMaskPattern.PATTERN100: return 0 == (Math.floor(t / 2) + Math.floor(i / 3)) % 2; case QRMaskPattern.PATTERN101: return 0 == t * i % 2 + t * i % 3; case QRMaskPattern.PATTERN110: return 0 == (t * i % 2 + t * i % 3) % 2; case QRMaskPattern.PATTERN111: return 0 == (t * i % 3 + (t + i) % 2) % 2; default: throw new Error("bad maskPattern:" + e) } }, getErrorCorrectPolynomial: function (e) { var t, i = new QRPolynomial([1], 0); for (t = 0; t < e; t++)i = i.multiply(new QRPolynomial([1, QRMath.gexp(t)], 0)); return i }, getLengthInBits: function (e, t) { if (1 <= t && t < 10) switch (e) { case QRMode.MODE_NUMBER: return 10; case QRMode.MODE_ALPHA_NUM: return 9; case QRMode.MODE_8BIT_BYTE: case QRMode.MODE_KANJI: return 8; default: throw new Error("mode:" + e) } else if (t < 27) switch (e) { case QRMode.MODE_NUMBER: return 12; case QRMode.MODE_ALPHA_NUM: return 11; case QRMode.MODE_8BIT_BYTE: return 16; case QRMode.MODE_KANJI: return 10; default: throw new Error("mode:" + e) } else { if (!(t < 41)) throw new Error("type:" + t); switch (e) { case QRMode.MODE_NUMBER: return 14; case QRMode.MODE_ALPHA_NUM: return 13; case QRMode.MODE_8BIT_BYTE: return 16; case QRMode.MODE_KANJI: return 12; default: throw new Error("mode:" + e) } } }, getLostPoint: function (e) { var t, i, n, a, s, r, o, l, c = e.getModuleCount(), d = 0; for (t = 0; t < c; t++)for (i = 0; i < c; i++) { for (n = 0, a = e.isDark(t, i), s = -1; s <= 1; s++)if (!(t + s < 0 || c <= t + s)) for (r = -1; r <= 1; r++)i + r < 0 || c <= i + r || (0 != s || 0 != r) && a == e.isDark(t + s, i + r) && n++; 5 < n && (d += 3 + n - 5) } for (t = 0; t < c - 1; t++)for (i = 0; i < c - 1; i++)o = 0, e.isDark(t, i) && o++ , e.isDark(t + 1, i) && o++ , e.isDark(t, i + 1) && o++ , e.isDark(t + 1, i + 1) && o++ , (0 == o || 4 == o) && (d += 3); for (t = 0; t < c; t++)for (i = 0; i < c - 6; i++)e.isDark(t, i) && !e.isDark(t, i + 1) && e.isDark(t, i + 2) && e.isDark(t, i + 3) && e.isDark(t, i + 4) && !e.isDark(t, i + 5) && e.isDark(t, i + 6) && (d += 40); for (i = 0; i < c; i++)for (t = 0; t < c - 6; t++)e.isDark(t, i) && !e.isDark(t + 1, i) && e.isDark(t + 2, i) && e.isDark(t + 3, i) && e.isDark(t + 4, i) && !e.isDark(t + 5, i) && e.isDark(t + 6, i) && (d += 40); for (i = l = 0; i < c; i++)for (t = 0; t < c; t++)e.isDark(t, i) && l++; return d + 10 * (Math.abs(100 * l / c / c - 50) / 5) } }, QRMath = { glog: function (e) { if (e < 1) throw new Error("glog(" + e + ")"); return QRMath.LOG_TABLE[e] }, gexp: function (e) { for (; e < 0;)e += 255; for (; 256 <= e;)e -= 255; return QRMath.EXP_TABLE[e] }, EXP_TABLE: new Array(256), LOG_TABLE: new Array(256) }, i = 0; i < 8; i++)QRMath.EXP_TABLE[i] = 1 << i; for (i = 8; i < 256; i++)QRMath.EXP_TABLE[i] = QRMath.EXP_TABLE[i - 4] ^ QRMath.EXP_TABLE[i - 5] ^ QRMath.EXP_TABLE[i - 6] ^ QRMath.EXP_TABLE[i - 8]; for (i = 0; i < 255; i++)QRMath.LOG_TABLE[QRMath.EXP_TABLE[i]] = i; QRPolynomial.prototype = { get: function (e) { return this.num[e] }, getLength: function () { return this.num.length }, multiply: function (e) { var t, i, n = new Array(this.getLength() + e.getLength() - 1); for (t = 0; t < this.getLength(); t++)for (i = 0; i < e.getLength(); i++)n[t + i] ^= QRMath.gexp(QRMath.glog(this.get(t)) + QRMath.glog(e.get(i))); return new QRPolynomial(n, 0) }, mod: function (e) { var t, i, n; if (this.getLength() - e.getLength() < 0) return this; for (t = QRMath.glog(this.get(0)) - QRMath.glog(e.get(0)), i = new Array(this.getLength()), n = 0; n < this.getLength(); n++)i[n] = this.get(n); for (n = 0; n < e.getLength(); n++)i[n] ^= QRMath.gexp(QRMath.glog(e.get(n)) + t); return new QRPolynomial(i, 0).mod(e) } }, QRRSBlock.RS_BLOCK_TABLE = [[1, 26, 19], [1, 26, 16], [1, 26, 13], [1, 26, 9], [1, 44, 34], [1, 44, 28], [1, 44, 22], [1, 44, 16], [1, 70, 55], [1, 70, 44], [2, 35, 17], [2, 35, 13], [1, 100, 80], [2, 50, 32], [2, 50, 24], [4, 25, 9], [1, 134, 108], [2, 67, 43], [2, 33, 15, 2, 34, 16], [2, 33, 11, 2, 34, 12], [2, 86, 68], [4, 43, 27], [4, 43, 19], [4, 43, 15], [2, 98, 78], [4, 49, 31], [2, 32, 14, 4, 33, 15], [4, 39, 13, 1, 40, 14], [2, 121, 97], [2, 60, 38, 2, 61, 39], [4, 40, 18, 2, 41, 19], [4, 40, 14, 2, 41, 15], [2, 146, 116], [3, 58, 36, 2, 59, 37], [4, 36, 16, 4, 37, 17], [4, 36, 12, 4, 37, 13], [2, 86, 68, 2, 87, 69], [4, 69, 43, 1, 70, 44], [6, 43, 19, 2, 44, 20], [6, 43, 15, 2, 44, 16], [4, 101, 81], [1, 80, 50, 4, 81, 51], [4, 50, 22, 4, 51, 23], [3, 36, 12, 8, 37, 13], [2, 116, 92, 2, 117, 93], [6, 58, 36, 2, 59, 37], [4, 46, 20, 6, 47, 21], [7, 42, 14, 4, 43, 15], [4, 133, 107], [8, 59, 37, 1, 60, 38], [8, 44, 20, 4, 45, 21], [12, 33, 11, 4, 34, 12], [3, 145, 115, 1, 146, 116], [4, 64, 40, 5, 65, 41], [11, 36, 16, 5, 37, 17], [11, 36, 12, 5, 37, 13], [5, 109, 87, 1, 110, 88], [5, 65, 41, 5, 66, 42], [5, 54, 24, 7, 55, 25], [11, 36, 12], [5, 122, 98, 1, 123, 99], [7, 73, 45, 3, 74, 46], [15, 43, 19, 2, 44, 20], [3, 45, 15, 13, 46, 16], [1, 135, 107, 5, 136, 108], [10, 74, 46, 1, 75, 47], [1, 50, 22, 15, 51, 23], [2, 42, 14, 17, 43, 15], [5, 150, 120, 1, 151, 121], [9, 69, 43, 4, 70, 44], [17, 50, 22, 1, 51, 23], [2, 42, 14, 19, 43, 15], [3, 141, 113, 4, 142, 114], [3, 70, 44, 11, 71, 45], [17, 47, 21, 4, 48, 22], [9, 39, 13, 16, 40, 14], [3, 135, 107, 5, 136, 108], [3, 67, 41, 13, 68, 42], [15, 54, 24, 5, 55, 25], [15, 43, 15, 10, 44, 16], [4, 144, 116, 4, 145, 117], [17, 68, 42], [17, 50, 22, 6, 51, 23], [19, 46, 16, 6, 47, 17], [2, 139, 111, 7, 140, 112], [17, 74, 46], [7, 54, 24, 16, 55, 25], [34, 37, 13], [4, 151, 121, 5, 152, 122], [4, 75, 47, 14, 76, 48], [11, 54, 24, 14, 55, 25], [16, 45, 15, 14, 46, 16], [6, 147, 117, 4, 148, 118], [6, 73, 45, 14, 74, 46], [11, 54, 24, 16, 55, 25], [30, 46, 16, 2, 47, 17], [8, 132, 106, 4, 133, 107], [8, 75, 47, 13, 76, 48], [7, 54, 24, 22, 55, 25], [22, 45, 15, 13, 46, 16], [10, 142, 114, 2, 143, 115], [19, 74, 46, 4, 75, 47], [28, 50, 22, 6, 51, 23], [33, 46, 16, 4, 47, 17], [8, 152, 122, 4, 153, 123], [22, 73, 45, 3, 74, 46], [8, 53, 23, 26, 54, 24], [12, 45, 15, 28, 46, 16], [3, 147, 117, 10, 148, 118], [3, 73, 45, 23, 74, 46], [4, 54, 24, 31, 55, 25], [11, 45, 15, 31, 46, 16], [7, 146, 116, 7, 147, 117], [21, 73, 45, 7, 74, 46], [1, 53, 23, 37, 54, 24], [19, 45, 15, 26, 46, 16], [5, 145, 115, 10, 146, 116], [19, 75, 47, 10, 76, 48], [15, 54, 24, 25, 55, 25], [23, 45, 15, 25, 46, 16], [13, 145, 115, 3, 146, 116], [2, 74, 46, 29, 75, 47], [42, 54, 24, 1, 55, 25], [23, 45, 15, 28, 46, 16], [17, 145, 115], [10, 74, 46, 23, 75, 47], [10, 54, 24, 35, 55, 25], [19, 45, 15, 35, 46, 16], [17, 145, 115, 1, 146, 116], [14, 74, 46, 21, 75, 47], [29, 54, 24, 19, 55, 25], [11, 45, 15, 46, 46, 16], [13, 145, 115, 6, 146, 116], [14, 74, 46, 23, 75, 47], [44, 54, 24, 7, 55, 25], [59, 46, 16, 1, 47, 17], [12, 151, 121, 7, 152, 122], [12, 75, 47, 26, 76, 48], [39, 54, 24, 14, 55, 25], [22, 45, 15, 41, 46, 16], [6, 151, 121, 14, 152, 122], [6, 75, 47, 34, 76, 48], [46, 54, 24, 10, 55, 25], [2, 45, 15, 64, 46, 16], [17, 152, 122, 4, 153, 123], [29, 74, 46, 14, 75, 47], [49, 54, 24, 10, 55, 25], [24, 45, 15, 46, 46, 16], [4, 152, 122, 18, 153, 123], [13, 74, 46, 32, 75, 47], [48, 54, 24, 14, 55, 25], [42, 45, 15, 32, 46, 16], [20, 147, 117, 4, 148, 118], [40, 75, 47, 7, 76, 48], [43, 54, 24, 22, 55, 25], [10, 45, 15, 67, 46, 16], [19, 148, 118, 6, 149, 119], [18, 75, 47, 31, 76, 48], [34, 54, 24, 34, 55, 25], [20, 45, 15, 61, 46, 16]], QRRSBlock.getRSBlocks = function (e, t) { var i, n, a, s, r, o, l, c = QRRSBlock.getRsBlockTable(e, t); if (null == c) throw new Error("bad rs block @ typeNumber:" + e + "/errorCorrectLevel:" + t); for (i = c.length / 3, n = new Array, a = 0; a < i; a++)for (s = c[3 * a + 0], r = c[3 * a + 1], o = c[3 * a + 2], l = 0; l < s; l++)n.push(new QRRSBlock(r, o)); return n }, QRRSBlock.getRsBlockTable = function (e, t) { switch (t) { case QRErrorCorrectLevel.L: return QRRSBlock.RS_BLOCK_TABLE[4 * (e - 1) + 0]; case QRErrorCorrectLevel.M: return QRRSBlock.RS_BLOCK_TABLE[4 * (e - 1) + 1]; case QRErrorCorrectLevel.Q: return QRRSBlock.RS_BLOCK_TABLE[4 * (e - 1) + 2]; case QRErrorCorrectLevel.H: return QRRSBlock.RS_BLOCK_TABLE[4 * (e - 1) + 3]; default: return } }, QRBitBuffer.prototype = { get: function (e) { var t = Math.floor(e / 8); return 1 == (1 & this.buffer[t] >>> 7 - e % 8) }, put: function (e, t) { for (var i = 0; i < t; i++)this.putBit(1 == (1 & e >>> t - i - 1)) }, getLengthInBits: function () { return this.length }, putBit: function (e) { var t = Math.floor(this.length / 8); this.buffer.length <= t && this.buffer.push(0), e && (this.buffer[t] |= 128 >>> this.length % 8), this.length++ } }, define("jqueryQrcode", function () { }), void 0 === jQuery.migrateMute && (jQuery.migrateMute = !0), function (c, i, d) { function u(e) { var t = i.console; n[e] || (n[e] = !0, c.migrateWarnings.push(e), t && t.warn && !c.migrateMute && (t.warn("JQMIGRATE: " + e), c.migrateTrace && t.trace && t.trace())) } function e(e, t, i, n) { if (Object.defineProperty) try { return Object.defineProperty(e, t, { configurable: !0, enumerable: !0, get: function () { return u(n), i }, set: function (e) { u(n), i = e } }), d } catch (e) { } c._definePropertyBroken = !0, e[t] = i } var n = {}; c.migrateWarnings = [], !c.migrateMute && i.console && i.console.log && i.console.log("JQMIGRATE: Logging is active"), c.migrateTrace === d && (c.migrateTrace = !0), c.migrateReset = function () { n = {}, c.migrateWarnings.length = 0 }, "BackCompat" === document.compatMode && u("jQuery is not compatible with Quirks Mode"); var r = c("<input/>", { size: 1 }).attr("size") && c.attrFn, o = c.attr, a = c.attrHooks.value && c.attrHooks.value.get || function () { return null }, s = c.attrHooks.value && c.attrHooks.value.set || function () { return d }, l = /^(?:input|button)$/i, h = /^[238]$/, p = /^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i, f = /^(?:checked|selected)$/i; e(c, "attrFn", r || {}, "jQuery.attrFn is deprecated"), c.attr = function (e, t, i, n) { var a = t.toLowerCase(), s = e && e.nodeType; return n && (o.length < 4 && u("jQuery.fn.attr( props, pass ) is deprecated"), e && !h.test(s) && (r ? t in r : c.isFunction(c.fn[t]))) ? c(e)[t](i) : ("type" === t && i !== d && l.test(e.nodeName) && e.parentNode && u("Can't change the 'type' of an input or button in IE 6/7/8"), !c.attrHooks[a] && p.test(a) && (c.attrHooks[a] = { get: function (e, t) { var i, n = c.prop(e, t); return !0 === n || "boolean" != typeof n && (i = e.getAttributeNode(t)) && !1 !== i.nodeValue ? t.toLowerCase() : d }, set: function (e, t, i) { var n; return !1 === t ? c.removeAttr(e, i) : ((n = c.propFix[i] || i) in e && (e[n] = !0), e.setAttribute(i, i.toLowerCase())), i } }, f.test(a) && u("jQuery.fn.attr('" + a + "') may use property instead of attribute")), o.call(c, e, t, i)) }, c.attrHooks.value = { get: function (e, t) { var i = (e.nodeName || "").toLowerCase(); return "button" === i ? a.apply(this, arguments) : ("input" !== i && "option" !== i && u("jQuery.fn.attr('value') no longer gets properties"), t in e ? e.value : null) }, set: function (e, t) { var i = (e.nodeName || "").toLowerCase(); return "button" === i ? s.apply(this, arguments) : ("input" !== i && "option" !== i && u("jQuery.fn.attr('value', val) no longer sets properties"), e.value = t, d) } }; var t, m, g = c.fn.init, _ = c.parseJSON, v = /^([^<]*)(<[\w\W]+>)([^>]*)$/; c.fn.init = function (e, t, i) { var n; return e && "string" == typeof e && !c.isPlainObject(t) && (n = v.exec(c.trim(e))) && n[0] && ("<" !== e.charAt(0) && u("$(html) HTML strings must start with '<' character"), n[3] && u("$(html) HTML text after last tag is ignored"), "#" === n[0].charAt(0) && (u("HTML string cannot start with a '#' character"), c.error("JQMIGRATE: Invalid selector string (XSS)")), t && t.context && (t = t.context), c.parseHTML) ? g.call(this, c.parseHTML(n[2], t, !0), t, i) : g.apply(this, arguments) }, c.fn.init.prototype = c.fn, c.parseJSON = function (e) { return e || null === e ? _.apply(this, arguments) : (u("jQuery.parseJSON requires a valid JSON string"), null) }, c.uaMatch = function (e) { e = e.toLowerCase(); var t = /(chrome)[ \/]([\w.]+)/.exec(e) || /(webkit)[ \/]([\w.]+)/.exec(e) || /(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e) || /(msie) ([\w.]+)/.exec(e) || e.indexOf("compatible") < 0 && /(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e) || []; return { browser: t[1] || "", version: t[2] || "0" } }, c.browser || (m = {}, (t = c.uaMatch(navigator.userAgent)).browser && (m[t.browser] = !0, m.version = t.version), m.chrome ? m.webkit = !0 : m.webkit && (m.safari = !0), c.browser = m), e(c, "browser", c.browser, "jQuery.browser is deprecated"), c.sub = function () { function i(e, t) { return new i.fn.init(e, t) } c.extend(!0, i, this), i.superclass = this, ((i.fn = i.prototype = this()).constructor = i).sub = this.sub, i.fn.init = function (e, t) { return t && t instanceof c && !(t instanceof i) && (t = i(t)), c.fn.init.call(this, e, t, n) }, i.fn.init.prototype = i.fn; var n = i(document); return u("jQuery.sub() is deprecated"), i }, c.ajaxSetup({ converters: { "text json": c.parseJSON } }); var y = c.fn.data; c.fn.data = function (e) { var t, i, n = this[0]; return !n || "events" !== e || 1 !== arguments.length || (t = c.data(n, e), i = c._data(n, e), t !== d && t !== i || i === d) ? y.apply(this, arguments) : (u("Use of jQuery.fn.data('events') is deprecated"), i) }; var b = /\/(java|ecma)script/i, w = c.fn.andSelf || c.fn.addBack; c.fn.andSelf = function () { return u("jQuery.fn.andSelf() replaced by jQuery.fn.addBack()"), w.apply(this, arguments) }, c.clean || (c.clean = function (e, t, i, n) { t = (t = !(t = t || document).nodeType && t[0] || t).ownerDocument || t, u("jQuery.clean() is deprecated"); var a, s, r, o, l = []; if (c.merge(l, c.buildFragment(e, t).childNodes), i) for (r = function (e) { return !e.type || b.test(e.type) ? n ? n.push(e.parentNode ? e.parentNode.removeChild(e) : e) : i.appendChild(e) : d }, a = 0; null != (s = l[a]); a++)c.nodeName(s, "script") && r(s) || (i.appendChild(s), s.getElementsByTagName !== d && (o = c.grep(c.merge([], s.getElementsByTagName("script")), r), l.splice.apply(l, [a + 1, 0].concat(o)), a += o.length)); return l }); var C = c.event.add, x = c.event.remove, k = c.event.trigger, T = c.fn.toggle, S = c.fn.live, $ = c.fn.die, A = "ajaxStart|ajaxStop|ajaxSend|ajaxComplete|ajaxError|ajaxSuccess", I = RegExp("\\b(?:" + A + ")\\b"), D = /(?:^|\s)hover(\.\S+|)\b/, P = function (e) { return "string" != typeof e || c.event.special.hover ? e : (D.test(e) && u("'hover' pseudo-event is deprecated, use 'mouseenter mouseleave'"), e && e.replace(D, "mouseenter$1 mouseleave$1")) }; c.event.props && "attrChange" !== c.event.props[0] && c.event.props.unshift("attrChange", "attrName", "relatedNode", "srcElement"), c.event.dispatch && e(c.event, "handle", c.event.dispatch, "jQuery.event.handle is undocumented and deprecated"), c.event.add = function (e, t, i, n, a) { e !== document && I.test(t) && u("AJAX events should be attached to document: " + t), C.call(this, e, P(t || ""), i, n, a) }, c.event.remove = function (e, t, i, n, a) { x.call(this, e, P(t) || "", i, n, a) }, c.fn.error = function () { var e = Array.prototype.slice.call(arguments, 0); return u("jQuery.fn.error() is deprecated"), e.splice(0, 0, "error"), arguments.length ? this.bind.apply(this, e) : (this.triggerHandler.apply(this, e), this) }, c.fn.toggle = function (i, e) { if (!c.isFunction(i) || !c.isFunction(e)) return T.apply(this, arguments); u("jQuery.fn.toggle(handler, handler...) is deprecated"); var n = arguments, t = i.guid || c.guid++, a = 0, s = function (e) { var t = (c._data(this, "lastToggle" + i.guid) || 0) % a; return c._data(this, "lastToggle" + i.guid, t + 1), e.preventDefault(), n[t].apply(this, arguments) || !1 }; for (s.guid = t; n.length > a;)n[a++].guid = t; return this.click(s) }, c.fn.live = function (e, t, i) { return u("jQuery.fn.live() is deprecated"), S ? S.apply(this, arguments) : (c(this.context).on(e, this.selector, t, i), this) }, c.fn.die = function (e, t) { return u("jQuery.fn.die() is deprecated"), $ ? $.apply(this, arguments) : (c(this.context).off(e, this.selector || "**", t), this) }, c.event.trigger = function (e, t, i, n) { return i || I.test(e) || u("Global events are undocumented and deprecated"), k.call(this, e, t, i || document, n) }, c.each(A.split("|"), function (e, t) { c.event.special[t] = { setup: function () { var e = this; return e !== document && (c.event.add(document, t + "." + c.guid, function () { c.event.trigger(t, null, e, !0) }), c._data(this, t, c.guid++)), !1 }, teardown: function () { return this !== document && c.event.remove(document, t + "." + c._data(this, t)), !1 } } }) }(jQuery, window), define("jquery-migrate", function () { }), function (s) { var r; s.fn.jqprint = function (e) { r = s.extend({}, s.fn.jqprint.defaults, e); var t = this instanceof jQuery ? this : s(this); if (r.operaSupport && s.browser.opera) { var i = window.open("", "jqPrint-preview"); i.document.open(); var n = i.document } else { var a = s("<iframe  />"); r.debug || a.css({ position: "absolute", width: "0px", height: "0px", left: "-600px", top: "-600px" }), a.appendTo("body"); n = a[0].contentWindow.document } r.importCSS && (0 < s("link[media=print]").length ? s("link[media=print]").each(function () { n.write("<link type='text/css' rel='stylesheet' href='" + s(this).attr("href") + "' media='print' />") }) : s("link").each(function () { n.write("<link type='text/css' rel='stylesheet' href='" + s(this).attr("href") + "' />") })), r.printContainer ? n.write(t.outer()) : t.each(function () { n.write(s(this).html()) }), n.close(), (r.operaSupport && s.browser.opera ? i : a[0].contentWindow).focus(), setTimeout(function () { (r.operaSupport && s.browser.opera ? i : a[0].contentWindow).print(), i && i.close() }, 1e3) }, s.fn.jqprint.defaults = { debug: !1, importCSS: !0, printContainer: !0, operaSupport: !0 }, jQuery.fn.outer = function () { return s(s("<div></div>").html(this.clone())).html() } }(jQuery), define("jqprint", ["jquery-migrate"], function () { }), define("components/digitalWaybill/index", ["baseView", "templates", "helper", "jspdf", "utils/stringUtils", "jqueryQrcode", "jqprint"], function (e, t, c, i, n) { var d = 978, u = 794; return e.extend({ template: t.digitalWaybill, layerOpts: { title: " ", area: "500px", skin: "digital-waybill" }, events: { "click .print": "print", "click .download": "download" }, render: function () { if (this.rLocationCode = this.options.infoList[0].appointmentDetail.appointmentOriginDetail.locationCode, this.getImgUrl(), this.$el.html(this.template({ sfLogoUrl: this.sfLogoUrl, sfTelUrl: this.sfTelUrl, infoList: this.options.infoList, numberToSensitive: n.numberToSensitive, hasPaymethodAndCargoMsg: this.hasPaymethodAndCargoMsg() })), this.renderQrCode(), 1 < this.options.infoList.length) { var e = this; $(window).resize(function () { e.$(".operate-wrapper").css("height", $(this).height() - 150) }), $(window).resize() } }, hasPaymethodAndCargoMsg: function () { return c.isHK(this.rLocationCode) }, print: function () { this.isIePrint = !1, c.isIE() && (this.isIePrint = !0), this.working || (this.working = !0, this.printOrDownload(this.$(".item").eq(0))) }, download: function () { if (!this.working) { this.isIePrint = !1, this.working = !0; var e = new i("", "pt", "a4"); this.printOrDownload(this.$(".item").eq(0), e) } }, html2canvas: function (e, t) { var i = e.find("canvas")[0], n = document.createElement("canvas"); n.width = u, n.height = d; var a, s = n.getContext("2d"); s.fillStyle = "#fff", s.font = "13px Adobe Ming Std", s.fillRect(0, 0, u, d), s.lineJoin = "round", s.lineWidth = 16, s.strokeStyle = "#dc1e32", s.strokeRect(16, 16, 16, 16), s.font = "16px Adobe Ming Std", s.fillStyle = "#fff", s.fillText("收", 16, 29), s.font = "13px Adobe Ming Std", s.fillStyle = "#333", s.fillText(e.find(".contact-name").text(), 70, 20), s.fillText(e.find(".appoint-region").text(), 200, 20), s.fillStyle = "#999", s.fillText(e.find(".contact-tel").text(), 70, 40), s.fillStyle = "#333", s.fillText(e.find(".appoint-address").text(), 200, 40), s.fillText(e.find(".appoint-payment").text(), 120, 65), s.drawImage(i, 90, 75), s.fillText(e.find(".bill-no").text(), 115, 300), 0 < e.find(".bill-msg span").length && (a = e.find(".bill-msg span").position().left), s.fillText(e.find(".bill-msg").text(), a - 50, 320), t.onrendered(n) }, printOrDownload: function (n, a, s, r) { var o, l = this; (s = s || 0) % 2 == 0 ? ((r = document.createElement("canvas")).width = u, r.height = d, (o = r.getContext("2d")).fillStyle = "#ffffff", o.fillRect(0, 0, u, d)) : o = r.getContext("2d"), this.html2canvas(n, { onrendered: function (e) { if (o.drawImage(e, 200, s % 2 * d / 2 + (l.isIePrint ? 110 : 80)), o.save(), s % 2 == 1 || s === l.$(".item").length - 1) if (a) a.addImage(r, "JPEG", 0, 0), s !== l.$(".item").length - 1 && a.addPage(); else { var t = new Image; t.src = r.toDataURL("image/png"), l.$(".print-hide").append(t) } var i = n.next(".item"); i.length ? l.printOrDownload(i, a, ++s, r) : (a ? a.save("SF Digital Waybill.pdf") : (c.isIE() && l.$(".print-hide img").each(function () { $(this).width(2 * u), $(this).height(2 * (d - 250)) }), l.$(".print-hide").jqprint()), l.working = !1) } }) }, renderQrCode: function () { var a = this; _.each(this.$(".qr-code-wrapper"), function (n) { _.each(a.options.infoList, function (e) { if ($(n).data("no") == e.appointmentDetail.waybillNo) { var t = a.getScanQRUrl(e.appointmentDetail.appointmentOriginDetail.locationCode); $(n).qrcode({ render: "canvas", text: t + e.appointmentDetail.waybillNo, width: "200", height: "200", background: "#ffffff", foreground: "#000000" }); var i = new Image; i.src = c.getResourceURL("images/about_us/SF_logo.png"), i.onload = function () { $(n).children("canvas")[0].getContext("2d").drawImage(i, 80, 80, 40, 40) } } }) }) }, getScanQRUrl: function (e) { return c.isHK_MC(e) ? c.getUcmpX() + "xaccess/scan/order?reserve=" : c.isTW(e) ? c.getUcmpX() + "xaccess/tw/scan/order?reserve=" : c.getUcmpWx() + "wxaccess/weixin/activity/wx_b2sf_order?p1=" }, getImgUrl: function () { this.sfLogoUrl = c.getResourceURL("images/order/sf-logo.jpg"), this.sfTelUrl = c.getResourceURL("images/order/sf-tel.jpg"); var e = this.options.infoList[0].appointmentDetail.appointmentOriginDetail; e && (c.isHK_MC(e.locationCode) ? (this.sfLogoUrl = c.getResourceURL("images/order/sf-logo-hk.jpg"), this.sfTelUrl = c.getResourceURL("images/order/sf-tel-hk.jpg")) : c.isHK_MC_TW(e.locationCode) && (this.sfLogoUrl = c.getResourceURL("images/order/sf-logo-tw.jpg"), this.sfTelUrl = c.getResourceURL("images/order/sf-tel-tw.jpg"))) } }) }), define("components/changeAppointBill/modifyReceiver", ["components/addressBook/addressBookModify", "sflayer"], function (e) { return e.extend({ init: function () { e.prototype.init.apply(this, arguments), this.onlyCnAdd = !0 }, setLocationAttr: function () { this.$(".detail-location-input").attr("data-hide-hkmctw", "true") }, saveAddress: function () { if (this.validateshipper()) var e = this.getAjaxData(), t = this, i = layer.confirm(_l("保存成功"), { noStop: !0, btn: _l("确定"), yes: function () { layer.close(i), t.options.callback(e), t.close() } }) } }) }), define("components/changeAppointBill/changeAppointBill", ["./changeAppointBillCommon", "templates", "./modifyReceiver", "components/addressBook/addressBook", "event", "components/newBillOptions/itemsAndWeight", "components/newBillOptions/cargoPayType", "components/newBillOptions/cargoService/index", "components/newBillOptions/cargoInsure", "helper", "const", "bus/index", "sflayer"], function (t, e, i, n, a, s, r, o, l, c, d, u) { var h = c.getSiteLocation(), p = { template: e.changeAppointBill, init: function () { t.prototype.init.apply(this, arguments), this.initAttributes() }, initAttributes: function () { this.initCargoItems(), this.cargoWeight = this.billInfo.metaWeight, this.payType = this.billInfo.freightFee.paymethod, this.monthAccount = this.billInfo.freightFee.custid, this.codCustid = this.billInfo.codCustid, this.codAmt = this.billInfo.codAmt, this.initCurrentCodType(), this.signedBackBillIndex = this.billInfo.signedBackDetail.signedBackSop, this.signedBackBillName = this.billInfo.signedBackDetail.signedBackName, this.supportVal = this.billInfo.declaredValue, this.supportPrise = this.billInfo.inSurance, this.choosedMsg = this.billInfo.remark, this.metaPrice = this.billInfo.metaPrice, this.selfPick = this.billInfo.selfPickUpFlag, this.medciName = _l("医药类产品"), this.insureTimes = 7 }, render: function () { this.$el.html(this.template({ sender: this.billInfo.appointmentOriginDetail, hasCargoMsg: u.hasCargoMsg(this.billInfo.pickupType), hasCargoService: u.hasCargoService(), hasCargoInsure: u.hasCargoInsure(), hideModifyReceiver: this.hideModifyReceiver, currencyCode: this.currencyCode })), this.showReceiver(), this.showItemsAndWeight(), this.showPayType(), this.showService(), this.showInsure(), this.showMsg(), this.showSelfPick(), this.isNotRangeOut = !0, this.queryAddressRange(), this.getInitRatePrice() }, events: { "click .items-weight": "popItemsAndWeight", "click .cargo-pay-type": "popCargoPayType", "click .cargo-service": "popCargoService", "click .cargo-insure": "popCargoInsure", "click .cargo-msg": "popCargoMsgView", "click .cargo-self-pick": "selfPickToggle", "click .receiver-modify": "modifyReceiver", "click .address-book": "showAddressBookContent", "click .confirm-change": "submitChange" }, initCargoItems: function () { 0 < this.billInfo.customerInfoList.length ? 0 < _.filter(this.billInfo.customerInfoList, function (e) { return 0 === e.isDeclare }).length ? (this.cargoItems = this.billInfo.customerInfoList[0].cargoName, this.cargoMedci = this.billInfo.customerInfoList[0].cargoDesc) : this.defaultCargoItems() : this.defaultCargoItems() }, defaultCargoItems: function () { this.cargoItems = _l("文件"), this.cargoMedci = "" }, initCurrentCodType: function () { var t = this; this.codCustid ? sfAjax.verifyCodAccount({ data: { customerCode: this.codCustid, amount: this.codAmt }, success: function (e) { 0 === e.code ? t.codType = e.result.isScatterCod : layer.msg(_l("网络错误")) }, error: function () { layer.msg(_l("网络错误")) } }) : this.codType = null }, getInitRatePrice: function () { if (this.metaPrice && "--" !== this.metaPrice) { var e = "" == this.signedBackBillIndex ? 0 : 5; this.ratePrice = this.metaPrice - this.supportPrise - e, this.changePredictPrice() } else this.fetchPriceAndTimes() }, popItemsAndWeight: function () { var t = this; new s({ choosedItem: this.cargoItems, choosedMedci: this.cargoMedci, weight: this.cargoWeight, callback: function (e) { t.cargoItems = e.items, t.cargoMedci = e.medci, t.cargoWeight = e.weight, t.showItemsAndWeight(), t.fetchPriceAndTimes() } }) }, showItemsAndWeight: function () { var e; this.$(".items-show").text(this.cargoItems || _l("无")), e = 20 == this.cargoWeight ? ">20kg" : this.cargoWeight + "kg", this.$(".weight-show").text(e) }, popCargoPayType: function () { var t = this; new r({ chooseType: this.sLocationCode == d.RATE_OF_TW && this.codCustid ? 4 : this.payType, monthAccount: this.monthAccount, whetherCollect: !!this.codCustid, callback: function (e) { t.payType = e.chooseType, t.monthAccount = e.monthAccount, t.showPayType() } }) }, showPayType: function () { this.$(".pay-type-show").text(_l(c.getPayType(this.payType))) }, popCargoService: function () { var t = this; new o({ signedBackBillIndex: this.signedBackBillIndex, codAmt: this.codAmt, codCustid: this.codCustid, callback: function (e) { t.signedBackBillIndex = e.signedBackBillIndex, t.signedBackBillName = e.signedBackBillName, void 0 === e.customerCode ? (t.codAmt = "", t.codCustid = "", t.codType = null) : (t.codAmt = e.amount, t.codCustid = e.customerCode, t.codType = e.isScatterCod), t.showService(), t.changePredictPrice() } }) }, showService: function () { var e = this.signedBackBillIndex ? this.signedBackBillName : this.codCustid ? _l("代收货款") : _l("无增值服务"); this.$(".servive-show").text(e) }, popCargoInsure: function () { var t = this; new l({ supportPrise: this.supportPrise, supportVal: this.supportVal, times: this.insureTimes, currencyCode: this.currencyCode, sLocationCode: this.sLocationCode, rLocationCode: this.rLocationCode, callback: function (e) { t.supportPrise = e.supportPrise, t.supportVal = e.supportVal, t.showInsure(), t.changePredictPrice() } }) }, fetchPriceAndTimes: function () { var e = this.billInfo.appointmentOriginDetail.locationCode, t = this.destinationAddress.locationCode, i = { originCode: c.isHK_MC_TW(e) ? this.billInfo.appointmentOriginDetail.cityCode : this.billInfo.appointmentOriginDetail.countyCode, destCode: c.isHK_MC_TW(t) ? this.destinationAddress.cityCode : this.destinationAddress.countyCode, time: moment().format(), queryType: 2, rateType: "toMainland", weight: this.cargoWeight }; this.loadIndex = layer.load(0, { shade: [.2, "#000"] }), this.rateCollection.rateSearch(i) }, changePredictPrice: function () { var e, t = "" == this.signedBackBillIndex ? 0 : 5; null == this.ratePrice ? (e = "--", this.metaPrice = 0) : (e = parseFloat(this.ratePrice) + this.supportPrise + t, this.metaPrice = e), this.$(".predict-money").text(e) }, modifyReceiver: function () { var t = this; new i({ addressBook: this.destinationAddress, callback: function (e) { u.setRLocationCode(e.locationCode), t.destinationAddress = e, t.showReceiver(), t.fetchPriceAndTimes(), t.queryAddressRange(!1) } }) }, showAddressBookContent: function (e) { $.cookie("loginUser") ? this.showAddressBook(e) : a.trigger(a.Needlogin, { succCallback: this.showAddressBook.bind(this), cancelCallback: null }) }, showAddressBook: function (e) { var t = this; this.isLocked(e) || sfAjax.fetchAddressBookList({ data: { pageNo: 1, rowCount: "8", condition: "" }, success: function (e) { e && 0 == e.code ? new n({ addressBooks: e.result.content, noHmt: !0, totalPage: e.result.totalPage, page: e.result.pageNo, callback: t.fillAddressBookAdd.bind(t) }) : layer.msg(_l("网络错误")) }, error: function () { layer.msg(_l("网络错误")) }, complete: function () { t.unlock(e) }, login: { succCallback: this.showAddressBook.bind(this), cancelCallback: null } }) }, fillAddressBookAdd: function (e) { this.destinationAddress = _.extend(this.destinationAddress, e), this.showReceiver(), this.fetchPriceAndTimes(), this.queryAddressRange(!1) }, validateSubmit: function () { var e = !1; return (this.cargoMedci || _.contains(this.cargoItems.split(","), this.medciName)) && (e = !0), e && this.selfPick ? (layer.alert(_l("医药类产品不能选择自取服务")), !1) : this.isNotRangeOut || this.selfPick ? 1 == this.codType && 2 == this.payType ? (layer.alert(_l("非月结客户的代收货款服务暂不支持“到付”")), !1) : !this.codCustid || 4 == this.payType || (layer.alert(_l("代收货款暂时只支持寄付月结付款")), !1) : (layer.alert(_l("亲，您的收件地址不在我司派送范围内，可选择自取服务")), !1) }, getCargoList: function () { return [{ name: this.cargoItems.substring(0, 10), uom: "", desc: this.cargoMedci, price: "0" }] }, submitChange: function () { if (this.validateSubmit()) { var e = [{ appointmentNo: this.billInfo.appointmentNo, appointmentTime: this.billInfo.appointmentTime, pickupType: this.billInfo.pickupType, destinationAddress: this.destinationAddress, remark: this.choosedMsg, productCode: this.billInfo.productInfo.code, productName: this.getProductTypeName(), metaWeight: this.cargoWeight, metaPrice: this.metaPrice, cargoList: this.getCargoList(), freightFeeCode: this.billInfo.freightFee.code || 1, freightFeeAmt: this.billInfo.freightFee.amt, paymethod: this.payType, custid: this.monthAccount, custom: null, supportValue: this.supportVal, premium: this.supportPrise, signedBackFlg: "" == this.signedBackBillIndex ? 0 : 1, signedBackName: this.signedBackBillName, signedBackSop: this.signedBackBillIndex, codAmt: this.codAmt, codCustid: this.codCustid, selfPickUpFlag: this.selfPick }], t = this, i = layer.load(0, { shade: [.2, "#000"] }); sfAjax.updateAppointOrder({ data: e, success: function (e) { e && 0 == e.code ? layer.alert(_l("修改成功"), function (e) { layer.close(e), t.options.callback(), t.close() }) : layer.msg(_l("修改失败")) }, error: function () { layer.msg(_l("修改失败")) }, complete: function () { layer.close(i) }, login: { succCallback: this.submitChange.bind(this), cancelCallback: function () { layer.msg(_l("修改失败")) } } }) } } }, f = { init: function (e) { t.prototype.init.apply(this, arguments), this.initAttributes(), this.hideModifyReceiver = !0 }, defaultCargoItems: function () { this.cargoItems = "", this.cargoMedci = "" }, fetchPriceAndTimes: function () { var e = this.billInfo.appointmentOriginDetail.locationCode, t = this.destinationAddress.locationCode, i = { originCode: c.isHK_MC_TW(e) ? this.billInfo.appointmentOriginDetail.cityCode : this.billInfo.appointmentOriginDetail.countyCode, destCode: c.isHK_MC_TW(t) ? this.destinationAddress.cityCode : this.destinationAddress.countyCode, time: moment().format(), queryType: 12, rateType: "toMainland", weight: this.cargoWeight }; this.loadIndex = layer.load(0, { shade: [.2, "#000"] }), this.rateCollection.rateSearch(i) } }; return "cn" === h ? t.extend(p) : "hk" === h || "tw" === h ? t.extend(_.extend(p, f)) : void 0 }), define("components/changeAppointBill/changeAppointBillHmt", ["./changeAppointBillCommon", "templates", "components/newBillOptions/hmtOptions/declareItems", "components/newBillOptions/cargoPayType", "components/newBillOptions/cargoService/index", "components/newBillOptions/hmtOptions/onlyCargoWeight", "components/newBillOptions/cargoInsure", "components/newBillOptions/hmtOptions/hmtCargoInsure", "components/newBillOptions/hmtOptions/declareType", "helper", "const", "bus/index"], function (e, t, i, n, a, s, r, o, l, c, d, u) { var h = c.getSiteLocation(), p = { template: t.changeAppointBillHmt, init: function () { e.prototype.init.apply(this, arguments), this.initAttributes() }, initAttributes: function () { this.initDeclareItems(), this.originCurrency = 0 < this.declareGoodsLists.length ? this.declareGoodsLists[0].currency : "CNY", this.feePayType = this.billInfo.paymentMethod, this.feeMonthAccount = this.billInfo.freightFee.custid, this.weight = this.billInfo.metaWeight, this.supportVal = this.billInfo.declaredValue, this.supportPrise = this.billInfo.inSurance, this.metaPrice = this.billInfo.metaPrice, this.choosedMsg = this.billInfo.remark, this.selfPick = this.billInfo.selfPickUpFlag, this.codCustid = this.billInfo.codCustid, this.codAmt = this.billInfo.codAmt, this.initCurrentCodType(), this.signedBackBillIndex = this.billInfo.signedBackDetail.signedBackSop, this.signedBackBillName = this.billInfo.signedBackDetail.signedBackName, this.changeRmbToNtd() }, render: function () { this.$el.html(this.template({ sender: this.billInfo.appointmentOriginDetail, isTW: c.isTW(this.rLocationCode), hideCargoWeight: this.hideCargoWeight, hideCargoDeclare: this.hideCargoDeclare, hasCargoInsure: u.hasCargoInsure(), hasCargoService: u.hasCargoService(), hasCargoMsg: u.hasCargoMsg(this.billInfo.pickupType), currencyCode: this.currencyCode })), this.showReceiver(), this.showItems(), this.showFeePayType(), this.showTaxPayType(), this.showWeight(), this.showInsure(), this.showDeclareType(), this.showMsg(), this.showSelfPick(), this.showService(), this.isNotRangeOut = !0, this.queryAddressRange(), this.getInitRatePrice() }, events: { "click .add-items": "addItems", "click .fee-pay-type": "popFeePayType", "click .tax-pay-type": "popTaxPayType", "click .cargo-weight": "popCargoWeight", "click .cargo-insure": "popCargoInsure", "click .cargo-declare-type": "popDeclareType", "click .cargo-msg": "popCargoMsgView", "click .cargo-self-pick": "selfPickToggle", "click .confirm-change": "validateSubmit", "click .cargo-service": "popCargoService" }, initDeclareItems: function () { if (0 < this.billInfo.customerInfoList.length) { var e = _.filter(this.billInfo.customerInfoList, function (e) { return 1 === e.isDeclare }); 0 < e.length ? (this.declareGoodsLists = this.getDeclareGoodsLists(e), this.declareValue = e[0].declareValue || 0, this.taxPaymethod = e[0].payMethod, this.taxMonthAccount = e[0].settlementCode, this.clearanceType = e[0].declareType) : this.defaultDeclareGoodsLists() } else this.defaultDeclareGoodsLists() }, changeRmbToNtd: function () { var t = this; sfAjax.getexrate({ data: { time: encodeURIComponent(moment().format()), originCode: "CNY", destCode: "NTD" }, success: function (e) { t.FIVE_THOUSAND_RMB_TO_NTD = c.toFixed(5e3 * e, 3) } }) }, getDeclareGoodsLists: function (e) { var i = []; return _.each(e, function (e) { var t = {}; t.currency = e.currency || "CNY", t.currencyCn = "CNY" == t.currency ? "人民币" : t.currency, t.declareType = "document" == e.cargoNameEn ? "file" : "goods", t.englishName = e.cargoNameEn, t.name = e.cargoName, t.price = e.cargoPrice, t.quantity = e.cargoQuantity, t.uom = e.cargoUom, t.origin = e.cargoOrigin, i.push(t) }), i }, defaultDeclareGoodsLists: function () { this.declareGoodsLists = [], this.declareValue = 0, this.taxPaymethod = 2, this.taxMonthAccount = "", this.clearanceType = 0 }, initCurrentCodType: function () { var t = this; this.codCustid ? sfAjax.verifyCodAccount({ data: { customerCode: this.codCustid, amount: this.codAmt }, success: function (e) { 0 === e.code ? t.codType = e.result.isScatterCod : layer.msg(_l("网络错误")) }, error: function () { layer.msg(_l("网络错误")) } }) : this.codType = null }, getInitRatePrice: function () { this.metaPrice && "--" !== this.metaPrice ? (this.ratePrice = this.metaPrice - this.supportPrise, this.changePredictPrice()) : this.fetchPriceAndTimes() }, fetchPriceAndTimes: function () { var e, t = this.destinationAddress.locationCode; e = c.isHK_MC_TW(t) ? this.destinationAddress.cityCode : this.destinationAddress.countyCode; var i = { originCode: this.billInfo.appointmentOriginDetail.countyCode, destCode: e, time: moment().format(), queryType: 3, rateType: "toMainland", weight: this.weight }; e && (this.loadIndex = layer.load(0, { shade: [.2, "#000"] }), this.rateCollection.rateSearch(i)) }, changePredictPrice: function () { var e; null == this.ratePrice ? (e = "--", this.metaPrice = 0) : (e = parseFloat(this.ratePrice) + this.supportPrise, this.metaPrice = e), this.$(".predict-money").text(e) }, addItems: function () { var t = this; new i({ declareValue: this.declareValue, declareGoodsLists: this.declareGoodsLists, originCurrency: this.originCurrency, callback: function (e) { t.declareValue = e.declareValue, t.originCurrency = e.originCurrency, t.declareGoodsLists = e.declareGoodsLists, t.showItems() } }) }, showItems: function () { var e; 0 < this.declareGoodsLists.length ? (e = "en" == c.getSiteLanguage() ? _.pluck(this.declareGoodsLists, "englishName").join(",") : _.pluck(this.declareGoodsLists, "name").join(","), this.$(".items-show").text(e)) : this.$(".items-show").text(_l("请填写")) }, popFeePayType: function () { var t = this; new n({ chooseType: this.feePayType, monthAccount: this.feeMonthAccount, callback: function (e) { t.feePayType = e.chooseType, t.feeMonthAccount = e.monthAccount, t.showFeePayType() } }) }, showFeePayType: function () { this.$(".fee-pay-type-show").text(_l(c.getPayType(this.feePayType))) }, popTaxPayType: function () { var t = this; new n({ types: [4, 2], chooseType: this.taxPaymethod, monthAccount: this.taxMonthAccount, callback: function (e) { t.taxPaymethod = e.chooseType, t.taxMonthAccount = e.monthAccount, t.showTaxPayType() } }) }, showTaxPayType: function () { this.$(".tax-pay-type-show").text(_l(c.getPayType(this.taxPaymethod))) }, popCargoWeight: function () { var t = this; new s({ weight: this.weight, callback: function (e) { t.weight = e.weight, t.showWeight(), t.fetchPriceAndTimes() } }) }, showWeight: function () { var e; e = 20 == this.weight ? ">20kg" : this.weight + "kg", this.$(".cargo-weight-show").text(e) }, popCargoInsure: function () { var t = this; new o({ supportPrise: this.supportPrise, supportVal: this.supportVal, times: 7, callback: function (e) { t.supportPrise = e.supportPrise, t.supportVal = e.supportVal, t.showInsure(), t.changePredictPrice() } }) }, popDeclareType: function () { var t = this; new l({ clearanceType: this.clearanceType, callback: function (e) { t.clearanceType = e.clearanceType, t.showDeclareType() } }) }, showDeclareType: function () { this.$(".cargo-declare-show").text(0 == this.clearanceType ? _l("非正式报关") : _l("正式报关")) }, popCargoService: function () { var t = this; new a({ signedBackBillIndex: this.signedBackBillIndex, codAmt: this.codAmt, codCustid: this.codCustid, callback: function (e) { t.signedBackBillIndex = e.signedBackBillIndex, t.signedBackBillName = e.signedBackBillName, void 0 === e.customerCode ? (t.codAmt = "", t.codCustid = "", t.codType = null) : (t.codAmt = e.amount, t.codCustid = e.customerCode, t.codType = e.isScatterCod), t.showService(), t.changePredictPrice() } }) }, showService: function () { var e = this.signedBackBillIndex ? this.signedBackBillName : this.codCustid ? _l("代收货款") : _l("无增值服务"); this.$(".servive-show").text(e) }, validateSubmit: function () { this.isNotRangeOut || this.selfPick ? this.validateGoods() : layer.alert(_l("亲，您的收件地址不在我司派送范围内，可选择自取服务")) }, validateGoods: function () { if (0 != this.declareGoodsLists.length) if (0 == _.filter(this.declareGoodsLists, function (e) { return "goods" == e.declareType }).length && 0 < this.supportVal) var e = this, t = layer.confirm(_l("当前物品不支持保价,是否取消保价"), { btn: [_l("是"), _l("否")] }, function () { e.supportPrise = 0, e.supportVal = 0, e.showInsure(), e.changePredictPrice(), e.validateValue(), layer.close(t) }, function () { layer.close(t) }); else this.validateValue(); else layer.alert(_l("申报物品必须填写")) }, validateValue: function () { var n = this, e = layer.load(0, { shade: [.2, "#000"] }); sfAjax.getexrate({ data: { time: encodeURIComponent(moment().format()), originCode: n.originCurrency, destCode: n.sLocationCode == d.RATE_OF_TW ? "NTD" : "CNY" }, success: function (e) { var t = c.toFixed(n.declareValue * e, 3); if (n.supportVal > t) layer.alert(_l("保价金额不能超过申报总值，当前申报总值为") + t + _l("元")); else { var i = _l("申报价值超过5000元人民币的物品，需要正式报关"); n.sLocationCode == d.RATE_OF_TW && 0 == n.clearanceType ? n.rLocationCode == d.RATE_OF_HK || n.rLocationCode == d.RATE_OF_MACAO ? 5e4 <= t ? (i = _l("物品需做正式报关且会产生NTD500报关服务费，请联络顺丰客服0800-088-830"), n.warnningTips(i, "NTD")) : n.submitChange() : 5e4 <= t ? (i = _l("物品需做正式报关且会产生NTD500报关服务费，请联络顺丰客服0800-088-830"), n.warnningTips(i, "NTD")) : t < 5e4 && t >= n.FIVE_THOUSAND_RMB_TO_NTD ? (i = _l("物品需做正式报关，请联络顺丰客服0800-088-830，并提供清关文件"), n.warnningTips(i, "NTD")) : n.submitChange() : 5e3 < t && 0 == n.clearanceType ? n.warnningTips(i) : n.submitChange() } }, error: function () { layer.msg(_l("网络错误")) }, complete: function () { layer.close(e) } }) }, warnningTips: function (e, t) { var i = this; if ("NTD" == t) n = layer.confirm(e, { btn: [_l("我知道了")] }, function () { layer.close(n) }); else var n = layer.confirm(e, { btn: [_l("正式报关"), _l("修改申报物品")] }, function () { i.clearanceType = 1, i.showDeclareType(), layer.close(n), i.submitChange() }, function () { layer.close(n), i.$(".add-items").trigger("click") }) }, getfinalDeclareGoodsLists: function () { return _.map(this.declareGoodsLists, function (e) { return _.omit(e, "id", "currency", "declareType", "currencyCn") }) }, submitChange: function () { var e = [{ appointmentNo: this.billInfo.appointmentNo, appointmentTime: this.billInfo.appointmentTime, pickupType: this.billInfo.pickupType, destinationAddress: this.destinationAddress, remark: this.choosedMsg, productCode: this.billInfo.productInfo.code, productName: this.getProductTypeName(), metaWeight: this.weight, metaPrice: this.metaPrice, cargoList: this.getfinalDeclareGoodsLists(), freightFeeCode: this.billInfo.freightFee.code || 1, freightFeeAmt: this.billInfo.freightFee.amt, paymethod: this.feePayType, custid: this.feeMonthAccount, custom: { currency: this.originCurrency, weight: this.weight, declareType: this.clearanceType, paymethod: this.taxPaymethod, settlementCode: this.taxMonthAccount, declareValue: this.declareValue }, supportValue: this.supportVal, premium: this.supportPrise, signedBackFlg: "" == this.signedBackBillIndex ? 0 : 1, signedBackName: this.signedBackBillName, signedBackSop: this.signedBackBillIndex, codAmt: this.codAmt, codCustid: this.codCustid, selfPickUpFlag: this.selfPick }], t = this, i = layer.load(0, { shade: [.2, "#000"] }); sfAjax.updateAppointOrder({ data: e, success: function (e) { e && 0 == e.code ? layer.alert(_l("修改成功"), function (e) { layer.close(e), t.options.callback(), t.close() }) : layer.msg(_l("修改失败")) }, error: function () { layer.msg(_l("修改失败")) }, complete: function () { layer.close(i) }, login: { succCallback: this.validateSubmit.bind(this), cancelCallback: function () { layer.msg(_l("修改失败")) } } }) } }, f = { init: function () { e.prototype.init.apply(this, arguments), this.initAttributes(), this.hideCargoWeight = !0, this.hideCargoDeclare = !(this.sLocationCode == d.RATE_OF_TW) }, fetchPriceAndTimes: function () { var e, t, i = this.billInfo.appointmentOriginDetail.locationCode; t = c.isHK_MC_TW(i) ? this.billInfo.appointmentOriginDetail.cityCode : this.billInfo.appointmentOriginDetail.countyCode; var n = this.destinationAddress.locationCode, a = { originCode: t, destCode: e = c.isHK_MC_TW(n) ? this.destinationAddress.cityCode : this.destinationAddress.countyCode, time: moment().format(), queryType: c.isHK_MC_TW(n) ? 12 : 4, rateType: "toMainland", weight: this.weight }; e && (this.loadIndex = layer.load(0, { shade: [.2, "#000"] }), this.rateCollection.rateSearch(a)) }, popCargoInsure: function () { var t = this; new r({ supportPrise: this.supportPrise, supportVal: this.supportVal, times: 7, currencyCode: this.currencyCode, sLocationCode: this.sLocationCode, rLocationCode: this.rLocationCode, callback: function (e) { t.supportPrise = e.supportPrise, t.supportVal = e.supportVal, t.showInsure(), t.changePredictPrice() } }) } }; return "cn" === h ? e.extend(p) : "hk" === h || "tw" === h ? e.extend(_.extend(p, f)) : void 0 }), define("components/newBillOptions/showBillDetail", ["helper", "const"], function (n, i) { return { showCargo: function (e) { var t = []; _.each(e, function (e) { "sc" == n.getSiteLanguage() || "tc" == n.getSiteLanguage() ? t.push(e.cargoName || e.cargoNameEn) : t.push(e.cargoNameEn || e.cargoName) }); var i = _.compact(t).join(","); return "" === i ? _l("无") : i }, showDeclaredValue: function (e, t) { return e ? t + e : _l("未选择保价") }, showAdditionalText: function (e) { var t = []; t.push(e.signedBackDetail.signedBackName), t.push(e.codAmt && e.codCustid ? _l("代收货款") : ""); var i = _.compact(t).join(","); return "" === i ? _l("无") : i }, showPayType: function (e) { return _l(n.getPayType(e)) }, showWeight: function (e) { return e ? e + "kg" : _l("无") }, showMetaPrice: function (e, t) { return e ? t + e : "--" }, afterProcessingDetail: function (e, t) { t = t || i.CUR_CN; return { cargo: this.showCargo(e.customerInfoList), declaredValue: this.showDeclaredValue(e.declaredValue, t), additionalText: this.showAdditionalText(e), payType: this.showPayType(e.paymentMethod), weight: this.showWeight(e.metaWeight), metaPrice: this.showMetaPrice(e.metaPrice, t) } } } }), define("views/pages/order/cn/bulkShipping/bulkOrderSuccess", ["baseView", "templates", "utils/time", "components/changeAppointBill/bulkChangeAppointBill", "components/digitalWaybill/index", "components/changeAppointBill/changeAppointBill", "components/changeAppointBill/changeAppointBillHmt", "components/newBillOptions/showBillDetail", "helper", "bus/index"], function (e, n, t, s, i, r, o, a, l, c) { var d = l.getSiteLocation(), u = { template: n.bulkOrderSuccess, render: function (t) { var e = layer.load(0, { shade: [.2, "#000"] }), i = this; sfAjax.bulkQueryAppointBill({ data: { billList: this.options.appointmentNoList.join(",") }, success: function (e) { e && 0 === e.code && 0 < e.result.length ? (i.infoList = e.result, i.sLocationCode = i.getSenderInfo().locationCode, c.setSLocationCode(i.sLocationCode), i.renderSuccHead(), null != i.options.failSubmitData && i.renderSubmitFailOrder(), i.renderInfoList(), i.renderDetailInfoList(), "showDetail" == t && (i.$(".info-list").hide(), i.$(".bulk-modify").trigger("click"), i.showSelectAll || i.$(".cancle-select").trigger("click"))) : i.queryChangeAppointBillFail() }, error: function () { i.queryChangeAppointBillFail() }, login: { succCallback: this.render.bind(this), cancelCallback: this.queryChangeAppointBillFail.bind(this) }, complete: function () { layer.close(e) } }) }, events: { "click .submit-again": "submitAgain", "click .download": "downloadDigital", "click .bulk-modify": "triggerInfoToggle", "click .detail-bulk-modify": "showCheckbox", "click .info-toggle": "infoToggle", "click .confirm-select": "bulkModify", "click .cancle-select": "hideCheckbox", "click .select-one": "checkToggle", "click .select-all": "allCheckToggle", "click .modify": "singleModify", "click .modify-hk": "singleModifyIcon", "click .to-waybill": "toWaybill" }, toWaybill: function () { "hk" === l.getSiteLocation() ? sfgather.trackClicks("点击查看订单列表", "XWF010402") : sfgather.trackClicks("点击查看订单列表", "OWF010402") }, singleModifyIcon: function () { "hk" === l.getSiteLocation() ? sfgather.trackClicks("点击收件人后完善快件信息按钮", "XWF010405") : sfgather.trackClicks("点击收件人后完善快件信息按钮", "OWF010405") }, renderSuccHead: function () { var e = this.infoList[0].appointmentDetail, t = this.getOutDoorTime(e); this.$el.html(this.template({ data: this.infoList, resoure: e.resoure, relativeDate: this.getRelativeDate(t), relativeHour: t.format("HH:mm"), listNO: this.infoList.length, totalFreight: this.calcTotalFreight(), pickupType: e.pickupType, currencyCode: this.options.currencyCode, selfSend: this.options.selfSend })) }, getOutDoorTime: function (e) { var t; return t = e.expectStartTm ? e.expectStartTm : e.appointmentTime, moment(t, "YYYY-MM-DD HH:mm:ss").add("hour", 1) }, getRelativeDate: function (e) { return t.relativeDate(e, this.options.synServerTim) }, queryChangeAppointBillFail: function () { this.$el.html(n.bookingSuccHappy({ imgUrl: l.getResourceURL("images/order/box-happy.png"), waybillUrl: l.getDynamicURLWithContext("/waybill/") })) }, renderSubmitFailOrder: function () { var e = this.options.failSubmitData.destinationInfo; this.$(".order-again").html(n.orderAgain({ data: e })) }, submitAgain: function () { var r = this.options.failSubmitData, t = []; _.each(r.destinationInfo, function (e) { t.push(_.omit(e, "rateHtml")) }), r.destinationInfo = t, this.submitBtn = this.$(".submit-again"), this.submitBtn.toggleClass("disabled", !0); var e = layer.load(0, { shade: [.2, "#000"] }), o = this; sfAjax.bulkSubmitNewOrder({ data: r, success: function (e) { if (e && 0 === e.code && 0 < e.result.length) { var t = e.result, i = []; _.each(t, function (e) { !1 === e.success && i.push(e.index) }); var n = { succ: t.length - i.length, fail: i.length }; if (0 === n.succ) layer.msg(_l("网络异常，请重新提交订单")); else var a = _l("预约成功，其中${succ}条成功，${fail}条失败！"), s = layer.alert(a._p(n), { closeBtn: 0 }, function () { layer.close(s), 0 === i.length ? o.options.failSubmitData = null : r.destinationInfo = _.filter(r.destinationInfo, function (e) { return _.contains(i, e.index) }); var e = _.pluck(_.filter(t, function (e) { return !0 === e.success }), "appointmentNo"); o.options.appointmentNoList.push(e), o.options.appointmentNoList = _.flatten(o.options.appointmentNoList), o.render() }) } else o.renderFail(e) }, error: function () { layer.msg(_l("网络异常，请重新提交订单")) }, login: { succCallback: this.submitAgain.bind(this), cancelCallback: null }, complete: function () { o.submitBtn.toggleClass("disabled", !1), layer.close(e) } }) }, renderFail: function (e) { 654 === e.code ? layer.msg(_l("月结账号无效")) : 651 === e.code ? layer.msg(_l("预约失败：下单时间不在服务时间范围内。")) : 652 === e.code ? layer.msg(_l("暂时不能为您提供收派件的服务，如有疑问请咨询我司热线95338。")) : 653 === e.code ? layer.msg(_l("账号异常！")) : 502 === e.code ? layer.msg(_l("系统繁忙，请重试！")) : layer.msg(_l("预约失败：信息校验不通过，请检查必填项。")) }, getSenderInfo: function () { return this.infoList[0].appointmentDetail.appointmentOriginDetail }, calcTotalFreight: function () { var t = 0; return _.each(this.infoList, function (e) { "NaN" === parseFloat(e.appointmentDetail.metaPrice).toString() || 0 === parseFloat(e.appointmentDetail.metaPrice) ? (t += 0, e.appointmentDetail.metaPrice = "--") : t += parseFloat(e.appointmentDetail.metaPrice) }), parseFloat(t) || "--" }, renderInfoList: function () { this.$(".info-list").html(n.infoList({ sender: this.getSenderInfo(), infoList: this.infoList, waybillUrl: l.getDynamicURLWithContext("/waybill/"), currencyCode: this.options.currencyCode })) }, renderDetailInfoList: function () { var t = this.options.currencyCode; this.$(".detail-info-list").html(n.detailInfoList({ sender: this.getSenderInfo(), infoList: this.infoList, totalFreight: this.calcTotalFreight(), waybillUrl: l.getDynamicURLWithContext("/waybill/"), currencyCode: t })); var i = ""; _.each(this.infoList, function (e) { c.setRLocationCode(e.appointmentDetail.appointmentDestDetail.locationCode), i += n.detailInfoItem({ obj: e, info: a.afterProcessingDetail(e.appointmentDetail, t), hasCargoService: c.hasCargoService(), hasCargoInsure: c.hasCargoInsure(), currencyCode: t }) }), this.$(".sfcard .receive-info-list").html(i) }, downloadDigital: function () { new i({ infoList: this.infoList }), "hk" === l.getSiteLocation() ? sfgather.trackClicks("点击下载电子运单", "XWF010403") : sfgather.trackClicks("点击下载电子运单", "OWF010403") }, triggerInfoToggle: function () { var e = this; this.$(".info-toggle").addClass("active"), this.$(".info-toggle").find("span").removeClass("aicon-chevron-double-down").addClass("aicon-chevron-double-up"), this.$(".info-list").fadeOut("fast", function () { e.$(".detail-info-list").fadeIn() }), this.$(".info-toggle-wrapper .price-desc").hide(), this.showCheckbox() }, infoToggle: function (e) { var t = this.$(e.currentTarget), i = this; t.toggleClass("active"), t.hasClass("active") ? (t.find("span").removeClass("aicon-chevron-double-down").addClass("aicon-chevron-double-up"), this.$(".info-list").fadeOut("fast", function () { i.$(".detail-info-list").fadeIn() }), this.$(".info-toggle-wrapper .price-desc").hide(), this.hideCheckbox()) : (t.find("span").removeClass("aicon-chevron-double-up").addClass("aicon-chevron-double-down"), this.$(".detail-info-list").fadeOut("fast", function () { i.$(".info-list").fadeIn() }), this.$(".info-toggle-wrapper .price-desc").show()), "hk" === l.getSiteLocation() ? sfgather.trackClicks("点击预约详情信息", "XWF010401") : sfgather.trackClicks("点击预约详情信息", "OWF010401") }, showCheckbox: function () { var e = this; this.$(".detail-bulk-modify,.receiver-table .sfbadge,.detail-info-list .download,.detail-info-list .to-waybill").fadeOut("fast", function () { e.$(".receiver-table .select-one,.select-all,.confirm-select,.cancle-select").fadeIn() }), "hk" === l.getSiteLocation() ? sfgather.trackClicks("点击批量修改预约信息", "XWF010404") : sfgather.trackClicks("点击批量修改预约信息", "OWF010404") }, hideCheckbox: function () { var e = this; this.$(".receiver-table .aicon-check, .select-all").addClass("aicon-uncheck").removeClass("aicon-check"), this.$(".receiver-table .select-one,.select-all,.confirm-select,.cancle-select").fadeOut("fast", function () { e.$(".detail-bulk-modify,.receiver-table .sfbadge,.detail-info-list .download,.detail-info-list .to-waybill").fadeIn() }) }, checkToggle: function (e) { this.$(e.currentTarget).toggleClass("aicon-check aicon-uncheck") }, allCheckToggle: function (e) { this.checkToggle(e), this.$(e.currentTarget).hasClass("aicon-check") ? this.$(".select-one").addClass("aicon-check").removeClass("aicon-uncheck") : this.$(".select-one").addClass("aicon-uncheck").removeClass("aicon-check") }, bulkModify: function () { var t = [], i = !1, e = this.$(".receiver-table .aicon-check"); if (e && 0 < e.length) { var n = []; _.each(e, function (e) { n.push($(e).parents(".detail-item").data("appointment-no")) }), _.each(this.infoList, function (e) { _.contains(n, e.appointmentNo) && (l.isHK_MC_TW(e.appointmentDetail.appointmentDestDetail.locationCode) ? i = !0 : t.push(JSON.parse(JSON.stringify(e)))) }), i ? layer.msg(_l("批量修改预约单不支持寄往港澳台！")) : new s({ billInfoList: t, callback: function () { this.render("showDetail") }.bind(this) }) } else layer.msg(_l("请选择预约单")); "hk" === l.getSiteLocation() ? sfgather.trackClicks("点击批量修改快递产品确认按钮", "XWF010406") : sfgather.trackClicks("点击批量修改快递产品确认按钮", "OWF010406") }, singleModify: function (e) { this.$(".select-all").is(":visible") ? this.showSelectAll = !0 : this.showSelectAll = !1; var t = $(e.currentTarget).parents(".detail-item").data("appointment-no"), i = _.find(this.infoList, function (e) { return e.appointmentNo === t }), n = { billInfo: i.appointmentDetail, callback: function () { this.render("showDetail") }.bind(this) }; l.isHK_MC_TW(i.appointmentDetail.appointmentDestDetail.locationCode) ? new o(n) : new r(n) } }, h = { bulkModify: function () { var t = [], i = !1, e = this.$(".receiver-table .aicon-check"), n = this; if (e && 0 < e.length) { var a = []; _.each(e, function (e) { a.push($(e).parents(".detail-item").data("appointment-no")) }), _.each(this.infoList, function (e) { _.contains(a, e.appointmentNo) && (n.sLocationCode != e.appointmentDetail.appointmentDestDetail.locationCode ? i = !0 : t.push(JSON.parse(JSON.stringify(e)))) }), i ? layer.msg(_l("批量修改预约单只支持同地区互寄！")) : new s({ billInfoList: t, callback: function () { this.render("showDetail") }.bind(this) }) } else layer.msg(_l("请选择预约单")) }, singleModify: function (e) { this.$(".select-all").is(":visible") ? this.showSelectAll = !0 : this.showSelectAll = !1; var t = $(e.currentTarget).parents(".detail-item").data("appointment-no"), i = _.find(this.infoList, function (e) { return e.appointmentNo === t }), n = { billInfo: i.appointmentDetail, callback: function () { this.render("showDetail") }.bind(this) }, a = i.appointmentDetail.appointmentDestDetail.locationCode; this.sLocationCode == a ? new r(n) : new o(n) } }; return "cn" === d ? e.extend(u) : "hk" === d ? e.extend(_.extend(u, h)) : void 0 }), define("views/pages/order/cn/bulkShipping/bookingInfo/peakControlFill", ["baseView", "templates", "sflayer"], function (e, t) { return e.extend({ events: { "click tr": "selectOne", "click .select-all": "selectAll", "click .delete-select": "deleteSelect", "click .delete-all-select": "deleteAllSelect", "click .continue-submit": "continueSubmit", "change .select": "controlTypeChange" }, template: t.peakControlFill, layerOpts: { title: _l("高峰管控提醒"), area: "800px", cancel: function () { this.options.callbackClose() } }, render: function () { var e = _.filter(this.model.get("receiverList"), function (e) { return 1 == e.obj.controlStrategy || 2 == e.obj.controlStrategy || 3 == e.obj.controlStrategy }); this.$el.html(this.template({ controlReceiverList: e, currencyCode: this.options.currencyCode })), this.renderSelect("all"); var t = this; $(window).resize(function () { t.$(".height-scroll").height() > $(this).height() - 364 ? t.$(".height-scroll").css("height", $(this).height() - 364) : t.$(".height-scroll").css("height", "auto") }), $(window).resize() }, selectOne: function (e) { this.$(e.target).hasClass("select-one") ? (this.$(e.target).hasClass("aicon-check") ? this.$(e.target).removeClass("aicon-check").addClass("aicon-uncheck") : this.$(e.target).removeClass("aicon-uncheck").addClass("aicon-check"), e.stopPropagation()) : this.$(e.currentTarget).find(".select-one").trigger("click") }, selectAll: function (e) { this.$(e.currentTarget).hasClass("aicon-check") ? (this.$(e.currentTarget).removeClass("aicon-check").addClass("aicon-uncheck"), this.$(".select-one").removeClass("aicon-check").addClass("aicon-uncheck")) : (this.$(e.currentTarget).removeClass("aicon-uncheck").addClass("aicon-check"), this.$(".select-one").removeClass("aicon-uncheck").addClass("aicon-check")) }, deleteSelect: function (n) { var a = this, e = _l("是否确认取消寄件"), s = layer.confirm(e, { title: _l("温馨提示"), btn: [_l("是"), _l("否")] }, function () { var e = a.$(n.currentTarget), t = e.data("rid"), i = _.reject(a.model.get("receiverList"), function (e) { return e.index == t }); a.model.set("receiverList", i), e.remove(), layer.close(s) }, function () { layer.close(s) }) }, deleteAllSelect: function (e) { var t = this, a = this.$(".select-one.aicon-check"); if (0 < a.length) var i = _l("是否确认取消寄件"), s = layer.confirm(i, { title: _l("温馨提示"), btn: [_l("是"), _l("否")] }, function () { var e = a.parents("tr"), i = []; _.each(e, function (e) { var t = $(e).data("rid"); i.push(t), $(e).remove() }); var n = t.model.get("receiverList"); _.each(i, function (t) { n = _.reject(n, function (e) { return e.index == t }) }), t.model.set("receiverList", n), layer.close(s) }, function () { layer.close(s) }) }, continueSubmit: function (e) { var t = this.model.get("receiverList"); if (0 < t.length) { 0 < _.filter(t, function (e) { return 1 == e.obj.controlStrategy }).length ? layer.alert(_l("请取消因延时管控而不能下单的选项")) : (this.close(), this.options.callbackSubmit()) } else { this.close(); var i = this, n = _l("当前0条寄件，请返回添加收件人信息"), a = layer.confirm(n, { title: _l("温馨提示"), btn: [_l("确定")], closeBtn: 0 }, function () { layer.close(a), i.options.callbackPrevStep() }) } }, controlTypeChange: function (e) { var t = _.filter(this.model.get("receiverList"), function (e) { return 1 == e.obj.controlStrategy || 2 == e.obj.controlStrategy || 3 == e.obj.controlStrategy }), i = this.$(e.currentTarget).val(); "all" != i && (t = _.filter(t, function (e) { return e.obj.controlStrategy == i })), this.$el.html(this.template({ controlReceiverList: t, currencyCode: this.options.currencyCode })), this.renderSelect(i) }, renderSelect: function (t) { this.$(".select").empty(); _.each([{ value: "all", name: "全部" }, { value: "1", name: "延时管控" }, { value: "2", name: "错峰管控" }, { value: "3", name: "加价管控" }], function (e) { t == e.value ? $(".select").append("<option value='" + e.value + "' selected>" + _l(e.name) + "</option>") : $(".select").append("<option value='" + e.value + "'>" + _l(e.name) + "</option>") }) } }) }), define("views/pages/order/cn/bulkShipping/bookingInfo/bulkBookingInfo", ["baseView", "templates", "components/detailDateTimePicker/pickupTimePicker", "components/newBillOptions/cargoMsg", "helper", "../bulkShippingPriceAndTime", "event", "../bulkOrderSuccess", "./peakControlFill", "const", "bus/index", "sflayer"], function (e, c, t, i, d, u, n, a, s, r, o) { var l = d.getSiteLocation(), h = { template: c.bulkBookingInfo, init: function () { this.choosedMsg = "", this.sender = this.model.get("originateAddress"), this.sLocationCode = this.sender.locationCode, o.setSLocationCode(this.sLocationCode), this.originRateCode = this.sender.countyCode, this.senderOutRange = this.model.get("senderOutRange"), this.pickType = o.getPickType(this.senderOutRange), this.msgsIndex = [0, 1, 3, 4, 5] }, render: function () { this.$el.html(this.template({ showToggle: this.hasPickTypeToggle(), currencyCode: this.getCurrencyCode() })), this.togglePickUpTypeView(), this.model.getServerCurrentTime(), this.model.getCityWorkingTime({ cityCode: this.model.get("senderLocationCityCode"), address: this.sender.address }), this.pickupTimePicker = new t({ el: this.$(".pickup-time"), serverTime: this.model.get("synServerTim"), dateTimes: this.model.get("dateTimes") }), this.initialDateTime = this.pickupTimePicker.getDateTime(), this.renderReceiverList(), this.setElement(this.$(".bulk-booking-info-wrapper")) }, events: { "click .cargo-msg": "leaveMsg", "click .term": "showTerm", "click .bulk-modify-select": "bulkModifySelect", "click .bulk-modify-confirm": "bulkModifyConfirm", "click .bulk-modify-cancel": "bulkModifyCancel", "click tr": "selectOne", "click .select-all": "selectAll", "click .modify": "modifyRate", "change #date": "onSelectDateChange", "click #agree-term-content": "agreeTermToggle", "click .prev": "prevStep", "click .next": "nextStep", "click .pick-type a": "pickTypeToggle", "click .time-maidian": "timeMaidian" }, hasPickTypeToggle: function () { var t = !0; return _.each(this.model.get("receiverList"), function (e) { o.setRLocationCode(e.locationCode), o.hasPickTypeToggle() || (t = !1) }), t }, togglePickUpTypeView: function () { var e = this; this.$(".pick-type .icon").removeClass("aicon-radio-active").addClass("aicon-radio"), 1 === this.pickType ? (this.$(".on-door .icon").addClass("aicon-radio-active").removeClass("aicon-radio"), this.$(".show-by-self").fadeOut(function () { e.$(".show-on-door").fadeIn() })) : null === this.pickType ? this.$(".show-by-self").fadeOut(function () { e.$(".show-on-door").fadeIn() }) : 2 === this.pickType && (this.$(".by-self .icon").addClass("aicon-radio-active").removeClass("aicon-radio"), this.$(".show-on-door").fadeOut(function () { e.$(".show-by-self").fadeIn() })) }, pickTypeToggle: function (e) { var t = this.$(e.currentTarget); t.hasClass("on-door") && 1 === this.pickType || t.hasClass("by-self") && 2 === this.pickType || (t.hasClass("on-door") && this.senderOutRange ? layer.alert(_l("您的寄件地址只支持自寄下单，如需选择快递员上门取件可修改您的寄件地址")) : (t.hasClass("on-door") ? this.pickType = 1 : this.pickType = 2, this.togglePickUpTypeView(), this.getRates())) }, timeMaidian: function () { "hk" === d.getSiteLocation() ? sfgather.trackClicks("点击上门时间", "XWF010301") : sfgather.trackClicks("点击上门时间", "OWF010301") }, setDestRateCode: function (e) { _.each(e, function (e) { e.locationCode == r.RATE_OF_TW || e.locationCode == r.RATE_OF_HK ? e.destRateCode = e.cityCode : e.destRateCode = e.countyCode }) }, renderReceiverList: function () { var e = this.model.get("receiverList"); this.setDestRateCode(e), this.$(".receiver-wrapper").html(c.bookingInfoReceiver({ rList: e })), 0 < e.length ? this.getRates() : this.$el.find(".predict-price .price").html(0) }, getBookingTime: function () { var e; return (e = 1 === this.pickType ? this.pickupTimePicker.getDateTime() : this.initialDateTime) && e.start ? e.start : this.model.get("synServerTim").format() }, getQueryType: function (e) { return d.isHK_MC_TW(e) ? "3" : "2" }, getRates: function () { this.$(".next").addClass("disabled"); var n = this.model.get("receiverList"), e = _.uniq(_.pluck(n, "destRateCode")), a = { origin: this.originRateCode, time: this.getBookingTime(), payFeeRates: [] }, s = this; _.each(e, function (t) { var e = { dest: t, weight: "tw" === d.getSiteLocation() || "hk" === d.getSiteLocation() ? "0.5" : "1", volume: 1 }, i = _.find(n, function (e) { return e.cityCode == t || e.countyCode == t }).locationCode; e.queryType = s.getQueryType(i), a.payFeeRates.push(e) }), this.getRatesAjax(a) }, getRatesAjax: function (e) { var t = { showErr: !0, limitTypeName: _l("顺丰标快"), deliverTime: _l("约2-4天"), totalFreight: _l("以收派员巴枪价格为准"), limitTypeCode: "T4", cargoTypeCode: "C201", expressTypeCode: "B1", closedTime: null }, i = this, n = layer.load(); sfAjax.bulkGetPayFee({ data: e, success: function (e) { i.dealRates(e, t) }, error: function () { i.renderErrRates(t) }, complete: function () { i.$(".next").removeClass("disabled"), layer.close(n) } }) }, dealRates: function (e, m) { var g = this; _.each(e, function (e) { if (e.rate) { var t = e.rate; _.reject(t, function (e) { return null === e.deliverTime }), _.each(t, function (e) { e.closedTime && (e.closedTime = moment(e.closedTime, "HHmm").format("HH:mm")), e.deliverTime && "Invalid date" != moment(e.deliverTime).format() && (e.deliverTime = _l("预计") + " " + moment(e.deliverTime).format("ddd HH:mm") + " " + _l("前")) }); var i, n = _.groupBy(t, "limitTypeCode"), a = _.first(n.T1 || n.T104), s = _.first(n.T8 || n.T801), r = _.first(n.T4), o = _.first(n.T6), l = moment(g.getBookingTime()).clone(); if (g.model.get("firstPickedEndDateTime")) { var c = g.model.get("firstPickedEndDateTime").clone(), d = g.model.get("secondPickedEndDateTime").clone(), u = g.model.get("thirdPickedEndDateTime").clone(); i = _.find([c, d, u], function (e) { return l.get("date") === e.get("date") }) } i && (a && a.closedTime && moment(i.format("YYYY-MM-DD") + " " + a.closedTime, "YYYY-MM-DD HH:mm").isAfter(i) && (a.closedTime = i.format("HH:mm")), s && s.closedTime && moment(i.format("YYYY-MM-DD") + " " + s.closedTime, "YYYY-MM-DD HH:mm").isAfter(i) && (s.closedTime = i.format("HH:mm")), r && (r.closedTime = i.format("HH:mm")), o && (o.closedTime = i.format("HH:mm"))); var h = { t1: a, t8: s, t4: r, t6: o, sendTime: l }, p = g.filterProductType(h); if (0 < p.length) { _.each(p, function (e) { "人民币" === e.currencyName && (e.totalFreight = e.totalFreight + "元") }); var f = _.sortBy(p, function (e) { return -parseFloat(e.totalFreight) }); e.priceAndTime = f[0] } else e.priceAndTime = m } else e.priceAndTime = m }), this.renderRates(e) }, filterProductType: function (e) { var t = []; return !_.isUndefined(e.t1) && e.t1.closedTime && e.sendTime.isBefore(moment(e.t1.closedTime, "HH:mm")) && t.push(e.t1), !_.isUndefined(e.t8) && e.t8.closedTime && e.sendTime.isBefore(moment(e.t8.closedTime, "HH:mm")) && t.push(e.t8), _.isUndefined(e.t4) || "1" === e.t4.destView && "1" === e.t4.orgionView && !e.t4.deliverTime || t.push(e.t4), _.isUndefined(e.t6) || t.push(e.t6), t }, getCurrencyCode: function () { var e = this.sender.locationCode; return d.getCurrencyByCode(e) }, renderRates: function (e) { var t = this.model.get("receiverList"); _.each(t, function (t) { _.each(e, function (e) { t.destRateCode == e.destCode && (t.productName = e.priceAndTime.limitTypeName, t.productCode = e.priceAndTime.limitTypeCode, t.cargoTypeCode = e.priceAndTime.cargoTypeCode, t.expressTypeCode = e.priceAndTime.expressTypeCode, t.metaPrice = e.priceAndTime.totalFreight, t.priceAndTime = e.priceAndTime) }) }); var n = this; _.each(this.$(".rate-cell"), function (t) { var i = $(t).parents("tr").data("code"); _.each(e, function (e) { i == e.destCode && $(t).html(c.rateCell({ list: e.priceAndTime, currencyCode: n.getCurrencyCode() })) }) }), this.model.set("receiverList", t), this.$el.find(".predict-price .price").html(this.calcTotalFreight()), "sc" === d.getSiteLanguage() && this.getBatchWarmReminder() }, renderErrRates: function (t) { var e = this.model.get("receiverList"); _.each(e, function (e) { e.productName = t.limitTypeName, e.productCode = t.limitTypeCode, e.cargoTypeCode = t.cargoTypeCode, e.expressTypeCode = t.expressTypeCode, e.metaPrice = "0", e.priceAndTime = e }), _.each(this.$(".rate-cell"), function (e) { $(e).html(c.rateCell({ list: t })) }), this.model.set("receiverList", e), this.$el.find(".predict-price .price").html(this.calcTotalFreight()) }, calcTotalFreight: function () { var e = this.model.get("receiverList"), t = 0; return _.each(e, function (e) { e.metaPrice = "string" == typeof e.metaPrice && -1 < e.metaPrice.indexOf("元") ? e.metaPrice.substring(0, e.metaPrice.length - 1) : e.metaPrice, t += "NaN" === parseFloat(e.metaPrice).toString() ? 0 : parseFloat(e.metaPrice) }), parseFloat(t) || "--" }, leaveMsg: function () { var t = this; new i({ initMsgsIndex: this.msgsIndex, choosedMsg: this.choosedMsg, callback: function (e) { t.choosedMsg = e.msg, t.showMsg() } }), "hk" === d.getSiteLocation() ? sfgather.trackClicks("点击捎话给快递员", "XWF010304") : sfgather.trackClicks("点击捎话给快递员", "OWF010304") }, showMsg: function () { this.$(".cargo-msg").text(this.choosedMsg || _l("无")) }, showTerm: function (t) { $(window).resize(function () { $("iframe").css("height", $(this).height() - 200) }); var e = d.getURLWithContext("other/modal/order_terms.html"), i = this; layer.open({ title: _l("电子运单契约条款"), type: 2, area: ["960px"], offset: "40px", content: [e, "no"], btn: _l("我已阅读该条款，同意遵守"), yes: function (e) { i.$("#agree-term-content").addClass("active"), t || i.checkToOrder(), layer.close(e) } }), $(window).resize() }, bulkModifySelect: function () { this.showBulkModify(), "hk" === d.getSiteLocation() ? sfgather.trackClicks("点击批量修改快递产品", "XWF010303") : sfgather.trackClicks("点击批量修改快递产品", "OWF010303") }, bulkModifyConfirm: function () { var e = this.$(".select-one.aicon-check"); if (0 == e.length) layer.msg(_l("请选择数据")); else { var t = []; _.each(e, function (e) { t.push($(e).parents("tr").data("code")) }); var i = _.uniq(t); if (1 < i.length) layer.msg(_l("请选择相同的省市区地址进行修改")); else { var n = e.parents("tr"), a = n.data("rid"), s = this.model.get("receiverList"), r = _.find(s, function (e) { return e.rid == a }).locationCode, o = { originCode: this.originRateCode, destCode: i[0], time: this.getBookingTime(), weight: "tw" === d.getSiteLocation() || "hk" === d.getSiteLocation() ? "0.5" : "1", queryType: this.getQueryType(r), rateType: "toMainland" }, l = this; new u({ model: this.model, data: o, sLocationCode: this.sender.locationCode, callback: function (i) { _.each(s, function (t) { _.each(n, function (e) { t.rid == $(e).data("rid") && (t.productName = i.limitTypeName, t.productCode = i.limitTypeCode, t.cargoTypeCode = i.cargoTypeCode, t.expressTypeCode = i.expressTypeCode, t.metaPrice = i.totalFreight, t.priceAndTime = i, $(e).find(".rate-cell").html(c.rateCell({ list: i, currencyCode: l.getCurrencyCode() }))) }) }), l.model.set("receiverList", s), l.$el.find(".predict-price .price").html(l.calcTotalFreight()), l.showBulkModify(!1) } }) } } "hk" === d.getSiteLocation() ? sfgather.trackClicks("点击批量选择收件人的确定选择按钮", "XWF010305") : sfgather.trackClicks("点击批量选择收件人的确定选择按钮", "OWF010305") }, bulkModifyCancel: function () { this.showBulkModify(!1) }, showBulkModify: function (e) { var t = this; !1 === e ? (this.$(".receiver-wrapper").removeClass("active"), this.$(".receiver-wrapper").find(".aicon-check").removeClass("aicon-check").addClass("aicon-uncheck"), this.$(".bulk-modify-confirm,.bulk-modify-cancel").fadeOut("fast", function () { t.$(".bulk-modify-select").fadeIn("fast") })) : (this.$(".receiver-wrapper").addClass("active"), this.$(".bulk-modify-select").fadeOut("fast", function () { t.$(".bulk-modify-confirm,.bulk-modify-cancel").fadeIn("fast") })) }, selectOne: function (e) { this.$(".receiver-wrapper").hasClass("active") && (this.$(e.target).hasClass("select-one") ? (this.$(e.target).hasClass("aicon-check") ? this.$(e.target).removeClass("aicon-check").addClass("aicon-uncheck") : this.$(e.target).removeClass("aicon-uncheck").addClass("aicon-check"), e.stopPropagation()) : this.$(e.currentTarget).find(".select-one").trigger("click")) }, selectAll: function (e) { this.$(e.currentTarget).hasClass("aicon-check") ? (this.$(e.currentTarget).removeClass("aicon-check").addClass("aicon-uncheck"), this.$(".select-one").removeClass("aicon-check").addClass("aicon-uncheck")) : (this.$(e.currentTarget).removeClass("aicon-uncheck").addClass("aicon-check"), this.$(".select-one").removeClass("aicon-uncheck").addClass("aicon-check")) }, modifyRate: function (e) { e.stopPropagation(); var i = this.$(e.currentTarget).parents("tr"), t = i.data("code"), n = i.data("rid"), a = this.model.get("receiverList"), s = _.find(a, function (e) { return e.rid == n }), r = { originCode: this.originRateCode, destCode: t, time: this.getBookingTime(), weight: "tw" === d.getSiteLocation() || "hk" === d.getSiteLocation() ? "0.5" : "1", queryType: this.getQueryType(s.locationCode), rateType: "toMainland" }, o = this; new u({ model: this.model, data: r, sLocationCode: this.sender.locationCode, callback: function (t) { _.each(a, function (e) { e.rid == n && (e.productName = t.limitTypeName, e.productCode = t.limitTypeCode, e.cargoTypeCode = t.cargoTypeCode, e.expressTypeCode = t.expressTypeCode, e.metaPrice = t.totalFreight, e.priceAndTime = t) }), i.find(".rate-cell").html(c.rateCell({ list: t, currencyCode: o.getCurrencyCode() })), o.model.set("receiverList", a), o.$el.find(".predict-price .price").html(o.calcTotalFreight()) } }), "hk" === d.getSiteLocation() ? sfgather.trackClicks("点击收件人列表后编辑按钮", "XWF010302") : sfgather.trackClicks("点击收件人列表后编辑按钮", "OWF010302") }, onSelectDateChange: function () { this.getRates() }, agreeTermToggle: function (e) { this.$(e.currentTarget).toggleClass("active") }, prevStep: function () { this.options.scrollable.seekTo(1), this.options.renderReceivers() }, nextStep: function () { if (null === this.pickType) return layer.alert(_l("请先选择您需要的寄件方式后，再点击下一步")), !1; if (this.canSubmitOrder = !0, 0 < this.model.get("receiverList").length) this.$("#agree-term-content").hasClass("active") ? this.checkToOrder() : this.showTerm(); else var e = this, t = _l("当前0条寄件，请返回添加收件人信息"), i = layer.confirm(t, { title: _l("温馨提示"), btn: [_l("确定")], closeBtn: 0 }, function () { layer.close(i), e.prevStep() }) }, checkToOrder: function () { $.cookie("loginUser") ? this.onSubmitOrder() : n.trigger(n.Needlogin, { succCallback: this.onSubmitOrder.bind(this), cancelCallback: null }) }, getCargoList: function (e) { return d.isHK_MC_TW(e) ? null : [{ name: "文件", uom: "", desc: "", price: "0" }] }, getReceiversInfo: function () { var e = this.model.get("receiverList"), n = [], a = this; return _.each(e, function (e) { var t; t = "string" == typeof e.metaPrice && -1 < e.metaPrice.indexOf("元") ? e.metaPrice.substring(0, e.metaPrice.length - 1) : "NaN" === parseFloat(e.metaPrice).toString() ? 0 : e.metaPrice; var i = { index: e.rid, destinationAddress: _.omit(e, "rid", "destRateCode", "productCode", "productName", "setMark", "cargoTypeCode", "expressTypeCode", "priceAndTime", "index", "obj"), remark: 1 === a.pickType ? a.choosedMsg : "", productCode: e.productCode, productName: e.productName.substring(0, 20), metaWeight: "tw" === d.getSiteLocation() || "hk" === d.getSiteLocation() ? "0.5" : "1", metaPrice: t, cargoList: a.getCargoList(e.locationCode), custom: null, paymethod: 1, custid: "", supportValue: "", premium: "", controlStrategy: e.obj ? e.obj.controlStrategy : "", notificationMsg: e.obj ? e.obj.notificationMsg : "", selfPickUpFlag: e.selfPick }; i.appointFlow = d.getFlowCode(e.locationCode, a.model.get("senderLocationCityCode")), n.push(i) }), n }, getSubmitPostData: function () { var e; return { expectStartTm: (e = 1 === this.pickType ? this.pickupTimePicker.getDateTime() : this.initialDateTime).start && moment(e.start).format("YYYY-MM-DD HH:mm:ss"), expectFinishTm: e.finish && moment(e.finish).format("YYYY-MM-DD HH:mm:ss"), selfSend: 2 === this.pickType, originateAddress: _.omit(this.sender, "setMark"), destinationInfo: this.getReceiversInfo() } }, submitOrderNext: function () { var e = layer.load(0, { shade: [.2, "#000"] }), t = this.getSubmitPostData(), r = this; sfAjax.bulkSubmitNewOrder({ data: t, success: function (e) { if (e && 0 == e.code && 0 < e.result.length) { var t = e.result, i = []; _.each(t, function (e) { 0 == e.success && i.push(e.index) }); var n = { succ: t.length - i.length, fail: i.length }; if (0 == n.succ) layer.msg(_l("网络异常，请重新提交订单")); else var a = _l("预约成功，其中${succ}条成功，${fail}条失败！"), s = layer.alert(a._p(n), { closeBtn: 0 }, function () { var e; layer.close(s), 0 == i.length ? e = null : ((e = r.getSubmitPostData()).destinationInfo = _.filter(e.destinationInfo, function (e) { return _.contains(i, e.index) }), _.each(e.destinationInfo, function (t) { var e = r.$("table tr"); _.each(e, function (e) { $(e).data("rid") == t.index && (t.rateHtml = $(e).find(".rate-cell").html()) }) })), r.newOrderSuccess(e, t), r.options.scrollable.seekTo(3) }); r.setAddressToStore(), r.saveToAddressBook() } else r.renderFail(e) }, error: function () { layer.msg(_l("网络异常，请重新提交订单")) }, login: { succCallback: this.submitOrderNext.bind(this), cancelCallback: null }, complete: function () { layer.close(e) } }) }, newOrderSuccess: function (e, t) { new a({ el: $(".booking-succ"), failSubmitData: e, synServerTim: this.model.get("synServerTim"), appointmentNoList: _.pluck(_.filter(t, function (e) { return 1 == e.success }), "appointmentNo"), currencyCode: this.getCurrencyCode(), selfSend: 2 === this.pickType }) }, renderFail: function (e) { 1 == e.code ? layer.msg(_l("运单号无效或已使用")) : 654 == e.code ? layer.msg(_l("月结账号无效")) : 651 == e.code ? layer.msg(_l("预约失败：下单时间不在服务时间范围内。")) : 652 == e.code ? layer.msg(_l("暂时不能为您提供收派件的服务，如有疑问请咨询我司热线95338。")) : 653 == e.code ? layer.msg(_l("账号异常！")) : 653 == e.code ? layer.msg(_l("系统繁忙，请重试！")) : layer.msg(_l("预约失败：信息校验不通过，请检查必填项。")) }, getShipperData: function () { return _.extend({ memType: 0, isDefault: 0 }, _.omit(this.sender, "setMark")) }, setAddressToStore: function () { var e = JSON.stringify(this.getShipperData()); localStorage.setItem(d.getLatestSenderKey() + $.cookie("loginUser"), e) }, saveToAddressBook: function () { var t = []; if (this.sender.setMark && t.push(this.getShipperData()), this.model.get("saveToAddressBook")) { var e = this.model.get("receiverList"); _.each(e, function (e) { e.setMark && t.push(_.extend({ memType: 1, isDefault: 0 }, _.omit(e, "rid", "destRateCode", "productCode", "productName", "setMark"))) }) } 0 < t.length && sfAjax.bulkSaveOrUpdateAddress({ data: t }) }, getAppointFlow: function (e) { return e == r.RATE_OF_HK ? "CN_HK" : e == r.RATE_OF_TW ? "CN_TW" : e == r.RATE_OF_MACAO ? "CN_MAC" : "CN_CN" }, getBatchWarmReminder: function () { var n = this.$("table tr"), a = []; sfAjax.batchBpsQueryOrderExceptionInfo({ data: this.getBatchControlParams(), success: function (e) { 0 === e.code && e.result && 0 < e.result.length && _.each(e.result, function (t) { if (t.obj && 4 == t.obj.controlStrategy && t.obj.notificationMsg) { a.push(t.obj.notificationMsg); var e = _.find(n, function (e) { return $(e).data("rid") === t.index - 1 }); $(e).addClass("reminder-tr"); var i = $(e).find(".consignee-warm-reminder"); i.html(t.obj.notificationMsg), i.attr("title", t.obj.notificationMsg) } }) } }) }, getBatchControlParams: function () { var e = this.sender, t = { channelCode: "PC.OWF" }; t.srcZoneCode = e.locationCode, t.consignedTm = this.pickupTimePicker.getDateTime() && this.pickupTimePicker.getDateTime().start ? moment(this.pickupTimePicker.getDateTime().start).format("YYYY-MM-DD HH:mm:ss") : moment(this.model.get("synServerTim")).format("YYYY-MM-DD HH:mm:ss"), t.srcAddress = d.getFullAddress(this.sender.locationCode, this.sender), t.srcCityCode = this.sender.cityCode, t.srcDivisionCode = this.sender.countyCode ? this.sender.countyCode : this.sender.cityCode; for (var i = [], n = this.model.get("receiverList"), a = 0; a < n.length; a++) { var s = {}; n[a].index = a + 1, s.index = a + 1, s.customerType = 1, s.customerCode = e.contactTel, s.productCode = "", s.destZoneCode = n[a].locationCode, s.destAddress = d.getFullAddress(n[a].locationCode, n[a]), s.destDivisionCode = n[a].countyCode ? n[a].countyCode : n[a].cityCode, s.destCityCode = n[a].cityCode, s.limitTypeCode = n[a].productCode, s.cargoTypeCode = n[a].cargoTypeCode, s.expressTypeCode = n[a].expressTypeCode, i.push(s) } return t.destBpsInfoList = i, t }, onSubmitOrder: function () { this.queryPeakControl() }, queryPeakControl: function () { var t = this; if (_webConfig.openPeakControl) { var e = layer.load(); sfAjax.queryBatchControlStrategy({ data: this.getBatchControlParams(), success: function (e) { e && 0 === e.code && 0 < e.result.length && (_.each(e.result, function (e) { null == e.obj && (e.obj = { controlStrategy: 0, customerCode: "", notificationMsg: "", serviceCode: "" }) }), _.each(t.model.get("receiverList"), function (t) { _.each(e.result, function (e) { t.index == e.index && (t.obj = e.obj) }) }), 0 < _.filter(e.result, function (e) { return 1 == e.obj.controlStrategy || 2 == e.obj.controlStrategy || 3 == e.obj.controlStrategy }).length && (t.canSubmitOrder = !1, new s({ model: t.model, callbackSubmit: t.submitOrderNext.bind(t), callbackClose: t.renderReceiverList.bind(t), callbackPrevStep: t.prevStep.bind(t), currencyCode: t.getCurrencyCode() }))) }, complete: function () { t.canSubmitOrder && t.submitOrderNext(), layer.close(e) } }) } else this.submitOrderNext() }, getFlowCode: function (e) { var t; return t = -1 < [r.RATE_OF_HK, r.RATE_OF_TW, r.RATE_OF_MACAO].indexOf(e) ? "GAT" : "ZH", (-1 < [r.RATE_OF_HK, r.RATE_OF_TW, r.RATE_OF_MACAO].indexOf(this.model.get("senderLocationCityCode")) ? "GAT" : "ZH") + "_" + t } }, p = { init: function () { var e; this.choosedMsg = "", this.sender = this.model.get("originateAddress"), this.sLocationCode = this.sender.locationCode, o.setSLocationCode(this.sLocationCode), e = d.isHK_MC_TW(this.sLocationCode) ? this.sender.cityCode : this.sender.countyCode, this.originRateCode = e, this.senderOutRange = this.model.get("senderOutRange"), this.pickType = o.getPickType(this.senderOutRange), this.msgsIndex = [0, 1, 3, 4, 5, 6] }, getQueryType: function (e) { return d.isHK_MC_TW(e) ? "12" : "4" }, getCargoList: function () { return [] } }; return "cn" === l ? e.extend(h) : "hk" === l ? e.extend(_.extend(h, p)) : void 0 }), define("components/changeAppointBill/changeAppointBillHeavyCargo", ["./changeAppointBill", "components/newBillOptions/itemsWeightAndVol"], function (e, i) { return e.extend({ init: function () { e.prototype.init.apply(this, arguments), this.quantity = this.billInfo.customerInfoList[0].cargoQuantity, this.volume = this.billInfo.customerInfoList[0].cargoVolume, this.length = this.billInfo.customerInfoList[0].cargoLength, this.width = this.billInfo.customerInfoList[0].cargoWidth, this.height = this.billInfo.customerInfoList[0].cargoHeight, this.width ? this.rateVolume = this.length * this.width * this.height : this.rateVolume = this.volume, this.medciName = _l("医药卫生"), this.insureTimes = 5, this.msgsIndex = [3, 4, 5] }, popItemsAndWeight: function () { var t = this; new i({ choosedItem: this.cargoItems, choosedMedci: this.cargoMedci, weight: this.cargoWeight, volume: this.volume, quantity: this.quantity, length: this.length, width: this.width, height: this.height, callback: function (e) { t.cargoItems = e.items, t.cargoMedci = e.medci, t.cargoWeight = e.weight, t.volume = e.volume, t.quantity = e.quantity, t.length = e.length, t.width = e.width, t.height = e.height, t.rateVolume = e.rateVolume, t.showItemsAndWeight(), t.fetchPriceAndTimes() } }) }, showItemsAndWeight: function () { this.$(".items-show").text(this.cargoItems), this.$(".weight-show").text(this.cargoWeight + "kg") }, fetchPriceAndTimes: function () { var e = { originCode: this.billInfo.appointmentOriginDetail.countyCode, destCode: this.destinationAddress.countyCode, time: moment().format(), queryType: 1, rateType: "heavyCargo", weight: this.cargoWeight, volume: this.rateVolume }; this.loadIndex = layer.load(0, { shade: [.2, "#000"] }), this.rateCollection.rateSearch(e) }, getRatePrice: function () { layer.close(this.loadIndex); var e = this.rateCollection.toJSON(); 0 == e.length || 1 == e.length && isNaN(parseFloat(e[0].totalFreight)) ? this.ratePrice = null : e[0].productCode == this.billInfo.productInfo.code ? this.ratePrice = e[0].totalFreight : this.ratePrice = null, this.changePredictPrice() }, getProductTypeName: function () { var e = this.billInfo.productInfo.code; return "SE0100" == e ? "重货包裹" : "SE0101" == e ? "小票零担" : "" }, getCargoList: function () { return [{ name: this.cargoItems.substring(0, 10), uom: "", desc: this.cargoMedci, price: "0", quantity: this.quantity, length: this.length, width: this.width, height: this.height, volume: this.volume }] } }) }), define("views/query/components/cancelAppointBill", ["baseView", "templates"], function (e, t) { return e.extend({ template: t.cancelAppointBill, layerOpts: { title: _l("温馨提示"), area: ["480px", "564px"], skin: "line" }, events: { "click .reason-items a": "chooseItem", "click .btn-wrapper .select-confirm": "confirm", "click .btn-wrapper .select-cancel": "cancel" }, init: function (e) { this.appointmentNo = e.appointmentNo, this.pickupType = e.pickupType }, render: function () { this.$el.html(this.template()); var e = this.$(".reason-items").find(".aicon-circle-check.checked")[0]; this.cusReason = $(e).next()[0].innerText }, chooseItem: function (e) { e.stopPropagation(); var t = $(e.currentTarget), i = this.$(".reason-items").find(".aicon-circle-check.checked"); _.each(i, function (e) { $(e).removeClass("checked") }), t.children(".aicon-circle-check").hasClass("checked") || (t.children(".aicon-circle-check").addClass("checked"), this.cusReason = t.children(".item-text")[0].innerText) }, confirm: function (e) { e.stopPropagation(); var t = this; sfAjax.cancelAppointmentBill({ data: { appointmentNo: this.appointmentNo, pickupType: this.pickupType, cusReason: this.cusReason }, success: function (e) { 0 === e.code ? (layer.msg(_l("订单已取消")), t.options.callback()) : layer.msg(_l("该包裹已揽收或者取消，取消寄件失败")) }, error: function () { layer.msg(_l("订单取消失败")) }, complete: function () { t.cancel() } }) }, cancel: function (e) { this.$el.parent().parent().find(".layui-layer-close").trigger("click") } }) }), define("views/pages/order/cn/orderSuccess", ["baseView", "templates", "utils/time", "helper", "components/changeAppointBill/changeAppointBill", "components/changeAppointBill/changeAppointBillHeavyCargo", "components/changeAppointBill/changeAppointBillHmt", "views/query/components/cancelAppointBill", "components/newBillOptions/showBillDetail", "components/digitalWaybill/index", "bus/index", "sflayer"], function (e, t, i, s, n, a, r, o, l, c, d) { var u = ["T1", "T104", "T8", "T801", "T4", "T6"], h = ["SE0100", "SE0101"], p = s.getSiteLocation(), f = { init: function (e) { this.appointmentNo = e.appointmentNo, this.waybillNo = e.waybillNo }, template: t.orderSuccess, render: function () { var a = this; sfAjax.queryAppointBill({ data: { appointmentNo: this.appointmentNo }, success: function (e) { var t = (a.info = e).appointmentDetail; a.sLocationCode = t.appointmentOriginDetail.locationCode, a.rLocationCode = t.appointmentDestDetail.locationCode, d.setSLocationCode(a.sLocationCode), d.setRLocationCode(a.rLocationCode), a.pickupType = t.pickupType; var i = a.getOutDoorTime(t), n = s.getCurrencyByCode(a.sLocationCode); a.$el.html(a.template({ data: t, info: l.afterProcessingDetail(t, n), relativeDate: a.getRelativeDate(i), relativeHour: i.format("HH:mm"), sender: t.appointmentOriginDetail, receiver: t.appointmentDestDetail, waybillUrl: s.getDynamicURLWithContext("/waybill/"), isSelfSend: a.options.selfSend, isQr: 3 == a.pickupType && !a.options.selfSend, waybillNo: a.waybillNo, hasCargoService: d.hasCargoService(), hasCargoInsure: d.hasCargoInsure() })) }, error: function () { a.queryChangeAppointBillFail() }, login: { succCallback: this.render.bind(this), cancelCallback: this.queryChangeAppointBillFail.bind(this) }, complete: function () { a.setElement(a.$(".order-success")), window.scrollTo(0, 0) } }) }, events: { "click .cancel": "cancelOrder", "click .fill-bill": "fillBill", "click .order-again": "orderAgain", "click .download": "downloadDigital", "click .go-waybill": "viewTheOrderList" }, viewTheOrderList: function () { "hk" === s.getSiteLocation() ? sfgather.trackClicks("点击查看订单列表", "XWF010402") : sfgather.trackClicks("点击查看订单列表", "OWF010402") }, queryChangeAppointBillFail: function () { this.$el.html(this.template({ data: null, imgUrl: s.getResourceURL("images/order/box-happy.png"), isQr: 3 == this.pickupType && !this.options.selfSend, waybillNo: this.waybillNo, waybillUrl: s.getDynamicURLWithContext("/waybill/") })) }, getOutDoorTime: function (e) { var t; return t = e.expectStartTm ? e.expectStartTm : e.appointmentTime, moment(t, "YYYY-MM-DD HH:mm:ss").add("hour", 1) }, getRelativeDate: function (e) { return i.relativeDate(e, this.options.synServerTim) }, cancelOrder: function () { new o({ appointmentNo: this.appointmentNo, pickupType: this.pickupType, callback: function () { window.location.reload() } }) }, fillBill: function () { var e = { billInfo: this.info.appointmentDetail, callback: function () { this.render(), window.scrollTo(0, 0) }.bind(this) }; if (s.isHK_MC_TW(this.rLocationCode)) new r(e); else { var t = this.info.appointmentDetail.productInfo.code; -1 < u.indexOf(t) ? new n(e) : -1 < h.indexOf(t) && new a(e) } sfgather.trackClicks("点击收件人后完善快件信息按钮", "OWF010405") }, orderAgain: function () { window.location.reload() }, downloadDigital: function () { new c({ infoList: [this.info] }), "hk" === s.getSiteLocation() ? sfgather.trackClicks("点击下载电子运单", "XWF010403") : sfgather.trackClicks("点击下载电子运单", "OWF010403") } }, m = { fillBill: function () { var e = { billInfo: this.info.appointmentDetail, callback: function () { this.render(), window.scrollTo(0, 0) }.bind(this) }; this.sLocationCode == this.rLocationCode ? new n(e) : new r(e), sfgather.trackClicks("点击收件人后完善快件信息按钮", "XWF010405") } }; return "cn" === p ? e.extend(f) : "hk" === p ? e.extend(_.extend(f, m)) : void 0 }), define("views/pages/order/cn/bulkShipping/bookingInfo/bookingInfo", ["baseView", "templates", "helper", "event", "components/detailDateTimePicker/pickupTimePicker", "../../../innerViews/priceAndTime", "../../orderSuccess", "const", "bus/index"], function (e, t, a, i, n, s, r, o, l) { var c = a.getSiteLocation(), d = { template: t.bookingInfo, init: function () { this.sender = this.model.get("originateAddress"), this.receiver = this.model.get("receiverList")[0], this.sLocationCode = this.sender.locationCode, this.rLocationCode = this.receiver.locationCode, l.setSLocationCode(this.sLocationCode), l.setRLocationCode(this.rLocationCode), this.senderOutRange = this.model.get("senderOutRange"), this.pickType = l.getPickType(this.senderOutRange), this.isTW = this.rLocationCode == o.RATE_OF_TW, this.isHMT = a.isHK_MC_TW(this.rLocationCode) }, render: function () { this.$el.html(this.template({ showToggle: l.hasPickTypeToggle(), senderOutRange: this.senderOutRange })), this.togglePickUpTypeView(), this.model.getServerCurrentTime(), this.model.getCityWorkingTime({ cityCode: this.model.get("senderLocationCityCode"), address: this.sender.address }), this.pickupTimePicker = new n({ el: this.$(".pickup-time"), serverTime: this.model.get("synServerTim"), dateTimes: this.model.get("dateTimes") }), this.initialDateTime = this.pickupTimePicker.getDateTime(), this.priceAndTime = new s({ el: this.$(".product-type-wrapper"), orderModel: this.model, callback: this.resetDefaultProduct.bind(this), type: 1, sLocationCode: this.sLocationCode }), this.fetchPriceAndTimes(), this.setElement(this.$(".booking-info-wrapper")) }, events: { "change #date": "fetchPriceAndTimes", "click .prev": "prevStep", "click .next": "nextStep", "click .term": "showTerm", "click #agree-term-content": "agreeTermToggle", "click .pick-type a": "pickTypeToggle", "click .sing-vote": "singVoteTime" }, togglePickUpTypeView: function () { var e = this; this.$(".pick-type .icon").removeClass("aicon-radio-active").addClass("aicon-radio"), 1 === this.pickType ? (this.$(".on-door .icon").addClass("aicon-radio-active").removeClass("aicon-radio"), this.$(".show-by-self").fadeOut(function () { e.$(".show-on-door").fadeIn() })) : null === this.pickType ? this.$(".show-by-self").fadeOut(function () { e.$(".show-on-door").fadeIn() }) : 2 === this.pickType && (this.$(".by-self .icon").addClass("aicon-radio-active").removeClass("aicon-radio"), this.$(".show-on-door").fadeOut(function () { e.$(".show-by-self").fadeIn() })) }, pickTypeToggle: function (e) { var t = this.$(e.currentTarget); t.hasClass("on-door") && 1 === this.pickType || t.hasClass("by-self") && 2 === this.pickType || (t.hasClass("on-door") && this.senderOutRange ? layer.alert(_l("您的寄件地址只支持自寄下单，如需选择快递员上门取件可修改您的寄件地址")) : (t.hasClass("on-door") ? this.pickType = 1 : this.pickType = 2, this.togglePickUpTypeView(), this.fetchPriceAndTimes())) }, singVoteTime: function () { "hk" === a.getSiteLocation() ? sfgather.trackClicks("点击上门时间", "XWF010301") : sfgather.trackClicks("点击上门时间", "OWF010301") }, getBookingTime: function () { var e; return (e = 1 === this.pickType ? this.pickupTimePicker.getDateTime() : this.initialDateTime) && e.start ? e.start : this.model.get("synServerTim").format() }, getMetaWeight: function () { return "tw" === a.getSiteLocation() || "hk" === a.getSiteLocation() ? "0.5" : "1" }, getQueryType: function () { return this.isHMT ? "3" : "2" }, fetchPriceAndTimes: function () { var e; e = a.isHK_MC_TW(this.rLocationCode) ? this.receiver.cityCode : this.receiver.countyCode; var t = { originCode: this.sender.countyCode, destCode: e, time: this.getBookingTime(), weight: this.getMetaWeight(), queryType: this.getQueryType(), rateType: "toMainland" }; this.priceAndTime.fetchTimeAndRate(t), this.$(".product-type-content").slideDown() }, resetDefaultProduct: function (e) { this.$(".next").toggleClass("disabled", !1), this.productCode = e.limitTypeCode, this.productName = e.limitTypeName, this.cargoTypeCode = e.cargoTypeCode, this.expressTypeCode = e.expressTypeCode, this.totalFreight = e.totalFreight, "sc" === a.getSiteLanguage() && this.getWarmReminder() }, prevStep: function () { this.options.scrollable.seekTo(1) }, nextStep: function () { if (null === this.pickType) return layer.alert(_l("请先选择您需要的寄件方式后，再点击下一步")), !1; this.$("#agree-term-content").hasClass("active") ? this.checkToOrder() : this.showTerm() }, showTerm: function (t) { $(window).resize(function () { $("iframe").css("height", $(this).height() - 200) }); var e = a.getURLWithContext("other/modal/order_terms.html"), i = this; layer.open({ title: _l("电子运单契约条款"), type: 2, area: ["960px"], offset: "40px", content: [e, "no"], btn: _l("我已阅读该条款，同意遵守"), yes: function (e) { i.$("#agree-term-content").addClass("active"), t || i.checkToOrder(), layer.close(e) } }), $(window).resize() }, agreeTermToggle: function (e) { this.$(e.currentTarget).toggleClass("active") }, checkToOrder: function () { $.cookie("loginUser") ? this.onSubmitOrder() : i.trigger(i.Needlogin, { succCallback: this.onSubmitOrder.bind(this), cancelCallback: null }) }, getSubmitPostData: function () { var e; return { expectStartTm: (e = 1 === this.pickType ? this.pickupTimePicker.getDateTime() : this.initialDateTime).start && moment(e.start).format("YYYY-MM-DD HH:mm:ss"), expectFinishTm: e.finish && moment(e.finish).format("YYYY-MM-DD HH:mm:ss"), selfSend: 2 === this.pickType, originateAddress: _.omit(this.sender, "setMark"), destinationInfo: this.getReceiversInfo() } }, onSubmitOrder: function () { this.queryPeakControl() }, getShipperData: function () { return _.extend({ memType: 0, isDefault: 0 }, _.omit(this.sender, "setMark")) }, setAddressToStore: function () { var e = JSON.stringify(this.getShipperData()); localStorage.setItem(a.getLatestSenderKey() + $.cookie("loginUser"), e) }, saveToAddressBook: function () { var e = []; this.sender.setMark && e.push(this.getShipperData()), this.model.get("saveToAddressBook") && this.receiver.setMark && e.push(_.extend({ memType: 1, isDefault: 0 }, _.omit(this.receiver, "rid", "setMark"))), 0 < e.length && sfAjax.bulkSaveOrUpdateAddress({ data: e }) }, creatOrder: function () { var e = this.getSubmitPostData(), t = layer.load(0, { shade: [.2, "#000"] }), i = this; sfAjax.submitNewOrder({ data: e, success: function (e) { e && 0 == e.code ? (i.newOrderSuccess(e.result), i.options.scrollable.seekTo(3), i.setAddressToStore(), i.saveToAddressBook()) : i.renderFail(e) }, error: function () { layer.msg(_l("网络异常，请重新提交订单")) }, login: { succCallback: this.onSubmitOrder.bind(this), cancelCallback: null }, complete: function () { layer.close(t) } }) }, newOrderSuccess: function (e) { new r({ el: $(".booking-succ"), synServerTim: this.model.get("synServerTim"), appointmentNo: e, waybillNo: null, selfSend: 2 === this.pickType }) }, getCargoList: function () { return this.isHMT ? null : [{ name: "文件", uom: "", desc: "", price: "0" }] }, getReceiversInfo: function () { var e = this.receiver, t = []; return e = { destinationAddress: _.omit(e, "rid", "destRateCode", "productCode", "productName", "setMark"), remark: "", productCode: this.productCode, productName: this.productName.substring(0, 20), metaWeight: this.getMetaWeight(), metaPrice: parseFloat(this.totalFreight), cargoList: this.getCargoList(), custom: null, paymethod: "1", custid: "", supportValue: "", premium: "", controlStrategy: this.controlStrategy, notificationMsg: this.notificationMsg, selfPickUpFlag: e.selfPick, signedBackFlg: "0", signedBackSop: "", signedBackName: "", codAmt: "", codCustid: "", appointFlow: a.getFlowCode(e.locationCode, this.model.get("senderLocationCityCode")) }, t.push(e), t }, renderFail: function (e) { 1 == e.code ? layer.msg(_l("运单号无效或已使用")) : 654 == e.code ? layer.msg(_l("月结账号无效")) : 651 == e.code ? layer.msg(_l("预约失败：下单时间不在服务时间范围内。")) : 652 == e.code ? layer.msg(_l("暂时不能为您提供收派件的服务，如有疑问请咨询我司热线95338。")) : 653 == e.code ? layer.msg(_l("账号异常！")) : 502 == e.code ? layer.msg(_l("系统繁忙，请重试！")) : layer.msg(_l("预约失败：信息校验不通过，请检查必填项。")) }, getControlUrlParams: function () { return { srcCityCode: this.sender.cityCode, destCityCode: this.receiver.cityCode } }, getControlPostParams: function () { return { customerType: 1, customerCode: this.sender.contactTel || this.sender.contactPhone, channelCode: "PC.OWF", srcZoneCode: this.sender.locationCode, destZoneCode: this.receiver.locationCode, srcAddress: a.getFullAddress(this.sender.locationCode, this.sender), destAddress: a.getFullAddress(this.receiver.locationCode, this.receiver), srcDivisionCode: this.sender.countyCode ? this.sender.countyCode : this.sender.cityCode, destDivisionCode: this.receiver.countyCode ? this.receiver.countyCode : this.receiver.cityCode, productCode: "", limitTypeCode: this.productCode, cargoTypeCode: this.cargoTypeCode, expressTypeCode: this.expressTypeCode, consignedTm: this.pickupTimePicker.getDateTime().start ? moment(this.pickupTimePicker.getDateTime().start).format("YYYY-MM-DD HH:mm:ss") : moment(this.model.get("synServerTim")).format("YYYY-MM-DD HH:mm:ss") } }, resetPeakControlInfo: function () { this.canOrder = !0, this.notificationMsg = "", this.controlStrategy = void 0 }, queryPeakControl: function () { var t = this; if (this.resetPeakControlInfo(), _webConfig.openPeakControl) { var i = layer.load(); sfAjax.queryCustomerControlStrategy({ params: this.getControlUrlParams(), data: this.getControlPostParams(), success: function (e) { if (e && 0 === e.code && e.result) switch (t.controlStrategy = e.result.controlStrategy, e.result.controlStrategy) { case 0: break; case 1: t.canOrder = !1; case 2: case 3: case 4: t.notificationMsg = e.result.notificationMsg } }, complete: function () { if (t.canOrder) if (2 === t.controlStrategy || 3 === t.controlStrategy || 4 === t.controlStrategy) var e = layer.confirm(t.notificationMsg, { title: _l("温馨提示"), btn: [_l("确定"), _l("取消")] }, function () { layer.close(e), t.creatOrder() }, function () { layer.close(e) }); else t.creatOrder(); else layer.alert(t.notificationMsg); layer.close(i) } }) } else t.creatOrder() }, getWarmReminder: function () { sfAjax.bpsQueryOrderExceptionInfo({ params: this.getControlUrlParams(), data: this.getControlPostParams(), success: function (e) { 0 === e.code && e.result && 4 == e.result.controlStrategy && $(".consignee-warm-reminder").html(e.result.notificationMsg).show() } }) }, getFlowCode: function () { var e; return e = -1 < [o.RATE_OF_HK, o.RATE_OF_TW, o.RATE_OF_MACAO].indexOf(this.receiver.locationCode) ? "GAT" : "ZH", (-1 < [o.RATE_OF_HK, o.RATE_OF_TW, o.RATE_OF_MACAO].indexOf(this.model.get("senderLocationCityCode")) ? "GAT" : "ZH") + "_" + e } }, u = { fetchPriceAndTimes: function () { var e, t = this.receiver.locationCode; e = a.isHK_MC_TW(t) ? this.receiver.cityCode : this.receiver.countyCode; var i = this.sender.locationCode, n = { originCode: a.isHK_MC_TW(i) ? this.sender.cityCode : this.sender.countyCode, destCode: e, time: this.getBookingTime(), weight: this.getMetaWeight(), queryType: this.getQueryType(), rateType: "toMainland" }; this.priceAndTime.fetchTimeAndRate(n), this.$(".product-type-content").slideDown() }, getQueryType: function () { return this.isHMT ? "12" : "4" }, getCargoList: function () { return null } }; return "cn" === c ? e.extend(d) : "hk" === c ? e.extend(_.extend(d, u)) : void 0 }), define("components/addressBook/bulkShippingReceiverModify", ["./addressBookModify", "helper", "sflayer"], function (e, t) { var i = t.getSiteLocation(), n = { saveAddress: function () { if (this.validateshipper()) var e = _.extend(_.omit(this.getFormDataObj(), "location"), this.getLocation(), { rid: this.addressBook.rid }), t = this, i = layer.confirm(_l("保存成功"), { noStop: !0, btn: _l("确定"), yes: function () { layer.close(i), t.options.callback(e), t.close() } }) } }, a = { init: function () { e.prototype.init.apply(this, arguments), this.showSelfRaising = !0 }, events: _.extend({ "blur .self-raising-point": "checkSelfRaisingPoint" }, e.prototype.events), checkSelfRaisingPoint: function (a) { var e = this.$(a.currentTarget).val(); if ("" !== e) { "" !== this.$('[name="location"]').val() ? (this.getLocation().province, this.getLocation().city, this.getLocation().county) : ""; var t = layer.load(0, { shade: [.2, "#000"] }), s = this; sfAjax.getAddressByPointCode({ data: { address: e, province: "", city: "", district: "" }, success: function (e) { if (e && 0 == e.code && e.result) { var t = layer.load(0, { shade: [.2, "#000"] }), n = e.result.serviceCode; sfAjax.addressSplit({ data: { address: e.result.address }, success: function (e) { if (0 === e.code) { var t, i = e.result || {}; 1 == i.splitType ? t = _l("未找到对应的省份，请您手动进行选择哦！") : 2 == i.splitType ? t = _l("未找到对应的城市，请您手动进行选择哦！") : 3 == i.splitType && (t = _l("未找到对应的行政区，请您手动进行选择哦！")), t ? layer.confirm(t, { btn: [_l("我知道了")] }, function (e) { layer.close(e), s.location.setLocation(i.originDestRegions) }) : s.location.setLocation(i.originDestRegions), s.$(a.currentTarget).val(n ? i.site + "  " + n : i.site) } }, error: function () { layer.msg(_l("网络异常")) }, complete: function () { layer.close(t) } }) } }, complete: function () { layer.close(t) } }) } } }; return "cn" === i ? e.extend(n) : "hk" === i ? e.extend(_.extend(n, a)) : "tw" === i ? e.extend(_.extend(n, {})) : void 0 }), define("views/pages/order/cn/bulkShipping/receiverInfo/topAddOneReceiver", ["components/addressBook/addressBookAdd"], function (e) { return e.extend({ saveAddress: function () { if (this.validateshipper()) { var e = _.extend(_.omit(this.getFormDataObj(), "location"), { addressId: "", locationCode: this.addLocation.locationCode, country: "中国", countryCode: "A000086000", province: this.addLocation.province, provinceCode: this.addLocation.provinceCode, city: this.addLocation.city, cityCode: this.addLocation.cityCode, county: this.addLocation.county, countyCode: this.addLocation.countyCode, longitude: "", latitude: "", postalCode: "", selfPick: !1 }); this.options.callback(e), this.close() } } }) }), define("views/pages/order/cn/bulkShipping/bookingInfo/outRange", ["baseView", "templates", "helper", "views/others/bootstrapPagination", "event", "sflayer"], function (e, t, i, n, a, s) { return e.extend({ events: { "click tr": "selectOne", "click .select-all": "selectAll", "click .continue-submit": "comformSubmit" }, template: t.outRange, layerOpts: { title: _l("地址超范围提示"), skin: "line", area: "800px" }, render: function () { var e = _.filter(this.model.get("receiverList"), function (e) { return 1 === e.state && !e.selfPick }); this.$el.html(this.template({ outRangeList: e })); var t = this; $(window).resize(function () { t.$(".height-scroll").height() > $(this).height() - 364 ? t.$(".height-scroll").css("height", $(this).height() - 364) : t.$(".height-scroll").css("height", "auto") }), $(window).resize() }, selectOne: function (e) { this.$(e.target).hasClass("select-one") ? (this.$(e.target).hasClass("aicon-check") ? (this.$(e.target).removeClass("aicon-check").addClass("aicon-uncheck"), this.$(".select-all").hasClass("aicon-check") && this.$(".select-all").removeClass("aicon-check").addClass("aicon-uncheck")) : (this.$(e.target).removeClass("aicon-uncheck").addClass("aicon-check"), this.$(".select-one").hasClass("aicon-uncheck") || this.$(".select-all").removeClass("aicon-uncheck").addClass("aicon-check")), e.stopPropagation()) : this.$(e.currentTarget).find(".select-one").trigger("click") }, selectAll: function (e) { this.$(e.currentTarget).hasClass("aicon-check") ? (this.$(e.currentTarget).removeClass("aicon-check").addClass("aicon-uncheck"), this.$(".select-one").removeClass("aicon-check").addClass("aicon-uncheck")) : (this.$(e.currentTarget).removeClass("aicon-uncheck").addClass("aicon-check"), this.$(".select-one").removeClass("aicon-uncheck").addClass("aicon-check")) }, comformSubmit: function (e) { var t = this.$(".select-one.aicon-check"); if (0 < t.length) { var i = this.model.get("receiverList"); _.each(i, function (i) { _.each(t.parents("tr"), function (e) { var t = $(e).data("rid"); i.rid === t && (i.selfPick = !0) }) }), this.model.set("receiverList", i), this.close(), _.filter(i, function (e) { return 1 === e.state && !e.selfPick }).length < 1 && (_.each(this.model.get("receiverList"), function (e) { delete e.state }), this.options.callbackGoNextStep()) } else layer.alert(_l("请选择一条数据")) } }) }), define("views/pages/order/cn/bulkShipping/receiverInfo/receiverInfo", ["baseView", "templates", "event", "helper", "../shipper/receiver", "./excelTemplate", "components/addressBook/bulkShippingAddressBook", "../bookingInfo/bulkBookingInfo", "../bookingInfo/bookingInfo", "components/addressBook/bulkShippingReceiverModify", "./topAddOneReceiver", "../bookingInfo/outRange", "sflayer"], function (e, a, t, s, i, n, r, o, l, c, d, u) { return e.extend({ template: a.receiverInfo, init: function () { this.region = s.getSiteLocation(), this.receivers = [], this.model.set("receiverList", []), this.onlyIssues = !1, this.model.set("saveToAddressBook", !0) }, render: function () { this.$el.html(this.template()), this.hideTipsOnScroll(), this.addOneReiceiver() }, events: { "click .prev": "prevStep", "click .next": "nextStep", "click .add-one": "addOneReiceiver", "click .add-from-addressBook": "addFromAddressBook", "click .add-from-excel": "showExcelTemplate", "click .l-modify": "modifyReceiver", "click .l-delete": "deleteReceiver", "click .only-issues": "onlyIssuesItems", "click .save-address-check": "toggleSaveAddress", "click .add-more": "addMoreReiceiver" }, addOneReiceiver: function (e) { if (0 < this.model.get("receiverList").length) new d({ callback: function (e) { this.pushReceiver(e), this.renderReceiverList() }.bind(this) }); else { var t = new i({ el: $('<div class="receiver"></div>'), rDelete: !0, rIndex: !0, deleteCallback: this.receiverDelete.bind(this), locationChange: function () { } }); this.$(".receiver-container").append(t.$el), t.$el.slideDown("fast"), this.receivers.push(t), this.renderIndex() } null != e && ("hk" === s.getSiteLocation() ? sfgather.trackClicks("点击添加一个收件人", "XWF010205") : sfgather.trackClicks("点击添加一个收件人", "OWF010205")) }, renderIndex: function () { 1 == this.receivers.length ? this.receivers[0].showIndex(null) : _.each(this.receivers, function (e, t) { e.showIndex(t) }), this.receivers[0].hideDelete() }, receiverDelete: function (t) { this.receivers = _.reject(this.receivers, function (e) { return e.cid == t }), this.renderIndex() }, addFromAddressBook: function (e) { this.validateAddOneReceiver() && ($.cookie("loginUser") ? this.showAddressBook(e) : t.trigger(t.Needlogin, { succCallback: this.addFromAddressBook.bind(this), cancelCallback: null })), "hk" === s.getSiteLocation() ? sfgather.trackClicks("点击从地址簿添加", "XWF010206") : sfgather.trackClicks("点击从地址簿添加", "OWF010206") }, showAddressBook: function (e) { var t = this; this.isLocked(e) || sfAjax.fetchAddressBookList({ data: { pageNo: 1, rowCount: "8", condition: "" }, success: function (e) { e && 0 == e.code ? t.newAddressBookView(e) : layer.msg(_l("网络错误")) }, error: function () { layer.msg(_l("网络错误")) }, complete: function () { t.unlock(e) }, login: { succCallback: this.showAddressBook.bind(this), cancelCallback: null } }) }, newAddressBookView: function (e) { var t = this; new r({ addressBooks: e.result.content, totalPage: e.result.totalPage, page: e.result.pageNo, callback: function (e) { t.pushReceiver(e), t.renderReceiverList() } }) }, showExcelTemplate: function () { if ("hk" === s.getSiteLocation() ? sfgather.trackClicks("点击从Excel表格添加", "XWF010208") : sfgather.trackClicks("点击从Excel表格添加", "OWF010208"), this.validateAddOneReceiver()) { var t = this; new n({ callback: function (e) { _.each(e, function (e) { e.address.message = e.message, e.address.normal = e.normal, e.address.country = e.address.country || "中国", e.address.countryCode = e.address.countryCode || "A000086000" }), t.pushReceiver(_.pluck(e, "address")), t.renderReceiverList() } }) } }, pushReceiver: function (e) { this.model.get("receiverList").push(e), this.model.set("receiverList", _.flatten(this.model.get("receiverList"))) }, renderReceiverList: function (e) { var t, i = this.model.get("receiverList"); void 0 === _.find(i, function (e) { return !1 === e.normal }) ? (this.onlyIssues = !1, this.$(".only-issues").removeClass("aicon-check").addClass("aicon-uncheck"), t = !1) : t = !0; var n = 0; 0 < i.length ? (this.receivers = [], _.each(i, function (e) { e.rid = n, n += 1, e.address = e.deptCode && -1 == e.address.indexOf(e.deptCode) ? e.address + "  " + e.deptCode : e.address }), this.$(".receiver-container").html(a.renderReceiverList({ rList: i, onlyIssues: this.onlyIssues, showOnlyIssues: t })), this.$(".drop-down-wrapper").show(), this.$(".btn_nav .dropdown").hide(), this.onlyIssues && this.$(".normal").hide()) : e && (this.$(".receiver-container").empty(), this.addOneReiceiver(), this.$(".drop-down-wrapper").hide(), this.$(".btn_nav .dropdown").show()) }, hideTipsOnScroll: function () { var e = this; this.$(".height-scroll").scroll(function () { layer.close(e.modifyTip), layer.close(e.deleteTip) }) }, modifyReceiver: function (e) { var t = $(e.currentTarget).parents("tr").data("rid"), i = _.findWhere(this.model.get("receiverList"), { rid: t }); new c({ addressBook: i, callback: this.modifyReceiverSucc.bind(this) }), e.stopPropagation(), "hk" === s.getSiteLocation() ? sfgather.trackClicks("点击收方信息列表后的修改按钮", "XWF010211") : sfgather.trackClicks("点击收方信息列表后的修改按钮", "OWF010211") }, modifyReceiverSucc: function (t) { _.each(this.model.get("receiverList"), function (e) { e.rid == t.rid && (_.extend(e, t, { normal: !0, changed: !0 }), delete e.selfPick) }), this.renderReceiverList() }, deleteReceiver: function (e) { var t = this.$(e.currentTarget).parents("tr").data("rid"), i = _l("您确定要删除该收件人？"), n = this, a = layer.confirm(i, { noStop: !0, btn: [_l("确定"), _l("取消")] }, function () { var e = n.model.get("receiverList"); e = _.reject(e, function (e) { return e.rid == t }), n.model.set("receiverList", e), n.renderReceiverList(!0), layer.close(a) }, function () { layer.close(a) }) }, validateAddOneReceiver: function () { var t = !0; if (_.each(this.receivers, function (e) { e.isAllNull() || e.validateshipper() || (t = !1) }), t) { var i = this; _.each(this.receivers, function (e) { e.isAllNull() || i.pushReceiver(e.getShipperData()) }), this.renderReceiverList() } return t }, onlyIssuesItems: function (e) { this.$(e.currentTarget).hasClass("aicon-check") ? (this.$(e.currentTarget).removeClass("aicon-check").addClass("aicon-uncheck"), this.onlyIssues = !1, this.$(".normal").show()) : (this.$(e.currentTarget).removeClass("aicon-uncheck").addClass("aicon-check"), this.onlyIssues = !0, this.$(".normal").hide()), "hk" === s.getSiteLocation() ? sfgather.trackClicks("点击收方信息列表页面仅显示错误地址前选项框", "XWF010213") : sfgather.trackClicks("点击收方信息列表页面仅显示错误地址前选项框", "OWF010213") }, hasIssuesItems: function () { return void 0 !== _.find(this.model.get("receiverList"), function (e) { return !1 === e.normal }) }, prevStep: function () { this.options.scrollable.seekTo(0) }, nextStep: function () { if (this.validateAddOneReceiver()) if (this.hasIssuesItems()) var e = _l("怎样处理错误的地址？"), t = this, i = layer.confirm(e, { noStop: !0, btn: [_l("直接删除"), _l("返回编辑")] }, function () { var e = t.model.get("receiverList"); e = _.reject(e, function (e) { return !1 === e.normal }), t.model.set("receiverList", e), t.renderReceiverList(!0), layer.close(i), t.limitReceivers() }, function () { layer.close(i) }); else this.limitReceivers() }, batchQueryAddressRange: function () { var e = this.model.get("receiverList"), t = {}, i = []; _.each(e, function (e) { e.addressId && !e.changed || (e.setMark = !0); var t = {}; t.index = e.rid, t.address = e.province + e.city + e.county + e.address, t.dataType = "r01", i.push(t) }), this.model.set("receiverList", e), t.addressRangeReqs = i; var a = this, n = layer.load(); sfAjax.batchQueryAddressRange({ data: t, success: function (e) { if (e && 0 === e.code && 0 < e.result.length) { var t = a.model.get("receiverList"); _.each(t, function (t) { _.each(e.result, function (e) { e.index === t.rid && (t.state = e.state) }) }), a.model.set("receiverList", t); var i = _.filter(e.result, function (e) { return 1 === e.state }), n = _.filter(t, function (e) { return !0 === e.selfPick }); 0 < i.length && i.length !== n.length ? new u({ model: a.model, callbackGoNextStep: a.goNextStep.bind(a) }) : (_.each(t, function (e) { delete e.state }), a.goNextStep()) } }, error: function () { a.goNextStep() }, complete: function () { layer.close(n) } }) }, goNextStep: function () { this.isOutRangeAndDeclare() ? layer.alert(_l("您的收件地址中包含出口件地址，无法使用自寄下单，请修改")) : (this.goBookingInfo(), this.options.scrollable.seekTo(2)) }, isOutRangeAndDeclare: function () { var t = this.model.get("senderLocationCityCode"), e = s.isHK_MC_TW(t), i = _.filter(this.model.get("receiverList"), function (e) { return s.isHK_MC_TW(e.locationCode) }), n = _.filter(this.model.get("receiverList"), function (e) { return t != e.locationCode }); return this.model.get("senderOutRange") && !(!e && 0 == i.length || e && 0 < n.length) }, limitReceivers: function () { var e = this.model.get("receiverList").length; 100 < e ? layer.alert(_l("收件人超过100条，不能下单！")) : 0 == e ? layer.alert(_l("收件人不能为空！")) : this.batchQueryAddressRange() }, goBookingInfo: function () { 1 === this.model.get("receiverList").length ? new l({ el: $(".booking-info"), model: this.model, scrollable: this.options.scrollable }) : new o({ el: $(".booking-info"), model: this.model, scrollable: this.options.scrollable, renderReceivers: this.renderReceiverList.bind(this) }) }, toggleSaveAddress: function (e) { this.$(e.currentTarget).toggleClass("checked"), this.$(e.currentTarget).hasClass("checked") ? this.model.set("saveToAddressBook", !0) : this.model.set("saveToAddressBook", !1), "hk" === s.getSiteLocation() ? sfgather.trackClicks("点击保存到地址簿单选按钮", "XWF010203") : sfgather.trackClicks("点击保存到地址簿单选按钮", "OWF010203") }, addMoreReiceiver: function () { "hk" === s.getSiteLocation() ? sfgather.trackClicks("点击+多个收件人", "XWF010204") : sfgather.trackClicks("点击+多个收件人", "OWF010204") } }) }), define("views/pages/order/cn/bulkShipping/senderInfo", ["baseView", "templates", "./shipper/sender", "./receiverInfo/receiverInfo"], function (e, t, i, n) { return e.extend({ template: t.senderInfo, render: function () { this.$el.html(this.template()), this.showSender() }, events: { "click .next": "nextStep" }, showSender: function () { this.sender = new i({ el: this.$(".sender"), locationChange: this.locationChange.bind(this) }) }, locationChange: function (e) { this.model.set("senderLocationCityCode", e) }, nextStep: function () { if (this.sender.validateshipper()) { var e = this; if (this.model.set("senderOutRange", !this.sender.notOutRange), this.sender.notOutRange) this.gotoReceiver(); else var t = _l("亲,您的寄件地址我司暂时无法上门收取件,您可以修改为其他地址,如仍继续将会为您选中自寄下单"), i = layer.confirm(t, { title: _l("温馨提示"), btn: [_l("修改地址"), _l("继续下单")] }, function () { layer.close(i) }, function () { layer.close(i), e.gotoReceiver() }) } }, gotoReceiver: function () { this.model.set("originateAddress", this.sender.getShipperData()), this.receiverInfo || (this.receiverInfo = new n({ el: $(".receiver-info"), model: this.model, scrollable: this.options.scrollable })), this.options.scrollable.seekTo(1) } }) }), function (p) { function t(e, t) { var i = p(t); return i.length < 2 ? i : e.parent().find(t) } var f; function i(e, r) { var o = this, l = e.add(o), c = e.children(), d = 0, u = r.vertical; if (f || (f = o), 1 < c.length && (c = p(r.items, e)), p.extend(o, { getConf: function () { return r }, getIndex: function () { return d }, getSize: function () { return o.getItems().size() }, getNaviButtons: function () { return i.add(s) }, getRoot: function () { return e }, getItemWrap: function () { return c }, getItems: function () { return c.children(r.item).not("." + r.clonedClass) }, move: function (e, t) { return o.seekTo(d + e, t) }, next: function (e) { return o.move(1, e) }, prev: function (e) { return o.move(-1, e) }, begin: function (e) { return o.seekTo(0, e) }, end: function (e) { return o.seekTo(o.getSize() - 1, e) }, focus: function () { return f = o }, addItem: function (e) { return e = p(e), r.circular ? (c.children("." + r.clonedClass + ":last").before(e), c.children("." + r.clonedClass + ":first").replaceWith(e.clone().addClass(r.clonedClass))) : c.append(e), l.trigger("onAddItem", [e]), o }, seekTo: function (e, t, i) { if (e.jquery || (e *= 1), r.circular && 0 === e && -1 == d && 0 !== t) return o; if (!r.circular && e < 0 || e > o.getSize() || e < -1) return o; var n = e; e.jquery ? e = o.getItems().index(e) : n = o.getItems().eq(e); var a = p.Event("onBeforeSeek"); if (!i && (l.trigger(a, [e, t]), a.isDefaultPrevented() || !n.length)) return o; var s = u ? { top: -n.position().top } : { left: -n.position().left }; return d = e, f = o, void 0 === t && (t = r.speed), c.animate(s, t, r.easing, i || function () { l.trigger("onSeek", [e]) }), o } }), p.each(["onBeforeSeek", "onSeek", "onAddItem"], function (e, t) { p.isFunction(r[t]) && p(o).bind(t, r[t]), o[t] = function (e) { return e && p(o).bind(t, e), o } }), r.circular) { var n = o.getItems().slice(-1).clone().prependTo(c), a = o.getItems().eq(1).clone().appendTo(c); n.add(a).addClass(r.clonedClass), o.onBeforeSeek(function (e, t, i) { if (!e.isDefaultPrevented()) { if (-1 == t) return o.seekTo(n, i, function () { o.end(0) }), e.preventDefault(); t == o.getSize() && o.seekTo(a, i, function () { o.begin(0) }) } }), o.seekTo(0, 0, function () { }) } var i = t(e, r.prev).click(function () { o.prev() }), s = t(e, r.next).click(function () { o.next() }); if (!r.circular && 1 < o.getSize() && (o.onBeforeSeek(function (e, t) { setTimeout(function () { e.isDefaultPrevented() || (i.toggleClass(r.disabledClass, t <= 0), s.toggleClass(r.disabledClass, t >= o.getSize() - 1)) }, 1) }), r.initialIndex || i.addClass(r.disabledClass)), r.mousewheel && p.fn.mousewheel && e.mousewheel(function (e, t) { if (r.mousewheel) return o.move(t < 0 ? 1 : -1, r.wheelSpeed || 50), !1 }), r.touch) { var h = {}; c[0].ontouchstart = function (e) { var t = e.touches[0]; h.x = t.clientX, h.y = t.clientY }, c[0].ontouchmove = function (e) { if (1 == e.touches.length && !c.is(":animated")) { var t = e.touches[0], i = h.x - t.clientX, n = h.y - t.clientY; o[u && 0 < n || !u && 0 < i ? "next" : "prev"](), e.preventDefault() } } } r.keyboard && p(document).bind("keydown.scrollable", function (e) { if (r.keyboard && !e.altKey && !e.ctrlKey && !p(e.target).is(":input")) { if ("static" != r.keyboard && f != o) return; var t = e.keyCode; if (u && (38 == t || 40 == t)) return o.move(38 == t ? -1 : 1), e.preventDefault(); if (!u && (37 == t || 39 == t)) return o.move(37 == t ? -1 : 1), e.preventDefault() } }), r.initialIndex && o.seekTo(r.initialIndex, 0, function () { }) } p.tools = p.tools || { version: "v1.2.5" }, p.tools.scrollable = { conf: { activeClass: "active", circular: !1, clonedClass: "cloned", disabledClass: "disabled", easing: "swing", initialIndex: 0, item: null, items: ".items", keyboard: !0, mousewheel: !1, next: ".next", prev: ".prev", speed: 400, vertical: !1, touch: !0, wheelSpeed: 0 } }, p.fn.scrollable = function (e) { var t = this.data("scrollable"); return t || (e = p.extend({}, p.tools.scrollable.conf, e), this.each(function () { t = new i(p(this), e), p(this).data("scrollable", t) }), e.api ? t : this) } }(jQuery), define("jquery-scrollable", ["jquery"], function () { }), define("views/pages/order/cn/bulkShipping/bulkShipping", ["baseView", "templates", "models/cityWorkingTime", "./senderInfo", "jquery-scrollable"], function (e, t, i, n) { return e.extend({ init: function () { this.model = new i }, template: t.bulkShipping, render: function () { this.$el.html(this.template()); var i = this; this.$(".bulkShipping").scrollable({ onBeforeSeek: function (e, t) { i.$(".items .page").eq(t).addClass("active") }, onSeek: function (e, t) { i.$(".step li").removeClass("active").eq(t).addClass("active"), i.$(".items .page").removeClass("active").eq(t).addClass("active") } }), this.scrollable = this.$(".bulkShipping").scrollable(), this.showSenderInfo(), this.setElement(this.$(".bulkShipping")) }, showSenderInfo: function () { new n({ el: this.$(".sender-info"), model: this.model, scrollable: this.scrollable }) } }) }), define("views/pages/order/cn/masterController", ["baseView", "templates", "./heavyCargo/heavyCargo", "./qrCode/qrCode", "./qrCode/qrOrder", "./bulkShipping/bulkShipping", "models/cityWorkingTime", "./orderSuccess", "plugins/cloudMessage", "helper", "utils/grayScale"], function (e, t, i, n, a, s, r, o, l, c, d) { var u = c.getSiteLocation(), h = { template: t.orderService, events: { "click .receiver-areas a": "tabToggle" }, init: function () { this.cityWorkingTime = new r }, render: function () { this.$el.html(this.template()); var e = this; this.$(".order-service").fadeIn("fast", function () { e.$el.css("min-height", "0px") }), this.tab && this.initTab(this.tab, this.monthAccount), this.rendered = !0 }, setTab: function (e, t) { this.tab = e, this.monthAccount = t, this.rendered && this.initTab(this.tab, this.monthAccount) }, initTab: function (e, t) { l.closeSSE(), (!e || "normalCargo" !== e && "heavyCargo" !== e && "qrCode" !== e) && (e = "normalCargo"), this.$(".receiver-areas a").removeClass("checked").attr("aria-checked", !1), this.$(".receiver-areas a[data-tab='" + e + "']").addClass("checked").attr("aria-checked", !0), "normalCargo" === e ? new s({ el: this.$(".order-wrapper") }) : "heavyCargo" === e ? (sfgather.trackClicks("点击寄大件", "111002"), new i({ el: this.$(".order-wrapper"), cityWorkingTime: this.cityWorkingTime, monthAccount: t, orderSuccess: this.showOrderSuccess.bind(this) })) : new n({ el: this.$(".order-wrapper"), showQrOrder: this.showQrOrder.bind(this) }) }, showQrOrder: function (e) { l.closeSSE(), new a({ el: this.$(".order-wrapper"), cityWorkingTime: this.cityWorkingTime, orderSuccess: this.showOrderSuccess.bind(this), waybillNo: e }) }, showOrderSuccess: function (e, t) { new o({ el: this.$(".order-wrapper"), synServerTim: this.cityWorkingTime.get("synServerTim"), appointmentNo: e, waybillNo: t }) }, tabToggle: function (e) { e.preventDefault(), $(e.target).siblings("a").attr("aria-checked", !1).end().attr("aria-checked", !0), Backbone.history.navigate($(e.target).data("tab"), { trigger: !0, replace: !1 }) } }, p = { template: t.hkOrderService, interceptor: { run: function () { var e = $.Deferred(); return d.isScale(d.GRAY_TYPE.HK_ORDER).done(function () { e.resolve() }).fail(function () { location.href = c.getDynamicURLWithContext("/send_introduced/quick/") }), e } }, render: function () { this.$el.html(this.template()); var e = this; this.$(".order-service").fadeIn("fast", function () { e.$el.css("min-height", "0px") }), this.initTab(this.tab, this.monthAccount) }, initTab: function () { l.closeSSE(), new s({ el: this.$(".order-wrapper") }) } }; return "cn" === u ? e.extend(h) : "hk" === u ? e.extend(_.extend(h, p)) : void 0 }), define("routers/orderDetailRouter", ["backbone", "views/pages/order/cn/masterController"], function (e, t) { return e.Router.extend({ initialize: function () { var e = $(".order-page"); this.orderMasterController = new t({ el: e }) }, routes: { ":targetTab": "initOrderWrapper", ":targetTab/": "initOrderWrapper", ":targetTab/monthAccount/:monthAccount": "initOrderWrapper", "*path": "initOrderWrapper" }, initOrderWrapper: function (e, t) { this.orderMasterController.setTab(e, t) } }) }), define("models/acsOrder", ["backbone"], function (e) { return e.Model.extend({ defaults: { acsBillNo: null } }) }), define("views/pages/order/acsOrder/billInput", ["backbone", "templates"], function (n, e) { return n.View.extend({ events: { "click .submit-acs": "checkAcsBillNo", "input .billInput": "inputChanged", "click .toggleChecked": "toggleChecked" }, initialize: function () { this.$el.html(e.acsBillInput()) }, checkAcsBillNo: function () { var t = this.$("#acsBillNo").val(); if (this.hideValidationBnoTip(), this.$(".billInput").parsley().validate()) { var i = this; sfAjax.validBillNo({ data: { waybillNo: t }, success: function (e) { e && 0 === e.code ? (i.model.set("acsBillNo", t), n.history.navigate("billInfoFill", { trigger: !0, replace: !1 })) : 610 === e.code ? i.$(".error[data-error=billno-used]").show() : 611 === e.code ? i.$(".error[data-error=billno-invalid]").show() : i.$(".error[data-error=network]").show() }, error: function () { i.$(".error[data-error=network]").show() } }) } }, hideValidationBnoTip: function () { this.$(".error[data-error=billno-invalid]").hide(), this.$(".error[data-error=billno-used]").hide(), this.$(".error[data-error=network]").hide() }, inputChanged: function () { this.$(".submit-acs").toggleClass("disabled", !(this.$(".billInput").parsley().validate() && this.$(".toggleChecked").hasClass("checked"))) }, toggleChecked: function (e) { this.$(e.currentTarget).toggleClass("checked"), this.inputChanged() } }) }), define("components/detailedLocationPicker/pricePicker", ["./picker"], function (e) { return e.extend({ availableRegions: function () { if ("international" === this.getSelectedArea()) { var e = this.regions.fetchingRegionLevel; return e && 0 < e ? this.regions.where({ level: e + 1 }) : this.regions.models } return this.regions.filter(function (e) { return e.get("available") || e.get("availableAsOrigin") && e.get("availableAsDestination") }) }, unavailableRegions: function () { return this.regions.filter(function (e) { return !e.get("availableAsOrigin") && !e.get("availableAsDestination") && e.get("opening") }) } }) }), define("views/pages/order/innerViews/addDeclareGoodsView", ["backbone", "templates", "helper", "sflayer", "moment"], function (e, i, t, n) { return e.View.extend({ initialize: function () { this.lang = t.getSiteLanguage().toUpperCase(), this.other = "OTHER", this.isGoodsNameLegal = !1, this.isUnitLegal = !1, this.goodsName = "" }, events: { "change .itemType": "itemTypeChangeEvent", "keyup .goodsName": "goodsNameKeyupEvent", "blur .goodsName": "goodsNameBlurEvent", "mousedown .clearance-item-form": "clearanceItemFormClickEvent", "change .unit": "unitChangeEvent", "blur .otherUnit": "otherUnitBlurEvent", "click .clearanceItemSubmitBtn": "clearanceItemSubmitEvent" }, initDeclareGoodsContent: function () { this.$el.html(i.clearanceItemForm({ data: {}, fromAcs: this.options.fromAcsOrder })), this.fillViewData(), this.$(".goods-input-required").show() }, showViewModal: function (e) { this.$el.html(i.modal({ title: _l("新增申报物品"), id: "addDeclareGoods", body: i.clearanceItemForm({ data: e || {}, fromAcs: this.options.fromAcsOrder }), fade: !0, width: !1 })), this.$("#addDeclareGoods").modal("show"), this.fillViewData(e) }, fillViewData: function (e) { this.$(".currency").html(i.dropdownSelectTemplate({ itemList: this.getCurrencyList() })), this.options.fromAcsOrder && this.$(".currency").val("HKD"), this.$(".unit").html(i.dropdownSelectTemplate({ itemList: this.getUnitList() })), e ? (this.selectedID = e.id, this.itemTypeChangeEvent(), this.$(".currency").val(e.currency), this.$(".goodsQuantity").val(e.quantity), this.checkUnit(e.uom) ? this.$(".unit").val(e.uom) : (this.$(".unit").val(this.other), this.unitChangeEvent(), this.$(".otherUnit").val(e.uom))) : this.selectedID = null }, getCurrencyList: function () { return "SC" == this.lang ? [{ value: "CNY", txt: "人民币" }, { value: "USD", txt: "美元" }, { value: "MOP", txt: "澳门元" }, { value: "SGD", txt: "新元" }, { value: "JPY", txt: "日元" }, { value: "KRW", txt: "韩元" }, { value: "MYR", txt: "马币" }, { value: "NTD", txt: "新台币" }, { value: "HKD", txt: "港币" }] : [{ value: "CNY", txt: "CNY" }, { value: "USD", txt: "USD" }, { value: "MOP", txt: "MOP" }, { value: "SGD", txt: "SGD" }, { value: "JPY", txt: "JPY" }, { value: "KRW", txt: "KRW" }, { value: "MYR", txt: "MYR" }, { value: "NTD", txt: "NTD" }, { value: "HKD", txt: "HKD" }] }, getUnitList: function () { return "SC" == this.lang ? [{ value: "个", txt: "个" }, { value: "份", txt: "份" }, { value: "件", txt: "件" }, { value: "条", txt: "条" }, { value: "只", txt: "只" }, { value: "双", txt: "双" }, { value: "台", txt: "台" }, { value: "张", txt: "张" }, { value: "盒", txt: "盒" }, { value: "OTHER", txt: "其他" }] : [{ value: "PCS", txt: "PCS" }, { value: "BOX", txt: "BOX" }, { value: "ROLL", txt: "ROLL" }, { value: "METER", txt: "METER" }, { value: "PAIR", txt: "PAIR" }, { value: "KG", txt: "KG" }, { value: "SETB", txt: "SETB" }, { value: "UNCH", txt: "UNCH" }, { value: "CAN", txt: "CAN" }, { value: "OTHER", txt: "OTHER" }] }, checkUnit: function (t) { var e = "SC" == this.lang ? ["个", "份", "件", "条", "只", "双", "台", "张", "盒"] : ["PCS", "BOX", "ROLL", "METER", "PAIR", "KG", "SETB", "UNCH", "CAN"], i = !1; return _.forEach(e, function (e) { t == e && (i = !0) }), i }, checkAllUnit: function (t) { var e = "SC" == this.lang ? ["个", "份", "件", "条", "只", "双", "台", "张", "盒", "千克", "支", "座", "辆", "艘", "架", "套", "头", "枝", "根", "把", "块", "卷", "副", "片", "组", "幅", "对", "棵", "株", "井", "米", "盘", "平方米", "立方米", "筒", "克", "盆", "万个", "具", "百副", "百支", "百把", "百个", "百片", "刀", "疋", "公担", "扇", "百枝", "千只", "千块", "千盒", "千枝", "千个", "亿支", "亿个", "万套", "千张", "万张", "千伏安", "千瓦", "千瓦时", "千升", "英尺", "吨", "长吨", "短吨", "司马担", "司马斤", "斤", "磅", "担", "英担", "短担", "两", "市担", "盎司", "克拉", "市尺", "码", "英寸", "寸", "升", "毫升", "英加仑", "美加仑", "立方英尺", "立方尺", "平方码", "平方英尺", "平方尺", "英制马力", "公制马力", "令", "箱", "批", "罐", "桶", "扎", "包", "箩", "打", "筐", "罗", "匹", "册", "本", "发", "枚", "捆", "袋", "粒", "合", "瓶", "千支", "万双", "万粒", "千粒", "千米", "千英尺", "百万贝可", "部", "封", "KG", "公斤"] : ["PCS", "BOX", "ROLL", "METER", "PAIR", "KG", "SETB", "UNCH", "CAN", "BOTTLE", "BAG", "YARD"], i = !1; return _.forEach(e, function (e) { t == e && (i = !0) }), i }, formCheck: function () { return "file" == (this.options.fromAcsOrder ? "goods" : this.$(".itemType:checked").val()) || (this.goodsNameCheck(), this.otherUnitBlurCheck(), this.$(".clearance-item-form").parsley().validate() && this.isGoodsNameLegal && this.isUnitLegal) }, itemTypeChangeEvent: function () { var e = this.options.fromAcsOrder ? "goods" : this.$(".itemType:checked").val(); "file" == e ? this.$(".goods-input-required").hide() : "goods" == e && this.$(".goods-input-required").show() }, goodsNameKeyupEvent: function () { var e = this.$(".goodsName").val(), a = this.lang, t = { goodsName: e }; sfAjax.goodsNameAssociate({ data: t, success: function (e) { var t = e.result, n = []; _.each(t, function (e) { var t = "SC" == a ? e.matchUnit : e.englishUnit, i = t && t.split(",")[0]; n.push({ value: e.matchName, txt: e.matchName, unit: i, enTxt: e.englishName, selectable: "Y" != e.isBlackList, lang: a }) }), n.length && (this.$(".goodsName-hint").html(i.promptDialogTemplate({ itemList: n })), this.$(".goodsName-hint").show()) }, error: function () { this.$(".goodsName-hint").hide() } }) }, goodsNameCheck: function () { var i = this, e = { goodsName: this.$(".goodsName").val() }; sfAjax.goodsNameCheck({ data: e, success: function (e) { var t = e.code; 700 == t ? (i.$(".goodsName-fuzzy").show(), i.$(".goodsName-contraband").hide(), i.isGoodsNameLegal = !1) : 701 == t ? (i.$(".goodsName-contraband").show(), i.$(".goodsName-fuzzy").hide(), i.isGoodsNameLegal = !1) : 0 == t && (i.$(".goodsName-fuzzy").hide(), i.$(".goodsName-contraband").hide(), i.isGoodsNameLegal = !0) }, error: function () { this.$(".goodsName-fuzzy").hide(), this.$(".goodsName-contraband").hide() } }) }, goodsNameHintClickEvent: function (e) { if ($(e.target).data("selectable")) { var t = $(e.target).data("sc"), i = $(e.target).data("en"), n = "SC" == this.lang ? t : i, a = $(e.target).data("unit"); n && (this.$(".goodsName").val(n), this.goodsName = n, this.$(".goodsName").data("sc", t), this.$(".goodsName").data("en", i), this.checkUnit(a) ? (this.$(".unit").val(a), this.unitChangeEvent()) : (this.$(".unit").val(this.other), this.unitChangeEvent(), this.$(".otherUnit").val(a)), this.$(".goodsName-hint").hide()) } }, unitChangeEvent: function () { this.$(".unit").find("option:selected").val() == this.other ? (this.$(".otherUnit").val(""), this.$(".otherUnit").show()) : this.$(".otherUnit").hide() }, goodsNameBlurEvent: function () { var e = this.$(".goodsName").val(); this.goodsName != e && this.$(".goodsName").data("en", "") }, clearanceItemFormClickEvent: function (e) { this.$(".goodsName-hint").find(e.target).length ? (this.goodsNameHintClickEvent(e), this.goodsNameCheck()) : "goodsName" != this.$(e.target).attr("name") && (this.$(".clearance-item-form").find(".goodsName-hint").hide(), this.goodsNameCheck()), "unit" != this.$(e.target).attr("name") && "otherUnit" != this.$(e.target).attr("name") && this.otherUnitBlurCheck() }, otherUnitBlurCheck: function () { var e = this.$(".unit").val(), t = this.$(".otherUnit").val(), i = e == this.other ? t : e; this.checkAllUnit(i) ? (this.$(".unit-error").hide(), this.isUnitLegal = !0) : (this.$(".unit-error").show(), this.isUnitLegal = !1) }, getData: function () { var e, t, i = this.options.fromAcsOrder ? "goods" : this.$(".itemType:checked").val(); "EN" == this.lang ? (e = this.$(".goodsName").data("sc") || this.$(".goodsName").val(), t = this.$(".goodsName").val() || this.$(".goodsName").data("en")) : (e = this.$(".goodsName").val() || this.$(".goodsName").data("sc"), t = this.$(".goodsName").data("en") || this.$(".goodsName").val()); var n = this.$(".price").val(), a = this.$(".currency").find("option:selected").val(), s = this.$(".currency").find("option:selected").html(), r = this.$(".goodsQuantity").val(), o = this.$(".unit").val(), l = this.$(".otherUnit").val(), c = o == this.other ? l : o; return { id: this.selectedID, name: e, uom: c, quantity: r, price: n, englishName: t || "", currency: a, currencyCn: s, declareType: i } }, clearanceItemSubmitEvent: function (e) { e.preventDefault(), this.formCheck() ? (this.options.callbackFun(this.getData()), this.$("#addDeclareGoods").modal("hide")) : n.msg(_l("添加失败")) } }) }), define("views/pages/order/acsOrder/billConfirm", ["templates", "sflayer", "const"], function (e, i, n) { return Backbone.View.extend({ events: { "click .go-back": "orderRefill", "click .pay-type a": "selectPayType", "click .submit-order": "submitOrder" }, initView: function () { this.$el.html(e.acsBillConfirm({ sender: this.model.get("orderData").appointmentList[0].originateInfo, receiver: this.model.get("orderData").appointmentList[0].destinationInfo, isReceiverHK: this.model.get("isReceiverHK"), isReceiverHKorMACAO: this.model.get("isReceiverHKorMACAO"), receiverCountry: this.model.get("isReceiverGlobal") ? this.model.get("orderData").appointmentList[0].destinationInfo.addrInfo.country : "", cargoList: this.model.get("orderData").appointmentList[0].cargoList[0], freightFee: this.model.get("orderData").appointmentList[0].freightFee.amt, acsBillNo: this.model.get("acsBillNo") })).show(), window.scrollTo(0, 0), this.payType = 1 }, orderRefill: function () { this.$el.trigger("orderRefill") }, selectPayType: function (e) { this.$(".pay-type a").removeClass("aicon-checked").addClass("aicon-check-Unseleted-x"), this.$(e.currentTarget).addClass("aicon-checked").removeClass("aicon-check-Unseleted-x"), this.payType = this.$(e.currentTarget).data("type") }, preprocessingData: function () { var e = this.model.get("orderData"); this.model.get("isReceiverHK") || (e.appointmentList[0].cargoList[0] = _.omit(e.appointmentList[0].cargoList[0], "id", "currency", "currencyCn", "declareType"), e.appointmentList[0].customList[0].paymethod = this.payType), this.model.get("isReceiverHKorMACAO") && (e.appointmentList[0].freightFee.paymethod = this.payType), this.model.set("orderData", e) }, submitOrder: function () { this.preprocessingData(); var t = this; sfAjax.subACSOrder({ data: this.model.get("orderData"), success: function (e) { e && 0 == e.code ? (1 == t.payType ? e.result.payUrl ? (window.localStorage.setItem(n.ACS_PAY_URL, e.result.payUrl), window.location.href = e.result.payUrl) : i.msg(_l("下单失败")) : 2 == t.payType && Backbone.history.navigate("billState?backType=1", { trigger: !0, replace: !1 }), t.model.set("acsBillNo", null)) : i.msg(_l("下单失败")) }, error: function () { i.msg(_l("下单失败")) } }) } }) }), define("views/pages/order/acsOrder/billInfoFill", ["templates", "components/detailedLocationPicker/pricePicker", "../innerViews/addDeclareGoodsView", "./billConfirm", "sflayer", "helper", "const", "verify"], function (i, e, a, t, s, n, r, o) { return Backbone.View.extend({ events: { "click .confirm-order": "confirmOrder", "click .receiver-item-menu a": "selectReceiverItem", "regionModelUpdate .sender-location .detail-location-input": "senderRegionModelUpdate", "locationChanged .receiver-location .detail-location-input": "receiverRegionModelUpdate", "change #recommendCountrys": "changeCountry", "blur .orther-contry input": "validCountry", "orderRefill .confirmWrapper": "refillOrder" }, initialize: function () { this.model.get("acsBillNo") || Backbone.history.navigate("billInput", { trigger: !0, replace: !1 }), this.$el.html(i.acsBillInfoFill({ acsBillNo: this.model.get("acsBillNo"), emailReg: this.regToString(o.reg.email), telReg: this.regToString(o.reg.tel_cn_hmt), postcodeReg: this.regToString(o.reg.postcode) })), this.originlocaltion = this.$(".sender-location .detail-location-input"), this.destlocaltion = this.$(".receiver-location .detail-location-input"), this.sender_location = new e({ el: this.originlocaltion }), this.receiver_location = new e({ el: this.destlocaltion }), this.isRightOtherCountry = !0, this.model.set("hkRecommendCountries", null), this.model.set("hkInternationalPrices", null) }, regToString: function (e) { return e.toString().slice(1, -1) }, LoadHKRecommendCountry: function () { if (!this.model.has("hkRecommendCountries")) { var t = this; sfAjax.getJson({ url: n.getResourceURL("data/hk-recommend-country.json"), success: function (e) { e && 0 < e.length ? (t.$("#recommendCountrys").append(i.dropdownRecommendCountrys({ dropdownItems: e })), t.model.set("hkRecommendCountries", e)) : s.msg("json文件数据不正确！") }, error: function () { s.msg("json文件不存在！") } }) } }, changeCountry: function (e) { var t = this.$(e.currentTarget); "ORTHERS" == t.val() ? (this.$(".orther-contry input").val("").trigger("blur"), this.$(".orther-contry").show()) : (this.isRightOtherCountry = !0, this.$(".orther-contry").hide(), this.$(".countryOfOrigin .error").hide(), this.declareCountryName = t.find("option:selected").text()) }, validCountry: function (e) { this.isRightOtherCountry = !1, this.$(".countryOfOrigin .error").hide(); var t = $.trim(this.$(e.currentTarget).val()); if ("" == t) this.$(".country-empty").show(); else { var i = this; sfAjax.validACSCountry({ data: { country: t }, success: function (e) { 0 == e.code && 1 == e.result ? (i.isRightOtherCountry = !0, i.declareCountryName = t) : i.$(".country-err").show() }, error: function () { i.$(".network-err").show() } }) } }, selectReceiverItem: function (e) { this.$(".receiver-item-menu a").removeClass("aicon-checked").addClass("aicon-check-Unseleted-x"), this.$(e.currentTarget).addClass("aicon-checked").removeClass("aicon-check-Unseleted-x"), this.$(e.currentTarget).hasClass("others-item") ? this.$(".other-item-input").css("display", "inline-block") : this.$(".other-item-input").hide() }, getAddressInfo: function (e) { return { locationCode: e.locationCode, country: e.countryName || "中国", province: e.provinceName, provinceCode: e.provinceCode, city: e.cityName, county: e.countyName, countyCode: e.countyCode } }, regionModelUpdate: function (e, t) { var i = this.$(e.currentTarget), n = 3 === t.regionType, a = 2 === t.regionType; i.data("max-level", n ? 2 : a ? 5 : 4) }, senderRegionModelUpdate: function (e, t) { this.regionModelUpdate(e, t), this.inputChanged() }, receiverRegionModelUpdate: function (e, t) { this.regionModelUpdate(e, t); var i = this.receiver_location.getLocationData(), n = i.locationCode; 3 == i.regionType || n == r.RATE_OF_TW ? (this.$("#receiver-postcode").val(""), this.$(".receiver-postcode").show()) : this.$(".receiver-postcode").hide(), n == r.RATE_OF_HK ? (this.model.set("isReceiverHK", !0), this.$(".receiver-item").show(), this.$(".declare").hide()) : (this.model.set("isReceiverHK", !1), this.addGoodView || (this.addGoodView = new a({ el: this.$(".declare-content"), fromAcsOrder: !0 })), this.addGoodView.initDeclareGoodsContent(), this.$(".receiver-item").hide(), this.$(".declare").show(), this.LoadHKRecommendCountry(), this.$("#recommendCountrys").trigger("change")), n == r.RATE_OF_HK || n == r.RATE_OF_MACAO ? this.model.set("isReceiverHKorMACAO", !0) : this.model.set("isReceiverHKorMACAO", !1), 3 == i.regionType ? this.model.set("isReceiverGlobal", !0) : this.model.set("isReceiverGlobal", !1), this.freightFee = "", this.getInternationalFreightFee(i) }, getCargoList: function () { if (this.model.get("isReceiverHK")) return [{ name: this.receiverItem, uom: "", desc: "", price: "0" }]; var e = this.addGoodView.getData(); return e.origin = this.declareCountryName, [e] }, getCustomList: function () { if (this.model.get("isReceiverHK")) return []; var e = this.addGoodView.getData(); return [{ currency: e.currency, weight: "1", declareType: "0", paymethod: "1", settlementCode: "", declareValue: e.price }] }, getInternationalFreightFee: function (t) { if (this.model.has("hkInternationalPrices")) this.showFreightFee(t); else { var i = this; sfAjax.getJson({ url: n.getResourceURL("data/hk-international-price.json"), success: function (e) { e && 0 < e.length ? (i.model.set("hkInternationalPrices", e), i.showFreightFee(t)) : s.msg("json文件数据不正确！") }, error: function () { s.msg("json文件不存在！") } }) } }, showFreightFee: function (e) { var t; t = 3 == e.regionType ? e.countryRateCode : e.locationCode == r.RATE_OF_HK ? "HK" : e.locationCode == r.RATE_OF_MACAO ? "MO" : e.locationCode == r.RATE_OF_TW ? "TW" : "CN"; var i = _.findWhere(this.model.get("hkInternationalPrices"), { code: t }); if (i) { var n = i.price; this.$(".freightFee").text(n + "HKD"), this.$(".freightFeeWrapper").show(), this.freightFee = n } else this.$(".freightFeeWrapper").hide() }, formValidate: function () { var e = this.$(".sender-form").parsley().validate(), t = this.$(".receiver-form").parsley().validate(), i = !0, n = !0; return this.model.get("isReceiverHK") ? this.$(".others-item").hasClass("aicon-checked") ? "" == $.trim(this.$(".other-item-input").val()) ? (s.msg(_l("托寄物不能为空")), this.$(".other-item-input").focus(), i = !1) : this.receiverItem = $.trim(this.$(".other-item-input").val()) : this.receiverItem = this.$(".receiver-item-menu .aicon-checked").html() : n = this.addGoodView.formCheck(), "" == this.freightFee ? (s.msg(_l("暂无所选择国家的运费信息")), !1) : e && t && i && n && this.isRightOtherCountry }, getSenderAddressInfo: function () { return _.extend({ address: this.$("#sender-address-detail").val() }, this.getAddressInfo(this.sender_location.getLocationData())) }, getReceiverAddressInfo: function () { return _.extend({ address: this.$("#receiver-address-detail").val() }, this.getAddressInfo(this.receiver_location.getLocationData())) }, confirmOrder: function () { if (this.formValidate()) { var e = { sysCode: "PC.OWF", waybillNo: this.model.get("acsBillNo"), memberId: this.$("#sender-mobile").val(), appointmentTime: "", appointmentInfo: { contact: this.$("#sender-name").val(), phone: "", mobile: this.$("#sender-mobile").val(), email: this.$("#sender-mail").val(), addressInfo: this.getSenderAddressInfo() }, appointmentList: [{ originateInfo: { contact: this.$("#sender-name").val(), phone: "", mobile: this.$("#sender-mobile").val(), email: this.$("#sender-mail").val(), addrInfo: this.getSenderAddressInfo() }, destinationInfo: { contact: this.$("#receiver-name").val(), mobile: this.$("#receiver-mobile").val(), email: this.$("#receiver-mail").val(), addrInfo: this.getReceiverAddressInfo() }, freightFee: { amt: this.freightFee, paymethod: "1" }, cargoList: this.getCargoList(), customList: this.getCustomList(), metaWeight: "1", metaPrice: this.freightFee }] }; this.model.set("orderData", e), this.$(".billInfoFill").hide(), this.billConfirmView || (this.billConfirmView = new t({ model: this.model, el: this.$(".confirmWrapper") })), this.billConfirmView.initView() } }, refillOrder: function () { this.$(".billInfoFill").show(), this.$(".confirmWrapper").hide() }, inputChanged: function () { var e = this.originlocaltion.find("input").data("code"), t = this.originlocaltion.find("input").data("country-code"); if (this.destlocaltion.find("input").attr("disabled", !e), this.destlocaltion.find("input").data("origin-country-code", t), e) { var i = _.sprintf(n.urls.subregionDest, { parentCode: "%s", originCode: e, level: "%s" }); this.destlocaltion.data("custom-url", i) } } }) }), define("views/pages/order/acsOrder/billState", ["templates", "helper", "const"], function (e, t, i) { return Backbone.View.extend({ initialize: function () { this.type = this.QueryString("backType"), (!this.type || 1 != this.type && 2 != this.type && 3 != this.type) && Backbone.history.navigate("billInput", { trigger: !0, replace: !1 }), this.$el.html(e.acsBillState({ type: this.type, imgUrl: this.getImgUrl() })) }, events: { "click .pay-again": "payAgain" }, QueryString: function (e) { var t = window.location.href, i = new RegExp(e + "=([^&?]*)", "ig"); return t.match(i) ? t.match(i)[0].substr(e.length + 1) : null }, getImgUrl: function () { return "1" == this.type ? t.getResourceURL("images/order/box-happy.png") : t.getResourceURL("images/order/box-sad.png") }, payAgain: function () { window.location.href = window.localStorage.getItem(i.ACS_PAY_URL) } }) }), define("views/pages/order/acsOrder/masterController", ["models/acsOrder", "./billInput", "./billInfoFill", "./billState"], function (e, t, i, n) { return Backbone.View.extend({ el: $(".acs-order-page").parent(), initialize: function () { this.hmtOrder = new e, this.initInnerHtml = this.$el.html() }, initOrderStatus: function (e) { this.billInputView = null, this.billInfoFillView = null, this.billStateView = null, this.$el.empty().html(this.initInnerHtml), (!e || "billInput" != e && "billInfoFill" != e && -1 == e.indexOf("billState")) && (e = "billInput"), "billInput" == e ? this.billInputView = new t({ model: this.hmtOrder, el: this.$(".acs-order-page") }) : "billInfoFill" == e ? this.billInfoFillView = new i({ model: this.hmtOrder, el: this.$(".acs-order-page") }) : -1 < e.indexOf("billState") && (this.billStateView = new n({ model: this.hmtOrder, el: this.$(".acs-order-page") })) } }) }), define("routers/acsOrderDetailRouter", ["views/pages/order/acsOrder/masterController"], function (e) { return Backbone.Router.extend({ initialize: function () { this.acsOrderMasterController = new e }, routes: { ":targetTab": "initOrderStatus", ":targetTab/": "initOrderStatus", "*path": "initOrderStatus" }, initOrderStatus: function (e) { this.acsOrderMasterController.initOrderStatus(e) } }) }), define("components/addressForm/config", [], function () { return { support: "ML_HK_MC_TW_INTL", fillOption: "sender", warmReminder: "", viewOption: "heavyCargo", allowHkMaCao: !0, nearBy: {}, location: { placeholder: "請選擇所在區域，例如：臺灣-臺北市-大同區" }, addressBook: {}, smartFill: { pop: !0, placeholder: "例：順小哥，0910000000，臺北市大同區承德路二段177號1樓" }, addressRedress: !1, autoMatch: { memType: 0 }, outRange: { tip: "亲，您的收件地址不在我司派送范围内，可选择自取服务" }, validate: function (e) { return { rules: { contactName: { required: !0, maxlength: 20 }, companyName: { maxlength: 20 }, contactTel: { required: function () { return "" == e.$('[name="contactPhone"]').val() }, regex: e.formatTel }, contactPhone: { required: function () { return "" == e.$('[name="contactTel"]').val() }, regex: "isMobile" }, location: { required: !0 }, address: { required: !0 }, customerId: { required: !1, regex: function () { return "" == e.$('[name="companyName"]').val() ? "isTwIdCardNo" : "isTwComLicenseNo" } } }, messages: { contactTel: { required: _l("手机号码、固话号码请至少填写一项"), regex: _l("您输入的手机号码格式不正确，请重新输入。") }, contactPhone: { required: _l("手机号码、固话号码请至少填写一项"), regex: _l("您输入的固话号码格式不正确，请重新输入。") }, customerId: { regex: function () { return "" == e.$('[name="companyName"]').val() ? _l("请填写正确的台湾个人身份证号") : _l("请填写正确的台湾公司营业执照号") } } } } } } }), define("components/addressForm/function/location", ["components/detailedLocationPicker/picker", "bus/address/index"], function (i, e) { return { events: { "change .detail-location-input input": "onLocationChanged", "locationChanged .detail-location-input": "regionModelUpdate" }, mounted: function () { var e = this.$(".detail-location-input"), t = this.config.support; this.location = new i({ el: this.$(".detail-location-input") }), -1 === t.indexOf("ML") && e.data("hide-main-land", "true"), -1 === t.indexOf("HK") && e.data("hide-hk", "true"), -1 === t.indexOf("MC") && e.data("hide-macao", "true"), -1 === t.indexOf("TW") && e.data("hide-tw", "true"), e.data("max-A000810000", 5).data("max-852", 5).data("max-886", 5) }, methods: { regionModelUpdate: function (e, t) { this.addLocation = t }, onLocationChanged: function (e) { var t = this.$(e.currentTarget).data("rate-code"), i = this.$(e.currentTarget).data("code"), n = $(".sender-wrapper").find("input[name=address]").val(); this.queryAddressRange(), this.options.locationChange(t, i, n, 1) } } } }), define("components/addressBook/_addressBook", ["baseView", "templates", "helper", "./addressBookAdd", "./addressBookModify", "views/others/bootstrapPagination", "sf-validate", "sflayer"], function (e, i, t, n, a, s, r) { return e.extend({ layerOpts: { title: _l("从地址簿选择"), area: "680px", skin: "line" }, template: i.addressBook, init: function (e) { this.addressBooks = e.addressBooks }, events: { "submit .search-form": "submitForm", "click .address_success tr": "selectAdd", "dblclick .address_success tr": "preDblclickToConform", "click .try-again": "fetchAddressBookAgain", "click .select-confirm": "confirmAddress", "click .add": "addOneAddress", "mouseenter .modify": "showModifyTip", "mouseleave .modify": "hideModifyTip", "click .modify": "modifyAddress", "mouseenter .set-default": "showSetDefaultTip", "mouseleave .set-default": "hideSetDefaultTip", "click .set-default": "setDefault", "mouseenter .delete": "showDeleteTip", "mouseleave .delete": "hideDeleteTip", "click .delete": "deleteAddress", "pageClicked .bootstrap-pagination": "jumpPage", "click .selectAll": "selectAllList" }, render: function () { this.$el.html(this.template({ loadingImg: t.getResourceURL("images/order/loading.gif"), hasSelectAll: this.hasSelectAll })), this.activeEV = "init", this.page = this.options.page, this.totalPage = this.options.totalPage, this.addFormValidate(), this.renderAddBooKList(), this.dealTips() }, dealTips: function () { var e = this; $(window).scroll(function () { layer.close(e.modifyTip), layer.close(e.setDefaultTip), layer.close(e.deleteTip) }), this.$(".height-scroll").scroll(function () { layer.close(e.modifyTip), layer.close(e.setDefaultTip), layer.close(e.deleteTip) }), $(window).resize(function () { e.$(".height-scroll").css("height", $(this).height() - 300), $(this).scroll() }), $(window).resize() }, renderAddBooKList: function () { var e = this.addressBooks; if (this.$(".add").toggleClass("disabled", !1), this.$(".address_success").remove(), this.$("dl").hide(), e && 0 < e.length) { var t = i.addressSuccessBody({ addressBookList: e }); this.$(".table-wrapper").append(t), new s({ el: this.$(".bootstrap-pagination"), totalPages: this.totalPage, currentPage: this.page, numberOfPages: 3 }), this.$(".address_success p").each(function () { $(this).attr("title", $(this).text()) }), this.$(".hide-in-loading").show() } else 1 < this.page ? (this.page -= 1, this.getAddBooKList()) : "init" == this.activeEV ? this.$(".address_fetch_null").show() : this.$(".address_search_null").show(); this.emptySelectAll() }, addFormValidate: function () { r(this.$(".search-form"), { rules: { searchParm: { maxlength: 20 } } }) }, emptySelectAll: function () { }, getAddBooKList: function (e) { this.page = e || this.page; var t = this; sfAjax.fetchAddressBookList({ data: { condition: encodeURI(this.searchParm || ""), pageNo: this.page, rowCount: "8" }, success: function (e) { e && 0 == e.code ? (t.addressBooks = e.result.content, t.page = e.result.pageNo, t.totalPage = e.result.totalPage, t.renderAddBooKList()) : t.showNetworkError() }, error: function () { t.showNetworkError() }, login: { succCallback: this.getAddBooKList.bind(this), cancelCallback: this.showNetworkError.bind(this) } }) }, submitForm: function (e) { if (e.preventDefault(), this.activeEV = "search", this.$(e.currentTarget).validate().form()) { this.showLoading(); var t = $.trim(this.$(".search-input").val()); this.searchParm = t, this.getAddBooKList(1) } }, jumpPage: function (e, t) { this.showLoading(), this.getAddBooKList(t) }, showNetworkError: function () { this.$(".add").toggleClass("disabled", !0), this.$("dl").hide(), this.$(".address_networkErr").show() }, showLoading: function () { this.$(".hide-in-loading").hide(), this.$("dl").hide(), this.$(".address_loading").show() }, selectAdd: function (e) { this.$(e.target).hasClass("address-check") ? (this.$(".address-check").removeClass("aicon-check").addClass("aicon-uncheck"), this.$(e.target).removeClass("aicon-uncheck").addClass("aicon-check"), e.stopPropagation()) : this.$(e.currentTarget).find(".address-check").trigger("click") }, confirmAddress: function () { 1 == this.$(".address-check.aicon-check").length ? this.dblclickToConform() : layer.msg(_l("请选择其中的一条数据")) }, preDblclickToConform: function (e) { 0 < this.$(e.target).closest(".modify,.set-default,.delete").length || this.dblclickToConform() }, dblclickToConform: function () { var t = this, e = this.$(".address-check.aicon-check").closest("tr").data("addid"); sfAjax.getAddressById({ data: { id: e }, success: function (e) { e && 0 == e.code && e.result && (e.result[0].countryCode = e.result[0].countryCode || "A000086000", t.options.callback(e.result[0]) && t.close()) }, error: function () { layer.msg(_l("网络错误")) }, login: { succCallback: this.dblclickToConform.bind(this), cancelCallback: null } }) }, locationNotSupport: function () { layer.msg(_l("暂不支持该地区下单")) }, fetchAddressBookAgain: function () { this.showLoading(), this.getAddBooKList() }, addOneAddress: function () { new n({ callback: this.getAddBooKList.bind(this) }) }, showModifyTip: function (e) { this.modifyTip = layer.tips(_l("修改"), e.currentTarget, { tips: [1, "#333"], time: !1 }) }, hideModifyTip: function () { layer.close(this.modifyTip) }, modifyAddress: function (e) { e && e.stopPropagation(), this.modifyAddressId = e ? this.$(e.currentTarget).closest("tr").data("addid") : this.modifyAddressId; var t = this; this.isLocked(e) || sfAjax.getAddressById({ data: { id: this.modifyAddressId }, success: function (e) { e && 0 == e.code && e.result && new a({ addressBook: e.result[0], callback: t.getAddBooKList.bind(t) }) }, complete: function () { t.unlock(e) }, error: function () { layer.msg(_l("网络错误")) }, login: { succCallback: this.modifyAddress.bind(this), cancelCallback: null } }) }, showSetDefaultTip: function (e) { var t = this.$(e.currentTarget).hasClass("active") ? _l("已为默认地址") : _l("设为默认地址"); this.setDefaultTip = layer.tips(t, e.currentTarget, { tips: [1, "#333"], time: !1 }) }, hideSetDefaultTip: function () { layer.close(this.setDefaultTip) }, setDefault: function (e) { if (e && e.stopPropagation(), this.hideSetDefaultTip(), this.setDefaultTarget = e ? this.$(e.currentTarget) : this.setDefaultTarget, !this.setDefaultTarget.hasClass("active")) { var t = this.setDefaultTarget.closest("tr").data("addid"); if (!this.setDefaultTarget.hasClass("disabled")) { this.setDefaultTarget.toggleClass("disabled", !0); var i = this; sfAjax.setDefaultAddress({ data: { addressId: t, isDefault: 1 }, success: function (e) { e && 0 == e.code && e.result ? i.setDefaultAddressSuccess(i.setDefaultTarget) : i.setDefaultAddressFail() }, error: function () { i.setDefaultAddressFail() }, complete: function () { i.setDefaultTarget.toggleClass("disabled", !1) }, login: { succCallback: this.setDefault.bind(this), cancelCallback: this.setDefaultAddressFail.bind(this) } }) } } }, setDefaultAddressSuccess: function (t) { var e; layer.msg(_l("已设为默认寄件地址")), e = 0 < this.$(".default-tip").length ? this.$(".default-tip") : $('<span class="default-tip">' + _l("默认") + "</span>"), t.closest("tr").find(".contact-name").append(e), this.$(".set-default.active").removeClass("active aicon-fill-star").addClass("aicon-stroke-star"), t.addClass("active aicon-fill-star").removeClass("aicon-stroke-star"), _.each(this.addressBooks, function (e) { "1" == e.isDefault && (e.isDefault = "0"), e.addressId == t.closest("tr").data("addid") && (e.isDefault = "1") }) }, setDefaultAddressFail: function () { layer.msg(_l("设置默认寄件地址失败")) }, showDeleteTip: function (e) { this.deleteTip = layer.tips(_l("删除"), e.currentTarget, { tips: [1, "#333"], time: !1 }) }, hideDeleteTip: function () { layer.close(this.deleteTip) }, deleteAddress: function (e) { e.stopPropagation(), this.deleteAddressId = this.$(e.target).closest("tr").data("addid"); var t = _.findWhere(this.addressBooks, { addressId: this.deleteAddressId }), i = _l("您真的要删除") + (t.contactTel || t.contactPhone) + "(" + t.contactName + ")" + _l("这个地址吗") + "？", n = this, a = layer.confirm(i, { noStop: !0, btn: [_l("确定"), _l("取消")] }, function () { layer.close(a), n.confirmDelete() }, function () { layer.close(a) }) }, confirmDelete: function () { var e = this; sfAjax.deleteOneAddress({ data: { id: this.deleteAddressId }, success: function () { layer.msg(_l("删除成功")), e.getAddBooKList() }, error: function () { layer.msg(_l("删除失败")) }, login: { succCallback: this.confirmDelete.bind(this), cancelCallback: function () { layer.msg(_l("删除失败")) } } }) } }) }), define("components/addressForm/function/addressBook", ["components/addressBook/_addressBook"], function (i) { return { events: { "click .address-book": "showAddressBookContent" }, mounted: function () { }, methods: { showAddressBookContent: function (e) { $.cookie("loginUser") ? this.showAddressBook(e) : Event.trigger(Event.Needlogin, { succCallback: this.showAddressBook.bind(this), cancelCallback: null }) }, showAddressBook: function (e) { var t = this; this.isLocked(e) || sfAjax.fetchAddressBookList({ data: { pageNo: 1, rowCount: "8", condition: "" }, success: function (e) { e && 0 === e.code ? new i(_.extend({ addressBooks: e.result.content, totalPage: e.result.totalPage, page: e.result.pageNo, callback: t.fillBackInfo.bind(t) }, t.config.addressBook)) : layer.msg(_l("网络错误")) }, error: function () { layer.msg(_l("网络错误")) }, complete: function () { t.unlock(e) }, login: { succCallback: this.showAddressBook.bind(this), cancelCallback: null } }) } } } }), define("components/detailedLocationPicker/_amapPicker", ["backbone", "templates", "sflayer", "helper", "jquery-ui"], function (e, t, a, n) { return e.View.extend({ initialize: function () { var n = this; this.$("input").autocomplete({ minLength: 0, source: function (e, t) { var i = n.options.location.getInputValue(); 2 < i.split("-").length ? (n.city = i.split("-")[1], n.district = i.split("-")[2]) : (n.city = i.split("-")[0], n.district = i.split("-")[1]), sfAjax.getDetailAddList({ data: { q: encodeURIComponent(e.term), city: encodeURIComponent(n.city), district: encodeURIComponent(n.district), ak: _webConfig.gisKey }, success: function (e) { 0 == e.status && 0 < e.result.POISum && t(e.result.POISet) }, error: function () { a.msg(_l("获取失败")) } }) }, select: function (e, t) { return e.stopPropagation(), n.addressSelected(t.item), !1 } }).autocomplete("instance")._renderItem = function (e, t) { return $("<li>").append(t.name + " <span>" + t.detail_addr + "</span>").appendTo(e) }, this.$("input").unbind("input") }, addressSelected: function (e) { this.$("input").val(e.name), e.regcode && this.checkAddressSame(e) }, checkAddressSame: function (e) { var t = this; if (e.adname[1] && e.adname[1] != this.city) var i = _p(_l("是否切换城市?详细地址与选择的省市区不一致，是否需要切换到%(city)s"), { city: e.adname[1] }), n = a.confirm(i, { title: _l("温馨提示!"), btn: [_l("切换城市"), _l("重新输入")] }, function () { t.queryAddrDistIdByName(e), a.close(n) }, function () { t.$("input").val(""), a.close(n) }); else if (e.adname[2] && e.adname[2] != t.district) i = _p(_l("您选择的地址可能属于%(city)s%(district)s，是否切换？"), { city: e.adname[1], district: e.adname[2] }), n = a.confirm(i, { title: _l("温馨提示!"), btn: [_l("是"), _l("否")] }, function () { t.queryAddrDistIdByName(e), a.close(n) }, function () { a.close(n) }) }, queryAddrDistIdByName: function (e) { var t = ""; t = n.isDirectCity(e.regcode) ? e.adname[0].substring(0, 2) : e.adname[0]; var i = this; sfAjax.getAddrDistIdByName({ data: { provinceName: t, cityName: e.adname[1], districtName: e.adname[2] }, success: function (e) { e ? i.options.location.setLocation(e) : a.msg(_l("获取失败")) }, error: function () { a.msg(_l("获取失败")) } }) } }) }), define("components/addressForm/function/addressRedress", ["components/detailedLocationPicker/_amapPicker"], function (e) { return { events: {}, mounted: function () { new e({ el: this.$("input[name='address']").parent(), location: this.location, allowHkMaCao: this.config.allowHkMaCao }) } } }), define("components/addressForm/function/autoMatch", ["templates", "helper", "sflayer", "bus/address/index"], function (i, e, t, n) { return { mounted: function () { var s = this; this.$(".autoAddPicker").each(function () { $(this).find("input").autocomplete({ minLength: 0, delay: 300, select: function (e, t) { return e.stopPropagation(), n.isInArea(s.config.support, t.item.locationCode) ? s.fillBackInfo(t.item) : layer.msg(_l("暂不支持该地区下单")), !1 }, source: function (e, t) { if ($.cookie("loginUser")) { var i = s.$("input[name='contactName']").val(), n = s.$("input[name='contactTel']").val(), a = s.$("input[name='companyName']").val(); sfAjax.compoundQueryAddressBook({ data: { contact: encodeURIComponent(i), telPhone: encodeURIComponent(n), companyName: encodeURIComponent(a), memType: s.config.autoMatch.memType }, success: function (e) { 0 === e.code && e.result && t(e.result.slice(0, 9)) } }) } else t([]) } }).autocomplete("instance")._renderItem = function (e, t) { return $("<li>").append($(i.auto_match({ item: t }))).appendTo(e) }, $(this).find("input").unbind("input") }) } } }), define("components/addressForm/function/nearBy", ["views/pages/order/innerViews/nearbyAddress", "helper"], function (e, t, i) { return { events: { "click .getNearbyAddress": "showNearbyAddressDropdown", "change [name=location]": "addressInRangeTip", "input [name=address]": "addressInRangeTip" }, mounted: function () { }, methods: { showNearbyAddressDropdown: function () { this.sender_nearby_address ? this.sender_nearby_address.loadMapJs() : this.sender_nearby_address = new t({ el: this.$(".nearbyAddressWrapper"), targetEL: this.$("input[name='location']"), senderLocation: this.location, detailAdd: this.$("input[name='address']") }) }, addressInRangeTip: function () { this.notOutRange = !0 } } } }), define("components/addressForm/function/outRange", ["views/pages/order/innerViews/popSmartFilling"], function (e) { return { events: { 'change [name="address"]': "queryAddressRange" }, mounted: function () { }, methods: { queryAddressRange: function () { this.notOutRange = !0; var e = this.$("[name=location]").val(), t = this.$("[name=address]").val(); if (e && t) { e = e.replace(/-/g, ""); var i = this; sfAjax.queryAddressRange({ data: { address: e + t, dataType: this.dataType }, success: function (e) { e && 710 == e.code ? i.addressOutRangeTip() : i.addressInRangeTip() }, error: function () { i.addressInRangeTip() } }) } }, addressOutRangeTip: function () { this.notOutRange = !1 }, addressInRangeTip: function () { this.notOutRange = !0 } } } }), define("components/smartFill/index", ["baseView", "templates", "helper", "const", "bus/address/index", "sflayer"], function (e, t, i, n, a) { return e.extend({ template: t.smartFill, init: function (e) { this.viewOption = e.viewOption, this.pop = e.pop || !1 }, layerOpts: { title: _l("智能地址填写"), area: "580px", skin: "line" }, render: function () { this.pop && this.$el.html(this.template(this.options)) }, closeView: function () { this.close() }, events: { "click .intellect-fill-btn": "orderAddrSplitSubmit", "input .intellect-order-addr": "isValidIntellectAddr" }, isValidIntellectAddr: function (e) { var t = this.$(".intellect-order-addr").val().trim(); this.$(".intellect-fill-input").text(t.length); var i = this.$(".intellect-fill-btn"); 0 == t.length ? i.addClass("disabled") : 100 < t.length ? (i.addClass("disabled"), this.tipIndex = layer.tips(_l("输入内容不能大于100字"), e.currentTarget, { tips: 3, anim: 5, time: !1, tipsMore: !1, isOutAnim: !1 })) : (i.removeClass("disabled"), this.tipIndex && layer.close(this.tipIndex)) }, orderAddrSplitSubmit: function () { var n = this; sfAjax.addressSplit({ data: { address: this.$(".intellect-order-addr").val().trim() }, success: function (e) { if (0 === e.code) { var t, i = e.result || {}; if (i.originDestRegions && i.originDestRegions.length && !a.isInArea(n.options.support, i.originDestRegions[0].rateCode)) return void layer.msg(_l("暂不支持该地区下单")); 1 == i.splitType ? t = _l("未找到对应的省份，请您手动进行选择哦！") : 2 == i.splitType ? t = _l("未找到对应的城市，请您手动进行选择哦！") : 3 == i.splitType && (t = _l("未找到对应的行政区，请您手动进行选择哦！")), n.options.callback(i, t), n.close() } }, error: function () { layer.msg(_l("网络异常，请稍后再试")) } }) } }) }), define("components/addressForm/function/smartFill", ["components/smartFill/index"], function (t) { return { events: { "click .addIntellectFill": "showAddIntellectFillContent" }, mounted: function () { }, methods: { showAddIntellectFillContent: function () { new t(_.extend({ pop: !0, callback: this.fillOrderItemInfo.bind(this) }, this.config)); var e = this.shipperType; "sender" === e ? "hk" === Helper.getSiteLocation() ? sfgather.trackClicks("点击寄件人智能地址填写", "XWF010102") : sfgather.trackClicks("点击寄件人智能地址填写", "OWF010102") : "receiver" === e && ("hk" === Helper.getSiteLocation() ? sfgather.trackClicks("点击收件人智能地址填写", "XWF010202") : sfgather.trackClicks("点击收件人智能地址填写", "OWF010202")) }, fillOrderItemInfo: function (t, e) { var i = this; this.$("input[name='contactName']").val(t.personalName), this.$("input[name='address']").val(t.site), t.mobile && this.$("input[name='contactTel']").val(t.mobile), t.telephone && this.$("input[name='contactPhone']").val(t.telephone), this.$(".intellect-warm-reminder").show(), e ? layer.confirm(e, { btn: [_l("我知道了")] }, function (e) { layer.close(e), i.location.setLocation(t.originDestRegions) }) : i.location.setLocation(t.originDestRegions) } } } }), define("components/addressForm/function/index", ["./location", "./addressBook", "./addressRedress", "./autoMatch", "./nearBy", "./outRange", "./smartFill"], function (e, t, i, n, a, s, r) { var o = { location: e, addressBook: t, addressRedress: i, autoMatch: n, nearBy: a, outRange: s, smartFill: r }; return { init: function (e) { var t = []; for (var i in o) e[i] && t.push(o[i]); return t } } }), define("components/addressForm/index", ["baseView", "templates", "event", "./config", "./function/index", "const", "sf-validate", "bus/address/index", "sflayer"], function (e, t, i, n, a, s, r, o) { return e.extend({ template: t.address_form, events: {}, init: function (e) { this.config = _.extend({}, n, e.config), this.mixins = a.init(this.config), this.formatTel = "isTelCnHmt" }, render: function () { this.$el.html(this.template(_.extend({ priceUrl: Helper.getDynamicURLWithContext("/price/"), rIndex: !1, hasCalc: !1, customID: !1 }, this.config))), this.config.warmReminder && this.$(".warm-red").show(), r(this.$("form"), this.config.validate(this)) }, showIndex: function (e) { null == e ? this.$(".r-index").text("") : this.$(".r-index").text("- " + (e + 1)) }, showCustomID: function (e) { this.$(".customID").toggleClass("hidden", !e) }, hideDelete: function () { this.$(".delete").remove() }, getFormDataObj: function () { var e = this.$("form").serializeArray(); return _.object(_.pluck(e, "name"), _.pluck(e, "value")) }, fillBackInfo: function (e) { return o.isInArea(this.config.support, e.locationCode) ? (Helper.isDirectCity(e.locationCode) && (e.province = e.city), this.$("input[name='contactName']").val(e.contactName), this.$("input[name='companyName']").val(e.companyName), this.$("input[name='location']").data("code", e.countyCode).data("rate-code", e.locationCode).data("parent-code", e.cityCode), this.$("input[name='address']").val(e.address), this.location.setLocationData(e), this.$("input[name='contactTel']").val(e.contactTel), this.$("input[name='contactPhone']").val(e.contactPhone), e.locationCode === s.RATE_OF_TW ? this.$("input[name='customerId']").val(e.customerId) : this.$("input[name='customerId']").val(""), this.addressId = e.addressId, this.preFormDataObj = this.getFormDataObj(), !0) : (layer.msg(_l("暂不支持该地区下单")), !1) }, getShipperData: function () { var e = _.omit(this.getFormDataObj(), "location"); return _.extend(e, { addressId: this.addressId || "", locationCode: this.addLocation.locationCode, country: "中国", countryCode: "A000086000", province: this.addLocation.province, provinceCode: this.addLocation.provinceCode, city: this.addLocation.city, cityCode: this.addLocation.cityCode, county: this.addLocation.county, countyCode: this.addLocation.countyCode, postalCode: "", longitude: "", latitude: "", setMark: this.judgeSetMark(), selfPick: this.selfPick || !1, distId: this.addLocation.countyId }) }, judgeSetMark: function () { var e = !0; return null != this.addressId && _.isEqual(this.preFormDataObj, this.getFormDataObj()) && (e = !1), e }, showReminder: function (e) { this.$(".warm-reminder").text(e).slideDown("fast") }, validateshipper: function () { return this.$("form").validate().form() }, isAllNull: function () { return 0 == _.compact(_.pluck(this.$("form").serializeArray(), "value")).length } }) }), define("views/pages/order/normal/success/single/index", ["baseView", "templates", "utils/time", "helper", "const", "components/changeAppointBill/changeAppointBill", "components/changeAppointBill/changeAppointBillHeavyCargo", "components/changeAppointBill/changeAppointBillHmt", "views/query/components/cancelAppointBill", "components/newBillOptions/showBillDetail", "components/digitalWaybill/index", "bus/index", "sflayer"], function (e, t, i, s, n, a, r, o, l, c, d, u) { var h = ["T1", "T104", "T8", "T801", "T4", "T6"], p = ["SE0100", "SE0101"], f = s.getSiteLocation(), m = { init: function (e) { this.appointmentNo = e.appointmentNo, this.waybillNo = e.waybillNo }, template: t.orderSuccess, render: function () { var a = this; sfAjax.queryAppointBill({ data: { appointmentNo: this.appointmentNo }, success: function (e) { var t = (a.info = e).appointmentDetail; a.sLocationCode = t.appointmentOriginDetail.locationCode, a.rLocationCode = t.appointmentDestDetail.locationCode, u.setSLocationCode(a.sLocationCode), u.setRLocationCode(a.rLocationCode), a.pickupType = t.pickupType; var i = a.getOutDoorTime(t), n = s.getCurrencyByCode(a.sLocationCode); a.$el.html(a.template({ data: t, info: c.afterProcessingDetail(t, n), relativeDate: a.getRelativeDate(i), relativeHour: i.format("HH:mm"), sender: t.appointmentOriginDetail, receiver: t.appointmentDestDetail, waybillUrl: s.getDynamicURLWithContext("/waybill/"), isSelfSend: a.options.selfSend, isQr: 3 == a.pickupType && !a.options.selfSend, waybillNo: a.waybillNo, hasCargoService: u.hasCargoService(), hasCargoInsure: u.hasCargoInsure() })) }, error: function () { a.queryChangeAppointBillFail() }, login: { succCallback: this.render.bind(this), cancelCallback: this.queryChangeAppointBillFail.bind(this) }, complete: function () { a.setElement(a.$(".order-success")), window.scrollTo(0, 0) } }) }, events: { "click .cancel": "cancelOrder", "click .fill-bill": "fillBill", "click .order-again": "orderAgain", "click .download": "downloadDigital", "click .go-waybill": "viewTheOrderList" }, viewTheOrderList: function () { "hk" === s.getSiteLocation() ? sfgather.trackClicks("点击查看订单列表", "XWF010402") : sfgather.trackClicks("点击查看订单列表", "OWF010402") }, queryChangeAppointBillFail: function () { this.$el.html(this.template({ data: null, isQr: 3 == this.pickupType && !this.options.selfSend, imgUrl: s.getResourceURL("images/order/box-happy.png"), waybillNo: this.waybillNo, waybillUrl: s.getDynamicURLWithContext("/waybill/") })) }, getOutDoorTime: function (e) { var t; return t = e.expectStartTm ? e.expectStartTm : e.appointmentTime, moment(t, "YYYY-MM-DD HH:mm:ss").add("hour", 1) }, getRelativeDate: function (e) { return i.relativeDate(e, this.options.synServerTim) }, cancelOrder: function () { new l({ appointmentNo: this.appointmentNo, pickupType: this.pickupType, callback: function () { window.location.reload() } }) }, fillBill: function () { var e = { billInfo: this.info.appointmentDetail, callback: function () { this.render(), window.scrollTo(0, 0) }.bind(this) }; if (s.isHK_MC_TW(this.rLocationCode)) new o(e); else { var t = this.info.appointmentDetail.productInfo.code; -1 < h.indexOf(t) ? new a(e) : -1 < p.indexOf(t) && new r(e) } sfgather.trackClicks("点击收件人后完善快件信息按钮", "OWF010405") }, orderAgain: function () { window.location.reload() }, downloadDigital: function () { new d({ infoList: [this.info] }), "hk" === s.getSiteLocation() ? sfgather.trackClicks("点击下载电子运单", "XWF010403") : sfgather.trackClicks("点击下载电子运单", "OWF010403") } }, g = { fillBill: function () { var e = { billInfo: this.info.appointmentDetail, callback: function () { this.render(), window.scrollTo(0, 0) }.bind(this) }; this.sLocationCode == this.rLocationCode ? new a(e) : new o(e), sfgather.trackClicks("点击收件人后完善快件信息按钮", "XWF010405") } }; return "cn" === f ? e.extend(m) : "hk" === f || "tw" === f ? e.extend(_.extend(m, g)) : void 0 }), define("views/pages/order/normal/success/batch/index", ["baseView", "templates", "utils/time", "components/changeAppointBill/bulkChangeAppointBill", "components/digitalWaybill/index", "components/changeAppointBill/changeAppointBill", "components/changeAppointBill/changeAppointBillHmt", "components/newBillOptions/showBillDetail", "helper", "const", "bus/index"], function (e, n, t, s, i, r, o, a, l, c, d) { var u = l.getSiteLocation(), h = { template: n.bulkOrderSuccess, render: function (t) { var e = layer.load(0, { shade: [.2, "#000"] }), i = this; sfAjax.bulkQueryAppointBill({ data: { billList: this.options.appointmentNoList.join(",") }, success: function (e) { e && 0 === e.code && 0 < e.result.length ? (i.infoList = e.result, i.sLocationCode = i.getSenderInfo().locationCode, d.setSLocationCode(i.sLocationCode), i.renderSuccHead(), null != i.options.failSubmitData && i.renderSubmitFailOrder(), i.renderInfoList(), i.renderDetailInfoList(), "showDetail" == t && (i.$(".info-list").hide(), i.$(".bulk-modify").trigger("click"), i.showSelectAll || i.$(".cancle-select").trigger("click"))) : i.queryChangeAppointBillFail() }, error: function () { i.queryChangeAppointBillFail() }, login: { succCallback: this.render.bind(this), cancelCallback: this.queryChangeAppointBillFail.bind(this) }, complete: function () { layer.close(e) } }) }, events: { "click .submit-again": "submitAgain", "click .download": "downloadDigital", "click .bulk-modify": "triggerInfoToggle", "click .detail-bulk-modify": "showCheckbox", "click .info-toggle": "infoToggle", "click .confirm-select": "bulkModify", "click .cancle-select": "hideCheckbox", "click .select-one": "checkToggle", "click .select-all": "allCheckToggle", "click .modify": "singleModify", "click .modify-hk": "singleModifyIcon", "click .to-waybill": "toWaybill" }, toWaybill: function () { "hk" === l.getSiteLocation() ? sfgather.trackClicks("点击查看订单列表", "XWF010402") : sfgather.trackClicks("点击查看订单列表", "OWF010402") }, singleModifyIcon: function () { "hk" === l.getSiteLocation() ? sfgather.trackClicks("点击收件人后完善快件信息按钮", "XWF010405") : sfgather.trackClicks("点击收件人后完善快件信息按钮", "OWF010405") }, renderSuccHead: function () { var e = this.infoList[0].appointmentDetail, t = this.getOutDoorTime(e); this.$el.html(this.template({ data: this.infoList, resoure: e.resoure, relativeDate: this.getRelativeDate(t), relativeHour: t.format("HH:mm"), listNO: this.infoList.length, totalFreight: this.calcTotalFreight(), pickupType: e.pickupType, currencyCode: this.options.currencyCode, selfSend: this.options.selfSend })) }, getOutDoorTime: function (e) { var t; return t = e.expectStartTm ? e.expectStartTm : e.appointmentTime, moment(t, "YYYY-MM-DD HH:mm:ss").add("hour", 1) }, getRelativeDate: function (e) { return t.relativeDate(e, this.options.synServerTim) }, queryChangeAppointBillFail: function () { this.$el.html(n.bookingSuccHappy({ imgUrl: l.getResourceURL("images/order/box-happy.png"), waybillUrl: l.getDynamicURLWithContext("/waybill/") })) }, renderSubmitFailOrder: function () { var e = this.options.failSubmitData.destinationInfo; this.$(".order-again").html(n.orderAgain({ data: e })) }, submitAgain: function () { var r = this.options.failSubmitData, t = []; _.each(r.destinationInfo, function (e) { t.push(_.omit(e, "rateHtml")) }), r.destinationInfo = t, this.submitBtn = this.$(".submit-again"), this.submitBtn.toggleClass("disabled", !0); var e = layer.load(0, { shade: [.2, "#000"] }), o = this; sfAjax.bulkSubmitNewOrder({ data: r, success: function (e) { if (e && 0 === e.code && 0 < e.result.length) { var t = e.result, i = []; _.each(t, function (e) { !1 === e.success && i.push(e.index) }); var n = { succ: t.length - i.length, fail: i.length }; if (0 === n.succ) layer.msg(_l("网络异常，请重新提交订单")); else var a = _l("预约成功，其中${succ}条成功，${fail}条失败！"), s = layer.alert(a._p(n), { closeBtn: 0 }, function () { layer.close(s), 0 === i.length ? o.options.failSubmitData = null : r.destinationInfo = _.filter(r.destinationInfo, function (e) { return _.contains(i, e.index) }); var e = _.pluck(_.filter(t, function (e) { return !0 === e.success }), "appointmentNo"); o.options.appointmentNoList.push(e), o.options.appointmentNoList = _.flatten(o.options.appointmentNoList), o.render() }) } else o.renderFail(e) }, error: function () { layer.msg(_l("网络异常，请重新提交订单")) }, login: { succCallback: this.submitAgain.bind(this), cancelCallback: null }, complete: function () { o.submitBtn.toggleClass("disabled", !1), layer.close(e) } }) }, renderFail: function (e) { 654 === e.code ? layer.msg(_l("月结账号无效")) : 651 === e.code ? layer.msg(_l("预约失败：下单时间不在服务时间范围内。")) : 652 === e.code ? layer.msg(_l("暂时不能为您提供收派件的服务，如有疑问请咨询我司热线95338。")) : 653 === e.code ? layer.msg(_l("账号异常！")) : 502 === e.code ? layer.msg(_l("系统繁忙，请重试！")) : layer.msg(_l("预约失败：信息校验不通过，请检查必填项。")) }, getSenderInfo: function () { return this.infoList[0].appointmentDetail.appointmentOriginDetail }, calcTotalFreight: function () { var t = 0; return _.each(this.infoList, function (e) { "NaN" === parseFloat(e.appointmentDetail.metaPrice).toString() || 0 === parseFloat(e.appointmentDetail.metaPrice) ? (t += 0, e.appointmentDetail.metaPrice = "--") : t += parseFloat(e.appointmentDetail.metaPrice) }), parseFloat(t) || "--" }, renderInfoList: function () { this.$(".info-list").html(n.infoList({ sender: this.getSenderInfo(), infoList: this.infoList, waybillUrl: l.getDynamicURLWithContext("/waybill/"), currencyCode: this.options.currencyCode })) }, renderDetailInfoList: function () { var t = this.options.currencyCode; this.$(".detail-info-list").html(n.detailInfoList({ sender: this.getSenderInfo(), infoList: this.infoList, totalFreight: this.calcTotalFreight(), waybillUrl: l.getDynamicURLWithContext("/waybill/"), currencyCode: t })); var i = ""; _.each(this.infoList, function (e) { d.setRLocationCode(e.appointmentDetail.appointmentDestDetail.locationCode), i += n.detailInfoItem({ obj: e, info: a.afterProcessingDetail(e.appointmentDetail, t), hasCargoService: d.hasCargoService(), hasCargoInsure: d.hasCargoInsure(), currencyCode: t }) }), this.$(".sfcard .receive-info-list").html(i) }, downloadDigital: function () { new i({ infoList: this.infoList }), "hk" === l.getSiteLocation() ? sfgather.trackClicks("点击下载电子运单", "XWF010403") : sfgather.trackClicks("点击下载电子运单", "OWF010403") }, triggerInfoToggle: function () { var e = this; this.$(".info-toggle").addClass("active"), this.$(".info-toggle").find("span").removeClass("aicon-chevron-double-down").addClass("aicon-chevron-double-up"), this.$(".info-list").fadeOut("fast", function () { e.$(".detail-info-list").fadeIn() }), this.$(".info-toggle-wrapper .price-desc").hide(), this.showCheckbox() }, infoToggle: function (e) { var t = this.$(e.currentTarget), i = this; t.toggleClass("active"), t.hasClass("active") ? (t.find("span").removeClass("aicon-chevron-double-down").addClass("aicon-chevron-double-up"), this.$(".info-list").fadeOut("fast", function () { i.$(".detail-info-list").fadeIn() }), this.$(".info-toggle-wrapper .price-desc").hide(), this.hideCheckbox()) : (t.find("span").removeClass("aicon-chevron-double-up").addClass("aicon-chevron-double-down"), this.$(".detail-info-list").fadeOut("fast", function () { i.$(".info-list").fadeIn() }), this.$(".info-toggle-wrapper .price-desc").show()), "hk" === l.getSiteLocation() ? sfgather.trackClicks("点击预约详情信息", "XWF010401") : sfgather.trackClicks("点击预约详情信息", "OWF010401") }, showCheckbox: function () { var e = this; this.$(".detail-bulk-modify,.receiver-table .sfbadge,.detail-info-list .download,.detail-info-list .to-waybill").fadeOut("fast", function () { e.$(".receiver-table .select-one,.select-all,.confirm-select,.cancle-select").fadeIn() }), "hk" === l.getSiteLocation() ? sfgather.trackClicks("点击批量修改预约信息", "XWF010404") : sfgather.trackClicks("点击批量修改预约信息", "OWF010404") }, hideCheckbox: function () { var e = this; this.$(".receiver-table .aicon-check, .select-all").addClass("aicon-uncheck").removeClass("aicon-check"), this.$(".receiver-table .select-one,.select-all,.confirm-select,.cancle-select").fadeOut("fast", function () { e.$(".detail-bulk-modify,.receiver-table .sfbadge,.detail-info-list .download,.detail-info-list .to-waybill").fadeIn() }) }, checkToggle: function (e) { this.$(e.currentTarget).toggleClass("aicon-check aicon-uncheck") }, allCheckToggle: function (e) { this.checkToggle(e), this.$(e.currentTarget).hasClass("aicon-check") ? this.$(".select-one").addClass("aicon-check").removeClass("aicon-uncheck") : this.$(".select-one").addClass("aicon-uncheck").removeClass("aicon-check") }, bulkModify: function () { var t = [], i = !1, e = this.$(".receiver-table .aicon-check"); if (e && 0 < e.length) { var n = []; _.each(e, function (e) { n.push($(e).parents(".detail-item").data("appointment-no")) }), _.each(this.infoList, function (e) { _.contains(n, e.appointmentNo) && (l.isHK_MC_TW(e.appointmentDetail.appointmentDestDetail.locationCode) ? i = !0 : t.push(JSON.parse(JSON.stringify(e)))) }), i ? layer.msg(_l("批量修改预约单不支持寄往港澳台！")) : new s({ billInfoList: t, callback: function () { this.render("showDetail") }.bind(this) }) } else layer.msg(_l("请选择预约单")); "hk" === l.getSiteLocation() ? sfgather.trackClicks("点击批量修改快递产品确认按钮", "XWF010406") : sfgather.trackClicks("点击批量修改快递产品确认按钮", "OWF010406") }, singleModify: function (e) { this.$(".select-all").is(":visible") ? this.showSelectAll = !0 : this.showSelectAll = !1; var t = $(e.currentTarget).parents(".detail-item").data("appointment-no"), i = _.find(this.infoList, function (e) { return e.appointmentNo === t }), n = { billInfo: i.appointmentDetail, callback: function () { this.render("showDetail") }.bind(this) }; l.isHK_MC_TW(i.appointmentDetail.appointmentDestDetail.locationCode) ? new o(n) : new r(n) } }, p = { bulkModify: function () { var t = [], i = !1, e = this.$(".receiver-table .aicon-check"), n = this; if (e && 0 < e.length) { var a = []; _.each(e, function (e) { a.push($(e).parents(".detail-item").data("appointment-no")) }), _.each(this.infoList, function (e) { _.contains(a, e.appointmentNo) && (n.sLocationCode != e.appointmentDetail.appointmentDestDetail.locationCode ? i = !0 : t.push(JSON.parse(JSON.stringify(e)))) }), i ? layer.msg(_l("批量修改预约单只支持同地区互寄！")) : new s({ billInfoList: t, callback: function () { this.render("showDetail") }.bind(this) }) } else layer.msg(_l("请选择预约单")) }, singleModify: function (e) { this.$(".select-all").is(":visible") ? this.showSelectAll = !0 : this.showSelectAll = !1; var t = $(e.currentTarget).parents(".detail-item").data("appointment-no"), i = _.find(this.infoList, function (e) { return e.appointmentNo === t }), n = { billInfo: i.appointmentDetail, callback: function () { this.render("showDetail") }.bind(this) }, a = i.appointmentDetail.appointmentDestDetail.locationCode; this.sLocationCode == a ? new r(n) : new o(n) } }; return "cn" === u ? e.extend(h) : "hk" === u || "tw" === u ? e.extend(_.extend(h, p)) : void 0 }), define("views/pages/order/normal/booking/internation", ["bus/address/index"], function (e) { return { tw: { initPickUpType: function () { var e = this; this.$(".on-door").find(".icon").removeClass("aicon-radio-active").addClass("aicon-radio"), this.$(".by-self").find(".icon").removeClass("aicon-radio").addClass("aicon-radio-active"), this.$(".pick-type").hide(), this.$(".show-on-door").fadeOut(function () { e.$(".show-by-self").html(_l("下單後可打印電子運單二維碼，向收派員或至順豐服務點出示二維碼，掃碼後快速寄件。實際送達時效以快地實際寄出時間為準(偏遠地區以第三方物流業者為準)")).fadeIn() }), this.pickType = 2 } } } }), define("views/pages/order/normal/booking/batch/peakControlFill", ["baseView", "templates", "sflayer"], function (e, t) { return e.extend({ events: { "click tr": "selectOne", "click .select-all": "selectAll", "click .delete-select": "deleteSelect", "click .delete-all-select": "deleteAllSelect", "click .continue-submit": "continueSubmit", "change .select": "controlTypeChange" }, template: t.peakControlFill, layerOpts: { title: _l("高峰管控提醒"), area: "800px", cancel: function () { this.options.callbackClose() } }, render: function () { var e = _.filter(this.model.get("receiverList"), function (e) { return 1 == e.obj.controlStrategy || 2 == e.obj.controlStrategy || 3 == e.obj.controlStrategy }); this.$el.html(this.template({ controlReceiverList: e, currencyCode: this.options.currencyCode })), this.renderSelect("all"); var t = this; $(window).resize(function () { t.$(".height-scroll").height() > $(this).height() - 364 ? t.$(".height-scroll").css("height", $(this).height() - 364) : t.$(".height-scroll").css("height", "auto") }), $(window).resize() }, selectOne: function (e) { this.$(e.target).hasClass("select-one") ? (this.$(e.target).hasClass("aicon-check") ? this.$(e.target).removeClass("aicon-check").addClass("aicon-uncheck") : this.$(e.target).removeClass("aicon-uncheck").addClass("aicon-check"), e.stopPropagation()) : this.$(e.currentTarget).find(".select-one").trigger("click") }, selectAll: function (e) { this.$(e.currentTarget).hasClass("aicon-check") ? (this.$(e.currentTarget).removeClass("aicon-check").addClass("aicon-uncheck"), this.$(".select-one").removeClass("aicon-check").addClass("aicon-uncheck")) : (this.$(e.currentTarget).removeClass("aicon-uncheck").addClass("aicon-check"), this.$(".select-one").removeClass("aicon-uncheck").addClass("aicon-check")) }, deleteSelect: function (n) { var a = this, e = _l("是否确认取消寄件"), s = layer.confirm(e, { title: _l("温馨提示"), btn: [_l("是"), _l("否")] }, function () { var e = a.$(n.currentTarget), t = e.data("rid"), i = _.reject(a.model.get("receiverList"), function (e) { return e.index == t }); a.model.set("receiverList", i), e.remove(), layer.close(s) }, function () { layer.close(s) }) }, deleteAllSelect: function (e) { var t = this, a = this.$(".select-one.aicon-check"); if (0 < a.length) var i = _l("是否确认取消寄件"), s = layer.confirm(i, { title: _l("温馨提示"), btn: [_l("是"), _l("否")] }, function () { var e = a.parents("tr"), i = []; _.each(e, function (e) { var t = $(e).data("rid"); i.push(t), $(e).remove() }); var n = t.model.get("receiverList"); _.each(i, function (t) { n = _.reject(n, function (e) { return e.index == t }) }), t.model.set("receiverList", n), layer.close(s) }, function () { layer.close(s) }) }, continueSubmit: function (e) { var t = this.model.get("receiverList"); if (0 < t.length) { 0 < _.filter(t, function (e) { return 1 == e.obj.controlStrategy }).length ? layer.alert(_l("请取消因延时管控而不能下单的选项")) : (this.close(), this.options.callbackSubmit()) } else { this.close(); var i = this, n = _l("当前0条寄件，请返回添加收件人信息"), a = layer.confirm(n, { title: _l("温馨提示"), btn: [_l("确定")], closeBtn: 0 }, function () { layer.close(a), i.options.callbackPrevStep() }) } }, controlTypeChange: function (e) { var t = _.filter(this.model.get("receiverList"), function (e) { return 1 == e.obj.controlStrategy || 2 == e.obj.controlStrategy || 3 == e.obj.controlStrategy }), i = this.$(e.currentTarget).val(); "all" != i && (t = _.filter(t, function (e) { return e.obj.controlStrategy == i })), this.$el.html(this.template({ controlReceiverList: t, currencyCode: this.options.currencyCode })), this.renderSelect(i) }, renderSelect: function (t) { this.$(".select").empty(); _.each([{ value: "all", name: "全部" }, { value: "1", name: "延时管控" }, { value: "2", name: "错峰管控" }, { value: "3", name: "加价管控" }], function (e) { t == e.value ? $(".select").append("<option value='" + e.value + "' selected>" + _l(e.name) + "</option>") : $(".select").append("<option value='" + e.value + "'>" + _l(e.name) + "</option>") }) } }) }), define("views/pages/order/bus/peakControl", ["../normal/booking/batch/peakControlFill"], function (o) { return { single: function (e) { var t = $.Deferred(), i = !0, n = null, a = ""; if (_webConfig.openPeakControl) { var s = layer.load(); sfAjax.queryCustomerControlStrategy({ data: e, success: function (e) { if (e && 0 === e.code && e.result) switch (n = e.result.controlStrategy) { case 0: break; case 1: i = !1; case 2: case 3: case 4: a = e.result.notificationMsg } }, complete: function () { if (i) if (2 === n || 3 === n || 4 === n) var e = layer.confirm(a, { title: _l("温馨提示"), btn: [_l("确定"), _l("取消")] }, function () { layer.close(e), t.resolve(n, a) }, function () { layer.close(e) }); else t.resolve(n, a); else layer.alert(a); layer.close(s) } }) } else t.resolve(n, a); return t }, batch: function (e, t, i, n) { var a = $.Deferred(), s = !0; if (_webConfig.openPeakControl) { var r = layer.load(); sfAjax.queryBatchControlStrategy({ data: e, success: function (e) { e && 0 === e.code && 0 !== e.result.length && (_.each(e.result, function (e) { e.obj = e.obj || { controlStrategy: 0, customerCode: "", notificationMsg: "", serviceCode: "" } }), _.each(t, function (t) { _.each(e.result, function (e) { t.index === e.index && (t.obj = e.obj) }) }), 0 < _.filter(e.result, function (e) { return 1 == e.obj.controlStrategy || 2 == e.obj.controlStrategy || 3 == e.obj.controlStrategy }).length && (s = !1, new o({ model: i, callbackSubmit: function () { a.resolve() }, callbackClose: function () { }, callbackPrevStep: function () { }, currencyCode: n }))) }, complete: function () { s && a.resolve(), layer.close(r) } }) } else a.resolve(); return a } } }), define("views/pages/order/normal/booking/single/index", ["baseView", "templates", "../../../innerViews/priceAndTime", "../../../bus/peakControl"], function (e, t, i, n) { return e.extend({ init: function (e) { this.time = e.time, this.receiver = this.model.get("receiverList")[0]; var t = this.receiver.locationCode; this.isHMT = Helper.isHK_MC_TW(t), this.getPickType = e.getPickType }, render: function () { this.priceAndTime = new i({ el: this.$(".product-type-wrapper"), orderModel: this.model, callback: this.setPriceAndTime.bind(this), type: 1, sLocationCode: this.model.get("originateAddress").locationCode, dLocationCode: this.receiver.locationCode }), this.fetchPriceAndTimes() }, whetherNeedClearance: function () { return Helper.isHK_MC_TW(this.receiver.locationCode) }, fetchPriceAndTimes: function () { var e = { originCode: this.getRateCode(this.model.get("originateAddress")), destCode: this.getRateCode(this.model.get("receiverList")[0]), time: this.time.start || this.model.get("synServerTim").format(), weight: this.getMetaWeight(), queryType: this.getQueryType(), rateType: "toMainland" }; this.priceAndTime.fetchTimeAndRate(e), this.$(".product-type-content").slideDown() }, getRateCode: function (e) { return Helper.isHK_MC_TW(e.locationCode) ? e.cityCode : e.countyCode }, setBookingTime: function (e) { this.time = e, this.fetchPriceAndTimes() }, getMetaWeight: function () { return "tw" === Helper.getSiteLocation() || "hk" === Helper.getSiteLocation() ? "0.5" : "1" }, getQueryType: function () { return "cn" === Helper.getSiteLocation() ? this.isHMT ? "3" : "2" : this.isHMT ? "12" : "4" }, getCargoList: function () { return this.isHMT ? null : [{ name: "文件", uom: "", desc: "", price: "0" }] }, createOrder: function (a) { var s = this; n.single({ customerType: 1, customerCode: this.model.get("originateAddress").contactTel || this.model.get("originateAddress").contactPhone, channelCode: "PC.OWF", srcZoneCode: this.model.get("originateAddress").locationCode, destZoneCode: this.model.get("receiverList")[0].locationCode, srcAddress: Helper.getFullAddress(this.model.get("originateAddress").locationCode, this.model.get("originateAddress")), destAddress: Helper.getFullAddress(this.model.get("receiverList")[0].locationCode, this.model.get("receiverList")[0]), srcDivisionCode: this.model.get("originateAddress").distId ? this.model.get("originateAddress").distId : "", destDivisionCode: this.model.get("receiverList")[0].distId ? this.model.get("receiverList")[0].distId : "", limitTypeCode: this.productCode, cargoTypeCode: this.cargoTypeCode, expressTypeCode: this.expressTypeCode, consignedTm: this.time.start ? moment(this.time.start).format("YYYY-MM-DD HH:mm:ss") : this.model.get("synServerTim").format() }).then(function (e, t) { this.controlStrategy = e, this.notificationMsg = t; var i = s.getSubmitPostData(), n = layer.load(0, { shade: [.2, "#000"] }); sfAjax.submitNewOrder({ data: i, success: function (e) { e && 0 == e.code ? (a(e.result), s.setAddressToStore(), s.saveToAddressBook()) : s.renderFail(e) }, error: function () { layer.msg(_l("网络异常，请重新提交订单")) }, login: { succCallback: s.createOrder.bind(s), cancelCallback: null }, complete: function () { layer.close(n) } }) }) }, setAddressToStore: function () { var e = JSON.stringify(this.getShipperData()); localStorage.setItem(Helper.getLatestSenderKey() + $.cookie("loginUser"), e) }, saveToAddressBook: function () { var e = []; if (this.model.get("originateAddress").setMark && e.push(this.getShipperData()), this.model.get("saveToAddressBook")) { var t = this.model.get("receiverList")[0]; t.setMark && e.push(_.extend({ memType: 1, isDefault: 0 }, _.omit(t, "rid", "setMark"))) } 0 < e.length && sfAjax.bulkSaveOrUpdateAddress({ data: e }) }, getShipperData: function () { return _.extend({ memType: 0, isDefault: 0 }, _.omit(this.model.get("originateAddress"), "setMark")) }, renderFail: function (e) { 1 == e.code ? layer.msg(_l("运单号无效或已使用")) : 654 == e.code ? layer.msg(_l("月结账号无效")) : 651 == e.code ? layer.msg(_l("预约失败：下单时间不在服务时间范围内。")) : 652 == e.code ? layer.msg(_l("暂时不能为您提供收派件的服务，如有疑问请咨询我司热线95338。")) : 653 == e.code ? layer.msg(_l("账号异常！")) : 502 == e.code ? layer.msg(_l("系统繁忙，请重试！")) : layer.msg(_l("预约失败：信息校验不通过，请检查必填项。")) }, getSubmitPostData: function () { return { expectStartTm: this.time.start && moment(this.time.start).format("YYYY-MM-DD HH:mm:ss"), expectFinishTm: this.time.finish && moment(this.time.finish).format("YYYY-MM-DD HH:mm:ss"), selfSend: 2 === this.getPickType(), originateAddress: _.omit(this.model.get("originateAddress"), "setMark"), destinationInfo: this.getReceiversInfo() } }, getReceiversInfo: function () { var e = this.model.get("receiverList")[0], t = []; return e = { destinationAddress: _.omit(e, "rid", "destRateCode", "productCode", "productName", "setMark"), remark: "", productCode: this.productCode, productName: this.productName.substring(0, 20), metaWeight: this.getMetaWeight(), metaPrice: parseFloat(this.totalFreight), cargoList: this.getCargoList(), custom: null, paymethod: "1", custid: "", supportValue: "", premium: "", controlStrategy: this.controlStrategy, notificationMsg: this.notificationMsg, selfPickUpFlag: e.selfPick, signedBackFlg: "0", signedBackSop: "", signedBackName: "", codAmt: "", codCustid: "", appointFlow: Helper.getFlowCode(e.locationCode, this.model.get("senderLocationCityCode")) }, t.push(e), t }, setPriceAndTime: function (e) { $(".next").toggleClass("disabled", !1), this.productCode = e.limitTypeCode, this.productName = e.limitTypeName, this.cargoTypeCode = e.cargoTypeCode, this.expressTypeCode = e.expressTypeCode, this.totalFreight = e.totalFreight } }) }), define("views/pages/order/components/bookingList/index", ["baseView", "templates", "../../cn/bulkShipping/bulkShippingPriceAndTime"], function (e, c, d) { return e.extend({ template: c.booking_list, events: { "click .bulk-modify-select": "bulkModifySelect", "click .bulk-modify-confirm": "bulkModifyConfirm", "click .bulk-modify-cancel": "bulkModifyCancel", "click tr": "selectOne", "click .select-all": "selectAll", "click .modify": "modifyRate", "change #date": "onSelectDateChange" }, init: function (e) { this.originRateCode = e.originRateCode }, render: function () { this.$el.html(this.template({ rList: this.options.list, currencyCode: this.options.currencyCode })) }, bulkModifySelect: function () { this.showBulkModify() }, bulkModifyCancel: function () { this.showBulkModify(!1) }, bulkModifyConfirm: function () { var e = this.$(".select-one.aicon-check"); if (0 == e.length) layer.msg(_l("请选择数据")); else { var t = []; _.each(e, function (e) { t.push($(e).parents("tr").data("code")) }); var i = _.uniq(t); if (1 < i.length) layer.msg(_l("请选择相同的省市区地址进行修改")); else { var n = e.parents("tr"), a = n.data("rid"), s = this.model.get("receiverList"), r = _.find(s, function (e) { return e.rid == a }).locationCode, o = { originCode: this.originRateCode, destCode: i[0], time: this.options.time, weight: 1, queryType: this.options.getQueryType(r), rateType: "toMainland" }, l = this; new d({ model: this.model, data: o, sLocationCode: this.model.get("originateAddress").locationCode, dLocationCode: r, callback: function (i) { _.each(s, function (t) { _.each(n, function (e) { t.rid == $(e).data("rid") && (t.productName = i.limitTypeName, t.productCode = i.limitTypeCode, t.cargoTypeCode = i.cargoTypeCode, t.expressTypeCode = i.expressTypeCode, t.metaPrice = i.totalFreight, t.priceAndTime = i, $(e).find(".rate-cell").html(c.rateCell({ list: i, currencyCode: l.options.currencyCode }))) }) }), l.model.set("receiverList", s), l.$el.find(".predict-price .price").html(l.calcTotalFreight()), l.showBulkModify(!1) } }) } } "hk" === Helper.getSiteLocation() ? sfgather.trackClicks("点击批量选择收件人的确定选择按钮", "XWF010305") : sfgather.trackClicks("点击批量选择收件人的确定选择按钮", "OWF010305") }, showBulkModify: function (e) { var t = this; !1 === e ? (this.$el.removeClass("active"), this.$(".receiver-wrapper").find(".aicon-check").removeClass("aicon-check").addClass("aicon-uncheck"), this.$(".bulk-modify-confirm,.bulk-modify-cancel").fadeOut("fast", function () { t.$(".bulk-modify-select").fadeIn("fast") })) : (this.$el.addClass("active"), this.$(".bulk-modify-select").fadeOut("fast", function () { t.$(".bulk-modify-confirm,.bulk-modify-cancel").fadeIn("fast") })) }, selectOne: function (e) { this.$(e.target).hasClass("select-one") ? (this.$(e.target).hasClass("aicon-check") ? this.$(e.target).removeClass("aicon-check").addClass("aicon-uncheck") : this.$(e.target).removeClass("aicon-uncheck").addClass("aicon-check"), e.stopPropagation()) : this.$(e.currentTarget).find(".select-one").trigger("click") }, selectAll: function (e) { this.$(e.currentTarget).hasClass("aicon-check") ? (this.$(e.currentTarget).removeClass("aicon-check").addClass("aicon-uncheck"), this.$(".select-one").removeClass("aicon-check").addClass("aicon-uncheck")) : (this.$(e.currentTarget).removeClass("aicon-uncheck").addClass("aicon-check"), this.$(".select-one").removeClass("aicon-uncheck").addClass("aicon-check")) }, modifyRate: function (e) { e.stopPropagation(); var i = this.$(e.currentTarget).parents("tr"), t = i.data("code"), n = i.data("rid"), a = this.model.get("receiverList"), s = _.find(a, function (e) { return e.rid == n }), r = { originCode: this.originRateCode, destCode: t, time: this.time, weight: 1, queryType: this.options.getQueryType(s.locationCode), rateType: "toMainland" }, o = this; new d({ model: this.model, data: r, sLocationCode: this.model.get("originateAddress").locationCode, dLocationCode: s.locationCode, callback: function (t) { _.each(a, function (e) { e.rid == n && (e.productName = t.limitTypeName, e.productCode = t.limitTypeCode, e.cargoTypeCode = t.cargoTypeCode, e.expressTypeCode = t.expressTypeCode, e.metaPrice = t.totalFreight, e.priceAndTime = t) }), i.find(".rate-cell").html(c.rateCell({ list: t, currencyCode: o.options.currencyCode })), o.model.set("receiverList", a), o.$el.find(".predict-price .price").html(o.calcTotalFreight()) } }), "hk" === Helper.getSiteLocation() ? sfgather.trackClicks("点击收件人列表后编辑按钮", "XWF010302") : sfgather.trackClicks("点击收件人列表后编辑按钮", "OWF010302") }, calcTotalFreight: function () { var e = this.model.get("receiverList"), t = 0; return _.each(e, function (e) { e.metaPrice = "string" == typeof e.metaPrice && -1 < e.metaPrice.indexOf("元") ? e.metaPrice.substring(0, e.metaPrice.length - 1) : e.metaPrice, t += "NaN" === parseFloat(e.metaPrice).toString() ? 0 : parseFloat(e.metaPrice) }), parseFloat(t) || "--" } }) }), define("views/pages/order/normal/booking/batch/timeAndRate", ["bus/address/index"], function (w) { return function (b) { return { getRatesParam: function () { var n = this, a = b.model.get("receiverList"); this.destRateCodeArr = _.uniq(_.pluck(a, "destRateCode")); var s = { origin: b.originRateCode, time: b.time, payFeeRates: [] }; return this.locationCodes = [], _.each(this.destRateCodeArr, function (t) { var e = _.find(a, function (e) { return e.cityCode == t || e.countyCode == t }).locationCode; n.locationCodes.push(e); var i = { dest: t, weight: "tw" === Helper.getSiteLocation() || "hk" === Helper.getSiteLocation() ? "0.5" : "1", volume: 1, queryType: b.getQueryType(e) }; s.payFeeRates.push(i) }), s }, getRatesData: function () { var t = this, e = this.getRatesParam(), i = { showErr: !0, limitTypeName: _l("顺丰标快"), deliverTime: _l("约2-4天"), totalFreight: _l("以收派员巴枪价格为准"), limitTypeCode: "T4", cargoTypeCode: "C201", expressTypeCode: "B1", closedTime: null }, n = layer.load(); sfAjax.bulkGetPayFee({ data: e, success: function (e) { t.dealRates(e) }, error: function () { b.error(i) }, complete: function () { layer.close(n) } }) }, dealRates: function (e, v) { var y = this; _.each(e, function (e, t) { if ("tw" === Helper.getSiteLocation() && (!e.rate || 0 === e.rate.length)) { var i = { limitTypeCode: "T4", limitTypeName: _l("顺丰标快"), deliverTime: moment().add(2, "day").format("YYYY-MM-DD 18:00"), closedTime: null, totalFreight: _l("以收派员巴枪价格为准") }; w.isHK(y.locationCodes[t]) ? i.totalFreight = 100 : w.isMC(y.locationCodes[t]) ? i.totalFreight = 125 : w.isTW(y.locationCodes[t]) ? (i.totalFreight = 80, i.deliverTime = moment().add(1, "day").format("YYYY-MM-DD 18:00")) : w.isMainland(y.locationCodes[t]) && (i.totalFreight = 126), e.rate = [], e.rate.push(i) } if (e.rate) { var n = e.rate; _.reject(n, function (e) { return null === e.deliverTime }), _.each(n, function (e) { e.closedTime && (e.closedTime = moment(e.closedTime, "HHmm").format("HH:mm")), e.deliverTime && "Invalid date" != moment(e.deliverTime).format() && (e.deliverTime = _l("预计") + " " + moment(e.deliverTime).format("ddd HH:mm") + " " + _l("前")) }); var a, s = _.groupBy(n, "limitTypeCode"), r = _.first(s.T1 || s.T104), o = _.first(s.T8 || s.T801), l = _.first(s.T4), c = _.first(s.T6), d = moment(b.time).clone(); if (b.model.get("firstPickedEndDateTime")) { var u = b.model.get("firstPickedEndDateTime").clone(), h = b.model.get("secondPickedEndDateTime").clone(), p = b.model.get("thirdPickedEndDateTime").clone(); a = _.find([u, h, p], function (e) { return d.get("date") === e.get("date") }) } a && (r && r.closedTime && moment(a.format("YYYY-MM-DD") + " " + r.closedTime, "YYYY-MM-DD HH:mm").isAfter(a) && (r.closedTime = a.format("HH:mm")), o && o.closedTime && moment(a.format("YYYY-MM-DD") + " " + o.closedTime, "YYYY-MM-DD HH:mm").isAfter(a) && (o.closedTime = a.format("HH:mm")), l && (l.closedTime = a.format("HH:mm")), c && (c.closedTime = a.format("HH:mm"))); var f = { t1: r, t8: o, t4: l, t6: c, sendTime: d }, m = y.filterProductType(f); if (0 < m.length) { _.each(m, function (e) { "人民币" === e.currencyName && (e.totalFreight = e.totalFreight + "元") }); var g = _.sortBy(m, function (e) { return -parseFloat(e.totalFreight) }); e.priceAndTime = g[0] } else e.priceAndTime = v } else e.priceAndTime = v }), b.success(e) }, filterProductType: function (e) { var t = []; return !_.isUndefined(e.t1) && e.t1.closedTime && e.sendTime.isBefore(moment(e.t1.closedTime, "HH:mm")) && t.push(e.t1), !_.isUndefined(e.t8) && e.t8.closedTime && e.sendTime.isBefore(moment(e.t8.closedTime, "HH:mm")) && t.push(e.t8), _.isUndefined(e.t4) || "1" === e.t4.destView && "1" === e.t4.orgionView && !e.t4.deliverTime || t.push(e.t4), _.isUndefined(e.t6) || t.push(e.t6), t } } } }), define("views/pages/order/normal/booking/batch/index", ["baseView", "templates", "helper", "../../../cn/bulkShipping/bulkShippingPriceAndTime", "../../../cn/bulkShipping/bulkOrderSuccess", "./peakControlFill", "const", "../../../components/bookingList/index", "./timeAndRate", "../../../bus/peakControl", "sflayer"], function (e, a, s, t, i, n, r, o, l, c) { return e.extend({ init: function (e) { this.time = e.time, this.getPickType = e.getPickType }, render: function () { this.$el.off(), this.setDestRateCode(this.model.get("receiverList")), this.bookList = new o({ el: this.$(".booking-list-wrapper"), model: this.model, list: this.model.get("receiverList"), getQueryType: this.getQueryType, currencyCode: this.getCurrencyCode(), originRateCode: this.model.get("originateAddress").countyCode, time: this.time && this.time.start ? this.time.start : this.model.get("synServerTim").format() }), l({ model: this.model, originRateCode: this.model.get("originateAddress").countyCode, getQueryType: this.getQueryType, time: this.time && this.time.start ? this.time.start : this.model.get("synServerTim").format(), success: this.renderRates.bind(this), error: this.renderErrRates.bind(this) }).getRatesData() }, whetherNeedClearance: function () { return void 0 !== _.find(this.model.get("receiverList"), function (e) { return s.isHK_MC_TW(e.locationCode) }) }, getRateCode: function (e) { return s.isHK_MC_TW(e.locationCode) ? e.cityCode : e.countyCode }, setBookingTime: function (e) { this.time = e && e.start ? e.start : this.model.get("synServerTim").format(), this.fetchPriceAndTimes() }, getQueryType: function () { return "cn" === s.getSiteLocation() ? this.isHMT ? "3" : "2" : this.isHMT ? "12" : "4" }, setDestRateCode: function (e) { _.each(e, function (e) { s.isHK_MC_TW(e.locationCode) ? e.destRateCode = e.cityCode : e.destRateCode = e.countyCode }) }, getCurrencyCode: function () { var e = this.model.get("originateAddress").locationCode; return s.getCurrencyByCode(e) }, renderRates: function (e) { this.$(".next").removeClass("disabled"); var t = this.model.get("receiverList"); _.each(t, function (t) { _.each(e, function (e) { t.destRateCode == e.destCode && (t.productName = e.priceAndTime.limitTypeName, t.productCode = e.priceAndTime.limitTypeCode, t.cargoTypeCode = e.priceAndTime.cargoTypeCode, t.expressTypeCode = e.priceAndTime.expressTypeCode, t.metaPrice = e.priceAndTime.totalFreight, t.priceAndTime = e.priceAndTime) }) }); var n = this; _.each(this.$(".rate-cell"), function (t) { var i = $(t).parents("tr").data("code"); _.each(e, function (e) { i == e.destCode && $(t).html(a.rateCell({ list: e.priceAndTime, currencyCode: n.getCurrencyCode() })) }) }), this.model.set("receiverList", t), this.$el.find(".predict-price .price").html(this.calcTotalFreight()) }, renderErrRates: function (t) { this.$(".next").removeClass("disabled"); var e = this.model.get("receiverList"); _.each(e, function (e) { e.productName = t.limitTypeName, e.productCode = t.limitTypeCode, e.cargoTypeCode = t.cargoTypeCode, e.expressTypeCode = t.expressTypeCode, e.metaPrice = "0", e.priceAndTime = e }), _.each(this.$(".rate-cell"), function (e) { $(e).html(a.rateCell({ list: t })) }), this.model.set("receiverList", e), this.$el.find(".predict-price .price").html(this.calcTotalFreight()) }, calcTotalFreight: function () { var e = this.model.get("receiverList"), t = 0; return _.each(e, function (e) { e.metaPrice = "string" == typeof e.metaPrice && -1 < e.metaPrice.indexOf("元") ? e.metaPrice.substring(0, e.metaPrice.length - 1) : e.metaPrice, t += "NaN" === parseFloat(e.metaPrice).toString() ? 0 : parseFloat(e.metaPrice) }), parseFloat(t) || "--" }, getCargoList: function (e) { return s.isHK_MC_TW(e) ? null : [{ name: "文件", uom: "", desc: "", price: "0" }] }, createOrder: function (r) { var o = this, e = this.getBpsInfoParams(), t = this.model.get("receiverList"), i = this.getCurrencyCode(); c.batch(e, t, this.model, i).then(function () { var e = layer.load(0, { shade: [.2, "#000"] }), t = o.getSubmitPostData(); sfAjax.bulkSubmitNewOrder({ data: t, success: function (e) { if (!e || 0 !== e.code || 0 === e.result.length) return o.renderFail(e); var i = e.result, n = []; _.each(i, function (e) { !e.success && n.push(e.index) }); var t = { succ: i.length - n.length, fail: n.length }; if (o.setAddressToStore(), o.saveToAddressBook(), 0 == t.succ) return layer.msg(_l("网络异常，请重新提交订单")); var a = _l("预约成功，其中${succ}条成功，${fail}条失败！"), s = layer.alert(a._p(t), { closeBtn: 0 }, function () { var e; layer.close(s), 0 == n.length ? e = null : ((e = o.getSubmitPostData()).destinationInfo = _.filter(e.destinationInfo, function (e) { return _.contains(n, e.index) }), _.each(e.destinationInfo, function (t) { var e = o.$("table tr"); _.each(e, function (e) { $(e).data("rid") == t.index && (t.rateHtml = $(e).find(".rate-cell").html()) }) })); var t = _.pluck(_.filter(i, function (e) { return !0 === e.success }), "appointmentNo"); r(t, e) }) }, error: function () { layer.msg(_l("网络异常，请重新提交订单")) }, login: { succCallback: o.createOrder.bind(this), cancelCallback: null }, complete: function () { layer.close(e) } }) }) }, renderFail: function (e) { 1 == e.code ? layer.msg(_l("运单号无效或已使用")) : 654 == e.code ? layer.msg(_l("月结账号无效")) : 651 == e.code ? layer.msg(_l("预约失败：下单时间不在服务时间范围内。")) : 652 == e.code ? layer.msg(_l("暂时不能为您提供收派件的服务，如有疑问请咨询我司热线95338。")) : 653 == e.code ? layer.msg(_l("账号异常！")) : 653 == e.code ? layer.msg(_l("系统繁忙，请重试！")) : layer.msg(_l("预约失败：信息校验不通过，请检查必填项。")) }, getSubmitPostData: function () { return { expectStartTm: this.time.start && moment(this.time.start).format("YYYY-MM-DD HH:mm:ss"), expectFinishTm: this.time.finish && moment(this.time.finish).format("YYYY-MM-DD HH:mm:ss"), selfSend: 2 === this.getPickType(), originateAddress: _.omit(this.model.get("originateAddress"), "setMark"), destinationInfo: this.getReceiversInfo() } }, getShipperData: function () { return _.extend({ memType: 0, isDefault: 0 }, _.omit(this.model.get("originateAddress"), "setMark")) }, setAddressToStore: function () { var e = JSON.stringify(this.getShipperData()); localStorage.setItem(s.getLatestSenderKey() + $.cookie("loginUser"), e) }, saveToAddressBook: function () { var t = []; if (this.model.get("originateAddress").setMark && t.push(this.getShipperData()), this.model.get("saveToAddressBook")) { var e = this.model.get("receiverList"); _.each(e, function (e) { e.setMark && t.push(_.extend({ memType: 1, isDefault: 0 }, _.omit(e, "rid", "destRateCode", "productCode", "productName", "setMark", "metaPrice", "normal", "obj", "postCode", "priceAndTime"))) }) } 0 < t.length && sfAjax.bulkSaveOrUpdateAddress({ data: t }) }, getReceiversInfo: function () { var e = this.model.get("receiverList"), n = [], a = this; return _.each(e, function (e) { var t; t = "string" == typeof e.metaPrice && -1 < e.metaPrice.indexOf("元") ? e.metaPrice.substring(0, e.metaPrice.length - 1) : "NaN" === parseFloat(e.metaPrice).toString() ? 0 : e.metaPrice; var i = { index: e.rid, destinationAddress: _.omit(e, "rid", "destRateCode", "productCode", "productName", "setMark", "cargoTypeCode", "expressTypeCode", "priceAndTime", "index", "obj"), remark: 1 === a.getPickType() ? a.choosedMsg : "", productCode: e.productCode, productName: e.productName.substring(0, 20), metaWeight: "tw" === s.getSiteLocation() || "hk" === s.getSiteLocation() ? "0.5" : "1", metaPrice: t, cargoList: a.getCargoList(e.locationCode), custom: null, paymethod: 1, custid: "", supportValue: "", premium: "", controlStrategy: e.obj ? e.obj.controlStrategy : "", notificationMsg: e.obj ? e.obj.notificationMsg : "", selfPickUpFlag: e.selfPick }; i.appointFlow = s.getFlowCode(e.locationCode, a.model.get("senderLocationCityCode")), n.push(i) }), n }, getBpsInfoParams: function () { var e = this.model.get("originateAddress"), t = { channelCode: "PC.OWF" }; t.srcZoneCode = e.locationCode, t.consignedTm = this.time && this.time.start ? moment(this.time.start).format("YYYY-MM-DD HH:mm:ss") : moment(this.model.get("synServerTim")).format("YYYY-MM-DD HH:mm:ss"); for (var i = [], n = 0; n < this.model.get("receiverList").length; n++) { var a = {}; this.model.get("receiverList")[n].index = n + 1, a.index = n + 1, a.customerType = 1, a.customerCode = e.contactTel, a.destZoneCode = this.model.get("receiverList")[n].locationCode, a.limitTypeCode = this.model.get("receiverList")[n].productCode, a.cargoTypeCode = this.model.get("receiverList")[n].cargoTypeCode, a.expressTypeCode = this.model.get("receiverList")[n].expressTypeCode, i.push(a) } return t.destBpsInfoList = i, t } }) }), define("views/pages/order/normal/booking/index", ["baseView", "templates", "helper", "event", "components/detailDateTimePicker/pickupTimePicker", "../success/single/index", "../success/batch/index", "const", "./internation", "./single/index", "./batch/index"], function (e, t, n, i, a, s, r, o, l, c, d) { return e.extend({ template: t.order_normal_booking, internation: l, events: { "change #date": "bookingTimeChanged", "click .prev": "prevStep", "click .next": "nextStep", "click .term": "showTerm", "click #agree-term-content": "agreeTermToggle", "click .pick-type a": "pickTypeToggle" }, init: function () { this.type = 1 === this.model.get("receiverList").length ? "single" : "batch", this.senderOutRange = this.model.get("senderOutRange"), this.model.getServerCurrentTime(), this.model.getCityWorkingTime({ cityCode: this.model.get("senderLocationCityCode"), address: this.model.get("originateAddress").address }) }, render: function () { this.$el.off(), this.$el.html(this.template({ showToggle: !1, senderOutRange: this.senderOutRange, type: this.type })), this.initPickUpType(), this.pickupTimePicker = new a({ el: this.$(".pickup-time"), serverTime: this.model.get("synServerTim"), dateTimes: this.model.get("dateTimes") }), this.initialDateTime = this.pickupTimePicker.getDateTime(), "single" === this.type ? this.bookComp = new c({ el: this.$el, model: this.model, time: this.initialDateTime, getPickType: this.getPickType.bind(this) }) : this.bookComp = new d({ el: this.$el, model: this.model, time: this.initialDateTime, getPickType: this.getPickType.bind(this) }) }, getPickType: function () { return this.pickType }, bookingTimeChanged: function () { var e = 1 === this.pickType ? this.pickupTimePicker.getDateTime() : this.initialDateTime; this.bookComp.setBookingTime(e) }, initPickUpType: function () { var e = this; this.pickType = this.senderOutRange ? 2 : 1, this.senderOutRange && (this.$(".on-door").find(".icon").removeClass("aicon-radio-active").addClass("aicon-radio"), this.$(".by-self").find(".icon").removeClass("aicon-radio").addClass("aicon-radio-active"), this.$(".show-on-door").fadeOut(function () { e.$(".show-by-self").fadeIn() })) }, pickTypeToggle: function (e) { var t = this.$(e.currentTarget), i = this; t.hasClass("on-door") && 1 === this.pickType || t.hasClass("by-self") && 2 === this.pickType || (t.hasClass("on-door") && this.senderOutRange ? layer.alert(_l("您的寄件地址只支持自寄下单，如需选择快递员上门取件可修改您的寄件地址")) : (t.hasClass("on-door") ? (this.pickType = 1, this.$(".show-by-self").fadeOut(function () { i.$(".show-on-door").fadeIn() })) : (this.pickType = 2, this.$(".show-on-door").fadeOut(function () { i.$(".show-by-self").fadeIn() })), t.children(".icon").removeClass("aicon-radio").addClass("aicon-radio-active").end().siblings("a").children(".icon").removeClass("aicon-radio-active").addClass("aicon-radio"))) }, prevStep: function () { this.options.scrollable.seekTo(1) }, nextStep: function () { this.$("#agree-term-content").hasClass("active") ? this.checkToOrder() : this.showTerm() }, showTerm: function (t) { $(window).resize(function () { $("iframe").css("height", $(this).height() - 200) }); var e = n.getURLWithContext("other/modal/order_terms.html"), i = this; layer.open({ title: _l("电子运单契约条款"), type: 2, area: ["960px"], offset: "40px", content: [e, "no"], btn: _l("我已阅读该条款，同意遵守"), yes: function (e) { i.$("#agree-term-content").addClass("active"), t || i.checkToOrder(), layer.close(e) } }), $(window).resize() }, agreeTermToggle: function (e) { this.$(e.currentTarget).toggleClass("active") }, checkToOrder: function () { $.cookie("loginUser") ? this.onSubmitOrder() : i.trigger(i.Needlogin, { succCallback: this.onSubmitOrder.bind(this), cancelCallback: null }) }, getCurrencyCode: function () { var e = this.model.get("originateAddress").locationCode; return n.getCurrencyByCode(e) }, onSubmitOrder: function () { var i = this; this.bookComp.createOrder(function (e, t) { void 0 !== t ? new r({ el: $(".booking-succ"), failSubmitData: t, synServerTim: i.model.get("synServerTim"), appointmentNoList: e, currencyCode: i.getCurrencyCode(), selfSend: 2 === i.pickType }) : new s({ el: $(".booking-succ"), synServerTim: i.model.get("synServerTim"), appointmentNo: e, waybillNo: null, selfSend: 2 === i.pickType }), i.options.scrollable.seekTo(3) }) } }) }), define("views/pages/order/normal/receiver/internation", ["bus/address/index"], function (n) { return { tw: { validate: function () { var e = this.model.get("originateAddress").customerId, t = this.model.get("receiverList"), i = !1; return _.each(t, function (e) { n.isTW(e.locationCode) || (i = !0) }), !(i && !e) || (layer.msg(_l("出口件需填寫寄方統一編號/身分證字號，請於寄件人頁面填寫")), !1) } } } }), define("views/pages/order/normal/receiver/form/index", ["baseView", "components/addressForm/index", "bus/address/index"], function (e, i, n) { return e.extend({ events: { "click .delete": "deleteReceiver" }, init: function () { this.addressForms = [], this.addOne() }, validate: function () { var t = !0; return _.each(this.addressForms, function (e) { e.isAllNull() || e.validateshipper() || (t = !1) }), t }, getListData: function () { var i = []; if (!this.validate()) return null; var n = 0; return _.each(this.addressForms, function (e) { if (!e.isAllNull()) { var t = e.getShipperData(); t.rid = n++ , i.push(t) } }), i }, addOne: function () { var e = $('<div class="receiver-wrap"><i class="aicon-delete2 delete"></i><div class="receiver"></div></div>'), t = new i({ el: e.find(".receiver"), config: { support: "ML_HK_MC_TW", fillOption: "receiver", rIndex: !0, nearBy: !1, customID: { text: "收件统编", placeholder: "公司請填寫統一編號，個人請填寫身份證字號(大陸正式報關/D類必填)", hide: !0 } }, locationChange: function (e) { t.showCustomID(!n.isTW(e)) } }); this.$el.append(e), e.find(".receiver").show(), e.slideDown("fast"), this.addressForms.push(t), 1 === this.addressForms.length && e.find(".delete").remove(), this.renderIndex() }, deleteReceiver: function (e) { var t = this, i = $(e.currentTarget).parent(), n = i.prevAll(".receiver-wrap").length, a = layer.confirm(_l("您确定要删除该收件人？"), { noStop: !0, btn: [_l("确定"), _l("取消")] }, function () { i.remove(), t.addressForms.splice(n, 1), t.renderIndex(), layer.close(a) }, function () { layer.close(a) }) }, renderIndex: function () { 1 == this.addressForms.length ? this.addressForms[0].showIndex(null) : _.each(this.addressForms, function (e, t) { e.showIndex(t) }) } }) }), define("views/pages/order/normal/receiver/list/index", ["baseView", "templates", "components/addressBook/bulkShippingReceiverModify", "../../../cn/bulkShipping/receiverInfo/topAddOneReceiver"], function (e, t, n, i) { return e.extend({ template: t.renderReceiverList, events: { "click .l-modify": "modifyReceiver", "click .l-delete": "deleteReceiver", "click .only-issues": "onlyIssuesItems" }, init: function (e) { this.$el.off(), this.onlyIssues = !1, this.list = e.list }, validate: function () { return !0 }, getListData: function () { return this.list }, addOne: function () { var t = this; new i({ callback: function (e) { t.list.push(e), t.render() } }) }, render: function () { var e; void 0 === _.find(this.list, function (e) { return !1 === e.normal }) ? (this.onlyIssues = !1, this.$(".only-issues").removeClass("aicon-check").addClass("aicon-uncheck"), e = !1) : e = !0; var t = 0; this.receivers = [], _.each(this.list, function (e) { e.rid = t, t += 1 }), this.$el.html(this.template({ rList: this.list, onlyIssues: this.onlyIssues, showOnlyIssues: e })), this.$(".drop-down-wrapper").show(), this.$(".btn_nav .dropdown").hide(), this.onlyIssues && this.$(".normal").hide() }, deleteReceiver: function (e) { var t = this.$(e.currentTarget).parents("tr").data("rid"), i = _l("您确定要删除该收件人？"), n = this, a = layer.confirm(i, { noStop: !0, btn: [_l("确定"), _l("取消")] }, function () { n.list = _.reject(n.list, function (e) { return e.rid === t }), 0 === n.list.length ? n.options.emptyCallback() : n.render(!0), layer.close(a) }, function () { layer.close(a) }) }, modifyReceiver: function (e) { var t = $(e.currentTarget).parents("tr").data("rid"), i = _.findWhere(this.list, { rid: t }); new n({ addressBook: i, callback: this.modifyReceiverSucc.bind(this) }), e.stopPropagation() }, modifyReceiverSucc: function (t) { _.each(this.list, function (e) { e.rid === t.rid && (_.extend(e, t, { normal: !0, changed: !0 }), delete e.selfPick) }), this.render() }, onlyIssuesItems: function (e) { this.$(e.currentTarget).hasClass("aicon-check") ? (this.$(e.currentTarget).removeClass("aicon-check").addClass("aicon-uncheck"), this.onlyIssues = !1, this.$(".normal").show()) : (this.$(e.currentTarget).removeClass("aicon-uncheck").addClass("aicon-check"), this.onlyIssues = !0, this.$(".normal").hide()), "hk" === Helper.getSiteLocation() ? sfgather.trackClicks("点击收方信息列表页面仅显示错误地址前选项框", "XWF010213") : sfgather.trackClicks("点击收方信息列表页面仅显示错误地址前选项框", "OWF010213") } }) }), define("views/pages/order/normal/receiver/index", ["baseView", "templates", "event", "helper", "../booking/index", "bus/address/index", "./internation", "./form/index", "./list/index", "components/addressBook/bulkShippingAddressBook", "../../cn/bulkShipping/receiverInfo/excelTemplate", "sflayer"], function (e, t, i, a, n, s, r, o, l, c, d) { return e.extend({ template: t.order_normal_receiver, internation: r, events: { "click .prev": "prevStep", "click .next": "nextStep", "click .add-one": "addOneReiceiver", "click .add-from-addressBook": "addFromAddressBook", "click .add-from-excel": "showExcelTemplate", "click .save-address-check": "toggleSaveAddress", "click .add-more": "addMoreReiceiver" }, init: function () { this.region = a.getSiteLocation(), this.receivers = [], this.model.set("receiverList", []), this.model.set("saveToAddressBook", !0) }, render: function () { this.$el.html(this.template()), this.switch("form") }, switch: function (e) { switch (e) { case "form": this.$(".receiver-container").empty(), this.$(".drop-down-wrapper").hide(), this.$(".btn_nav .dropdown").show(), this.dataComponent = new o({ el: this.$(".receiver-container"), list: this.receivers }); break; case "list": this.$(".drop-down-wrapper").show(), this.$(".btn_nav .dropdown").hide(), this.dataComponent = new l({ el: this.$(".receiver-container"), list: this.receivers, emptyCallback: this.switch.bind(this, "form") }) } }, addOneReiceiver: function () { this.dataComponent.addOne() }, addFromAddressBook: function (e) { var t = this; if (this.dataComponent.validate()) if ($.cookie("loginUser")) { if (this.isLocked(e)) return; sfAjax.fetchAddressBookList({ data: { pageNo: 1, rowCount: "8", condition: "" }, success: function (e) { e && 0 == e.code ? t.newAddressBookView(e) : layer.msg(_l("网络错误")) }, error: function () { layer.msg(_l("网络错误")) }, complete: function () { t.unlock(e) }, login: { succCallback: t.addFromAddressBook.bind(this), cancelCallback: null } }) } else i.trigger(i.Needlogin, { succCallback: this.addFromAddressBook.bind(this), cancelCallback: null }) }, newAddressBookView: function (e) { var i = this; new c({ addressBooks: e.result.content, totalPage: e.result.totalPage, page: e.result.pageNo, callback: function (e) { var t = i.dataComponent.getListData(); t.push(e), t = _.flatten(t), i.receivers = t, i.switch("list") } }) }, showExcelTemplate: function () { if (this.dataComponent.validate()) { var t = this; new d({ callback: function (e) { t.receivers = t.dataComponent.getListData(), _.each(e, function (e) { e.address.message = e.message, e.address.normal = e.normal, e.address.country = e.address.country || "中国", e.address.countryCode = e.address.countryCode || "A000086000" }), t.receivers.push(_.pluck(e, "address")), t.receivers = _.flatten(t.receivers), t.switch("list") } }) } }, prevStep: function () { this.options.scrollable.seekTo(0) }, validate: function () { return !0 }, nextStep: function () { var e, t = this; if ((e = this.dataComponent.getListData()) && (this.model.set("receiverList", e), this.validate())) if (this.hasIssuesItems(e)) var i = layer.confirm(_l("怎样处理错误的地址？"), { noStop: !0, btn: [_l("直接删除"), _l("返回编辑")] }, function () { var e = t.model.get("receiverList"); e = _.reject(e, function (e) { return !1 === e.normal }), t.model.set("receiverList", e), t.dataComponent.list = e, t.dataComponent.render(), layer.close(i), t.batchQueryAddressRange() }, function () { layer.close(i) }); else this.batchQueryAddressRange() }, batchQueryAddressRange: function () { if (this.limitReceivers()) { var e = this.model.get("receiverList"), t = {}, i = []; _.each(e, function (e) { e.addressId && !e.changed || (e.setMark = !0); var t = {}; t.index = e.rid, t.address = e.province + e.city + e.county + e.address, t.dataType = "r01", i.push(t) }), this.model.set("receiverList", e), t.addressRangeReqs = i; var a = this, n = layer.load(); sfAjax.batchQueryAddressRange({ data: t, success: function (e) { if (e && 0 === e.code && 0 < e.result.length) { var t = a.model.get("receiverList"); _.each(t, function (t) { _.each(e.result, function (e) { e.index === t.rid && (t.state = e.state) }) }), a.model.set("receiverList", t); var i = _.filter(e.result, function (e) { return 1 === e.state }), n = _.filter(t, function (e) { return !0 === e.selfPick }); 0 < i.length && i.length !== n.length ? new OutRange({ model: a.model, callbackGoNextStep: a.goNextStep.bind(a) }) : (_.each(t, function (e) { delete e.state }), a.goNextStep()) } }, error: function () { a.goNextStep() }, complete: function () { layer.close(n) } }) } }, goNextStep: function () { this.isOutRangeAndDeclare() ? layer.alert(_l("您的收件地址中包含出口件地址，无法使用自寄下单，请修改")) : (this.goBookingInfo(), this.options.scrollable.seekTo(2)) }, isOutRangeAndDeclare: function () { var t = this.model.get("senderLocationCityCode"), e = a.isHK_MC(t), i = _.filter(this.model.get("receiverList"), function (e) { return a.isHK_MC(e.locationCode) }), n = _.filter(this.model.get("receiverList"), function (e) { return t != e.locationCode }); return this.model.get("senderOutRange") && !(!e && 0 == i.length || e && 0 < n.length) }, limitReceivers: function () { var e = this.model.get("receiverList").length; if (100 < e) layer.alert(_l("收件人超过100条，不能下单！")); else { if (0 != e) return !0; layer.alert(_l("收件人不能为空！")) } }, goBookingInfo: function () { new n({ el: $(".booking-info"), model: this.model, scrollable: this.options.scrollable }) }, toggleSaveAddress: function (e) { this.$(e.currentTarget).toggleClass("checked"), this.$(e.currentTarget).hasClass("checked") ? this.model.set("saveToAddressBook", !0) : this.model.set("saveToAddressBook", !1), "hk" === a.getSiteLocation() ? sfgather.trackClicks("点击保存到地址簿单选按钮", "XWF010203") : sfgather.trackClicks("点击保存到地址簿单选按钮", "OWF010203") }, addMoreReiceiver: function () { "hk" === a.getSiteLocation() ? sfgather.trackClicks("点击+多个收件人", "XWF010204") : sfgather.trackClicks("点击+多个收件人", "OWF010204") }, hasIssuesItems: function (e) { return !!_.find(e, function (e) { return !1 === e.normal }) } }) }), define("views/pages/order/normal/sender/index", ["baseView", "templates", "components/addressForm/index", "../receiver/index"], function (e, t, i, n) { return e.extend({ template: t.order_normal_sender, events: { "click .next": "nextStep" }, render: function () { var t = this; this.$el.html(this.template()), this.sender = new i({ el: this.$(".sender"), config: { warmReminder: "溫馨提示：下單後需自行聯繫收派員或自寄，暫不支持預約收派員上門收件", support: "TW", nearBy: !1, customID: { text: "寄件統編(出口件必須填寫)", placeholder: "公司請填寫統一編號，個人請填寫身份證字號" } }, locationChange: function (e) { t.model.set("senderLocationCityCode", e) } }), this.initSenderDefaultAddressItem() }, initSenderDefaultAddressItem: function () { var t = this; if ($.cookie("loginUser")) { var i = !1; sfAjax.fetchDefaultAndFirstAddress({ success: function (e) { e && 0 === e.code && (_.isEmpty(e.result) || (i = !0, t.sender.fillBackInfo(e.result))) }, complete: function () { if (!i) { var e = t.getAddressFromStore(); e && t.sender.fillBackInfo(e) } } }) } }, judgeInfo: function (e) { Helper.isTW(e.locationCode) && this.sender.fillBackInfo(e) }, getAddressFromStore: function () { var t = localStorage.getItem(Helper.getLatestSenderKey() + $.cookie("loginUser")); try { t = JSON.parse(t) } catch (e) { t = null } return t }, nextStep: function () { var e = this; if (this.sender.validateshipper()) if (this.sender.notOutRange) this.gotoReceiver(); else var t = layer.confirm(_l("亲,您的寄件地址我司暂时无法上门收取件,您可以修改为其他地址,如仍继续将会为您选中自寄下单"), { title: _l("温馨提示"), btn: [_l("修改地址"), _l("继续下单")] }, function () { layer.close(t) }, function () { layer.close(t), e.gotoReceiver() }) }, gotoReceiver: function () { this.model.set("senderOutRange", !this.sender.notOutRange), this.model.set("originateAddress", this.sender.getShipperData()), this.receiverInfo || (this.receiverInfo = new n({ el: $(".receiver-info"), model: this.model, scrollable: this.options.scrollable })), this.options.scrollable.seekTo(1) } }) }), define("views/pages/order/normal/internation", ["utils/grayScale"], function (t) { return { tw: { interceptor: { run: function () { var e = $.Deferred(); return t.isScale(t.GRAY_TYPE.TW_ORDER).done(function () { e.resolve() }).fail(function () { location.href = Helper.getDynamicURLWithContext("/send_introduced/quick/") }), e } }, mounted: function () { this.$(".receiver-areas").hide() } }, hk: { interceptor: { run: function () { var e = $.Deferred(); return t.isScale(t.GRAY_TYPE.HK_ORDER).done(function () { e.resolve() }).fail(function () { location.href = Helper.getDynamicURLWithContext("/send_introduced/quick/") }), e } } } } }), define("views/pages/order/normal/index", ["baseView", "templates", "models/cityWorkingTime", "./sender/index", "./internation", "jquery-scrollable"], function (e, t, i, n, a) { return e.extend({ template: t.order_normal, internation: a, init: function () { this.$el.off(), this.model = new i }, render: function () { this.$el.html(this.template()), this.initScrollable(), new n({ el: this.$(".sender-info"), model: this.model, scrollable: this.scrollable }), this.$(".order-service").show() }, initScrollable: function () { var i = this; this.$(".bulkShipping").scrollable({ onBeforeSeek: function (e, t) { i.$(".items .page").eq(t).addClass("active") }, onSeek: function (e, t) { i.$(".step li").removeClass("active").eq(t).addClass("active"), i.$(".items .page").removeClass("active").eq(t).addClass("active") } }), this.scrollable = this.$(".bulkShipping").scrollable() } }) }), define("components/operators/perfect/index", ["baseView", "bus/index", "components/changeAppointBill/changeAppointBill", "components/changeAppointBill/changeAppointBillHeavyCargo", "components/changeAppointBill/changeAppointBillHmt"], function (e, t, s, r, o) { function i() { var a = this; sfAjax.queryAppointBill({ data: { appointmentNo: this.appointmentNo }, success: function (e) { if (e.success) { var t = e.appointmentDetail, i = { billInfo: t, callback: a.success }; if ("cn" === Helper.getSiteLocation()) if (Helper.isHK_MC_TW(t.appointmentDestDetail.locationCode)) new o(i); else { var n = t.productInfo.code; -1 < ["T1", "T104", "T8", "T801", "T4", "T6"].indexOf(n) ? new s(i) : -1 < ["SE0100", "SE0101"].indexOf(n) && new r(i) } else t.appointmentOriginDetail.locationCode == t.appointmentDestDetail.locationCode ? new s(i) : new o(i) } else layer.msg(_l("该预约单暂不支持修改")) }, error: function () { layer.msg(_l("网络错误")) }, complete: function () { a.complete && a.complete() }, login: { succCallback: this.prefect.bind(this), cancelCallback: function () { layer.msg(_l("修改失败")) } } }) } return function (e) { this.appointmentNo = e.data.appointmentNo, this.success = e.success, this.complete = e.complete, this.prefect = i, this.prefect() } }), define("components/operators/cancel/index", ["baseView", "templates"], function (e, t) { return e.extend({ template: t.cancelAppointBill, layerOpts: { title: _l("温馨提示"), area: ["480px", "564px"], skin: "line" }, events: { "click .reason-items a": "chooseItem", "click .btn-wrapper .select-confirm": "confirm", "click .btn-wrapper .select-cancel": "cancel" }, init: function (e) { this.appointmentNo = e.data.appointmentNo, this.pickupType = e.data.pickupType, e.complete && e.complete() }, render: function () { this.$el.html(this.template()); var e = this.$(".reason-items").find(".aicon-circle-check.checked")[0]; this.cusReason = $(e).next()[0].innerText }, chooseItem: function (e) { e.stopPropagation(); var t = $(e.currentTarget), i = this.$(".reason-items").find(".aicon-circle-check.checked"); _.each(i, function (e) { $(e).removeClass("checked") }), t.children(".aicon-circle-check").hasClass("checked") || (t.children(".aicon-circle-check").addClass("checked"), this.cusReason = t.children(".item-text")[0].innerText) }, confirm: function (e) { e.stopPropagation(); var t = this; sfAjax.cancelAppointmentBill({ data: { appointmentNo: this.appointmentNo, pickupType: this.pickupType, cusReason: this.cusReason }, success: function (e) { 0 === e.code ? (layer.msg(_l("订单已取消")), t.options.success()) : layer.msg(_l("该包裹已揽收或者取消，取消寄件失败")) }, error: function () { layer.msg(_l("订单取消失败")) }, complete: function () { t.cancel() } }) }, cancel: function (e) { this.$el.parent().parent().find(".layui-layer-close").trigger("click"), this.options.complete && this.options.complete() } }) }), define("utils/mapLoader", [], function () { var a = { gaode: { url: _cmsConfig.mapSrc, getMap: function () { return window.AMap }, loading: !1, cbs: [], errors: [] }, google: { url: _cmsConfig.googleSrc, getMap: function () { return window.google }, loading: !1, cbs: [], errors: [] } }; return { load: function (e, t, i) { "string" != typeof e && (i = t, t = e, e = "cn" === Helper.getSiteLocation() ? "gaode" : "google"), t = t || function () { }; var n = a[e]; if (n) if (n.getMap()) t(n.getMap()); else { if (n.cbs.push(t), n.errors.push(i), n.loading) return; n.loading = !0, sfAjax.getScript({ url: n.url, success: function () { _.each(n.cbs, function (e) { e(n.getMap()) }) }, error: function () { _.each(n.errors, function (e) { e() }) }, complete: function () { n.loading = !1 } }) } } } }), define("views/query/appointment/map", ["utils/mapLoader"], function (n) { return { init: function (e, t, i) { this.context = e, this.address = t, this.city = i, n.load(this.callback.bind(this)) }, callback: function (t) { var i = this; sfAjax.getLocalByAddress({ params: { cc: 1, address: this.address, exact: 1, city: this.city, ak: _webConfig.gisKey, span: 1 }, success: function (e) { t === window.AMap ? i.initGaodeMap(e) : t === window.google && i.initGoogleMap(e) } }) }, initGaodeMap: function (e) { if (0 !== e.result.xcoord || 0 !== e.result.ycoord) { var t = new AMap.Map("map1", { center: [e.result.xcoord, e.result.ycoord], zoom: 11, scrollWheel: !1 }); AMap.plugin(["AMap.ToolBar", "AMap.Geolocation"], function () { t.addControl(new AMap.ToolBar), t.addControl(new AMap.Geolocation) }); var i = new AMap.Marker({ position: [e.result.xcoord, e.result.ycoord] }), n = new AMap.Pixel(30, -5); new AMap.InfoWindow({ content: this.context.$(".delivery-map-hide").html(), offset: n }).open(t, i.getPosition()) } else new AMap.Map("map1", { zoom: 2, scrollWheel: !1 }) }, initGoogleMap: function (e) { function t(e, t) { this.position = e, t.classList.add("popup-bubble-content"); var i = document.createElement("div"); i.classList.add("popup-bubble-anchor"), i.appendChild(t), this.anchor = document.createElement("div"), this.anchor.classList.add("popup-tip-anchor"), this.anchor.appendChild(i) } if ((t.prototype = Object.create(google.maps.OverlayView.prototype)).onAdd = function () { this.getPanes().floatPane.appendChild(this.anchor) }, t.prototype.draw = function () { var e = this.getProjection().fromLatLngToDivPixel(this.position), t = Math.abs(e.x) < 4e3 && Math.abs(e.y) < 4e3 ? "block" : "none"; "block" === t && (this.anchor.style.left = e.x + "px", this.anchor.style.top = e.y - $(this.anchor).height() + "px"), this.anchor.style.display !== t && (this.anchor.style.display = t) }, 0 !== e.result.xcoord || 0 !== e.result.ycoord) { var i = new google.maps.LatLng(e.result.ycoord, e.result.xcoord), n = new google.maps.Map(this.context.$("#map1")[0], { center: i, zoom: 11, mapTypeId: google.maps.MapTypeId.ROADMAP }); new t(i, $(this.context.$(".delivery-map-hide").html())[0]).setMap(n) } else new google.maps.Map(this.context.$("#map1")[0], { zoom: 2, mapTypeId: google.maps.MapTypeId.ROADMAP }) } } }), define("bus/query/operate", ["../index", "const"], function (i, t) { function n(e, t) { return t && i.isSender(e.billType) && -1 < ["2", "3", "4", "8", "9"].indexOf(e.waybillStatus) ? e.sendEvaluate ? "evaluated" : "evaluate" : !t && "4" === e.waybillStatus && e.endTime ? e.recEvaluate ? "evaluated" : "evaluate" : void 0 } return { cancel: { text: "取消预约", judge: function (e) { return !i.isSecurityExpress(e) && (-1 < [0, 1, 40038, 40039].indexOf(e.appointmentStatue) || e.pickupType === t.CCS5_SEND && "7" !== e.status) }, icon: "aicon-bs-refused", maidian: 115007 }, delete: { text: "删除", judge: function (e) { return "4" === e.waybillStatus || ("8" === e.waybillStatus || "9" === e.waybillStatus) && i.isUntreadBill(e.modifiedType) || ("2" === e.waybillStatus || "3" === e.waybillStatus) && i.isUntreadBill(e.modifiedType) && i.isMyBill(e.billType) || -1 < [7, 12, 4001, 40042, 40044].indexOf(e.appointmentStatue) || e.pickupType === t.CCS5_SEND && "7" === e.status }, icon: "aicon-bs-delete" }, change: { text: "改派", judge: function (e, t) { return -1 < ["2", "3", "8", "9"].indexOf(e.waybillStatus) && !t && !(Helper.isHK_MC_TW(e.destCityCode) || Helper.isInternational(e.destCityCode)) && "SE0006" !== e.productType && "SE0021" !== e.productType && "0" !== e.isIssuedPrefrence && !i.isSecurityExpress(e) && "en" !== Helper.getSiteLanguage() }, icon: "aicon-change-deliver" }, perfect: { text: "完善信息", judge: function (e) { return !i.isSecurityExpress(e) && (0 === e.appointmentStatue || 1 === e.appointmentStatue || e.pickupType === t.CCS5_SEND && "7" !== e.status) }, icon: "aicon-bs-edit" }, digital: { text: "查看电子运单", judge: function (e) { return e.waybillno && (0 === e.appointmentStatue || 1 === e.appointmentStatue) }, icon: "aicon-qrcode" }, evaluate: { text: "服务评价", judge: function (e, t) { return "evaluate" === n(e, t) }, icon: "aicon-agree", className: "red" }, evaluated: { text: "服务评价", judge: function (e, t) { return "evaluated" === n(e, t) }, icon: "aicon-agree" } } }), define("views/query/appointment/billDetails", ["baseView", "templates", "components/operators/perfect/index", "event", "components/operators/cancel/index", "helper", "components/newBillOptions/showBillDetail", "./map", "const", "bus/query/operate"], function (e, i, n, t, a, s, r, o, l, c) { return e.extend({ template: { exception: i.query_exception, closed: i.query_detail_appoint_closed, normalAppoint: i.query_detail_appoint_normal, scanAppoint: i.query_detail_appoint_scan }, events: { "click .cancel-btn": "cancel", "click .modify-btn": "modify", "click .login-btn": "login", "click .reload-btn": "doRequestVip" }, init: function (e) { this.$el.off(), this.appointmentNo = e.appointmentNo, $.cookie("loginUser") || this.renderError("noLogin"), this.doRequestVip() }, doRequestVip: function (e, t) { var i = this, n = layer.load(); sfAjax.queryAppointBill({ data: { appointmentNo: this.appointmentNo }, success: function (e) { i.handleAppoinmentData(e), i.renderAppoinment(); var t = i.originDetail.city; s.isHK_MC_TW(i.originDetail.locationCode) && (t = i.originDetail.province), o.init(i, i.originDetail.address, t) }, error: function () { i.renderError() }, complete: function () { t && t(), layer.close(n) }, login: { succCallback: this.doRequestVip.bind(this), cancelCallback: null } }) }, isHideCargoService: function (e) { return "cn" !== s.getSiteLocation() || s.isHK_MC_TW(e) }, handleAppoinmentData: function (e) { var t = e.appointmentDetail, i = this.viewType = this.getViewType(t.state, t.pickupType); this.originDetail = t.appointmentOriginDetail; var n = r.afterProcessingDetail(t); if (this.model = { waybillNo: t.waybillNo, appointmentNo: e.appointmentNo, originOld: t.appointmentOriginDetail.city, destinationOld: t.appointmentDestDetail.city, pickupType: t.pickupType, hideCargoService: this.isHideCargoService(t.appointmentDestDetail.locationCode), info: n, canCancel: c.cancel.judge({ pickupType: t.pickupType, appointmentStatue: t.state, status: t.state + "" }), canPerfect: c.perfect.judge({ pickupType: t.pickupType, appointmentStatue: t.state, status: t.state + "" }) }, "closed" === i) _.extend(this.model, { statusText: this.getClosedText(t.state), modifyDate: moment(t.modifyTime).format("MM-DD "), modifyTime: moment(t.modifyTime).format("HH:mm"), orderUrl: s.getDynamicURLWithContext("/order/quick/") }); else if ("scanAppoint" === i) _.extend(this.model, {}); else if ("normalAppoint" === i) { var a = this.getOutDoorTime(t); _.extend(this.model, { resoure: t.resoure, date: a.format("MM-DD "), time: a.format("HH:mm") }) } }, renderAppoinment: function () { var e = this.template[this.viewType]; if (e) { var t = $('<div class="delivery appointment-delivery"></div>'); this.$el.html(t), t.html(e(this.model)), this.$(".show-bill-detail").html(i.showBillDetail(this.model)) } else this.renderError() }, renderError: function (e) { e = e || "noAppointmentInfo", this.$el.html(this.template.exception({ type: e })) }, getViewType: function (e, t) { return 5 == e || 10 == e ? "sendOut" : 7 == e || 12 == e ? "closed" : 3 == t ? "scanAppoint" : "normalAppoint" }, getOutDoorTime: function (e) { var t; return t = e.expectStartTm ? e.expectStartTm : e.appointmentTime, moment(t).add("hour", 1) }, getClosedText: function (e) { return "7" == e ? "已取消" : "已关闭" }, cancel: function (e) { new a({ data: { appointmentNo: this.model.appointmentNo, pickupType: this.model.pickupType }, success: this.doRequestVip.bind(this) }) }, modify: function (e) { var t = this; this.isLocked(e) || new n({ data: { appointmentNo: t.model.appointmentNo }, success: this.doRequestVip.bind(this), complete: function () { t.unlock(e) } }) }, login: function () { var e = this; t.trigger(t.impNeedlogin, { succCallback: function () { e.doRequestVip() }, cancelCallback: null }) } }) }), define("plugins/tencentCaptcha", ["helper"], function (i) { return { initCap: function () { return i.getRESTfulDomain("captcha/getJsUrl") }, show: function (e) { var t = { callback: e, showHeader: !0, lang: "sc" == i.getSiteLanguage() ? 2052 : "tc" == i.getSiteLanguage() ? 1028 : 1033, pos: "fixed", themeColor: "000000", type: "popup", end: function () { $("#modal_captcha").hide() } }; $("#modal_captcha").show(), capInit(document.getElementById("TCaptcha"), t) }, refresh: function (e) { capDestroy(), this.show(e) }, captcha: function (t) { var i = this; "function" != typeof capDestroy ? Backbone.ajax({ type: "GET", url: this.initCap(), success: function (e) { sfAjax.getScript({ url: e, success: function () { i.capScriptAjaxsuccess(t) }, error: function () { layer.msg(_l("查询异常，请稍后再试")) }, complete: function (e, t) { "timeout" == t && layer.msg(_l("查询超时，请稍后再试")) } }) }, error: function () { layer.msg(_l("查询异常，请稍后再试")) } }) : i.capScriptAjaxsuccess(t) }, capScriptAjaxsuccess: function (t) { this.refresh(function (e) { 0 == e.ret && t(e) }) } } }), define("views/query/waybill/baseBillManager", ["baseView", "templates", "sflayer", "plugins/tencentCaptcha", "event"], function (e, r, s, i, t) { return e.extend({ template: r.query_exception, events: { "click .reload-btn": "requestData" }, init: function (e) { this.$el.empty(), this.items = [], this.vip = e.vip, this.billIds = e.billIds, this.customInit(), this.requestData(), this.listenTo(t, "mapModelChange", this.mapModelChange), this.mapModel = this.getMapModel() }, getMapModel: function () { return "hk" === Helper.getSiteLocation() || "tw" === Helper.getSiteLocation() ? ($(".openMapModel").hide(), !1) : this.vip ? ($(".openMapModel").hide(), !0) : ($(".openMapModel").show(), $(".bill-title .openMapModel input[type='checkbox']").prop("checked")) }, requestData: function (e) { e && e.stopPropagation(); var t = this; this.vip ? this.doRequestVip({ id: this.billIds }) : i.captcha(function (e) { t.doRequest(t.billIds, e.ticket) }) }, doRequest: function (t, e, i) { var n = this, a = s.load(); this.resetItems(), sfAjax.routes({ data: { billNumbers: t, ticket: e, app: "bill" }, success: function (e) { 500 === e.code ? n.$el.html(n.template({ type: "noAppointmentInfo" })) : n.render(t, n.handleData(e)) }, error: function () { n.$el.html(n.template({ type: "noAppointmentInfo" })) }, complete: function () { i && i(), s.close(a) } }) }, doRequestVip: function (t, e) { var i = this, n = s.load(); this.resetItems(), sfAjax.getBillDetailByNum({ data: { id: t.id }, success: function (e) { 0 === e.code ? i.render(t.id, i.handleData([e.result])) : 600 === e.code ? i.render(t.id, i.handleData([])) : 500 === e.code && i.$el.html(i.template({ type: "noAppointmentInfo" })) }, error: function () { i.$el.html(i.template({ type: "noAppointmentInfo" })) }, complete: function () { e && e(), s.close(n) } }) }, handleData: function (e) { var t = this; return e = _.map(e, function (e) { return t.parse(e) }), _.filter(e, function (e) { return null !== e }) }, parse: function (n) { if (!n) return null; var e = ["运单资料&签收图", "運單資料&簽收圖", "AWB Info & POD"]; return n.routes = _.filter(n.routes, function (t) { var i = !0; return _.each(e, function (e) { -1 < t.remark.indexOf(e) && (n.signed = !0, i = !1) }), i }), 0 === n.routes.length ? null : (n.routes = _.sortBy(n.routes, function (e) { return e.scanDateTime }).reverse(), n) }, resetItems: function () { this.$el.empty() }, render: function (e, a) { if (e) { var s = this; e = e instanceof Array ? e : e.split(","), _.each(e, function (t, e) { var i = _.find(a, function (e) { return e.id === t }); if (i) { var n = $('<div class="delivery"></div>'); 0 !== e && $(n).addClass("waybill-detail"), s.$el.append(n), s.renderItem(n, i, e) } else s.$el.append(r.waybillNotFound({ billNumber: t })) }) } }, mapModelChange: function (e) { e ? (this.$(".delivery-item").removeClass("brief-model"), _.each(this.items, function (e) { e.createMap() })) : this.$(".delivery-item").addClass("brief-model") } }) }), define("popHeightView", ["./baseView", "utils/stringUtils", "templates"], function (e, n, a) { var s; return e.extend({ modalOpts: {}, initialize: function (e) { var t = this, i = "open-" + n.uuid(10); $("body").append(a.modal({ id: i, title: this.layerOpts.title })), (s = $("#" + i)).on("hidden.bs.modal", function () { $(this).remove() }), this.$el = s.find(".modal-body"), this.internationMixin(), this.interceptor ? this.interceptor.run().done(function () { t._init(e) }) : this._init(e) }, show: function () { s.modal("show") }, heightChange: function () { s.modal("handleUpdate") }, close: function () { s.modal("hide") } }) }), jQuery.fn.rotate = function (e, t) { var i = this.get(0); if (i.angle = t ? e : ((null == i.angle ? 0 : i.angle) + e) % 360, 0 <= i.angle) var n = Math.PI * i.angle / 180; else n = Math.PI * (360 + i.angle) / 180; var a = Math.round(1e3 * Math.cos(n)) / 1e3, s = Math.round(1e3 * Math.sin(n)) / 1e3; if (document.all && !window.opera) { (r = document.createElement("img")).src = i.src, r.height = i.height, r.width = i.width, r.style.filter = "progid:DXImageTransform.Microsoft.Matrix(M11=" + a + ",M12=" + -s + ",M21=" + s + ",M22=" + a + ",SizingMethod='auto expand')" } else { var r = document.createElement("canvas"); i.oImage ? r.oImage = i.oImage : (r.oImage = new Image, r.oImage.src = i.src), r.style.width = r.width = Math.abs(a * r.oImage.width) + Math.abs(s * r.oImage.height), r.style.height = r.height = Math.abs(a * r.oImage.height) + Math.abs(s * r.oImage.width); var o = r.getContext("2d"); o.save(), n <= Math.PI / 2 ? o.translate(s * r.oImage.height, 0) : n <= Math.PI ? o.translate(r.width, -a * r.oImage.height) : n <= 1.5 * Math.PI ? o.translate(-a * r.oImage.width, r.height) : o.translate(0, -s * r.oImage.width), o.rotate(n), o.drawImage(r.oImage, 0, 0, r.oImage.width, r.oImage.height), o.restore() } r.id = i.id, r.angle = i.angle, i.parentNode.replaceChild(r, i) }, jQuery.fn.rotateRight = function (e) { this.rotate(null == e ? 90 : e) }, jQuery.fn.rotateLeft = function (e) { this.rotate(null == e ? -90 : -e) }, define("JqueryRotate", function () { }), function (i) { function n(e) { if (a[e]) return a[e].exports; var t = a[e] = { i: e, l: !1, exports: {} }; return i[e].call(t.exports, t, t.exports, n), t.l = !0, t.exports } var a = {}; n.m = i, n.c = a, n.i = function (e) { return e }, n.d = function (e, t, i) { n.o(e, t) || Object.defineProperty(e, t, { configurable: !1, enumerable: !0, get: i }) }, n.n = function (e) { var t = e && e.__esModule ? function () { return e.default } : function () { return e }; return n.d(t, "a", t), t }, n.o = function (e, t) { return Object.prototype.hasOwnProperty.call(e, t) }, n.p = "", n(n.s = 19) }([function (e, t, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); t.default = function e(t, i) { (function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") })(this, e), this.data = t, this.text = i.text || t, this.options = i } }, function (e, t, i) { "use strict"; function n(e, t, i) { return t in e ? Object.defineProperty(e, t, { value: i, enumerable: !0, configurable: !0, writable: !0 }) : e[t] = i, e } Object.defineProperty(t, "__esModule", { value: !0 }); var a, s = t.SET_A = 0, r = t.SET_B = 1, o = t.SET_C = 2, l = (t.SHIFT = 98, t.START_A = 103), c = t.START_B = 104, d = t.START_C = 105; t.MODULO = 103, t.STOP = 106, t.FNC1 = 207, t.SET_BY_CODE = (n(a = {}, l, s), n(a, c, r), n(a, d, o), a), t.SWAP = { 101: s, 100: r, 99: o }, t.A_START_CHAR = String.fromCharCode(208), t.B_START_CHAR = String.fromCharCode(209), t.C_START_CHAR = String.fromCharCode(210), t.A_CHARS = "[\0-_È-Ï]", t.B_CHARS = "[ -È-Ï]", t.C_CHARS = "(Ï*[0-9]{2}Ï*)", t.BARS = [11011001100, 11001101100, 11001100110, 10010011e3, 10010001100, 10001001100, 10011001e3, 10011000100, 10001100100, 11001001e3, 11001000100, 11000100100, 10110011100, 10011011100, 10011001110, 10111001100, 10011101100, 10011100110, 11001110010, 11001011100, 11001001110, 11011100100, 11001110100, 11101101110, 11101001100, 11100101100, 11100100110, 11101100100, 11100110100, 11100110010, 11011011e3, 11011000110, 11000110110, 10100011e3, 10001011e3, 10001000110, 10110001e3, 10001101e3, 10001100010, 11010001e3, 11000101e3, 11000100010, 10110111e3, 10110001110, 10001101110, 10111011e3, 10111000110, 10001110110, 11101110110, 11010001110, 11000101110, 11011101e3, 11011100010, 11011101110, 11101011e3, 11101000110, 11100010110, 11101101e3, 11101100010, 11100011010, 11101111010, 11001000010, 11110001010, 1010011e4, 10100001100, 1001011e4, 10010000110, 10000101100, 10000100110, 1011001e4, 10110000100, 1001101e4, 10011000010, 10000110100, 10000110010, 11000010010, 1100101e4, 11110111010, 11000010100, 10001111010, 10100111100, 10010111100, 10010011110, 10111100100, 10011110100, 10011110010, 11110100100, 11110010100, 11110010010, 11011011110, 11011110110, 11110110110, 10101111e3, 10100011110, 10001011110, 10111101e3, 10111100010, 11110101e3, 11110100010, 10111011110, 10111101110, 11101011110, 11110101110, 11010000100, 1101001e4, 11010011100, 1100011101011] }, function (e, t, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.SIDE_BIN = "101", t.MIDDLE_BIN = "01010", t.BINARIES = { L: ["0001101", "0011001", "0010011", "0111101", "0100011", "0110001", "0101111", "0111011", "0110111", "0001011"], G: ["0100111", "0110011", "0011011", "0100001", "0011101", "0111001", "0000101", "0010001", "0001001", "0010111"], R: ["1110010", "1100110", "1101100", "1000010", "1011100", "1001110", "1010000", "1000100", "1001000", "1110100"], O: ["0001101", "0011001", "0010011", "0111101", "0100011", "0110001", "0101111", "0111011", "0110111", "0001011"], E: ["0100111", "0110011", "0011011", "0100001", "0011101", "0111001", "0000101", "0010001", "0001001", "0010111"] }, t.EAN2_STRUCTURE = ["LL", "LG", "GL", "GG"], t.EAN5_STRUCTURE = ["GGLLL", "GLGLL", "GLLGL", "GLLLG", "LGGLL", "LLGGL", "LLLGG", "LGLGL", "LGLLG", "LLGLG"], t.EAN13_STRUCTURE = ["LLLLLL", "LLGLGG", "LLGGLG", "LLGGGL", "LGLLGG", "LGGLLG", "LGGGLL", "LGLGLG", "LGLGGL", "LGGLGL"] }, function (e, t, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = i(2); t.default = function (i, n, a) { var e = i.split("").map(function (e, t) { return r.BINARIES[n[t]] }).map(function (e, t) { return e ? e[i[t]] : "" }); if (a) { var s = i.length - 1; e = e.map(function (e, t) { return t < s ? e + a : e }) } return e.join("") } }, function (e, t, i) { "use strict"; function a(e, t) { for (var i = 0; i < t; i++)e = "0" + e; return e } Object.defineProperty(t, "__esModule", { value: !0 }); var n, s = function () { function n(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (e, t, i) { return t && n(e.prototype, t), i && n(e, i), e } }(), r = i(0), o = (n = r) && n.__esModule ? n : { default: n }, l = function (e) { function i(e, t) { return function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, i), function (e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t }(this, (i.__proto__ || Object.getPrototypeOf(i)).call(this, e, t)) } return function (e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(i, o.default), s(i, [{ key: "encode", value: function () { for (var e = "110", t = 0; t < this.data.length; t++) { var i = parseInt(this.data[t]).toString(2); i = a(i, 4 - i.length); for (var n = 0; n < i.length; n++)e += "0" == i[n] ? "100" : "110" } return { data: e += "1001", text: this.text } } }, { key: "valid", value: function () { return -1 !== this.data.search(/^[0-9]+$/) } }]), i }(); t.default = l }, function (e, t, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var n = Object.assign || function (e) { for (var t = 1; t < arguments.length; t++) { var i = arguments[t]; for (var n in i) Object.prototype.hasOwnProperty.call(i, n) && (e[n] = i[n]) } return e }; t.default = function (e, t) { return n({}, e, t) } }, function (e, t, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var n, a = function () { function n(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (e, t, i) { return t && n(e.prototype, t), i && n(e, i), e } }(), s = i(0), r = (n = s) && n.__esModule ? n : { default: n }, l = i(1), o = function (e) { function o(e, t) { !function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, o); var i = function (e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t }(this, (o.__proto__ || Object.getPrototypeOf(o)).call(this, e.substring(1), t)); return i.bytes = e.split("").map(function (e) { return e.charCodeAt(0) }), i } return function (e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(o, r.default), a(o, [{ key: "valid", value: function () { return /^[\x00-\x7F\xC8-\xD3]+$/.test(this.data) } }, { key: "encode", value: function () { var e = this.bytes, t = e.shift() - 105, i = l.SET_BY_CODE[t]; if (void 0 === i) throw new RangeError("The encoding does not start with a start character."); !0 === this.shouldEncodeAsEan128() && e.unshift(l.FNC1); var n = o.next(e, 1, i); return { text: this.text === this.data ? this.text.replace(/[^\x20-\x7E]/g, "") : this.text, data: o.getBar(t) + n.result + o.getBar((n.checksum + t) % l.MODULO) + o.getBar(l.STOP) } } }, { key: "shouldEncodeAsEan128", value: function () { var e = this.options.ean128 || !1; return "string" == typeof e && (e = "true" === e.toLowerCase()), e } }], [{ key: "getBar", value: function (e) { return l.BARS[e] ? l.BARS[e].toString() : "" } }, { key: "correctIndex", value: function (e, t) { if (t === l.SET_A) { var i = e.shift(); return i < 32 ? i + 64 : i - 32 } return t === l.SET_B ? e.shift() - 32 : 10 * (e.shift() - 48) + e.shift() - 48 } }, { key: "next", value: function (e, t, i) { if (!e.length) return { result: "", checksum: 0 }; var n = void 0, a = void 0; if (200 <= e[0]) { a = e.shift() - 105; var s = l.SWAP[a]; void 0 !== s ? n = o.next(e, t + 1, s) : (i !== l.SET_A && i !== l.SET_B || a !== l.SHIFT || (e[0] = i === l.SET_A ? 95 < e[0] ? e[0] - 96 : e[0] : e[0] < 32 ? e[0] + 96 : e[0]), n = o.next(e, t + 1, i)) } else a = o.correctIndex(e, i), n = o.next(e, t + 1, i); var r = a * t; return { result: o.getBar(a) + n.result, checksum: r + n.checksum } } }]), o }(); t.default = o }, function (e, t, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.mod10 = function (e) { for (var t = 0, i = 0; i < e.length; i++) { var n = parseInt(e[i]); (i + e.length) % 2 == 0 ? t += n : t += 2 * n % 10 + Math.floor(2 * n / 10) } return (10 - t % 10) % 10 }, t.mod11 = function (e) { for (var t = 0, i = [2, 3, 4, 5, 6, 7], n = 0; n < e.length; n++)t += i[n % i.length] * parseInt(e[e.length - 1 - n]); return (11 - t % 11) % 11 } }, function (e, t, i) { "use strict"; function a(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") } function s(e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t } function r(e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) } Object.defineProperty(t, "__esModule", { value: !0 }); var n = function (e) { function n(e, t) { a(this, n); var i = s(this, (n.__proto__ || Object.getPrototypeOf(n)).call(this)); return i.name = "InvalidInputException", i.symbology = e, i.input = t, i.message = '"' + i.input + '" is not a valid input for ' + i.symbology, i } return r(n, Error), n }(), o = function (e) { function t() { a(this, t); var e = s(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this)); return e.name = "InvalidElementException", e.message = "Not supported type to render on", e } return r(t, Error), t }(), l = function (e) { function t() { a(this, t); var e = s(this, (t.__proto__ || Object.getPrototypeOf(t)).call(this)); return e.name = "NoElementException", e.message = "No element to render on.", e } return r(t, Error), t }(); t.InvalidInputException = n, t.InvalidElementException = o, t.NoElementException = l }, function (e, t, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.default = function (e) { var t = ["width", "height", "textMargin", "fontSize", "margin", "marginTop", "marginBottom", "marginLeft", "marginRight"]; for (var i in t) t.hasOwnProperty(i) && "string" == typeof e[i = t[i]] && (e[i] = parseInt(e[i], 10)); return "string" == typeof e.displayValue && (e.displayValue = "false" != e.displayValue), e } }, function (e, t, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); t.default = { width: 2, height: 100, format: "auto", displayValue: !0, fontOptions: "", font: "monospace", text: void 0, textAlign: "center", textPosition: "bottom", textMargin: 2, fontSize: 20, background: "#ffffff", lineColor: "#000000", margin: 10, marginTop: void 0, marginBottom: void 0, marginLeft: void 0, marginRight: void 0, valid: function () { } } }, function (e, t, i) { "use strict"; function n(e) { return e && e.__esModule ? e : { default: e } } Object.defineProperty(t, "__esModule", { value: !0 }); var a = function () { function n(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (e, t, i) { return t && n(e.prototype, t), i && n(e, i), e } }(), s = i(2), r = n(i(3)), o = n(i(0)), l = function (e) { function n(e, t) { !function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, n); var i = function (e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t }(this, (n.__proto__ || Object.getPrototypeOf(n)).call(this, e, t)); return i.fontSize = !t.flat && t.fontSize > 10 * t.width ? 10 * t.width : t.fontSize, i.guardHeight = t.height + i.fontSize / 2 + t.textMargin, i } return function (e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(n, o.default), a(n, [{ key: "encode", value: function () { return this.options.flat ? this.encodeFlat() : this.encodeGuarded() } }, { key: "leftText", value: function (e, t) { return this.text.substr(e, t) } }, { key: "leftEncode", value: function (e, t) { return (0, r.default)(e, t) } }, { key: "rightText", value: function (e, t) { return this.text.substr(e, t) } }, { key: "rightEncode", value: function (e, t) { return (0, r.default)(e, t) } }, { key: "encodeGuarded", value: function () { var e = { fontSize: this.fontSize }, t = { height: this.guardHeight }; return [{ data: s.SIDE_BIN, options: t }, { data: this.leftEncode(), text: this.leftText(), options: e }, { data: s.MIDDLE_BIN, options: t }, { data: this.rightEncode(), text: this.rightText(), options: e }, { data: s.SIDE_BIN, options: t }] } }, { key: "encodeFlat", value: function () { return { data: [s.SIDE_BIN, this.leftEncode(), s.MIDDLE_BIN, this.rightEncode(), s.SIDE_BIN].join(""), text: this.text } } }]), n }(); t.default = l }, function (e, t, i) { "use strict"; function n(e) { return e && e.__esModule ? e : { default: e } } function a(e) { var t, i = 0; for (t = 1; t < 11; t += 2)i += parseInt(e[t]); for (t = 0; t < 11; t += 2)i += 3 * parseInt(e[t]); return (10 - i % 10) % 10 } Object.defineProperty(t, "__esModule", { value: !0 }); var s = function () { function n(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (e, t, i) { return t && n(e.prototype, t), i && n(e, i), e } }(); t.checksum = a; var r = n(i(3)), o = n(i(0)), l = function (e) { function n(e, t) { (function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") })(this, n), -1 !== e.search(/^[0-9]{11}$/) && (e += a(e)); var i = function (e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t }(this, (n.__proto__ || Object.getPrototypeOf(n)).call(this, e, t)); return i.displayValue = t.displayValue, t.fontSize > 10 * t.width ? i.fontSize = 10 * t.width : i.fontSize = t.fontSize, i.guardHeight = t.height + i.fontSize / 2 + t.textMargin, i } return function (e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(n, o.default), s(n, [{ key: "valid", value: function () { return -1 !== this.data.search(/^[0-9]{12}$/) && this.data[11] == a(this.data) } }, { key: "encode", value: function () { return this.options.flat ? this.flatEncoding() : this.guardedEncoding() } }, { key: "flatEncoding", value: function () { var e = ""; return e += "101", e += (0, r.default)(this.data.substr(0, 6), "LLLLLL"), e += "01010", e += (0, r.default)(this.data.substr(6, 6), "RRRRRR"), { data: e += "101", text: this.text } } }, { key: "guardedEncoding", value: function () { var e = []; return this.displayValue && e.push({ data: "00000000", text: this.text.substr(0, 1), options: { textAlign: "left", fontSize: this.fontSize } }), e.push({ data: "101" + (0, r.default)(this.data[0], "L"), options: { height: this.guardHeight } }), e.push({ data: (0, r.default)(this.data.substr(1, 5), "LLLLL"), text: this.text.substr(1, 5), options: { fontSize: this.fontSize } }), e.push({ data: "01010", options: { height: this.guardHeight } }), e.push({ data: (0, r.default)(this.data.substr(6, 5), "RRRRR"), text: this.text.substr(6, 5), options: { fontSize: this.fontSize } }), e.push({ data: (0, r.default)(this.data[11], "R") + "101", options: { height: this.guardHeight } }), this.displayValue && e.push({ data: "00000000", text: this.text.substr(11, 1), options: { textAlign: "right", fontSize: this.fontSize } }), e } }]), n }(); t.default = l }, function (e, t, i) { "use strict"; function l(e, t) { return t.height + (t.displayValue && 0 < e.text.length ? t.fontSize + t.textMargin : 0) + t.marginTop + t.marginBottom } function c(e, t, i) { if (i.displayValue && t < e) { if ("center" == i.textAlign) return Math.floor((e - t) / 2); if ("left" == i.textAlign) return 0; if ("right" == i.textAlign) return Math.floor(e - t) } return 0 } function d(e, t, i) { var n; if (i) n = i; else { if ("undefined" == typeof document) return 0; n = document.createElement("canvas").getContext("2d") } return n.font = t.fontOptions + " " + t.fontSize + "px " + t.font, n.measureText(e).width } Object.defineProperty(t, "__esModule", { value: !0 }), t.getTotalWidthOfEncodings = t.calculateEncodingAttributes = t.getBarcodePadding = t.getEncodingHeight = t.getMaximumHeightOfEncodings = void 0; var n, a = i(5), u = (n = a) && n.__esModule ? n : { default: n }; t.getMaximumHeightOfEncodings = function (e) { for (var t = 0, i = 0; i < e.length; i++)e[i].height > t && (t = e[i].height); return t }, t.getEncodingHeight = l, t.getBarcodePadding = c, t.calculateEncodingAttributes = function (e, t, i) { for (var n = 0; n < e.length; n++) { var a, s = e[n], r = (0, u.default)(t, s.options); a = r.displayValue ? d(s.text, r, i) : 0; var o = s.data.length * r.width; s.width = Math.ceil(Math.max(a, o)), s.height = l(s, r), s.barcodePadding = c(a, o, r) } }, t.getTotalWidthOfEncodings = function (e) { for (var t = 0, i = 0; i < e.length; i++)t += e[i].width; return t } }, function (e, t, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var n = i(26), a = i(25), s = i(32), r = i(35), o = i(34), l = i(40), c = i(42), d = i(41), u = i(33); t.default = { CODE39: n.CODE39, CODE128: a.CODE128, CODE128A: a.CODE128A, CODE128B: a.CODE128B, CODE128C: a.CODE128C, EAN13: s.EAN13, EAN8: s.EAN8, EAN5: s.EAN5, EAN2: s.EAN2, UPC: s.UPC, UPCE: s.UPCE, ITF14: r.ITF14, ITF: o.ITF, MSI: l.MSI, MSI10: l.MSI10, MSI11: l.MSI11, MSI1010: l.MSI1010, MSI1110: l.MSI1110, pharmacode: c.pharmacode, codabar: d.codabar, GenericBarcode: u.GenericBarcode } }, function (e, t, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var n = function () { function n(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (e, t, i) { return t && n(e.prototype, t), i && n(e, i), e } }(), a = function () { function t(e) { (function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") })(this, t), this.api = e } return n(t, [{ key: "handleCatch", value: function (e) { if ("InvalidInputException" !== e.name) throw e; if (this.api._options.valid === this.api._defaults.valid) throw e.message; this.api._options.valid(!1), this.api.render = function () { } } }, { key: "wrapBarcodeCall", value: function (e) { try { var t = e.apply(void 0, arguments); return this.api._options.valid(!0), t } catch (e) { return this.handleCatch(e), this.api } } }]), t }(); t.default = a }, function (e, t, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.default = function (e) { return e.marginTop = e.marginTop || e.margin, e.marginBottom = e.marginBottom || e.margin, e.marginRight = e.marginRight || e.margin, e.marginLeft = e.marginLeft || e.margin, e } }, function (e, t, i) { "use strict"; function n(e) { return e && e.__esModule ? e : { default: e } } function s(e) { if ("string" == typeof e) return function (e) { var t = document.querySelectorAll(e); if (0 !== t.length) { for (var i = [], n = 0; n < t.length; n++)i.push(s(t[n])); return i } }(e); if (Array.isArray(e)) { for (var t = [], i = 0; i < e.length; i++)t.push(s(e[i])); return t } if ("undefined" != typeof HTMLCanvasElement && e instanceof HTMLImageElement) return n = e, { element: a = document.createElement("canvas"), options: (0, o.default)(n), renderer: l.default.CanvasRenderer, afterRender: function () { n.setAttribute("src", a.toDataURL()) } }; var n, a; if (e && "svg" === e.nodeName || "undefined" != typeof SVGElement && e instanceof SVGElement) return { element: e, options: (0, o.default)(e), renderer: l.default.SVGRenderer }; if ("undefined" != typeof HTMLCanvasElement && e instanceof HTMLCanvasElement) return { element: e, options: (0, o.default)(e), renderer: l.default.CanvasRenderer }; if (e && e.getContext) return { element: e, renderer: l.default.CanvasRenderer }; if (e && "object" === (void 0 === e ? "undefined" : r(e)) && !e.nodeName) return { element: e, renderer: l.default.ObjectRenderer }; throw new c.InvalidElementException } Object.defineProperty(t, "__esModule", { value: !0 }); var r = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (e) { return typeof e } : function (e) { return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e }, o = n(i(43)), l = n(i(45)), c = i(8); t.default = s }, function (e, t, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.default = function (e) { var n = []; return function e(t) { if (Array.isArray(t)) for (var i = 0; i < t.length; i++)e(t[i]); else t.text = t.text || "", t.data = t.data || "", n.push(t) }(e), n } }, function (e, t, i) { "use strict"; function n(e) { return e && e.__esModule ? e : { default: e } } function l(e, t, i) { var n = new t(e = "" + e, i); if (!n.valid()) throw new f.InvalidInputException(n.constructor.name, e); var a = n.encode(); a = (0, o.default)(a); for (var s = 0; s < a.length; s++)a[s].options = (0, c.default)(i, a[s].options); return a } function a() { return r.default.CODE128 ? "CODE128" : Object.keys(r.default)[0] } function s(e, t, i) { t = (0, o.default)(t); for (var n = 0; n < t.length; n++)t[n].options = (0, c.default)(i, t[n].options), (0, d.default)(t[n].options); (0, d.default)(i), new e.renderer(e.element, t, i).render(), e.afterRender && e.afterRender() } var r = n(i(14)), c = n(i(5)), o = n(i(18)), d = n(i(16)), u = n(i(17)), h = n(i(9)), p = n(i(15)), f = i(8), m = n(i(10)), g = function () { }, _ = function (e, t, i) { var n = new g; if (void 0 === e) throw Error("No element to render on was provided."); return n._renderProperties = (0, u.default)(e), n._encodings = [], n._options = m.default, n._errorHandler = new p.default(n), void 0 !== t && ((i = i || {}).format || (i.format = a()), n.options(i)[i.format](t, i).render()), n }; for (var v in _.getModule = function (e) { return r.default[e] }, r.default) r.default.hasOwnProperty(v) && function (r, o) { g.prototype[o] = g.prototype[o.toUpperCase()] = g.prototype[o.toLowerCase()] = function (n, a) { var s = this; return s._errorHandler.wrapBarcodeCall(function () { a.text = void 0 === a.text ? void 0 : "" + a.text; var e = (0, c.default)(s._options, a); e = (0, h.default)(e); var t = r[o], i = l(n, t, e); return s._encodings.push(i), s }) } }(r.default, v); g.prototype.options = function (e) { return this._options = (0, c.default)(this._options, e), this }, g.prototype.blank = function (e) { var t = new Array(e + 1).join("0"); return this._encodings.push({ data: t }), this }, g.prototype.init = function () { var t; if (this._renderProperties) for (var e in Array.isArray(this._renderProperties) || (this._renderProperties = [this._renderProperties]), this._renderProperties) { t = this._renderProperties[e]; var i = (0, c.default)(this._options, t.options); "auto" == i.format && (i.format = a()), this._errorHandler.wrapBarcodeCall(function () { var e = l(i.value, r.default[i.format.toUpperCase()], i); s(t, e, i) }) } }, g.prototype.render = function () { if (!this._renderProperties) throw new f.NoElementException; if (Array.isArray(this._renderProperties)) for (var e = 0; e < this._renderProperties.length; e++)s(this._renderProperties[e], this._encodings, this._options); else s(this._renderProperties, this._encodings, this._options); return this }, g.prototype._defaults = m.default, "undefined" != typeof window && (window.JsBarcode = _), "undefined" != typeof jQuery && (jQuery.fn.JsBarcode = function (e, t) { var i = []; return jQuery(this).each(function () { i.push(this) }), _(i, e, t) }), e.exports = _ }, function (e, t, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var n, a = function () { function n(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (e, t, i) { return t && n(e.prototype, t), i && n(e, i), e } }(), s = i(6), r = (n = s) && n.__esModule ? n : { default: n }, o = i(1), l = function (e) { function i(e, t) { return function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, i), function (e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t }(this, (i.__proto__ || Object.getPrototypeOf(i)).call(this, o.A_START_CHAR + e, t)) } return function (e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(i, r.default), a(i, [{ key: "valid", value: function () { return new RegExp("^" + o.A_CHARS + "+$").test(this.data) } }]), i }(); t.default = l }, function (e, t, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var n, a = function () { function n(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (e, t, i) { return t && n(e.prototype, t), i && n(e, i), e } }(), s = i(6), r = (n = s) && n.__esModule ? n : { default: n }, o = i(1), l = function (e) { function i(e, t) { return function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, i), function (e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t }(this, (i.__proto__ || Object.getPrototypeOf(i)).call(this, o.B_START_CHAR + e, t)) } return function (e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(i, r.default), a(i, [{ key: "valid", value: function () { return new RegExp("^" + o.B_CHARS + "+$").test(this.data) } }]), i }(); t.default = l }, function (e, t, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var n, a = function () { function n(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (e, t, i) { return t && n(e.prototype, t), i && n(e, i), e } }(), s = i(6), r = (n = s) && n.__esModule ? n : { default: n }, o = i(1), l = function (e) { function i(e, t) { return function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, i), function (e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t }(this, (i.__proto__ || Object.getPrototypeOf(i)).call(this, o.C_START_CHAR + e, t)) } return function (e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(i, r.default), a(i, [{ key: "valid", value: function () { return new RegExp("^" + o.C_CHARS + "+$").test(this.data) } }]), i }(); t.default = l }, function (e, t, i) { "use strict"; function n(e) { return e && e.__esModule ? e : { default: e } } function a(e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t } Object.defineProperty(t, "__esModule", { value: !0 }); var s = n(i(6)), r = n(i(24)), o = function (e) { function n(e, t) { if (function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, n), /^[\x00-\x7F\xC8-\xD3]+$/.test(e)) var i = a(this, (n.__proto__ || Object.getPrototypeOf(n)).call(this, (0, r.default)(e), t)); else i = a(this, (n.__proto__ || Object.getPrototypeOf(n)).call(this, e, t)); return a(i) } return function (e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(n, s.default), n }(); t.default = o }, function (e, t, i) { "use strict"; function s(e, t) { var i = t ? o.A_CHARS : o.B_CHARS, n = e.match(new RegExp("^(" + i + "+?)(([0-9]{2}){2,})([^0-9]|$)")); if (n) return n[1] + String.fromCharCode(204) + r(e.substring(n[1].length)); var a = e.match(new RegExp("^" + i + "+"))[0]; return a.length === e.length ? e : a + String.fromCharCode(t ? 205 : 206) + s(e.substring(a.length), !t) } function r(e) { var t = c(e), i = t.length; if (i === e.length) return e; e = e.substring(i); var n = a(e) >= l(e); return t + String.fromCharCode(n ? 206 : 205) + s(e, n) } Object.defineProperty(t, "__esModule", { value: !0 }); var o = i(1), a = function (e) { return e.match(new RegExp("^" + o.A_CHARS + "*"))[0].length }, l = function (e) { return e.match(new RegExp("^" + o.B_CHARS + "*"))[0].length }, c = function (e) { return e.match(new RegExp("^" + o.C_CHARS + "*"))[0] }; t.default = function (e) { var t = void 0; if (2 <= c(e).length) t = o.C_START_CHAR + r(e); else { var i = a(e) > l(e); t = (i ? o.A_START_CHAR : o.B_START_CHAR) + s(e, i) } return t.replace(/[\xCD\xCE]([^])[\xCD\xCE]/, function (e, t) { return String.fromCharCode(203) + t }) } }, function (e, t, i) { "use strict"; function n(e) { return e && e.__esModule ? e : { default: e } } Object.defineProperty(t, "__esModule", { value: !0 }), t.CODE128C = t.CODE128B = t.CODE128A = t.CODE128 = void 0; var a = n(i(23)), s = n(i(20)), r = n(i(21)), o = n(i(22)); t.CODE128 = a.default, t.CODE128A = s.default, t.CODE128B = r.default, t.CODE128C = o.default }, function (e, t, i) { "use strict"; function a(e) { return t = s(e), u[t].toString(2); var t } function s(e) { return d.indexOf(e) } Object.defineProperty(t, "__esModule", { value: !0 }), t.CODE39 = void 0; var n, r = function () { function n(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (e, t, i) { return t && n(e.prototype, t), i && n(e, i), e } }(), o = i(0), l = (n = o) && n.__esModule ? n : { default: n }, c = function (e) { function n(e, t) { return function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, n), e = e.toUpperCase(), t.mod43 && (e += (i = function (e) { for (var t = 0, i = 0; i < e.length; i++)t += s(e[i]); return t % 43 }(e), d[i])), function (e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t }(this, (n.__proto__ || Object.getPrototypeOf(n)).call(this, e, t)); var i } return function (e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(n, l.default), r(n, [{ key: "encode", value: function () { for (var e = a("*"), t = 0; t < this.data.length; t++)e += a(this.data[t]) + "0"; return { data: e += a("*"), text: this.text } } }, { key: "valid", value: function () { return -1 !== this.data.search(/^[0-9A-Z\-\.\ \$\/\+\%]+$/) } }]), n }(), d = ["0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z", "-", ".", " ", "$", "/", "+", "%", "*"], u = [20957, 29783, 23639, 30485, 20951, 29813, 23669, 20855, 29789, 23645, 29975, 23831, 30533, 22295, 30149, 24005, 21623, 29981, 23837, 22301, 30023, 23879, 30545, 22343, 30161, 24017, 21959, 30065, 23921, 22385, 29015, 18263, 29141, 17879, 29045, 18293, 17783, 29021, 18269, 17477, 17489, 17681, 20753, 35770]; t.CODE39 = c }, function (e, t, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var n, a = function () { function n(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (e, t, i) { return t && n(e.prototype, t), i && n(e, i), e } }(), s = function e(t, i, n) { null === t && (t = Function.prototype); var a = Object.getOwnPropertyDescriptor(t, i); if (void 0 === a) { var s = Object.getPrototypeOf(t); return null === s ? void 0 : e(s, i, n) } if ("value" in a) return a.value; var r = a.get; return void 0 !== r ? r.call(n) : void 0 }, r = i(2), o = i(11), l = (n = o) && n.__esModule ? n : { default: n }, c = function (e) { return (10 - e.substr(0, 12).split("").map(function (e) { return +e }).reduce(function (e, t, i) { return i % 2 ? e + 3 * t : e + t }, 0) % 10) % 10 }, d = function (e) { function n(e, t) { (function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") })(this, n), -1 !== e.search(/^[0-9]{12}$/) && (e += c(e)); var i = function (e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t }(this, (n.__proto__ || Object.getPrototypeOf(n)).call(this, e, t)); return i.lastChar = t.lastChar, i } return function (e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(n, l.default), a(n, [{ key: "valid", value: function () { return -1 !== this.data.search(/^[0-9]{13}$/) && +this.data[12] === c(this.data) } }, { key: "leftText", value: function () { return s(n.prototype.__proto__ || Object.getPrototypeOf(n.prototype), "leftText", this).call(this, 1, 6) } }, { key: "leftEncode", value: function () { var e = this.data.substr(1, 6), t = r.EAN13_STRUCTURE[this.data[0]]; return s(n.prototype.__proto__ || Object.getPrototypeOf(n.prototype), "leftEncode", this).call(this, e, t) } }, { key: "rightText", value: function () { return s(n.prototype.__proto__ || Object.getPrototypeOf(n.prototype), "rightText", this).call(this, 7, 6) } }, { key: "rightEncode", value: function () { var e = this.data.substr(7, 6); return s(n.prototype.__proto__ || Object.getPrototypeOf(n.prototype), "rightEncode", this).call(this, e, "RRRRRR") } }, { key: "encodeGuarded", value: function () { var e = s(n.prototype.__proto__ || Object.getPrototypeOf(n.prototype), "encodeGuarded", this).call(this); return this.options.displayValue && (e.unshift({ data: "000000000000", text: this.text.substr(0, 1), options: { textAlign: "left", fontSize: this.fontSize } }), this.options.lastChar && (e.push({ data: "00" }), e.push({ data: "00000", text: this.options.lastChar, options: { fontSize: this.fontSize } }))), e } }]), n }(); t.default = d }, function (e, t, i) { "use strict"; function n(e) { return e && e.__esModule ? e : { default: e } } Object.defineProperty(t, "__esModule", { value: !0 }); var a = function () { function n(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (e, t, i) { return t && n(e.prototype, t), i && n(e, i), e } }(), s = i(2), r = n(i(3)), o = n(i(0)), l = function (e) { function i(e, t) { return function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, i), function (e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t }(this, (i.__proto__ || Object.getPrototypeOf(i)).call(this, e, t)) } return function (e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(i, o.default), a(i, [{ key: "valid", value: function () { return -1 !== this.data.search(/^[0-9]{2}$/) } }, { key: "encode", value: function () { var e = s.EAN2_STRUCTURE[parseInt(this.data) % 4]; return { data: "1011" + (0, r.default)(this.data, e, "01"), text: this.text } } }]), i }(); t.default = l }, function (e, t, i) { "use strict"; function n(e) { return e && e.__esModule ? e : { default: e } } Object.defineProperty(t, "__esModule", { value: !0 }); var a = function () { function n(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (e, t, i) { return t && n(e.prototype, t), i && n(e, i), e } }(), s = i(2), r = n(i(3)), o = n(i(0)), l = function (e) { function i(e, t) { return function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, i), function (e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t }(this, (i.__proto__ || Object.getPrototypeOf(i)).call(this, e, t)) } return function (e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(i, o.default), a(i, [{ key: "valid", value: function () { return -1 !== this.data.search(/^[0-9]{5}$/) } }, { key: "encode", value: function () { var e, t = s.EAN5_STRUCTURE[(e = this.data, e.split("").map(function (e) { return +e }).reduce(function (e, t, i) { return i % 2 ? e + 9 * t : e + 3 * t }, 0) % 10)]; return { data: "1011" + (0, r.default)(this.data, t, "01"), text: this.text } } }]), i }(); t.default = l }, function (e, t, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var n, a = function () { function n(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (e, t, i) { return t && n(e.prototype, t), i && n(e, i), e } }(), s = function e(t, i, n) { null === t && (t = Function.prototype); var a = Object.getOwnPropertyDescriptor(t, i); if (void 0 === a) { var s = Object.getPrototypeOf(t); return null === s ? void 0 : e(s, i, n) } if ("value" in a) return a.value; var r = a.get; return void 0 !== r ? r.call(n) : void 0 }, r = i(11), o = (n = r) && n.__esModule ? n : { default: n }, l = function (e) { return (10 - e.substr(0, 7).split("").map(function (e) { return +e }).reduce(function (e, t, i) { return i % 2 ? e + t : e + 3 * t }, 0) % 10) % 10 }, c = function (e) { function i(e, t) { return function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, i), -1 !== e.search(/^[0-9]{7}$/) && (e += l(e)), function (e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t }(this, (i.__proto__ || Object.getPrototypeOf(i)).call(this, e, t)) } return function (e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(i, o.default), a(i, [{ key: "valid", value: function () { return -1 !== this.data.search(/^[0-9]{8}$/) && +this.data[7] === l(this.data) } }, { key: "leftText", value: function () { return s(i.prototype.__proto__ || Object.getPrototypeOf(i.prototype), "leftText", this).call(this, 0, 4) } }, { key: "leftEncode", value: function () { var e = this.data.substr(0, 4); return s(i.prototype.__proto__ || Object.getPrototypeOf(i.prototype), "leftEncode", this).call(this, e, "LLLL") } }, { key: "rightText", value: function () { return s(i.prototype.__proto__ || Object.getPrototypeOf(i.prototype), "rightText", this).call(this, 4, 4) } }, { key: "rightEncode", value: function () { var e = this.data.substr(4, 4); return s(i.prototype.__proto__ || Object.getPrototypeOf(i.prototype), "rightEncode", this).call(this, e, "RRRR") } }]), i }(); t.default = c }, function (e, t, i) { "use strict"; function n(e) { return e && e.__esModule ? e : { default: e } } function a(e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t } function s(e, t) { for (var i = parseInt(e[e.length - 1]), n = d[i], a = "", s = 0, r = 0; r < n.length; r++) { var o = n[r]; a += "X" === o ? e[s++] : o } return (a = "" + t + a) + (0, c.checksum)(a) } Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { function n(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (e, t, i) { return t && n(e.prototype, t), i && n(e, i), e } }(), o = n(i(3)), l = n(i(0)), c = i(12), d = ["XX00000XXX", "XX10000XXX", "XX20000XXX", "XXX00000XX", "XXXX00000X", "XXXXX00005", "XXXXX00006", "XXXXX00007", "XXXXX00008", "XXXXX00009"], u = [["EEEOOO", "OOOEEE"], ["EEOEOO", "OOEOEE"], ["EEOOEO", "OOEEOE"], ["EEOOOE", "OOEEEO"], ["EOEEOO", "OEOOEE"], ["EOOEEO", "OEEOOE"], ["EOOOEE", "OEEEOO"], ["EOEOEO", "OEOEOE"], ["EOEOOE", "OEOEEO"], ["EOOEOE", "OEEOEO"]], h = function (e) { function n(e, t) { !function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, n); var i = a(this, (n.__proto__ || Object.getPrototypeOf(n)).call(this, e, t)); if (i.isValid = !1, -1 !== e.search(/^[0-9]{6}$/)) i.middleDigits = e, i.upcA = s(e, "0"), i.text = t.text || "" + i.upcA[0] + e + i.upcA[i.upcA.length - 1], i.isValid = !0; else { if (-1 === e.search(/^[01][0-9]{7}$/)) return a(i); if (i.middleDigits = e.substring(1, e.length - 1), i.upcA = s(i.middleDigits, e[0]), i.upcA[i.upcA.length - 1] !== e[e.length - 1]) return a(i); i.isValid = !0 } return i.displayValue = t.displayValue, t.fontSize > 10 * t.width ? i.fontSize = 10 * t.width : i.fontSize = t.fontSize, i.guardHeight = t.height + i.fontSize / 2 + t.textMargin, i } return function (e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(n, l.default), r(n, [{ key: "valid", value: function () { return this.isValid } }, { key: "encode", value: function () { return this.options.flat ? this.flatEncoding() : this.guardedEncoding() } }, { key: "flatEncoding", value: function () { var e = ""; return e += "101", e += this.encodeMiddleDigits(), { data: e += "010101", text: this.text } } }, { key: "guardedEncoding", value: function () { var e = []; return this.displayValue && e.push({ data: "00000000", text: this.text[0], options: { textAlign: "left", fontSize: this.fontSize } }), e.push({ data: "101", options: { height: this.guardHeight } }), e.push({ data: this.encodeMiddleDigits(), text: this.text.substring(1, 7), options: { fontSize: this.fontSize } }), e.push({ data: "010101", options: { height: this.guardHeight } }), this.displayValue && e.push({ data: "00000000", text: this.text[7], options: { textAlign: "right", fontSize: this.fontSize } }), e } }, { key: "encodeMiddleDigits", value: function () { var e = this.upcA[0], t = this.upcA[this.upcA.length - 1], i = u[parseInt(t)][parseInt(e)]; return (0, o.default)(this.middleDigits, i) } }]), n }(); t.default = h }, function (e, t, i) { "use strict"; function n(e) { return e && e.__esModule ? e : { default: e } } Object.defineProperty(t, "__esModule", { value: !0 }), t.UPCE = t.UPC = t.EAN2 = t.EAN5 = t.EAN8 = t.EAN13 = void 0; var a = n(i(27)), s = n(i(30)), r = n(i(29)), o = n(i(28)), l = n(i(12)), c = n(i(31)); t.EAN13 = a.default, t.EAN8 = s.default, t.EAN5 = r.default, t.EAN2 = o.default, t.UPC = l.default, t.UPCE = c.default }, function (e, t, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.GenericBarcode = void 0; var n, a = function () { function n(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (e, t, i) { return t && n(e.prototype, t), i && n(e, i), e } }(), s = i(0), r = (n = s) && n.__esModule ? n : { default: n }, o = function (e) { function i(e, t) { return function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, i), function (e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t }(this, (i.__proto__ || Object.getPrototypeOf(i)).call(this, e, t)) } return function (e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(i, r.default), a(i, [{ key: "encode", value: function () { return { data: "10101010101010101010101010101010101010101", text: this.text } } }, { key: "valid", value: function () { return !0 } }]), i }(); t.GenericBarcode = o }, function (e, t, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.ITF = void 0; var n, a = function () { function n(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (e, t, i) { return t && n(e.prototype, t), i && n(e, i), e } }(), s = i(0), r = (n = s) && n.__esModule ? n : { default: n }, o = function (e) { function n(e, t) { !function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, n); var i = function (e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t }(this, (n.__proto__ || Object.getPrototypeOf(n)).call(this, e, t)); return i.binaryRepresentation = { 0: "00110", 1: "10001", 2: "01001", 3: "11000", 4: "00101", 5: "10100", 6: "01100", 7: "00011", 8: "10010", 9: "01010" }, i } return function (e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(n, r.default), a(n, [{ key: "valid", value: function () { return -1 !== this.data.search(/^([0-9]{2})+$/) } }, { key: "encode", value: function () { for (var e = "1010", t = 0; t < this.data.length; t += 2)e += this.calculatePair(this.data.substr(t, 2)); return { data: e += "11101", text: this.text } } }, { key: "calculatePair", value: function (e) { for (var t = "", i = this.binaryRepresentation[e[0]], n = this.binaryRepresentation[e[1]], a = 0; a < 5; a++)t += "1" == i[a] ? "111" : "1", t += "1" == n[a] ? "000" : "0"; return t } }]), n }(); t.ITF = o }, function (e, t, i) { "use strict"; function a(e) { for (var t = 0, i = 0; i < 13; i++)t += parseInt(e[i]) * (3 - i % 2 * 2); return 10 * Math.ceil(t / 10) - t } Object.defineProperty(t, "__esModule", { value: !0 }), t.ITF14 = void 0; var n, s = function () { function n(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (e, t, i) { return t && n(e.prototype, t), i && n(e, i), e } }(), r = i(0), o = (n = r) && n.__esModule ? n : { default: n }, l = function (e) { function n(e, t) { (function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") })(this, n), -1 !== e.search(/^[0-9]{13}$/) && (e += a(e)); var i = function (e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t }(this, (n.__proto__ || Object.getPrototypeOf(n)).call(this, e, t)); return i.binaryRepresentation = { 0: "00110", 1: "10001", 2: "01001", 3: "11000", 4: "00101", 5: "10100", 6: "01100", 7: "00011", 8: "10010", 9: "01010" }, i } return function (e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(n, o.default), s(n, [{ key: "valid", value: function () { return -1 !== this.data.search(/^[0-9]{14}$/) && this.data[13] == a(this.data) } }, { key: "encode", value: function () { for (var e = "1010", t = 0; t < 14; t += 2)e += this.calculatePair(this.data.substr(t, 2)); return { data: e += "11101", text: this.text } } }, { key: "calculatePair", value: function (e) { for (var t = "", i = this.binaryRepresentation[e[0]], n = this.binaryRepresentation[e[1]], a = 0; a < 5; a++)t += "1" == i[a] ? "111" : "1", t += "1" == n[a] ? "000" : "0"; return t } }]), n }(); t.ITF14 = l }, function (e, t, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var n, a = i(4), s = (n = a) && n.__esModule ? n : { default: n }, r = i(7), o = function (e) { function i(e, t) { return function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, i), function (e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t }(this, (i.__proto__ || Object.getPrototypeOf(i)).call(this, e + (0, r.mod10)(e), t)) } return function (e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(i, s.default), i }(); t.default = o }, function (e, t, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var n, a = i(4), s = (n = a) && n.__esModule ? n : { default: n }, r = i(7), o = function (e) { function i(e, t) { return function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, i), e += (0, r.mod10)(e), e += (0, r.mod10)(e), function (e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t }(this, (i.__proto__ || Object.getPrototypeOf(i)).call(this, e, t)) } return function (e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(i, s.default), i }(); t.default = o }, function (e, t, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var n, a = i(4), s = (n = a) && n.__esModule ? n : { default: n }, r = i(7), o = function (e) { function i(e, t) { return function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, i), function (e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t }(this, (i.__proto__ || Object.getPrototypeOf(i)).call(this, e + (0, r.mod11)(e), t)) } return function (e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(i, s.default), i }(); t.default = o }, function (e, t, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var n, a = i(4), s = (n = a) && n.__esModule ? n : { default: n }, r = i(7), o = function (e) { function i(e, t) { return function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, i), e += (0, r.mod11)(e), e += (0, r.mod10)(e), function (e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t }(this, (i.__proto__ || Object.getPrototypeOf(i)).call(this, e, t)) } return function (e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(i, s.default), i }(); t.default = o }, function (e, t, i) { "use strict"; function n(e) { return e && e.__esModule ? e : { default: e } } Object.defineProperty(t, "__esModule", { value: !0 }), t.MSI1110 = t.MSI1010 = t.MSI11 = t.MSI10 = t.MSI = void 0; var a = n(i(4)), s = n(i(36)), r = n(i(38)), o = n(i(37)), l = n(i(39)); t.MSI = a.default, t.MSI10 = s.default, t.MSI11 = r.default, t.MSI1010 = o.default, t.MSI1110 = l.default }, function (e, t, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.codabar = void 0; var n, a = function () { function n(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (e, t, i) { return t && n(e.prototype, t), i && n(e, i), e } }(), s = i(0), r = (n = s) && n.__esModule ? n : { default: n }, o = function (e) { function n(e, t) { (function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") })(this, n), 0 === e.search(/^[0-9\-\$\:\.\+\/]+$/) && (e = "A" + e + "A"); var i = function (e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t }(this, (n.__proto__ || Object.getPrototypeOf(n)).call(this, e.toUpperCase(), t)); return i.text = i.options.text || i.text.replace(/[A-D]/g, ""), i } return function (e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(n, r.default), a(n, [{ key: "valid", value: function () { return -1 !== this.data.search(/^[A-D][0-9\-\$\:\.\+\/]+[A-D]$/) } }, { key: "encode", value: function () { for (var e = [], t = this.getEncodings(), i = 0; i < this.data.length; i++)e.push(t[this.data.charAt(i)]), i !== this.data.length - 1 && e.push("0"); return { text: this.text, data: e.join("") } } }, { key: "getEncodings", value: function () { return { 0: "101010011", 1: "101011001", 2: "101001011", 3: "110010101", 4: "101101001", 5: "110101001", 6: "100101011", 7: "100101101", 8: "100110101", 9: "110100101", "-": "101001101", $: "101100101", ":": "1101011011", "/": "1101101011", ".": "1101101101", "+": "101100110011", A: "1011001001", B: "1001001011", C: "1010010011", D: "1010011001" } } }]), n }(); t.codabar = o }, function (e, t, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.pharmacode = void 0; var n, a = function () { function n(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (e, t, i) { return t && n(e.prototype, t), i && n(e, i), e } }(), s = i(0), r = (n = s) && n.__esModule ? n : { default: n }, o = function (e) { function n(e, t) { !function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, n); var i = function (e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t }(this, (n.__proto__ || Object.getPrototypeOf(n)).call(this, e, t)); return i.number = parseInt(e, 10), i } return function (e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(n, r.default), a(n, [{ key: "encode", value: function () { for (var e = this.number, t = ""; !isNaN(e) && 0 != e;)e % 2 == 0 ? (t = "11100" + t, e = (e - 2) / 2) : (t = "100" + t, e = (e - 1) / 2); return { data: t = t.slice(0, -2), text: this.text } } }, { key: "valid", value: function () { return 3 <= this.number && this.number <= 131070 } }]), n }(); t.pharmacode = o }, function (e, t, i) { "use strict"; function n(e) { return e && e.__esModule ? e : { default: e } } Object.defineProperty(t, "__esModule", { value: !0 }); var a = n(i(9)), s = n(i(10)); t.default = function (e) { var t = {}; for (var i in s.default) s.default.hasOwnProperty(i) && (e.hasAttribute("jsbarcode-" + i.toLowerCase()) && (t[i] = e.getAttribute("jsbarcode-" + i.toLowerCase())), e.hasAttribute("data-" + i.toLowerCase()) && (t[i] = e.getAttribute("data-" + i.toLowerCase()))); return t.value = e.getAttribute("jsbarcode-value") || e.getAttribute("data-value"), (0, a.default)(t) } }, function (e, t, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var n, a = function () { function n(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (e, t, i) { return t && n(e.prototype, t), i && n(e, i), e } }(), s = i(5), r = (n = s) && n.__esModule ? n : { default: n }, o = i(13), l = function () { function n(e, t, i) { (function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") })(this, n), this.canvas = e, this.encodings = t, this.options = i } return a(n, [{ key: "render", value: function () { if (!this.canvas.getContext) throw new Error("The browser does not support canvas."); this.prepareCanvas(); for (var e = 0; e < this.encodings.length; e++) { var t = (0, r.default)(this.options, this.encodings[e].options); this.drawCanvasBarcode(t, this.encodings[e]), this.drawCanvasText(t, this.encodings[e]), this.moveCanvasDrawing(this.encodings[e]) } this.restoreCanvas() } }, { key: "prepareCanvas", value: function () { var e = this.canvas.getContext("2d"); e.save(), (0, o.calculateEncodingAttributes)(this.encodings, this.options, e); var t = (0, o.getTotalWidthOfEncodings)(this.encodings), i = (0, o.getMaximumHeightOfEncodings)(this.encodings); this.canvas.width = t + this.options.marginLeft + this.options.marginRight, this.canvas.height = i, e.clearRect(0, 0, this.canvas.width, this.canvas.height), this.options.background && (e.fillStyle = this.options.background, e.fillRect(0, 0, this.canvas.width, this.canvas.height)), e.translate(this.options.marginLeft, 0) } }, { key: "drawCanvasBarcode", value: function (e, t) { var i, n = this.canvas.getContext("2d"), a = t.data; i = "top" == e.textPosition ? e.marginTop + e.fontSize + e.textMargin : e.marginTop, n.fillStyle = e.lineColor; for (var s = 0; s < a.length; s++) { var r = s * e.width + t.barcodePadding; "1" === a[s] ? n.fillRect(r, i, e.width, e.height) : a[s] && n.fillRect(r, i, e.width, e.height * a[s]) } } }, { key: "drawCanvasText", value: function (e, t) { var i, n, a = this.canvas.getContext("2d"), s = e.fontOptions + " " + e.fontSize + "px " + e.font; e.displayValue && (n = "top" == e.textPosition ? e.marginTop + e.fontSize - e.textMargin : e.height + e.textMargin + e.marginTop + e.fontSize, a.font = s, "left" == e.textAlign || 0 < t.barcodePadding ? (i = 0, a.textAlign = "left") : "right" == e.textAlign ? (i = t.width - 1, a.textAlign = "right") : (i = t.width / 2, a.textAlign = "center"), a.fillText(t.text, i, n)) } }, { key: "moveCanvasDrawing", value: function (e) { this.canvas.getContext("2d").translate(e.width, 0) } }, { key: "restoreCanvas", value: function () { this.canvas.getContext("2d").restore() } }]), n }(); t.default = l }, function (e, t, i) { "use strict"; function n(e) { return e && e.__esModule ? e : { default: e } } Object.defineProperty(t, "__esModule", { value: !0 }); var a = n(i(44)), s = n(i(47)), r = n(i(46)); t.default = { CanvasRenderer: a.default, SVGRenderer: s.default, ObjectRenderer: r.default } }, function (e, t, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var a = function () { function n(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (e, t, i) { return t && n(e.prototype, t), i && n(e, i), e } }(), n = function () { function n(e, t, i) { (function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") })(this, n), this.object = e, this.encodings = t, this.options = i } return a(n, [{ key: "render", value: function () { this.object.encodings = this.encodings } }]), n }(); t.default = n }, function (e, t, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var n, a = function () { function n(e, t) { for (var i = 0; i < t.length; i++) { var n = t[i]; n.enumerable = n.enumerable || !1, n.configurable = !0, "value" in n && (n.writable = !0), Object.defineProperty(e, n.key, n) } } return function (e, t, i) { return t && n(e.prototype, t), i && n(e, i), e } }(), s = i(5), r = (n = s) && n.__esModule ? n : { default: n }, o = i(13), l = "http://www.w3.org/2000/svg", c = function () { function n(e, t, i) { (function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") })(this, n), this.svg = e, this.encodings = t, this.options = i, this.document = i.xmlDocument || document } return a(n, [{ key: "render", value: function () { var e = this.options.marginLeft; this.prepareSVG(); for (var t = 0; t < this.encodings.length; t++) { var i = this.encodings[t], n = (0, r.default)(this.options, i.options), a = this.createGroup(e, n.marginTop, this.svg); this.setGroupOptions(a, n), this.drawSvgBarcode(a, n, i), this.drawSVGText(a, n, i), e += i.width } } }, { key: "prepareSVG", value: function () { for (; this.svg.firstChild;)this.svg.removeChild(this.svg.firstChild); (0, o.calculateEncodingAttributes)(this.encodings, this.options); var e = (0, o.getTotalWidthOfEncodings)(this.encodings), t = (0, o.getMaximumHeightOfEncodings)(this.encodings), i = e + this.options.marginLeft + this.options.marginRight; this.setSvgAttributes(i, t), this.options.background && this.drawRect(0, 0, i, t, this.svg).setAttribute("style", "fill:" + this.options.background + ";") } }, { key: "drawSvgBarcode", value: function (e, t, i) { var n, a = i.data; n = "top" == t.textPosition ? t.fontSize + t.textMargin : 0; for (var s = 0, r = 0, o = 0; o < a.length; o++)r = o * t.width + i.barcodePadding, "1" === a[o] ? s++ : 0 < s && (this.drawRect(r - t.width * s, n, t.width * s, t.height, e), s = 0); 0 < s && this.drawRect(r - t.width * (s - 1), n, t.width * s, t.height, e) } }, { key: "drawSVGText", value: function (e, t, i) { var n, a, s = this.document.createElementNS(l, "text"); t.displayValue && (s.setAttribute("style", "font:" + t.fontOptions + " " + t.fontSize + "px " + t.font), a = "top" == t.textPosition ? t.fontSize - t.textMargin : t.height + t.textMargin + t.fontSize, "left" == t.textAlign || 0 < i.barcodePadding ? (n = 0, s.setAttribute("text-anchor", "start")) : "right" == t.textAlign ? (n = i.width - 1, s.setAttribute("text-anchor", "end")) : (n = i.width / 2, s.setAttribute("text-anchor", "middle")), s.setAttribute("x", n), s.setAttribute("y", a), s.appendChild(this.document.createTextNode(i.text)), e.appendChild(s)) } }, { key: "setSvgAttributes", value: function (e, t) { var i = this.svg; i.setAttribute("width", e + "px"), i.setAttribute("height", t + "px"), i.setAttribute("x", "0px"), i.setAttribute("y", "0px"), i.setAttribute("viewBox", "0 0 " + e + " " + t), i.setAttribute("xmlns", l), i.setAttribute("version", "1.1"), i.setAttribute("style", "transform: translate(0,0)") } }, { key: "createGroup", value: function (e, t, i) { var n = this.document.createElementNS(l, "g"); return n.setAttribute("transform", "translate(" + e + ", " + t + ")"), i.appendChild(n), n } }, { key: "setGroupOptions", value: function (e, t) { e.setAttribute("style", "fill:" + t.lineColor + ";") } }, { key: "drawRect", value: function (e, t, i, n, a) { var s = this.document.createElementNS(l, "rect"); return s.setAttribute("x", e), s.setAttribute("y", t), s.setAttribute("width", i), s.setAttribute("height", n), a.appendChild(s), s } }]), n }(); t.default = c }]), define("JsBarcode", function () { }), function (k, T, Y) { var s, t, r, o, c, G = {}; function l(e, t, i) { var n, a = e.runtimeStyle && e.runtimeStyle[t], s = e.style; return !/^-?[0-9]+\.?[0-9]*(?:px)?$/i.test(i) && /^-?\d/.test(i) && (n = s.left, a && (e.runtimeStyle.left = e.currentStyle.left), s.left = "fontSize" === t ? "1em" : i || 0, i = s.pixelLeft + "px", s.left = n, a && (e.runtimeStyle.left = a)), /^(thin|medium|thick)$/i.test(i) ? i : Math.round(parseFloat(i)) + "px" } function d(e) { return parseInt(e, 10) } function u(e, t, i, n, a, s) { var r, o, l, c, d = G.Util.getCSS(t, e, a); if (1 === d.length && (c = d[0], (d = [])[0] = c, d[1] = c), -1 !== d[0].toString().indexOf("%")) l = parseFloat(d[0]) / 100, o = i.width * l, "backgroundSize" !== e && (o -= (s || n).width * l); else if ("backgroundSize" === e) if ("auto" === d[0]) o = n.width; else if (/contain|cover/.test(d[0])) { var u = G.Util.resizeBounds(n.width, n.height, i.width, i.height, d[0]); o = u.width, r = u.height } else o = parseInt(d[0], 10); else o = parseInt(d[0], 10); return "auto" === d[1] ? r = o / n.width * n.height : -1 !== d[1].toString().indexOf("%") ? (l = parseFloat(d[1]) / 100, r = i.height * l, "backgroundSize" !== e && (r -= (s || n).height * l)) : r = parseInt(d[1], 10), [o, r] } G.Util = {}, G.Util.log = function (e) { G.logging && k.console && k.console.log && k.console.log(e) }, G.Util.trimText = (t = String.prototype.trim, function (e) { return t ? t.apply(e) : ((e || "") + "").replace(/^\s+|\s+$/g, "") }), G.Util.asFloat = function (e) { return parseFloat(e) }, r = /((rgba|rgb)\([^\)]+\)(\s-?\d+px){0,})/g, o = /(-?\d+px)|(#.+)|(rgb\(.+\))|(rgba\(.+\))/g, G.Util.parseTextShadows = function (e) { if (!e || "none" === e) return []; for (var t = e.match(r), i = [], n = 0; t && n < t.length; n++) { var a = t[n].match(o); i.push({ color: a[0], offsetX: a[1] ? a[1].replace("px", "") : 0, offsetY: a[2] ? a[2].replace("px", "") : 0, blur: a[3] ? a[3].replace("px", "") : 0 }) } return i }, G.Util.parseBackgroundImage = function (e) { var t, i, n, a, s, r, o, l, c = [], d = 0, u = 0, h = function () { t && ('"' === i.substr(0, 1) && (i = i.substr(1, i.length - 2)), i && l.push(i), "-" === t.substr(0, 1) && 0 < (a = t.indexOf("-", 1) + 1) && (n = t.substr(0, a), t = t.substr(a)), c.push({ prefix: n, method: t.toLowerCase(), value: s, args: l })), l = [], t = n = i = s = "" }; h(); for (var p = 0, f = e.length; p < f; p++)if (r = e[p], !(0 === d && -1 < " \r\n\t".indexOf(r))) { switch (r) { case '"': o ? o === r && (o = null) : o = r; break; case "(": if (o) break; if (0 === d) { d = 1, s += r; continue } u++; break; case ")": if (o) break; if (1 === d) { if (0 === u) { d = 0, s += r, h(); continue } u-- } break; case ",": if (o) break; if (0 === d) { h(); continue } if (1 === d && 0 === u && !t.match(/^url$/i)) { l.push(i), i = "", s += r; continue } }s += r, 0 === d ? t += r : i += r } return h(), c }, G.Util.Bounds = function (e) { var t, i = {}; return e.getBoundingClientRect && (t = e.getBoundingClientRect(), i.top = t.top, i.bottom = t.bottom || t.top + t.height, i.left = t.left, i.width = e.offsetWidth, i.height = e.offsetHeight), i }, G.Util.OffsetBounds = function (e) { var t = e.offsetParent ? G.Util.OffsetBounds(e.offsetParent) : { top: 0, left: 0 }; return { top: e.offsetTop + t.top, bottom: e.offsetTop + e.offsetHeight + t.top, left: e.offsetLeft + t.left, width: e.offsetWidth, height: e.offsetHeight } }, G.Util.getCSS = function (e, t, i) { void 0 !== e && (s = T.defaultView.getComputedStyle(e, null)); var n = s[t]; if (/^background(Size|Position)$/.test(t)) return function (e, t, i, n) { if (e = (e = (e || "").split(","))[n || 0] || e[0] || "auto", e = G.Util.trimText(e).split(" "), "backgroundSize" !== i || e[0] && !e[0].match(/cover|contain|auto/)) { if (e[0] = -1 === e[0].indexOf("%") ? l(t, i + "X", e[0]) : e[0], e[1] === Y) { if ("backgroundSize" === i) return e[1] = "auto", e; e[1] = e[0] } e[1] = -1 === e[1].indexOf("%") ? l(t, i + "Y", e[1]) : e[1] } return e }(n, e, t, i); if (/border(Top|Bottom)(Left|Right)Radius/.test(t)) { var a = n.split(" "); return a.length <= 1 && (a[1] = a[0]), a.map(d) } return n }, G.Util.resizeBounds = function (e, t, i, n, a) { var s, r, o = e / t; return a && "auto" !== a ? i / n < o ^ "contain" === a ? s = (r = n) * o : r = (s = i) / o : (s = i, r = n), { width: s, height: r } }, G.Util.BackgroundPosition = function (e, t, i, n, a) { var s = u("backgroundPosition", e, t, i, n, a); return { left: s[0], top: s[1] } }, G.Util.BackgroundSize = function (e, t, i, n) { var a = u("backgroundSize", e, t, i, n); return { width: a[0], height: a[1] } }, G.Util.Extend = function (e, t) { for (var i in e) e.hasOwnProperty(i) && (t[i] = e[i]); return t }, G.Util.Children = function (e) { var t, i, n; try { t = e.nodeName && "IFRAME" === e.nodeName.toUpperCase() ? e.contentDocument || e.contentWindow.document : (i = e.childNodes, n = [], null !== i && function (e, t) { var i = e.length, n = 0; if ("number" == typeof t.length) for (var a = t.length; n < a; n++)e[i++] = t[n]; else for (; t[n] !== Y;)e[i++] = t[n++]; e.length = i }(n, i), n) } catch (e) { G.Util.log("html2canvas.Util.Children failed with exception: " + e.message), t = [] } return t }, G.Util.isTransparent = function (e) { return "transparent" === e || "rgba(0, 0, 0, 0)" === e }, G.Util.Font = (c = {}, function (e, t, i) { if (c[e + "-" + t] !== Y) return c[e + "-" + t]; var n, a, s = i.createElement("div"), r = i.createElement("img"), o = i.createElement("span"), l = "Hidden Text"; return s.style.visibility = "hidden", s.style.fontFamily = e, s.style.fontSize = t, s.style.margin = 0, s.style.padding = 0, i.body.appendChild(s), r.src = "data:image/gif;base64,R0lGODlhAQABAIABAP///wAAACwAAAAAAQABAAACAkQBADs=", r.width = 1, r.height = 1, r.style.margin = 0, r.style.padding = 0, r.style.verticalAlign = "baseline", o.style.fontFamily = e, o.style.fontSize = t, o.style.margin = 0, o.style.padding = 0, o.appendChild(i.createTextNode(l)), s.appendChild(o), s.appendChild(r), n = r.offsetTop - o.offsetTop + 1, s.removeChild(o), s.appendChild(i.createTextNode(l)), s.style.lineHeight = "normal", r.style.verticalAlign = "super", a = { baseline: n, lineWidth: 1, middle: r.offsetTop - s.offsetTop + 1 }, c[e + "-" + t] = a, i.body.removeChild(s), a }), function () { var i = G.Util, e = {}; G.Generate = e; var m = [/^(-webkit-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/, /^(-o-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/, /^(-webkit-gradient)\((linear|radial),\s((?:\d{1,3}%?)\s(?:\d{1,3}%?),\s(?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)\-]+)\)$/, /^(-moz-linear-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)]+)\)$/, /^(-webkit-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z\-]+)([\w\d\.\s,%\(\)]+)\)$/, /^(-moz-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s?([a-z\-]*)([\w\d\.\s,%\(\)]+)\)$/, /^(-o-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z\-]+)([\w\d\.\s,%\(\)]+)\)$/]; function d(e) { return function (t) { try { e.addColorStop(t.stop, t.color) } catch (e) { i.log(["failed to add color stop: ", e, "; tried to add: ", t]) } } } e.parseGradient = function (e, t) { var i, n, a, s, r, o, l, c, d, u, h, p, f = m.length; for (n = 0; n < f && !(a = e.match(m[n])); n += 1); if (a) switch (a[1]) { case "-webkit-linear-gradient": case "-o-linear-gradient": if (i = { type: "linear", x0: null, y0: null, x1: null, y1: null, colorStops: [] }, r = a[2].match(/\w+/g)) for (o = r.length, n = 0; n < o; n += 1)switch (r[n]) { case "top": i.y0 = 0, i.y1 = t.height; break; case "right": i.x0 = t.width, i.x1 = 0; break; case "bottom": i.y0 = t.height, i.y1 = 0; break; case "left": i.x0 = 0, i.x1 = t.width }if (null === i.x0 && null === i.x1 && (i.x0 = i.x1 = t.width / 2), null === i.y0 && null === i.y1 && (i.y0 = i.y1 = t.height / 2), r = a[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g)) for (o = r.length, l = 1 / Math.max(o - 1, 1), n = 0; n < o; n += 1)(c = r[n].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/))[2] ? (s = parseFloat(c[2]), "%" === c[3] ? s /= 100 : s /= t.width) : s = n * l, i.colorStops.push({ color: c[1], stop: s }); break; case "-webkit-gradient": if (i = { type: "radial" === a[2] ? "circle" : a[2], x0: 0, y0: 0, x1: 0, y1: 0, colorStops: [] }, (r = a[3].match(/(\d{1,3})%?\s(\d{1,3})%?,\s(\d{1,3})%?\s(\d{1,3})%?/)) && (i.x0 = r[1] * t.width / 100, i.y0 = r[2] * t.height / 100, i.x1 = r[3] * t.width / 100, i.y1 = r[4] * t.height / 100), r = a[4].match(/((?:from|to|color-stop)\((?:[0-9\.]+,\s)?(?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)\))+/g)) for (o = r.length, n = 0; n < o; n += 1)c = r[n].match(/(from|to|color-stop)\(([0-9\.]+)?(?:,\s)?((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\)/), s = parseFloat(c[2]), "from" === c[1] && (s = 0), "to" === c[1] && (s = 1), i.colorStops.push({ color: c[3], stop: s }); break; case "-moz-linear-gradient": if (i = { type: "linear", x0: 0, y0: 0, x1: 0, y1: 0, colorStops: [] }, (r = a[2].match(/(\d{1,3})%?\s(\d{1,3})%?/)) && (i.x0 = r[1] * t.width / 100, i.y0 = r[2] * t.height / 100, i.x1 = t.width - i.x0, i.y1 = t.height - i.y0), r = a[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}%)?)+/g)) for (o = r.length, l = 1 / Math.max(o - 1, 1), n = 0; n < o; n += 1)(c = r[n].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%)?/))[2] ? (s = parseFloat(c[2]), c[3] && (s /= 100)) : s = n * l, i.colorStops.push({ color: c[1], stop: s }); break; case "-webkit-radial-gradient": case "-moz-radial-gradient": case "-o-radial-gradient": if (i = { type: "circle", x0: 0, y0: 0, x1: t.width, y1: t.height, cx: 0, cy: 0, rx: 0, ry: 0, colorStops: [] }, (r = a[2].match(/(\d{1,3})%?\s(\d{1,3})%?/)) && (i.cx = r[1] * t.width / 100, i.cy = r[2] * t.height / 100), r = a[3].match(/\w+/), c = a[4].match(/[a-z\-]*/), r && c) switch (c[0]) { case "farthest-corner": case "cover": case "": d = Math.sqrt(Math.pow(i.cx, 2) + Math.pow(i.cy, 2)), u = Math.sqrt(Math.pow(i.cx, 2) + Math.pow(i.y1 - i.cy, 2)), h = Math.sqrt(Math.pow(i.x1 - i.cx, 2) + Math.pow(i.y1 - i.cy, 2)), p = Math.sqrt(Math.pow(i.x1 - i.cx, 2) + Math.pow(i.cy, 2)), i.rx = i.ry = Math.max(d, u, h, p); break; case "closest-corner": d = Math.sqrt(Math.pow(i.cx, 2) + Math.pow(i.cy, 2)), u = Math.sqrt(Math.pow(i.cx, 2) + Math.pow(i.y1 - i.cy, 2)), h = Math.sqrt(Math.pow(i.x1 - i.cx, 2) + Math.pow(i.y1 - i.cy, 2)), p = Math.sqrt(Math.pow(i.x1 - i.cx, 2) + Math.pow(i.cy, 2)), i.rx = i.ry = Math.min(d, u, h, p); break; case "farthest-side": "circle" === r[0] ? i.rx = i.ry = Math.max(i.cx, i.cy, i.x1 - i.cx, i.y1 - i.cy) : (i.type = r[0], i.rx = Math.max(i.cx, i.x1 - i.cx), i.ry = Math.max(i.cy, i.y1 - i.cy)); break; case "closest-side": case "contain": "circle" === r[0] ? i.rx = i.ry = Math.min(i.cx, i.cy, i.x1 - i.cx, i.y1 - i.cy) : (i.type = r[0], i.rx = Math.min(i.cx, i.x1 - i.cx), i.ry = Math.min(i.cy, i.y1 - i.cy)) }if (r = a[5].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g)) for (o = r.length, l = 1 / Math.max(o - 1, 1), n = 0; n < o; n += 1)(c = r[n].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/))[2] ? (s = parseFloat(c[2]), "%" === c[3] ? s /= 100 : s /= t.width) : s = n * l, i.colorStops.push({ color: c[1], stop: s }) }return i }, e.Gradient = function (e, t) { if (0 !== t.width && 0 !== t.height) { var i, n, a = T.createElement("canvas"), s = a.getContext("2d"); if (a.width = t.width, a.height = t.height, i = G.Generate.parseGradient(e, t)) switch (i.type) { case "linear": n = s.createLinearGradient(i.x0, i.y0, i.x1, i.y1), i.colorStops.forEach(d(n)), s.fillStyle = n, s.fillRect(0, 0, t.width, t.height); break; case "circle": n = s.createRadialGradient(i.cx, i.cy, 0, i.cx, i.cy, i.rx), i.colorStops.forEach(d(n)), s.fillStyle = n, s.fillRect(0, 0, t.width, t.height); break; case "ellipse": var r = T.createElement("canvas"), o = r.getContext("2d"), l = Math.max(i.rx, i.ry), c = 2 * l; r.width = r.height = c, n = o.createRadialGradient(i.rx, i.ry, 0, i.rx, i.ry, l), i.colorStops.forEach(d(n)), o.fillStyle = n, o.fillRect(0, 0, c, c), s.fillStyle = i.colorStops[i.colorStops.length - 1].color, s.fillRect(0, 0, a.width, a.height), s.drawImage(r, i.cx - i.rx, i.cy - i.ry, 2 * i.rx, 2 * i.ry) }return a } }, e.ListAlpha = function (e) { for (var t, i = ""; t = e % 26, i = String.fromCharCode(t + 64) + i, 26 < 26 * (e /= 26);); return i }, e.ListRoman = function (e) { var t, i = ["M", "CM", "D", "CD", "C", "XC", "L", "XL", "X", "IX", "V", "IV", "I"], n = [1e3, 900, 500, 400, 100, 90, 50, 40, 10, 9, 5, 4, 1], a = "", s = i.length; if (e <= 0 || 4e3 <= e) return e; for (t = 0; t < s; t += 1)for (; n[t] <= e;)e -= n[t], a += i[t]; return a } }(), G.Parse = function (i, w) { k.scroll(0, 0); var e = w.elements === Y ? T.body : w.elements[0], C = e.ownerDocument, S = G.Util, u = S.Support(w, C), $ = new RegExp("(" + w.ignoreElements + ")"), r = C.body, O = S.getCSS, A = "___html2canvas___pseudoelement", t = C.createElement("style"); function x(e, t) { var i = parseInt(O(e, t), 10); return isNaN(i) ? 0 : i } function I(e, t, i, n, a, s) { "transparent" !== s && (e.setVariable("fillStyle", s), e.fillRect(t, i, n, a), 1) } function h(e, t, i) { if (0 < e.length) return t + i.toUpperCase() } function p(e, t, i, n) { null !== e && 0 < S.trimText(e).length && (n.fillText(e, t, i), 1) } function f(e, t, i, n) { var a = O(t, "fontWeight"), s = O(t, "fontFamily"), r = O(t, "fontSize"), o = S.parseTextShadows(O(t, "textShadow")); switch (parseInt(a, 10)) { case 401: a = "bold"; break; case 400: a = "normal" }if (e.setVariable("fillStyle", n), e.setVariable("font", [O(t, "fontStyle"), O(t, "fontVariant"), a, r, s].join(" ")), e.setVariable("textAlign", "left"), o.length && (e.setVariable("shadowColor", o[0].color), e.setVariable("shadowOffsetX", o[0].offsetX), e.setVariable("shadowOffsetY", o[0].offsetY), e.setVariable("shadowBlur", o[0].blur)), "none" !== i) return S.Font(s, r, C) } function m(e, t, i, n, a) { var s, r, o, l, c; if (u.rangeBounds && !a) "none" === i && 0 === S.trimText(t).length || (r = t, o = e.node, l = e.textOffset, (c = C.createRange()).setStart(o, l), c.setEnd(o, l + r.length), s = c.getBoundingClientRect()), e.textOffset += t.length; else if (e.node && "string" == typeof e.node.nodeValue) { var d = n ? e.node.splitText(t.length) : null; s = function (e, t) { var i = e.parentNode, n = C.createElement("wrapper"), a = e.cloneNode(!0); n.appendChild(e.cloneNode(!0)), i.replaceChild(n, e); var s = t ? S.OffsetBounds(n) : S.Bounds(n); return i.replaceChild(a, n), s }(e.node, a), e.node = d } return s } function o(e, t, n) { var a, s, i, r = n.ctx, o = O(e, "color"), l = O(e, "textDecoration"), c = O(e, "textAlign"), d = { node: t, textOffset: 0 }; 0 < S.trimText(t.nodeValue).length && (t.nodeValue = function (e, t) { switch (t) { case "lowercase": return e.toLowerCase(); case "capitalize": return e.replace(/(^|\s|:|-|\(|\))([a-z])/g, h); case "uppercase": return e.toUpperCase(); default: return e } }(t.nodeValue, O(e, "textTransform")), c = c.replace(["-webkit-auto"], ["auto"]), s = !w.letterRendering && /^(left|right|justify|auto)$/.test(c) && (i = O(e, "letterSpacing"), /^(normal|none|0px)$/.test(i)) ? t.nodeValue.split(/(\b| )/) : t.nodeValue.split(""), a = f(r, e, l, o), w.chinese && s.forEach(function (e, t) { /.*[\u4E00-\u9FA5].*$/.test(e) && ((e = e.split("")).unshift(t, 1), s.splice.apply(s, e)) }), s.forEach(function (e, t) { var i = m(d, e, l, t < s.length - 1, n.transform.matrix); i && (p(e, i.left, i.bottom, r), function (e, t, i, n, a) { switch (t) { case "underline": I(e, i.left, Math.round(i.top + n.baseline + n.lineWidth), i.width, 1, a); break; case "overline": I(e, i.left, Math.round(i.top), i.width, 1, a); break; case "line-through": I(e, i.left, Math.ceil(i.top + n.middle + n.lineWidth), i.width, 1, a) } }(r, l, i, a, o)) })) } function D(e, t, i) { var n, a, s, r, o, l, c, d = t.ctx, u = O(e, "listStyleType"); if (/^(decimal|decimal-leading-zero|upper-alpha|upper-latin|upper-roman|lower-alpha|lower-greek|lower-latin|lower-roman)$/i.test(u)) { if (n = function (e, t) { var i, n = function (e) { var t = -1, i = 1, n = e.parentNode.childNodes; if (e.parentNode) { for (; n[++t] !== e;)1 === n[t].nodeType && i++; return i } return -1 }(e); switch (t) { case "decimal": i = n; break; case "decimal-leading-zero": i = 1 === n.toString().length ? n = "0" + n.toString() : n.toString(); break; case "upper-roman": i = G.Generate.ListRoman(n); break; case "lower-roman": i = G.Generate.ListRoman(n).toLowerCase(); break; case "lower-alpha": i = G.Generate.ListAlpha(n).toLowerCase(); break; case "upper-alpha": i = G.Generate.ListAlpha(n) }return i + ". " }(e, u), s = e, r = n, (c = C.createElement("boundelement")).style.display = "inline", o = s.style.listStyleType, s.style.listStyleType = "none", c.appendChild(C.createTextNode(r)), s.insertBefore(c, s.firstChild), l = S.Bounds(c), s.removeChild(c), s.style.listStyleType = o, a = l, f(d, e, "none", O(e, "color")), "inside" !== O(e, "listStylePosition")) return; d.setVariable("textAlign", "left"), p(n, i.left, a.bottom, d) } } function P(e) { var t = i[e]; return !(!t || !0 !== t.succeeded) && t.img } function j(e, t) { var i = Math.max(e.left, t.left), n = Math.max(e.top, t.top); return { left: i, top: n, width: Math.min(e.left + e.width, t.left + t.width) - i, height: Math.min(e.top + e.height, t.top + t.height) - n } } function L(e, t, i, n, a) { var s = x(t, "paddingLeft"), r = x(t, "paddingTop"), o = x(t, "paddingRight"), l = x(t, "paddingBottom"); c(e, i, 0, 0, i.width, i.height, n.left + s + a[3].width, n.top + r + a[0].width, n.width - (a[1].width + a[3].width + s + o), n.height - (a[0].width + a[2].width + r + l)) } t.innerHTML = "." + A + '-before:before { content: "" !important; display: none !important; }.' + A + '-after:after { content: "" !important; display: none !important; }', r.appendChild(t), i = i || {}; var l, E = (l = (Math.sqrt(2) - 1) / 3 * 4, function (e, t, i, n) { var a = i * l, s = n * l, r = e + i, o = t + n; return { topLeft: g({ x: e, y: o }, { x: e, y: o - s }, { x: r - a, y: t }, { x: r, y: t }), topRight: g({ x: e, y: t }, { x: e + a, y: t }, { x: r, y: o - s }, { x: r, y: o }), bottomRight: g({ x: r, y: t }, { x: r, y: t + s }, { x: e + a, y: o }, { x: e, y: o }), bottomLeft: g({ x: r, y: o }, { x: r - a, y: o }, { x: e, y: t + s }, { x: e, y: t }) } }); function g(o, l, c, d) { var u = function (e, t, i) { return { x: e.x + (t.x - e.x) * i, y: e.y + (t.y - e.y) * i } }; return { start: o, startControl: l, endControl: c, end: d, subdivide: function (e) { var t = u(o, l, e), i = u(l, c, e), n = u(c, d, e), a = u(t, i, e), s = u(i, n, e), r = u(a, s, e); return [g(o, t, a, r), g(r, s, n, d)] }, curveTo: function (e) { e.push(["bezierCurve", l.x, l.y, c.x, c.y, d.x, d.y]) }, curveToReversed: function (e) { e.push(["bezierCurve", c.x, c.y, l.x, l.y, o.x, o.y]) } } } function N(e, t, i, n, a, s, r) { 0 < t[0] || 0 < t[1] ? (e.push(["line", n[0].start.x, n[0].start.y]), n[0].curveTo(e), n[1].curveTo(e)) : e.push(["line", s, r]), (0 < i[0] || 0 < i[1]) && e.push(["line", a[0].start.x, a[0].start.y]) } function B(e, t, i, n, a, s, r) { var o = []; return 0 < t[0] || 0 < t[1] ? (o.push(["line", n[1].start.x, n[1].start.y]), n[1].curveTo(o)) : o.push(["line", e.c1[0], e.c1[1]]), 0 < i[0] || 0 < i[1] ? (o.push(["line", s[0].start.x, s[0].start.y]), s[0].curveTo(o), o.push(["line", r[0].end.x, r[0].end.y]), r[0].curveToReversed(o)) : (o.push(["line", e.c2[0], e.c2[1]]), o.push(["line", e.c3[0], e.c3[1]])), 0 < t[0] || 0 < t[1] ? (o.push(["line", a[1].end.x, a[1].end.y]), a[1].curveToReversed(o)) : o.push(["line", e.c4[0], e.c4[1]]), o } function M(e, t, i) { var n, a, s, r, o, l, c, d, u, h, p, f, m, g, _, v, y, b, w, C, x, k, T, S, $, A, I = t.left, D = t.top, P = t.width, j = t.height, L = (A = e, ["TopLeft", "TopRight", "BottomRight", "BottomLeft"].map(function (e) { return O(A, "border" + e + "Radius") })), M = (d = L, u = i, h = (c = t).left, p = c.top, f = c.width, m = c.height, g = d[0][0], _ = d[0][1], v = d[1][0], y = d[1][1], b = d[2][0], w = d[2][1], C = d[3][0], x = d[3][1], k = f - v, T = m - w, S = f - b, $ = m - x, { topLeftOuter: E(h, p, g, _).topLeft.subdivide(.5), topLeftInner: E(h + u[3].width, p + u[0].width, Math.max(0, g - u[3].width), Math.max(0, _ - u[0].width)).topLeft.subdivide(.5), topRightOuter: E(h + k, p, v, y).topRight.subdivide(.5), topRightInner: E(h + Math.min(k, f + u[3].width), p + u[0].width, k > f + u[3].width ? 0 : v - u[3].width, y - u[0].width).topRight.subdivide(.5), bottomRightOuter: E(h + S, p + T, b, w).bottomRight.subdivide(.5), bottomRightInner: E(h + Math.min(S, f + u[3].width), p + Math.min(T, m + u[0].width), Math.max(0, b - u[1].width), Math.max(0, w - u[2].width)).bottomRight.subdivide(.5), bottomLeftOuter: E(h, p + $, C, x).bottomLeft.subdivide(.5), bottomLeftInner: E(h + u[3].width, p + $, Math.max(0, C - u[3].width), Math.max(0, x - u[2].width)).bottomLeft.subdivide(.5) }), R = { clip: function (e, t, i, n, a) { var s = []; switch (O(e, "backgroundClip")) { case "content-box": case "padding-box": N(s, n[0], n[1], t.topLeftInner, t.topRightInner, a.left + i[3].width, a.top + i[0].width), N(s, n[1], n[2], t.topRightInner, t.bottomRightInner, a.left + a.width - i[1].width, a.top + i[0].width), N(s, n[2], n[3], t.bottomRightInner, t.bottomLeftInner, a.left + a.width - i[1].width, a.top + a.height - i[2].width), N(s, n[3], n[0], t.bottomLeftInner, t.topLeftInner, a.left + i[3].width, a.top + a.height - i[2].width); break; default: N(s, n[0], n[1], t.topLeftOuter, t.topRightOuter, a.left, a.top), N(s, n[1], n[2], t.topRightOuter, t.bottomRightOuter, a.left + a.width, a.top), N(s, n[2], n[3], t.bottomRightOuter, t.bottomLeftOuter, a.left + a.width, a.top + a.height), N(s, n[3], n[0], t.bottomLeftOuter, t.topLeftOuter, a.left, a.top + a.height) }return s }(e, M, i, L, t), borders: [] }; for (n = 0; n < 4; n++)if (0 < i[n].width) { switch (a = I, s = D, r = P, o = j - i[2].width, n) { case 0: o = i[0].width, l = B({ c1: [a, s], c2: [a + r, s], c3: [a + r - i[1].width, s + o], c4: [a + i[3].width, s + o] }, L[0], L[1], M.topLeftOuter, M.topLeftInner, M.topRightOuter, M.topRightInner); break; case 1: l = B({ c1: [(a = I + P - i[1].width) + (r = i[1].width), s], c2: [a + r, s + o + i[2].width], c3: [a, s + o], c4: [a, s + i[0].width] }, L[1], L[2], M.topRightOuter, M.topRightInner, M.bottomRightOuter, M.bottomRightInner); break; case 2: l = B({ c1: [a + r, (s = s + j - i[2].width) + (o = i[2].width)], c2: [a, s + o], c3: [a + i[3].width, s], c4: [a + r - i[3].width, s] }, L[2], L[3], M.bottomRightOuter, M.bottomRightInner, M.bottomLeftOuter, M.bottomLeftInner); break; case 3: r = i[3].width, l = B({ c1: [a, s + o + i[2].width], c2: [a, s], c3: [a + r, s + i[0].width], c4: [a + r, s + o] }, L[3], L[0], M.bottomLeftOuter, M.bottomLeftInner, M.topLeftOuter, M.topLeftInner) }R.borders.push({ args: l, color: i[n].color }) } return R } function R(e, t) { var i = e.drawShape(); return t.forEach(function (e, t) { i[0 === t ? "moveTo" : e[0] + "To"].apply(null, e.slice(1)) }), i } function F(t, e, i) { var n, a, s = C.createElement("valuewrap");["lineHeight", "textAlign", "fontFamily", "color", "fontSize", "paddingLeft", "paddingTop", "width", "height", "border", "borderLeftWidth", "borderTopWidth"].forEach(function (e) { try { s.style[e] = O(t, e) } catch (e) { S.log("html2canvas: Parse: Exception caught in renderFormValue: " + e.message) } }), s.style.borderColor = "black", s.style.borderStyle = "solid", s.style.display = "block", s.style.position = "absolute", (/^(submit|reset|button|text|password)$/.test(t.type) || "SELECT" === t.nodeName) && (s.style.lineHeight = O(t, "height")), s.style.top = e.top + "px", s.style.left = e.left + "px", (n = "SELECT" === t.nodeName ? (t.options[t.selectedIndex] || 0).text : t.value) || (n = t.placeholder), a = C.createTextNode(n), s.appendChild(a), r.appendChild(s), o(t, a, i), r.removeChild(s) } function c(e) { e.drawImage.apply(e, Array.prototype.slice.call(arguments, 1)), 1 } function q(e, t) { var i = k.getComputedStyle(e, t); if (i && i.content && "none" !== i.content && "-moz-alt-content" !== i.content && "none" !== i.display) { var n = i.content + "", a = n.substr(0, 1); a === n.substr(n.length - 1) && a.match(/'|"/) && (n = n.substr(1, n.length - 2)); var s = "url" === n.substr(0, 3), r = T.createElement(s ? "img" : "span"); return r.className = A + "-before " + A + "-after", Object.keys(i).filter(d).forEach(function (t) { try { r.style[t] = i[t] } catch (e) { S.log(["Tried to assign readonly property ", t, "Error:", e]) } }), s ? r.src = S.parseBackgroundImage(n)[0].args[0] : r.innerHTML = n, r } } function d(e) { return isNaN(k.parseInt(e, 10)) } function _(e, t, i, n) { var a = Math.round(n.left + i.left), s = Math.round(n.top + i.top); e.createPattern(t), e.translate(a, s), e.fill(), e.translate(-a, -s) } function v(e, t, i, n, a, s, r, o) { var l = []; l.push(["line", Math.round(a), Math.round(s)]), l.push(["line", Math.round(a + r), Math.round(s)]), l.push(["line", Math.round(a + r), Math.round(o + s)]), l.push(["line", Math.round(a), Math.round(o + s)]), R(e, l), e.save(), e.clip(), _(e, t, i, n), e.restore() } function U(e, t, i, n, a) { var s = S.BackgroundSize(e, t, n, a), r = S.BackgroundPosition(e, t, n, a, s), o = O(e, "backgroundRepeat").split(",").map(S.trimText); switch (n = function (e, t) { if (e.width === t.width && e.height === t.height) return e; var i = C.createElement("canvas"); return i.width = t.width, i.height = t.height, c(i.getContext("2d"), e, 0, 0, e.width, e.height, 0, 0, t.width, t.height), i }(n, s), o = o[a] || o[0]) { case "repeat-x": v(i, n, r, t, t.left, t.top + r.top, 99999, n.height); break; case "repeat-y": v(i, n, r, t, t.left + r.left, t.top, n.width, 99999); break; case "no-repeat": v(i, n, r, t, t.left + r.left, t.top + r.top, n.width, n.height); break; default: _(i, n, r, { top: t.top, left: t.left, width: n.width, height: n.height }) } } function H(e) { return e.replace("px", "") } var n, a, s, W = /(matrix)\((.+)\)/; function V(e, t, i, n) { var a, s, r, o, l, c, d, u, h, p, f, m, g, _, v, y = (l = t ? i.width : Math.max(Math.max(C.body.scrollWidth, C.documentElement.scrollWidth), Math.max(C.body.offsetWidth, C.documentElement.offsetWidth), Math.max(C.body.clientWidth, C.documentElement.clientWidth)), c = t ? i.height : Math.max(Math.max(C.body.scrollHeight, C.documentElement.scrollHeight), Math.max(C.body.offsetHeight, C.documentElement.offsetHeight), Math.max(C.body.clientHeight, C.documentElement.clientHeight)), { storage: d = [], width: l, height: c, clip: function () { d.push({ type: "function", name: "clip", arguments: arguments }) }, translate: function () { d.push({ type: "function", name: "translate", arguments: arguments }) }, fill: function () { d.push({ type: "function", name: "fill", arguments: arguments }) }, save: function () { d.push({ type: "function", name: "save", arguments: arguments }) }, restore: function () { d.push({ type: "function", name: "restore", arguments: arguments }) }, fillRect: function () { d.push({ type: "function", name: "fillRect", arguments: arguments }) }, createPattern: function () { d.push({ type: "function", name: "createPattern", arguments: arguments }) }, drawShape: function () { var e = []; return d.push({ type: "function", name: "drawShape", arguments: e }), { moveTo: function () { e.push({ name: "moveTo", arguments: arguments }) }, lineTo: function () { e.push({ name: "lineTo", arguments: arguments }) }, arcTo: function () { e.push({ name: "arcTo", arguments: arguments }) }, bezierCurveTo: function () { e.push({ name: "bezierCurveTo", arguments: arguments }) }, quadraticCurveTo: function () { e.push({ name: "quadraticCurveTo", arguments: arguments }) } } }, drawImage: function () { d.push({ type: "function", name: "drawImage", arguments: arguments }) }, fillText: function () { d.push({ type: "function", name: "fillText", arguments: arguments }) }, setVariable: function (e, t) { return d.push({ type: "variable", name: e, arguments: t }), t } }), b = { ctx: y, opacity: (s = y, r = e, o = t, s.setVariable("globalAlpha", O(r, "opacity") * (o ? o.opacity : 1))), cssPosition: O(e, "position"), borders: (a = e, ["Top", "Right", "Bottom", "Left"].map(function (e) { return { width: x(a, "border" + e + "Width"), color: O(a, "border" + e + "Color") } })), transform: n, clip: t && t.clip ? S.Extend({}, t.clip) : null }; return u = e, p = t, m = "static" !== (h = b).cssPosition, g = m ? O(u, "zIndex") : "auto", _ = O(u, "opacity"), v = "none" !== O(u, "cssFloat"), h.zIndex = f = { zindex: g, children: [] }, f.isPositioned = m, f.isFloated = v, f.opacity = _, f.ownStacking = "auto" !== g || _ < 1, p && p.zIndex.children.push(h), !0 === w.useOverflow && !0 === /(hidden|scroll|auto)/.test(O(e, "overflow")) && !1 === /(BODY)/i.test(e.nodeName) && (b.clip = b.clip ? j(b.clip, i) : i), b } function y(e, t, i, n) { var a, s, r, o, l, c, d, u, h, p, f, m, g, _, v = function (e, t) { var i, n = O(e, "transform") || O(e, "-webkit-transform") || O(e, "-moz-transform") || O(e, "-ms-transform") || O(e, "-o-transform"), a = O(e, "transform-origin") || O(e, "-webkit-transform-origin") || O(e, "-moz-transform-origin") || O(e, "-ms-transform-origin") || O(e, "-o-transform-origin") || "0px 0px"; if (a = a.split(" ").map(H).map(S.asFloat), n && "none" !== n) { var s = n.match(W); if (s) switch (s[1]) { case "matrix": i = s[2].split(",").map(S.trimText).map(S.asFloat) } } return { origin: a, matrix: i } }(e), y = (c = e, u = (d = v).matrix ? S.OffsetBounds(c) : S.Bounds(c), d.origin[0] += u.left, d.origin[1] += u.top, u), b = V(e, t, y, v), w = b.borders, C = b.ctx, x = (s = w, r = y, o = b.clip, l = { left: r.left + s[3].width, top: r.top + s[0].width, width: r.width - (s[1].width + s[3].width), height: r.height - (s[0].width + s[2].width) }, o && (l = j(l, o)), l), k = M(e, y, w), T = $.test(e.nodeName) ? "#efefef" : O(e, "backgroundColor"); switch (R(C, k.clip), C.save(), C.clip(), 0 < x.height && 0 < x.width && !n ? (p = T, I(C, (h = y).left, h.top, h.width, h.height, p), function (e, t, i) { for (var n, a = O(e, "backgroundImage"), s = S.parseBackgroundImage(a), r = s.length; r--;)(a = s[r]).args && 0 !== a.args.length && ((n = P("url" === a.method ? a.args[0] : a.value)) ? U(e, t, i, n, r) : S.log("html2canvas: Error loading background:", a)) }(e, x, C)) : n && (b.backgroundColor = T), C.restore(), k.borders.forEach(function (e) { var t, i, n; t = C, i = e.args, "transparent" !== (n = e.color) && (t.setVariable("fillStyle", n), R(t, i), t.fill(), 1) }), i || (m = b, g = q(f = e, ":before"), _ = q(f, ":after"), (g || _) && (g && (f.className += " " + A + "-before", f.parentNode.insertBefore(g, f), z(g, m, !0), f.parentNode.removeChild(g), f.className = f.className.replace(A + "-before", "").trim()), _ && (f.className += " " + A + "-after", f.appendChild(_), z(_, m, !0), f.removeChild(_), f.className = f.className.replace(A + "-after", "").trim()))), e.nodeName) { case "IMG": (a = P(e.getAttribute("src"))) ? L(C, e, a, y, w) : S.log("html2canvas: Error loading <img>:" + e.getAttribute("src")); break; case "INPUT": /^(text|url|email|submit|button|reset)$/.test(e.type) && 0 < (e.value || e.placeholder || "").length && F(e, y, b); break; case "TEXTAREA": 0 < (e.value || e.placeholder || "").length && F(e, y, b); break; case "SELECT": 0 < (e.options || e.placeholder || "").length && F(e, y, b); break; case "LI": D(e, b, x); break; case "CANVAS": L(C, e, e, y, w) }return b } function z(e, t, i) { var n; "none" === O(n = e, "display") || "hidden" === O(n, "visibility") || n.hasAttribute("data-html2canvas-ignore") || (t = y(e, t, i, !1) || t, $.test(e.nodeName) || b(e, t, i)) } function b(t, i, n) { S.Children(t).forEach(function (e) { e.nodeType === e.ELEMENT_NODE ? z(e, i, n) : e.nodeType === e.TEXT_NODE && o(t, e, i) }) } return n = O(T.documentElement, "backgroundColor"), a = S.isTransparent(n) && e === T.body, s = y(e, null, !1, a), b(e, s), a && (n = s.backgroundColor), r.removeChild(t), { backgroundColor: n, stack: s } }, G.Preload = function (r) { var a, o, e, t, l = { numLoaded: 0, numFailed: 0, numTotal: 0, cleanupDone: !1 }, s = G.Util, c = 0, i = r.elements[0] || T.body, d = i.ownerDocument, n = i.getElementsByTagName("img"), u = n.length, h = d.createElement("a"), p = (new Image).crossOrigin !== Y; function f() { s.log("html2canvas: start: images: " + l.numLoaded + " / " + l.numTotal + " (failed: " + l.numFailed + ")"), !l.firstRun && l.numLoaded >= l.numTotal && (s.log("Finished loading images: # " + l.numTotal + " (failed: " + l.numFailed + ")"), "function" == typeof r.complete && r.complete(l)) } function m(e, t, i) { var n, a, s = r.proxy; h.href = e, e = h.href, n = "html2canvas_" + c++ , i.callbackname = n, -1 < s.indexOf("?") ? s += "&" : s += "?", s += "url=" + encodeURIComponent(e) + "&callback=" + n, a = d.createElement("script"), k[n] = function (e) { "error:" === e.substring(0, 6) ? (i.succeeded = !1, l.numLoaded++ , l.numFailed++ , f()) : (y(t, i), t.src = e), k[n] = Y; try { delete k[n] } catch (e) { } a.parentNode.removeChild(a), a = null, delete i.script, delete i.callbackname }, a.setAttribute("type", "text/javascript"), a.setAttribute("src", s), i.script = a, k.document.body.appendChild(a) } function g(e, t) { var i = k.getComputedStyle(e, t), n = i.content; "url" === n.substr(0, 3) && o.loadImage(G.Util.parseBackgroundImage(n)[0].args[0]), v(i.backgroundImage, e) } function _(e) { return e && e.method && e.args && 0 < e.args.length } function v(e, a) { var s; G.Util.parseBackgroundImage(e).filter(_).forEach(function (e) { var t, i, n; "url" === e.method ? o.loadImage(e.args[0]) : e.method.match(/\-?gradient$/) && (s === Y && (s = G.Util.Bounds(a)), t = e.value, i = s, (n = G.Generate.Gradient(t, i)) !== Y && (l[t] = { img: n, succeeded: !0 }, l.numTotal++ , l.numLoaded++ , f())) }) } function y(t, i) { t.onload = function () { i.timer !== Y && k.clearTimeout(i.timer), l.numLoaded++ , i.succeeded = !0, t.onerror = t.onload = null, f() }, t.onerror = function () { if ("anonymous" === t.crossOrigin && (k.clearTimeout(i.timer), r.proxy)) { var e = t.src; return t = new Image, (i.img = t).src = e, void m(t.src, t, i) } l.numLoaded++ , l.numFailed++ , i.succeeded = !1, t.onerror = t.onload = null, f() } } for (h.href = k.location.href, a = h.protocol + h.host, o = { loadImage: function (e) { var t, i, n; e && l[e] === Y && (t = new Image, e.match(/data:image\/.*;base64,/i) ? (t.src = e.replace(/url\(['"]{0,}|['"]{0,}\)$/gi, ""), i = l[e] = { img: t }, l.numTotal++ , y(t, i)) : (n = e, h.href = n, h.href = h.href, h.protocol + h.host === a || !0 === r.allowTaint ? (i = l[e] = { img: t }, l.numTotal++ , y(t, i), t.src = e) : p && !r.allowTaint && r.useCORS ? (t.crossOrigin = "anonymous", i = l[e] = { img: t }, l.numTotal++ , y(t, i), t.src = e) : r.proxy && (i = l[e] = { img: t }, l.numTotal++ , m(e, t, i)))) }, cleanupDOM: function (e) { var t, i; if (!l.cleanupDone) { for (i in e && "string" == typeof e ? s.log("html2canvas: Cleanup because: " + e) : s.log("html2canvas: Cleanup after timeout: " + r.timeout + " ms."), l) if (l.hasOwnProperty(i) && "object" == typeof (t = l[i]) && t.callbackname && t.succeeded === Y) { k[t.callbackname] = Y; try { delete k[t.callbackname] } catch (e) { } t.script && t.script.parentNode && (t.script.setAttribute("src", "about:blank"), t.script.parentNode.removeChild(t.script)), l.numLoaded++ , l.numFailed++ , s.log("html2canvas: Cleaned up failed img: '" + i + "' Steps: " + l.numLoaded + " / " + l.numTotal) } k.stop !== Y ? k.stop() : T.execCommand !== Y && T.execCommand("Stop", !1), T.close !== Y && T.close(), l.cleanupDone = !0, e && "string" == typeof e || f() } }, renderingDone: function () { t && k.clearTimeout(t) } }, 0 < r.timeout && (t = k.setTimeout(o.cleanupDOM, r.timeout)), s.log("html2canvas: Preload starts: finding background-images"), l.firstRun = !0, function e(t) { var i, n = !1; try { s.Children(t).forEach(e) } catch (e) { } try { n = t.nodeType } catch (e) { n = !1, s.log("html2canvas: failed to access some element's nodeType - Exception: " + e.message) } if (1 === n || n === Y) { g(i = t, ":before"), g(i, ":after"); try { v(s.getCSS(t, "backgroundImage"), t) } catch (e) { s.log("html2canvas: failed to get background-image - Exception: " + e.message) } v(t) } }(i), s.log("html2canvas: Preload: Finding images"), e = 0; e < u; e += 1)o.loadImage(n[e].getAttribute("src")); return l.firstRun = !1, s.log("html2canvas: Preload: Done."), l.numTotal === l.numLoaded && f(), o }, G.Renderer = function (e, i) { return function (e) { var t; if ("string" == typeof i.renderer && G.Renderer[e] !== Y) t = G.Renderer[e](i); else { if ("function" != typeof e) throw new Error("Unknown renderer"); t = e(i) } if ("function" != typeof t) throw new Error("Invalid renderer defined"); return t }(i.renderer)(e, i, T, (t = e.stack, o = [], function t(e, i, n) { var a = "auto" === i.zIndex.zindex ? 0 : Number(i.zIndex.zindex), s = e, r = i.zIndex.isPositioned, o = i.zIndex.isFloated, l = { node: i }, c = n; i.zIndex.ownStacking ? (s = l.context = { "!": [{ node: i, children: [] }] }, c = Y) : (r || o) && (c = l.children = []), 0 === a && n ? n.push(l) : (e[a] || (e[a] = []), e[a].push(l)), i.zIndex.children.forEach(function (e) { t(s, e, c) }) }(n = {}, t), function s(r) { Object.keys(r).sort().forEach(function (e) { var t = [], i = [], n = [], a = []; r[e].forEach(function (e) { e.node.zIndex.isPositioned || e.node.zIndex.opacity < 1 ? n.push(e) : e.node.zIndex.isFloated ? i.push(e) : t.push(e) }), function t(e) { e.forEach(function (e) { a.push(e), e.children && t(e.children) }) }(t.concat(i, n)), a.forEach(function (e) { e.context ? s(e.context) : o.push(e.node) }) }) }(n), o), G); var t, n, o }, G.Util.Support = function (e, n) { return { rangeBounds: (a = !1, n.createRange && (t = n.createRange()).getBoundingClientRect && ((i = n.createElement("boundtest")).style.height = "123px", i.style.display = "block", n.body.appendChild(i), t.selectNode(i), 123 === t.getBoundingClientRect().height && (a = !0), n.body.removeChild(i)), a), svgRendering: e.svgRendering && function () { var e = new Image, t = n.createElement("canvas"), i = t.getContext !== Y && t.getContext("2d"); if (!1 === i) return !1; t.width = t.height = 10, e.src = ["data:image/svg+xml,", "<svg xmlns='http://www.w3.org/2000/svg' width='10' height='10'>", "<foreignObject width='10' height='10'>", "<div xmlns='http://www.w3.org/1999/xhtml' style='width:10;height:10;'>", "sup", "</div>", "</foreignObject>", "</svg>"].join(""); try { i.drawImage(e, 0, 0), t.toDataURL() } catch (e) { return !1 } return G.Util.log("html2canvas: Parse: SVG powered rendering available"), !0 }() }; var t, i, a }, k.html2canvas = function (e, t) { var i, n, a = { logging: !1, elements: e = e.length ? e : [e], background: "#fff", proxy: null, timeout: 0, useCORS: !1, allowTaint: !1, svgRendering: !1, ignoreElements: "IFRAME|OBJECT|PARAM", useOverflow: !0, letterRendering: !1, chinese: !1, width: null, height: null, taintTest: !0, renderer: "Canvas" }; return a = G.Util.Extend(t, a), G.logging = a.logging, a.complete = function (e) { "function" == typeof a.onpreloaded && !1 === a.onpreloaded(e) || (i = G.Parse(e, a), "function" == typeof a.onparsed && !1 === a.onparsed(i) || (n = G.Renderer(i, a), "function" == typeof a.onrendered && a.onrendered(n))) }, k.setTimeout(function () { G.Preload(a) }, 0), { render: function (e, t) { return G.Renderer(e, G.Util.Extend(t, a)) }, parse: function (e, t) { return G.Parse(e, G.Util.Extend(t, a)) }, preload: function (e) { return G.Preload(G.Util.Extend(e, a)) }, log: G.Util.log } }, k.html2canvas.log = G.Util.log, k.html2canvas.Renderer = { Canvas: Y }, G.Renderer.Canvas = function (a) { a = a || {}; var s = T, r = [], o = T.createElement("canvas"), l = o.getContext("2d"), d = G.Util, u = a.canvas || s.createElement("canvas"); function h(e, t) { switch (t.type) { case "variable": e[t.name] = t.arguments; break; case "function": switch (t.name) { case "createPattern": if (0 < t.arguments[0].width && 0 < t.arguments[0].height) try { e.fillStyle = e.createPattern(t.arguments[0], "repeat") } catch (e) { d.log("html2canvas: Renderer: Error creating pattern", e.message) } break; case "drawShape": i = e, n = t.arguments, i.beginPath(), n.forEach(function (e) { i[e.name].apply(i, e.arguments) }), i.closePath(); break; case "drawImage": 0 < t.arguments[8] && 0 < t.arguments[7] && (!a.taintTest || a.taintTest && function (e) { if (-1 === r.indexOf(e.arguments[0].src)) { l.drawImage(e.arguments[0], 0, 0); try { l.getImageData(0, 0, 1, 1) } catch (e) { return o = s.createElement("canvas"), l = o.getContext("2d"), !1 } r.push(e.arguments[0].src) } return !0 }(t)) && e.drawImage.apply(e, t.arguments); break; default: e[t.name].apply(e, t.arguments) } }var i, n } return function (e, t, i, n, a) { var s, r, o, l = u.getContext("2d"), c = e.stack; return u.width = u.style.width = t.width || c.ctx.width, u.height = u.style.height = t.height || c.ctx.height, o = l.fillStyle, l.fillStyle = d.isTransparent(c.backgroundColor) && t.background !== Y ? t.background : e.backgroundColor, l.fillRect(0, 0, u.width, u.height), l.fillStyle = o, n.forEach(function (e) { l.textBaseline = "bottom", l.save(), e.transform.matrix && (l.translate(e.transform.origin[0], e.transform.origin[1]), l.transform.apply(l, e.transform.matrix), l.translate(-e.transform.origin[0], -e.transform.origin[1])), e.clip && (l.beginPath(), l.rect(e.clip.left, e.clip.top, e.clip.width, e.clip.height), l.clip()), e.ctx.storage && e.ctx.storage.forEach(function (e) { h(l, e) }), l.restore() }), d.log("html2canvas: Renderer: Canvas renderer done - returning canvas obj"), 1 === t.elements.length && "object" == typeof t.elements[0] && "BODY" !== t.elements[0].nodeName ? (r = a.Util.Bounds(t.elements[0]), (s = i.createElement("canvas")).width = Math.ceil(r.width), s.height = Math.ceil(r.height), (l = s.getContext("2d")).drawImage(u, r.left, r.top, r.width, r.height, 0, 0, r.width, r.height), u = null, s) : u } } }(window, document), define("html2canvas", function () { }), define("components/waybillStub/waybillStub", ["popHeightView", "templates", "jspdf", "helper", "jqprint", "JqueryRotate", "JsBarcode", "html2canvas"], function (e, a, l, n) { return e.extend({ template: a.moreInfo, events: { "click .signedBill": "fetchsignedBill", "click .rotate": "rotateReceipt", "click .print-receipt": "printReceipt", "click .download-receipt": "downloadReceipt", "click .download-stub": "downloadStub", "click .print-stub": "printStub" }, init: function (e) { this.waybillId = e.waybillId, this.isSecurityExpress = e.isSecurityExpress, this.latestInfo = e.latestInfo, this.deliveryTm = e.deliveryTm, this.refresh = !0 }, render: function () { this.$el.html(this.template()), this.showBillInfo() }, showBillInfo: function () { var i = this, e = layer.load(); sfAjax.electronicStub({ data: { id: this.waybillId, securityExpress: this.isSecurityExpress }, success: function (e) { if (e && 0 === e.code && e.result) { var t = _.filter(e.result.feeList, function (e) { return "1" != e.feeCode }); i.$("#waybillDetail").html(a.moreInfoDetail({ result: i.model, latestInfo: i.latestInfo, deliveryTm: i.deliveryTm, data: e.result })), i.$("#electronicStub").html(a.billInfoElectronicStub({ payType: n.getPayType(e.result.payType), data: e.result, feeListWidthoutTotalFee: t })), i.getBarCode(i.waybillId), i.changeDeliveryRecord() } }, error: function () { layer.msg(_l("获取失败")) }, complete: function () { layer.close(e), i.show() }, login: { succCallback: i.showBillInfo.bind(i), cancelCallback: null } }) }, changeDeliveryRecord: function () { var n = this; sfAjax.queryAcceptableService({ data: { billNo: this.waybillId }, success: function (e) { var t = _.filter(e.serviceInfoList, function (e) { return 8 == e.type })[0], i = _.filter(e.serviceInfoList, function (e) { return 7 == e.type || 22 == e.type || 23 == e.type || 24 == e.type || 25 == e.type })[0]; n.$("#changeRecord").html(a.changeDeliverRecored({ contact: t, timeAndAddr: i })) } }) }, fetchsignedBill: function () { if (this.refresh) { var e = layer.load(), i = this, t = n.getSiteLanguage(); -1 < ["th", "ru", "vi", "ge", "fr"].indexOf(t) && (t = "en"), sfAjax.signFigure({ data: { id: this.waybillId, head: !0 }, langRegion: { lang: t, region: n.getSiteLocation() }, success: function (e) { if (e && void 0 === e.code) { var t = n.getRESTfulDomain("memberBills/" + i.waybillId + "/image?lang=sc&region=cn"); i.loadPic(t), i.refresh = !1 } }, complete: function () { layer.close(e) }, login: { succCallback: i.fetchsignedBill.bind(i), cancelCallback: null } }) } }, loadPic: function (e) { var t = this, i = new Image; i.src = e; var n = layer.load(); i.onload = function () { t.$("#signedBill").html(a.billInfoSignedBill()), t.$(".signing-receipt").append(this), layer.close(n) }, i.onerror = function () { layer.close(n) } }, rotateReceipt: function () { 0 < this.$(".signing-receipt img").length ? this.$(".signing-receipt img").rotateRight() : 0 < this.$(".signing-receipt canvas").length && this.$(".signing-receipt canvas").rotateRight() }, printReceipt: function () { if (0 < this.$(".signing-receipt img").length) this.$(".signing-receipt img").jqprint(); else if (0 < this.$(".signing-receipt canvas").length) { var e = this.$(".signing-receipt canvas")[0], t = new Image; t.src = e.toDataURL("image/jpeg", 1), $(t).jqprint() } }, downloadReceipt: function () { var e; if (0 < this.$(".signing-receipt img").length) { var t = this.$(".signing-receipt img")[0]; (e = document.createElement("canvas")).width = t.width, e.height = t.height, e.getContext("2d").drawImage(t, 0, 0, t.width, t.height), this.downloadPdf(e, _l("签收底单") + "_" + this.waybillId) } else 0 < this.$(".signing-receipt canvas").length && (e = this.$(".signing-receipt canvas")[0], this.downloadPdf(e, _l("签收底单") + "_" + this.waybillId)) }, getBarCode: function (e) { JsBarcode("#barcode", e, { width: 2, height: 50, displayValue: !0, text: e, textAlign: "justify" }); var t = this.$("#barcode")[0], i = new Image; i.src = t.toDataURL("image/png", 1), $(t).after(i).remove() }, htmlToCanvas: function (e, t) { var i = layer.load(); html2canvas(e, { onrendered: function (e) { layer.close(i), t(e) } }) }, downloadPdf: function (e, t) { var i = e.toDataURL("image/png", 1), n = new l("", "pt", "a4"), a = e.width, s = e.height, r = parseInt((595 - a) / 2), o = parseInt((842 - s) / 2); n.addImage(i, "PNG", r, o, a, s), n.save(t + ".pdf") }, downloadStub: function () { if (this.stubCanvas) this.downloadPdf(this.stubCanvas, _l("电子存根") + "_" + this.waybillId); else { var t = this; this.htmlToCanvas($("#electronicStub table")[0], function (e) { t.stubCanvas = e, t.downloadPdf(t.stubCanvas, _l("电子存根") + "_" + this.waybillId) }.bind(this)) } }, printStub: function () { this.$(".electronicStub").jqprint() } }) }), define("views/query/waybill/routesDetail", ["baseView", "templates", "moment", "helper"], function (e, t, i, n) { return e.extend({ template: t.routesDetail, render: function () { this.$el.html(this.template(this.handleData(this.model))), this.$(".dashed-line").css("height", this.$(".route-list").height() - 78 + "px"), this.model.routes.length < 2 && this.$(".dashed-line").hide() }, handleData: function (e) { var i = this; if (e.routes && e.routes.length) { var n = e.routes.length - 1; _.each(e.routes, function (e, t) { e.img = i.getImageUrl(e.opState.type, t, n) }) } return e }, getImageUrl: function (e, t, i) { return 0 !== t ? t === i && 0 < i && ("collect" === e || "pickedup" === e) ? n.getResourceURL("images/waybill/status-collect.png") : n.getResourceURL("images/waybill/status-transporting.png") : "collect" === e || "pickedup" === e ? n.getResourceURL("images/waybill/status-collect-cur.png") : "delivery" === e || "other" === e || "invalid" === e ? n.getResourceURL("images/waybill/status-delivery.png") : "signed" === e ? n.getResourceURL("images/waybill/status-signed.png") : void 0 } }) }), define("views/query/waybill/map", ["utils/mapLoader"], function (t) { return { createMap: function (e) { t.load(this.initGaodeMap.bind(this, e)) }, initGaodeMap: function (e) { if (!this.hasCreatedMap) { var t = this, i = "bill-map-" + this.model.id; this.$("#map").attr("id", i), e.unDrawPoint ? this.map = new AMap.Map(i, { zoom: 3, scrollWheel: !1 }) : (this.map = new AMap.Map(i, { zoom: 11, scrollWheel: !1 }), AMap.plugin(["AMap.ToolBar", "AMap.Geolocation"], function () { t.map.addControl(new AMap.ToolBar), t.map.addControl(new AMap.Geolocation), t.getPointData().done(t.drawMapPath.bind(t)) }), this.hasCreatedMap = !0) } }, getPointData: function () { var n = $.Deferred(); return this.self ? $.when(this.getSenderLocation(), this.getReceiverLocation(), this.getSiteCoordinates()).done(function (e, t, i) { n.resolve(e, t, i) }) : this.getSiteCoordinates().then(function (e) { n.resolve(null, null, e) }), n }, getSenderLocation: function () { var t = $.Deferred(); return sfAjax.getLocalByAddress({ params: { cc: 1, address: this.waybillInfo.consignorAddr, exact: 1, city: this.model.originOld, ak: _webConfig.gisKey, span: 1 }, success: function (e) { t.resolve({ longitude: e.result.xcoord, latitude: e.result.ycoord }) } }), t }, getReceiverLocation: function () { var t = $.Deferred(); return sfAjax.getLocalByAddress({ params: { cc: 1, address: this.waybillInfo.addresseeAddr, exact: 1, city: this.model.destinationOld, ak: _webConfig.gisKey, span: 1 }, success: function (e) { t.resolve({ longitude: e.result.xcoord, latitude: e.result.ycoord }) } }), t }, getSiteCoordinates: function () { var t = $.Deferred(), i = []; return _.each(this.model.routes, function (e) { -1 === i.indexOf(e.zoneCode) && i.push(e.zoneCode) }), i.reverse(), sfAjax.coordinates({ data: { geometryCodes: i.join(",") }, success: function (e) { 0 === e.code && t.resolve(e.result) } }), t }, handlerPoints: function (e, t, i) { var n = [], a = this.getStatusByOpcode(); if (e) { if (e.pointType = "start", "collect" === a.type || "pickedup" === a.type) return e.text = a.name, [e]; n.push(e) } return _.each(i, function (e, t) { e.pointType = "middle", t === i.length - 1 && "signed" !== a.type && "delivery" !== a.type && (e.text = a.name), n.push(e) }), t && (t.pointType = "end", "signed" !== a.type && "delivery" !== a.type || (t.text = a.name), n.push(t)), n }, drawMapPath: function (e, t, i) { var n = this.handlerPoints(e, t, i), a = this, s = [], r = [], o = !1; _.each(n, function (e) { var t = [e.longitude, e.latitude], i = "middle" === e.pointType ? -4 : -8; 0 == t[0] && 0 == t[1] || (o ? r.push(t) : e.text ? (s.push(t), r.push(t), o = !0) : s.push(t), new AMap.Marker({ map: a.map, content: a.getMapInfo(e), position: t, offset: new AMap.Pixel(i, i) })) }); var l = new AMap.Polyline({ path: s, strokeColor: "#333", strokeWeight: 2, strokeStyle: "solid" }), c = new AMap.Polyline({ path: r, strokeColor: "red", strokeWeight: 2, strokeStyle: "dashed" }); l.setMap(this.map), c.setMap(this.map), this.map.setFitView([l, c]) }, getMapInfo: function (e) { return '<div class="map-point-' + e.pointType + '">' + (e.text ? '<div class="map-status">' + _l(e.text) + "</div>" : "") + "</div>" } } }), define("views/query/components/evaluateBill", ["baseView", "templates", "event"], function (e, t, i) { return e.extend({ template: t.evaluateBill, layerOpts: { title: _l("服务评价"), area: "680px", skin: "line", fixed: !1 }, events: { "click .evaluate-courier a.tag": "selectCourierTags", "input .evaluate-courier .fill-content": "validateCourierInput", "click .evaluate-courier .select-confirm": "submitCourier", "click .evaluate-SF a.tag": "selectSFTags", "input .evaluate-SF .fill-content": "validateSFInput", "click .evaluate-SF .select-confirm": "submitSF" }, init: function (e) { this.billInfo = e.billInfo, this.courierTags = {}, this.sfTags = {}, this.getEvaluateTagsJSON() }, render: function () { this.$el.html(this.template(this.billInfo.courierInfo)); var t = this; this.$(".evaluate-courier a.item").on("click", function (e) { t.scoreCourier(e) }), this.$(".evaluate-SF a.item").on("click", function (e) { t.scoreSF(e) }), 1 != this.billInfo.sendEvaluate && 1 != this.billInfo.recEvaluate && this.isExceedDeadline(), this.judgeEvaluateCourier(), this.judgeEvaluateSF() }, handleParam: function () { return { waybillNo: this.billInfo.waybillNo, courierNo: this.billInfo.courierInfo.empNo, type: this.billInfo.isSender ? "0" : "1" } }, judgeEvaluateCourier: function () { var t = this; sfAjax.queryEvaluateCourier({ data: this.handleParam(), success: function (e) { e && 0 === e.code && e.result && e.result.length && e.result[0].grade && (t.$(".evaluate-courier .star a").slice(0, e.result[0].grade).addClass("red"), t.$(".evaluate-courier .title").text(_l("已评价小哥")), t.$(".evaluate-courier .star .gray").css("font-size", "13px"), t.$(".evaluate-courier .star-label").text(_l("谢谢您的评价")).show(), t.$(".evaluate-courier a.item").off("click")) }, error: function () { layer.msg(_l("网络错误")) } }) }, judgeEvaluateSF: function () { sfAjax.queryEvaluateSF({ data: this.handleParam(), success: function (e) { e && 0 === e.code && e.result && e.result.grade && (this.$(".evaluate-SF .title").text(_l("已评价顺丰")), this.$(".evaluate-SF .star .gray").css("font-size", "13px"), this.$(".evaluate-SF .star a").slice(0, e.result.grade).addClass("red"), this.$(".evaluate-SF .star-label").text(_l("谢谢您的评价")).show(), this.$(".evaluate-SF a.item").off("click")) }, error: function () { layer.msg(_l("网络错误")) } }) }, isExceedDeadline: function () { 4 === this.billInfo.statusCode && this.billInfo.endTime && 432e6 < (new Date).getTime() - moment(this.billInfo.endTime).valueOf() && (this.$(".evaluate-courier .title").text(_l("已超出评价期限")), this.$(".evaluate-courier .star a").css({ "font-size": "13px", color: "rgba(220, 30, 50, 0.3)" }), this.$(".evaluate-courier a.item").off("click")) }, scoreCourier: function (e) { this.scoreTarget(e, !0, this.$(".evaluate-courier .star-label"), this.$(".evaluate-courier .tag-wrapper"), this.$(".evaluate-courier .select-confirm"), 0, $.trim(this.$(".evaluate-courier .fill-content").val()).length), this.$(".evaluate-courier .other-evaluate").show(), this.$(".evaluate-courier .button-wrapper").show(), $(window).resize() }, selectCourierTags: function (e) { this.selectTags(e, !0, this.$(".evaluate-courier .select-confirm"), this.$(".evaluate-courier .star a.red").length, $.trim(this.$(".evaluate-courier .fill-content").val()).length) }, validateCourierInput: function () { this.validateInput(this.$(".evaluate-courier .star .red").length, this.$(".evaluate-courier .tag-wrapper a.selected").length, $.trim(this.$(".evaluate-courier .fill-content").val()).length, this.$(".evaluate-courier .other-evaluate .filled-num"), this.$(".evaluate-courier .select-confirm"), this.$(".evaluate-courier .error-tip")) }, submitCourier: function (e) { e.stopPropagation(); var t = this; sfAjax.evaluateCourier({ data: this.handlePostData(!0, this.$(".evaluate-courier .tag-wrapper a.selected"), this.$(".evaluate-courier .star a.red").length + "", $.trim(this.$(".evaluate-courier .fill-content").val())), success: function (e) { e && 0 === e.code && e.result ? (t.$(".evaluate-courier .title").text(_l("已评价小哥")), t.$(".evaluate-courier .star .gray").css("font-size", "13px"), t.$(".evaluate-courier .star-label").text(_l("谢谢您的评价")), t.$(".evaluate-courier .tag-wrapper").hide(), t.$(".evaluate-courier .other-evaluate").hide(), t.$(".evaluate-courier .button-wrapper").hide(), t.$(".evaluate-courier a.item").off("click"), t.billInfo.callback()) : layer.msg(_l("提交评价小哥失败")) }, error: function (e) { layer.msg(_l("提交评价小哥失败")) } }) }, handlePostData: function (e, t, i, n) { var a = []; _.each(t, function (e) { a.push({ tagId: $(e).data("id"), tagName: $(e).text(), tagType: $(e).data("type"), rate: $(e).data("rate") }) }); var s = { waybillNo: this.billInfo.waybillNo, courierNo: this.billInfo.courierInfo.empNo, grade: i, evaluate: n, tagList: a }; return this.billInfo && this.billInfo.waybillNo && (s = this.billInfo.isSender ? _.extend(s, { type: "0" }) : _.extend(s, { type: "1" })), e || delete s.courierNo, s }, scoreSF: function (e) { this.scoreTarget(e, !1, this.$(".evaluate-SF .star-label"), this.$(".evaluate-SF .tag-wrapper"), this.$(".evaluate-SF .select-confirm"), 0, $.trim(this.$(".evaluate-SF .fill-content").val()).length), this.$(".evaluate-SF .other-evaluate").show(), this.$(".evaluate-SF .button-wrapper").show(), $(window).resize() }, selectSFTags: function (e) { this.selectTags(e, !1, this.$(".evaluate-SF .select-confirm"), this.$(".evaluate-SF .star a.red").length, $.trim(this.$(".evaluate-SF .fill-content").val()).length); var t = this.$(".evaluate-SF .tag-wrapper a.tag").not(this.$(".evaluate-SF .tag-wrapper a.selected")); this.$(".evaluate-SF .tag-wrapper a.selected").length < 6 ? _.each(t, function (e) { $(e).removeAttr("disabled") }) : _.each(t, function (e) { $(e).attr("disabled", "disabled") }) }, validateSFInput: function () { this.validateInput(this.$(".evaluate-SF .star .red").length, this.$(".evaluate-SF .tag-wrapper a.selected").length, $.trim(this.$(".evaluate-SF .fill-content").val()).length, this.$(".evaluate-SF .other-evaluate .filled-num"), this.$(".evaluate-SF .select-confirm"), this.$(".evaluate-SF .error-tip")) }, submitSF: function (e) { e.stopPropagation(); var t = this; sfAjax.evaluateSF({ data: this.handlePostData(!1, this.$(".evaluate-SF .tag-wrapper a.selected"), this.$(".evaluate-SF .star a.red").length + "", $.trim(this.$(".evaluate-SF .fill-content").val())), success: function (e) { e && 0 === e.code && e.result ? (t.$(".evaluate-SF .title").text(_l("已评价顺丰")), t.$(".evaluate-SF .star .gray").css("font-size", "13px"), t.$(".evaluate-SF .star-label").text(_l("谢谢您的评价")), t.$(".evaluate-SF .tag-wrapper").hide(), t.$(".evaluate-SF .other-evaluate").hide(), t.$(".evaluate-SF .button-wrapper").hide(), t.$(".evaluate-SF a.item").off("click"), t.billInfo.callback()) : layer.msg(_l("提交评价顺丰失败")) }, error: function (e) { layer.msg(_l("提交评价顺丰失败")) } }) }, scoreTarget: function (e, t, i, n, a, s, r) { e.stopPropagation(); var o = $(e.currentTarget), l = o.prevAll(), c = o.nextAll(); o.hasClass("red") || o.addClass("red"), _.each(l, function (e) { $(e).hasClass("red") || $(e).addClass("red") }), _.each(c, function (e) { $(e).hasClass("red") && $(e).removeClass("red") }), l.length <= 2 ? (i.text(_l("一般般")).show(), n.html(this.renderEvaluateTags(t ? this.courierTags.oneLevel : this.sfTags.oneLevel))) : 3 === l.length ? (i.text(_l("比较满意")).show(), n.html(this.renderEvaluateTags(t ? this.courierTags.oneLevel : this.sfTags.oneLevel))) : 4 === l.length && (i.text(_l("非常满意")).show(), n.html(this.renderEvaluateTags(t ? this.courierTags.twoLevel : this.sfTags.twoLevel))), n.css({ display: "flex", "flex-flow": "row wrap", "justify-content": "center" }), this.validateBtnAvailable(l.length + 1, s, r, a) }, renderEvaluateTags: function (e) { var t = ""; return _.each(e, function (e) { t += '<li><a href="javascript:void(0);" class="tag primary-btn" data-id="' + e.tagId + '" data-type="' + e.tagType + '" data-rate="' + e.rate + '">' + _l(e.tagName) + "</a></li>" }), t }, selectTags: function (e, t, i, n, a) { e.stopPropagation(), $(e.currentTarget).toggleClass("selected"); var s = 0; s = t ? this.$(".evaluate-courier .tag-wrapper a.selected").length : this.$(".evaluate-SF .tag-wrapper a.selected").length, this.validateBtnAvailable(n, s, a, i) }, validateInput: function (e, t, i, n, a, s) { n.text(i), i <= 200 ? s.hide() : s.show(), this.validateBtnAvailable(e, t, i, a) }, validateBtnAvailable: function (e, t, i, n) { (3 < e || e <= 3 && 0 < t) && i <= 200 ? n.removeAttr("disabled") : n.attr("disabled", "disabled") }, getEvaluateTagsJSON: function () { var t = this; sfAjax.getJson({ url: Helper.getResourceURL("data/evaluate-tag-list.json"), success: function (e) { e ? t.handleEvaluateTags(e) : layer.msg("json文件数据不正确！") }, error: function () { layer.msg("json文件不存在！") } }) }, handleEvaluateTags: function (e) { if (e && this.billInfo) { var t = e.courierTags.oneLevel.consigneeCourier, i = e.courierTags.oneLevel.deliverCourier; this.courierTags.oneLevel = this.billInfo.isSender ? t : i, this.courierTags.twoLevel = e.courierTags.twoLevel, this.sfTags.oneLevel = e.sfTags.oneLevel, this.sfTags.twoLevel = e.sfTags.twoLevel } } }) }), define("components/changeDelivery/changeDeliveryTime", ["baseView", "templates", "moment", "utils/time", "helper"], function (e, i, d, s) { var u = "YYYY-MM-DD HH:mm", h = "HH:mm"; return e.extend({ data: { serverTime: null, dateTimes: [] }, layerOpts: { title: _l("设置派送时间"), area: "480px", skin: "line", offset: "50px" }, events: { "click .date-wrapper li": "selectDate", "click .time-wrapper li.item": "selectTime", "click .confirm-change": "comformChange", "click .left-arrow": "moveToLeft", "click .right-arrow": "moveToRight" }, init: function (e) { this.$picker = $('<div class="pickup-time-picker" style="width: 480px;border: 0;height: 400px"></div>'), this.$el.addClass("time-picker-pk").append(this.$picker), this.data.serverTime = (e.serverTime || d()).startOf("minutes"), e.dateTimes && this.setDateTimes(e.dateTimes), this.expectedDeliveryTime = e.expectedDeliveryTime, this.beginIndex = 0 }, render: function () { var e = i.changeDeliveryTime({ dates: this.dates, times: this.getTimes(this.dates[0].date) }); this.$picker.html(e); var t = this.$(".date-wrapper").find("li")[0]; $(t).addClass("cur"), $(t).attr("aria-checked", !0), this.$("input").val(this.expectedDeliveryTime) }, selectDate: function (e) { e.stopPropagation(); var t = $(e.currentTarget), i = this.$(".date-wrapper").find("li"), n = ""; i.removeClass("cur"), i.removeAttr("aria-checked"), t.addClass("cur"), t.attr("aria-checked", !0); var a = $.trim(this.$("input").val()).split(" ")[1]; a ? this.$("input").val(t.data("value") + " " + a) : this.$("input").val(t.data("value")); var s = this.getTimes(t.data("value")); _.each(s, function (e) { n += '<li role="radio" tabindex="0" data-value="' + e.start + '" class="item accessible-click' + (a === e.text ? " current" : "") + '"' + (a === e.text ? ' aria-checked="true"' : "") + "><span>" + e.text + '</span><span class="red aicon-right"></span></li>' }), this.$(".time-wrapper").html(n) }, selectTime: function (e) { var t = $(e.currentTarget), i = this.$("input"); this.showTime = t.data("value"); var n = this.$(".date-wrapper").find("li.cur")[0]; i.val($(n).data("value") + " " + t.text()), this.selectedDateTime = d(this.showTime), i.trigger("change"); var a = this.$(".time-wrapper").find("li"); a.removeClass("current"), a.removeAttr("aria-checked"), t.addClass("current"), t.attr("aria-checked", !0) }, comformChange: function () { var e = this.$("#date").val(); e && -1 != e.indexOf("~") ? (this.options.callbackSubmit(e), this.close()) : layer.msg(_l("请选择派送时间")) }, calculateDates: function () { var a = this, e = this.data.dateTimes; this.dates = [], e && e.forEach(function (e, t) { var i = e.workingTime.split("-"), n = { text: s.relativeDate(d(e.date), a.data.serverTime), date: e.date, start: a.getNextHourSharp(d(e.date + " " + i[0])), end: d(e.date + " " + i[1]).startOf("hour") }; n.times = a.calculateTimes(n, t), a.dates.push(n) }), 0 === this.dates[0].times.length ? this.dates.splice(0, 1) : this.dates.splice(-1, 1) }, calculateTimes: function (e, t) { var i = [], n = d(e.date), a = n.clone().add(9, "hour"), s = a.clone().add(3, "hour"); 0 === t ? this.data.serverTime < a && i.push({ text: a.format(h) + "~" + s.format(h), start: a.format(u) }) : i.push({ text: a.format(h) + "~" + s.format(h), start: a.format(u) }); var r = n.clone().add(12, "hour"), o = r.clone().add(6, "hour"); 0 === t ? this.data.serverTime < r && i.push({ text: r.format(h) + "~" + o.format(h), start: r.format(u) }) : i.push({ text: r.format(h) + "~" + o.format(h), start: r.format(u) }); var l = n.clone().add(18, "hour"), c = d(e.end); return 0 === t ? this.data.serverTime < l && l < c && i.push({ text: l.format(h) + "~" + c.format(h), start: l.format(u) }) : l < c && i.push({ text: l.format(h) + "~" + c.format(h), start: l.format(u) }), i }, getNextHourSharp: function (e) { return e.clone().add(59, "minute").startOf("hour") }, getTimes: function (e) { for (var t = 0; t < this.dates.length; t++) { var i = this.dates[t]; if (i.date === e) return i.times } }, setServerTime: function (e) { return this.data.serverTime = e || d(), this.calculateDates(), this }, setDateTimes: function (e) { return this.data.dateTimes = e || [], this.calculateDates(), this }, moveToLeft: function (e) { e.stopPropagation(), this.beginIndex-- , this.moveToTarget() }, moveToRight: function (e) { e.stopPropagation(), this.beginIndex++ , this.moveToTarget() }, moveToTarget: function () { this.beginIndex < 0 ? this.beginIndex = 0 : 4 < this.beginIndex ? this.beginIndex = 4 : this.$(".date-wrapper").stop().animate({ "margin-left": "-" + 156 * this.beginIndex + "px" }, 300) } }) }), define("components/changeDelivery/changeDeliveryAddr", ["baseView", "templates", "helper"], function (e, i, a) { return e.extend({ layerOpts: { title: _l("选择代收点"), area: "600px", skin: "line" }, init: function (e) { this.deliveryLong = e.longitude, this.deliveryLat = e.latitude, this.toSF = e.toSF, this.toBox = e.toBox, this.toBest = e.toBest, this.toStore = e.toStore, this.selectStoreType = "5", this.selectPointCode = "", this.selectPoint = null, this.points = [], this.allPoints = e.allPoints }, render: function () { var t = this; this.points = _.filter(this.allPoints, function (e) { return e.storeType == t.selectStoreType && t.isCanChangeDelivery() }), this.$el.html(i.changeDeliveryAddr({ points: this.points, selectStoreType: this.selectStoreType, selectPointCode: this.selectPointCode })), this.loadMap() }, events: { "click .store-wrapper li": "selectPointType", "click .point-wrapper li.item": "selectStorePoint", "click .confirm-change": "comformChange" }, loadMap: function () { window.AMap ? this.createMap() : sfAjax.getScript({ url: _cmsConfig.mapSrc, success: function () { this.createMap() }.bind(this) }) }, selectPointType: function (e) { var t = $(e.currentTarget); this.selectStoreType = t.data("value"), this.render(), e.stopPropagation() }, isCanChangeDelivery: function () { return !("1" != this.selectStoreType || !this.toSF) || (!("2" != this.selectStoreType || !this.toStore) || (!("3" != this.selectStoreType || !this.toBest) || !("5" != this.selectStoreType || !this.toBox))) }, selectStorePoint: function (e) { var t = this, i = $(e.currentTarget); t.selectPointCode = i.data("value"), t.selectPoint = _.filter(this.points, function (e) { return e.code == t.selectPointCode })[0], this.createMark(), this.addActiveClass(i), e.stopPropagation() }, addActiveClass: function (e) { this.$(e).closest(".point-wrapper").find(".aicon").removeClass("aicon-right"), this.$(e).closest(".point-wrapper").find(".item-name").removeClass("item-active"), this.$(e).find(".aicon").addClass("aicon-right"), this.$(e).find(".item-name").addClass("item-active") }, comformChange: function () { null != this.selectPoint ? (this.options.callbackSubmit(this.selectPoint), this.close()) : layer.msg(_l("请选择网点")) }, createMark: function () { var t = this, i = a.getResourceURL("images/changeDelivery/icon-normal.png"), e = a.getResourceURL("images/changeDelivery/icon-active.png"); t.points.forEach(function (e) { new AMap.Marker({ map: t.map, icon: i, position: [e.longitude, e.latitude], offset: new AMap.Pixel(-13, -30) }) }); var n = _.filter(t.points, function (e) { return e.code == t.selectPointCode }); 0 < n.length && new AMap.Marker({ map: t.map, icon: e, position: [n[0].longitude, n[0].latitude], offset: new AMap.Pixel(-13, -30) }) }, createMap: function () { var e = a.getResourceURL("images/changeDelivery/icon-addr.png"); this.map = new AMap.Map("netmap", { zoom: 11, scrollWheel: !1 }); var t = new AMap.Marker({ icon: e, position: [this.deliveryLong, this.deliveryLat], offset: new AMap.Pixel(-13, -30) }); t.setTitle(_l("收件地址")), t.setLabel({ offset: new AMap.Pixel(-10, -25), content: "<div class='info'>" + _l("收件地址") + "<div class='line-class'></div></div>" }), t.setMap(this.map), this.createMark(), this.map.setFitView() } }) }), define("components/changeDelivery/changeDeliveryReceiver", ["baseView", "templates", "helper", "verify"], function (e, t, i, n) { return e.extend({ layerOpts: { title: _l("更改收件人信息"), area: "600px", skin: "line" }, init: function (e) { this.contactName = e.contactName, this.contactPhone = e.contactPhone }, render: function () { this.$el.html(t.changeDeliveryReceiver({ contactName: this.contactName, contactPhone: this.contactPhone })) }, events: { "input #contactName": "valContactName", "input #contactPhone": "valContactPhone", "click .receiver-confirm": "comformChange" }, comformChange: function () { var e = this.$("#contactName").val(), t = this.$("#contactPhone").val(); this.valContactName() && this.valContactPhone() && (this.contactName != e || this.contactPhone != t ? (this.options.callbackSubmit(e, t), this.close()) : layer.msg(_l("您没有修改任何信息"))) }, valContactPhone: function () { var e = this.$("#contactPhone").val(); return n.isTelCn(e) || n.isMobile(e) ? (this.$(".phone-error").hide(), !0) : (this.$(".phone-error").show(), !1) }, valContactName: function () { return 20 < this.$("#contactName").val().length ? (this.$(".name-error").show(), !1) : (this.$(".name-error").hide(), !0) } }) }), define("components/changeDelivery/changeDelivery", ["baseView", "templates", "models/cityWorkingTime", "./changeDeliveryTime", "./changeDeliveryAddr", "./changeDeliveryReceiver"], function (e, t, i, n, a, s) { return e.extend({ layerOpts: { title: _l("更改派送"), area: "600px", skin: "line" }, init: function (e) { this.cityWorkingTime = new i, this.awsmId = e.awsmId, this.waybillNo = e.waybillNo, this.contactName = e.contactName, this.contactPhone = e.contactPhone, this.newContactName = e.newContactName, this.deliverDate = e.deliverDate, this.deliverTimeMin = e.deliverTimeMin, this.deliverTimeMax = e.deliverTimeMax, this.networkStoreName = e.networkStoreName, this.expectedDeliveryTime = e.expectedDeliveryTime, this.serviceCode = "", this.canEditContact = e.modifyContact, this.canEditTimeOrAddr = e.modifyTimOrAddr, this.baiduLongitude = "", this.baiduLatitude = "", this.gaodeLongitude = "", this.gaodeLatitude = "", this.getLocalByAddress(e.address, e.city, 1), this.getLocalByAddress(e.address, e.city, 2) }, render: function () { this.$el.html(t.changeDelivery({ contactName: this.newContactName ? this.newContactName : this.contactName, contactPhone: this.options.newContactPhone ? this.options.newContactPhone : this.contactPhone, deliverDate: this.deliverDate, deliverTime: this.deliverTimeMin ? this.deliverTimeMin + "~" + this.deliverTimeMax : "", storeTypeName: this.getStoreTypeNameForFill(this.options.storeType), networkStoreName: this.networkStoreName, networkStoreAddress: this.options.networkStoreAddress, expectedDeliveryTime: this.expectedDeliveryTime })), this.cityWorkingTime.getServerCurrentTime() }, events: { "click .time-change": "changeDeliveryTim", "click .addr-change": "changeDeliveryAddr", "click .receiver-change": "changeDeliveryReceiver" }, changeDeliveryReceiver: function (e) { e && e.stopPropagation(), Helper.isAppleWaybill(this.waybillNo) || Helper.isHuaweiWaybill(this.waybillNo) ? layer.msg(_l("不可变更，请联系95338进行改派")) : this.canEditContact ? new s({ contactName: this.contactName, contactPhone: this.contactPhone, callbackSubmit: this.changeReceiverCallBack.bind(this) }) : layer.msg(_l("收件人信息已变更成功，暂不支持再次修改")) }, changeDeliveryTim: function (e) { if (e && e.stopPropagation(), this.canEditTimeOrAddr) if (this.expectedDeliveryTime) { var t = this.cityWorkingTime.get("synServerTim"); this.cityWorkingTime.getCityWorkingTime({ cityCode: this.options.cityCode, address: this.options.address, addressType: 2, bookingTime: moment(t).format("YYYY-MM-DD HH:mm:ss"), dayNum: 7 }); var i = this.cityWorkingTime.get("dateTimes"); i && 0 < i.length && new n({ serverTime: t, dateTimes: i, expectedDeliveryTime: this.expectedDeliveryTime, callbackSubmit: this.changeTimeCallBack.bind(this) }) } else layer.msg(_l("目前暂无预计最晚送达时间，不可修改派送时间")); else layer.msg(_l("派送方式已修改，不可再次修改")) }, changeDeliveryAddr: function (e) { e && e.stopPropagation(), Helper.isAppleWaybill(this.waybillNo) || Helper.isHuaweiWaybill(this.waybillNo) ? layer.msg(_l("不可变更，请联系95338进行改派")) : this.canEditTimeOrAddr ? this.canChangeDelivery() ? layer.msg(_l("该票快递不可变更服务点自取，如有疑问可咨询客服热线95338，谢谢！")) : this.getMapContent(this.baiduLongitude, this.baiduLatitude, e) : layer.msg(_l("派送方式已修改，不可再次修改")) }, canChangeDelivery: function () { return !(this.options.toSF || this.options.toBox || this.options.toBest || this.options.toStore) }, getMapContent: function (e, t, i) { var n = this; if (!e || !t) return layer.msg(_l("网络错误")); this.isLocked(i) || sfAjax.getNetworkStore({ data: { longitude: e, latitude: t }, success: function (e) { e && 0 == e.code && e.result ? new a({ allPoints: e.result, toSF: n.options.toSF, toBox: n.options.toBox, toBest: n.options.toBest, toStore: n.options.toStore, longitude: n.gaodeLongitude, latitude: n.gaodeLatitude, callbackSubmit: n.changeAddressCallBack.bind(n) }) : layer.msg(_l("网络错误")) }, error: function (e) { layer.msg(_l("网络错误")) }, complete: function () { n.unlock(i) } }) }, changeReceiverCallBack: function (e, t) { this.contactName = e, this.contactPhone = t, this.serviceCode = "8"; var i = { name: e, phone: t }, n = { waybillNo: this.waybillNo, awsmId: this.awsmId, serviceCode: this.serviceCode, contact: this.contactName, phone: this.contactPhone }; this.confirmChange(n, "contact", i) }, fillChangeContact: function (e) { this.$(".contact-name").text(e.name), this.$(".contact-phone").text(e.phone) }, changeTimeCallBack: function (e) { if (e) { this.serviceCode = "7"; var t = e.split(" ")[0], i = e.split(" ")[1], n = { date: t, time: i }, a = { waybillNo: this.waybillNo, awsmId: this.awsmId, serviceCode: this.serviceCode, deliverDate: t, deliverTimeMin: i.split("~")[0], deliverTimeMax: i.split("~")[1] }; this.confirmChange(a, "time", n) } }, fillChangeTime: function (e) { this.$(".date-text").text(e.date), this.$(".time-text").text(e.time), this.$(".time-change").addClass("already-change"), this.$(".addr-change").addClass("disabled") }, changeAddressCallBack: function (e) { if (e) { this.serviceCode = 1 == e.storeType ? 22 : 2 == e.storeType ? 25 : 3 == e.storeType ? 24 : 23; var t = { waybillNo: this.waybillNo, awsmId: this.awsmId, serviceCode: this.serviceCode, address: e.address, selfPickPoint: this.cxStoreTypeToAwsm(e.storeType), selfPickPointCode: e.code, selfPickPointName: e.name }, i = { storeTypeName: this.getStoreTypeNameForFill(this.cxStoreTypeToAwsm(e.storeType)), pointName: e.name, address: e.address }; this.confirmChange(t, "Addr", i) } }, fillChangeAddr: function (e) { this.$(".store-text").text(e.storeTypeName), this.$(".point-text").text(e.pointName), this.$(".point-addr-text").text(e.address), this.$(".addr-change").addClass("already-change"), this.$(".time-change").addClass("disabled") }, getLocalByAddress: function (e, t, i) { var n = this; e && sfAjax.getLocalByAddress({ params: { cc: i || 1, address: e, exact: 1, city: t, ak: _webConfig.gisKey, span: 1 }, success: function (e) { 1 == i ? (n.gaodeLongitude = e.result.xcoord, n.gaodeLatitude = e.result.ycoord) : (n.baiduLongitude = e.result.xcoord, n.baiduLatitude = e.result.ycoord) } }) }, confirmChange: function (e, t, i) { var n = this; sfAjax.abnormalApply({ data: e, success: function () { "contact" == t ? (n.canEditContact = !1, layer.msg(_l("修改收件人联系方式成功")), n.fillChangeContact(i)) : "time" == t ? (layer.msg(_l("修改派件方式成功")), n.canEditTimeOrAddr = !1, n.fillChangeTime(i)) : "Addr" == t && (layer.msg(_l("修改派件方式成功")), n.canEditTimeOrAddr = !1, n.fillChangeAddr(i)), n.queryAcceptableService() }, error: function () { layer.msg(_l("网络错误")) } }) }, queryAcceptableService: function () { var t = this; sfAjax.queryAcceptableService({ data: { billNo: t.waybillNo }, success: function (e) { t.awsmId = e.awsmId }, error: function () { layer.msg(_l("网络错误")) } }) }, cxStoreTypeToAwsm: function (e) { return { 1: "3", 2: "1", 3: "5", 5: "2" }[e] }, getStoreTypeNameForFill: function (e) { return "3" == e ? _l("门店") : "1" == e ? _l("便利店") : "5" == e ? _l("顺丰优选") : "2" == e ? _l("丰巢智能柜") : void 0 } }) }), define("views/query/waybill/baseBillItem", ["baseView", "templates", "moment", "helper", "components/waybillStub/waybillStub", "event", "./routesDetail", "./map", "../components/evaluateBill", "components/changeDelivery/changeDelivery", "const", "bus/index"], function (e, t, a, s, i, n, r, o, l, c, d, u) { var h = { signed: ["已签收", "80", "8000_1"], invalid: ["已作废", "8000_2"], delivery: ["派送中", "44", "34", "33", "122", "123", "630", "640", "83", "47", "634", "125", "204", "70_5", "70_7", "70_65"], collect: ["已揽收", "50"], pickedup: ["已取件", "54"], other: ["运送中"] }; return e.extend(_.extend({ template: t.detailSendOut, init: function (e) { if (this.showLogin = e.showLogin, this.vip = e.vip, this.self = s.isSender(e.model.billType) || s.isReceiver(e.model.billType), this.statusObj = this.getStatusByOpcode(this.model.routes[0]), this.customInit(e), this.mapModel = e.mapModel, !e.vip) { var t = s.getArrayFromCookie("billNOs"); (t = _.without(t, this.model.id)).unshift(this.model.id), s.setArrayToCookie("billNOs", t, 6), n.trigger(n.nearlyBillCookied) } }, login: function () { n.trigger(n.impNeedlogin, { succCallback: function () { $("#queryBill").trigger("click") }, cancelCallback: null }) }, showBillInfo: function (e) { this.isRootMenu && new i({ waybillId: this.$(e.currentTarget).attr("id").split("-")[1], isSecurityExpress: this.isSecurityExpress, latestInfo: this.getLatestInfo(this.model), deliveryTm: this.getDeliveryTm(this.model), model: this.model }) }, evaluate: function () { var t = this; s.isSender(this.model.billType) && this.waybillInfo.consigneeEmpCode || s.isReceiver(this.model.billType) && this.waybillInfo.deliverEmpCode ? sfAjax.getCourierInfo({ data: { courierNo: this.getCourierNo(), bno: this.model.id }, success: function (e) { new l({ billInfo: { waybillNo: t.model.id, isSender: s.isSender(t.model.billType), statusCode: "signed" === t.statusObj.type ? 4 : "", endTime: t.model.routes[0].scanDateTime, courierInfo: e, sendEvaluate: t.sendEvaluate, recEvaluate: t.recEvaluate, callback: function () { t.$(".btn-wrap .aicon-agree").removeClass("red") }.bind(t) } }) }, error: function () { layer.msg(_l("系统繁忙，请稍后再试")) } }) : layer.msg(_l("系统繁忙，请稍后再试")) }, render: function () { var t = this; this.$el.html(this.template(this.getRenderData(this.model))), this.self ? this.getWaybillDetails().then(function (e) { t.isSecurityExpress = e.securityExpress, t.mapModel && t.createMap({ unDrawPoint: e.securityExpress }), t.getExpressServiceEvent(e.securityExpress) }) : (this.mapModel && this.createMap({}), t.getExpressServiceEvent()), new r({ el: this.$(".routes-wrapper"), model: this.getRoutesData() }) }, getRenderData: function (e) { return { result: e, certifiedShippingImgUrl: this.getCertifiedShippingImgUrl(e), deliveryTm: this.getDeliveryTm(e), isRootMenu: this.isRootMenu, statusObj: this.statusObj, hasChildSet: e.childSet && e.childSet.length, showLogin: this.showLogin, canEvaluate: this.judgeIfEvaluate(this.model.billType, this.statusObj.type), canChangeDelivery: this.judgeIfChangeDelivery(e, this.statusObj.type), mapModel: this.mapModel } }, getWaybillDetails: function () { var t = this, i = $.Deferred(); return sfAjax.getWaybillDetails({ data: { billNo: this.model.id }, success: function (e) { e && 0 === e.code && e.result && (t.waybillInfo = e.result, t.judgeEvaluateCourier(), i.resolve(e.result)), t.getCourierInfo() }, error: function () { layer.msg(_l("获取运单详情失败")) } }), i }, getCourierNo: function () { var e = ""; return "1" == this.model.billType ? e = this.waybillInfo.consigneeEmpCode : "2" == this.model.billType ? e = this.waybillInfo.deliverEmpCode : "3" == this.model.billType && ("signed" == this.statusObj.type ? e = this.waybillInfo.deliverEmpCode : -1 < ["delivery", "collect", "pickedup", "other"].indexOf(this.statusObj.type) && (e = this.waybillInfo.consigneeEmpCode)), e }, judgeEvaluateCourier: function () { var t = this; sfAjax.queryEvaluateCourier({ data: { waybillNo: this.model.id, courierNo: this.getCourierNo(), type: s.isSender(this.model.billType) ? "0" : "1" }, success: function (e) { 0 === e.code && e.result && e.result.length && e.result[0].grade && (t.$(".btn-wrap .aicon-agree").removeClass("red"), s.isSender(t.model.billType) ? t.sendEvaluate = "1" : t.recEvaluate = "1") }, error: function () { layer.msg(_l("网络错误")) } }) }, getCourierInfo: function () { var t = this, i = this.statusObj; this.waybillInfo && this.waybillInfo.deliverEmpCode ? sfAjax.getCourierInfo({ data: { courierNo: this.waybillInfo.deliverEmpCode, bno: this.model.id }, success: function (e) { "delivery" !== i.type && "signed" !== i.type || (t.setCourierInfo(e.empName, e.telPhone, e.grade), e.empNo || (t.$(".man-info .courier-info").hide(), t.$(".man-info .courier-tel").hide(), t.$(".man-info .not-assign").show())) }, error: function () { t.setCourierInfo(_l("顺丰小哥"), "95338", 4.9) }, login: { succCallback: t.getCourierInfo.bind(t), cancelCallback: null } }) : "delivery" === i.type ? (this.$(".man-info .courier-info").hide(), this.$(".man-info .courier-tel").hide(), this.$(".man-info .not-assign").show()) : "signed" === i.type && this.setCourierInfo(_l("顺丰小哥"), "95338", 4.9) }, setCourierInfo: function (e, t, i) { i = i ? i + "" : "4.90", this.$(".man-info .man-name").html(e || _l("顺丰小哥")), this.$(".man-info .contact-phone").html(t || "95338"), this.$(".man-info .number").html(i), this.$(".man-info .none").css("width", i / 5 * 100 + "%") }, getCertifiedShippingImgUrl: function (e) { var t = e.internationalExpressFlag; return t ? s.getResourceURL("images/certified_shipping/" + t + ".png") : null }, getDeliveryTm: function (e) { if ("hk" !== s.getSiteLocation() && ("en" === s.getSiteLanguage() || "sc" === s.getSiteLanguage()) && !1 === e.signed && e.dynamicExpectedDeliveryTm && e.destination) { var t = e.dynamicExpectedDeliveryTm, i = t.substring(0, 0 <= t.indexOf("+") ? t.indexOf("+") : t.length); if (e.delay) return ""; var n = a(i).format("MMM Do"); return { date: "sc" === s.getSiteLanguage() ? n.replace(/\s/, "") : n, time: a(i).format("HH:mm"), datetime: a(i).format("YYYY.MM.DD HH:mm") } } }, getRoutesData: function () { var t = this, i = []; return this.model.routes && this.model.routes.length && _.each(this.model.routes, function (e) { i.push(t.handlerRouteInfo(e, t.model.limitTypeCode)) }), { routes: i } }, handlerRouteInfo: function (e, t) { var i = { scanDateTime: a(e.scanDateTime).format("YYYY-MM-DD HH:mm"), remark: "", opState: this.getStatusByOpcode(e) }; if (e.remark) { var n = e.remark.replace('id="opr_phone"', 'class="route-phone"'); "ru" === s.getSiteLocation() && ("T13" === t && "31" === e.opCode && _.contains(d.VIRTUAL_T13, e.zoneCode) ? n += _l("Tip31") : "T14" === t && "204" === e.opCode && _.contains(d.VIRTUAL_T14, e.zoneCode) && (n = _l("Tip204"))), i.remark = n } return i }, getLatestInfo: function (e) { if (e.routes && e.routes.length) return this.handlerRouteInfo(e.routes[0], e.limitTypeCode) }, getExpressServiceEvent: function (e) { if (e) this.$(".warm-reminder").html(_l("提示：该运单为隐址件暂不开放地图路由查询，请查看文字路由信息")).show(); else if ("cn" === s.getSiteLocation() && "sc" === s.getSiteLanguage()) { var t = this; this.model.sourceCityCode && this.model.destCityCode && sfAjax.bpsQueryOrderExceptionInfo({ params: { srcCityCode: this.model.sourceCityCode, destCityCode: this.model.destCityCode, waybillNo: this.model.id }, data: { productCode: this.model.productCode, consignedTm: this.model.routes[0].scanDateTime, srcZoneCode: this.model.sourceCityCode, destZoneCode: this.model.destCityCode, limitTypeCode: t.model.limitTypeCode, cargoTypeCode: t.model.cargoTypeCode, expressTypeCode: t.model.expressTypeCode, srcAddress: t.waybillInfo && t.waybillInfo.addresseeAddr, destAddress: t.waybillInfo && t.waybillInfo.consignorAddr }, success: function (e) { 0 === e.code && e.result.notificationMsg && t.$(".warm-reminder").html(e.result.notificationMsg).show() } }) } }, getStatusByOpcode: function (e) { var t = "other"; for (var i in e = e || this.model.routes[0], h) { -1 < h[i].indexOf(e.opCode) && (t = i) } return { name: h[t][0], date: a(e.scanDateTime).format("MMM Do"), time: a(e.scanDateTime).format("HH:mm"), type: t } }, judgeIfEvaluate: function (e, t) { return s.isSender(e) ? -1 < ["signed", "delivery", "collect", "pickedup", "other"].indexOf(t) : s.isReceiver(e) ? -1 < ["signed"].indexOf(t) : void 0 }, judgeIfChangeDelivery: function (e, t) { return -1 < ["delivery", "collect", "pickedup", "other"].indexOf(t) && s.isReceiver(e.billType) && !s.isHK_MC_TW(e.destCityCode) && !s.isInternational(e.destCityCode) && s.supportChangeDelivery(e.productCode, e.isIssuedPrefrence) && "en" != s.getSiteLanguage() }, changeDelivery: function (e) { e && e.stopPropagation(); var t = this; this.isLocked(e) || sfAjax.queryAcceptableService({ data: { billNo: this.model.id }, success: function (e) { t.handleChangeDelivery(e) }, error: function () { layer.msg(_l("网络错误")) }, complete: function () { t.unlock(e) } }) }, handleChangeDelivery: function (e) { var t = _.filter(e.serviceInfoList, function (e) { return 8 == e.type })[0], i = _.filter(e.serviceInfoList, function (e) { return -1 != [7, 22, 23, 24, 25].indexOf(e.type) })[0], n = { awsmId: e.awsmId, waybillNo: this.model.id, city: e.city, cityCode: e.cityCode, expectedDeliveryTime: this.model.expectedDeliveryTimeEnd, address: e.address, contactName: e.contactName, contactPhone: e.contactPhone, modifyContact: e.modifyContact, modifyTimOrAddr: null == i, newContactName: t ? t.name : "", newContactPhone: t ? t.phone : "", deliverDate: i ? i.deliverDate : "", deliverTimeMin: i ? i.deliverTimeMin : "", deliverTimeMax: i ? i.deliverTimeMax : "", storeType: i ? i.networkStoreType : "", networkStoreName: i ? i.networkStoreName : "", networkStoreAddress: i ? i.networkStoreAddress : "", toSF: e.toSF, toBox: e.toBox && !s.isOnlyChangeToSF(e.cargoTypeCode), toBest: e.toBest && !s.isOnlyChangeToSF(e.cargoTypeCode), toStore: e.toStore && !s.isOnlyChangeToSF(e.cargoTypeCode) }; new c(n) } }, o)) }), define("views/query/waybill/childItem", ["./baseBillItem"], function (e) { return e.extend({ events: { "click .tabs li": "tabsToggle", "click .a_link_login": "login", "click .show-details-btn": "showBillInfo" }, customInit: function () { this.isRootMenu = !1 } }) }), define("views/query/waybill/childManager", ["./baseBillManager", "./childItem"], function (e, n) { return e.extend({ customInit: function () { this.isRootMenu = !1 }, renderItem: function (e, t, i) { this.items.push(new n({ el: e, model: t, vip: this.vip, showLogin: !$.cookie("loginUser") && 0 === i, mapModel: this.mapModel })) } }) }), define("views/query/waybill/billItem", ["./baseBillItem", "./childManager"], function (e, t) { return e.extend({ events: { "click .tabs li": "tabsToggle", "click .a_link_login": "login", "click .show-details-btn": "showBillInfo", "click .child-details .title": "showChildDetail", "click .child-details .bottom": "hideChildDetail", "click .evaluate-btn": "evaluate", "click .changeDelivery-btn": "changeDelivery" }, customInit: function () { this.isRootMenu = !0 }, showChildDetail: function () { this.$(".child-details .title").addClass("active"), this.$(".title .aicon-chevron-double-down").hide(), this.childManager || (this.childManager = new t({ el: this.$(".route-details"), billIds: this.model.childSet, vip: this.vip })), this.$(".route-details").slideDown(), this.$(".child-details .bottom").show() }, hideChildDetail: function () { this.$(".route-details").slideUp(), this.$(".child-details .bottom").hide(), this.$(".child-details .title").removeClass("active"), this.$(".title .aicon-chevron-double-down").show() } }) }), define("views/query/waybill/billManager", ["./baseBillManager", "./billItem"], function (e, n) { return e.extend({ customInit: function () { this.isRootMenu = !0 }, renderItem: function (e, t, i) { this.items.push(new n({ el: e, model: t, vip: this.vip, showLogin: !$.cookie("loginUser") && 0 === i, mapModel: this.mapModel })) } }) }), define("components/operators/change/index", ["baseView", "components/changeDelivery/changeDelivery"], function (e, s) { return function (e) { var a = e.data; if (!a.waybillno) return layer.msg(_l("网络错误")); sfAjax.queryAcceptableService({ data: { billNo: a.waybillno }, success: function (e) { var t = _.filter(e.serviceInfoList, function (e) { return 8 == e.type })[0], i = _.filter(e.serviceInfoList, function (e) { return -1 != [7, 22, 23, 24, 25].indexOf(e.type) })[0], n = { awsmId: e.awsmId, waybillNo: a.waybillno, city: e.city, cityCode: e.cityCode, expectedDeliveryTime: a.time, address: e.address, contactName: e.contactName, contactPhone: e.contactPhone, modifyContact: e.modifyContact, modifyTimOrAddr: null == i, newContactName: t ? t.name : "", newContactPhone: t ? t.phone : "", deliverDate: i ? i.deliverDate : "", deliverTimeMin: i ? i.deliverTimeMin : "", deliverTimeMax: i ? i.deliverTimeMax : "", storeType: i ? i.networkStoreType : "", networkStoreName: i ? i.networkStoreName : "", networkStoreAddress: i ? i.networkStoreAddress : "", toSF: e.toSF, toBox: e.toBox && !Helper.isOnlyChangeToSF(e.cargoTypeCode), toBest: e.toBest && !Helper.isOnlyChangeToSF(e.cargoTypeCode), toStore: e.toStore && !Helper.isOnlyChangeToSF(e.cargoTypeCode) }; new s(n) }, error: function () { layer.msg(_l("网络错误")) }, complete: function () { e.complete && e.complete() } }) } }), define("components/operators/delete/index", ["baseView", "bus/index"], function (e, a) { return function (i) { var n = i.data; layer.confirm(_l("是否删除订单？"), { btn: [_l("是"), _l("否")] }, function () { var e = a.isAppointment(n) ? "0" : this.isSend ? "1" : "2", t = n.appointmentNo || n.waybillno; sfAjax.deleteWayBill({ data: { abno: t, deleteType: e }, success: function () { layer.msg(_l("删除成功")), i.success && i.success() }, error: function () { layer.msg(_l("删除失败")), i.error && i.error() } }) }), i.complete && i.complete() } }), define("components/operators/digital/index", ["baseView", "components/digitalWaybill/index"], function (e, i) { return function (e) { var t = e.data; sfAjax.queryAppointBill({ data: { appointmentNo: t.appointmentNo }, success: function (e) { new i({ infoList: [e] }) }, error: function () { layer.msg(_l("网络错误")) }, complete: function () { e.complete && e.complete() } }) } }), define("components/operators/evaluate/index", ["baseView", "views/query/components/evaluateBill"], function (e, s) { return function (t) { var i = this, n = t.data, a = t.isSend; !a && n.recEmpCode || a && n.empCode ? sfAjax.getCourierInfo({ data: { courierNo: a ? n.empCode : n.recEmpCode, bno: n.waybillno }, success: function (e) { new s({ billInfo: { waybillNo: n.waybillno, isSender: a, statusCode: n.waybillStatus, endTime: n.time, courierInfo: e, sendEvaluate: n.sendEvaluate, recEvaluate: n.recEvaluate, callback: t.success.bind(i) } }) }, error: function () { layer.msg(_l("系统繁忙，请稍后再试")) }, complete: function () { t.complete && t.complete() } }) : (i.complete && i.complete(), layer.msg(_l("系统繁忙，请稍后再试"))) } }), define("components/operators/index", ["./cancel/index", "./change/index", "./delete/index", "./digital/index", "./evaluate/index", "./perfect/index"], function () { var i = {}, n = arguments; return _.each(["cancel", "change", "delete", "digital", "evaluate", "perfect"], function (e, t) { i[e] = n[t] }), i }), define("bus/query/list", ["./index", "./operate", "const"], function (r, o, n) { var l = [{ 2: { text: "运送中", irate: 3, time: "_l(预计送达时间)：${expectedDeliveryTime}" }, 3: { text: "派送中", irate: 5, time: "_l(预计送达时间)：${expectedDeliveryTime}" }, 4: { text: "已签收", irate: 6, time: "_l(签收时间)：${endTime}" }, 5: { text: "已作废", irate: 0, time: "_l(作废时间)：${endTime}" }, 8: { text: "已退回", irate: 3, time: "" }, 9: { text: "已转寄", irate: 3, time: "" }, type: "waybill", no: "_l(运单号)：${waybillno}" }, { 0: { text: "待寄出|待上门", irate: 0, time: "_l(预约上门时间)：${appointmentTime}" }, 1: { text: "待寄出|待上门", irate: 0, time: "_l(预约上门时间)：${appointmentTime}" }, 5: { text: "已揽件", irate: 1, time: "_l(揽件时间)：${endTime}" }, 7: { text: "已取消", irate: 0, time: "_l(取消时间)：${endTime}", no: "_l(运单号)：_l(无)" }, 10: { text: "已取件", irate: 1, time: "" }, 12: { text: "已关闭", irate: 0, time: "_l(关闭时间)：${endTime}", no: "_l(运单号)：_l(无)" }, type: "appointment", no: function (e) { return _l("运单号") + "：" + (e.waybillno || _l("待定")) } }, { 40038: { text: "待上门", irate: 0, time: "" }, 40039: { text: "待支付", irate: 0, time: "" }, 40040: { text: "待退款", irate: 0, time: "" }, 40041: { text: "已退款", irate: 0, time: "_l(退款时间)：${endTime}" }, 40042: { text: "已取消", irate: 0, time: "_l(取消时间)：${endTime}" }, 40043: { text: "运送中", irate: 3, time: "_l(预计派达时间)：${expectedDeliveryTime}" }, 40044: { text: "已签收", irate: 0, time: "_l(完成时间)：${endTime}" }, 40049: { text: "已拒单", irate: 0, time: "" }, 40050: { text: "可接单", irate: 0, time: "" }, type: "intraCity", no: "_l(订单号)：${appointmentNo}" }]; function c(e) { for (var t, i = /_l\(([^()]+)\)/g; t = i.exec(e);)e = e.replace(t[0], _l(t[1])), i.lastIndex = 0; return e } function d(e, t, i) { for (var n, a = /\$\{([^()]+)\}/g; n = a.exec(e);) { var s = t[n[1]]; e = e.replace(n[0], i ? i(n[1]) : s), a.lastIndex = 0 } return e } return { configs: l, handler: function (a, s) { var t, e, i = function (e) { var t, i; for (var n in r.isWaybill(e) ? (t = l[0], i = t[e.waybillStatus]) : r.isIntraCity(e) ? (t = l[2], i = t[e.appointmentStatue] || t[40042]) : (t = l[1], i = t[e.appointmentStatue] || { text: "待寄出|待上门", irate: 0, time: "" }), t) /^\d+$/.test(n) || void 0 !== i[n] || (i[n] = t[n]); return i }(a); return { no: "function" == typeof i.no ? i.no(a) : c(d(i.no, a)), text: "待寄出|待上门" === i.text ? a.pickupType === n.SCAN_SEND ? "待寄出" : "待上门" : i.text, irate: "progress" + i.irate, time: (t = !1, e = d(i.time, a, function (e) { if (a[e] || !(t = !0)) switch (e) { case "appointmentTime": return a.pickupType === n.SCAN_SEND ? void (t = !0) : moment(a[e]).add(1, "hours").format("YYYY-MM-DD HH:mm"); case "expectedDeliveryTime": case "endTime": return a[e] && moment(a[e]).format("YYYY-MM-DD HH:mm"); default: return a[e] } }), t ? "" : c(e)), origCity: a.originateCityName || _l("寄"), destCity: a.destinationCityName || _l("收"), origName: a.originateContacts || _l("暂无信息"), destName: a.destinationContacts || _l("暂无信息"), operateArr: function () { var e, t, i = []; for (e in o) if ((t = o[e]).judge(a, s)) { var n = t.className + " " + t.icon; t.maidian && (n += " maidian"), i.push(_.extend({}, t, { name: e, className: n })) } return i }() } } } }), define("views/query/list/listSimple2", ["baseView", "templates", "components/operators/index", "bus/query/list", "bus/index"], function (e, t, r, a, i) { return e.extend({ template: t.query_list_simple2, data: { type: null, pageNo: 1, pageRows: 10, primaryNo: null, getData: function () { } }, events: { "click .item": "selectItem", "click .bill-btn": "operatorClick" }, init: function (e) { this.$el.off(), this.data = _.extend({}, this.data, e), "batch" === e.type && (this.data.pageRows = 100), this.isSend = "receive" !== e.type, this.request = { send: sfAjax.getMemberSendBillInfo, receive: sfAjax.getMemberRecBillInfo, batch: sfAjax.getBatchShipChildList }[e.type], this.doRequest() }, doRequest: function (t) { var i = this, e = layer.load(), n = { pageNo: this.data.pageNo, pageRows: this.data.pageRows }; "batch" === this.data.type && (n.primaryNo = this.data.primaryNo), i.data.list = [], this.request({ data: n, success: function (e) { e.result && (i.currData = e.result.content, i.data.totalPage = e.result.totalPage, _.each(e.result.content, function (e) { i.data.list.push(a.handler(e, i.isSend)) }), i.data.getData(e.result.content)), i.renderList(), t && t() }, complete: function () { layer.close(e) } }) }, renderList: function () { var a = this; if (this.$el.html(this.template({ list: this.data.list, isSender: this.isSend, type: this.data.type })), "batch" !== this.data.type) { var e = { currentPage: this.data.pageNo, totalPages: this.data.totalPage, numberOfPages: this.data.pageRows, bootstrapMajorVersion: 3, alignment: "center", itemTexts: function (e, t) { return { first: _l("首页2"), prev: _l("上一页"), next: _l("下一页"), last: _l("末页"), page: t }[e] }, itemContainerClass: function (e, t, i) { return t === i ? "active" : "pointer-cursor" }, onPageClicked: function (e, t, i, n) { a.data.pageNo = n, a.doRequest(function () { $("html").scrollTop(290) }) } }; this.$(".pagination").bootstrapPaginator(e) } }, getItemData: function (e) { var t = $(e.currentTarget); return t.hasClass("item") || (t = t.parents(".bill-list .item")), this.currData[t.data("index")] }, selectItem: function (e) { if (!$(e.target).hasClass("bill-btn")) { var t = this.getItemData(e); if ($("html").scrollTop(0), i.isWaybill(t) || -1 < [5, 10].indexOf(t.appointmentStatue)) { if (i.isNotMyWaybill(t.billType)) return void (location.hash = "search/bill-number/" + t.waybillno); location.hash = "search/bill-number/v/" + t.waybillno } else location.hash = "search/order/" + t.appointmentNo } }, operatorClick: function (e) { var t = this, i = this.getItemData(e), n = e && e.currentTarget, a = $(n).data("operator"), s = r[a]; "evaluated" === a && (s = r.evaluate), this.isLocked(n) || new s({ data: i, isSend: this.isSend, success: this.doRequest.bind(this), complete: function () { t.unlock(n) } }) } }) }), define("views/query/list/listBatch", ["backbone", "templates", "baseView", "./listSimple2", "components/digitalWaybill/index"], function (e, a, t, r, i) { return t.extend({ data: { list: [], pager: { pageNo: 1, pageRows: 10 } }, template: a.query_list_batch, events: { "click .item": "selectBatchParentBill", "click .download": "digital" }, init: function (e) { this.$el.off(), this.data = _.extend({}, this.data, e), this.doRequest() }, doRequest: function (t) { var i = this, e = layer.load(); sfAjax.getBatchShipParentList({ data: { pageNo: this.data.pager.pageNo, pageRows: this.data.pager.pageRows }, success: function (e) { e && 0 === e.code && i.handlerData(e.result), i.render(), t && t() }, complete: function () { layer.close(e) } }) }, handlerData: function (e) { if (!e || !e.content) return this.data.list = [], void (this.data.pager.totalPage = 0); this.data.list = e.content, this.data.pager = { pageNo: e.pageNo, pageRows: e.pageRows, totalPage: e.totalPage } }, render: function () { var a = this, e = this.data.pager, t = { currentPage: e.pageNo, totalPages: e.totalPage, numberOfPages: e.pageRows, bootstrapMajorVersion: 3, alignment: "center", itemTexts: function (e, t) { switch (e) { case "first": return _l("首页2"); case "prev": return _l("上一页"); case "next": return _l("下一页"); case "last": return _l("末页"); case "page": return t } }, itemContainerClass: function (e, t, i) { return t === i ? "active" : "pointer-cursor" }, onPageClicked: function (e, t, i, n) { a.data.pager.pageNo = n, a.doRequest(function () { $("html").scrollTop(290) }) } }; this.$(".list-wrap").length || this.$el.html('<ul class="list-wrap"></ul><ul class="bootstrap-pagination"><ul class="pagination"></ul></ul>'), this.$(".list-wrap").html(this.template({ list: this.data.list })), e.totalPage ? this.$(".pagination").bootstrapPaginator(t) : this.$(".pagination").empty() }, selectBatchParentBill: function (e) { if (!$(e.target).hasClass("bill-btn")) { var i = this, t = $(e.currentTarget), n = t.data("primaryno"), a = $(".resource-info-" + n), s = $(".child-list-" + n); t.next().find(".list-wrap").length ? (s.html(""), a.html(""), t.next().hide()) : (new r({ el: s, type: "batch", primaryNo: n, pageRows: 100, getData: function (e) { var t = _.find(e, function (e) { return 1 === e.pickupType }); !t || 0 !== t.appointmentStatue && 1 !== t.appointmentStatue ? a.hide() : i.getResoureInfo(t, a) } }), t.next().show()) } }, digital: function (e) { e && e.stopPropagation(); var t = this; this.primaryNo = $(e.currentTarget).data("primaryno"), this.isLocked(e) || sfAjax.getWayBillAddrList({ data: { primaryNo: this.primaryNo }, success: function (e) { e && 0 === e.code ? new i({ infoList: t.handlerDigitalData(e.result) }) : layer.msg(_l("查询电子运单失败")) }, error: function () { layer.msg(_l("网络错误")) }, complete: function () { t.unlock(e) } }) }, handlerDigitalData: function (e) { var n = []; return _.each(e, function (e) { var t = {}; t.waybillNo = e.waybillNo, t.contactName = e.name, t.contactPhone = e.mobile, t.province = e.provinceName, t.city = e.cityName, t.county = e.countyName, t.address = e.address; var i = { appointmentDetail: t = { appointmentDestDetail: t, paymentMethod: e.paymentMethod, remark: e.remark, appointmentOriginDetail: { locationCode: e.sourceCityCode }, waybillNo: e.waybillNo } }; n.push(i) }), n }, getResoureInfo: function (e, t) { var i = { empName: _l("分配小哥中"), telPhone: "", grade: 0, date: "", time: "" }, n = e.expectedTime || moment(e.appointmentTime).add(1, "hours").format("YYYY-MM-DD HH:mm:ss"); n && (i.date = moment(n).format("MM-DD"), i.time = moment(n).format("HH:ss")), e.empCode ? sfAjax.getCourierInfo({ data: { courierNo: e.empCode, bno: e.waybillno, appointNo: e.appointmentNo }, success: function (e) { i.empName = e.empName, i.telPhone = e.telPhone, i.grade = e.grade }, error: function () { i.empName = _l("顺丰小哥") }, complete: function () { t.html(a.resourceInfo({ resource: i })) } }) : t.html(a.resourceInfo({ resource: i })) } }) }), define("views/query/list/index", ["baseView", "./listSimple2", "./listBatch", "event"], function (e, a, s, r) { return e.extend({ events: { "click .bill-tab span": "switchTab", "click .login-btn": "showLoginModal" }, init: function () { this.$el.off() }, render: function () { this.showBillList("send") }, switchTab: function (e) { var t = $(e.currentTarget).data("type"); this.showBillList(t) }, showBillList: function (e) { var t = this, i = this.$("." + e + "-tab"), n = this.$("." + e + "-list"); r.trigger(r.RegisterLoginCallback, [function () { i.click() }, function () { t.$(".no-login-wrap").show(), t.$(".bill-list").hide() }]), i.addClass("active").siblings().removeClass("active"), $(".no-login-wrap").hide(), $(".bill-list").hide(), $.cookie("loginUser") ? (n.show(), "send" === e || "receive" === e ? new a({ el: n, type: e }) : new s({ el: n })) : $(".no-login-wrap").show() }, showLoginModal: function () { var e = this; r.trigger(r.Needlogin, { succCallback: function () { e.$(".bill-tab span.active").click() } }) } }) }), define("views/query/router", ["./appointment/billDetails", "./waybill/billManager", "./list/index"], function (t, i, e) { return Backbone.Router.extend({ initialize: function (e) { this.queryInput = e.queryInput, Backbone.history.start() }, routes: { "search/bill-number/:numbers": "initWaybill", "search/bill-number/v/:numbers": "initVipWaybill", "search/order/:number": "initAppoint", "*path": "initBillList" }, initBillList: function () { $(".my-bills,.shipping-search-detail").show(), $(".route-result").hide(), new e({ el: $(".my-bills") }) }, initAppoint: function (e) { $(".my-bills,.shipping-search-detail").hide(), $(".route-result").show(), $(".openMapModel").hide(), new t({ el: $(".delivery-wrapper"), appointmentNo: e }) }, initWaybill: function (e) { $(".my-bills").hide(), $(".route-result").show(), this.queryInput.setTokens(e), new i({ el: $(".delivery-wrapper"), billIds: e }) }, initVipWaybill: function (e) { $(".my-bills").hide(), $(".route-result").show(), $(".openMapModel").hide(), this.queryInput.setTokens(e), new i({ el: $(".delivery-wrapper"), billIds: e, vip: !0 }) } }) }), function (t) { "function" == typeof define && define.amd ? define("tokenfield", ["jquery"], t) : "object" == typeof exports ? module.exports = global.window && global.window.$ ? t(global.window.$) : function (e) { if (!e.$ && !e.fn) throw new Error("Tokenfield requires a window object with jQuery or a jQuery instance"); return t(e.$ || e) } : t(jQuery) }(function (_, v) { "use strict"; var o = function (e, t) { var i = this; this.$element = _(e), this.textDirection = this.$element.css("direction"), this.options = _.extend(!0, {}, _.fn.tokenfield.defaults, { tokens: this.$element.val() }, this.$element.data(), t), this._delimiters = "string" == typeof this.options.delimiter ? [this.options.delimiter] : this.options.delimiter, this._triggerKeys = _.map(this._delimiters, function (e) { return e.charCodeAt(0) }), this._firstDelimiter = this._delimiters[0]; var n = _.inArray(" ", this._delimiters), a = _.inArray("-", this._delimiters); 0 <= n && (this._delimiters[n] = "\\s"), 0 <= a && (delete this._delimiters[a], this._delimiters.unshift("-")); var s = ["\\", "$", "[", "{", "^", ".", "|", "?", "*", "+", "(", ")"]; _.each(this._delimiters, function (e, t) { 0 <= _.inArray(t, s) && (i._delimiters[e] = "\\" + t) }); var r, o = v && "function" == typeof v.getMatchedCSSRules ? v.getMatchedCSSRules(e) : null, l = e.style.width, c = this.$element.width(); o && _.each(o, function (e, t) { t.style.width && (r = t.style.width) }); var d = "rtl" === _("body").css("direction") ? "right" : "left", u = { position: this.$element.css("position") }; u[d] = this.$element.css(d), this.$element.data("original-styles", u).data("original-tabindex", this.$element.prop("tabindex")).css("position", "absolute").css(d, "-10000px").prop("tabindex", -1), this.$wrapper = _('<div class="tokenfield form-control" />'), this.$element.hasClass("input-lg") && this.$wrapper.addClass("input-lg"), this.$element.hasClass("input-sm") && this.$wrapper.addClass("input-sm"), "rtl" === this.textDirection && this.$wrapper.addClass("rtl"); var h = this.$element.prop("id") || (new Date).getTime() + "" + Math.floor(100 * (1 + Math.random())); this.$input = _('<input type="text" class="token-input" autocomplete="off" />').appendTo(this.$wrapper).prop("placeholder", this.$element.prop("placeholder")).prop("id", h + "-tokenfield").prop("tabindex", this.$element.data("original-tabindex")); var p = _('label[for="' + this.$element.prop("id") + '"]'); if (p.length && p.prop("for", this.$input.prop("id")), this.$copyHelper = _('<input type="text" />').css("position", "absolute").css(d, "-10000px").prop("tabindex", -1).prependTo(this.$wrapper), l ? this.$wrapper.css("width", l) : r ? this.$wrapper.css("width", r) : this.$element.parents(".form-inline").length && this.$wrapper.width(c), (this.$element.prop("disabled") || this.$element.parents("fieldset[disabled]").length) && this.disable(), this.$mirror = _('<span style="position:absolute; top:-999px; left:0; white-space:pre;"/>'), this.$input.css("min-width", this.options.minWidth + "px"), _.each(["fontFamily", "fontSize", "fontWeight", "fontStyle", "letterSpacing", "textTransform", "wordSpacing", "textIndent"], function (e, t) { i.$mirror[0].style[t] = i.$input.css(t) }), this.$mirror.appendTo("body"), this.$wrapper.insertBefore(this.$element), this.$element.prependTo(this.$wrapper), this.update(), this.setTokens(this.options.tokens, !1, !1), this.listen(), !_.isEmptyObject(this.options.autocomplete)) { var f = "rtl" === this.textDirection ? "right" : "left", m = _.extend({ minLength: this.options.showAutocompleteOnFocus ? 0 : null, position: { my: f + " top", at: f + " bottom", of: this.$wrapper } }, this.options.autocomplete); this.$input.autocomplete(m) } if (!_.isEmptyObject(this.options.typeahead)) { var g = _.extend({ minLength: this.options.showAutocompleteOnFocus ? 0 : null }, this.options.typeahead); this.$input.typeahead(null, g), this.typeahead = !0 } this.$element.trigger("tokenfield:initialize") }; o.prototype = { constructor: o, createToken: function (e, t) { "string" == typeof e && (e = { value: e, label: e }), void 0 === t && (t = !0); var i = this, n = _.trim(e.value), a = e.label && e.label.length ? _.trim(e.label) : n; if (n.length && a.length && !(n.length < this.options.minLength)) if (this.options.limit && this.getTokens().length >= this.options.limit) this.options.leakCallback && this.options.leakCallback(); else { var s = _.Event("tokenfield:preparetoken"); if (s.token = { value: n, label: a }, this.$element.trigger(s), s.token) { if (n = s.token.value, a = s.token.label, !this.options.allowDuplicates && _.grep(this.getTokens(), function (e) { return e.value === n }).length) { var r = _.Event("tokenfield:preventduplicate"); r.token = { value: n, label: a }, this.$element.trigger(r); var o = this.$wrapper.find('.token[data-value="' + n + '"]').addClass("duplicate"); return setTimeout(function () { o.removeClass("duplicate") }, 250), !1 } var l = _('<div class="token" />').attr("data-value", n).append('<span class="token-label" />').append('<a href="#" class="close" tabindex="-1">&times;</a>'); this.$input.hasClass("tt-input") ? this.$input.parent().before(l) : this.$input.before(l), this.$input.css("width", this.options.minWidth + "px"); var c = l.find(".token-label"), d = l.find(".close"); this.maxTokenWidth || (this.maxTokenWidth = this.$wrapper.width() - d.outerWidth() - parseInt(d.css("margin-left"), 10) - parseInt(d.css("margin-right"), 10) - parseInt(l.css("border-left-width"), 10) - parseInt(l.css("border-right-width"), 10) - parseInt(l.css("padding-left"), 10) - parseInt(l.css("padding-right"), 10), parseInt(c.css("border-left-width"), 10), parseInt(c.css("border-right-width"), 10), parseInt(c.css("padding-left"), 10), parseInt(c.css("padding-right"), 10), parseInt(c.css("margin-left"), 10), parseInt(c.css("margin-right"), 10)), c.text(a).css("max-width", this.maxTokenWidth - 5), l.on("mousedown", function (e) { if (i.disabled) return !1; i.preventDeactivation = !0 }).on("click", function (e) { return !i.disabled && (i.preventDeactivation = !1, e.ctrlKey || e.metaKey ? (e.preventDefault(), i.toggle(l)) : void i.activate(l, e.shiftKey, e.shiftKey)) }).on("dblclick", function (e) { if (i.disabled || !i.options.allowEditing) return !1; i.edit(l) }), d.on("click", _.proxy(this.remove, this)); var u = _.Event("tokenfield:createtoken"); u.token = s.token, u.relatedTarget = l.get(0), this.$element.trigger(u); var h = _.Event("change"); return h.initiator = "tokenfield", t && this.$element.val(this.getTokensList()).trigger(h), this.update(), this.$input.get(0) } } }, setTokens: function (e, t, i) { if (e) { t || this.$wrapper.find(".token").remove(), void 0 === i && (i = !0), "string" == typeof e && (e = this._delimiters.length ? e.split(new RegExp("[" + this._delimiters.join("") + "]")) : [e]); var n = this; return _.each(e, function (e, t) { n.createToken(t, i) }), this.$element.get(0) } }, getTokenData: function (e) { var t = e.map(function () { var e = _(this); return { value: e.attr("data-value"), label: e.find(".token-label").text() } }).get(); return 1 == t.length && (t = t[0]), t }, getTokens: function (e) { var t = this, i = [], n = e ? ".active" : ""; return this.$wrapper.find(".token" + n).each(function () { i.push(t.getTokenData(_(this))) }), i }, getTokensList: function (e, t, i) { var n = (e = e || this._firstDelimiter) + ((t = null != t ? t : this.options.beautify) && " " !== e ? " " : ""); return _.map(this.getTokens(i), function (e) { return e.value }).join(n) }, getInput: function () { return this.$input.val() }, listen: function () { var n = this; this.$element.on("change", _.proxy(this.change, this)), this.$wrapper.on("mousedown", _.proxy(this.focusInput, this)), this.$input.on("focus", _.proxy(this.focus, this)).on("blur", _.proxy(this.blur, this)).on("paste", _.proxy(this.paste, this)).on("keydown", _.proxy(this.keydown, this)).on("keypress", _.proxy(this.keypress, this)).on("keyup", _.proxy(this.keyup, this)), this.$copyHelper.on("focus", _.proxy(this.focus, this)).on("blur", _.proxy(this.blur, this)).on("keydown", _.proxy(this.keydown, this)).on("keyup", _.proxy(this.keyup, this)), this.$input.on("keypress", _.proxy(this.update, this)).on("keyup", _.proxy(this.update, this)), this.$input.on("autocompletecreate", function () { var e = _(this).data("ui-autocomplete").menu.element, t = n.$wrapper.outerWidth() - parseInt(e.css("border-left-width"), 10) - parseInt(e.css("border-right-width"), 10); e.css("min-width", t + "px") }).on("autocompleteselect", function (e, t) { return n.createToken(t.item) && (n.$input.val(""), n.$input.data("edit") && n.unedit(!0)), !1 }).on("typeahead:selected", function (e, t, i) { n.createToken(t) && (n.$input.typeahead("val", ""), n.$input.data("edit") && n.unedit(!0)) }).on("typeahead:autocompleted", function (e, t, i) { n.createToken(n.$input.val()), n.$input.typeahead("val", ""), n.$input.data("edit") && n.unedit(!0) }), _(v).on("resize", _.proxy(this.update, this)) }, keydown: function (a) { if (this.focused) { var s = this; switch (a.keyCode) { case 8: if (!this.$input.is(document.activeElement)) break; this.lastInputValue = this.$input.val(); break; case 37: e("rtl" === this.textDirection ? "next" : "prev"); break; case 38: t("prev"); break; case 39: e("rtl" === this.textDirection ? "prev" : "next"); break; case 40: t("next"); break; case 65: if (0 < this.$input.val().length || !a.ctrlKey && !a.metaKey) break; this.activateAll(), a.preventDefault(); break; case 9: case 13: if (this.$input.data("ui-autocomplete") && this.$input.data("ui-autocomplete").menu.element.find("li:has(a.ui-state-focus)").length) break; if (this.$input.hasClass("tt-input") && this.$wrapper.find(".tt-cursor").length) break; if (this.$input.hasClass("tt-input") && this.$wrapper.find(".tt-hint").val().length) break; if (this.$input.is(document.activeElement) && this.$input.val().length || this.$input.data("edit")) return this.createTokensFromInput(a, this.$input.data("edit")); if (13 === a.keyCode) { if (!this.$copyHelper.is(document.activeElement) || 1 !== this.$wrapper.find(".token.active").length) break; if (!s.options.allowEditing) break; this.edit(this.$wrapper.find(".token.active")) } }this.lastKeyDown = a.keyCode } function e(e) { if (s.$input.is(document.activeElement)) { if (0 < s.$input.val().length) return; e += "All"; var t = s.$input.hasClass("tt-input") ? s.$input.parent()[e](".token:first") : s.$input[e](".token:first"); if (!t.length) return; s.preventInputFocus = !0, s.preventDeactivation = !0, s.activate(t), a.preventDefault() } else s[e](a.shiftKey), a.preventDefault() } function t(e) { if (a.shiftKey) { if (s.$input.is(document.activeElement)) { if (0 < s.$input.val().length) return; var t = s.$input.hasClass("tt-input") ? s.$input.parent()[e + "All"](".token:first") : s.$input[e + "All"](".token:first"); if (!t.length) return; s.activate(t) } var i = "prev" === e ? "next" : "prev", n = "prev" === e ? "first" : "last"; s.firstActiveToken[i + "All"](".token").each(function () { s.deactivate(_(this)) }), s.activate(s.$wrapper.find(".token:" + n), !0, !0), a.preventDefault() } } }, keypress: function (e) { if (this.lastKeyPressCode = e.keyCode, this.lastKeyPressCharCode = e.charCode, -1 !== _.inArray(e.charCode, this._triggerKeys) && this.$input.is(document.activeElement)) return this.$input.val() && this.createTokensFromInput(e), !1 }, keyup: function (e) { if (this.preventInputFocus = !1, this.focused) { switch (e.keyCode) { case 8: if (this.$input.is(document.activeElement)) { if (this.$input.val().length || this.lastInputValue.length && 8 === this.lastKeyDown) break; this.preventDeactivation = !0; var t = this.$input.hasClass("tt-input") ? this.$input.parent().prevAll(".token:first") : this.$input.prevAll(".token:first"); if (!t.length) break; this.activate(t) } else this.remove(e); break; case 46: this.remove(e, "next") }this.lastKeyUp = e.keyCode } }, focus: function (e) { this.focused = !0, this.$wrapper.addClass("focus"), this.$input.is(document.activeElement) && (this.$wrapper.find(".active").removeClass("active"), this.firstActiveToken = null, this.options.showAutocompleteOnFocus && this.search()) }, blur: function (e) { this.focused = !1, this.$wrapper.removeClass("focus"), this.preventDeactivation || this.$element.is(document.activeElement) || (this.$wrapper.find(".active").removeClass("active"), this.firstActiveToken = null), !this.preventCreateTokens && (this.$input.data("edit") && !this.$input.is(document.activeElement) || this.options.createTokensOnBlur) && this.createTokensFromInput(e), this.preventDeactivation = !1, this.preventCreateTokens = !1 }, paste: function (e) { var t = this; try { if (clipboardData) { var i = clipboardData.getData("Text"); /^\d/.test(i) && (e.clipData = i.replace(/^\s+|\s+$/g, "").replace(/(\r\n|\n|\r)/gm, " ")) } } catch (e) { } setTimeout(function () { t.createTokensFromInput(e) }, 1) }, change: function (e) { "tokenfield" !== e.initiator && this.setTokens(this.$element.val()) }, createTokensFromInput: function (e, t) { if (e.clipData && this.$input.val(e.clipData), !(this.$input.val().length < this.options.minLength)) { var i = this.getTokensList(); return this.setTokens(this.$input.val(), !0), i == this.getTokensList() && this.$input.val().length ? !1 : (this.$input.hasClass("tt-input") ? this.$input.typeahead("val", "") : this.$input.val(""), this.$input.data("edit") && this.unedit(t), !1) } }, next: function (e) { if (e) { var t = this.$wrapper.find(".active:first"); if (!(!t || !this.firstActiveToken) && t.index() < this.firstActiveToken.index()) return this.deactivate(t) } var i = this.$wrapper.find(".active:last").nextAll(".token:first"); i.length ? this.activate(i, e) : this.$input.focus() }, prev: function (e) { if (e) { var t = this.$wrapper.find(".active:last"); if (!(!t || !this.firstActiveToken) && t.index() > this.firstActiveToken.index()) return this.deactivate(t) } var i = this.$wrapper.find(".active:first").prevAll(".token:first"); i.length || (i = this.$wrapper.find(".token:first")), i.length || e ? this.activate(i, e) : this.$input.focus() }, activate: function (e, t, i, n) { if (e) { if (void 0 === n) n = !0; if (i) t = !0; if (this.$copyHelper.focus(), t || (this.$wrapper.find(".active").removeClass("active"), n ? this.firstActiveToken = e : delete this.firstActiveToken), i && this.firstActiveToken) { var a = this.firstActiveToken.index() - 2, s = e.index() - 2, r = this; this.$wrapper.find(".token").slice(Math.min(a, s) + 1, Math.max(a, s)).each(function () { r.activate(_(this), !0) }) } e.addClass("active"), this.$copyHelper.val(this.getTokensList(null, null, !0)).select() } }, activateAll: function () { var t = this; this.$wrapper.find(".token").each(function (e) { t.activate(_(this), 0 !== e, !1, !1) }) }, deactivate: function (e) { e && (e.removeClass("active"), this.$copyHelper.val(this.getTokensList(null, null, !0)).select()) }, toggle: function (e) { e && (e.toggleClass("active"), this.$copyHelper.val(this.getTokensList(null, null, !0)).select()) }, edit: function (e) { if (e) { var t = e.data("value"), i = e.find(".token-label").text(), n = _.Event("tokenfield:edittoken"); if (n.token = { value: t, label: i }, n.relatedTarget = e.get(0), this.$element.trigger(n), n.token) { t = n.token.value, i = n.token.label, e.find(".token-label").text(t); var a = e.outerWidth(), s = this.$input.hasClass("tt-input") ? this.$input.parent() : this.$input; e.replaceWith(s), this.preventCreateTokens = !0, this.$input.val(t).select().data("edit", !0).width(a), this.update() } } }, unedit: function (e) { if ((this.$input.hasClass("tt-input") ? this.$input.parent() : this.$input).appendTo(this.$wrapper), this.$input.data("edit", !1), this.$mirror.text(""), this.update(), e) { var t = this; setTimeout(function () { t.$input.focus() }, 1) } }, remove: function (e, t) { if (!this.$input.is(document.activeElement) && !this.disabled) { var i = "click" === e.type ? _(e.target).closest(".token") : this.$wrapper.find(".token.active"); if ("click" !== e.type) { if (!t) t = "prev"; if (this[t](), "prev" === t) var n = 0 === i.first().prevAll(".token:first").length } var a = _.Event("tokenfield:removetoken"); a.token = this.getTokenData(i); var s = _.Event("change"); s.initiator = "tokenfield", i.remove(), this.$element.val(this.getTokensList()).trigger(a).trigger(s), this.$wrapper.find(".token").length && "click" !== e.type && !n || this.$input.focus(), this.$input.css("width", this.options.minWidth + "px"), this.update(), e.preventDefault(), e.stopPropagation() } }, update: function (e) { var t = this.$input.val(), i = parseInt(this.$input.css("padding-left"), 10) + parseInt(this.$input.css("padding-right"), 10); if (this.$input.data("edit")) { if (t || (t = this.$input.prop("placeholder")), t === this.$mirror.text()) return; this.$mirror.text(t); var n = this.$mirror.width() + 10; if (n > this.$wrapper.width()) return this.$input.width(this.$wrapper.width()); this.$input.width(n) } else { if (this.$input.css("width", this.options.minWidth + "px"), "rtl" === this.textDirection) return this.$input.width(this.$input.offset().left + this.$input.outerWidth() - this.$wrapper.offset().left - parseInt(this.$wrapper.css("padding-left"), 10) - i - 1); this.$input.width(this.$wrapper.offset().left + this.$wrapper.width() + parseInt(this.$wrapper.css("padding-left"), 10) - this.$input.offset().left - i - 2) } }, focusInput: function (e) { if (!_(e.target).closest(".token").length && !_(e.target).closest(".token-input").length) { var t = this; setTimeout(function () { t.$input.focus() }, 0) } }, search: function () { this.$input.data("ui-autocomplete") && this.$input.autocomplete("search") }, disable: function () { this.disabled = !0, this.$input.prop("disabled", !0), this.$element.prop("disabled", !0), this.$wrapper.addClass("disabled") }, enable: function () { this.disabled = !1, this.$input.prop("disabled", !1), this.$element.prop("disabled", !1), this.$wrapper.removeClass("disabled") }, destroy: function () { this.$element.val(this.getTokensList()), this.$element.css(this.$element.data("original-styles")), this.$element.prop("tabindex", this.$element.data("original-tabindex")); var e = _('label[for="' + this.$input.prop("id") + '"]'); return e.length && e.prop("for", this.$element.prop("id")), this.$element.insertBefore(this.$wrapper), this.$element.removeData("original-styles"), this.$element.removeData("original-tabindex"), this.$element.removeData("bs.tokenfield"), this.$wrapper.remove(), this.$element } }; var e = _.fn.tokenfield; return _.fn.tokenfield = function (n, a) { var s, r = []; Array.prototype.push.apply(r, arguments); var e = this.each(function () { var e = _(this), t = e.data("bs.tokenfield"), i = "object" == typeof n && n; "string" == typeof n && t && t[n] ? (r.shift(), s = t[n].apply(t, r)) : t || "string" == typeof n || a || e.data("bs.tokenfield", t = new o(this, i)) }); return void 0 !== s ? s : e }, _.fn.tokenfield.defaults = { minWidth: 60, minLength: 0, allowDuplicates: !1, allowEditing: !0, limit: 0, autocomplete: {}, typeahead: {}, showAutocompleteOnFocus: !1, createTokensOnBlur: !1, delimiter: ",", beautify: !0 }, _.fn.tokenfield.Constructor = o, _.fn.tokenfield.noConflict = function () { return _.fn.tokenfield = e, this }, o }), define("components/tokenInput", ["underscore", "baseView", "utils/checkUtils", "tokenfield"], function (t, e, i) { return e.extend({ data: { numbers: null, limitCallback: null, formatCallback: null }, init: function (e) { this.data.numbers = e.numbers, this.data.limitCallback = e.limitCallback, this.data.formatCallback = e.formatCallback, this.setupTokenField() }, setupTokenField: function () { var t = this; this.$el.on("tokenfield:removetoken", t.validate.bind(this)).on("tokenfield:createtoken", function (e) { i.billNumber(e.token.value) || $(e.relatedTarget).addClass("invalid"), t.validate() }).on("tokenfield:preventduplicate", t.validate.bind(this, "duplicate")).tokenfield({ createTokensOnBlur: !0, delimiter: [",", "\n", "\t", " ", "，"], limit: 20, minWidth: 90, leakCallback: function () { t.data.limitCallback(!1) } }), this.input = this.$el.parent().children(".token-input"), this.placeholder = this.input.attr("placeholder") }, validate: function (e) { var t = this.getTokens(); return this.data.limitCallback(t.length <= 20), this.data.formatCallback("duplicate" !== e && i.billNumbers(t)), this.placeHolderToggle(), i.billNumbers(t) }, getTokens: function () { var e = this.$el.tokenfield("getTokens"); return t.map(e, function (e) { return e.value.toUpperCase() }) }, clear: function () { this.$(".token-input").val(""), this.$el.tokenfield("setTokens", []), this.$el.trigger("tokenfield:removetoken") }, createToken: function (e) { this.$el.tokenfield("createToken", e) }, setTokens: function (e) { this.$el.tokenfield("setTokens", e.toUpperCase().commaReplace().split(",")) }, placeHolderToggle: function () { if (0 === this.getTokens().length) { var e = this.$el.parent(), t = e.offset().left + e.width() + parseInt(e.css("padding-left"), 10) - this.input.offset().left - 1; this.input.attr("placeholder", this.placeholder).width(t) } else this.input.attr("placeholder", "") } }) }), define("views/query/components/queryInput", ["baseView", "event", "components/tokenInput", "helper"], function (e, t, i, n) { return e.extend({ init: function () { this.listenTo(t, t.nearlyBillCookied, this.renderNearlyBillNO) }, render: function () { var t = this; this.tokenInput = new i({ el: this.$(".bill-number-input"), numbers: "", limitCallback: function (e) { e ? t.$(".error[data-error=limit-exceeded]").hide() : (t.$(".token-input").val(""), t.$(".error[data-error=limit-exceeded]").show()) }, formatCallback: function (e) { e ? t.$(".error[data-error=bill-number-format]").hide() : t.$(".error[data-error=bill-number-format]").show() } }), this.renderNearlyBillNO() }, events: { "click .primary-button": "query", "click .clear-inputs": "clearInputs", "click .bill-number-list-content a": "fillInputToken", "click .nearly-records .remove": "deleteRecord" }, renderNearlyBillNO: function () { var t = "", e = n.getArrayFromCookie("billNOs"); _.each(e, function (e) { t += '<li><a data-bill="' + e + '">' + e + '</a><span class="remove">×</span></li>' }), this.$(".nearly-records").html(t) }, query: function () { var e = this.tokenInput.getTokens() + ""; this.tokenInput.validate() ? n.setHash("search/bill-number/" + e) : this.$(".delivery-wrapper").empty() }, clearInputs: function () { this.tokenInput.clear(), this.$(".error").hide() }, fillInputToken: function (e) { this.tokenInput.createToken($(e.target).data("bill").toString()) }, deleteRecord: function (e) { var t = $(e.currentTarget); n.delArrayItemFromCookie("billNOs", t.siblings("a").text()), t.parent().remove() }, setTokens: function (e) { this.tokenInput.setTokens(e) } }) }), define("views/query/index", ["baseView", "templates", "./router", "event", "const", "./components/queryInput"], function (e, t, i, n, a, s) { return e.extend({ template: t.query, events: { "click .go-to-bill-list": "closeRouteResult", 'change .openMapModel input[type="checkbox"]': "mapModelChange" }, render: function () { this.$el.html(this.template()), this.queryInput = new s({ el: this.$(".shipping-search-detail") }); var e = localStorage.getItem(a.OPEN_MAP_MODEL_KEY); e = null === e ? "1" : e, this.$('.openMapModel input[type="checkbox"]').prop("checked", "1" === e), new i({ queryInput: this.queryInput }) }, closeRouteResult: function () { window.location.hash = "" }, mapModelChange: function () { var e = this.$('.openMapModel input[type="checkbox"]').prop("checked"); localStorage.setItem(a.OPEN_MAP_MODEL_KEY, e ? 1 : 0), n.trigger("mapModelChange", e) } }) }), define("components/waybillStub/abroadWaybillStub", ["baseView", "templates", "jqprint", "JqueryRotate", "JsBarcode"], function (e, n) { return e.extend({ template: n.moreInfo, layerOpts: { title: " ", area: "580px", skin: "line" }, events: { "click .rotate": "rotatePic", "click .signedBill": "fetchsignedBill", "click .print": "printPic", "click li.tab-li": "tabChange" }, init: function (e) { this.waybillId = e.waybillId, this.latestInfo = e.latestInfo, this.deliveryTm = e.deliveryTm, this.refresh = !0, this.picHasLoaded = !1 }, render: function () { this.$el.html(this.template({})), this.showBillInfo() }, showBillInfo: function () { var i = this, e = layer.load(); sfAjax.electronicStub({ data: { id: this.waybillId }, success: function (e) { if (e && 0 === e.code && e.result) { var t = _.filter(e.result.feeList, function (e) { return "1" != e.feeCode }); i.$("#waybillDetail").html(n.moreInfoDetail({ result: i.model, latestInfo: i.latestInfo, deliveryTm: i.deliveryTm, data: e.result })), i.$("#electronicStub").html(n.billInfoElectronicStub({ payType: i.getPayType(e.result), data: e.result, feeListWidthoutTotalFee: t })), i.getBarCode(i.waybillId) } }, error: function () { layer.msg(_l("获取失败")) }, complete: function () { layer.close(e) }, login: { succCallback: i.showBillInfo.bind(i), cancelCallback: null } }) }, fetchsignedBill: function () { if (this.refresh) { var e = layer.load(), t = this, i = Helper.getSiteLanguage(); -1 < ["th", "ru", "vi", "ge", "fr"].indexOf(i) && (i = "en"), sfAjax.signFigure({ data: { id: this.waybillId, head: !0 }, langRegion: { lang: i, region: Helper.getSiteLocation() }, success: function (e) { e && void 0 === e.code && (t.$("#signedBill").html(n.billInfoSignedBill({ data: Helper.getRESTfulDomain("memberBills/" + t.waybillId + "/image?lang=sc&region=cn") })), t.judgepicLoad(), t.refresh = !1) }, complete: function () { layer.close(e), $(window).resize() }, login: { succCallback: t.fetchsignedBill.bind(t), cancelCallback: null } }) } }, getBarCode: function (e) { JsBarcode("#barcode", e, { width: 2, height: 50, displayValue: !0, text: e, textAlign: "justify" }) }, tabChange: function () { setTimeout(function () { $(window).resize() }) }, rotatePic: function () { this.picHasLoaded && (0 < this.$(".signBillPic").length ? this.$(".signBillPic").rotateRight() : this.$("canvas").rotateRight(), this.$("canvas").css({ width: "100%" })) }, printPic: function () { this.picHasLoaded && this.signBillPic.jqprint() }, getPayType: function (e) { return "1" == e.payType ? "寄付现结" : "2" == e.payType ? "到付" : "3" == e.payType ? "第三方付" : "4" == e.payType ? "寄付月结" : "5" == e.payType ? "到付月结" : "" }, judgepicLoad: function () { var e = this, t = setInterval(function () { "visible" === e.$(".signBillPic").css("visibility") && 0 != e.$(".signBillPic").css("width") && (e.picHasLoaded = !0, e.signBillPic = e.$(".signBillPic").clone(), clearInterval(t)) }) } }) }), define("views/query/abroad/billDetailItem", ["require", "plugins/tencentCaptcha", "baseView", "templates", "moment", "helper", "components/waybillStub/abroadWaybillStub", "event", "./billDetails", "const"], function (n, e, t, i, a, s, r, o, l, c) { var d = { 2: { state: "2", className: "sfi-cancelled", txt: "已作废" }, 3: { state: "3", className: "sfi-turnto", txt: "已转寄" }, 4: { state: "4", className: "sfi-sendBack", txt: "已退回" }, 5: { state: "5", className: "sfi-fastener", txt: "已扣件" }, 6: { state: "6", className: "sfi-lost", txt: "已遗失" }, 99: { state: "99", className: "delivering", txt: "运送中" }, 100: { state: "100", className: "delivered", txt: "已签收" } }; return t.extend({ template: i.waybillResult2, events: { "click .tabs li": "tabsToggle", "click .a_link_login": "login", "click .delivery-brief": "preshowBillInfo", "click .status-update-tab": "showRoutesByDate" }, init: function (e) { this.isRootMenu = e.isRootMenu }, tabsToggle: function (e) { var t = $(e.currentTarget); if (t.data("tab")) { if (t.hasClass("active")) return t.removeClass("active").attr("aria-expanded", "false"), void this.$(".tab-details").slideUp(300); this.$(".tabs li").removeClass("active").attr("aria-expanded", "false"), t.addClass("active").attr("aria-expanded", "true"); var i = t.data("tab"); "waybill-childRoute" === i && (this.billDetails = new (n("./billDetails"))({ el: this.$(".childRoute-update"), isRootMenu: !1, billIds: this.model.childSet.join(",") })), this.$(".tab-details>li[data-detail=" + i + "]").siblings().hide().end().trigger("showTabDetail").show().parent().slideDown(300) } }, login: function () { o.trigger(o.impNeedlogin, { succCallback: function () { $("#queryBill").trigger("click") }, cancelCallback: null }) }, preshowBillInfo: function (e) { this.isRootMenu && this.$(e.currentTarget).hasClass("mybill") && new r({ waybillId: this.$(e.currentTarget).attr("id").split("-")[1], latestInfo: this.getLatestInfo(this.model), deliveryTm: this.getDeliveryTm(this.model), model: this.model }) }, showRoutesByDate: function (e) { e.stopPropagation(), $(e.target).parents(".status-update-box").toggleClass("open") }, render: function () { this.$el.html(this.template(this.handleData(this.model))); var e = s.getArrayFromCookie("billNOs"); (e = _.without(e, this.model.id)).unshift(this.model.id), s.setArrayToCookie("billNOs", e, 6), o.trigger(o.nearlyBillCookied); var t = this.model.childSet; this.isRootMenu && t && t.length && this.$(".tabs-wrapper").show(), this.showRoutes() }, handleData: function (t) { var i = this, n = []; t.routes && t.routes.length && _.each(t.routes, function (e) { n.push(i.handlerRouteInfo(e, t.limitTypeCode)) }); var e = _.groupBy(t.routes, function (e) { return a(e.scanDateTime).format("YYYY-MM-DD") }); return { result: this.model, expressState: this.getExpressState(this.model), certifiedShippingImgUrl: this.getCertifiedShippingImgUrl(this.model), latestInfo: this.getLatestInfo(this.model), deliveryTm: this.getDeliveryTm(this.model), isCNlocation: "cn" == s.getSiteLocation(), isRootMenu: this.isRootMenu, groupRoute: _.pairs(e) } }, showRoutes: function () { this.$(".tabs-wrapper .tabs>li").addClass("accessible-click").attr("tabindex", "0").attr("role", "tab").attr("aria-expanded", "false"), this.$(".tabs-wrapper .tabs>li[data-tab=waybill-status]").addClass("active").attr("aria-expanded", "true"), this.$(".tab-details>li[data-detail=waybill-status]").trigger("showTabDetail").show(), this.$(".tab-details").slideDown(300) }, getExpressState: function (e) { return d[e.expressState] || (e.signed ? d[100] : d[99]) }, getCertifiedShippingImgUrl: function (e) { var t = e.internationalExpressFlag; return t ? s.getResourceURL("images/certified_shipping/" + t + ".png") : null }, getDeliveryTm: function (e) { if ("hk" !== s.getSiteLocation() && ("en" === s.getSiteLanguage() || "sc" === s.getSiteLanguage()) && !1 === e.signed && e.dynamicExpectedDeliveryTm && e.destination) { var t = e.dynamicExpectedDeliveryTm, i = a(t.substring(0, 0 <= t.indexOf("+") ? t.indexOf("+") : t.length)).format("YYYY.MM.DD HH:mm"); return e.delay ? _l("预计派送时间重新计算中") : "<p>" + _p(_l("预计<i>%(deliveryTime)s前</i>到达"), { deliveryTime: i }) + '</p><p class="product-time-p">' + _l("(仅供参考，具体时效以实际派送时间为准)") + "</p>" } }, handlerRouteInfo: function (e, t) { var i = { scanDateTime: a(e.scanDateTime).format("YYYY-MM-DD HH:mm"), remark: "" }; if (e.remark) { var n = e.remark.replace('id="opr_phone"', 'class="route-phone"'); "ru" === s.getSiteLocation() && ("T13" === t && 31 == e.opCode && _.contains(c.VIRTUAL_T13, e.zoneCode) ? n += _l("Tip31") : "T14" === t && 204 == e.opCode && _.contains(c.VIRTUAL_T14, e.zoneCode) && (n = _l("Tip204"))), i.remark = n } return i }, getLatestInfo: function (e) { if (e.routes && e.routes.length) return this.handlerRouteInfo(e.routes[0], e.limitTypeCode) } }) }), define("views/query/abroad/billDetails", ["baseView", "./billDetailItem", "templates", "sflayer", "plugins/tencentCaptcha"], function (e, s, r, o, n) { return e.extend({ init: function (t) { var i = this; this.isRootMenu = t.isRootMenu, n.captcha(function (e) { i.doRequest(t.billIds, e.ticket) }) }, doRequest: function (t, e, i) { var n = this; this.resetItems(), sfAjax.routes({ data: { billNumbers: t, ticket: e, app: "bill" }, success: function (e) { n.render(t, n.handleData(e)) }, error: function () { o.msg(_l("网络错误")) }, complete: i }) }, doRequestVip: function (e, t) { var i = this, n = e.id; this.resetItems(); var a = o.load(); sfAjax.getBillDetailByNum({ data: { id: n }, success: function (e) { 0 === e.code ? (i.render(n, i.handleData([e.result])), t()) : 600 === e.code && (i.render(n, i.handleData([])), t()) }, error: function () { o.msg(_l("获取失败")) }, complete: function () { o.close(a) } }) }, handleData: function (e) { var t = this; return e = _.map(e, function (e) { return t.parse(e) }), _.filter(e, function (e) { return null !== e }) }, parse: function (e) { if (!e) return null; var t = !1; return e.routes = _.filter(e.routes, function (e) { return "sc" === Helper.getSiteLanguage() ? (0 <= e.remark.indexOf("运单资料&签收图") && (t = !0), e.remark.indexOf("运单资料&签收图") < 0) : "tc" === Helper.getSiteLanguage() ? (0 <= e.remark.indexOf("運單資料&簽收圖") && (t = !0), e.remark.indexOf("運單資料&簽收圖") < 0) : (0 <= e.remark.indexOf("運單資料&簽收圖") && (t = !0), e.remark.indexOf("AWB Info & POD") < 0) }), t && (e.signed = t), 0 === e.routes.length ? null : (e.routes = _.sortBy(e.routes, function (e) { return e.scanDateTime }).reverse(), e) }, resetItems: function () { this.$el.empty() }, render: function (e, n) { if (e) { var a = this; _.each(e.split(","), function (t) { var e = _.find(n, function (e) { return e.id == t }); if (e) { var i = $('<div class="delivery"></div>'); a.$el.append(i), new s({ el: i, model: e, isRootMenu: a.isRootMenu }) } else a.$el.append(r.waybillNotFound({ billNumber: t })) }) } }, findWaybillById: function (e, t) { } }) }), define("views/query/abroad/infoRouter", ["./billDetails"], function (t) { return Backbone.Router.extend({ initialize: function (e) { this.setTokens = e.setTokens, Backbone.history.start() }, routes: { "search/bill-number/:numbers": "initWaybill", "*path": "waybillEmpty" }, initWaybill: function (e) { this.setTokens(e), new t({ el: $(".delivery-wrapper"), billIds: e, isRootMenu: !0 }) }, waybillEmpty: function () { this.setTokens("") } }) }), define("views/query/abroad/waybill", ["baseView", "helper", "templates", "../components/queryInput", "./infoRouter"], function (e, t, i, n, a) { return e.extend({ template: i.waybillAbroad, init: function () { this.region = t.getSiteLocation() }, render: function () { this.$el.html(this.template({ region: this.region })), this.queryInput = new n({ el: this.$(".shipping-search-detail") }); var t = this; new a({ setTokens: function (e) { t.queryInput.setTokens(e) } }) } }) }), function (T, S) { var f = T(window); function $() { return new Date(Date.UTC.apply(Date, arguments)) } function o() { var e = new Date; return $(e.getFullYear(), e.getMonth(), e.getDate()) } function e(e) { return function () { return this[e].apply(this, arguments) } } var t, i = (t = { get: function (e) { return this.slice(e)[0] }, contains: function (e) { for (var t = e && e.valueOf(), i = 0, n = this.length; i < n; i++)if (this[i].valueOf() === t) return i; return -1 }, remove: function (e) { this.splice(e, 1) }, replace: function (e) { e && (T.isArray(e) || (e = [e]), this.clear(), this.push.apply(this, e)) }, clear: function () { this.length = 0 }, copy: function () { var e = new i; return e.replace(this), e } }, function () { var e = []; return e.push.apply(e, arguments), T.extend(e, t), e }), v = function (e, t) { this.dates = new i, this.viewDate = o(), this.focusDate = null, this._process_options(t), this.element = T(e), this.isInline = !1, this.isInput = this.element.is("input"), this.component = !!this.element.is(".date") && this.element.find(".add-on, .input-group-addon, .btn"), this.hasInput = this.component && this.element.find("input").length, this.component && 0 === this.component.length && (this.component = !1), this.picker = T(I.template), this._buildEvents(), this._attachEvents(), this.isInline ? this.picker.addClass("datepicker-inline").appendTo(this.element) : this.picker.addClass("datepicker-dropdown dropdown-menu"), this.o.rtl && this.picker.addClass("datepicker-rtl"), this.viewMode = this.o.startView, this.o.calendarWeeks && this.picker.find("tfoot th.today").attr("colspan", function (e, t) { return parseInt(t) + 1 }), this._allow_update = !1, this.setStartDate(this._o.startDate), this.setEndDate(this._o.endDate), this.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled), this.fillDow(), this.fillMonths(), this._allow_update = !0, this.update(), this.showMode(), this.isInline && this.show() }; v.prototype = { constructor: v, _process_options: function (e) { this._o = T.extend({}, this._o, e); var t = this.o = T.extend({}, this._o), i = t.language; switch (A[i] || (i = i.split("-")[0], A[i] || (i = u.language)), t.language = i, t.startView) { case 2: case "decade": t.startView = 2; break; case 1: case "year": t.startView = 1; break; default: t.startView = 0 }switch (t.minViewMode) { case 1: case "months": t.minViewMode = 1; break; case 2: case "years": t.minViewMode = 2; break; default: t.minViewMode = 0 }t.startView = Math.max(t.startView, t.minViewMode), !0 !== t.multidate && (t.multidate = Number(t.multidate) || !1, !1 !== t.multidate && (t.multidate = Math.max(0, t.multidate))), t.multidateSeparator = String(t.multidateSeparator), t.weekStart %= 7, t.weekEnd = (t.weekStart + 6) % 7; var n = I.parseFormat(t.format); t.startDate !== -1 / 0 && (t.startDate ? t.startDate instanceof Date ? t.startDate = this._local_to_utc(this._zero_time(t.startDate)) : t.startDate = I.parseDate(t.startDate, n, t.language) : t.startDate = -1 / 0), t.endDate !== 1 / 0 && (t.endDate ? t.endDate instanceof Date ? t.endDate = this._local_to_utc(this._zero_time(t.endDate)) : t.endDate = I.parseDate(t.endDate, n, t.language) : t.endDate = 1 / 0), t.daysOfWeekDisabled = t.daysOfWeekDisabled || [], T.isArray(t.daysOfWeekDisabled) || (t.daysOfWeekDisabled = t.daysOfWeekDisabled.split(/[,\s]*/)), t.daysOfWeekDisabled = T.map(t.daysOfWeekDisabled, function (e) { return parseInt(e, 10) }); var a = String(t.orientation).toLowerCase().split(/\s+/g), s = t.orientation.toLowerCase(); if (a = T.grep(a, function (e) { return /^auto|left|right|top|bottom$/.test(e) }), t.orientation = { x: "auto", y: "auto" }, s && "auto" !== s) if (1 === a.length) switch (a[0]) { case "top": case "bottom": t.orientation.y = a[0]; break; case "left": case "right": t.orientation.x = a[0] } else s = T.grep(a, function (e) { return /^left|right$/.test(e) }), t.orientation.x = s[0] || "auto", s = T.grep(a, function (e) { return /^top|bottom$/.test(e) }), t.orientation.y = s[0] || "auto"; else; }, _events: [], _secondaryEvents: [], _applyEvents: function (e) { for (var t, i, n, a = 0; a < e.length; a++)t = e[a][0], 2 === e[a].length ? (i = S, n = e[a][1]) : 3 === e[a].length && (i = e[a][1], n = e[a][2]), t.on(n, i) }, _unapplyEvents: function (e) { for (var t, i, n, a = 0; a < e.length; a++)t = e[a][0], 2 === e[a].length ? (n = S, i = e[a][1]) : 3 === e[a].length && (n = e[a][1], i = e[a][2]), t.off(i, n) }, _buildEvents: function () { this.isInput ? this._events = [[this.element, { focus: T.proxy(this.show, this), keyup: T.proxy(function (e) { -1 === T.inArray(e.keyCode, [27, 37, 39, 38, 40, 32, 13, 9]) && this.update() }, this), keydown: T.proxy(this.keydown, this) }]] : this.component && this.hasInput ? this._events = [[this.element.find("input"), { focus: T.proxy(this.show, this), keyup: T.proxy(function (e) { -1 === T.inArray(e.keyCode, [27, 37, 39, 38, 40, 32, 13, 9]) && this.update() }, this), keydown: T.proxy(this.keydown, this) }], [this.component, { click: T.proxy(this.show, this) }]] : this.element.is("div") ? this.isInline = !0 : this._events = [[this.element, { click: T.proxy(this.show, this) }]], this._events.push([this.element, "*", { blur: T.proxy(function (e) { this._focused_from = e.target }, this) }], [this.element, { blur: T.proxy(function (e) { this._focused_from = e.target }, this) }]), this._secondaryEvents = [[this.picker, { click: T.proxy(this.click, this) }], [T(window), { resize: T.proxy(this.place, this) }], [T(document), { "mousedown touchstart": T.proxy(function (e) { this.element.is(e.target) || this.element.find(e.target).length || this.picker.is(e.target) || this.picker.find(e.target).length || this.hide() }, this) }]] }, _attachEvents: function () { this._detachEvents(), this._applyEvents(this._events) }, _detachEvents: function () { this._unapplyEvents(this._events) }, _attachSecondaryEvents: function () { this._detachSecondaryEvents(), this._applyEvents(this._secondaryEvents) }, _detachSecondaryEvents: function () { this._unapplyEvents(this._secondaryEvents) }, _trigger: function (e, t) { var i = t || this.dates.get(-1), n = this._utc_to_local(i); this.element.trigger({ type: e, date: n, dates: T.map(this.dates, this._utc_to_local), format: T.proxy(function (e, t) { 0 === arguments.length ? (e = this.dates.length - 1, t = this.o.format) : "string" == typeof e && (t = e, e = this.dates.length - 1), t = t || this.o.format; var i = this.dates.get(e); return I.formatDate(i, t, this.o.language) }, this) }) }, show: function () { this.isInline || this.picker.appendTo("body"), this.picker.show(), this.place(), this._attachSecondaryEvents(), this._trigger("show") }, hide: function () { this.isInline || this.picker.is(":visible") && (this.focusDate = null, this.picker.hide().detach(), this._detachSecondaryEvents(), this.viewMode = this.o.startView, this.showMode(), this.o.forceParse && (this.isInput && this.element.val() || this.hasInput && this.element.find("input").val()) && this.setValue(), this._trigger("hide")) }, remove: function () { this.hide(), this._detachEvents(), this._detachSecondaryEvents(), this.picker.remove(), delete this.element.data().datepicker, this.isInput || delete this.element.data().date }, _utc_to_local: function (e) { return e && new Date(e.getTime() + 6e4 * e.getTimezoneOffset()) }, _local_to_utc: function (e) { return e && new Date(e.getTime() - 6e4 * e.getTimezoneOffset()) }, _zero_time: function (e) { return e && new Date(e.getFullYear(), e.getMonth(), e.getDate()) }, _zero_utc_time: function (e) { return e && new Date(Date.UTC(e.getUTCFullYear(), e.getUTCMonth(), e.getUTCDate())) }, getDates: function () { return T.map(this.dates, this._utc_to_local) }, getUTCDates: function () { return T.map(this.dates, function (e) { return new Date(e) }) }, getDate: function () { return this._utc_to_local(this.getUTCDate()) }, getUTCDate: function () { return new Date(this.dates.get(-1)) }, setDates: function () { var e = T.isArray(arguments[0]) ? arguments[0] : arguments; this.update.apply(this, e), this._trigger("changeDate"), this.setValue() }, setUTCDates: function () { var e = T.isArray(arguments[0]) ? arguments[0] : arguments; this.update.apply(this, T.map(e, this._utc_to_local)), this._trigger("changeDate"), this.setValue() }, setDate: e("setDates"), setUTCDate: e("setUTCDates"), setValue: function () { var e = this.getFormattedDate(); this.isInput ? this.element.val(e).change() : this.component && this.element.find("input").val(e).change() }, getFormattedDate: function (t) { t === S && (t = this.o.format); var i = this.o.language; return T.map(this.dates, function (e) { return I.formatDate(e, t, i) }).join(this.o.multidateSeparator) }, setStartDate: function (e) { this._process_options({ startDate: e }), this.update(), this.updateNavArrows() }, setEndDate: function (e) { this._process_options({ endDate: e }), this.update(), this.updateNavArrows() }, setDaysOfWeekDisabled: function (e) { this._process_options({ daysOfWeekDisabled: e }), this.update(), this.updateNavArrows() }, place: function () { if (!this.isInline) { var e = this.picker.outerWidth(), t = this.picker.outerHeight(), i = f.width(), n = f.height(), a = f.scrollTop(), s = parseInt(this.element.parents().filter(function () { return "auto" !== T(this).css("z-index") }).first().css("z-index")) + 10, r = this.component ? this.component.parent().offset() : this.element.offset(), o = this.component ? this.component.outerHeight(!0) : this.element.outerHeight(!1), l = this.component ? this.component.outerWidth(!0) : this.element.outerWidth(!1), c = r.left, d = r.top; this.picker.removeClass("datepicker-orient-top datepicker-orient-bottom datepicker-orient-right datepicker-orient-left"), "auto" !== this.o.orientation.x ? (this.picker.addClass("datepicker-orient-" + this.o.orientation.x), "right" === this.o.orientation.x && (c -= e - l)) : (this.picker.addClass("datepicker-orient-left"), r.left < 0 ? c -= r.left - 10 : r.left + e > i && (c = i - e - 10)); var u, h, p = this.o.orientation.y; "auto" === p && (u = -a + r.top - t, h = a + n - (r.top + o + t), p = Math.max(u, h) === h ? "top" : "bottom"), this.picker.addClass("datepicker-orient-" + p), "top" === p ? d += o : d -= t + parseInt(this.picker.css("padding-top")), this.picker.css({ top: d, left: c, zIndex: s }) } }, _allow_update: !0, update: function () { if (this._allow_update) { var e = this.dates.copy(), i = [], t = !1; arguments.length ? (T.each(arguments, T.proxy(function (e, t) { t instanceof Date && (t = this._local_to_utc(t)), i.push(t) }, this)), t = !0) : (i = (i = this.isInput ? this.element.val() : this.element.data("date") || this.element.find("input").val()) && this.o.multidate ? i.split(this.o.multidateSeparator) : [i], delete this.element.data().date), i = T.map(i, T.proxy(function (e) { return I.parseDate(e, this.o.format, this.o.language) }, this)), i = T.grep(i, T.proxy(function (e) { return e < this.o.startDate || e > this.o.endDate || !e }, this), !0), this.dates.replace(i), this.dates.length ? this.viewDate = new Date(this.dates.get(-1)) : this.viewDate < this.o.startDate ? this.viewDate = new Date(this.o.startDate) : this.viewDate > this.o.endDate && (this.viewDate = new Date(this.o.endDate)), t ? this.setValue() : i.length && String(e) !== String(this.dates) && this._trigger("changeDate"), !this.dates.length && e.length && this._trigger("clearDate"), this.fill() } }, fillDow: function () { var e = this.o.weekStart, t = "<tr>"; if (this.o.calendarWeeks) { var i = '<th class="cw">&nbsp;</th>'; t += i, this.picker.find(".datepicker-days thead tr:first-child").prepend(i) } for (; e < this.o.weekStart + 7;)t += '<th class="dow">' + A[this.o.language].daysMin[e++ % 7] + "</th>"; t += "</tr>", this.picker.find(".datepicker-days thead").append(t) }, fillMonths: function () { for (var e = "", t = 0; t < 12;)e += '<span class="month">' + A[this.o.language].monthsShort[t++] + "</span>"; this.picker.find(".datepicker-months td").html(e) }, setRange: function (e) { e && e.length ? this.range = T.map(e, function (e) { return e.valueOf() }) : delete this.range, this.fill() }, getClassNames: function (e) { var t = [], i = this.viewDate.getUTCFullYear(), n = this.viewDate.getUTCMonth(), a = new Date; return e.getUTCFullYear() < i || e.getUTCFullYear() === i && e.getUTCMonth() < n ? t.push("old") : (e.getUTCFullYear() > i || e.getUTCFullYear() === i && e.getUTCMonth() > n) && t.push("new"), this.focusDate && e.valueOf() === this.focusDate.valueOf() && t.push("focused"), this.o.todayHighlight && e.getUTCFullYear() === a.getFullYear() && e.getUTCMonth() === a.getMonth() && e.getUTCDate() === a.getDate() && t.push("today"), -1 !== this.dates.contains(e) && t.push("active"), (e.valueOf() < this.o.startDate || e.valueOf() > this.o.endDate || -1 !== T.inArray(e.getUTCDay(), this.o.daysOfWeekDisabled)) && t.push("disabled"), this.range && (e > this.range[0] && e < this.range[this.range.length - 1] && t.push("range"), -1 !== T.inArray(e.valueOf(), this.range) && t.push("selected")), t }, fill: function () { var e, t = new Date(this.viewDate), i = t.getUTCFullYear(), n = t.getUTCMonth(), a = this.o.startDate !== -1 / 0 ? this.o.startDate.getUTCFullYear() : -1 / 0, s = this.o.startDate !== -1 / 0 ? this.o.startDate.getUTCMonth() : -1 / 0, r = this.o.endDate !== 1 / 0 ? this.o.endDate.getUTCFullYear() : 1 / 0, o = this.o.endDate !== 1 / 0 ? this.o.endDate.getUTCMonth() : 1 / 0, l = A[this.o.language].today || A.en.today || "", c = A[this.o.language].clear || A.en.clear || ""; this.picker.find(".datepicker-days thead th.datepicker-switch").text(A[this.o.language].months[n] + " " + i), this.picker.find("tfoot th.today").text(l).toggle(!1 !== this.o.todayBtn), this.picker.find("tfoot th.clear").text(c).toggle(!1 !== this.o.clearBtn), this.updateNavArrows(), this.fillMonths(); var d = $(i, n - 1, 28), u = I.getDaysInMonth(d.getUTCFullYear(), d.getUTCMonth()); d.setUTCDate(u), d.setUTCDate(u - (d.getUTCDay() - this.o.weekStart + 7) % 7); var h = new Date(d); h.setUTCDate(h.getUTCDate() + 42), h = h.valueOf(); for (var p, f = []; d.valueOf() < h;) { if (d.getUTCDay() === this.o.weekStart && (f.push("<tr>"), this.o.calendarWeeks)) { var m = new Date(+d + (this.o.weekStart - d.getUTCDay() - 7) % 7 * 864e5), g = new Date(Number(m) + (11 - m.getUTCDay()) % 7 * 864e5), _ = new Date(Number(_ = $(g.getUTCFullYear(), 0, 1)) + (11 - _.getUTCDay()) % 7 * 864e5), v = (g - _) / 864e5 / 7 + 1; f.push('<td class="cw">' + v + "</td>") } if ((p = this.getClassNames(d)).push("day"), this.o.beforeShowDay !== T.noop) { var y = this.o.beforeShowDay(this._utc_to_local(d)); y === S ? y = {} : "boolean" == typeof y ? y = { enabled: y } : "string" == typeof y && (y = { classes: y }), !1 === y.enabled && p.push("disabled"), y.classes && (p = p.concat(y.classes.split(/\s+/))), y.tooltip && (e = y.tooltip) } p = T.unique(p), f.push('<td class="' + p.join(" ") + '"' + (e ? ' title="' + e + '"' : "") + ">" + d.getUTCDate() + "</td>"), d.getUTCDay() === this.o.weekEnd && f.push("</tr>"), d.setUTCDate(d.getUTCDate() + 1) } this.picker.find(".datepicker-days tbody").empty().append(f.join("")); var b = this.picker.find(".datepicker-months").find("th:eq(1)").text(i).end().find("span").removeClass("active"); T.each(this.dates, function (e, t) { t.getUTCFullYear() === i && b.eq(t.getUTCMonth()).addClass("active") }), (i < a || r < i) && b.addClass("disabled"), i === a && b.slice(0, s).addClass("disabled"), i === r && b.slice(o + 1).addClass("disabled"), f = "", i = 10 * parseInt(i / 10, 10); var w = this.picker.find(".datepicker-years").find("th:eq(1)").text(i + "-" + (i + 9)).end().find("td"); i -= 1; for (var C, x = T.map(this.dates, function (e) { return e.getUTCFullYear() }), k = -1; k < 11; k++)C = ["year"], -1 === k ? C.push("old") : 10 === k && C.push("new"), -1 !== T.inArray(i, x) && C.push("active"), (i < a || r < i) && C.push("disabled"), f += '<span class="' + C.join(" ") + '">' + i + "</span>", i += 1; w.html(f) }, updateNavArrows: function () { if (this._allow_update) { var e = new Date(this.viewDate), t = e.getUTCFullYear(), i = e.getUTCMonth(); switch (this.viewMode) { case 0: this.o.startDate !== -1 / 0 && t <= this.o.startDate.getUTCFullYear() && i <= this.o.startDate.getUTCMonth() ? this.picker.find(".prev").css({ visibility: "hidden" }) : this.picker.find(".prev").css({ visibility: "visible" }), this.o.endDate !== 1 / 0 && t >= this.o.endDate.getUTCFullYear() && i >= this.o.endDate.getUTCMonth() ? this.picker.find(".next").css({ visibility: "hidden" }) : this.picker.find(".next").css({ visibility: "visible" }); break; case 1: case 2: this.o.startDate !== -1 / 0 && t <= this.o.startDate.getUTCFullYear() ? this.picker.find(".prev").css({ visibility: "hidden" }) : this.picker.find(".prev").css({ visibility: "visible" }), this.o.endDate !== 1 / 0 && t >= this.o.endDate.getUTCFullYear() ? this.picker.find(".next").css({ visibility: "hidden" }) : this.picker.find(".next").css({ visibility: "visible" }) } } }, click: function (e) { e.preventDefault(); var t, i, n, a = T(e.target).closest("span, td, th"); if (1 === a.length) switch (a[0].nodeName.toLowerCase()) { case "th": switch (a[0].className) { case "datepicker-switch": this.showMode(1); break; case "prev": case "next": var s = I.modes[this.viewMode].navStep * ("prev" === a[0].className ? -1 : 1); switch (this.viewMode) { case 0: this.viewDate = this.moveMonth(this.viewDate, s), this._trigger("changeMonth", this.viewDate); break; case 1: case 2: this.viewDate = this.moveYear(this.viewDate, s), 1 === this.viewMode && this._trigger("changeYear", this.viewDate) }this.fill(); break; case "today": var r = new Date; r = $(r.getFullYear(), r.getMonth(), r.getDate(), 0, 0, 0), this.showMode(-2); var o = "linked" === this.o.todayBtn ? null : "view"; this._setDate(r, o); break; case "clear": var l; this.isInput ? l = this.element : this.component && (l = this.element.find("input")), l && l.val("").change(), this.update(), this._trigger("changeDate"), this.o.autoclose && this.hide() }break; case "span": a.is(".disabled") || (this.viewDate.setUTCDate(1), a.is(".month") ? (n = 1, i = a.parent().find("span").index(a), t = this.viewDate.getUTCFullYear(), this.viewDate.setUTCMonth(i), this._trigger("changeMonth", this.viewDate), 1 === this.o.minViewMode && this._setDate($(t, i, n))) : (n = 1, i = 0, t = parseInt(a.text(), 10) || 0, this.viewDate.setUTCFullYear(t), this._trigger("changeYear", this.viewDate), 2 === this.o.minViewMode && this._setDate($(t, i, n))), this.showMode(-1), this.fill()); break; case "td": a.is(".day") && !a.is(".disabled") && (n = parseInt(a.text(), 10) || 1, t = this.viewDate.getUTCFullYear(), i = this.viewDate.getUTCMonth(), a.is(".old") ? 0 === i ? (i = 11, t -= 1) : i -= 1 : a.is(".new") && (11 === i ? (i = 0, t += 1) : i += 1), this._setDate($(t, i, n))) }this.picker.is(":visible") && this._focused_from && T(this._focused_from).focus(), delete this._focused_from }, _toggle_multidate: function (e) { var t = this.dates.contains(e); if (e) { if (!1 === this.o.multidate) this.dates.clear(), this.dates.push(e); else if (-1 !== t ? this.dates.remove(t) : this.dates.push(e), "number" == typeof this.o.multidate) for (; this.dates.length > this.o.multidate;)this.dates.remove(0) } else this.dates.clear() }, _setDate: function (e, t) { var i; t && "date" !== t || this._toggle_multidate(e && new Date(e)), t && "view" !== t || (this.viewDate = e && new Date(e)), this.fill(), this.setValue(), this._trigger("changeDate"), this.isInput ? i = this.element : this.component && (i = this.element.find("input")), i && i.change(), !this.o.autoclose || t && "date" !== t || this.hide() }, moveMonth: function (e, t) { if (!e) return S; if (!t) return e; var i, n, a = new Date(e.valueOf()), s = a.getUTCDate(), r = a.getUTCMonth(), o = Math.abs(t); if (t = 0 < t ? 1 : -1, 1 === o) n = -1 === t ? function () { return a.getUTCMonth() === r } : function () { return a.getUTCMonth() !== i }, i = r + t, a.setUTCMonth(i), (i < 0 || 11 < i) && (i = (i + 12) % 12); else { for (var l = 0; l < o; l++)a = this.moveMonth(a, t); i = a.getUTCMonth(), a.setUTCDate(s), n = function () { return i !== a.getUTCMonth() } } for (; n();)a.setUTCDate(--s), a.setUTCMonth(i); return a }, moveYear: function (e, t) { return this.moveMonth(e, 12 * t) }, dateWithinRange: function (e) { return e >= this.o.startDate && e <= this.o.endDate }, keydown: function (e) { if (this.picker.is(":not(:visible)")) 27 === e.keyCode && this.show(); else { var t, i, n, a, s = !1, r = this.focusDate || this.viewDate; switch (e.keyCode) { case 27: this.focusDate ? (this.focusDate = null, this.viewDate = this.dates.get(-1) || this.viewDate, this.fill()) : this.hide(), e.preventDefault(); break; case 37: case 39: if (!this.o.keyboardNavigation) break; t = 37 === e.keyCode ? -1 : 1, e.ctrlKey ? (i = this.moveYear(this.dates.get(-1) || o(), t), n = this.moveYear(r, t), this._trigger("changeYear", this.viewDate)) : e.shiftKey ? (i = this.moveMonth(this.dates.get(-1) || o(), t), n = this.moveMonth(r, t), this._trigger("changeMonth", this.viewDate)) : ((i = new Date(this.dates.get(-1) || o())).setUTCDate(i.getUTCDate() + t), (n = new Date(r)).setUTCDate(r.getUTCDate() + t)), this.dateWithinRange(i) && (this.focusDate = this.viewDate = n, this.setValue(), this.fill(), e.preventDefault()); break; case 38: case 40: if (!this.o.keyboardNavigation) break; t = 38 === e.keyCode ? -1 : 1, e.ctrlKey ? (i = this.moveYear(this.dates.get(-1) || o(), t), n = this.moveYear(r, t), this._trigger("changeYear", this.viewDate)) : e.shiftKey ? (i = this.moveMonth(this.dates.get(-1) || o(), t), n = this.moveMonth(r, t), this._trigger("changeMonth", this.viewDate)) : ((i = new Date(this.dates.get(-1) || o())).setUTCDate(i.getUTCDate() + 7 * t), (n = new Date(r)).setUTCDate(r.getUTCDate() + 7 * t)), this.dateWithinRange(i) && (this.focusDate = this.viewDate = n, this.setValue(), this.fill(), e.preventDefault()); break; case 32: break; case 13: r = this.focusDate || this.dates.get(-1) || this.viewDate, this._toggle_multidate(r), s = !0, this.focusDate = null, this.viewDate = this.dates.get(-1) || this.viewDate, this.setValue(), this.fill(), this.picker.is(":visible") && (e.preventDefault(), this.o.autoclose && this.hide()); break; case 9: this.focusDate = null, this.viewDate = this.dates.get(-1) || this.viewDate, this.fill(), this.hide() }if (s) this.dates.length ? this._trigger("changeDate") : this._trigger("clearDate"), this.isInput ? a = this.element : this.component && (a = this.element.find("input")), a && a.change() } }, showMode: function (e) { e && (this.viewMode = Math.max(this.o.minViewMode, Math.min(2, this.viewMode + e))), this.picker.find(">div").hide().filter(".datepicker-" + I.modes[this.viewMode].clsName).css("display", "block"), this.updateNavArrows() } }; var d = function (e, t) { this.element = T(e), this.inputs = T.map(t.inputs, function (e) { return e.jquery ? e[0] : e }), delete t.inputs, T(this.inputs).datepicker(t).bind("changeDate", T.proxy(this.dateUpdated, this)), this.pickers = T.map(this.inputs, function (e) { return T(e).data("datepicker") }), this.updateDates() }; d.prototype = { updateDates: function () { this.dates = T.map(this.pickers, function (e) { return e.getUTCDate() }), this.updateRanges() }, updateRanges: function () { var i = T.map(this.dates, function (e) { return e.valueOf() }); T.each(this.pickers, function (e, t) { t.setRange(i) }) }, dateUpdated: function (e) { if (!this.updating) { this.updating = !0; var i = T(e.target).data("datepicker").getUTCDate(), t = T.inArray(e.target, this.inputs), n = this.inputs.length; if (-1 !== t) { if (T.each(this.pickers, function (e, t) { t.getUTCDate() || t.setUTCDate(i) }), i < this.dates[t]) for (; 0 <= t && i < this.dates[t];)this.pickers[t--].setUTCDate(i); else if (i > this.dates[t]) for (; t < n && i > this.dates[t];)this.pickers[t++].setUTCDate(i); this.updateDates(), delete this.updating } } }, remove: function () { T.map(this.pickers, function (e) { e.remove() }), delete this.element.data().datepicker } }; var n = T.fn.datepicker; T.fn.datepicker = function (o) { var l, c = Array.apply(null, arguments); return c.shift(), this.each(function () { var e = T(this), t = e.data("datepicker"), i = "object" == typeof o && o; if (!t) { var n = function (e, t) { var i = T(e).data(), n = {}, a = new RegExp("^" + t.toLowerCase() + "([A-Z])"); function s(e, t) { return t.toLowerCase() } for (var r in t = new RegExp("^" + t.toLowerCase()), i) t.test(r) && (n[r.replace(a, s)] = i[r]); return n }(this, "date"), a = function (e) { var i = {}; if (A[e] || (e = e.split("-")[0], A[e])) { var n = A[e]; return T.each(h, function (e, t) { t in n && (i[t] = n[t]) }), i } }(T.extend({}, u, n, i).language), s = T.extend({}, u, a, n, i); if (e.is(".input-daterange") || s.inputs) { var r = { inputs: s.inputs || e.find("input").toArray() }; e.data("datepicker", t = new d(this, T.extend(s, r))) } else e.data("datepicker", t = new v(this, s)) } if ("string" == typeof o && "function" == typeof t[o] && (l = t[o].apply(t, c)) !== S) return !1 }), l !== S ? l : this }; var u = T.fn.datepicker.defaults = { autoclose: !1, beforeShowDay: T.noop, calendarWeeks: !1, clearBtn: !1, daysOfWeekDisabled: [], endDate: 1 / 0, forceParse: !0, format: "mm/dd/yyyy", keyboardNavigation: !0, language: "en", minViewMode: 0, multidate: !1, multidateSeparator: ",", orientation: "auto", rtl: !1, startDate: -1 / 0, startView: 0, todayBtn: !1, todayHighlight: !1, weekStart: 0 }, h = T.fn.datepicker.locale_opts = ["format", "rtl", "weekStart"]; T.fn.datepicker.Constructor = v; var A = T.fn.datepicker.dates = { en: { days: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"], daysShort: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"], daysMin: ["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa", "Su"], months: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"], monthsShort: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"], today: "Today", clear: "Clear" } }, I = { modes: [{ clsName: "days", navFnc: "Month", navStep: 1 }, { clsName: "months", navFnc: "FullYear", navStep: 1 }, { clsName: "years", navFnc: "FullYear", navStep: 10 }], isLeapYear: function (e) { return e % 4 == 0 && e % 100 != 0 || e % 400 == 0 }, getDaysInMonth: function (e, t) { return [31, I.isLeapYear(e) ? 29 : 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31][t] }, validParts: /dd?|DD?|mm?|MM?|yy(?:yy)?/g, nonpunctuation: /[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g, parseFormat: function (e) { var t = e.replace(this.validParts, "\0").split("\0"), i = e.match(this.validParts); if (!t || !t.length || !i || 0 === i.length) throw new Error("Invalid date format."); return { separators: t, parts: i } }, parseDate: function (e, t, i) { if (!e) return S; if (e instanceof Date) return e; "string" == typeof t && (t = I.parseFormat(t)); var n, a, s, r = /([\-+]\d+)([dmwy])/, o = e.match(/([\-+]\d+)([dmwy])/g); if (/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(e)) { for (e = new Date, s = 0; s < o.length; s++)switch (n = r.exec(o[s]), a = parseInt(n[1]), n[2]) { case "d": e.setUTCDate(e.getUTCDate() + a); break; case "m": e = v.prototype.moveMonth.call(v.prototype, e, a); break; case "w": e.setUTCDate(e.getUTCDate() + 7 * a); break; case "y": e = v.prototype.moveYear.call(v.prototype, e, a) }return $(e.getUTCFullYear(), e.getUTCMonth(), e.getUTCDate(), 0, 0, 0) } o = e && e.match(this.nonpunctuation) || [], e = new Date; var l, c, d = {}, u = ["yyyy", "yy", "M", "MM", "m", "mm", "d", "dd"], h = { yyyy: function (e, t) { return e.setUTCFullYear(t) }, yy: function (e, t) { return e.setUTCFullYear(2e3 + t) }, m: function (e, t) { if (isNaN(e)) return e; for (t -= 1; t < 0;)t += 12; for (t %= 12, e.setUTCMonth(t); e.getUTCMonth() !== t;)e.setUTCDate(e.getUTCDate() - 1); return e }, d: function (e, t) { return e.setUTCDate(t) } }; h.M = h.MM = h.mm = h.m, h.dd = h.d, e = $(e.getFullYear(), e.getMonth(), e.getDate(), 0, 0, 0); var p = t.parts.slice(); function f() { var e = this.slice(0, o[s].length); return e === o[s].slice(0, e.length) } if (o.length !== p.length && (p = T(p).filter(function (e, t) { return -1 !== T.inArray(t, u) }).toArray()), o.length === p.length) { var m, g, _; for (s = 0, m = p.length; s < m; s++) { if (l = parseInt(o[s], 10), n = p[s], isNaN(l)) switch (n) { case "MM": c = T(A[i].months).filter(f), l = T.inArray(c[0], A[i].months) + 1; break; case "M": c = T(A[i].monthsShort).filter(f), l = T.inArray(c[0], A[i].monthsShort) + 1 }d[n] = l } for (s = 0; s < u.length; s++)(_ = u[s]) in d && !isNaN(d[_]) && (g = new Date(e), h[_](g, d[_]), isNaN(g) || (e = g)) } return e }, formatDate: function (e, t, i) { if (!e) return ""; "string" == typeof t && (t = I.parseFormat(t)); var n = { d: e.getUTCDate(), D: A[i].daysShort[e.getUTCDay()], DD: A[i].days[e.getUTCDay()], m: e.getUTCMonth() + 1, M: A[i].monthsShort[e.getUTCMonth()], MM: A[i].months[e.getUTCMonth()], yy: e.getUTCFullYear().toString().substring(2), yyyy: e.getUTCFullYear() }; n.dd = (n.d < 10 ? "0" : "") + n.d, n.mm = (n.m < 10 ? "0" : "") + n.m, e = []; for (var a = T.extend([], t.separators), s = 0, r = t.parts.length; s <= r; s++)a.length && e.push(a.shift()), e.push(n[t.parts[s]]); return e.join("") }, headTemplate: '<thead><tr><th class="prev">&laquo;</th><th colspan="5" class="datepicker-switch"></th><th class="next">&raquo;</th></tr></thead>', contTemplate: '<tbody><tr><td colspan="7"></td></tr></tbody>', footTemplate: '<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>' }; I.template = '<div class="datepicker"><div class="datepicker-days"><table class=" table-condensed">' + I.headTemplate + "<tbody></tbody>" + I.footTemplate + '</table></div><div class="datepicker-months"><table class="table-condensed">' + I.headTemplate + I.contTemplate + I.footTemplate + '</table></div><div class="datepicker-years"><table class="table-condensed">' + I.headTemplate + I.contTemplate + I.footTemplate + "</table></div></div>", T.fn.datepicker.DPGlobal = I, T.fn.datepicker.noConflict = function () { return T.fn.datepicker = n, this }, T(document).on("focus.datepicker.data-api click.datepicker.data-api", '[data-provide="datepicker"]', function (e) { var t = T(this); t.data("datepicker") || (e.preventDefault(), t.datepicker("show")) }), T(function () { T('[data-provide="datepicker-inline"]').datepicker() }) }(window.jQuery), define("datepicker", function (e) { return function () { return e.datepicker } }(this)), jQuery.fn.datepicker.dates["zh-CN"] = { days: ["星期日", "星期一", "星期二", "星期三", "星期四", "星期五", "星期六", "星期日"], daysShort: ["周日", "周一", "周二", "周三", "周四", "周五", "周六", "周日"], daysMin: ["日", "一", "二", "三", "四", "五", "六", "日"], months: ["一月", "二月", "三月", "四月", "五月", "六月", "七月", "八月", "九月", "十月", "十一月", "十二月"], monthsShort: ["一月", "二月", "三月", "四月", "五月", "六月", "七月", "八月", "九月", "十月", "十一月", "十二月"], today: "今天", format: "yyyy年mm月dd日", weekStart: 1 }, define("datepickercn", ["datepicker"], function (e) { return function () { return e.datepickercn } }(this)), define("utils/datepickerlist", ["jquery", "moment", "utils/time"], function (d, u, n) { d.fn.datepickerlist = function (e) { var r = d(this), o = [], t = "object" == typeof e && e, l = d.extend({}, { format: "YYYY-MM-DD", days: 5 }, t); function c(e, t) { var i = d('<p tabindex="0" class="datepicker-list__item accessible-click"/>'); return e.format(l.format) === (t || u()).format(l.format) && i.addClass("today"), i.append(d('<span class="name" />').html(n.relativeDate(e, t)), d('<span class="date" />').html(e.format(l.format))).data("date", e.format(l.format)).on("click", function () { r.find(".datepicker-list__item").removeClass("selected"), d(this).addClass("selected"), r.trigger("changeDate", [d(this).data("date")]) }), i } return function () { o = []; var e = l.days < 0, t = e ? -l.days : l.days, i = l.baseMomentDate, n = l.synServerTim ? l.synServerTim : void 0; r.html("").addClass("datepicker-list"); for (var a = null, s = 0; s < t; s++)a = c(u(i).subtract("days", e ? -s : s), n), r.append(a), o.push(a); r.on("setDate", function (e, t) { var i; i = t, d.each(o, function (e, t) { t.data("date") == u(i).format(l.format) && t.addClass("selected") }) }) }(), r } }), define("components/detailDateTimePicker/picker", ["backbone", "datepicker", "datepickercn", "templates", "moment", "helper", "utils/datepickerlist"], function (e, t, i, n, a, s) { return e.View.extend({ events: { "click input": "toggleLocationPicker", "click .input-group-addon": "toggleLocationPicker", toggle: "toggleLocationPicker", "click .detail-date-time-picker": "stopPropagation", click: "stopPropagation", "click .date-time-tabs li": "toggleDateTime", "mousewheel .picker-wrapper": "mouseWheelChangeOnTimes", "click .indicator": "scrollPage", "click .times li": "timeClicked" }, changeTimeToNow: function () { var e = this; $("body").on("click", function () { e.resetNowTimeDescription() }) }, resetNowTimeDescription: function () { this.selectedMoment.isSame(this.nextHalfHourInTheFuture()) && this.$("input").val(_l("现在")) }, initialize: function () { this.$pickerWrapper = $('<div class="detail-date-time-picker toggle-plugins"></div>'), this.$el.append(this.$pickerWrapper), this.showTimePicker = !0, this.synServerTim = this.options && this.options.synServerTim ? this.options.synServerTim : a(), this.selectedMoment = this.nextHalfHourInTheFuture(), this.$("input").data("time", this.selectedMoment.format()), this.render(), this.changeTimeToNow() }, stopPropagation: function (e) { e.stopPropagation() }, showPicker: function () { $(".toggle-plugins").hide(), this.$pickerWrapper.show(), this.selectedTimeChanged(), this.render() }, toggleLocationPicker: function (e) { this.$pickerWrapper.is(":visible") ? (this.$pickerWrapper.hide(), this.resetNowTimeDescription()) : (e && e.stopPropagation(), this.showPicker()) }, nextHalfHourInTheFuture: function () { var e = this.synServerTim.clone().startOf("hour").add("minutes", 30); return e.isBefore(this.synServerTim) && e.add("minutes", 30), e }, selectedTimeChanged: function () { var e = this.$("input"); "" != this.selectedMoment && this.selectedMoment.isSame(this.synServerTim, "day") && 0 == this.selectedMoment.hour() && 0 == this.selectedMoment.minutes() ? (e.val(_l("现在")), e.data("time", "")) : (e.val(this.selectedMoment.format("YYYY-MM-DD HH: mm")).trigger("change"), e.data("time", this.selectedMoment.format())) }, render: function () { this.showTimePicker ? (this.preRenderTimePicker(), this.$pickerWrapper.html(n.detailedDateTimePicker({ showTimePicker: this.showTimePicker, times: this.times, selectedTime: this.selectedMoment.format("HH: mm"), selectedWithInOneHour: !1 })), this.scrollToSelectedTime(), this.contentScrolled()) : (this.$pickerWrapper.html(n.detailedDateTimePicker({ showTimePicker: this.showTimePicker })), this.postRenderDatePicker()) }, preRenderTimePicker: function () { for (var e = a(this.selectedMoment.format()).startOf("day"), t = [], i = 0; i < 48; i++)e.isAfter(this.synServerTim) && t.push(e.format("HH: mm")), e.add("minutes", 30); this.times = t }, scrollToSelectedTime: function () { var e = this.$(".picker-wrapper"), t = 0; 0 < this.$(".times li.current").length && (t = this.$(".times li.current").position().top); var i = this.$(".picker-wrapper").height(); e.scrollTop(t - i / 3) }, startDate: function () { return "0d" }, endDate: function () { return !1 }, postRenderDatePicker: function () { var i = this, n = a(this.selectedMoment.format()); i.endDate() ? this.$(".detail-date-picker").datepickerlist({ format: "YYYY-MM-DD", baseMomentDate: i.synServerTim.clone().add("days", parseInt(i.startDate())), days: -parseInt(i.endDate()), synServerTim: i.synServerTim }).on("changeDate", function (e, t) { t && i.pickDate(t), n && (i.showTimePicker = !0, i.render()) }).trigger("setDate", n.startOf("day").toDate()).on("click", i.stopPropagation) : this.$(".detail-date-picker").datepicker({ language: s.getStandardLocale(), startDate: i.startDate(), endDate: i.endDate(), todayBtn: "linked" }).on("changeDate", function (e) { e.date && i.pickDate(e.date), n && !n.isSame(a(e.date), "date") && (i.showTimePicker = !0, i.render()) }).datepicker("setDate", n.startOf("day").toDate()).on("click", i.stopPropagation) }, toggleDateTime: function (e) { this.showTimePicker = $(e.currentTarget).hasClass("time"), this.render() }, pickDate: function (e) { this.selectedMoment.year(a(e).year()), this.selectedMoment.month(a(e).month()), this.selectedMoment.date(a(e).date()), this.selectedMoment.isBefore(this.synServerTim) && (this.selectedMoment = this.nextHalfHourInTheFuture(), this.$("input").data("time", this.selectedMoment.format())), this.showTimePicker = !0 }, timeClicked: function (e) { this.$(".times li").removeClass("current"), $(e.currentTarget).addClass("current"); var t = a($(e.currentTarget).text(), "HH: mm"); this.selectedMoment.hour(t.hour()), this.selectedMoment.minutes(t.minutes()), this.selectedTimeChanged(), $("body").click() }, mouseWheelChangeOnTimes: function (e) { var t = e.originalEvent.deltaY, i = $(e.currentTarget); if (t) { var n = i.scrollTop(); return i.scrollTop(n + t), this.contentScrolled(), !1 } }, contentScrolled: function () { var e = this.$(".picker-wrapper"), t = e.scrollTop(), i = this.$(".indicator.top"), n = this.$(".indicator.bottom"); 0 === t ? i.addClass("disabled") : i.removeClass("disabled"), t >= e.find(".times").height() - e.height() ? n.addClass("disabled") : n.removeClass("disabled") }, scrollPage: function (e) { e.stopPropagation(); var t, i = $(e.currentTarget).hasClass("top"), n = this.$(".picker-wrapper"), a = n.scrollTop(); t = i ? a - n.height() : a + n.height(); var s = this; return n.animate({ scrollTop: t }, 500, function () { s.contentScrolled() }), !1 } }) }), define("components/detailDateTimePicker/timeQueryPicker", ["components/detailDateTimePicker/picker", "helper"], function (e, n) { return e.extend({ preRenderTimePicker: function () { var e = moment(this.selectedMoment.format()).startOf("day"); if (!this.times) { for (var t = [], i = 0; i < 48; i++)t.push(e.format("HH: mm")), e.add("minutes", 30); this.times = t } }, postRenderDatePicker: function () { var e = { language: n.getStandardLocale(), startDate: this.startDate(), todayBtn: "linked" }; this.endDate() && (e.endDate = this.endDate()); var t = this, i = moment(this.selectedMoment.format()); this.$(".detail-date-picker").datepicker(e).datepicker("setDate", i.startOf("day").toDate()).on("changeDate", function (e) { e.date && t.pickDate(e.date), i && (t.showTimePicker = !0, t.render()) }).on("click", this.stopPropagation) }, pickDate: function (e) { this.selectedMoment.year(moment(e).year()), this.selectedMoment.month(moment(e).month()), this.selectedMoment.date(moment(e).date()), this.selectedTimeChanged(), this.showTimePicker = !0 }, startDate: function () { return "-7d" } }) }), define("views/pages/payFee/locationInput", ["backbone", "helper", "event", "components/detailDateTimePicker/timeQueryPicker", "components/detailedLocationPicker/pricePicker"], function (e, c, l, i, n) { return e.View.extend({ events: { "click .primary-button": "queryRate", "change input.origins": "originInputChanged", "change input.dests": "destInputChanged", "blur input.dests": "destInputChanged", "change #weight": "weightChanged", "regionModelUpdate .detail-location-input": "regionModelUpdate" }, initialize: function () { this.$(".origin-price").data("custom-url", _.sprintf(c.urls.subregionOrigin, { parentCode: "%s", level: "%s" })), this.originPrice = this.$(".detail-location-input.origin-price"), this.destPrice = this.$(".detail-location-input.dest-price"), this.originInput = this.$("input.origins.autocomplete"), this.destsInput = this.$("input.dests.autocomplete"), new n({ el: this.originPrice }), new n({ el: this.destPrice }), new i({ el: this.$(".detail-date-time-input") }); var e = this.originPrice.data("selected-area"), t = this.destPrice.data("selected-area"); "hk-mc-tw" === e && this.originPrice.data("max-level", 4), "hk-mc-tw" === t && this.originPrice.data("max-level", 4), this.originPrice.data("max-A000710000", 4), this.originPrice.data("max-A000820000", 4), this.originPrice.data("max-A000810000", 4), this.originPrice.data("max-886", 4), this.destPrice.data("max-A000710000", 4), this.destPrice.data("max-A000810000", 4), this.destPrice.data("max-A000820000", 4), this.destPrice.data("max-886", 4), this.$el.data("redirect") || (this.listenTo(l, "RateSearchCompleted", this.searchComplete), this.listenTo(l, "RateSearchFailed", this.searchFailed), this.listenTo(l, l.RateSearch, this.searchStart), this.listenTo(l, l.SwitchRateSearch, this.swithQueryType), this.handleQueryStringsFromURL()) }, handleQueryStringsFromURL: function () { var e = c.getQueryStrings(); e && "waybill" === e.from && (this.originInput.val(""), this.originInput.val(e.originName), this.destsInput.val(e.destName), this.$("#weight").val(Number(e.weight)), this.$(".time-query input").val(this.nextHalfHourInTheFuture(decodeURIComponent(e.time)).format("YYYY-MM-DD HH:mm"))), e && e.destName && e.destCode && e.originName && e.originCode && e.lang === c.getSiteLanguage() && (this.originInput.data("code", e.originCode), this.originInput.data("country-code", e.originCountryCode), this.originInput.val(e.originName), this.destsInput.data("code", e.destCode), this.destsInput.data("country-code", e.destCountryCode), this.destsInput.val(e.destName), this.$(".primary-button").toggleClass("disabled", !0), this.inputChanged(), this.queryRate()) }, nextHalfHourInTheFuture: function (e) { var t = moment(e).startOf("hour").add("minutes", 30); return t.isBefore() && t.add("minutes", 30), t }, regionModelUpdate: function (e, t) { var i = $(e.currentTarget), n = (this.originInput.data("country-code"), "GLOBAL" === t.regionTabs[0].parentRegion.code); t.regionTabs[0].parentRegion.code; i.data("max-level", n ? 1 : 4) }, searchStart: function () { this.$(".primary-button").button("loading") }, searchComplete: function (e) { this.$(".primary-button").button("reset") }, searchFailed: function () { this.$(".primary-button").button("reset") }, originInputChanged: function () { var e = this.originInput.data("code"), t = this.$("#weightUnit"), i = $("#unitWeight"), n = $("#length-value"), a = $("#width-value"), s = $("#height-value"); "A000001000" == e ? (t.text("lbs"), i.text("lbs"), n.attr("placeholder", "in"), a.attr("placeholder", "in"), s.attr("placeholder", "in")) : (t.text("kg"), i.text("kg")); var r = this.originInput.data("country-code"), o = this.destsInput; if (o.data("origin-country-code", r), e) { var l = _.sprintf(c.urls.subregionDest, { parentCode: "%s", originCode: e, level: "%s" }); $(".dest-price").first().data("custom-url", l), $(".dest-price").last().data("custom-url", l), o.data("code") && (o.val(""), o.data("code", "")), o.trigger("change") } this.inputChanged() }, destInputChanged: function () { this.inputChanged() }, inputChanged: function () { var e = this.originInput.data("code"), t = this.destsInput.data("code"); this.destsInput.attr("disabled", !e); var i = e && t && this.weightChanged(), n = this.$(".primary-button"); n.toggleClass("disabled", !i), i && n.text(n.data("resetText")), this.$(".error").hide(), "A000710000" === this.originInput.data("code") && "A000710000" === this.destsInput.data("code") && this.$(".primary-button").toggleClass("disabled", !0) }, weightChanged: function () { if (0 === this.$("input.weight").length) return !0; var e = this.$("input.weight").val(); return (isNaN(e) || _.isEmpty(e) || _.isNull(e)) && this.$("input.weight").val(1), !0 }, getQueryType: function () { var e, t, i, n, a, s, r = $(".payFee-page .origin-price .area-level-tabs li.current").data("tab"), o = $(".payFee-page .dest-price .area-level-tabs li.current").data("tab"); return "main-land" == r ? e = !0 : "hk-mc-tw" == r ? t = !0 : "international" == r && (i = !0), "main-land" == o ? n = !0 : "hk-mc-tw" == o ? a = !0 : "international" == o && (s = !0), "heavyCargo" == this.rateType ? "1" : e && n ? "2" : e && a ? "3" : t && n ? "4" : e && s || i && n || i && s ? "5" : t && s || i && a ? "9" : t && a ? "12" : "0" }, queryRate: function () { var e = this.originInput.data("code"), t = this.destsInput.data("code"), i = this.originInput.data("country-code"), n = this.destsInput.data("country-code"), a = this.$("input.date").data("time"), s = this.getQueryType(); if (this.$el.data("redirect")) { var r = this.originInput.val(), o = this.destsInput.val(); location.href = c.getDynamicURLWithContext("/price/?originCode=" + e + "&originCountryCode=" + i + "&originName=" + r + "&destCode=" + t + "&destCountryCode=" + n + "&destName=" + o + "&time=" + encodeURIComponent(a) + "&queryType=" + s + "&flag=" + !0 + "&lang=" + c.getSiteLanguage()) } else this.$(".error").hide(), l.trigger(l.RateSearch, { originCode: e, destCode: t, originCountryCode: i, destsCountryCode: n, time: a, flag: !0, queryType: s, rateType: this.rateType }) }, swithQueryType: function (e) { this.rateType = e.type, this.queryRate() } }) }), define("models/otherService", ["backbone"], function (e) { return e.Model.extend({ availableAt: function (e) { var t = e.origin, i = e.dests; t != _l("中国件") && t != _l("香港件") && t != _l("台湾件") && t != _l("澳门件") && (t = _l("国际件")), i != _l("中国件") && i != _l("香港件") && i != _l("台湾件") && i != _l("澳门件") && (i = _l("国际件")); for (var n = { originLocations: t, destsLocations: i }, a = this.get("locations"), s = !1, r = 0; r < a.length; r++)JSON.stringify(n) == JSON.stringify(a[r]) && (s = !0); return s } }) }), define("collections/otherServices", ["backbone", "models/otherService"], function (e, t) { return e.Collection.extend({ model: t, comparator: "order", filterOtherServicesWithLocations: function (t) { var e = _.filter(this.models, function (e) { return e.availableAt({ origin: t.originCountryCode, dests: t.destsCountryCode }) }); e.length ? this.trigger("availableOtherServicesFound", e) : $(".payFee-page .other-services-container").css("display", "none") } }) }), define("views/pages/payFee/otherService", ["event", "templates", "models/otherService", "backbone", "collections/otherServices"], function (e, t, i, n, a) { return n.View.extend({ template: t.otherService, initialize: function () { this.$otherServices = $('<div class="other-services"></div>'), this.$el.append(this.$otherServices), this.listenTo(e, e.RateSearch, this.rateSearchStarted), this.listenTo(e, "RateSearchCompleted", this.render), this.otherServices = new a(window.otherServiceList), this.listenTo(this.otherServices, "availableOtherServicesFound", this.appendOtherServices) }, appendOtherServices: function (e) { this.$otherServices.html(this.template({ otherServices: e })), this.$el.fadeIn() }, rateSearchStarted: function (e) { this.locations = _.extend(this.locations || {}, e), this.$el.slideUp(), this.$otherServices.html("") }, render: function (e) { if (e) { var t = this.locations; t.originCode && t.destCode && (this.otherServices.filterOtherServicesWithLocations(t), this.$el.is(":visible") && this.$el.slideDown()) } } }) }), define("models/payFeeComment", ["backbone", "event"], function (e, t) { return e.Model.extend({ defaults: { shouldShow: !1 }, initialize: function () { this.listenTo(t, t.RateSearch, this.refresh) }, refresh: function (e) { if (this.originCode = e.originCode ? e.originCode : this.originCode, this.originCountryCode = e.originCountryCode ? e.originCountryCode : this.originCountryCode, this.destCode = e.destCode ? e.destCode : this.destCode, this.destCountryCode = e.destCountryCode ? e.destCountryCode : this.destCountryCode, this.originCode && this.destCode) { var t = 0 <= _.indexOf(this.get("originLocations").split(" "), this.originCode), i = 0 <= _.indexOf(this.get("originLocations").split(" "), this.originCountryCode), n = 0 <= _.indexOf(this.get("destsLocations").split(" "), this.destCode), a = 0 <= _.indexOf(this.get("destsLocations").split(" "), this.destCountryCode); this.get("bothRequired") ? (t || i) && (n || a) ? this.set("shouldShow", !0) : this.set("shouldShow", !1) : i || t || a || n ? this.set("shouldShow", !0) : this.set("shouldShow", !1) } } }) }), define("collections/payFeeComments", ["backbone", "models/payFeeComment"], function (e, t) { return e.Collection.extend({ model: t }) }), define("views/pages/payFee/payFee", ["backbone", "bootstrap", "templates", "utils/time"], function (e, t, i, s) { return e.View.extend({ tagName: "tr", template: i.payFee, initialize: function (e) { if (1 == e.showDefault) this.$el.html(this.template({ showDefaultService: !0, service: e.data })); else { var t = this.model.toJSON(), i = $(".payFee-page .origin-price .area-level-tabs li.current").data("tab"), n = $(".payFee-page .dest-price .area-level-tabs li.current").data("tab"); "main-land" == i && "main-land" == n || (t.notmainland = !0), t.deliverTime ? t.relativeDate = s.relativeDate(moment(t.deliverTime)) : t.internet || ("T104" == t.limitTypeCode ? t.deliverTimeForType = _l("当日送达") : "T801" == t.limitTypeCode ? t.deliverTimeForType = _l("次早送达") : "T4" == t.limitTypeCode ? (t.deliverTimeForType = "2-3" + _l("天"), "hk-mc-tw" == i && "hk-mc-tw" == n ? t.deliverTimeForType = "" : "2" == t.orgionView && "2" == t.destView && (t.deliverTimeForType = "")) : "T6" == t.limitTypeCode ? (t.deliverTimeForType = "3-5" + _l("天"), "hk-mc-tw" == i && "hk-mc-tw" == n ? t.deliverTimeForType = "" : "2" == t.orgionView && "2" == t.destView && (t.deliverTimeForType = "")) : t.deliverTimeForType = ""); var a = e.model.collection.rateType; "coldChain" == a && t ? $(".service-clodchain-tips").show() : $(".service-clodchain-tips").hide(), t.showDestCurrencyPrice = e.showDestCurrencyPrice, this.$el.html(this.template({ showDefaultService: !1, rateType: a, service: t })) } } }) }), define("views/pages/payFee/payFeeInitial", ["backbone", "templates", "./payFee"], function (e, t, i) { return i.extend({ template: t.payFeeInitial, initialize: function () { var e = this.model.toJSON(), t = ["#EF7D00", "#E30413", "#FFED00", "#009440"]; e.limitTypeCode && (e.serTextColor = "white", "T104" == e.limitTypeCode ? e.serviceColor = t[0] : "T801" == e.limitTypeCode ? e.serviceColor = t[1] : "T4" == e.limitTypeCode ? (e.serviceColor = t[2], e.serTextColor = "black") : "T6" == e.limitTypeCode ? e.serviceColor = t[3] : (e.serTextColor = "", e.serviceColor = "")), this.$el.html(this.template(e)) } }) }), define("models/rateSearchOption", ["backbone"], function (e) { return e.Model.extend({ defaults: { weight: "", height: "", length: "", width: "" } }) }), define("views/pages/payFee/payFees", ["backbone", "templates", "./payFee", "./payFeeInitial", "models/rateSearchOption", "collections/payFee", "collections/detailRegions", "models/payFee"], function (e, t, a, n, i, s, r, o) { return e.View.extend({ tagName: "table", className: "services", template: t.payFee, initialize: function () { var i = this; this.listenTo(this.collection, "sync", this.render), this.listenTo(this.collection, "showDestCurrency", this.renderServices), this.listenTo(this.collection, "outOfRange", this.render), this.listenTo(this.collection, "showDefault", this.showDefaultRule); var e = this.collection.withPromotion(); s.setupOrderSymbol(e), _.each(e, function (e) { var t = new n({ model: e }); i.$el.append(t.$el) }) }, render: function () { var e = this.collection.checkResult, t = this.showSearchHint(); e.canSearch ? (this.appendServicesWithoutOutskirts(), this.$el.addClass("show-cargo-type"), this.$el.prepend(t)) : this.$el.html(t) }, isQueryLocationChinaMainLand: function () { var e = r.isNotAboard(this.collection.originCountryCode), t = r.isNotAboard(this.collection.destsCountryCode); return e && t }, appendServicesWithoutOutskirts: function () { var e, t = this.collection.withOutskirts(); 0 < t.length ? (e = t, _.each(e, function (e) { e.attributes.limitTypeName += "<em style='color:red;'>(" + _l("郊") + ")</em>" })) : e = this.collection.withoutOutskirts(); s.setupOrderSymbol(e), this.finallyServices = e, this.renderServices() }, renderServices: function () { this.$el.empty(), $(".service-heavyCargo-weight-tip").hide(), "heavyCargo" == this.collection.rateType && 0 < this.finallyServices.length && this.collection.weight && (this.collection.showDestCurrencyPrice ? this.collection.weight < this.finallyServices[0].get("destWeight") && $(".service-heavyCargo-weight-tip").show() : this.collection.weight < this.finallyServices[0].get("weight") && $(".service-heavyCargo-weight-tip").show()); var n = this; _.each(n.finallyServices, function (e) { var t = e.attributes; if ("T4" != t.limitTypeCode || "1" !== t.destView || "1" !== t.orgionView || t.deliverTime) { var i = new a({ model: e, showDestCurrencyPrice: n.collection.showDestCurrencyPrice }); n.$el.append(i.$el) } }) }, showSearchHint: function () { var e = $("<tbody><tr><td style='padding: 0 33px;color:red' colspan='4'></td></tr></tbody>"), i = [_l("重量超限,"), _l("体积超限,")], t = this.collection.checkResult, n = ""; return t.canSearch && this.arrayContain(t.errs, "2") ? n = _l("您的快件属于超长件，收件时将收取相应的超长附加费。感谢您对顺丰速运的关注与支持，如有疑问，可致电4008-111-111咨询。") : t.canSearch || (n = _l("很抱歉，您的快件"), $.each(t.errs, function (e, t) { n += i[t] }), n += _l("暂时不能提供收寄服务。感谢您对顺丰速运的关注与支持，如有疑问，可致电4008-111-111咨询。")), e.find("td").text(n), 0 == t.errs.length ? "" : e.html() }, arrayContain: function (e, t) { if (null == e) return !1; for (var i = 0; i < e.length; i++)if (e[i] == t) return !0; return !1 }, showDefaultRule: function (e) { if (this.$el.empty(), "coldChain" == this.collection.rateType) $(".service-wrapper").append("<span id='noData' style='margin-left: 45%;vertical-align: middle;font-size: 20px;color: red;'>" + _l("暂无数据") + "</span>"), $(".services-bottom-bar").toggleClass("empty-content", !0), $(".additional-services-link").empty(); else { var t = new a({ data: e, showDefault: !0 }); this.$el.append(t.$el) } } }) }), define("views/pages/payFee/comments", ["backbone", "templates"], function (e, t) { return e.View.extend({ className: "service-comments", template: t.payFeeComments, initialize: function () { this.listenTo(this.collection, "change:shouldShow", this.render) }, render: function () { this.collection.findWhere({ shouldShow: !0 }) ? this.$el.html(this.template({ comments: this.collection.toJSON() })).show() : this.$el.hide() } }) }), define("views/pages/payFee/moreWeight", ["jquery", "backbone", "templates", "event"], function (a, e, t, i) { return e.View.extend({ className: "more-weight", template: t.moreWeight, events: { "click .weight-search": "weightSearch", click: "stopPropagation", "keyup input": "refreshSearchButton", "blur #weight-value, #length-value, #width-value, #height-value": "onNumberBlur" }, onNumberBlur: function (e) { var t = a(e.target), i = t.val(), n = Number(i); isNaN(n) || t.val(n) }, initialize: function () { this.listenTo(this.model, "change", this.render), this.$el.html(this.template()), this.$("input").placeholder(), this.$length = this.$(".length-value"), this.$weight = this.$(".weight-value"), this.$height = this.$(".height-value"), this.$width = this.$(".width-value"), this.$weightBtn = a('[data-tab="weight"]'), this.listenTo(i, i.RateSearch, this.reloadOnFetch) }, reloadOnFetch: function (e) { e.originCountryCode && ("A000810000" === e.originCountryCode ? (this.$(".extra-weight-side-note").show(), this.$weightBtn.addClass("has-extra")) : (this.$(".extra-weight-side-note").hide(), this.$weightBtn.removeClass("has-extra"))) }, numberCheck: function (e) { var t = a(e.currentTarget).val(); isNaN(t) && (2 < (t = t.replace(/[^0-9\.]/g, "")).split(".").length && (t = t.replace(/\.+$/, "")), a(e.currentTarget).val(t)) }, getRoundWeight: function () { var e = a("input.dests").last().data("country-code"), t = a("input.origins").last().data("country-code"); return this.isChinaRegion(e) && this.isChinaRegion(t) ? Math.round(10 * Number(this.$weight.val())) / 10 : Math.round(100 * Number(this.$weight.val())) / 100 }, isChinaRegion: function (e) { return "A000086000" === e || "A000820000" === e || "A000810000" === e || "A000710000" === e }, hasWeightInput: function () { return 0 < this.getRoundWeight() }, hasSizeInput: function () { return 0 < Number(this.$height.val()) * Number(this.$length.val()) * Number(this.$width.val()) }, refreshSearchButton: function (e) { this.numberCheck(e), this.$(".weight-search").toggleClass("disabled", !this.hasWeightInput() && !this.hasSizeInput()) }, reloadModel: function () { this.model.set({ weight: this.$weight.val(), height: this.$height.val(), length: this.$length.val(), width: this.$width.val() }) }, searchOptionChange: function () { this.reloadModel() }, stopPropagation: function (e) { e.stopPropagation() }, toggleWeightPanel: function () { this.$(".weight-panel").toggle() }, weightSearch: function () { return this.getRoundWeight() && this.$weight.val(this.getRoundWeight()), (this.hasSizeInput() || this.hasWeightInput()) && i.trigger(i.RateSearch, { weight: this.$weight.val(), height: this.$height.val(), length: this.$length.val(), width: this.$width.val(), originCode: a("input.origins").last().data("code"), destCode: a("input.dests").last().data("code"), destCountryCode: a("input.origins").last().data("country-code"), originCountryCode: a("input.origins").last().data("country-code") }), this.toggleWeightPanel(), !1 }, render: function () { this.$length.val(this.model.get("length")), this.$weight.val(this.model.get("weight")), this.$height.val(this.model.get("height")), this.$width.val(this.model.get("width")) } }) }), define("views/pages/payFee/topBar", ["backbone", "templates", "models/rateSearchOption", "./moreWeight"], function (e, t, i, n) { return e.View.extend({ events: { "click li[data-tab=price-toggle] a": "priceCurrecyToggle", "click li[data-tab=weight] a": "moreWeightToggle" }, initialize: function () { this.render(!1) }, setupMoreWeightPannel: function () { var e = new i; this.moreWeightView = new n({ model: e }), this.$(".more-weight-wrapper").html(this.moreWeightView.$el), this.changeWeightUnit() }, changeWeightUnit: function () { var e = $("input.origins.autocomplete").data("code"), t = $("#unitWeight"), i = $("#length-value"), n = $("#width-value"), a = $("#height-value"); "A000001000" == e ? (t.text("lbs"), i.attr("placeholder", "in"), n.attr("placeholder", "in"), a.attr("placeholder", "in")) : t.text("kg") }, moreWeightToggle: function (e) { e.preventDefault(), e.stopPropagation(), this.moreWeightView.toggleWeightPanel() }, priceCurrecyToggle: function (e) { e.preventDefault(), this.collection.showDestCurrencyPrice = !this.collection.showDestCurrencyPrice, this.collection.trigger("showDestCurrency"), this.render(this.collection.showDestCurrencyPrice) }, render: function (e) { this.$el.html(t.topBarUtils({ showDestCurrency: e })), this.setupMoreWeightPannel() } }) }), define("views/pages/payFee/payFeesContainer", ["./otherService", "backbone", "collections/payFee", "collections/payFeeComments", "./payFees", "./comments", "./topBar", "event", "templates", "helper"], function (e, t, i, n, a, s, r, o, l, c) { return t.View.extend({ template: l.payFeeContainer, initialize: function () { this.rateType = "normal", this.collection = new i(window.serviceList), this.listenTo(o, o.RateSearch, this.searchStart), this.listenTo(this.collection, "sync", this.searchComplete), this.listenTo(this.collection, "showDefault", this.showSearchDefault), this.$el.html(this.template()), this.$serviceWrapper = this.$(".service-wrapper"), this.$serviceInternet = this.$(".service-internet-wrapper"), this.$searching = this.$(".searching"), this.topbarUtilsView = new r({ el: this.$(".utils"), collection: this.collection }), this.$additionalServicesLink = this.$(".additional-services-link"), this.appendServices(), this.appendServiceComments() }, events: { "click .service-switch a": "switchServiceType" }, switchServiceType: function (e) { var t = this.$(e.currentTarget).data("type"); t != this.rateType && (this.rateType = t, this.$(e.currentTarget).siblings().removeClass("active").end().addClass("active"), o.trigger(o.SwitchRateSearch, { type: this.rateType })) }, searchStart: function () { this.collection.checkResult.canSearch ? ($("#noData").remove(), this.$serviceInternet.empty(), this.$el.slideUp()) : ($(".service-comments").hide(), $(".services-bottom-bar").hide()) }, searchComplete: function () { o.trigger("RateSearchCompleted", !0), this.topbarUtilsView.$el.show(), this.$el.slideDown(), $("li[data-tab=price-toggle] a").show(), this.$(".service-clodchain-tips").hide(); var e = this.collection.availableAdditionalServices(); _.isEmpty(e) ? (this.$(".services-bottom-bar").toggleClass("empty-content", !0), this.$additionalServicesLink.html("")) : (this.$(".services-bottom-bar").toggleClass("empty-content", !1), this.$additionalServicesLink.html(l.addtionalService({ additionalServices: e }))), _.isEmpty(this.collection.models) ? this.$serviceWrapper.append("<span id='noData' style='margin-left: 45%;vertical-align: middle;font-size: 20px;color: red;'>" + _l("暂无数据") + "</span>") : this.$serviceInternet.html(l.payFeeInternet({ service: this.collection.models[0].toJSON() })) }, showSearchDefault: function () { o.trigger("RateSearchFailed"), this.topbarUtilsView.$el.show(), this.$el.slideDown(), $("li[data-tab=price-toggle] a").hide() }, appendServices: function () { this.$servicesView = new a({ collection: this.collection }), this.$serviceWrapper.append(this.$servicesView.$el) }, appendServiceComments: function () { var e = new n(window.serviceComment); this.$commentsView = new s({ collection: e }), this.$serviceWrapper.append(this.$commentsView.$el) } }) }), define("views/pages/payFee/payFeePage", ["backbone", "./locationInput", "./payFeesContainer", "./otherService"], function (e, t, i, n) { return e.View.extend({ initialize: function () { new t({ el: this.$(".payFee-location-inputs") }), new i({ el: this.$(".services-container") }), new n({ el: this.$(".other-services-container") }), $("body").on("click", function () { $(".weight-panel").hide() }) } }) }), define("views/pages/store/input", ["backbone", "helper", "jquery", "components/detailedLocationPicker/picker", "const"], function (e, s, n, t, r) { return e.View.extend({ events: { "click .primary-button": "onSearch", "change input": "inputChanged", "keyup .virtual-address-code, .address-keyword": "inputChanged", "change .address": "addressPickerChanged", "regionModelUpdate .detail-location-input": "regionModelUpdate", "click .switcher": "switchSearching", "click .storeTypeList.dropdown-menu a": "selectStoreType" }, initialize: function (e) { this.switchStatus = 1, this.$searchButton = this.$el.find(".primary-button"), this.taiwanStores = e.taiwanStores, this.chineseStores = e.chineseStores, this.map = e.map, this.googleMap = e.googleMap, this.$(".detail-location-input").data("max-A000710000", 5), this.$(".detail-location-input").data("max-A000810000", 5), this.$(".detail-location-input").data("max-852", 5), this.$(".detail-location-input").data("max-886", 5), this.$(".detail-location-input").data("hide-fussy-selector", !0), new t({ el: this.$(".detail-location-input") }), this.listenTo(this.taiwanStores, "notFound", this.showNotFoundError), this.listenTo(this.taiwanStores, "virtualNotFound", this.showVirtualNotFoundError), this.listenTo(this.chineseStores, "notFound", this.showNotFoundError), this.listenTo(this.chineseStores, "virtualNotFound", this.showVirtualNotFoundError), this.listenTo(this.chineseStores, "sync", this.resetView), this.listenTo(this.taiwanStores, "sync", this.resetView), this.handleQueryStringFromURL(), this.inputChanged() }, showMap: function () { n(".store-map-container").removeClass("hide"), this.isNotAboardForRate() ? (n("#china-store-google-map").removeClass("hide"), n("#china-store-map").addClass("hide")) : (n("#china-store-google-map").addClass("hide"), n("#china-store-map").removeClass("hide")) }, hideMap: function () { n(".store-map-container").addClass("hide"), n(".china-store-google-map").addClass("hide"), n(".china-store-map").addClass("hide") }, addressPickerChanged: function () { this.isTaiWanAddress || this.$(".address-keyword").show() }, switchSearching: function (e) { e.preventDefault(), this.clearError(); var t = n(e.target); 1 === this.switchStatus ? (t.text(t.data("text-picker")), this.$(".store-address-picker").hide(), this.$(".to-mark").hide(), this.$(".address-keyword").hide(), this.$(".address-keyword").val(""), this.$(".virtual-address-code").show(), this.switchStatus = 2) : (t.text(t.data("text-virtual")), this.$(".store-address-picker").show(), this.$(".to-mark").show(), "" !== this.$(".address").val() && this.$(".address-keyword").show(), this.$(".virtual-address-code").hide(), this.switchStatus = 1), this.inputChanged() }, handleQueryStringFromURL: function () { var e = s.getQueryStrings(); e && e.locationName && e.locationCode && e.locationCountryCode && e.lang === s.getSiteLanguage() && (this.$searchButton.button("loading"), this.$("input.address").data("code", e.locationCode), this.$("input.address").val(e.locationName), this.$("input.address-keyword").val(e.locationKeyword).show(), this.isTaiWanAddress = "A000710000" === e.locationCountryCode || r.RATE_OF_TW == e.locationRateCode, this.isNotAboardForRate() ? this.googleMap.searchByAddrName(e.locationName + (e.locationKeyword || ""), e.locationKeyword || "", e.locationCode, s.getSiteLanguage()) : this.isTaiWanAddress ? this.taiwanStores.searchStores(e.locationName + (e.locationKeyword || ""), e.locationKeyword || "", e.locationCode) : this.map.searchByAddressName(e.locationName + (e.locationKeyword || ""), e.locationKeyword || "")) }, resetView: function () { this.$searchButton.button("reset"), this.showMap() }, inputChanged: function () { if (1 === this.switchStatus) { var e = 20 < this.$(".address-keyword").val().length; e ? this.$(".keyword-error").show() : this.$(".keyword-error").hide(), this.$searchButton.toggleClass("disabled", _.isEmpty(this.$(".address").data("code")) || e) } else this.$searchButton.toggleClass("disabled", _.isEmpty(this.$(".virtual-address-code").val())) }, regionModelUpdate: function (e, t) { var i = t.regionTabs; this.isTaiWanAddress = _.find(i, function (e) { return !!e.selectedRegion && "A000710000" === e.selectedRegion.code }) }, validateVirtualAddressCode: function () { var e = this.$(".virtual-address-code").val(); return new RegExp(/[a-zA-Z0-9]{3,33}$/).test(e) }, isNotAboardForRate: function () { var e = !1, t = "hk" == s.getSiteLocation() || "tw" == s.getSiteLocation(); if (1 === this.switchStatus) { var i = this.$(".address").data("rate-code"); if (!i) { var n = s.getQueryStrings(); n && n.locationRateCode && (i = n.locationRateCode) } e = t && (i == r.RATE_OF_HK || i == r.RATE_OF_MACAO || i == r.RATE_OF_TW) } else { var a = this.$(".virtual-address-code").val(); e = t && (0 <= _.indexOf(a, "SF852") || 0 <= _.indexOf(a, "SF853") || 0 <= _.indexOf(a, "SF886") || 0 <= _.indexOf(a, "TW")) } return e }, isTaiWanAddr: function () { var e = s.getQueryStrings(); return !!(e && e.locationName && e.locationCode && e.locationCountryCode && e.lang === s.getSiteLanguage()) && "A000710000" === e.locationCountryCode }, onSearch: function () { this.clearError(), this.$searchButton.button("loading"); var e = this.$(".virtual-address-code").val(); 1 === this.switchStatus ? this.isNotAboardForRate() ? this.googleMap.searchByAddrName(this.getAddressName(), this.getKeyWord(), this.getRateCode(), s.getSiteLanguage()) : this.isTaiWanAddr() || this.isTaiWanAddress ? this.taiwanStores.searchStores(this.getAddressName(), this.getKeyWord(), this.getRateCode()) : this.map.searchByAddressName(this.getAddressName(), this.getKeyWord()) : this.validateVirtualAddressCode() ? this.isNotAboardForRate() ? this.chineseStores.searchByVirtualAddressCodeHMT(e, this.googleMap) : 0 <= _.indexOf(e, "SF886") || 0 <= _.indexOf(e, "TW") ? this.taiwanStores.searchByVirtualAddressCode(e, this.getRateCode()) : this.chineseStores.searchByVirtualAddressCode(e) : (this.$searchButton.button("reset"), this.showVirtualAddressCodeError()) }, getRateCode: function () { return this.$(".address").data("rate-code") }, clearError: function () { this.$(".error").hide() }, showNotFoundError: function () { this.clearError(), this.$searchButton.button("reset"), this.$(".not-found-error").show(), this.hideMap() }, showVirtualNotFoundError: function () { this.clearError(), this.$searchButton.button("reset"), this.$(".not-found-virtual-error").show(), this.hideMap() }, showVirtualAddressCodeError: function () { this.clearError(), this.$searchButton.button("reset"), this.$(".virtual-address-code-error").show(), this.hideMap() }, getAddressName: function () { return this.isTaiWanAddr() || this.isTaiWanAddress ? this.$(".address").val() : this.$(".address").val() + this.$(".address-keyword").val() }, getKeyWord: function () { return this.$(".address-keyword").val() }, selectStoreType: function (e) { var t = n(e.currentTarget), i = t.text(); this.$(".storeType").val(i), window.storeType = t.data("code") } }) }), define("views/pages/store/map", ["backbone"], function (e) { return e.View.extend({ events: { "click .close": "closeTip" }, initialize: function () { this.listenTo(this.collection, "sync", this.render) }, closeTip: function () { this.model.closeOverlayTip() }, render: function () { "cn" === Helper.getSiteLocation() && 0 < this.collection.length ? $(".store-certificate-prompt").show() : $(".store-certificate-prompt").hide(), $(".store-result").hide(), this.$el.show() } }) }), define("views/pages/store/taiwanStoresResult", ["backbone", "templates", "jquery"], function (e, t, i) { return e.View.extend({ initialize: function () { this.listenTo(this.collection, "sync", this.render) }, render: function () { i(".store-result").hide(), this.$el.show(), this.$el.find(".results").html(t.taiwanStoresTable({ stores: this.collection.toJSON() })) } }) }), define("models/store", ["backbone", "templates"], function (e, n) { return e.Model.extend({ parse: function (e) { return null == window.storeType ? e : window.storeType == e.storeType ? e : void 0 }, parseData: function () { var e; this.has("serviceContent") && (e = this.get("serviceContent"), 0 <= _.indexOf(e, "1") && this.set("service_content_type", this.getCMSLabels().serviceContent1), 0 <= _.indexOf(e, "2") && this.set("service_content_type", this.getCMSLabels().serviceContent2), 0 <= _.indexOf(e, "3") && this.set("service_content_type", this.getCMSLabels().serviceContent3), 0 <= _.indexOf(e, "4") && this.set("service_content_type", this.getCMSLabels().serviceContent4), 0 <= _.indexOf(e, "5") && this.set("service_content_type", this.getCMSLabels().serviceContent5), this.set("telephone", this.get("tel")), this.set("virtual_addr", this.get("code"))) }, parseTWData: function () { var e; this.has("service_content_type") && (e = this.get("service_content_type"), 0 <= _.indexOf(e, "1") && this.set("service_content_type", this.getCMSLabels().serviceContent1), 0 <= _.indexOf(e, "2") && this.set("service_content_type", this.getCMSLabels().serviceContent2), 0 <= _.indexOf(e, "3") && this.set("service_content_type", this.getCMSLabels().serviceContent3), 0 <= _.indexOf(e, "4") && this.set("service_content_type", this.getCMSLabels().serviceContent4), 0 <= _.indexOf(e, "5") && this.set("service_content_type", this.getCMSLabels().serviceContent5)) }, updateServices: function () { var e; if (this.has("serviceContent")) { e = this.get("serviceContent"); var t = []; 0 <= _.indexOf(e, "1") && t.push({ flag: "self-send", name: this.getCMSLabels().serviceContent1 }), 0 <= _.indexOf(e, "2") && t.push({ flag: "self-get", name: this.getCMSLabels().serviceContent2 }), 0 <= _.indexOf(e, "3") && t.push({ flag: "self-send-get", name: this.getCMSLabels().serviceContent3 }), 0 <= _.indexOf(e, "4") && t.push({ flag: "personal-address", name: this.getCMSLabels().serviceContent4 }), 0 <= _.indexOf(e, "5") && t.push({ flag: "convenient", name: this.getCMSLabels().serviceContent5 }), this.set("services", t) } }, getType: function () { return "1" === this.get("storeType") ? this.getCMSLabels().type1 : "2" === this.get("storeType") ? this.getCMSLabels().type2 : "3" === this.get("storeType") ? this.getCMSLabels().type3 : "4" === this.get("storeType") ? this.getCMSLabels().type4 : (this.get("storeType"), this.getCMSLabels().type5) }, getLabel: function () { var e = {}; return e.type = this.getType(), this.get("code") ? "SF" === this.get("code").substring(0, 2).toUpperCase() ? e.code = this.get("code") : e.code = "SF" + this.get("code") : e.code = "", e }, getImageUrl: function () { var e; return "1" === this.get("storeType") ? this.get("selfSendDiscount") || this.get("selfPickupDiscount") ? (e = this.getCMSLabels().type6Image, this.set("tipImageUrl", this.getCMSLabels().type6ImageTip)) : (e = this.getCMSLabels().type1Image, this.set("tipImageUrl", this.getCMSLabels().type1ImageTip)) : "2" === this.get("storeType") ? (e = this.getCMSLabels().type2Image, this.set("tipImageUrl", this.getCMSLabels().type2ImageTip)) : "3" === this.get("storeType") ? (e = this.getCMSLabels().type3Image, this.set("tipImageUrl", this.getCMSLabels().type3ImageTip)) : "4" === this.get("storeType") ? (e = this.getCMSLabels().type4Image, this.set("tipImageUrl", this.getCMSLabels().type4ImageTip)) : (this.get("storeType"), e = this.getCMSLabels().type5Image, this.set("tipImageUrl", this.getCMSLabels().type5ImageTip)), e = e.substring(e.indexOf("/resource")), location.protocol + "//" + location.host + e }, getLabelOption: function () { var e = new MLabelOptions; return e.content = "", e.hasBorder = !1, e.hasBackground = !1, e.labelPosition = new MPoint(12, -8), e }, getMarkerOptions: function () { this.updateServices(); var e = {}; return e.icon = this.getImageUrl(), e }, getContent: function () { return n.storePoint({ store: this.toJSON(), label: this.getLabel() }).replace(/(\r\n|\n|\r)/gm, "") }, getCMSLabels: function () { return window._cmsLabels }, getMarker: function () { var e = this.getMarkerOptions(); return this.get("lng") && this.get("lat") && (e.position = new AMap.LngLat(this.get("lng"), this.get("lat"))), new AMap.Marker(e) }, getMarkerTipContent: function (e) { return n.storePoint({ tipImageUrl: e.getImageUrl(), services: e.updateServices(), store: e.toJSON(), label: e.getLabel() }).replace(/(\r\n|\n|\r)/gm, "") }, getMapBarMarker: function () { var e = new MPoint(this.get("lng"), this.get("lat")); this.updateServices(), this.getImageUrl(); var t = n.storePoint({ store: this.toJSON(), label: this.getLabel() }).replace(/(\r\n|\n|\r)/gm, ""), i = new MMarker(e, new MIcon(this.getImageUrl(), 32, 32), new MInfoWindow("", t)); return this.set("markerId", i.id), i } }) }), define("collections/chineseStores", ["backbone", "underscore", "models/store", "helper"], function (e, n, t, i) { return e.Collection.extend({ model: t, getUrl: function () { return _webConfig.useNewStore ? i.getRESTfulDomain("store/query") : i.getRESTfulDomain("store") }, searchByVirtualAddressCode: function (e) { this.searchStores(this.getRateReq(e)) }, getRateReq: function (e) { return _webConfig.useNewStore ? { storeId: e } : { virtualAddressCode: e } }, searchStores: function (e) { var i = "notFound"; n.has(e, "virtualAddressCode") && (i = "virtualNotFound"), this.url = this.getUrl(), this.fetch({ data: e, error: function (e, t) { t.status, e.trigger(i) } }) }, searchByVirtualAddressCodeHMT: function (e, t) { this.searchStoresHMT(this.getRateReq(e), t) }, searchStoresHMT: function (e, t) { var i = "notFound"; n.has(e, "virtualAddressCode") && (i = "virtualNotFound"), this.url = this.getUrl(), this.fetch({ data: e, success: function (e) { t.drawPoint(e) }, error: function (e, t) { t.status, e.trigger(i) } }) } }) }), define("collections/taiwanStores", ["backbone", "underscore", "models/store", "const", "helper"], function (e, s, t, i, r) { return e.Collection.extend({ model: t, getUrl: function (e) { return _webConfig.useNewStore ? "TW" == e ? r.getRESTfulDomain("store/taiwan/query") : r.getRESTfulDomain("store/query") : "TW" == e ? r.getRESTfulDomain("store/taiwan") : r.getRESTfulDomain("store") }, getRateReq: function (e, t, i, n) { var a; return t && (a = t.split("-")), _webConfig.useNewStore ? s.isEmpty(t) ? { storeId: e } : { province: a[0], city: a[1], district: a[2], rateCode: n, lang: "tw" === r.getSiteLocation().toLowerCase() ? "tc" : "sc" } : s.isEmpty(t) ? { virtualAddressCode: e } : { province: a[0], city: a[1], county: a[2], start: 0, end: 100, lang: "tw" === r.getSiteLocation().toLowerCase() ? "tc" : "sc" } }, searchStores: function (e, t, i) { this.url = this.getUrl("TW"), this.fetch({ data: this.getRateReq("", e, t, i), success: function (e) { e.each(function (e) { e.parseTWData() }) }, error: function (e, t) { 404 === t.status && e.trigger("notFound") } }) }, searchByVirtualAddressCode: function (e, t) { this.url = this.getUrl(""), this.fetch({ data: this.getRateReq(e, "", t), success: function (e) { e.each(function (e) { e.parseData() }) }, error: function (e, t) { 404 === t.status && e.trigger("virtualNotFound") } }) }, parse: function (e) { return e.result ? e.result : e } }) }), define("models/mapFix", ["underscore"], function (n) { var a = { "香港香港岛上环": { Y: "22.283696", X: "114.157047" }, "香港香港岛西环": { Y: "22.282147", X: "114.140739" }, "香港香港岛鸭脷洲": { Y: "22.23818", X: "114.159794" }, "香港香港岛北角": { Y: "22.288064", X: "114.20567" }, "香港香港岛湾仔": { Y: "22.2761507532427", X: "114.175157546997" }, "香港新界葵涌": { Y: "22.3619033549806", X: "114.134945869445" }, "香港新界马鞍山": { Y: "22.421899", X: "114.236526" }, "香港新界将军澳": { Y: "22.304602", X: "114.264615" }, "香港九龙长沙湾": { Y: "22.332174", X: "114.161038" }, "香港新界大埔": { Y: "22.44324", X: "114.17078" }, "香港九龙慈云山": { Y: "22.345432", X: "114.205306" }, "香港九龙观塘": { Y: "22.310935", X: "114.227943" }, "香港九龙荔枝角": { Y: "22.334833", X: "114.153013" }, "香港九龙美孚": { Y: "22.336778537476", X: "114.140181541442" }, "香港九龙九龙湾": { Y: "22.317584", X: "114.216184" }, "香港九龙彩虹": { Y: "22.331757", X: "114.212065" }, "香港离岛大屿山": { X: "114.010277", Y: "22.279089" }, "澳门路环": { X: "113.559153", Y: "22.116473" }, "香港离岛马湾": { X: "114.062328", Y: "22.346307" } }, s = { "香港香港岛": { Y: "22.2761507532427", X: "114.175157546997" }, "香港离岛": { X: "113.941032", Y: "22.278811" }, "香港新界": { Y: "22.3619033549806", X: "114.134945869445" } }; return { searchFixies: function (t) { var e = s[t]; if (e) return e; var i = n.find(n.keys(a), function (e) { return -1 !== n.indexOf(t, e) }); return i ? a[i] : void 0 } } }), define("models/map", ["backbone", "models/mapFix"], function (e, a) { return e.Model.extend({ initialize: function () { var e = { zoom: 4 }; e.center = new AMap.LngLat(104.195397, 35.86166), e.resizeEnable = !0, e.scrollWheel = !0, e.lang = "zh_cn"; var t = new AMap.Map(this.get("mapContainer"), e); t.plugin(["AMap.ToolBar"], function () { t.addControl(new AMap.ToolBar) }), t.plugin(["AMap.Scale"], function () { t.addControl(new AMap.Scale) }); var i = new AMap.PlaceSearch({ pageSize: 1, pageIndex: 1 }); this.mapObj = t, this.placeSearch = i, this.listenTo(this.get("stores"), "sync", this.storesChange), _.bindAll(this, "openOverlayTip", "onGeocodeReturn") }, storesChange: function () { var t = this; window.setTimeout(function () { t.clearPoints(), t.get("stores").each(function (e) { e.getMarker().getPosition() && t.drawPoint(e.getMarker(), e.getContent()) }), t.setZoomAndCenter() }, 500) }, drawPoint: function (e, t) { e.setMap(this.mapObj), AMap.event.addListener(e, "click", function () { new AMap.InfoWindow({ isCustom: !0, content: t, offset: new AMap.Pixel(8, -41) }).open(e.getMap(), e.getPosition()) }) }, clearPoints: function () { this.mapObj.clearMap() }, searchByAddressName: function (e, t) { e = e.replace(/-/g, ""); var i = a.searchFixies(e); if (i) this.onGeocodeReturn({ list: [{ x: i.X, y: i.Y, range: window._cmsLabels.queryRadius }] }); else { var n = this.onGeocodeReturn; this.placeSearch.search(e, function (e, t) { var i = {}; "complete" === e && t.poiList.pois[0] && (i.list = [{ x: t.poiList.pois[0].location.lng, y: t.poiList.pois[0].location.lat }]), n(i) }) } }, onGeocodeReturn: function (e) { this.set("longitudeAndLatitude", { longitude: e.list ? e.list[0].x : 0, latitude: e.list ? e.list[0].y : 0, range: window._cmsLabels.queryRadius }), this.get("stores").searchStores(this.get("longitudeAndLatitude")) }, setZoomAndCenter: function () { var e = this.get("stores"); 1 === e.size() ? this.mapObj.setZoomAndCenter(window._cmsLabels.defaultLevel, new AMap.LngLat(e.at(0).get("lng"), e.at(0).get("lat"))) : null != this.get("longitudeAndLatitude") && this.mapObj.setZoomAndCenter(window._cmsLabels.defaultLevel, new AMap.LngLat(this.get("longitudeAndLatitude").longitude, this.get("longitudeAndLatitude").latitude)) }, closeOverlayTip: function () { this.mapObj.clearInfoWindow() }, openOverlayTip: function (e, t) { new AMap.InfoWindow({ isCustom: !0, content: t, offset: new AMap.Pixel(16, -45) }).open(this.mapObj, e.getPosition()) } }) }), define("models/mapBar", ["backbone", "models/mapFix"], function (n, a) { return n.Model.extend({ initialize: function () { maplet = new Maplet(this.get("mapContainer")), maplet.centerAndZoom(new MPoint(116.38749, 39.90515), window._cmsLabels.defaultLevel), maplet.addControl(new MStandardControl), maplet.customInfoWindow = !0, this.listenTo(this.get("stores"), "sync", this.storesChange) }, storesChange: function () { var t = this; window.setTimeout(function () { t.clearPoints(), t.closeOverlayTip(), t.get("stores").each(function (e) { t.drawPoint(e) }), t.setZoomAndCenter() }, 500) }, drawPoint: function (e) { marker = e.getMapBarMarker(), maplet.addOverlay(marker), MEvent.addListener(marker, "iw_beforeopen", this.showCustomIw), MEvent.addListener(marker, "click", function (e) { maplet.setCenter(new MPoint(e.pt.lon, e.pt.lat)) }) }, showCustomIw: function (e, t, i) { var n = { pin: !1, zindex: 1001, content: e.info.content, location: { type: "xy", x: 10, y: -16 }, zoomhide: !0 }; p = new MPanel(n), MPanel.enableDragMap(p.dom, !1), maplet.addPanel(p) }, clearPoints: function () { maplet.clearOverlays(!1) }, searchByAddressName: function (e) { 2 < e.split("-").length ? city = e.split("-")[1] : city = e.split("-")[0], e = e.replace(/-/g, ""); var t = a.searchFixies(e); if (t) this.onGeocodeReturn(t.X, t.Y); else { var i = this; n.ajax({ type: "GET", dataType: "json", url: Helper.getRESTfulDomain("store/getLatLonByAddress?city=" + city + "&encode=UTF-8&customer=2&keyword=" + e), success: function (e) { x = e.strlatlon.split(",")[0], y = e.strlatlon.split(",")[1], i.onGeocodeReturn(x, y) } }) } }, onGeocodeReturn: function (e, t) { this.set("longitudeAndLatitude", { longitude: e || 0, latitude: t || 0, range: window._cmsLabels.queryRadius }), this.get("stores").searchStores(this.get("longitudeAndLatitude")) }, closeOverlayTip: function () { _.each(maplet.getPanels(), function (e) { maplet.removePanel(e) }) }, setZoomAndCenter: function () { var e = this.get("stores"); 1 === e.size() ? null != e.at(0).get("lng") && (maplet.setCenter(new MPoint(e.at(0).get("lng"), e.at(0).get("lat"))), maplet.setZoomLevel(window._cmsLabels.defaultLevel)) : (maplet.setCenter(new MPoint(this.get("longitudeAndLatitude").longitude, this.get("longitudeAndLatitude").latitude)), maplet.setZoomLevel(window._cmsLabels.defaultLevel)) } }) }), define("models/googleMap", ["backbone", "models/mapFix", "models/store"], function (e, t, n) { return e.Model.extend({ initialize: function () { this.otherStore = new n, this.marker_hk = new google.maps.Marker; var e = { zoom: 4, center: new google.maps.LatLng(22.396428, 114.109497), mapTypeId: google.maps.MapTypeId.ROADMAP }; this.mapObj = new google.maps.Map($("#" + this.get("mapContainer")).get(0), e), this.marker_hk.setMap(this.mapObj), this.marker_hk.setVisible(!0), this.markersArray = [], this.clickMarkersArray = null, this.geocoder = new google.maps.Geocoder }, searchByAddrName: function (e, t, r, i) { var o = this, l = "", c = "", d = ""; if (e) { var n = e.split("-"); l = n[0], c = n[1], d = n[2] } this.geocoder.geocode({ address: e, language: this.getLanguageCode(i) }, function (e, t) { if (t == google.maps.GeocoderStatus.OK) { var i = e[0].geometry.location; o.mapObj.setCenter(i), o.mapObj.setZoom(4); var n, a = new String(i), s = (e = a.substring(1, a.length - 1)).split(","); n = _webConfig.useNewStore ? { longitude: s[1].trim(), latitude: s[0].trim(), province: l, city: c, district: d, rateCode: r } : { longitude: s[1].trim(), latitude: s[0].trim(), range: window._cmsLabels.queryRadius }, o.set("longitudeAndLatitude", n), o.get("stores").searchStoresHMT(o.get("longitudeAndLatitude"), o) } }) }, drawPoint: function (e) { var s = this.mapObj, r = 0, o = this.otherStore; this.deleteMarkersArray(); var l = this; s.setZoom(12), e.each(function (e) { if (null != e.get("lat")) { var t = new google.maps.LatLng(e.get("lat"), e.get("lng")); 0 == r && (s.setZoom(12), s.setCenter(t), r++); var i = new google.maps.Marker({ icon: l.getIconUrl(e), position: t, map: s, visible: !0 }); l.markersArray.push(i); var n = o.getMarkerTipContent(e), a = new google.maps.InfoWindow({ maxWidth: 380, maxHeight: 260, content: n.replace('class="store"', 'class="store-new"') }); google.maps.event.addListener(i, "click", function () { l.clickMarkersArray && l.clickMarkersArray.close(), a.open(s, i), l.clickMarkersArray = a }) } }) }, deleteMarkersArray: function () { if (this.markersArray && 0 < this.markersArray.length) { for (i = 0; i < this.markersArray.length; i++)this.markersArray[i].setMap(null); this.markersArray = [], this.markersArray.length = 0 } }, getLanguageCode: function (e) { return "SC" == e ? "zh" : "TC" == e ? "zh-TW" : "EN" == e ? "en" : e }, getIconUrl: function (e) { var t; return "/" === (t = e.get("selfSendDiscount") || e.get("selfPickupDiscount") ? this.otherStore.getCMSLabels().type5Image : "1" === e.get("storeType") ? this.otherStore.getCMSLabels().type1Image : "2" === e.get("storeType") ? this.otherStore.getCMSLabels().type2Image : "3" === e.get("storeType") ? this.otherStore.getCMSLabels().type3Image : "6" === e.get("storeType") ? this.otherStore.getCMSLabels().type6Image : "9" === e.get("storeType") ? this.otherStore.getCMSLabels().type9Image : this.otherStore.getCMSLabels().type4Image)[0] ? location.protocol + "//" + location.host + t : location.protocol + "//" + location.host + location.pathname + t } }) }), define("views/pages/store/storeManager", ["backbone", "jquery", "./input", "./map", "./taiwanStoresResult", "collections/chineseStores", "collections/taiwanStores", "models/map", "models/mapBar", "models/googleMap", "helper"], function (e, a, s, r, o, l, c, d, t, u, h) { return e.View.extend({ initialize: function () { var e, t = new l, i = new d({ mapContainer: "china-store-map", stores: t }); "hk" === h.getSiteLocation() || "tw" === h.getSiteLocation() ? (e = new u({ mapContainer: "china-store-google-map", stores: t }), a(".store-map-container").removeClass("hide"), a("#china-store-google-map").removeClass("hide"), a("#china-store-map").addClass("hide")) : e = i; var n = new c; new s({ el: a(".store-input-view"), chineseStores: t, map: i, googleMap: e, taiwanStores: n }), new r({ el: this.$(".store-map"), collection: t, model: i, googleMap: e }), new o({ el: this.$(".store-table"), collection: n }) } }) }), define("components/detailedLocationPicker/available", ["./picker"], function (e) { return e.extend({ availableRegions: function () { return "international" === this.getSelectedArea() ? this.regions.models : this.regions.filter(function (e) { return e.get("availableAsOrigin") || e.get("availableAsDestination") }) }, unavailableRegions: function () { return this.regions.filter(function (e) { return !e.get("availableAsOrigin") && !e.get("availableAsDestination") && e.get("opening") }) } }) }), define("views/pages/range/input", ["backbone", "collections/detailRegions", "components/detailedLocationPicker/available"], function (e, r, t) { return e.View.extend({ events: { "click .primary-button": "queryRangeDetail", "change .detail-location-input input": "inputChanged", "keyup .abroad-zip-code-input input": "zipCodeinputChanged", "regionModelUpdate .detail-location-input": "regionModelUpdate" }, initialize: function () { this.$(".detail-location-input").data("max-A000710000", 5), this.$(".detail-location-input").data("max-886", 5), new t({ el: this.$(".detail-location-input") }), this.inputChanged() }, inputChanged: function () { var e = this.$("input").data("code"), t = this.$("input").data("country-code"), i = this.$("input").data("rate-code"), n = r.isNotAboard(t), a = r.isNotAboardForRate(i), s = Boolean(e); n || a ? this.$(".abroad-zip-code-input").hide() : (this.$(".abroad-zip-code-input").show(), this.$(".abroad-zip-code-input input").val(""), s = s && Boolean(this.$(".abroad-zip-code-input input").val())), this.$(".primary-button").toggleClass("disabled", !s) }, numberCheck: function (e) { var t = $(e.currentTarget).val(); /[^a-zA-Z0-9]/g.test(t) && (t = t.replace(/[^a-zA-Z0-9]/g, ""), $(e.currentTarget).val(t)), /[a-z]/g.test(t) && $(e.currentTarget).val(t.toUpperCase()) }, zipCodeinputChanged: function (e) { this.numberCheck(e); var t = this.$("input").data("code"), i = Boolean(t) && Boolean(this.$(".abroad-zip-code-input input").val()); this.$(".primary-button").toggleClass("disabled", !i) }, regionModelUpdate: function (e, t) { this.isTaiWanAddress = _.some(t.regionTabs, function (e) { return e.selectedRegion && "A000710000" === e.selectedRegion.code }), this.isHongKongAddress = _.some(t.regionTabs, function (e) { return e.selectedRegion && "A000810000" === e.selectedRegion.code }), this.isMacaoAddress = _.some(t.regionTabs, function (e) { return e.selectedRegion && "A000820000" === e.selectedRegion.code }); var i = $(e.currentTarget), n = $("li[class='accessible-click current']"); this.isChoosingAbord = "international" === n.data("tab") || "international" === i.data("selected-area"), i.data("max-level", this.isChoosingAbord ? 1 : 4) }, queryRangeDetail: function (e) { var t = this.$("input").data("code"), i = this; this.model.clear().trigger("sync"); var n = $(e.currentTarget); n.button("loading"), this.$(".error").hide(), this.model.set({ locationName: this.$("input").val(), locationCode: this.$("input").data("code"), locationCountryCode: this.$("input").data("country-code"), locationRateCode: this.$("input").data("rate-code"), isTaiWanAddress: this.isTaiWanAddress, isHongKongAddress: this.isHongKongAddress, isMacaoAddress: this.isMacaoAddress, isChoosingAbord: this.isChoosingAbord, zipCodeInputed: this.$(".abroad-zip-code-input input").val() }), this.model.fetchRegion(t, { error: function () { i.isChoosingAbord ? i.$(".error[data-error=zip-code-not-found]").show() : i.$(".error[data-error=not-found]").show() }, complete: function () { n.button("reset") } }) } }) }), define("views/pages/range/result", ["backbone", "templates", "helper"], function (e, i, r) { return e.View.extend({ events: { "click .result-regions li": "rangeClicked" }, initialize: function () { this.listenTo(this.model, "sync", this.render) }, closePreviousPopover: function (e) { var t = this.$(".result-region-detail-wrapper"); t.length ? t.fadeOut(function () { t.remove(), e() }) : e() }, storeURL: function (e, t, i, n, a) { var s = a ? "&locationKeyword=" + a : ""; return r.getDynamicURLWithContext("/store/?locationName=" + e + "&locationCode=" + t + "&locationCountryCode=" + i + s + "&lang=" + r.getSiteLanguage() + "&locationRateCode=" + n) }, rangeDescriptionDatasource: function () { return [{ availableAsOrigin: !0, availableAsDestination: !1, selfSend: !1, selfPickup: !1, showRemark: !1, remarks: [{ litterTag: _l("收"), remark: _l("仅支持上门收件服务，暂不支持上门派件") }] }, { availableAsOrigin: !1, availableAsDestination: !0, selfSend: !1, selfPickup: !1, showRemark: !1, remarks: [{ litterTag: _l("派"), remark: _l("仅支持上门派件服务，暂不支持上门收件") }] }, { availableAsOrigin: !0, availableAsDestination: !1, selfSend: !0, selfPickup: !1, showRemark: !0, remarks: [{ litterTag: _l("自"), remark: _l("仅支持到店自寄服务，暂不支持上门收派件") }] }, { availableAsOrigin: !1, availableAsDestination: !0, selfSend: !1, selfPickup: !0, showRemark: !0, remarks: [{ litterTag: _l("自"), remark: _l("仅支持到店自取服务，暂不支持上门收派件") }] }, { availableAsOrigin: !0, availableAsDestination: !0, selfSend: !0, selfPickup: !0, showRemark: !0, remarks: [{ litterTag: _l("自"), remark: _l("仅支持到店自寄自取服务，暂不支持上门收派件") }] }] }, getAvailableDescription: function (e) { var t = _.findWhere(this.rangeDescriptionDatasource(), { availableAsOrigin: e.availableAsOrigin, availableAsDestination: e.availableAsDestination, selfSend: e.selfSend, selfPickup: e.selfPickup }), i = t ? t.remarks : []; return e.addTime && i.push({ litterTag: _l("时"), remark: _p(_l("上门服务需要加时：+%s天"), e.addTime), remark_content: e.remark }), i }, getShowRemark: function (e) { var t = _.findWhere(this.rangeDescriptionDatasource(), { availableAsOrigin: e.availableAsOrigin, availableAsDestination: e.availableAsDestination, selfSend: e.selfSend, selfPickup: e.selfPickup }); return !(null == t || null == t.showRemark || !t.showRemark) }, getShowRemarkFromEnd: function (e) { return e.get("isTaiWanAddress") || e.get("isHongKongAddress") || e.get("isMacaoAddress") }, rangeClicked: function (e) { }, render: function () { if (this.model.get("type") || this.model.get("name")) { this.$el.slideDown(); var e = this.model.toJSON(), t = $(".detail-location-input input.no-left-border").prop("title"); t && e && (e.name = t), e.isChoosingAbord ? this.$el.html(i.rangeResultInternational(e)) : (e.storeLinkURL = this.storeURL(e.locationName, e.locationCode, e.locationCountryCode, e.locationRateCode), e.lang = r.getSiteLanguage(), e.region = r.getSiteLocation(), this.$el.html(i.rangeResult(e))) } else this.$el.slideUp() } }) }), define("models/range", ["backbone", "helper"], function (e, i) { return e.Model.extend({ fetchRegion: function (e, t) { this.get("isChoosingAbord") ? this.url = i.getRESTfulDomain("region/" + e + "/globalRange?zipCode=" + this.get("zipCodeInputed")) : this.url = i.getRESTfulDomain("region/" + e + "/range"), this.fetch(t) } }) }), define("views/pages/range/range", ["backbone", "./input", "./result", "models/range"], function (e, t, i, n) { return e.View.extend({ el: ".range-page", initialize: function () { this.model = new n, this.inputView = new t({ el: this.$(".range-input"), model: this.model }), this.resultView = new i({ el: this.$(".range-result"), model: this.model }) } }) }), define("models/acceptanceCriteria", ["backbone", "helper"], function (t, n) { return t.Model.extend({ fetchDetailsFromCmsp: function (e) { var i = this; t.ajax({ type: "GET", url: n.getRESTfulDomain(_p("acceptance/criteria?srcCountryCode=%s&desCountryCode=%s&goodsName=%s&currentPage=%s&pageSize=%s", encodeURIComponent(e.srcCode), encodeURIComponent(e.desCode), encodeURIComponent(e.goodsName), e.currentPage, e.pageSize)), error: function (e, t) { 404 === t.status ? i.trigger("notFound") : i.trigger("networkError") }, success: function (e, t) { i.trigger("fetchSuccess", e) } }) }, fetchDetailsFromHHT: function (e) { var i = this; t.ajax({ type: "GET", url: n.getRESTfulDomain(_p("acceptance/chmtcriteria?country=%s&goodsName=%s&currentPage=%s&pageSize=%s", encodeURIComponent(e.country), encodeURIComponent(e.goodsName), e.currentPage, e.pageSize)), error: function (e, t) { 404 === t.status ? i.trigger("notFound") : i.trigger("networkError") }, success: function (e, t) { i.trigger("fetchSuccess", e) } }) }, fetchOrigins: function () { var i = this; t.ajax({ type: "GET", url: n.getRESTfulDomain("acceptance/srcCountry"), error: function (e, t) { 404 === t.status ? i.trigger("notFound") : i.trigger("networkError") }, success: function (e, t) { i.trigger("fetchSuccess", e) } }) }, fetchDests: function (e) { var i = this; t.ajax({ type: "GET", url: n.getRESTfulDomain(_p("acceptance/destCountry?country=%s", encodeURIComponent(e))), error: function (e, t) { 404 === t.status ? i.trigger("notFound") : i.trigger("networkError") }, success: function (e, t) { i.trigger("fetchSuccess", e) } }) } }) }), define("views/pages/acceptanceCriteria/index", ["backbone", "underscore", "bootstrap", "helper", "models/acceptanceCriteria", "templates"], function (e, a, t, i, n, r) { return e.View.extend({ events: { "click .origin-dest-selection .dropdown-menu a": "selectOriginDestSelection", "click .origin .dropdown-menu a": "selectOrigin", "click .dest .dropdown-menu a": "selectDest", "click .submit-query-mainland-hk-mc-tw": "queryAcceptanceCriteriaFromHHT", "keyup #good-name-for-mainland-hk-mc-tw": "updateButtonStatusForHHT", "keyup #good-name-for-others": "updateQueryButtonStatus", "click .submit-query": "queryDetails", "click .clear-query-mainland-hk-mc-tw": "clearInput", "click .clear-query": "clearInput", "click .rule-pagination-other .pagination a": "gotoOtherPage", "click .rule-pagination-hht .pagination a": "gotoHHTPage", "keypress input#good-name-for-mainland-hk-mc-tw": "keypressSearchHHT", "keypress input#good-name-for-others": "keypressSearchCMSP" }, initialize: function () { this.region = i.getSiteLocation(), this.pageSize = 10, "cn" === this.region || "hk" === this.region ? (this.originDestSelection = [{ name: _l("本地件"), code: "LOCAL" }, { name: _l("进出口件"), code: "IMPORT&EXPORT" }], this.selectionSelected = this.originDestSelection[0], this.$(".selection-mainland-hk-mc-tw").hide()) : "tw" === this.region ? (this.originDestSelection = [{ name: _l("台湾宅配件"), code: "LOCAL_TW" }, { name: _l("台湾跨境件"), code: "IMPORT&EXPORT_TW" }], this.selectionSelected = this.originDestSelection[0], this.$(".selection-mainland-hk-mc-tw").hide()) : (this.originDestSelection = [{ name: _l("中国内地互寄"), code: "CHINA_MAINLAND_DELIVERY" }, { name: _l("香港同城"), code: "HK_DELIVERY" }, { name: _l("澳门同城"), code: "MC_DELIVERY" }, { name: _l("台湾同城"), code: "TW_DELIVERY" }, { name: _l("进出口（含港/澳/台）"), code: "IMPORT&EXPORT_HMT" }], this.srcCountry = new n, this.destCountry = new n, this.hhtDetails = new n, this.otherDetails = new n, this.initsrcCountry = new n, this.listenTo(this.srcCountry, "fetchSuccess", this.renderSrcCountry), this.listenTo(this.destCountry, "fetchSuccess", this.renderDestCountry), this.listenTo(this.hhtDetails, "fetchSuccess", this.renderHHTResults), this.listenTo(this.otherDetails, "fetchSuccess", this.renderOtherResults), this.listenTo(this.initsrcCountry, "fetchSuccess", this.initRenderSrcCountry), this.initImportExport()), this.render() }, initImportExport: function () { this.selectionSelected = this.originDestSelection[this.originDestSelection.length - 1], this.initsrcCountry.fetchOrigins(), $(".selection-others").show(), $(".selection-mainland-hk-mc-tw").hide(), $(".mainland-hk-mc-tw").hide(), $(".other-other-tip").show(), this.$(".results .other-table").hide(), this.$(".results .hmt-table").hide(), this.$(".results .cn-table").hide(), this.$(".rule-pagination-hht").hide(), this.$(".rule-pagination-other").hide() }, initRenderSrcCountry: function (e) { this.$(".origin .dropdown-menu").html(r.dropdownAcceptSrcCountry({ dropdownItems: e })) }, selectOriginDestSelection: function (e) { var t = $(e.currentTarget); this.selectionSelected = { name: t.text(), code: t.data("code") }; var i = t.data("code"); "cn" !== this.region && "hk" !== this.region && "tw" !== this.region ? "IMPORT&EXPORT_HMT" === i ? (this.srcCountry.fetchOrigins(), $(".selection-mainland-hk-mc-tw").hide(), $(".mainland-hk-mc-tw").hide(), $(".selection-others").show(), $(".other-other-tip").show()) : ($(".selection-others").hide(), $(".other-other-tip").hide(), $(".selection-mainland-hk-mc-tw").show(), $(".mainland-hk-mc-tw").show()) : ($(".selection-mainland-hk-mc-tw").hide(), $(".selection-others").hide(), $(".results").hide(), "LOCAL" === i || "LOCAL_TW" === i ? ($(".other-other-tip").hide(), $(".mainland-hk-mc-tw").show()) : ($(".mainland-hk-mc-tw").hide(), $(".other-other-tip").show())), this.$(".results .other-table").hide(), this.$(".results .hmt-table").hide(), this.$(".results .cn-table").hide(), this.$(".rule-pagination-hht").hide(), this.$(".rule-pagination-other").hide(), this.render() }, selectOrigin: function (e) { var t = $(e.currentTarget); this.originSelected = { name: t.text(), code: t.data("code") }, this.$(".dest-tip").html(""), this.destSelected = null, this.render(), this.destCountry.fetchDests(this.originSelected.code) }, selectDest: function (e) { var t = $(e.currentTarget); this.destSelected = { name: t.text(), code: t.data("code"), tip: a.isBlank($.trim(t.data("tip"))) ? "" : _l("温馨提示：此流向寄件,") + t.data("tip") }, this.$(".dest-tip").html(this.destSelected.tip), this.render() }, updateButtonStatusForHHT: function (e) { var t = $(e.currentTarget); a.isEmpty(t.val()) ? this.$(".submit-query-mainland-hk-mc-tw").toggleClass("disabled", !0) : this.$(".submit-query-mainland-hk-mc-tw").toggleClass("disabled", !1) }, updateQueryButtonStatus: function () { var e = $.trim(this.$("#good-name-for-others").val()), t = this.originSelected && this.destSelected && !a.isEmpty(e); this.$(".submit-query").toggleClass("disabled", !t) }, renderDropdowns: function () { this.$(".origin-dest-selection .dropdown-menu").html(r.dropdownRuleTemplates({ dropdownItems: this.originDestSelection })) }, renderDropdownTitle: function () { var e = this.$(".origin-dest-selection .dropdown-toggle .selected-dropdown"), t = this.selectionSelected ? this.selectionSelected.name : e.data("origin-text"); if (e.text(t), "cn" !== this.region && "hk" !== this.region && "tw" !== this.region) { var i = this.$(".origin .dropdown-toggle .selected-dropdown"), n = this.originSelected ? this.originSelected.name : i.data("origin-text"); i.text(n); var a = this.$(".dest .dropdown-toggle .selected-dropdown"), s = this.destSelected ? this.destSelected.name : a.data("origin-text"); a.text(s); var r = this.$(".recieve-type .dropdown-toggle .selected-dropdown"), o = this.recieveTypeSelected ? this.recieveTypeSelected.name : r.data("origin-text"); r.text(o) } }, renderSrcCountry: function (e) { var t = this.selectionSelected; t && "IMPORT&EXPORT_HMT" === t.code && this.$(".origin .dropdown-menu").html(r.dropdownAcceptSrcCountry({ dropdownItems: e })) }, renderDestCountry: function (e) { this.originSelected ? (this.$(".dest .dropdown-menu").removeClass("hidden"), this.$(".dest .dropdown-menu").html(r.dropdownAcceptDestCountry({ dropdownItems: e }))) : this.$(".dest .dropdown-menu").addClass("hidden") }, renderResults: function () { this.$(".results"), this.$(".results .src-table tbody") }, renderHHTResults: function (e) { var t = this.$(".results"), i = this.$(".results .cn-table tbody"), n = this.$(".results .hmt-table tbody"); e.acceptCriterias && !a.isEmpty(e.acceptCriterias) ? (this.currentSrcGoods = e.acceptCriterias, -1 == e.code ? (i.empty().html(r.acceptCriteriaResultCN({ results: this.currentSrcGoods, pageIndex: window.pageIndex || 1, pageSize: this.pageSize })), this.$(".results .cn-table").show(), this.$(".results .hmt-table").hide(), this.$(".results .other-table").hide()) : -2 == e.code && (n.empty().html(r.acceptCriteriaResultHMT({ results: this.currentSrcGoods, pageIndex: window.pageIndex || 1, pageSize: this.pageSize })), this.$(".results .cn-table").hide(), this.$(".results .hmt-table").show(), this.$(".results .other-table").hide()), this.printPageNavLinkList(".rule-pagination-hht", e.page.totalPage), this.$(".rule-pagination-hht").show(), t.slideDown()) : (i.empty(), n.empty(), t.slideUp(), this.$(".results .cn-table").hide(), this.$(".results .hmt-table").hide(), this.$(".results .other-table").hide(), this.$(".rule-pagination-hht").hide(), alert(_l("未搜索到的物品以收派员上门核实为准"))) }, renderOtherResults: function (e) { var t = this.$(".results"), i = this.$(".results .other-table tbody"); 0 == e.code ? e.acceptCriterias && !a.isEmpty(e.acceptCriterias) ? (this.currentSrcGoods = e.acceptCriterias, i.empty().html(r.acceptCriteriaOther({ results: this.currentSrcGoods, pageIndex: window.pageIndex || 1, pageSize: this.pageSize })), this.printPageNavLinkList(".rule-pagination-other", e.page.totalPage), this.$(".results .other-table").show(), this.$(".results .cn-table").hide(), this.$(".results .hmt-table").hide(), this.$(".rule-pagination-other").show(), t.slideDown()) : (i.empty(), t.slideUp(), alert(_l("未搜索到的物品以收派员上门核实为准"))) : (t.slideDown(), this.$(".results .other-table").hide(), this.$(".results .cn-table").hide(), this.$(".results .hmt-table").hide(), this.$(".rule-pagination-other").hide(), i.empty(), alert(_l("未搜索到的物品以收派员上门核实为准"))) }, render: function () { this.renderDropdownTitle(), this.renderDropdowns(), "cn" !== this.region && "hk" !== this.region && "tw" !== this.region && this.updateQueryButtonStatus() }, gotoOtherPage: function (e) { var t = $(e.currentTarget); e.stopPropagation(); var i = t.attr("data-pageindex"); window.pageIndex = Number(i); var n = { srcCode: this.originSelected.code, desCode: this.destSelected.code, goodsName: $.trim(this.$("#good-name-for-others").val()), currentPage: i, pageSize: this.pageSize }; this.otherDetails.fetchDetailsFromCmsp(n) }, gotoHHTPage: function (e) { var t = $(e.currentTarget); e.stopPropagation(); var i = t.attr("data-pageindex"); window.pageIndex = Number(i); var n = { goodsName: $.trim(this.$("#good-name-for-mainland-hk-mc-tw").val()), currentPage: i, country: null == this.selectionSelected ? "1" : this.selectionSelected.code, pageSize: this.pageSize }; this.hhtDetails.fetchDetailsFromHHT(n) }, showsSrcTaxDetails: function (e) { var t = $(e.currentTarget); e.stopPropagation(); var i = t.attr("item-index"), n = Number(i), a = this.currentSrcGoods[n].taxs, s = r.tooltipsTable({ taxs: a }); t.attr("title", s), $(".tooltip").remove(), t.tooltip("toggle"), $(".tooltip").css({ top: "30px", "z-index": "1000", background: "#D0CECE", position: "absolute" }), $(".tooltip table").css({ background: "#D0CECE", width: "300px", "text-align": "center" }), t.attr("title", "") }, keypressSearchHHT: function (e) { 13 == e.keyCode && this.queryAcceptanceCriteriaFromHHT() }, keypressSearchCMSP: function (e) { 13 == e.keyCode && this.queryDetails() }, queryAcceptanceCriteriaFromHHT: function () { var e = this, t = { goodsName: $.trim(e.$("#good-name-for-mainland-hk-mc-tw").val()), currentPage: 1, country: null == e.selectionSelected ? "1" : e.selectionSelected.code, pageSize: e.pageSize }; e.checkInput(t) && (window.pageIndex = 1, e.$(".error").hide(), e.$(".results").slideUp(function () { e.hhtDetails.fetchDetailsFromHHT(t) })) }, queryDetails: function () { var e = this; if (a.isEmpty(e.originSelected)) alert(_l("请选择始发国家")); else if (a.isEmpty(e.destSelected)) alert(_l("请选择目的国家")); else { var t = { srcCode: e.originSelected.code, desCode: e.destSelected.code, goodsName: $.trim(e.$("#good-name-for-others").val()), currentPage: 1, pageSize: e.pageSize }; e.checkInput(t) && (window.pageIndex = 1, e.$(".error").hide(), e.$(".results").slideUp(function () { e.otherDetails.fetchDetailsFromCmsp(t) })) } }, checkInput: function (e) { return !("" === e.goodName || "" != e.goodName && 50 < i.parseChineseChar(e.goodName).length) || (this.$(".error[data-error=input-invalid]").text(_l("请输入必填项")).show(), this.$("input[name=goodName]").focus(), !1) }, clearInput: function () { this.$("input[type=text]").val(""), this.$(".submit-query-mainland-hk-mc-tw").toggleClass("disabled", !0) }, resetQueryButton: function () { this.$(".submit-query").button("reset") }, showNotFoundError: function () { this.$(".error[data-error=not-found]").show(), this.resetQueryButton() }, showNetworkError: function () { this.$(".error[data-error=network]").show(), this.resetQueryButton() }, paginationNews: function () { this.show(this.newsOfPage(1)), 1 < this.pageCount() && this.printPageNavLinkList() }, printPageNavLinkList: function (e, t) { var i = window.pageIndex || 1; $(e).html(r.pagination({ pageIndex: i, pageCount: t })) }, pageCount: function () { var e = window.news.size(), t = window.newsPageSize; return e % t == 0 ? e / t : Math.floor(e / t) + 1 } }) }), define("collections/rules", ["backbone", "helper"], function (e, i) { return e.Collection.extend({ fetchURL: function (e, t) { t = t || {}, this.url = i.getRESTfulDomain(e), this.reset().fetch(t) }, fetchOrigins: function () { this.fetchURL("regulation/origins") }, fetchDests: function (e) { this.fetchURL(_p("regulation/dests?originCode=%s", encodeURIComponent(e))) }, fetchItems: function (e, t) { this.fetchURL(_p("regulation/items?originCode=%s&destCode=%s", encodeURIComponent(e), encodeURIComponent(t))) }, fetchDetails: function (e, t, i) { var n = this; this.fetchURL(_p("regular/tax?code=%s&flag=%s&descType=%s&goodCode=%s&goodName=%s&weight=%s&goodValue=%s&currentPage=%s&pageSize=%s", encodeURIComponent(e), encodeURIComponent(t), encodeURIComponent(i.descType), encodeURIComponent(i.goodCode), encodeURIComponent(i.goodName), i.weight, encodeURIComponent(i.goodValue), i.currentPage, i.pageSize), { error: function (e, t) { 404 === t.status ? n.trigger("notFound") : n.trigger("networkError") } }) } }) }), define("models/rules", ["backbone", "helper"], function (a, s) { return a.Model.extend({ fetchDetails: function (e, t, i) { var n = this; a.ajax({ type: "GET", url: s.getRESTfulDomain(_p("regular/tax?code=%s&flag=%s&descType=%s&goodCode=%s&goodName=%s&weight=%s&goodValue=%s&currentPage=%s&pageSize=%s", encodeURIComponent(e), encodeURIComponent(t), encodeURIComponent(i.descType), encodeURIComponent(i.goodCode), encodeURIComponent(i.goodName), i.weight, encodeURIComponent(i.goodValue), i.currentPage, i.pageSize)), error: function (e, t) { 404 === t.status ? n.trigger("notFound") : n.trigger("networkError") }, success: function (e, t) { n.trigger("fetchSuccess", e) } }) } }) }), define("views/pages/importExportRule/index", ["backbone", "underscore", "bootstrap", "helper", "collections/rules", "models/rules", "templates"], function (e, n, t, a, i, s, r) { return e.View.extend({ events: { "click .origin .dropdown-menu a": "selectOrigin", "click .dest .dropdown-menu a": "selectDest", "click .recieve-type .dropdown-menu a": "selectRecieveType", "click .submit-query": "queryDetails", "click .clear-query": "clearInput", "click .rule-pagination-src .pagination a": "gotoSrcPage", "click .rule-pagination-dest .pagination a": "gotoDestPage", "click .src-table td a.tax-details": "showsSrcTaxDetails", "click .dest-table td a.tax-details": "showsDestTaxDetails", "click td a.tax-images": "showsTaxImages" }, initialize: function () { this.pageSize = 10, this.origins = [{ code: "CN", name: _l("中国大陆") }, { code: "TW", name: _l("中国台湾") }, { code: "HK", name: _l("中国香港") }, { code: "MO", name: _l("中国澳门") }, { code: "IN", name: _l("印度") }, { code: "KH", name: _l("柬埔寨") }, { code: "AU", name: _l("澳大利亚") }, { code: "SG", name: _l("新加坡") }, { code: "MY", name: _l("马来西亚") }, { code: "TH", name: _l("泰国") }, { code: "VN", name: _l("越南") }, { code: "JP", name: _l("日本") }, { code: "US", name: _l("美国") }, { code: "KR", name: _l("韩国") }, { code: "RU", name: _l("俄罗斯") }, { code: "MN", name: _l("蒙古国") }, { code: "ID", name: _l("印度尼西亚") }], this.srcDetails = new s, this.destDetails = new s, this.listenTo(this.srcDetails, "fetchSuccess", this.renderSrcResults), this.listenTo(this.srcDetails, "notFound", this.showNotFoundError), this.listenTo(this.srcDetails, "networkError", this.showNetworkError), this.listenTo(this.destDetails, "fetchSuccess", this.renderDestResults), this.listenTo(this.destDetails, "notFound", this.showNotFoundError), this.render(), $("[data-toggle='tooltip']").tooltip({ html: !0 }) }, selectOrigin: function (e) { var t = $(e.currentTarget); this.originSelected = { name: t.text(), code: t.data("code") }, this.render() }, selectDest: function (e) { var t = $(e.currentTarget); this.destSelected = { name: t.text(), code: t.data("code") }, this.render() }, selectRecieveType: function (e) { var t = $(e.currentTarget); this.recieveTypeSelected = { name: t.text(), code: t.data("code") }, this.render() }, renderDropdowns: function () { this.$(".origin .dropdown-menu").html(r.dropdownRuleTemplates({ dropdownItems: n.sortBy(this.origins) })), this.$(".dest .dropdown-menu").removeClass("hidden"), this.$(".dest .dropdown-menu").html(r.dropdownRuleTemplates({ dropdownItems: n.sortBy(this.origins) })) }, renderDropdownTitle: function () { var e = this.$(".origin .dropdown-toggle .selected-dropdown"), t = this.originSelected ? this.originSelected.name : e.data("origin-text"); e.text(t); var i = this.$(".dest .dropdown-toggle .selected-dropdown"), n = this.destSelected ? this.destSelected.name : i.data("origin-text"); i.text(n); var a = this.$(".recieve-type .dropdown-toggle .selected-dropdown"), s = this.recieveTypeSelected ? this.recieveTypeSelected.name : a.data("origin-text"); a.text(s) }, updateQueryButtonStatus: function () { var e = this.originSelected && this.destSelected && this.recieveTypeSelected; this.$(".submit-query").toggleClass("disabled", !e) }, renderResults: function () { this.$(".results"), this.$(".results .src-table tbody"), this.$(".results .dest-table tbody") }, renderSrcResults: function (e) { var t = this.$(".results"), i = this.$(".results .src-table tbody"); 0 == e.code ? e.goods && !n.isEmpty(e.goods) ? (this.currentSrcGoods = e.goods, i.empty().html(r.importExportRuleResult({ results: e.goods, pageIndex: window.pageIndex || 1, pageSize: this.pageSize })), this.printPageNavLinkList(".rule-pagination-src", e.page.totalPage), this.$(".results .src-table").show(), this.$(".rule-pagination-src").show(), t.slideDown()) : (i.empty(), t.slideUp()) : (t.slideDown(), this.$(".results .src-table").show(), this.$(".rule-pagination-src").hide(), i.empty()) }, renderDestResults: function (e) { var t = this.$(".results"), i = this.$(".results .dest-table tbody"); 0 == e.code ? e.goods && !n.isEmpty(e.goods) ? (this.currentDestGoods = e.goods, i.empty().html(r.importExportRuleResult({ results: e.goods, pageIndex: window.pageIndex || 1, pageSize: this.pageSize })), this.printPageNavLinkList(".rule-pagination-dest", e.page.totalPage), this.$(".results .dest-table").show(), this.$(".rule-pagination-dest").show(), t.slideDown()) : (i.empty(), t.slideUp()) : (t.slideDown(), this.$(".results .dest-table").show(), this.$(".rule-pagination-dest").hide(), i.empty()) }, render: function () { this.renderDropdownTitle(), this.renderDropdowns(), this.updateQueryButtonStatus() }, gotoSrcPage: function (e) { var t = $(e.currentTarget); e.stopPropagation(); var i = t.attr("data-pageindex"); window.pageIndex = Number(i); var n = { descType: this.recieveTypeSelected.code, goodCode: $.trim(this.$("input[name=goodCode]").val()), goodName: $.trim(this.$("input[name=goodName]").val()), weight: $.trim(this.$("input[name=weight]").val()), goodValue: $.trim(this.$("input[name=goodValue]").val()), currentPage: i, pageSize: this.pageSize }; this.srcDetails.fetchDetails(this.originSelected.code, "E", n) }, gotoDestPage: function (e) { var t = $(e.currentTarget); e.stopPropagation(); var i = t.attr("data-pageindex"); window.pageIndex = Number(i); var n = { descType: this.recieveTypeSelected.code, goodCode: $.trim(this.$("input[name=goodCode]").val()), goodName: $.trim(this.$("input[name=goodName]").val()), weight: $.trim(this.$("input[name=weight]").val()), goodValue: $.trim(this.$("input[name=goodValue]").val()), currentPage: i, pageSize: this.pageSize }; this.destDetails.fetchDetails(this.destSelected.code, "I", n) }, showsSrcTaxDetails: function (e) { var t = $(e.currentTarget); e.stopPropagation(); var i = t.attr("item-index"), n = Number(i), a = this.currentSrcGoods[n].taxs, s = r.tooltipsTable({ taxs: a }); t.attr("title", s), $(".tooltip").remove(), t.tooltip("toggle"), $(".tooltip").css({ top: "30px", "z-index": "1000", background: "#D0CECE", position: "absolute" }), $(".tooltip table").css({ background: "#D0CECE", width: "300px", "text-align": "center" }), t.attr("title", "") }, showsDestTaxDetails: function (e) { var t = $(e.currentTarget); e.stopPropagation(); var i = t.attr("item-index"), n = Number(i), a = this.currentDestGoods[n].taxs, s = r.tooltipsTable({ taxs: a }); t.attr("title", s), $(".tooltip").remove(), t.tooltip("toggle"), $(".tooltip").css({ top: "30px", "z-index": "1000", background: "#D0CECE", position: "absolute" }), $(".tooltip table").css({ background: "#D0CECE", width: "300px", "text-align": "center" }), t.attr("title", "") }, showsTaxImages: function (e) { var t = $(e.currentTarget); e.stopPropagation(); var i = t.attr("image-src"), n = a.getImportAndExportPicture() + i; window.open(n) }, queryDetails: function () { var e = this, t = { descType: e.recieveTypeSelected.code, goodCode: $.trim(e.$("input[name=goodCode]").val()), goodName: $.trim(e.$("input[name=goodName]").val()), weight: $.trim(e.$("input[name=weight]").val()), goodValue: $.trim(e.$("input[name=goodValue]").val()), currentPage: 1, pageSize: e.pageSize }; e.checkInput(t) && (this.$(".error").hide(), this.$(".results").slideUp(function () { e.srcDetails.fetchDetails(e.originSelected.code, "E", t), e.destDetails.fetchDetails(e.destSelected.code, "I", t) })) }, checkInput: function (e) { return "" == e.goodValue || 50 < a.parseChineseChar(e.goodValue).length ? (this.$(".error[data-error=input-invalid]").text(_l("请输入必填项")).show(), this.$("input[name=goodValue]").focus(), !1) : "" == e.weight || 50 < a.parseChineseChar(e.weight).length ? (this.$(".error[data-error=input-invalid]").text(_l("请输入必填项")).show(), this.$("input[name=weight]").focus(), !1) : "" != e.goodName && 50 < a.parseChineseChar(e.goodName).length ? (this.$(".error[data-error=input-invalid]").show(), this.$("input[name=goodName]").focus(), !1) : "" != e.goodCode && 50 < a.parseChineseChar(e.goodCode).length ? (this.$(".error[data-error=input-invalid]").show(), this.$("input[name=goodCode]").focus(), !1) : "" != e.goodCode || "" != e.goodName || (this.$(".error[data-error=input-invalid]").text(_l("品名与商品代码至少输入一项")).show(), this.$("input[name=goodCode]").focus(), !1) }, clearInput: function () { this.$("input[type=text]").val("") }, resetQueryButton: function () { this.$(".submit-query").button("reset") }, showNotFoundError: function () { this.$(".error[data-error=not-found]").show(), this.resetQueryButton() }, showNetworkError: function () { this.$(".error[data-error=network]").show(), this.resetQueryButton() }, paginationNews: function () { this.show(this.newsOfPage(1)), 1 < this.pageCount() && this.printPageNavLinkList() }, printPageNavLinkList: function (e, t) { var i = window.pageIndex || 1; $(e).html(r.pagination({ pageIndex: i, pageCount: t })) }, pageCount: function () { var e = window.news.size(), t = window.newsPageSize; return e % t == 0 ? e / t : Math.floor(e / t) + 1 } }) }), function (c, e) { "use strict"; c.ajaxPrefilter(function (e, t, i) { if (e.iframe) return "iframe" }), c.ajaxTransport("iframe", function (e, t, i) { var n = null, a = null, s = "iframe-" + c.now(), r = c(e.files).filter(":file:enabled"), o = null; function l() { o.replaceWith(function (e) { return r.get(e) }), n.remove(), a.attr("src", "javascript:false;").remove() } if (e.dataTypes.shift(), r.length) return n = c("<form enctype='multipart/form-data' method='post'></form>").hide().attr({ action: e.url, target: s }), "string" == typeof e.data && 0 < e.data.length && c.error("data must not be serialized"), c.each(e.data || {}, function (e, t) { c.isPlainObject(t) && (e = t.name, t = t.value), c("<input type='hidden'>").attr({ name: e, value: t }).appendTo(n) }), c("<input type='hidden' value='IFrame' name='X-Requested-With'>").appendTo(n), o = r.after(function (e) { return c(this).clone().prop("disabled", !0) }).next(), r.appendTo(n), { send: function (e, o) { (a = c("<iframe src='javascript:false;' name='" + s + "' style='display:none'></iframe>")).on("load", function () { a.off("load").on("load", function () { var e, t = this.contentWindow ? this.contentWindow.document : this.contentDocument ? this.contentDocument : this.document, i = t.documentElement ? t.documentElement : t.body, n = i.getElementsByTagName("textarea")[0], a = n ? n.getAttribute("data-type") : null, s = { html: i.innerHTML, text: a ? n.value : i ? i.textContent || i.innerText : null }, r = 200; l(); try { r = (e = JSON.parse(s.text)).error || 200, delete e.error, s.text = JSON.stringify(e) } catch (e) { } o(r, 200 == r ? "success" : "error", s, a ? "Content-Type: " + a : null) }), n[0].submit() }), c("body").append(n, a) }, abort: function () { null !== a && (a.off("load").attr("src", "javascript:false;"), l()) } } }) }(jQuery), define("jquery.iframe-transport", function () { }), define("models/clearance", ["backbone", "jquery", "helper", "jquery.iframe-transport"], function (t, e, i) { return t.Model.extend({ uploadClearance: function (e) { var n = this; t.ajax({ type: " POST", dataType: "json", data: e.data, files: e.files, iframe: !0, processData: !1, url: i.getRESTfulDomain("clearance/upload"), error: function (e, t, i) { n.trigger("clearance-failed", e.responseText) }, success: function (e, t, i) { n.trigger("clearance-success", e, i.responseText) } }) }, uploadClearanceqingguan: function (e) { var n = this; t.ajax({ type: " POST", dataType: "json", contentType: "application/x-www-form-urlencoded; charset=utf-8", data: { cardType: e.cardType, imageType: e.imageType, bno: e.bno }, files: e.files, iframe: !0, processData: !1, url: i.getRESTfulDomain("clearance/clearanceImageUpload"), error: function (e, t, i) { n.trigger("clearance-failed", e.responseText) }, success: function (e, t, i) { n.trigger("clearanceqingguan-success", e, i.responseText) } }) } }) }), define("views/pages/clearance/index", ["templates", "backbone", "models/clearance", "helper", "utils/checkUtils"], function (e, t, i, n, a) { return t.View.extend({ $el: $(".clearance-page"), initialize: function () { this.model = new i, this.$imgBackWrapper = this.$("#imgBackWrapper"), this.$billNumber = this.$("#bno"), this.$cardType = this.$("#cardType"), this.$submitButton = this.$("#submitButton"), this.$imgBackWrapper = this.$("#imgBackWrapper"), this.$idcardFront = this.$("#idcardFront"), this.$idcardBack = this.$("#idcardBack"), this.$errorWrapper = this.$(".form-group.error"), this.errCodes = [], this.listenTo(this.model, "clearance-failed", this.clearanceFail), this.listenTo(this.model, "clearance-success", this.clearanceSuccess), this.listenTo(this.model, "clearanceqingguan-success", this.clearanceqingguanSuccess), this.check = !0 }, events: { "click #btutypeqingguan .label-button": "changeTypeqingguan", "click #btntype .label-button": "changeType", "change #bno": "checkAll", "change #idcardFront": "checkAll", "change #idcardBack": "checkAll", "change #clearanceImage": "checkAll", "click #submitButton": "submitButtonImage", "click .require-policy input.policy": "agreePrivacy" }, changeTypeqingguan: function (e) { $("#btntype .label-button").removeClass("selected"), $("#file-pathF").attr("placeholder", _l("上传图片")), e.stopPropagation(); var t = $(e.target); t.attr("btn-type"); t.addClass("selected").siblings().removeClass("selected"), this.$cardType.val(t.attr("btn-value")), this.$imgBackWrapper.find("input").val(""), this.$imgBackWrapper.hide(), this.checkAll() }, changeType: function (e) { $("#btutypeqingguan .label-button").removeClass("selected"), $("#file-pathF").attr("placeholder", _l("上传证件正面图片")), e.stopPropagation(); var t = $(e.target), i = t.attr("btn-type"); t.addClass("selected").siblings().removeClass("selected"), this.$cardType.val(t.attr("btn-value")), "passport" == i || "others" == i ? (this.$imgBackWrapper.find("input").val(""), this.$imgBackWrapper.hide()) : this.$imgBackWrapper.show(), this.checkAll() }, submitButtonImage: function (e) { var t = $(".label-button.selected").attr("btn-type"); "passport" == t || "others" == t || "identity" == t ? this.uploadClearance() : this.uploadClearanceqingguan() }, checkAll: function () { this.check = !0, this.errCodes = [], this.checkBillNumber(), this.checkImg(), "cn" != n.getSiteLocation() && this.checkPrivacyPolicy(), this.renderMsg(this.errCodes), this.check ? this.$submitButton.removeAttr("disabled") : this.$submitButton.attr("disabled", "disabled") }, checkBillNumber: function () { var e = this.$billNumber.val().toUpperCase(); "" == e || null == e ? (this.errCodes.push("4"), this.check = !1) : a.billNumber(e) || (this.errCodes.push("7"), this.check = !1) }, checkImg: function () { var e = /.*(jpg|JPG|jpeg|JPEG|gif|GIF|png|PNG)$/; "1" === this.$cardType.val() ? "" == this.$idcardFront.val() || null == this.$idcardFront.val() || "" == this.$idcardBack.val() || null == this.$idcardBack.val() ? (this.check = !1, this.errCodes.push("2")) : e.test(this.$idcardFront.val()) && e.test(this.$idcardBack.val()) || (this.check = !1, this.errCodes.push("21")) : "" == this.$idcardFront.val() || null == this.$idcardFront.val() ? (this.check = !1, this.errCodes.push("2")) : e.test(this.$idcardFront.val()) || (this.check = !1, this.errCodes.push("21")) }, renderMsg: function (e) { var n = this.$errorWrapper; this.clearHint(), this.$errorWrapper.show(), _.each(e, function (e, t, i) { n.find("#err-" + e).css("display", "block") }) }, uploadClearanceqingguan: function () { if (this.checkAll(), 0 === this.errCodes.length) { var e = $(".label-button.selected").attr("btn-type"), t = $(".label-button.selected").attr("btn-value"), i = this.$billNumber.val().toUpperCase(); $('input[name="idcardFront"]').attr("name", "clearanceImage"), $('input[id="idcardFront"]').attr("id", "clearanceImage"), this.model.uploadClearanceqingguan({ files: this.$("form :file"), cardType: e, imageType: t, bno: i }) } }, uploadClearance: function () { if ($('input[name="clearanceImage"]').attr("name", "idcardFront"), $('input[id="clearanceImage"]').attr("id", "idcardFront"), this.checkAll(), 0 === this.errCodes.length) { var t = {}; _.each(this.$('form :input[type="text"]').add('form :input[type="hidden"]'), function (e) { t[e.name] = e.value }), t.bno = t.bno.toUpperCase(), this.model.uploadClearance({ files: this.$("form :file"), data: t }) } }, clearHint: function () { this.$errorWrapper.hide().find("b").hide() }, clearanceFail: function (e) { this.renderMsg([9]) }, clearanceqingguanSuccess: function (e) { this.renderMsg([e[0].code]), 500 === e[0].code && this.renderMsg([9]), 100 === e[0].code && this.renderMsg([0]), 100 == e[0].code && ($(".form-horizontal")[0].reset(), this.$submitButton.attr("disabled", "disabled")) }, clearanceSuccess: function (e) { this.renderMsg([e.code]), 500 === e.code && this.renderMsg([9]), 0 == e.code && ($(".form-horizontal")[0].reset(), this.$submitButton.attr("disabled", "disabled")) }, agreePrivacy: function (e) { $(e.currentTarget).attr("checked") ? ($(".require-policy .error-prompt").hide(), this.checkAll()) : ($(".require-policy .error-prompt").show(), this.$submitButton.attr("disabled", "disabled")) }, checkPrivacyPolicy: function () { $("#policy").attr("checked") ? $(".require-policy .checkbox").removeClass("s-prompt") : ($(".require-policy .error-prompt").show(), $(".require-policy .checkbox").addClass("s-prompt"), this.check = !1, this.errCodes.push("201")) } }) }), define("views/pages/clearanceImageUpload/confirmInfo", ["baseView", "templates"], function (e, t) { return e.extend({ layerOpts: { title: _l("确认证件信息"), area: "480px", skin: "line" }, template: t.ocrConfirmInfo, render: function () { this.$el.html(this.template({ name: this.options.ocrName, id: this.options.ocrId, date: this.options.ocrDate })) }, events: { "click .cancel": "cancel", "click .confirm": "confirm" }, cancel: function () { this.close() }, confirm: function () { this.options.confirmCallback(), this.close() } }) }), define("views/pages/clearanceImageUpload/config", [], function () { return { picture: { clearanceType: "1", name: "证照单证", type: { idCard: { name: "身份证", cardType: "identity", imageType: "1", upload: { front: { name: "身份证个人面", icon: "id-card-front" }, back: { name: "身份证国徽面", icon: "id-card-back" } } }, passport: { name: "护照", cardType: "passport", imageType: "2", upload: { front: { name: "护照-证件封面", icon: "passport-front" }, back: { name: "护照-个人信息页", icon: "passport-back" } } }, otherPicture: { name: "其他证件", cardType: "others", imageType: "3", upload: { front: { name: "其他证件-证件封面", icon: "others-front" }, back: { name: "其他证件-个人信息页", icon: "others-back" } } } } }, document: { name: "清关单证", clearanceType: "2", type: { invoice: { name: "发票", cardType: "-1", imageType: "6", upload: { front: { name: "上传图片", icon: "others-front" } } }, packingList: { name: "装箱单", cardType: "-1", imageType: "7", upload: { front: { name: "上传图片", icon: "others-front" } } }, attorney: { name: "代理报关委托书", cardType: "-1", imageType: "8", upload: { front: { name: "上传图片", icon: "others-front" } } }, contract: { name: "合同", cardType: "-1", imageType: "9", upload: { front: { name: "上传图片", icon: "others-front" }, back: { name: "上传图片", icon: "others-back" } } }, otherDocument: { name: "其他报关资料", cardType: "-1", imageType: "0", upload: { front: { name: "上传图片", icon: "others-front" } } } } } } }), define("views/pages/clearanceImageUpload/index", ["baseView", "./confirmInfo", "templates", "./config", "sf-validate", "verify", "helper", "sflayer"], function (e, r, t, n, i, a, s) { var o = [{ index: 2, msg: "图片不能为空" }, { index: 3, msg: "图片大小应小于150k" }, { index: 4, msg: "运单号不能为空" }, { index: 6, msg: "身份证校验不通过" }, { index: 7, msg: "运单号不正确" }, { index: 9, msg: "服务暂不可用，请稍后再试" }, { index: 13, msg: "图片超过300k" }, { index: 21, msg: "证件格式不正确" }]; return e.extend({ template: t.clearanceImgUpload, init: function () { this.clearanceType = "1", this.preTarget = "#idCard", this.aftTarget = "#invoice" }, render: function () { this.$el.html(this.template({ data: n })).css({ "min-height": "auto" }), this.addWaybillValidate() }, events: { "submit .waybill-no": "submitWaybillNo", "click .tab-head a": "changeClearanceType", "click .sf-capsule a": "changeCredentials", 'change [type="file"]': "checkFileExtention", "click .delete": "cancelUpload", "click .submit": "submitUpload", "click .term-toggle": "termToggle", "click .show-term": "showTerm" }, addWaybillValidate: function () { i(this.$(".waybill-no"), { rules: { waybillNo: { required: !0, regex: "isWaybillNo" } }, messages: { waybillNo: { regex: _l("运单号格式不正确，请重新输入") } } }) }, submitWaybillNo: function (e) { e.preventDefault(), this.$(".waybill-no").validate().form() }, changeClearanceType: function (e) { e.preventDefault(); var t = this.$(e.currentTarget); t.addClass("active").siblings().removeClass("active"), this.$(t.attr("href")).addClass("active").siblings().removeClass("active"), this.clearanceType = t.data("clearance-type"), this.toggleWarmTips() }, changeCredentials: function (e) { e.preventDefault(); var t = this.$(e.currentTarget); t.parents(".sf-capsule").find("a").removeClass("active"), t.addClass("active"), this.$(t.attr("href")).addClass("active").siblings().removeClass("active"), "1" == this.clearanceType ? this.preTarget = t.attr("href") : this.aftTarget = t.attr("href"), this.toggleWarmTips() }, getTarget: function () { return "1" == this.clearanceType ? this.preTarget : this.aftTarget }, checkFileExtention: function (e) { var t = this.$(e.currentTarget), i = t.val(); "" !== i && ("#idCard" === this.getTarget() ? a.isRegularExtension(["jpg", "png", "jpeg"], i) ? this.checkFileSize(t) : (layer.alert(_l("图片格式不正确，仅支持jpg或png格式的图片,请重新上传")), t.val("")) : a.isRegularExtension(["jpg", "png", "jpeg", "gif"], i) ? this.checkFileSize(t) : (layer.alert(_l("图片格式不正确，仅支持jpg、png、jepg或gif格式的图片,请重新上传")), t.val(""))) }, checkFileSize: function (e) { 1048576 < e[0].files[0].size ? (layer.alert(_l("图片大小不能超过1MB，请重新上传")), e.val("")) : this.uploadPic(e) }, uploadPic: function (e) { "#idCard" === this.getTarget() ? this.idCardUpload(e) : (e.hide(), e.siblings(".upload").addClass("succeed"), this.getTypeByTarget()[e.parents(".file-input-wrapper").data("surface")] = !0, this.toggleSubmitBtn()) }, cancelUpload: function (e) { var i = this.$(e.currentTarget), n = this; layer.confirm(_l("确定取消上传该图片吗？"), { btn: [_l("确定"), _l("取消")] }, function (e) { layer.close(e); var t = i.parents(".file-input-wrapper").data("surface"); i.parents(".upload").removeClass("succeed").siblings("input").val("").show(), n.getTypeByTarget()[t] = !1, n.toggleSubmitBtn(), "#idCard" === n.getTarget() && ("front" === t ? (n.$("#ocr-id").val(""), n.$("#ocr-name").val(""), n.$(".id-card-form .fl").hide()) : (n.$("#ocr-start-date").val(""), n.$("#ocr-end-date").val(""), n.$(".id-card-form .fr").hide())) }, function (e) { layer.close(e) }) }, getTypeByTarget: function () { var i = this, e = _.find(n, function (e) { return e.clearanceType == i.clearanceType }); return _.find(e.type, function (e, t) { return "#" + t === i.getTarget() }) }, toggleSubmitBtn: function () { var e = this.getTypeByTarget(), t = this.$(this.getTarget()).find(".submit-wrapper"); 1 === _.size(e.upload) ? e.front ? t.show() : t.hide() : e.front && e.back ? t.show() : t.hide(), this.toggleWarmTips() }, toggleWarmTips: function () { this.$(this.getTarget()).find(".submit-wrapper").is(":visible") ? this.$(".tips").hide() : this.$(".tips").show() }, submitUpload: function () { if (this.$(".waybill-no").validate().form()) { var i = this; if ("1" == this.clearanceType) if (this.ocrId = "", this.ocrName = "", "#idCard" === this.getTarget()) { if (!this.$(".term-toggle").hasClass("aicon-check")) return void layer.alert(_l("请先阅读并同意") + "《" + _l("消费者实名备案协议条款") + "》", function () { i.showTerm() }); this.ocrId = this.$("#ocr-id").val(), this.ocrName = this.$("#ocr-name").val(), new r({ ocrName: this.ocrName, ocrId: this.ocrId, ocrDate: this.$("#ocr-start-date").val() + "-" + this.$("#ocr-end-date").val(), confirmCallback: this.uploadClearancePic.bind(this) }) } else this.uploadClearancePic(); else { var e = this.$(".waybill-no").find("input").val().toUpperCase(), t = this.getTypeByTarget().cardType, n = this.getTypeByTarget().imageType, a = new FormData; _.each(this.$(this.getTarget()).find(":file"), function (e) { a.append($(e).attr("name"), e.files[0]) }), a.append("bno", e), a.append("cardType", t), a.append("imageType", n); var s = layer.load(); sfAjax.uploadClearanceDoc({ dataType: "json", data: a, contentType: !1, cache: !1, processData: !1, error: function () { i.showErrMsg(9) }, success: function (e) { var t = e[0]; 500 == t.code ? i.showErrMsg(9) : 100 == t.code ? i.showSuccess() : i.showErrMsg(t.code) }, complete: function () { layer.close(s) } }) } } }, uploadClearancePic: function () { var e = this.$(".waybill-no").find("input").val().toUpperCase(), t = this.getTypeByTarget().imageType, i = layer.load(), n = this, a = new FormData; _.each(this.$(this.getTarget()).find(":file"), function (e) { a.append($(e).attr("name"), e.files[0]) }), a.append("bno", e), a.append("cardType", t), a.append("id", this.ocrId), a.append("name", this.ocrName), sfAjax.uploadClearancePic({ dataType: "json", data: a, contentType: !1, cache: !1, processData: !1, error: function () { n.showErrMsg(9) }, success: function (e) { 500 == e.code ? n.showErrMsg(9) : 0 == e.code ? n.showSuccess() : n.showErrMsg(e.code) }, complete: function () { layer.close(i) } }) }, showErrMsg: function (t) { var e = _.find(o, function (e) { return e.index == t }); layer.msg(_l(e.msg)) }, showSuccess: function () { this.$el.html(t.clearanceImgUploadSucc({ imgUrl: s.getResourceURL("images/waybill/bg_bill_succ.png"), sfCareUrl: s.getDynamicURLWithContext("/sf_care/") })), window.scrollTo(0, 0) }, idCardUpload: function (t) { this.upLoadSucc = !1; var i = this, e = t.attr("name"); t.attr("name", "idCardFile"); var n = layer.load(), a = new FormData; a.append("idCardFile", t[0].files[0]), sfAjax.uploadIdCard({ dataType: "json", data: a, contentType: !1, cache: !1, processData: !1, error: function () { i.showErrMsg(9) }, success: function (e) { 0 == e.code ? i.idCardUploadSucc(e.data, t) : 1 == e.code ? i.showErrMsg(2) : 2 == e.code ? layer.msg(_l("图片大小不能超过1MB，请重新上传")) : 3 == e.code ? i.showErrMsg(21) : 4 == e.code ? layer.msg(_l("您上传的图片不是身份证件，请重新上传")) : 5 == e.code ? layer.msg(_l("您上传的图片不够清晰，请重新上传")) : i.showErrMsg(9) }, complete: function () { i.upLoadSucc ? (i.getTypeByTarget()[t.parents(".file-input-wrapper").data("surface")] = !0, t.siblings(".upload").addClass("succeed")) : (i.getTypeByTarget()[t.parents(".file-input-wrapper").data("surface")] = !1, t.val("")), i.toggleSubmitBtn(), t.attr("name", e), layer.close(n) } }) }, idCardUploadSucc: function (e, t) { var i = t.parents(".file-input-wrapper").data("surface"); if (e.quality < .5) layer.alert(_l("您上传的图片不够清晰，请重新上传")); else if ("front" === i) e.id && e.name ? (this.upLoadSucc = !0, this.$("#ocr-id").val(e.id), this.$("#ocr-name").val(e.name), this.$(".id-card-form .fl").show()) : layer.alert(_l("您上传的图片不是身份证件，请重新上传")); else if (e.date) { var n = e.date.split("-")[0], a = e.date.split("-")[1]; moment(a, "YYYY.MM.DD").isBefore() ? layer.alert(_l("您上传的证件已过期，请检查日期是否正确或重新上传")) : (this.upLoadSucc = !0, this.$("#ocr-start-date").val(n), this.$("#ocr-end-date").val(a), this.$(".id-card-form .fr").show()) } else layer.alert(_l("您上传的图片不是身份证件国徽面，请重新上传")) }, termToggle: function (e) { var t = this.$(e.currentTarget); t.hasClass("aicon-check") ? t.removeClass("aicon-check").addClass("aicon-uncheck") : t.removeClass("aicon-uncheck").addClass("aicon-check") }, showTerm: function (t) { var e = s.getURLWithContext("other/modal/real-name-filing.html"), i = this; layer.open({ title: _l("消费者实名备案协议条款"), type: 2, area: ["680px", "351px"], content: [e, "no"], btn: _l("我已阅读该条款，同意遵守"), yes: function (e) { i.$(".term-toggle").removeClass("aicon-uncheck").addClass("aicon-check"), layer.close(e), t || i.$(i.getTarget()).find(".submit").trigger("click") } }), $("iframe").css("height", "225px") } }) }), define("models/tax", ["backbone", "helper"], function (e, i) { return e.Model.extend({ getTaxDetail: function () { var t = this; e.ajax({ contentType: "application/json", type: "GET", headers: { "Captcha-App": "kj3tax" }, url: i.getRESTfulDomain("tax/kj3/" + this.get("ticket") + "?app=kj3tax&answer=" + this.get("answer")), error: function (e) { t.trigger("failed", e) }, success: function (e) { t.trigger("get-tax", e) } }) } }) }), function (y, b) { var w = /[<>&\r\n"']/gm, C = { "<": "lt;", ">": "gt;", "&": "amp;", "\r": "#13;", "\n": "#10;", '"': "quot;", "'": "apos;" }; y.extend({ fileDownload: function (a, e) { var t, i, n, s = y.extend({ preparingMessageHtml: null, failMessageHtml: null, androidPostUnsupportedMessageHtml: "Unfortunately your Android browser doesn't support this type of file download. Please try again with a different browser.", dialogOptions: { modal: !0 }, prepareCallback: function (e) { }, successCallback: function (e) { }, failCallback: function (e, t) { }, httpMethod: "GET", data: null, checkInterval: 100, cookieName: "fileDownload", cookieValue: "true", cookiePath: "/", popupWindowTitle: "Initiating file download...", encodeHTMLEntities: !0 }, e), r = new y.Deferred, o = (navigator.userAgent || navigator.vendor || b.opera).toLowerCase(); /ip(ad|hone|od)/.test(o) ? t = !0 : -1 !== o.indexOf("android") ? i = !0 : n = /avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|playbook|silk|iemobile|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(o) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(o.substr(0, 4)); var l = s.httpMethod.toUpperCase(); if (i && "GET" !== l) return y().dialog ? y("<div>").html(s.androidPostUnsupportedMessageHtml).dialog(s.dialogOptions) : alert(s.androidPostUnsupportedMessageHtml), r.reject(); var c, d, u, h, p = null, f = { onPrepare: function (e) { s.preparingMessageHtml ? p = y("<div>").html(s.preparingMessageHtml).dialog(s.dialogOptions) : s.prepareCallback && s.prepareCallback(e) }, onSuccess: function (e) { p && p.dialog("close"), s.successCallback(e), r.resolve(e) }, onFail: function (e, t) { p && p.dialog("close"), s.failMessageHtml && y("<div>").html(s.failMessageHtml).dialog(s.dialogOptions), s.failCallback(e, t), r.reject(e, t) } }; if (f.onPrepare(a), null !== s.data && "string" != typeof s.data && (s.data = y.param(s.data)), "GET" === l) { if (null !== s.data) -1 !== a.indexOf("?") ? "&" !== a.substring(a.length - 1) && (a += "&") : a += "?", a += s.data; t || i ? ((d = b.open(a)).document.title = s.popupWindowTitle, b.focus()) : n ? b.location(a) : c = y("<iframe>").hide().prop("src", a).appendTo("body") } else { var m = ""; null !== s.data && y.each(s.data.replace(/\+/g, " ").split("&"), function () { var e = this.split("="), t = s.encodeHTMLEntities ? v(decodeURIComponent(e[0])) : decodeURIComponent(e[0]); if (t) { var i = s.encodeHTMLEntities ? v(decodeURIComponent(e[1])) : decodeURIComponent(e[1]); m += '<input type="hidden" name="' + t + '" value="' + i + '" />' } }), n ? (h = y("<form>").appendTo("body")).hide().prop("method", s.httpMethod).prop("action", a).html(m) : (t ? ((d = b.open("about:blank")).document.title = s.popupWindowTitle, u = d.document, b.focus()) : u = g(c = y("<iframe style='display: none' src='about:blank'></iframe>").appendTo("body")), u.write("<html><head></head><body><form method='" + s.httpMethod + "' action='" + a + "'>" + m + "</form>" + s.popupWindowTitle + "</body></html>"), h = y(u).find("form")), h.submit() } function g(e) { var t = e[0].contentWindow || e[0].contentDocument; return t.document && (t = t.document), t } function _(e) { setTimeout(function () { d && (i && d.close(), t && (d.focus(), e && d.close())) }, 0) } function v(e) { return e.replace(w, function (e) { return "&" + C[e] }) } return setTimeout(function e() { if (-1 != document.cookie.indexOf(s.cookieName + "=" + s.cookieValue)) return f.onSuccess(a), document.cookie = s.cookieName + "=; expires=" + new Date(1e3).toUTCString() + "; path=" + s.cookiePath, void _(!1); if (d || c) try { var t = d ? d.document : g(c); if (t && null != t.body && t.body.innerHTML.length) { var i = !0; if (h && h.length) { var n = y(t.body).contents().first(); n.length && n[0] === h[0] && (i = !1) } if (i) return f.onFail(t.body.innerHTML, a), void _(!0) } } catch (e) { return f.onFail("", a), void _(!0) } setTimeout(e, s.checkInterval) }, s.checkInterval), r.promise() } }) }(jQuery, this), define("jquery-download", function () { }), define("views/pages/tax/index", ["templates", "backbone", "models/tax", "helper", "utils/checkUtils", "jquery-download"], function (t, e, i, n, a, s) { return e.View.extend({ events: { "click .primary-button.fetch-result": "getTaxDetail", "click .primary-button.download": "download", "click .verification-code .refresh": "refreshValidationCode", "click .validation-image": "refreshValidationCode", "keyup input": "checkInput", "blur input": "checkInput", "click .close": "closeModal" }, initialize: function () { this.refreshValidationCode("refresh-search-code"), this.model = new i, this.listenTo(this.model, "get-tax", this.renderTax).listenTo(this.model, "failed", this.renderFailed) }, download: function () { var e = this, t = n.getRESTfulDomain("tax/kj3/" + this.model.get("ticket") + ".pdf?app=kj3tax&lang=" + n.getSiteLanguage() + "&region=" + n.getSiteLocation() + "&answer=" + $("#validation-download-code").val()); $.fileDownload(t).fail(function () { alert(_l("验证码输入有误，文件下载失败!")) }), window.setTimeout(function () { e.refreshValidationCode("refresh-download-code") }, 1e3) }, clearHint: function () { this.$(".hint").removeClass("show"), this.$(".hint .error.show").removeClass("show") }, closeModal: function () { this.refreshValidationCode("refresh-search-code"), $("#tax-modal").modal("hide") }, renderTax: function (e) { if (e.validation = this.$("#validation-search-code").val(), 0 === e.code) { "KJ3" == e.taxType ? $(".modal-content.tax-detail").html(t.taxDetail({ result: e })) : "F" == e.taxType ? $(".modal-content.tax-detail").html(t.taxBorderDetail({ result: e })) : $(".modal-content.tax-detail").html(t.taxPersonDetail({ result: e })), this.$("#tax-modal").modal({ keyboard: !0, backdrop: !0 }), this.refreshValidationCode("refresh-download-code") } else this.renderMsg(e.code) }, renderFailed: function (e) { 403 === e.status ? this.renderMsg("5") : this.renderMsg("6") }, renderMsg: function (e) { this.refreshValidationCode("refresh-search-code"), this.$(".hint").addClass("show"), this.$(".hint .error.show").removeClass("show"), e ? (e = "#code-" + e, this.$(e).addClass("show")) : this.$("#code-2").addClass("show") }, getTaxDetail: function (e) { e.preventDefault(), this.model.set("ticket", this.$("#ticket").val().toUpperCase()).set("answer", this.$("#validation-search-code").val()).getTaxDetail() }, checkInput: function (e) { this.clearHint(), "validation-download-code" === e.currentTarget.id ? this.$(".primary-button.download").toggleClass("disabled", !this.isExist(this.$("#validation-download-code").val())) : this.$(".primary-button.fetch-result").toggleClass("disabled", !(a.billNumber(this.$("#ticket").val().toUpperCase()) && this.isExist(this.$("#validation-search-code").val()))) }, isExist: function (e) { return e && "" !== e }, refreshValidationCode: function (e) { switch (e = _.isObject(e) ? e.currentTarget.id : e) { case "refresh-search-code": e = "#validation-search-image"; break; case "refresh-download-code": e = "#validation-download-image"; break; case "validation-search-image": case "validation-download-image": e = "#" + e }var t = this.$(e), i = n.getRESTfulDomain("captcha/kj3tax?force=true&time=" + moment()); t.attr("src", i), this.$(".primary-button.download").toggleClass("disabled", !0), this.$(".verification-code input").val("") } }) }), define("views/others/graphValidate", ["sflayer", "helper"], function (e, t) { return Backbone.View.extend({ initialize: function () { this.getNewGraph() }, events: { "click .graph-validate-img": "getNewGraph", "submit form": "submitValidate" }, getNewGraph: function () { this.$(".graph-validate-img").attr("src", t.getRESTfulDomain("captcha/sms?force=true&time=" + (new Date).getTime())) }, submitValidate: function (e) { e.preventDefault(); var t = this.$(".graph-validate-input").val(); /^[A-Za-z0-9]{5}$/.test(t) ? this.options.submitCallBack(t) : this.graphInputErr() }, graphInputErr: function () { e.msg(_l("请输入正确的验证码")) } }) }), define("views/pages/claims/index", ["templates", "backbone", "models/clearance", "helper", "components/detailedLocationPicker/picker", "views/others/graphValidate", "utils/checkUtils"], function (t, r, e, o, i, n, a) { return r.View.extend({ el: $(".claim"), initialize: function () { new i({ el: this.$(".detail-location-input") }), this.$steps = [this.$(".step_1"), this.$(".step_2"), this.$(".step_3")], this.$protocalWrapper = this.$("#protocalWrapper"), this.$invalidTips = this.$(".invalid-claims-tips"), this.$errorWrapper = this.$(".form-group.error"), this.errCodes = [], this.isValidClaimsBillNo = !1, this.formData = [] }, events: { "keyup #carryId": "checkCarryidBeforeSubmit", "click #bankCode_ul li a": "selectBank", "click #submitBtn": "postInfo", "keyup #phone": "isMemberByPhone", "click #getCaptcha": "getCaptcha", "click #confirmBtn": "confirm", "click #backModifyBtn": "backModify", "change #countProvince": "setCode" }, parseChineseChar: function (e) { return encodeURIComponent(e).replace(/%[A-F\d]{2}/g, "U") }, checkCarryidBeforeSubmit: function (e) { e.preventDefault(); var t = $(e.target).val().toUpperCase(); this.$(".invalid-claims-tips ul>li").hide(), this.$invalidTips.hide(), this.checkBillNo(t) }, checkBillNo: function (e) { if ((t = this).validBillnoLength(e)) { var t = this; r.ajax({ type: "GET", url: o.getRESTfulDomain("claims/" + e + "/check?app=claims"), error: function (e) { t.handleCheckingError(e) }, success: function (e) { t.handleCheckingSuccess(e) } }) } else t.setValidCheckingBillNo(!1) }, setValidCheckingBillNo: function (e) { (this.isValidClaimsBillNo = e) ? this.$("#submitBtn").removeClass("disabled") : this.$("#submitBtn").addClass("disabled") }, validBillnoLength: function (e) { return !!a.billNumber(e) || (this.$invalidTips.show(), this.$(".invalid-claims-tips ul>li[invalid-code=2]").show(), !1) }, handleCheckingError: function (e) { var t = ".invalid-claims-tips ul>li[invalid-code=500]"; e.status, this.$invalidTips.show(), this.$(t).show() }, handleCheckingSuccess: function (e) { var t = e.code; if (0 == t) this.setValidCheckingBillNo(!0), this.$invalidTips.hide(); else { 61 !== t && 62 !== t || (t = 61); var i = ".invalid-claims-tips ul>li[invalid-code=" + t + "]"; this.$invalidTips.show(), this.$(i).show() } }, selectBank: function (e) { e.preventDefault(); var t = $(e.target).data("value"), i = $(e.target).text(), n = $(e.target).parents("ul"); n.prevAll("input[name='bankCode']").val(t), n.prevAll("input[name='bankCodeTxt']").val(i), n.prevAll("button").html(i + '<span class="caret"></span>') }, postInfo: function () { this.setCode(); if (!this.checkAllInputs()) return this.renderErrMsg(), !1; var e = this.$("form").serializeArray(); e.forEach(function (e) { "carryId" == e.name && (e.value = e.value.toUpperCase()) }), this.formData = e, this.$steps[1].html(t.claims({ data: this.serializeObject(this.formData) })), this.showStep(2) }, checkAllInputs: function () { return this.errCodes = [], this.checkCarryId(), this.checkEndClaimMoney(), this.checkCompensateAmt(), this.checkBankCode(), this.checkBankname(), this.checkCountName(), this.checkCustomerBankCard(), this.checkCountProvince(), this.checkPurp(), this.checkPhone(), this.checkCapcha(), this.renderErrMsg(), this.checkArea(), 0 == this.errCodes.length }, isMemberByPhone: function () { var e = this.$("#phone").val(); if (/^6\d{7}$|^(569){1}\d{7}$|^9\d{8}$/.test(e)) this.$(".area :radio")[0].checked = !0, this.$(".area").show(); else { var t = this.$(".area :radio:checked"); 0 < t.length && (t[0].checked = !1, this.$(".area").hide()) } if (!this.isValidMainlandPhoneNumber(e)) { var i = this.$("#protocal:checked"); return 0 < i.length && (i[0].checked = !1, this.$protocalWrapper.hide()), !1 } var n = this; r.ajax({ type: "POST", url: o.getRESTfulDomain(_p("member/%(phone)s/exists?lang=%(lang)s&region=%(region)s", { phone: e, lang: o.getSiteLanguage(), region: o.getSiteLocation() })), success: function (e) { n.errCodes = [], e.success ? (n.$("#protocal")[0].checked = !0, n.$protocalWrapper.show("")) : (n.$("#protocal")[0].checked = !1, n.$protocalWrapper.hide()) }, error: function () { } }) }, getCaptcha: function (e) { this.graphValidateLayer = layer.open({ title: _l("图形验证码"), area: "380px", skin: "graphValidate", content: t.graphValidate() }), this.graphValidate = new n({ el: ".graphValidate", submitCallBack: this.getCaptchaone.bind(this) }) }, getCaptchaone: function (e) { layer.close(this.graphValidateLayer); var i = this, t = $("#phone").val(); if (!o.isValidPhoneNumber(t)) return i.errCodes.push("910"), i.renderErrMsg(), !1; if (!i.checkArea()) return i.errCodes.push("913"), i.renderErrMsg(), !1; if ("" == i.$("#carryId").val() || "none" != i.$invalidTips.css("display")) return i.errCodes.push("901"), i.renderErrMsg(), !1; var n = 30, a = i.$("#getCaptcha").attr("disabled", !0); r.ajax({ type: "POST", url: o.getRESTfulDomain("sms/claims/" + i.$("#phone").val() + "/notification?app=sms&lang=" + o.getSiteLanguage() + "&region=" + o.getSiteLocation() + "&billno=" + i.$("#carryId").val().toUpperCase() + "&answer=" + e + "&area=" + o.getArea(i.$("#phone").val())), error: function (e) { i.errCodes = [], 403 === e.status ? i.errCodes.push("916") : i.errCodes.push("915"), i.renderErrMsg(), i.showStep(1), i.$("#getCaptcha").attr("disabled", !1) }, success: function (e) { i.errCodes = [], i.renderErrMsg(), i.showStep(1); var t = function () { setTimeout(function () { if (0 == n) return a.text(_l("获取验证码")), a.attr("disabled", !1), !1; a.text(_l("重新获取") + n--), t() }, 1e3) }; t() } }) }, isValidMainlandPhoneNumber: function (e) { return /^1\d{10}$/.test(e) }, renderErrMsg: function () { this.$("#errMsgWrapper li").hide(), 0 < this.errCodes.length && _.each(this.errCodes, function (e) { this.$("#errMsgWrapper li[errCode=" + e + "]").show() }) }, checkCarryId: function () { "" != this.$("#carryId").val() && a.billNumber(this.$("#carryId").val().toUpperCase()) || this.errCodes.push("901") }, checkEndClaimMoney: function () { var e = this.$("#endClaimMoney").val(); "" != e && /^\d+(\.\d{1,2})?$/.test(e) || this.errCodes.push("902") }, checkCompensateAmt: function () { var e = this.$("#compensateAmt").val(); "" != e && /^\d+(\.\d{1,2})?$/.test(e) || this.errCodes.push("903") }, checkBankCode: function () { "" == this.$("#bankCode").val() && this.errCodes.push("904") }, checkBankname: function () { var e = this.$("#bankName").val(); "" == (e = this.parseChineseChar(e)) && this.errCodes.push("905"), 100 < e.length && this.errCodes.push("1105") }, checkCountName: function () { var e = this.$("#countName").val(); "" == (e = this.parseChineseChar(e)) && this.errCodes.push("906"), 100 < e.length && this.errCodes.push("1104") }, checkCustomerBankCard: function () { var e = this.$("#customerBankCard").val(); "" == e && this.errCodes.push("907"), (!/^\d*$/.test(e) || 25 < e.length) && this.errCodes.push("1106") }, checkCountProvince: function () { "" == this.$("#countProvince").val() && this.errCodes.push("908") }, checkPurp: function () { 0 === this.$(":radio[name=ctgyPurp]:checked").length && this.errCodes.push("909") }, checkPhone: function () { o.isValidMobileByChinaAndHMT(this.$("#phone").val()) || this.errCodes.push("910") }, checkCapcha: function () { "" != this.$("#capcha").val() && 6 == this.$("#capcha").val().length || this.errCodes.push("911") }, checkArea: function () { return !this.$(".area").is(":visible") || 0 != this.$(".area :radio:checked").length || (this.errCodes.push("914"), !1) }, showStep: function (e) { _.each(this.$steps, function (e) { e.hide() }), this.$steps[e - 1].show() }, confirm: function () { var s = this; 0 < this.errCodes.length ? (s.renderErrMsg(), s.showStep(1)) : r.ajax({ type: "POST", url: o.getRESTfulDomain("claims/sendCustomer?app=claims"), headers: { "SMS-Verification-App": "claims", "SMS-Verification-Code": this.$("#capcha").val(), "SMS-Verification-Mobile": this.$("#phone").val() }, data: this.formData, error: function (e) { if (s.errCodes = [], 403 === e.status) { var t = JSON.parse(e.responseText); !t || "003" !== t.code && "002" !== t.code ? s.errCodes.push("911") : s.errCodes.push("912") } else s.errCodes.push("913"); var i = s.$("#getCaptcha"); i.text(_l("获取验证码")), i.attr("disabled", !1), s.renderErrMsg(), s.showStep(1) }, success: function (e) { if ("0" == e.claimsRst) { if (s.$("#protocal").is(":checked")) { var t = _l("您已经成功注册为顺丰会员，账号为") + s.$("#phone").val() + _l("。密码会在稍后发送到您的手机。"), i = _l("注册会员失败。"), n = "1" == e.regRst && s.$("") ? t : i; s.$(".step_3").append("<p>" + n + "</p>") } s.showStep(3) } else { var a = e; "2" !== a.claimsRst && "48" !== a.claimsRst || (a.claimsRst = "2"), "5" !== a.claimsRst && "47" !== a.claimsRst || (a.claimsRst = "5"), "1" !== a.claimsRst && "46" !== a.claimsRst || (a.claimsRst = "1"), "3" !== a.claimsRst && "49" !== a.claimsRst || (a.claimsRst = "3"), s.errCodes = [], s.errCodes.push(a.claimsRst), s.renderErrMsg(), s.showStep(1) } } }) }, backModify: function () { this.showStep(1) }, serializeObject: function (e) { var t = {}; return $.each(e, function () { void 0 !== t[this.name] ? (t[this.name].push || (t[this.name] = [t[this.name]]), t[this.name].push(this.value || "")) : t[this.name] = this.value || "" }), t }, setCode: function () { this.$("#countProvinceCode").val(this.$("#countProvince").data("code")) } }) }), define("models/currency", ["backbone"], function (e) { return e.Model.extend({ initialize: function () { } }) }), define("collections/currency", ["backbone", "models/currency", "helper", "moment"], function (n, e, a, s) { return n.Collection.extend({ model: e, url: a.getRESTfulDomain("exrate/currencies"), initialize: function () { this.fetch() }, fetchRate: function (e, t, i) { return n.ajax({ url: a.getRESTfulDomain("exrate"), data: { time: i && s(i).add(7.5, "h").isBefore(s()) ? s(i).add(7.5, "h").format() : s().format(), originCode: e, destCode: t } }) } }) }), define("components/detailDatePicker/picker", ["backbone", "datepicker", "datepickercn", "templates", "moment", "helper"], function (e, t, i, n, a, s) { return e.View.extend({ events: { "click input": "toggleLocationPicker", "click .input-group-addon": "toggleLocationPicker", toggle: "toggleLocationPicker", click: "stopPropagation" }, initialize: function () { this.$pickerWrapper = $('<div class="detail-date-picker toggle-plugins"></div>'), this.$el.append(this.$pickerWrapper), this.render() }, stopPropagation: function (e) { e.stopPropagation() }, showPicker: function () { $("body").click(), this.$pickerWrapper.show() }, toggleLocationPicker: function (e) { this.$pickerWrapper.is(":visible") ? this.$pickerWrapper.hide() : (e && e.stopPropagation(), this.showPicker()) }, startDate: function () { return "1993-01-01" }, render: function () { var t = this; this.$(".detail-date-picker").datepicker({ language: s.getStandardLocale(), startDate: t.startDate(), endDate: "0d", todayBtn: "linked" }).on("changeDate", function (e) { e.date && (a(e.date).isSame(a(), "day") ? t.$("input").val(_l("今天")) : t.$("input").val(a(e.date).format("YYYY-MM-DD")), t.$("input").data("date", a(e.date).format()).trigger("change")); t.$pickerWrapper.hide() }).datepicker("setDate", "0d") } }) }), define("views/pages/currency/index", ["backbone", "collections/currency", "templates", "components/detailDatePicker/picker"], function (e, t, i, n) { return e.View.extend({ events: { "click .origin .dropdown-menu a": "selectOriginCurrency", "click .dest .dropdown-menu a": "selectDestCurrency", "keyup .origin input": "originInputChanged", "change #time-picker": "fetchRate" }, initialize: function () { this.collection = new t, this.listenTo(this.collection, "sync", this.render), this.originUnit = 1, new n({ el: $(".detail-date-input") }), this.render() }, numberCheck: function (e) { var t = $(e.currentTarget).val(); (isNaN(t) || -1 !== _.indexOf(t, ".")) && (t = t.replace(/[^0-9]/g, ""), $(e.currentTarget).val(t)), 9 < t.length && $(e.currentTarget).val(t.substr(0, 9)) }, originInputChanged: function (e) { this.numberCheck(e), this.originUnit = Math.round(Number($(e.currentTarget).val())), this.currencyRate && this.setResultText() }, setResultText: function () { var e; if (Number(this.originUnit)) { var t = this.originUnit * this.currencyRate; e = Math.round(1e6 * t) / 1e6 } else e = this.$(".result-text").data("placeholder"); var i = this.selectedDest.code; this.$(".result-text").html("<small>" + i + "</small> " + e).show() }, selectOriginCurrency: function (e) { var t = $(e.currentTarget); this.selectedOrigin = { name: t.text(), code: t.data("code") }, this.$(".origin .input-group-addon").text(t.data("code")).show(), this.fetchRate() }, selectDestCurrency: function (e) { var t = $(e.currentTarget); this.selectedDest = { name: t.text(), code: t.data("code") }, this.$(".dest .input-group-addon").text(t.data("code")).show(), this.fetchRate() }, fetchRate: function () { if (!this.selectedOrigin || !this.selectedDest) return this.isFetchRateFromServer = !1, this.render(), void this.$(".result-text").hide(); var t = this; t.$(".error").hide(), t.isFetchRateFromServer = !0, t.currencyRate = null, t.render(), this.collection.fetchRate(this.selectedOrigin.code, this.selectedDest.code, this.$("#time-picker").data("date")).success(function (e) { t.currencyRate = e, t.isFetchRateFromServer = !1, t.render() }).error(function (e) { t.isFetchRateFromServer = !1, t.currencyRate = void 0, t.render(), 404 === e.status ? t.$(".error[data-error=not-found]").show() : t.$(".error[data-error=network]").show() }) }, availableOriginCurrencies: function () { return this.selectedDest, this.collection.models }, availableDestCurrencies: function () { return this.selectedOrigin, this.collection.models }, render: function () { this.selectedOrigin && this.$(".origin .dropdown-toggle .selected-currency").text(this.selectedOrigin.name), this.selectedDest && this.$(".dest .dropdown-toggle .selected-currency").text(this.selectedDest.name), this.$(".origin input").val(this.originUnit), this.currencyRate ? this.setResultText() : this.isFetchRateFromServer ? this.$(".result-text").html(this.$(".result-text").data("loading-text")).show() : this.$(".result-text").hide(), this.$(".origin .dropdown-menu").html(i.dropdownTemplates({ dropdownItems: this.availableOriginCurrencies() })), this.$(".dest .dropdown-menu").html(i.dropdownTemplates({ dropdownItems: this.availableDestCurrencies() })) } }) }), define("collections/invoices", ["backbone", "helper"], function (e, a) { return e.Collection.extend({ parse: function (e) { return _.each(e, function (e) { e.invoiceID = e.id, e.id = null }), e }, fetchInvoiceDetails: function (e, t, i) { var n = this; this.url = a.getRESTfulDomain(_p("invoices/%s?code=%s&answer=%s&app=invoice", e, t, i)), this.fetch({ error: function (e, t) { 404 === t.status ? n.trigger("notFound") : 403 === t.status ? n.trigger("validationCodeError") : n.trigger("networkError"); var i = a.getRESTfulDomain("captcha/invoice?force=true&time=" + moment()); this.$("#validation-search-image").attr("src", i), this.$("#validation-search-code").val("") } }) } }) }), define("views/pages/invoices/index", ["backbone", "collections/invoices", "templates", "helper"], function (e, t, n, i) { return e.View.extend({ events: { "keyup #invoice-number": "invoiceNumberUpdated", "keyup #invoice-code": "invoiceCodeUpdated", "keyup #validation-search-code": "inputUpdated", "click .refresh": "reloadValidateCodeImage", "click #validation-search-image": "reloadValidateCodeImage", "click .primary-button": "queryInvoices" }, initialize: function () { this.collection = new t, this.listenTo(this.collection, "sync", this.render), this.listenTo(this.collection, "notFound", this.showNotFoundError), this.listenTo(this.collection, "networkError", this.showNetworkError), this.listenTo(this.collection, "validationCodeError", this.showValidationCodeError), this.reloadValidateCodeImage() }, invoiceNumberUpdated: function (e) { var t = $(e.currentTarget).val(), i = t.replace(/[^0-9]/g, ""); t !== i && $(e.currentTarget).val(i), this.inputUpdated() }, invoiceCodeUpdated: function (e) { var t = $(e.currentTarget).val(), i = t.replace(/[^0-9A-Za-z]/g, ""); t !== i && $(e.currentTarget).val(i), this.inputUpdated() }, reloadValidateCodeImage: function () { var e = i.getRESTfulDomain("captcha/invoice?force=true&time=" + moment()); this.$("#validation-search-image").attr("src", e), this.$("#validation-search-code").val("") }, render: function () { var e = this.$(".results"); if (this.collection.length) { var t = this.$(".primary-button"); t.html(t.data("resetText")), this.reloadValidateCodeImage(); var i = this.collection.toJSON(); e.html(n.invoicesResult({ results: i })), e.slideDown() } else e.slideUp() }, inputUpdated: function () { var e = this.$("#invoice-number").val(), t = this.$("#invoice-code").val(), i = this.$("#validation-search-code").val(); this.$(".primary-button").toggleClass("disabled", !(e && t && i)), this.$(".error").hide() }, resetLoading: function () { this.$(".error").hide(), this.$(".primary-button").button("reset") }, showNotFoundError: function () { var e = this.$(".primary-button"); e.html(e.data("resetText")), this.$(".error[data-error=not-found]").show(), this.reloadValidateCodeImage() }, showNetworkError: function () { this.resetLoading(), this.$(".error[data-error=network]").show() }, showValidationCodeError: function () { var e = this.$(".primary-button"); e.html(e.data("resetText")), this.$(".error[data-error=validation-code]").show() }, queryInvoices: function () { var e = this.$(".primary-button"); this.resetLoading(), e.button("loading"); var t = this.$("#invoice-number").val(), i = this.$("#invoice-code").val(), n = this.$("#validation-search-code").val(), a = this; this.$(".results").slideUp(function () { a.collection.fetchInvoiceDetails(t, i, n) }) } }) }), define("components/addressBook/userCenterAddressBook", ["./addressBook", "templates"], function (e, t) { return e.extend({ template: t.userCenteraddressBook, render: function () { e.prototype.render.apply(this, arguments), this.setElement(this.$(".uc-adds-books")) }, events: _.extend({ "click .go-back": "goBack" }, e.prototype.events), dealTips: function () { }, preDblclickToConform: function () { }, goBack: function () { this.options.callback() } }) }), define("views/query/list/listSimple", ["baseView", "templates", "sflayer", "moment", "components/changeAppointBill/changeAppointBill", "components/changeAppointBill/changeAppointBillHeavyCargo", "components/changeAppointBill/changeAppointBillHmt", "components/digitalWaybill/index", "helper", "../components/cancelAppointBill", "../components/evaluateBill", "components/changeDelivery/changeDelivery"], function (e, t, r, n, s, o, l, a, c, i, d, u) { var h = ["T1", "T104", "T8", "T801", "T4", "T6"], p = ["SE0100", "SE0101"], f = { 0: { statusTxt: "等待取件", timeTxt: "预约上门时间", statusIcon: "progress0" }, 2: { statusTxt: "运送中", timeTxt: "预计送达时间", statusIcon: "progress3" }, 3: { statusTxt: "派送中", timeTxt: "预计送达时间", statusIcon: "progress5" }, 4: { statusTxt: "已签收", timeTxt: "签收时间", statusIcon: "progress6" }, 5: { statusTxt: "已作废", timeTxt: "作废时间", statusIcon: "progress0" }, 8: { statusTxt: "已退回", timeTxt: "退回时间", statusIcon: "progress3" }, 9: { statusTxt: "已转寄", timeTxt: "转寄时间", statusIcon: "progress3" } }, m = { "0or1": [{ statusTxt: "待寄出", timeTxt: "预约上门时间", statusIcon: "progress0" }, { statusTxt: "等待上门", timeTxt: "预约上门时间", statusIcon: "progress0" }], 5: { statusTxt: "已揽件", timeTxt: "揽件时间", statusIcon: "progress1" }, 7: { statusTxt: "已取消", timeTxt: "取消时间", statusIcon: "progress0" }, 10: { statusTxt: "已取件", timeTxt: "取件时间", statusIcon: "progress1" }, 12: { statusTxt: "已关闭", timeTxt: "关闭时间", statusIcon: "progress0" } }, g = { 7: { statusTxt: "已取消", timeTxt: "取消时间", statusIcon: "progress0" }, 12: { statusTxt: "已关闭", timeTxt: "关闭时间", statusIcon: "progress0" }, 40038: { statusTxt: "等待上门", timeTxt: "", statusIcon: "progress0" }, 40039: { statusTxt: "待支付", timeTxt: "", statusIcon: "progress0" }, 40040: { statusTxt: "待退款", timeTxt: "", statusIcon: "progress0" }, 40041: { statusTxt: "已退款", timeTxt: "退款时间", statusIcon: "progress0" }, 40042: { statusTxt: "已取消", timeTxt: "取消时间", statusIcon: "progress0" }, 40043: { statusTxt: "运送中", timeTxt: "", statusIcon: "progress3" }, 40044: { statusTxt: "预约完成", timeTxt: "完成时间", statusIcon: "progress0" }, 40049: { statusTxt: "已拒单", timeTxt: "拒单时间", statusIcon: "progress0" }, 40050: { statusTxt: "可接单", timeTxt: "", statusIcon: "progress0" } }, v = c.getSiteLocation(), y = _.extend({ template: t.query_list_simple, data: { type: null, pageNo: 1, pageRows: 10, primaryNo: null, getData: function () { } }, init: function (e) { this.$el.off(), this.data = _.extend({}, this.data, e), "batch" === e.type && (this.data.pageRows = 100), this.isSend = "receive" !== e.type, this.request = { send: sfAjax.getMemberSendBillInfo, receive: sfAjax.getMemberRecBillInfo, batch: sfAjax.getBatchShipChildList }[e.type], this.doRequest() }, doRequest: function (t) { var i = this, e = r.load(0, { shade: [.2, "#000"] }), n = { pageNo: this.data.pageNo, pageRows: this.data.pageRows }; "batch" === this.data.type && (n.primaryNo = this.data.primaryNo), this.request({ data: n, success: function (e) { e.result && (i.data.totalPage = e.result.totalPage, i.data.list = i.handlerWaybillData(e.result.content), i.data.getData(e.result.content)), i.renderList(), t && t() }, complete: function () { r.close(e) } }) }, handlerWaybillData: function (e) { var i = this; return _.map(e, function (e) { var t; return 10 != e.pickupType && 18 != e.pickupType ? "" === e.appointmentStatue || null === e.appointmentStatue ? (t = f[e.waybillStatus], 2 == e.waybillStatus || 3 == e.waybillStatus ? e.time = e.expectedDeliveryTime : 0 == e.waybillStatus ? e.time = e.expectedTime || n(e.appointmentTime).add(1, "hours").format("YYYY-MM-DD HH:mm:ss") : e.time = e.endTime) : (t = m[e.appointmentStatue], 0 == e.appointmentStatue || 1 == e.appointmentStatue ? (t = 3 == e.pickupType ? m["0or1"][0] : m["0or1"][1], e.time = e.expectedTime || n(e.appointmentTime).add(1, "hours").format("YYYY-MM-DD HH:mm:ss")) : e.time = e.endTime) : "" === e.appointmentStatue && null === e.appointmentStatus || (t = g[e.appointmentStatue], e.time = e.endTime), e.billNum = e.waybillno || (7 == e.appointmentStatue ? _l("无2") : _l("待定")), i.judgeWaybillState(e), _.extend(e, t) }) }, renderList: function () { var a = this; if (this.$el.html(this.template({ list: this.data.list, isSender: this.isSend, type: this.data.type })), "batch" !== this.data.type) { var e = { currentPage: this.data.pageNo, totalPages: this.data.totalPage, numberOfPages: this.data.pageRows, bootstrapMajorVersion: 3, alignment: "center", itemTexts: function (e, t) { switch (e) { case "first": return _l("首页2"); case "prev": return _l("上一页"); case "next": return _l("下一页"); case "last": return _l("末页"); case "page": return t } }, itemContainerClass: function (e, t, i) { return t === i ? "active" : "pointer-cursor" }, onPageClicked: function (e, t, i, n) { a.data.pageNo = n, a.doRequest(function () { $("html").scrollTop(290) }) } }; this.$(".pagination").bootstrapPaginator(e) } }, judgeWaybillState: function (e) { e.cancel = this.judgeIfCancel(e), e.delete = this.judgeIfDelete(e), e.modify = this.judgeIfModify(e), e.digital = this.judgeIfDigital(e), e.evaluate = this.judgeIfEvaluate(e), e.changeDelivery = this.judgeIfChangeDelivery(e) }, judgeIfCancel: function (e) { if (e.waybillno && 10 != e.pickupType && 18 != e.pickupType && (0 == e.appointmentStatue || 1 == e.appointmentStatue)) return !0; if (!e.waybillno) { if (10 == e.pickupType || 18 == e.pickupType) return 40038 == e.appointmentStatue || 40039 == e.appointmentStatue; if (7 != e.appointmentStatue && 12 != e.appointmentStatue) return !0 } return !1 }, judgeIfDelete: function (e) { for (var t = e.waybillStatus || e.appointmentStatue, i = [4, 7, 12, 4001, 40042, 40044], n = 0; n < i.length; n++)if (i[n] == t) return !0; return !1 }, judgeIfChangeDelivery: function (e) { return (2 == e.waybillStatus || 3 == e.waybillStatus) && c.isReceiver(e.billType) && !this.isSend && !c.isHK_MC_TW(e.destCityCode) && !c.isInternational(e.destCityCode) && c.supportChangeDelivery(e.productType, e.isIssuedPrefrence) && "en" != c.getSiteLanguage() }, judgeIfModify: function (e) { return 0 === e.appointmentStatue || 1 === e.appointmentStatue }, judgeIfDigital: function (e) { return e.waybillno && (0 === e.appointmentStatue || 1 === e.appointmentStatue) }, judgeIfEvaluate: function (e) { return c.isReceiver(e.billType) && !this.isSend ? "4" == e.waybillStatus : c.isSender(e.billType) ? 5 === e.appointmentStatue || 10 === e.appointmentStatue || "2" == e.waybillStatus || "3" == e.waybillStatus || "4" == e.waybillStatus : void 0 } }, { events: { "click .item.canSelect": "selectItem", "click .cancel-img": "cancel", "click .remove-img": "delete", "click .modify-img": "modify", "click .digital-img": "digital", "click .evaluate-img": "evaluate", "click .changeDelivery-img": "changeDelivery" }, selectItem: function (e) { if (!$(e.target).hasClass("bill-btn")) { var t = $(e.currentTarget), i = t.data("status"), n = t.data("appointment-statue"), a = t.data("appointmentno"), s = t.data("id") + "", r = t.data("bill-type"); if ($("html").scrollTop(0), 0 < i || "5" == n || "10" == n) { if (c.isNotMyWaybill(r)) return void (location.hash = "search/bill-number/" + s); location.hash = "search/bill-number/v/" + s } else location.hash = "search/order/" + a } }, cancel: function (e) { var t = $(e.currentTarget).parents(".item"); new i({ appointmentNo: t.data("appointmentno"), pickupType: t.data("pickup-type"), callback: this.doRequest.bind(this) }) }, delete: function (e) { var i = this, n = $(e.currentTarget).parents(".item"); r.confirm(_l("是否删除订单？"), { btn: [_l("是"), _l("否")] }, function () { var e = n.hasClass("appointBill") ? "0" : $(".send-tab").hasClass("active") ? "1" : "2", t = n.hasClass("appointBill") ? n.data("appointmentno") : n.data("id"); sfAjax.deleteWayBill({ data: { abno: t, deleteType: e }, success: function () { r.msg(_l("删除成功")), i.doRequest() }, error: function () { r.msg(_l("删除失败")) } }) }) }, modify: function (e) { var a = this, t = e && e.currentTarget; this.appointmentNo = e ? this.$(e.currentTarget).closest(".appointBill").data("appointmentno") : this.appointmentNo, this.isLocked(t) || sfAjax.queryAppointBill({ data: { appointmentNo: this.appointmentNo }, success: function (e) { var t = e.appointmentDetail, i = { billInfo: t, callback: a.doRequest.bind(a) }; if (c.isHK_MC_TW(t.appointmentDestDetail.locationCode)) new l(i); else { var n = t.productInfo.code; -1 < h.indexOf(n) ? new s(i) : -1 < p.indexOf(n) && new o(i) } }, error: function () { r.msg(_l("网络错误")) }, complete: function () { a.unlock(t) }, login: { succCallback: this.modify.bind(this), cancelCallback: function () { r.msg(_l("修改失败")) } } }) }, digital: function (e) { var t = this, i = e && e.currentTarget; this.appointmentNo = e ? this.$(e.currentTarget).closest(".appointBill").data("appointmentno") : this.appointmentNo, this.isLocked(i) || sfAjax.queryAppointBill({ data: { appointmentNo: this.appointmentNo }, success: function (e) { new a({ infoList: [e] }) }, error: function () { r.msg(_l("网络错误")) }, complete: function () { t.unlock(i) } }) }, evaluate: function (e) { var t = e && e.currentTarget; if (!this.isLocked(t)) { var i = this.$(e.currentTarget).closest(".waybill"), n = this; !this.isSend && i.data("rec-emp-code") || this.isSend && i.data("emp-code") ? sfAjax.getCourierInfo({ data: { courierNo: this.isSend ? i.data("emp-code") : i.data("rec-emp-code"), bno: i.data("id") }, success: function (e) { new d({ billInfo: { waybillNo: i.data("id"), isSender: n.isSend, statusCode: i.data("status"), endTime: i.data("end-time"), courierInfo: e, sendEvaluate: i.data("send-evaluate"), recEvaluate: i.data("rec-evaluate"), callback: function () { this.doRequest() }.bind(n) } }) }, error: function () { r.msg(_l("系统繁忙，请稍后再试")) }, complete: function () { n.unlock(t) } }) : r.msg(_l("系统繁忙，请稍后再试")) } }, changeDelivery: function (e) { var t = e && e.currentTarget; if (!this.isLocked(t)) { var i = this, n = this.$(e.currentTarget).closest(".waybill"), a = n.data("id"), s = n.data("end-time"); a ? sfAjax.queryAcceptableService({ data: { billNo: a }, success: function (e) { var t = _.filter(e.serviceInfoList, function (e) { return 8 == e.type })[0], i = _.filter(e.serviceInfoList, function (e) { return -1 != [7, 22, 23, 24, 25].indexOf(e.type) })[0], n = { awsmId: e.awsmId, waybillNo: a, city: e.city, cityCode: e.cityCode, expectedDeliveryTime: s, address: e.address, contactName: e.contactName, contactPhone: e.contactPhone, modifyContact: e.modifyContact, modifyTimOrAddr: null == i, newContactName: t ? t.name : "", newContactPhone: t ? t.phone : "", deliverDate: i ? i.deliverDate : "", deliverTimeMin: i ? i.deliverTimeMin : "", deliverTimeMax: i ? i.deliverTimeMax : "", storeType: i ? i.networkStoreType : "", networkStoreName: i ? i.networkStoreName : "", networkStoreAddress: i ? i.networkStoreAddress : "", toSF: e.toSF, toBox: e.toBox && !c.isOnlyChangeToSF(e.cargoTypeCode), toBest: e.toBest && !c.isOnlyChangeToSF(e.cargoTypeCode), toStore: e.toStore && !c.isOnlyChangeToSF(e.cargoTypeCode) }; new u(n) }, error: function () { r.msg(_l("网络错误")) }, complete: function () { i.unlock(t) } }) : r.msg(_l("网络错误")) } } }), b = { modify: function (e) { var n = this, t = e && e.currentTarget; this.appointmentNo = e ? this.$(e.currentTarget).closest(".appointBill").data("appointmentno") : this.appointmentNo, this.isLocked(t) || sfAjax.queryAppointBill({ data: { appointmentNo: this.appointmentNo }, success: function (e) { var t = e.appointmentDetail, i = { billInfo: t, callback: n.doRequest.bind(n) }; t.appointmentOriginDetail.locationCode == t.appointmentDestDetail.locationCode ? new s(i) : new l(i) }, error: function () { r.msg(_l("网络错误")) }, complete: function () { n.unlock(t) }, login: { succCallback: this.modify.bind(this), cancelCallback: function () { r.msg(_l("修改失败")) } } }) } }; return "cn" === v ? e.extend(y) : "hk" === v || "tw" === v ? e.extend(_.extend(y, b)) : void 0 }), define("views/others/countDownButton", ["backbone"], function (e) { return e.View.extend({ events: { "start .count-down-button": "startCountDown", "reset .count-down-button": "resetCountDown", "shouldBeActive .count-down-button": "changeShouldActiveFlag" }, changeShouldActiveFlag: function (e, t) { var i = $(e.currentTarget); i.data("should-deactivate", !Boolean(t)), i.data("is-loading") || i.toggleClass("disabled", !t) }, startCountDown: function (e) { var t = $(e.currentTarget); t.data("origin-title", t.text()); var i = t.data("count-down-time") || 30, n = t.data("count-down-title") || "reload in %d"; t.toggleClass("disabled", !0), t.text(_p(n, i)), t.data("is-loading", !0); var a = this; this.countDownTimer = window.setInterval(function () { (i -= 1) ? t.text(_p(n, i)) : a.resetCountDown(e) }, 1e3) }, resetCountDown: function (e) { var t = $(e.currentTarget); t.toggleClass("disabled", t.data("should-deactivate")), t.text(t.data("origin-title")), this.countDownTimer && window.clearInterval(this.countDownTimer), t.data("is-loading", !1) } }) }), define("views/others/newGraphValidate", ["baseView", "templates", "helper", "verify", "sflayer"], function (e, t, i, n) { return e.extend({ layerOpts: { title: _l("图形验证码"), area: "380px", skin: "line graphValidate" }, template: t.graphValidate, init: function (e) { this.mobile = e.mobile }, render: function () { this.$el.html(this.template()), this.getNewGraph() }, events: { "click .graph-validate-img": "getNewGraph", "submit form": "submitValidate" }, getNewGraph: function () { this.$(".graph-validate-img").attr("src", i.getRESTfulDomain("captcha/sms?force=true&time=" + (new Date).getTime())) }, submitValidate: function (e) { e.preventDefault(); var t = this.$(".graph-validate-input").val(); n.isCaptcha(t) ? this.getSMSCodefromServer(t) : this.graphInputErr() }, graphInputErr: function () { layer.msg(_l("请输入正确的验证码")) }, getSMSCodefromServer: function (e) { var t = this; sfAjax.smsUserNotification({ params: { app: "sms", mobile: this.mobile, answer: e, area: i.getArea() }, success: function () { t.close(), t.options.callback() }, error: function (e) { 403 == e.status ? (t.getNewGraph(), t.graphInputErr()) : 410 == e.status ? (t.close(), layer.msg(_l("该手机号本日已达到发送短信上限"))) : 400 == e.status ? (t.close(), layer.msg(_l("手机号错误"))) : (layer.msg(_l("网络错误")), t.getNewGraph()) } }) } }) }), define("views/pages/userCenter/changeMobile", ["baseView", "views/others/countDownButton", "views/others/newGraphValidate"], function (e, t, i) { return e.extend({ renderInit: function () { new t({ el: this.$(".count-down-button").parent() }), this.setElement(this.$(".change-mobile")) }, events: { "click .count-down-button": "getValidationCode", "input .validation-code": "validateCode" }, getValidationCode: function () { new i({ mobile: this.mobile, callback: this.validationSuccess.bind(this) }) }, validationSuccess: function () { this.$(".code-hide").fadeIn(), this.$(".validation-code").val("").focus(), this.$(".count-down-button").trigger("start") }, validateCode: function (e) { var t = this.$(e.currentTarget).val(); this.$(e.currentTarget).val(t.replace(/[^0-9]/g, "")), 6 == this.$(e.currentTarget).val().length && (this.$(e.currentTarget).blur(), this.code = this.$(e.currentTarget).val(), this.checkMobile()) } }) }), define("views/pages/userCenter/validateNewMobile", ["./changeMobile", "templates", "sf-validate", "views/others/newGraphValidate", "sflayer"], function (e, t, i, n) { return e.extend({ template: t.validateNewMobile, render: function () { this.$el.html(this.template()), this.renderInit(), this.addFormValidate(), this.$('[name="mobile"]').focus() }, events: _.extend({ "submit form": "submitForm" }, e.prototype.events), addFormValidate: function () { i(this.$("form"), { rules: { mobile: { required: !0, regex: "isTelCn" } }, messages: { mobile: { regex: _l("您输入的手机号码格式不正确，请重新输入。") } } }) }, submitForm: function (e) { e.preventDefault() }, getValidationCode: function () { this.$("form").validate().form() && (this.mobile = this.$('[name="mobile"]').val(), new n({ mobile: this.mobile, callback: this.validationSuccess.bind(this) })) }, checkMobile: function () { var e = layer.load(), t = this; sfAjax.bindMobile({ headers: { "SMS-Verification-App": "user", "SMS-Verification-Code": this.code, "SMS-Verification-Mobile": this.mobile }, success: function (e) { 0 === e.code ? (layer.msg(_l("更新信息成功")), t.options.callback(t.mobile), t.options.close()) : 670 === e.code ? layer.msg(_l("手机号已绑定其他会员账户，请重新输入")) : 111 === e.code ? layer.msg(_l("验证码错误")) : 112 === e.code ? layer.msg(_l("验证码参数错误")) : 113 === e.code ? layer.msg(_l("验证码未发送")) : 114 === e.code ? layer.msg(_l("验证码已过期")) : 115 === e.code ? layer.msg(_l("验证码超次数，请重新获取")) : layer.msg(_l("更新信息失败")) }, error: function () { layer.msg(_l("更新信息失败")) }, complete: function () { layer.close(e), t.$(".validation-code").val("").focus() }, login: { succCallback: this.checkMobile.bind(this), cancelCallback: function () { layer.msg(_l("更新信息失败")) } } }) } }) }), define("views/pages/userCenter/validateOldMobile", ["./changeMobile", "templates", "./validateNewMobile"], function (e, t, i) { return e.extend({ layerOpts: { title: _l("身份验证"), area: "380px", skin: "line" }, template: t.validateOldMobile, init: function (e) { this.mobile = e.mobile, this.$initEl = this.$el }, render: function () { this.$el.html(this.template({ mobile: this.mobile })), this.renderInit() }, checkMobile: function () { var e = layer.load(), t = this; sfAjax.checkMobile({ headers: { "SMS-Verification-App": "user", "SMS-Verification-Code": this.code, "SMS-Verification-Mobile": this.mobile }, success: function (e) { 0 === e.code ? t.validateSmsSucc() : 671 === e.code ? layer.msg(_l("手机号不正确")) : 111 === e.code ? layer.msg(_l("验证码错误")) : 112 === e.code ? layer.msg(_l("验证码参数错误")) : 113 === e.code ? layer.msg(_l("验证码未发送")) : 114 === e.code ? layer.msg(_l("验证码已过期")) : 115 === e.code ? layer.msg(_l("验证码超次数，请重新获取")) : layer.msg(_l("网络错误")) }, error: function () { layer.msg(_l("网络错误")) }, complete: function () { layer.close(e), t.$(".validation-code").val("").focus() }, login: { succCallback: this.checkMobile.bind(this), cancelCallback: function () { layer.msg(_l("更新信息失败")) } } }) }, validateSmsSucc: function () { this.changeTitle(_l("新手机号")), new i({ el: this.$initEl, close: this.close.bind(this), callback: this.options.callback }) }, changeTitle: function (e) { layer.title(e, this.layerIndex) } }) }), define("views/pages/userCenter/birthdayPicker", ["baseView", "datepicker", "templates", "helper", "datepickercn", "sflayer"], function (e, t, i, n) { return e.extend({ init: function (e) { this.brief = e.brief, this.$pickerWrapper = $('<div class="detail-date-picker toggle-plugins"></div>'), this.$el.append(this.$pickerWrapper) }, render: function () { var t = this; this.$(".detail-date-picker").datepicker({ language: n.getStandardLocale(), endDate: "0d", todayBtn: "linked", keyboardNavigation: !0 }).on("changeDate", function (e) { e.date && t.$("input").trigger("change", e.date) }) }, events: { "click input": "toggleLocationPicker", click: "stopPropagation" }, stopPropagation: function (e) { e.stopPropagation() }, showPicker: function () { $("body").click(), this.$pickerWrapper.show() }, hidePicker: function () { this.$pickerWrapper.hide() }, toggleLocationPicker: function (e) { this.brief.birthday ? layer.msg(_l("生日信息暂不支持修改")) : this.$pickerWrapper.is(":visible") ? this.$pickerWrapper.hide() : (e.stopPropagation(), this.showPicker()) } }) }), define("views/pages/userCenter/setPersonal", ["baseView", "templates", "helper", "components/detailedLocationPicker/picker", "./validateOldMobile", "./birthdayPicker", "sflayer"], function (e, t, n, i, a, s) { return e.extend({ init: function (e) { this.brief = e.brief, this.headPhotoUrl = e.headPhotoUrl }, template: t.setPersonal, render: function () { var e; this.brief.sex ? "W" === this.brief.sex.toUpperCase() ? e = _l("女") : "M" === this.brief.sex.toUpperCase() && (e = _l("男")) : e = "", this.$el.html(this.template({ brief: this.brief, genderVal: e, headPhotoUrl: this.headPhotoUrl || n.getResourceURL("images/user_center/profile-pic.png") })), new i({ el: this.$(".detail-location-input") }), this.birthdayPicker = new s({ el: this.$(".detail-date-input"), brief: this.brief }), this.toggleBirthdayArrow(), this.setElement(this.$(".personal-setting-wrapper")) }, events: { "click .go-back": "goBack", "click .select-item": "selectGender", "click .user-mobile": "changeMobile", "locationChanged .detail-location-input": "regionModelUpdate", "change .detail-location-input input": "onLocationChanged", "change #birthday": "birthdaySelected" }, goBack: function () { this.options.callback() }, selectGender: function (e) { var t = this.$(e.currentTarget).data("type"); this.updateUserInfo("gender", t) }, toggleBirthdayArrow: function () { this.brief.birthday ? this.$(".detail-date-input").addClass("active") : this.$(".detail-date-input").removeClass("active") }, birthdaySelected: function (e, t) { var i = this; this.birthdayLayer = layer.confirm(_l("生日信息提交后将不能更改"), { btn: [_l("确定"), _l("取消")] }, function () { i.updateUserInfo("birthday", moment(t).format("YYYY-MM-DD")) }, function (e) { i.$("#birthday").val(i.brief.birthday), layer.close(e) }) }, changeMobile: function (t) { var i = this; new a({ mobile: this.brief.mobile, callback: function (e) { i.brief.mobile = e, i.$(t.currentTarget).val(e), i.$(".user-phone").text(e), i.options.changeMobile(e), $(".head-user-number").text(n.handleStr(e)), $.cookie("loginUser", e, { path: "/", expires: 7 }) } }) }, regionModelUpdate: function (e, t) { this.addLocation = t }, onLocationChanged: function (e) { this.$(e.currentTarget).val(_.uniq(_.compact([this.brief.province, this.brief.city]), !0).join("-")), this.updateUserInfo("location", { city: this.addLocation.city, province: this.addLocation.province }) }, updateUserInfo: function (t, i) { var e = { provinceName: this.brief.province, cityName: this.brief.city, sex: this.brief.sex, birthday: this.brief.birthday }; "gender" === t ? e.sex = i : "birthday" === t ? e.birthday = i : "location" === t && (e.cityName = i.city, e.provinceName = i.province); var n = this; sfAjax.updateUserInfo({ data: e, success: function (e) { e && 0 == e.code ? (layer.msg(_l("更新信息成功")), "gender" === t ? (n.brief.sex = i, n.$(".gender").val(n.$('[data-type="' + i + '"]').text())) : "birthday" === t ? (n.brief.birthday = i, n.birthdayPicker.hidePicker()) : "location" === t && (n.brief.city = i.city, n.brief.province = i.province, n.$(".region").val(_.uniq(_.compact([n.brief.province, n.brief.city]), !0).join("-")))) : layer.msg(_l("更新信息失败")) }, error: function () { layer.msg(_l("更新信息失败")) }, complete: function () { "birthday" === t && (n.$("#birthday").val(n.brief.birthday), n.toggleBirthdayArrow(), layer.close(n.birthdayLayer)) }, login: { succCallback: this.updateUserInfo.bind(this), cancelCallback: function () { layer.msg(_l("更新信息失败")) } } }) } }) }), define("views/pages/userCenter/userCenter", ["baseView", "templates", "helper", "event", "components/addressBook/userCenterAddressBook", "views/query/list/listSimple", "./setPersonal", "sflayer"], function (e, t, o, i, n, a, s) { var r = { NORMAL: { name: "注册会员", img: "normal" }, COPPER: { name: "铜牌会员", img: "copper" }, SILVER: { name: "银牌会员", img: "silver" }, GOLD: { name: "金牌会员", img: "golden" }, DIAMOND: { name: "钻石会员", img: "diamond" } }; return e.extend({ template: t.userCenter, render: function () { var t = this; sfAjax.getUserInfo({ success: function (e) { e && 0 == e.code ? (t.brief = e.result, t.$el.html(t.template({ mobile: t.brief.mobile, usablePoint: t.brief.usablePoint, memberLevelName: _l(r[t.brief.gradeVal || "NORMAL"].name), memberLevelImg: o.getResourceURL("images/user_center/SFmember_" + r[t.brief.gradeVal || "NORMAL"].img + ".png"), headPhotoUrl: o.getResourceURL("images/user_center/profile-pic.png"), waybillUrl: o.getDynamicURLWithContext("/waybill/") })), t.getUserAvatar(), t.getLatestWaybill(), t.$el.css("min-height", 0)) : t.initNetworkErr() }, error: function () { t.initNetworkErr() }, login: { succCallback: this.render.bind(this), cancelCallback: function () { window.location.href = o.getURLWithContext("/index.html") } } }) }, initNetworkErr: function () { layer.alert(_l("网络错误"), function (e) { layer.close(e), window.history.back(-1) }) }, events: { "click .address-book": "showAddressBook", "click .logout": "logout", "click .try-again": "getLatestWaybill", "click .set-personal": "setPersonal", "click .bill-detail": "goToWaybillStatus" }, getUserAvatar: function () { var t = this; sfAjax.getUserAvatar({ success: function (e) { e && 0 == e.code && (t.headPhotoUrl = e.result, t.$(".head-photo").attr("src", e.result)) }, login: { succCallback: this.getUserAvatar.bind(this), cancelCallback: null } }) }, showAddressBook: function () { if ($.cookie("loginUser")) { var t = this, e = layer.load(); sfAjax.fetchAddressBookList({ data: { pageNo: 1, rowCount: "8", condition: "" }, success: function (e) { e && 0 === e.code ? (new n({ el: t.$(".minor-view"), addressBooks: e.result.content, totalPage: e.result.totalPage, page: e.result.pageNo, callback: t.showMain.bind(t) }), t.showMinor()) : layer.msg(_l("网络错误")) }, error: function () { layer.msg(_l("网络错误")) }, complete: function () { layer.close(e) }, login: { succCallback: this.showAddressBook.bind(this), cancelCallback: null } }) } else i.trigger(i.Needlogin, { succCallback: this.showAddressBook.bind(this), cancelCallback: null }) }, logout: function () { layer.confirm(_l("退出登录"), { btn: [_l("否"), _l("是")] }, function (e) { layer.close(e) }, function (e) { sfAjax.logout({ success: function () { $.cookie("loginUser", null, { path: "/" }), layer.close(e), window.location.href = o.getURLWithContext("/index.html") }, error: function () { layer.msg(_l("网络错误")) } }) }) }, getLatestWaybill: function () { var t = this, e = layer.load(); sfAjax.getLatestWaybills({ success: function (e) { e && 0 == e.code ? 0 < e.result.length ? t.renderLatestWaybills(e.result) : t.getLatestWaybillsEmpty() : t.getLatestWaybillsErr() }, error: function () { t.getLatestWaybillsErr() }, complete: function () { layer.close(e), t.$(".express-status").css("min-height", 0) }, login: { succCallback: this.getLatestWaybill.bind(this), cancelCallback: this.getLatestWaybillsErr.bind(this) } }) }, getLatestWaybillsErr: function () { this.$(".express-status-list").html(t.latestWaybillsErr({ imgUrl: o.getResourceURL("images/waybill/bg_bill_error.png") })) }, renderLatestWaybills: function (e) { a.prototype.handlerWaybillData.apply(this, arguments), this.$(".express-status-list").html(t.latestWaybills({ waybills: e })), this.$(".express-status .search-more").show() }, getLatestWaybillsEmpty: function () { this.$(".express-status-list").html(t.latestWaybillsEmpty({ imgUrl: o.getResourceURL("images/waybill/sf-empty.png"), orderUrl: o.getDynamicURLWithContext("/order/quick/") })) }, judgeWaybillState: function () { }, goToWaybillStatus: function (e) { var t = this.$(e.currentTarget), i = t.data("status"), n = t.data("appointment-statue"), a = t.data("bill-type"), s = t.data("appointmentno"), r = t.data("id"); if (0 < i || "5" == n || "10" == n) { if (o.isNotMyWaybill(a)) return void (location.href = o.getDynamicURLWithContext("/waybill/#search/bill-number/" + r)); location.href = o.getDynamicURLWithContext("/waybill/#search/bill-number/v/" + r) } else location.href = o.getDynamicURLWithContext("/waybill/#search/order/" + s) }, setPersonal: function () { var t = this; new s({ el: this.$(".minor-view"), brief: this.brief, headPhotoUrl: this.headPhotoUrl, changeMobile: function (e) { t.$(".user-phone").text(e) }, callback: this.showMain.bind(this) }), this.showMinor() }, showMinor: function () { var e = this; this.$(".main-view").fadeOut("fast", function () { e.$(".minor-view").fadeIn() }) }, showMain: function () { var e = this; this.$(".minor-view").fadeOut("fast", function () { e.$(".main-view").fadeIn() }) } }) }), define("views/pages/sfCare/sfCareConfig", ["helper"], function (e) { var t = e.getSiteLocation(), i = e.getSiteLanguage(), n = { price: { name: "运费时效", url: "price", icon: "freight-time" }, range: { name: "服务范围", url: "range", icon: "service-area" }, store: { name: "网点查询", url: "store", icon: "net-point" }, accept: { name: "收寄标准", url: "accept", icon: "post-standard" } }; return "cn" === t ? _.extend({ bottomService: { exchange: { name: "汇率查询", url: "more/exchange", icon: "exchange" }, agencyEbill: { name: "代收货款账单", url: "more/agency-ebill", icon: "cod-bills" }, CodEbilling: { name: "代收货款对账", url: "more/COD_Ebilling_System", icon: "cod-checking" }, formDownload: { name: "常用表格", url: "more/formdownload", icon: "useful-forms" }, payment: { name: "理赔", url: "more/payment", icon: "claim", show: function () { return "sc" === i } }, clearance: { name: "清关服务", url: "clearance", icon: "customs-clear", dropdown: { pictureUpload: { name: "清关证件图片上传", url: "clearance_pictureUpload" }, clearanceTax: { name: "税金信息查询(中国)", url: "clearance_tax" }, restrictedDelivery: { name: "进出口规则", url: "restricted_delivery" } } }, lostBill: { name: "无着件公示", url: "more/lost", icon: "miss", show: function () { return "sc" === i } } } }, { topService: n }) : "hk" === t ? _.extend({ bottomService: { exchange: { name: "汇率查询", url: "more/exchange", icon: "exchange" }, airportExpress: { name: "机场速递服务", url: "order/airport_express", icon: "airport" }, customerZone: { name: "客户专区", url: "Customer_Zone", icon: "customer-zone", dropdown: { scheme: { name: "运单填写指引", url: "Scheme" }, eBill: { name: "电子账单", url: "eBill" }, paymentMethod: { name: "多元化付款方式", url: "Payment_Method" }, formDownload: { name: "常用表格", url: "formdownload" } } }, netLocation: { name: "网点地址清单", url: "S.F.Network", icon: "net-location", dropdown: { serviceCenter: { name: "服务中心地址", url: "SF_service_center_address" }, serviceStore: { name: "顺丰站地址", url: "SF_store_address" }, efLocker: { name: "顺便智能柜地址", url: "EF-Locker" }, servicePoints: { name: "顺丰服务点地址", url: "S.F.-Service-Points" } } }, clearance: { name: "清关服务专区", url: "clearance", icon: "customs-clear", dropdown: { pictureUpload: { name: "清关证件图片上传", url: "clearance_pictureUpload" }, clearanceTax: { name: "税金信息查询(中国)", url: "clearance_tax" }, rule: { name: "进出口规则", url: "rule" } } }, packagingPrinciples: { name: "包装原则", url: "more/packaging_principles", icon: "package" }, valuableItem: { name: "易损、易碎、贵重物品类型查询", url: "more/Types_of_Vulnerable_Fragile_Valuable_Item", icon: "fragile" }, ccrnSearch: { name: "海关货物编号查询", url: "more/CcrnSearch", icon: "ccrn-search" } } }, { topService: n }) : "tw" === t ? _.extend({ bottomService: { selfService: { name: "自寄自取件服务", url: "self_service", icon: "self-service", dropdown: { pickUp24: { name: "24小时便利店取件服务", url: "pick_up" }, selfSend24: { name: "24小时便利店寄件服务-中港澳快递", url: "self_send" }, taiwanSend24: { name: "24小时便利店取件服务-台湾宅配", url: "taiwan_send" }, timeSearch: { name: "截单时间查询", url: "time_search" } } }, clearance: { name: "清关服务专区", url: "clearance", icon: "customs-clear", dropdown: { pictureUpload: { name: "清关证件图片上传", url: "clearance_pictureUpload" }, clearanceTax: { name: "税金信息查询(中国)", url: "clearance_tax" }, rule: { name: "进出口规则", url: "rule" } } }, exchange: { name: "汇率查询", url: "more/exchange", icon: "exchange" }, serviceStations: { name: "服务据点资讯", url: "service_stations", icon: "file-outlined", dropdown: { rule: { name: "服务中心", url: "service_center" }, regulation: { name: "理货中心", url: "tally_cente" } } } } }, { topService: n }) : void 0 }), define("views/pages/sfCare/sfCare", ["baseView", "templates", "helper", "./sfCareConfig"], function (e, t, i, n) { return e.extend({ template: t.sfCare, init: function () { $(".care-tips").addClass("sf-care-index"), $(".service-inside-nav").hide(); var i = this; _.each(n.topService, function (e) { i.dealData(e) }), _.each(n.bottomService, function (t) { void 0 === t.dropdown ? i.dealData(t) : (t.name = _l(t.name), _.each(t.dropdown, function (e) { e.url = t.url + "/" + e.url, i.dealData(e) })) }) }, dealData: function (e) { e.name = _l(e.name), e.url = i.getDynamicURLWithContext("/" + e.url + "/") }, render: function () { this.$el.html(this.template({ topService: n.topService, bottomService: n.bottomService })), this.toggleServiceList() }, events: { "click .toggle-service-list": "toggleServiceList" }, toggleServiceList: function () { this.$(".close-toggle-txt").is(":hidden") ? (this.$(".close-toggle-txt").show(), this.$(".open-toggle-txt").hide(), this.$(".more-support").slideDown(500)) : (this.$(".close-toggle-txt").hide(), this.$(".open-toggle-txt").show(), this.$(".more-support").slideUp(500)) } }) }), define("views/pages/sfCare/customsClearance", ["backbone"], function (e) { return e.View.extend({ initialize: function () { var e = /tab=([^&]+)/.exec(location.search); if (e) { var t = e[1] - 1; $(".nav-tabs li").eq(t).addClass("active").siblings().removeClass("active"), $(".tab-pane").eq(t).addClass("active").siblings().removeClass("active") } } }) }), define("views/pages/sfCare/serviceInsideNav", ["baseView", "templates", "helper", "./sfCareConfig"], function (e, t, i, n) { return e.extend({ template: t.serviceInsideNav, init: function () { var i = this; this.allService = [], _.each(n.topService, function (e) { i.dealData(e), i.allService.push(e) }), _.each(n.bottomService, function (t) { void 0 === t.dropdown ? i.dealData(t) : (t.name = _l(t.name), _.each(t.dropdown, function (e) { e.url = t.url + "/" + e.url, i.dealData(e) })), i.allService.push(t) }) }, dealData: function (e) { e.name = _l(e.name), e.url = i.getDynamicURLWithContext("/" + e.url + "/") }, render: function () { this.$el.html(this.template({ allService: this.allService })) } }) }), define("views/pages/feedback/qaConfig", [], function () { return { QAContent: [{ title: "怎么进行批量下单？", content: ["点击“我要寄件”，在填写收件人页面您可以选择添加多个收件人。系统支持从地址簿选择或上传Excel的方式导入多个收件人，导入后如发现有误按请系统提示修改。下单成功后请您打印电子运单二维码，寄件时出示给收派员即可。"], gather: { agree: { name: "第一条问题满意", id: "OWF101102" }, disagree: { name: "第一条问题不满意", id: "OWF101101" } } }, { title: "怎么修改下单信息？", content: ["您登录官网后可在运单追踪—“我寄的”列表中找到您的订单，点击进去可对订单信息进行修改。如您需要修改寄件人信息，可取消下单后，再点击重新下单进行修改。"], gather: { agree: { name: "第二条问题满意", id: "OWF101202" }, disagree: { name: "第二条问题不满意", id: "OWF101201" } } }, { title: "“我寄的”或“我收的”查询不到运单信息？", content: ["请从以下几点判断，", "1、系统仅显示3个月内的运单，请确认运单寄出日期是否超出", "2、是否没有登录顺丰官网；", "3、请确认登录官网的手机号码是否为寄件方/收件方的手机号码，若不是，则在此处无法查询。"], gather: { agree: { name: "第三条问题满意", id: "OWF101302" }, disagree: { name: "第三条问题不满意", id: "OWF101301" } } }, { title: "怎么申请电子发票？", content: ["大部分城市已开通电子发票自助申请，付款方在支付运费约1个工作日后即可通过微信公众号申请：“我”—“我的钱包”—“发票申请”—输入或勾选运单号—申请发票。"], gather: { agree: { name: "第四条问题满意", id: "OWF101402" }, disagree: { name: "第四条问题不满意", id: "OWF101401" } } }, { title: "国际件开通的国家有哪些？", content: ["目前我司已经开通到韩国、美国、泰国、蒙古、越南、澳大利亚、俄罗斯、马来西亚、日本、新加坡、印度尼西亚、柬埔寨、加拿大、墨西哥、缅甸、阿联酋、斯里兰卡、巴基斯坦、菲律宾国家的快递~其它国家地区暂不支持收寄个人件，后续如开通其它国家或地区，会在官网第一时间公布相关信息。", "（注：西藏、玉树藏族自治州、果洛藏族自治州、黄南藏族自治州暂不支持国际件）"], gather: { agree: { name: "第五条问题满意", id: "OWF101502" }, disagree: { name: "第五条问题不满意", id: "OWF101501" } } }, { title: "申请月结需要满足哪些条件？", content: ["申请我司月结的条件为：", "1、有固定的经营场所或居住场所", "2、凡申请按月结计算运费，前一个月结算的运费以及寄件量要求以地区标准为准", "3、在顺丰服务范围内注册的具有独立法人资格的企业、社会团体、持有营业执照的单位及个体户或持有有效证件的个人，且企业或个人信誉度良好", "PS:详情以您所在地区点部核实为准"], gather: { agree: { name: "第六条问题满意", id: "OWF101602" }, disagree: { name: "第六条问题不满意", id: "OWF101601" } } }], TypesOfFeedback: [{ title: "寄快递", type: "0", icon: "package", remarks: "信息填写、地址薄、下单异常等", content: ["收/寄件人信息填写", "快递员上门下单", "自寄下单", "完善快件信息（托寄物、付款方式、保价、增值服务、备注）", "其他"] }, { title: "查快递", type: "1", icon: "search", remarks: "更改派送、路由信息、自寄码等", content: ["查件列表（运单号、运单状态）", "输入运单/扫码查快递", "服务评价", "投诉", "更改派送", "删除运单", "路由显示（地图、文字）", "运单详情", "自寄码", "其他"] }, { title: "其他功能", type: "2", icon: "h-dot", remarks: "会员福利、偏好设置、服务查询等", content: ["运费时效/服务范围/收寄标准查询", "服务网点查询", "偏好设置（派送偏好、消息推送）", "会员福利（积分、会员权益等）", "我的钱包", "投诉理赔", "会员退出/注销", "其他"] }], suggestFunctions: [{ title: "收派服务", icon: "package" }, { title: "包装物料", icon: "package-2" }, { title: "价格发票", icon: "cod-bills" }, { title: "附加服务", icon: "round-add" }, { title: "其他", icon: "h-dot" }] } }), define("views/pages/feedback/submitCommon", ["baseView", "templates", "sf-validate", "verify"], function (e, t, i, n) { return e.extend({ init: function () { this.files = [], this.compressMaxSize = 51200, this.maxSize = 1048576 }, events: { "click .submit": "submit", 'change [type="file"]': "addPic", "click .img-wrapper .img": "previewPic", "click .img-wrapper .delete": "deletePic" }, addFormValidate: function () { var t = this; i(this.$("form"), { onkeyup: function (e) { "textarea" === $(e).attr("name") && (t.$(".textarea-wrapper .no-tip").text($(e).val().length + "/200"), t.changeSubmitBtnStatus()), "name" !== $(e).attr("name") && "contact" !== $(e).attr("name") || $(e).valid() }, rules: { textarea: { required: !0, maxlength: 200 }, name: { maxlength: 20 }, contact: { maxlength: 20 } } }) }, addPic: function (e) { var t = this.$(e.currentTarget); if ("" !== t.val()) { var i = t[0].files[0]; n.isRegularExtension(["jpg", "png", "jpeg", "gif"], i.name) ? this.readImg(i) : layer.alert(_l("图片格式不正确，仅支持jpg、png、jpeg或gif格式的图片,请重新上传")), t.val("") } }, readImg: function (e) { this.readerIndex = layer.load(); var t = new FileReader; t.readAsDataURL(e); var i = this; t.onload = function () { i.compressImage(this.result, e) }, t.onerror = function () { layer.close(i.readerIndex) } }, compressImage: function (n, a) { var s = a.size; if (s < this.compressMaxSize) return this.storeImg(n, n, a), void layer.close(this.readerIndex); var e = new Image; e.src = n; var r = this; e.onload = function () { try { var e = document.createElement("canvas"); e.width = this.width, e.height = this.height, e.getContext("2d").drawImage(this, 0, 0, this.width, this.height); var t = r.compressMaxSize / s; .5 < t ? t = .5 : t < .01 && (t = .01); var i = e.toDataURL(a.type, t); r.storeImg(n, i, a), layer.close(r.readerIndex) } catch (e) { r.storeErrImg(n, a), layer.close(r.readerIndex) } }, e.onerror = function () { layer.close(r.readerIndex) } }, base64ToBlob: function (e) { for (var t = e.split(","), i = t[0].match(/:(.*?);/)[1], n = atob(t[1]), a = n.length, s = new Uint8Array(a); a--;)s[a] = n.charCodeAt(a); return new Blob([s], { type: i }) }, storeImg: function (e, t, i) { var n = this.base64ToBlob(t); if (n.size > i.size) this.storeErrImg(e, i); else if (n.size > this.maxSize) layer.alert(_l("图片文件过大，请从新上传")); else { var a = { id: this.files.length, name: i.name, originalBase64: e, processedBlob: n }; this.files.push(a), this.showThumbnail(a) } }, storeErrImg: function (e, t) { if (t.size > this.maxSize) layer.alert(_l("图片文件过大，请从新上传")); else { var i = { id: this.files.length, originalBase64: e, file: t }; this.files.push(i), this.showThumbnail(i) } }, showThumbnail: function (e) { 5 <= this.files.length && this.$(".file-wrapper").hide(), this.$(".file-wrapper").before(t.feedbackImgWrapper({ imgUrl: e.originalBase64 || Helper.getResourceURL("images/common/picErr.png"), id: e.id })) }, previewPic: function (e) { layer.open({ type: 1, title: !1, closeBtn: 0, area: "500px", shadeClose: !0, skin: "only-img", content: $(e.currentTarget).siblings("img") }) }, deletePic: function (i) { var n = this; layer.confirm(_l("确定取消上传该图片吗？"), { btn: [_l("确定"), _l("取消")] }, function (e) { var t = n.$(i.currentTarget).data("id"); n.files = _.reject(n.files, function (e) { return e.id === t }), layer.close(e), n.$(i.currentTarget).parents(".img-wrapper").remove(), n.files.length < 5 && n.$(".file-wrapper").show() }) }, submit: function () { if (5 < this.files.length) layer.alert("最多选择5张截图"); else if (this.$("form").validate().form()) if (this.photoUrls = {}, 0 == this.files.length) this.postSuggestion(); else { var i = this, t = new FormData; _.each(this.files, function (e) { e.processedBlob ? t.append("files", e.processedBlob, e.name) : t.append("files", e.file) }); var e = layer.load(); sfAjax.feedBackUpload({ basePath: Helper.getUcmpWx(), dataType: "json", data: t, contentType: !1, cache: !1, processData: !1, success: function (e) { e.success ? (_.each(e.obj, function (e, t) { i.photoUrls["photoUrl" + (t + 1)] = e }), i.postSuggestion()) : layer.msg("网络错误") }, error: function () { layer.msg("网络错误") }, complete: function () { layer.close(e) } }) } }, postSuggestion: function () { var e = layer.load(), t = this; sfAjax.postSuggestion({ data: _.extend({ typeOne: this.typeOne, typeTwo: this.typeTwo, typeThree: this.typeThree, remark: this.$('[name="textarea"]').val(), name: this.$('[name="name"]').val(), mobile: this.$('[name="contact"]').val() }, this.photoUrls), success: function () { t.options.callback() }, error: function () { layer.msg("网络错误") }, login: { succCallback: this.postSuggestion.bind(this), cancelCallback: null }, complete: function () { layer.close(e) } }) } }) }), define("views/pages/feedback/suggestion/index", ["../submitCommon", "templates", "../qaConfig"], function (e, t, i) { return e.extend({ template: t.suggestionSubmit, init: function () { e.prototype.init.apply(this, arguments), this.typeOne = "建议", this.typeThree = "" }, render: function () { this.$el.html(this.template({ suggestFunctions: i.suggestFunctions })), this.setElement(this.$(".suggestion-submit")), this.addFormValidate() }, events: _.extend({ "click .sf-new-capsule a": "chooseSuggestionType" }, e.prototype.events), chooseSuggestionType: function (e) { this.$(e.currentTarget).addClass("active").siblings().removeClass("active"), this.typeTwo = this.$(e.currentTarget).text(), this.changeSubmitBtnStatus() }, changeSubmitBtnStatus: function () { this.$(".sf-new-capsule a").hasClass("active") && "" !== this.$('[name="textarea"]').val() ? this.$(".submit").removeClass("disabled") : this.$(".submit").addClass("disabled") } }) }), define("views/pages/feedback/question/index", ["../submitCommon", "templates"], function (e, t) { return e.extend({ template: t.questionSubmit, init: function () { e.prototype.init.apply(this, arguments), this.typeOne = "问题", this.typeTwo = this.options.questionType.title, this.typeThree = this.options.questionType.content[this.options.typeIndex] }, render: function () { this.$el.html(this.template({ typeThree: this.typeThree })), this.setElement(this.$(".question-submit")), this.addFormValidate() }, changeSubmitBtnStatus: function () { "" !== this.$('[name="textarea"]').val() ? this.$(".submit").removeClass("disabled") : this.$(".submit").addClass("disabled") } }) }), define("views/pages/feedback/index", ["baseView", "templates", "./qaConfig", "./suggestion/index", "./question/index", "helper"], function (e, t, n, i, a, s) { return e.extend({ template: { index: t.feedbackIndex, topQuestions: t.topQuestions, topAnswers: t.topAnswers, questionType: t.questionType, subdivisionQuestion: t.subdivisionQuestion, feedbackSucc: t.feedbackSucc }, render: function () { this.$el.html(this.template.index()).css("height", "auto"), this.$(".first").html(this.template.topQuestions({ QAContent: n.QAContent })) }, events: { "click .top-questions a": "showAnswer", "click .top-answers .options a": "chooseUseful", "click .suggestion": "showSuggestionSubmit", "click .question": "showQuestion", "click .feedback-questionType a": "showSubdivisionQuestion", "click .subdivision-question a": "showQuestionSubmit", "click .second .back": "showFirst", "click .third .back": "showSecond", "click .fourth .back": "showThird" }, showPage: function (e) { this.$(".first,.second,.third,.fourth").hide(), this.$("." + e).fadeIn("fast") }, showFirst: function () { this.showPage("first") }, showSecond: function () { this.showPage("second") }, showThird: function () { this.showPage("third") }, showAnswer: function (e) { var i = this.$(e.currentTarget).data("index"), t = _.find(n.QAContent, function (e, t) { return t == i }); this.$(".second").html(this.template.topAnswers({ data: t })), this.showPage("second") }, showSuggestionSubmit: function () { new i({ el: this.$(".second"), callback: this.showSucc.bind(this) }), this.showPage("second") }, showQuestion: function () { this.$(".second").html(this.template.questionType({ questionTypeList: n.TypesOfFeedback })), this.showPage("second") }, showSubdivisionQuestion: function (e) { var t = this.$(e.currentTarget).data("type"); this.questionType = _.find(n.TypesOfFeedback, function (e) { return e.type == t }), this.$(".third").html(this.template.subdivisionQuestion({ subdivision: this.questionType.content })), this.showPage("third") }, showQuestionSubmit: function (e) { new a({ el: this.$(".fourth"), questionType: this.questionType, typeIndex: this.$(e.currentTarget).data("index"), callback: this.showSucc.bind(this) }), this.showPage("fourth") }, chooseUseful: function (e) { if (!this.$(".top-answers .options a").hasClass("active")) { var t = this.$(e.currentTarget); t.addClass("active"), sfgather.trackClicks(t.data("name"), t.data("id")) } }, showSucc: function () { this.$el.html(this.template.feedbackSucc({ imgUrl: s.getResourceURL("images/waybill/bg_bill_succ.png"), indexUrl: s.getURLWithContext("index.html") })) } }) }), define("views/pages/home/queryBillInput", ["backbone", "tokenfield", "helper", "utils/checkUtils", "jquery-placeholder"], function (e, t, i, a) { return e.View.extend({ events: { "mouseout .tokenfield.form-control": "stopPropagation", "focusin input.token-input": "setInputToken", "focusout input.token-input": "setInputToken", "click .submit.primary-button": "queryBillNumbersandPhone", "click .form-wrap .icon a": "setInputToken", "click .phone .icon a": "queryBillNumbersByPhone", "click .nearlyWaybillNO": "fillBillNOAndQuery", "click .uploadAddBook .button": "linkToAddressBookPageEvent" }, initialize: function () { this.$el.addClass("inithack"); var e = this.$(".bill-numbers-input").attr("placeholder"); this.setupTokenField(this.$(".bill-numbers-input"), e), this.$el.find(".tokenfield").find(".token")[0] && this.$el.find(".tokenfield").find(".token").remove(), this.$el.removeClass("inithack") }, setInputToken: function (e) { var t = this; "focusin" === e.type || "click" === e.type ? (this.$(e.target).data("input-status", !0), this.$el.find(".bill-number").removeClass("folded"), 0 < i.getArrayFromCookie("billNOs").length && this.$el.find(".nearlyWaybill").find(".nearlyWaybillNO").data("bill", i.getArrayFromCookie("billNOs")[0]).html(i.getArrayFromCookie("billNOs")[0]).end().show()) : (this.$(e.target).data("input-status", !1), this.$el.find(".token").length || this.$el.find(".token-input").val() || setTimeout(function () { t.$el.find(".tokenfield.form-control").hasClass("focus") || (t.$el.find(".bill-number").addClass("folded"), t.$el.find(".nearlyWaybill").hide()) }, 200)) }, fillBillNOAndQuery: function (e) { window.location.href = i.getDynamicURLWithContext("/waybill/#search/bill-number/" + $(e.target).data("bill")) }, linkToAddressBookPageEvent: function (e) { sfgather.trackClicks("点击一键导入", "105001") }, stopPropagation: function (e) { e.stopPropagation() }, placeHolderToggle: function () { if (0 === this.inputedBillNumbers().length) { var e = this.$(".tokenfield.form-control"), t = this.$(".token-input"), i = e.offset().left + e.width() + parseInt(e.css("padding-left"), 10) - t.offset().left - 1; t.attr("placeholder", this.placeholder).width(i).placeholder() } else this.$(".token-input").attr("placeholder", "").removeClass("placeholder") }, setupTokenField: function (e, t) { this.placeholder = t; var i = this; this.$tokenfield = e; var n = function () { window.setTimeout(function () { i.validateBillNumbersInput() }, 0) }; i.$tokenfield.attr("placeholder", t).on("tokenfield:removetoken", function () { i.$(".error[data-error=limit-exceeded]").hide(), i.placeHolderToggle(), i.inputValidate() && i.$(".error[data-error=bill-number-format]").hide(), i.validateBillNumbersInput() }).on("tokenfield:createtoken", function (e) { a.billNumber(e.token.value) || $(e.relatedTarget).addClass("invalid"), i.placeHolderToggle(), n() }).on("tokenfield:preventduplicate", function () { window.setTimeout(function () { i.$(".error[data-error=bill-number-format]").show() }, 200) }).on("tokenfield:edittoken", function () { i.$(".token-input").on("blur", function () { n() }).on("keyup", function (e) { e.currentTarget.value.length || (i.placeHolderToggle(), n()) }) }).tokenfield({ createTokensOnBlur: !0, delimiter: [",", "\n", "\t", " ", "，"], limit: 20, minWidth: 90, leakCallback: function () { i.$(".token-input").val(""), i.$(".error[data-error=limit-exceeded]").show() } }), i.$(".token-input").attr("placeholder", t).placeholder() }, inputedBillNumbers: function () { var t; try { t = this.$tokenfield.tokenfield("getTokensList").split(",") } catch (e) { t = this.$tokenfield.tokenfield("getTokensList").val().split(",") } return t = _.map(t, function (e) { return e.trim().toUpperCase() }), _.compact(t) }, hasInputs: function () { var t = !1; return _.each(this.inputedBillNumbers(), function (e) { e.length && (t = !0) }), t }, hasPhoneNumInputs: function () { var e = !1; return "" != $(".quick-tool .phone input").val() && (e = !0), e }, inputValidate: function () { return a.billNumbers(this.inputedBillNumbers()) }, inputPhoneValidate: function () { var e = $(".quick-tool .phone input").val(); return "" == e || i.isValidPhoneNumber(e) }, validateBillNumbersInput: function () { this.inputValidate() ? this.$(".error[data-error=bill-number-format]").hide() : this.$(".error[data-error=bill-number-format]").show(), this.updateQueryButtonStatus() }, updateQueryButtonStatus: function () { null != $(".quick-tool .phone input").val() ? !this.inputValidate() && !this.hasPhoneNumInputs() || !this.inputValidate() && !this.inputPhoneValidate() || !this.hasInputs() && !this.inputPhoneValidate() ? this.$("button").addClass("disabled") : this.$("button").removeClass("disabled") : this.inputValidate() ? this.$("button").removeClass("disabled") : this.$("button").addClass("disabled") }, queryBillNumbersandPhone: function () { sfgather.trackClicks("点击查询", "116003"); var e = $(".quick-tool .phone input").val(); if (null != e) { if (!this.inputValidate() && !this.hasPhoneNumInputs() || !this.inputValidate() && !this.inputPhoneValidate() || !this.hasInputs() && !this.inputPhoneValidate()) return; !this.hasInputs() && this.inputPhoneValidate() && this.hasPhoneNumInputs() || !this.inputValidate() && this.inputPhoneValidate() && this.hasPhoneNumInputs() ? window.location.href = i.getDynamicURLWithContext("/waybill/#search/phone-number/" + e) : window.location.href = i.getDynamicURLWithContext("/waybill/#search/bill-number/" + this.inputedBillNumbers().join(",")) } else { if (!this.inputValidate()) return; window.location.href = i.getDynamicURLWithContext("/waybill/#search/bill-number/" + this.inputedBillNumbers().join(",")) } }, queryBillNumbersByPhone: function () { var e = $(".quick-tool .phone input").val(); this.inputPhoneValidate() && (window.location.href = i.getDynamicURLWithContext("/waybill/#search/phone-number/" + e)) } }) }), define("views/pages/home/moveContent", ["backbone"], function (e) { return e.View.extend({ events: { "click .nav a": "tabSwitch" }, initialize: function () { this.$(".nav a").attr("aria-pressed", "false") }, tabSwitch: function (e) { e.preventDefault(), this.$(".nav li").removeClass("active").find("a").attr("aria-pressed", "false"), this.$(e.currentTarget).parent().addClass("active").end().attr("aria-pressed", "true"), this.$(".nav-content").removeClass("tab-open"), this.$(this.$(e.currentTarget).attr("href")).addClass("tab-open") } }) }), define("views/pages/home/index", ["./queryBillInput", "./moveContent"], function (e, t) { return Backbone.View.extend({ initialize: function () { new e({ el: this.$("#small-header .quick-tool") }), 0 < $(".move-content").length && new t({ el: $(".index-page .move-content") }) } }) }), define("views/pages/cooperativeAdvisory/index", ["backbone", "templates", "jquery", "helper", "components/detailedLocationPicker/amapPicker", "components/detailedLocationPicker/picker", "sflayer"], function (i, e, a, s, t, n, r) { var o = { companyName: { require: "客户名称未填写", maxLength: [50, "客户名称超出长度范围"] }, companyRegion: { require: "客户区域未填写" }, companyAddress: { require: "客户详细地址未填写", maxLength: [128, "客户详细地址超出长度范围"] }, contacts: { require: "联系人姓名未填写", maxLength: [32, "联系人姓名超出长度范围"] }, contactsMobile: { require: "联系人手机未填写", regex: [/^[1][3,4,5,7,8][0-9]{9}$/, "联系人手机不符合手机格式"] }, contactsTel: { regex: [/^0\d{2,3}-[1-9]\d{6,7}(-\d{3,5})?$/, "联系人座机不符合电话格式"] }, potentialIncomeStr: { require: "每月顺丰快递费未填写", regex: [/^([1-9]\d{0,8}|1000000000)$/, "每月顺丰快递费超出长度规定"] }, code: { require: "您输入的验证码不能为空" }, policy: { checked: "必须同意隐私声明" } }, l = { 0: { tip: "无效手机号码" }, 1: { status: "common", tip: "您的合作申请需求我司已在跟进中，请您耐心等待，谢谢！" }, 2: { status: "common", tip: "您的月结申请未成功，如有问题请与客户经理联系（客户经理${managerName}、电话${managerPhone}），谢谢！" }, 3: { status: "common", tip: "您的月结申请已在办理中，如有问题请与客户经理联系（客户经理${managerName}、电话${managerPhone}），谢谢！" }, 4: { status: "continue", tip: "您在${clueCloseTime}申请我司月结未成功，是否继续申请？" }, 5: { status: "continue", tip: "您已是月结卡号尾数为${cardTailNum}的月结客户，如有问题请与客户经理联系（客户经理${managerName}、电话${managerPhone}），是否继续申请？" }, 6: { status: "success", tip: "销售人员将会尽快与您取得联系，近期请留意接听来电" }, 7: { status: "continue", tip: "您的月结申请已在办理中，如有问题请与客户经理联系（客户经理${managerName}、电话${managerPhone}），是否继续申请？" } }; return i.View.extend({ events: { "click .select p": "openCooperativeType", "click .select li": "chooseCooperativeType", "click #validation-image": "refreshValidationCode", "click .r-btn-a": "sumitApplication", "click .continue-btn": "sumitApplication", "blur input.text": "txtBlur", "focus input.text": "txtFocus", "change #policy": "policyChange", "regionModelUpdate .detail-location-input": "regionModelUpdate" }, initialize: function () { this.refreshValidationCode(), this.location = new n({ el: this.$(".detail-location-input") }), this.AmapPicker = new t({ el: this.$("#companyAddress").parent(), location: this.location }) }, txtBlur: function (e) { var t = a(e.currentTarget), i = t.attr("id"); this.subValidate(t.parents(".subclass"), o[i], t.val().trim()), "companyAddress" === i && this.subValidate(a(".company-region"), o.companyRegion, a("#companyRegion").val().trim()) }, txtFocus: function (e) { this.hideError(a(e.currentTarget).parents(".subclass")) }, openCooperativeType: function (e) { a(e.currentTarget).parent().toggleClass("active") }, chooseCooperativeType: function (e) { var t = a(e.currentTarget); t.parents(".select").removeClass("active").find("p").text(t.text()), a("#businessSegment").val(t.data("business-type")) }, policyChange: function () { this.subValidate(a(".require-policy"), o.policy, a("#policy").prop("checked")) }, regionModelUpdate: function (e, t) { this.add_location = this.getLocationData(t.regionTabs) || {}, this.subValidate(a(".company-region"), o.companyRegion, "1") }, showError: function (e, t) { var i = a(a(".error-prompt-template").html()); i.children("span").text(_l(t)), e.append(i), e.find(".input").addClass("s-prompt") }, hideError: function (e) { e.find(".error-prompt").remove(), e.find(".input").removeClass("s-prompt") }, refreshValidationCode: function () { a("#code").val(""); var e = s.getRESTfulDomain("captcha/sasp?force=true&time=" + (new Date).getTime()); a("#validation-image").length && a("#validation-image").attr("src", e) }, getLocationData: function (e) { var t, i, n, a, s, r; return 2 === (e = _.filter(e, function (e) { return e.selectedRegion })).length ? (t = e[0].selectedRegion.distId, i = e[1].selectedRegion.parentId, n = e[1].selectedRegion.distId, a = e[1].selectedRegion.rateCode, s = e[0].selectedRegion.name, r = e[1].selectedRegion.name) : 3 === e.length && (t = e[0].selectedRegion.distId, i = e[1].selectedRegion.distId, n = e[2].selectedRegion.distId, a = e[2].selectedRegion.rateCode, s = e[1].selectedRegion.name, r = e[2].selectedRegion.name), { provinceId: t, cityId: i, districtId: n, cityCode: a, cityName: s, districtName: r } }, subValidate: function (e, t, i) { if (t) { var n = ""; this.hideError(e), t.require && "" === i && (n = t.require), t.checked && !i && (n = t.checked), t.maxLength && i.length > t.maxLength[0] && (n = t.maxLength[1]), "" !== i && t.regex && !t.regex[0].test(i) && (n = t.regex[1]), n && this.showError(e, n) } }, validateAll: function () { var i = this; a(".subclass").each(function () { var e = a(this).find("input[type='text']"), t = a(this).find("input[type='checkbox']"); e.length ? i.subValidate(a(this), o[e.attr("id")], e.val().trim()) : t.length && i.subValidate(a(this), o[t.attr("id")], t.prop("checked")) }) }, sumitApplication: function (e) { if (this.validateAll(), 1 === a(".error-prompt").length) { var t = { isResubmit: a(e.currentTarget).hasClass("continue-btn"), companyName: a("#companyName").val(), companyAddress: a("#companyAddress").val(), contacts: a("#contacts").val(), contactsMobile: a("#contactsMobile").val(), contactsTel: a("#contactsTel").val(), potentialIncomeStr: a("#potentialIncomeStr").val(), clueSubmitPeople: a("#clueSubmitPeople").val(), businessSegment: a("#businessSegment").val(), clueSource: 1958, remark: a("#remark").val(), lang: s.getSiteLanguage() }; _.extend(t, this.add_location), this.saveCooperativeAjax(t, a("#code").val()) } }, saveCooperativeAjax: function (e, t) { var n = this; i.ajax({ type: "POST", contentType: "application/json", url: s.getRESTfulDomain("sasp/collectedInformation?app=sasp&answer=" + t), data: JSON.stringify(e), success: function (e) { if (a(".submit-result").hide(), "true" === e.success) { var t = e.obj, i = l[t.status]; switch (a("." + i.status).show().find(".tip").html(n.getTip(_l(i.tip), t)), i.status) { case "continue": a(".submit-wrap").hide(), n.refreshValidationCode(); break; case "success": case "common": a(".content form").hide(); break; default: a(".prompt2").text(_l(t.tips)) } } else a(".r-btn-b").show(), n.refreshValidationCode(), setTimeout("$('.r-btn-b').hide()", 3e3) }, error: function (e) { 403 === e.status ? n.showError(a(".verification-code"), _l("您输入的验证码有误，请重新输入")) : (a(".r-btn-b").css("width", "220px").text(_l("网络异常，请稍后再试！")).show(), setTimeout("$('.r-btn-b').hide()", 3e3)), n.refreshValidationCode() } }) }, getTip: function (e, t) { for (var i in t) e = e.replace("${" + i + "}", t[i]); return e } }) }), define("views/pages/cooperativeAdvisory/cooperativeAdvisoryForKR", ["backbone", "templates", "jquery", "helper"], function (n, e, a, s) { return n.View.extend({ events: { "click .select p": "openContactTitleType", "click .select a": "chooseContactTitleType", "click #validation-image": "refreshValidationCode", "blur .contact-name input.text": "inputChangedByContactName", "blur .require-company input.text": "inputChangedByCompanyName", "blur .mobile input.text": "inputChangedByMobile", "blur .require-mail input.text": "inputChangedByMail", "blur .require-enquiry textarea.enquiry": "inputChangedByEnquiry", "click .r-btn-a": "sumitApplication", "click .require-policy input.policy": "agreePrivacy", "focus .contact-name input.text, .mobile input.text, .require-mail input.text, .require-company input.text, .require-enquiry textarea.enquiry ": "hideErrorPrompt", "focus #code": "hideValidcodeErrorPrompt" }, initialize: function () { this.errorCode = [], this.defaultTitleType(), this.refreshValidationCode() }, defaultTitleType: function () { a(".subclass .input").removeClass("s-prompt"), a(".validation-code").siblings(".input").find(".error-prompt").hide(), a("form")[0].reset(), this.showSubmitBtn(), this.setDefaultTitleType() }, showSubmitBtn: function () { a(".r-btn-b").hide(), a(".submit-bottom .r-prompt").hide(), a(".r-btn-a").show() }, setDefaultTitleType: function () { var e = a("ul.type-down").children().first().find("a").data("title-type"), t = a("ul.type-down").children().first().find("a").text(); a("#title-type").data("title-type", e), a("#title-type").val(t) }, openContactTitleType: function (e) { a(e.currentTarget).parent().toggleClass("active"), a(e.currentTarget).parent().siblings().removeClass("active") }, chooseContactTitleType: function (e) { var t = a(e.currentTarget), i = t.html(), n = t.data("title-type"); t.parent().parent().parent().removeClass("active"), t.parent().parent().siblings("p").html("").append(i), a("#title-type").data("titleType", n), a("#title-type").val(i), a(".r-btn-a").show(), a(".submit-bottom .r-prompt").hide(), a(".input").find("input").val(""), a(".textarea").find("textarea").val(""), this.refreshValidationCode() }, hideErrorPrompt: function (e) { var t = a(e.currentTarget); t.parent().removeClass("s-prompt"), t.parent().children(".error-prompt").hide() }, hideValidcodeErrorPrompt: function () { a(".validation-code-prompt").hide() }, agreePrivacy: function (e) { a(e.currentTarget).attr("checked") ? a(".require-policy .error-prompt").hide() : a(".require-policy .error-prompt").show() }, refreshValidationCode: function () { var e = this.$("#validation-image"), t = s.getRESTfulDomain("captcha/pms?force=true&time=" + (new Date).getTime()); e && e.attr("src", t) }, inputChangedByContactName: function (e) { var t = a.trim(a(e.currentTarget).val()); "" == t || null == t ? (a(".contact-name .error-prompt").prop("lastChild").nodeValue = _l("您的姓名不可为空"), a(".contact-name .error-prompt").show(), a(".contact-name .input").addClass("s-prompt")) : a(".contact-name .input").removeClass("s-prompt") }, inputChangedByCompanyName: function (e) { var t = a.trim(a(e.currentTarget).val()); "" == t || null == t ? (a(".require-company .error-prompt").prop("lastChild").nodeValue = _l("公司名称不可为空"), a(".require-company .error-prompt").show(), a(".require-company .input").addClass("s-prompt")) : a(".require-company .input").removeClass("s-prompt") }, inputChangedByMobile: function (e) { var t = a.trim(a(e.currentTarget).val()), i = s.isValidPhoneNumber(t); "" == t || null == t ? (a(".mobile .error-prompt").prop("lastChild").nodeValue = _l("您的联系电话不可为空"), a(".mobile .error-prompt").show(), a(".mobile .input").addClass("s-prompt")) : i ? a(".mobile .input").removeClass("s-prompt") : (a(".mobile .error-prompt").prop("lastChild").nodeValue = _l("您输入联系电话有误，请重新输入"), a(".mobile .error-prompt").show(), a(".mobile .input").addClass("s-prompt")) }, inputChangedByMail: function (e) { var t = a.trim(a(e.currentTarget).val()), i = s.isValidMailAddr(t); "" == t || null == t ? (a(".require-mail .error-prompt").prop("lastChild").nodeValue = _l("邮箱地址不可为空"), a(".require-mail .error-prompt").show(), a(".require-mail .input").addClass("s-prompt")) : i ? a(".require-mail .input").removeClass("s-prompt") : (a(".require-mail .error-prompt").prop("lastChild").nodeValue = _l("邮箱地址格式有误"), a(".require-mail .error-prompt").show(), a(".require-mail .input").addClass("s-prompt")) }, inputChangedByEnquiry: function (e) { var t = a.trim(a(e.currentTarget).val()); "" == t || null == t ? (a(".require-enquiry .error-prompt").prop("lastChild").nodeValue = _l("咨询内容不可为空"), a(".require-enquiry .error-prompt").addClass("textArea"), a(".require-enquiry .error-prompt").show(), a(".require-enquiry .textarea").addClass("s-prompt")) : (a(".require-enquiry .error-prompt").removeClass("textArea"), a(".require-enquiry .textarea").removeClass("s-prompt")) }, sumitApplication: function () { var e, t = a("#code").val(); this.checkContactName() && this.checkCompanyName() && this.checkMobile() && this.checkMobileReg() && this.checkMail() && this.checkMailReg() && this.checkEnquiry() && this.checkValidCode() && this.checkPrivacyPolicy() && (e = { customerName: a("input[name='user']").val(), companyName: a("input[name='companyName']").val(), industry: a("input[name='industry']").val(), tel: a("input[name='mobile']").val(), email: a("input[name='mail']").val(), city: a("input[name='city']").val(), countryCode: s.getSiteLocation(), lang: s.getSiteLanguage(), message: a("textarea[name='enquiry']").val(), countryInput: a("input[name='country']").val(), source: "CE", isRecMsg: "gb" == s.getSiteLocation() || "fr" == s.getSiteLocation() || "de" == s.getSiteLocation() ? 1 == a("#marketing-info").prop("checked") ? "1" : "0" : "" }, this.saveCooperativeAjax(e, t)) }, saveCooperativeAjax: function (e, t) { var i = this; n.ajax({ type: "POST", contentType: "application/json", url: s.getRESTfulDomain("pms/collectedInformation?app=pms&answer=" + t), data: JSON.stringify(e), success: function (e) { if ("WS_PC_01" === e.resultStr && (a(".r-btn-a").hide(), a(".submit-bottom .r-prompt").show()), "WS_PC_02" === e.resultStr || "WS_PC_03" === e.resultStr || "WS_PC_04" === e.resultStr) { a(".r-btn-b").show(), a(".validation-code-prompt").hide(), i.refreshValidationCode(); setTimeout("$('.r-btn-b').hide()", 3e3) } }, error: function (e) { 403 === e.status ? (a(".validation-code-prompt").prop("lastChild").nodeValue = _l("您输入的验证码有误，请重新输入"), a(".validation-code-prompt").show()) : (a(".r-btn-b").text(_l("网络异常，请稍后再试！")), a(".r-btn-b").css("width", "220px"), a(".r-btn-b").show(), setTimeout("$('.r-btn-b').hide()", 3e3)), i.refreshValidationCode() } }) }, checkValidCode: function () { var e = a("#code").val(); return "" != e && null != e || (a(".validation-code-prompt").prop("lastChild").nodeValue = _l("您输入的验证码不能为空"), a(".validation-code-prompt").show(), !1) }, checkContactName: function () { var e = a.trim(a(".contact-name input").val()); return "" != e && null != e || (a(".contact-name .error-prompt").prop("lastChild").nodeValue = _l("您的姓名不可为空"), a(".contact-name .input").addClass("s-prompt"), !1) }, checkCompanyName: function () { var e = a.trim(a(".require-company input").val()); return "" != e && null != e || (a(".require-company .error-prompt").prop("lastChild").nodeValue = _l("公司名称不可为空"), a(".require-company .input").addClass("s-prompt"), !1) }, checkMobile: function () { var e = a.trim(a(".mobile input").val()); return "" != e && null != e || (a(".mobile .error-prompt").prop("lastChild").nodeValue = _l("您的联系电话不可为空"), a(".mobile .input").addClass("s-prompt"), !1) }, checkMobileReg: function () { var e = a.trim(a(".mobile input").val()); return !!s.isValidPhoneNumber(e) || (a(".mobile .error-prompt").prop("lastChild").nodeValue = _l("您输入联系电话有误，请重新输入"), a(".mobile .input").addClass("s-prompt"), !1) }, checkMail: function () { var e = a.trim(a(".require-mail input").val()); s.isValidMailAddr(e); return "" == e || null == e ? (a(".require-mail .error-prompt").prop("lastChild").nodeValue = _l("邮箱地址不可为空"), a(".require-mail .input").addClass("s-prompt"), !1) : (a(".require-mail .input").removeClass("s-prompt"), !0) }, checkMailReg: function () { var e = a.trim(a(".require-mail input").val()); return s.isValidMailAddr(e) ? (a(".require-mail .input").removeClass("s-prompt"), !0) : (a(".require-mail .error-prompt").prop("lastChild").nodeValue = _l("邮箱地址格式有误"), a(".require-mail .input").addClass("s-prompt"), !1) }, checkEnquiry: function () { var e = a.trim(a(".require-enquiry textarea").val()); return "" == e || null == e ? (a(".require-enquiry .error-prompt").prop("lastChild").nodeValue = _l("咨询内容不可为空"), a(".require-enquiry .error-prompt").addClass("textArea"), a(".require-enquiry .error-prompt").show(), a(".require-enquiry .textarea").addClass("s-prompt"), !1) : (a(".require-enquiry .error-prompt").removeClass("textArea"), a(".require-enquiry .textarea").removeClass("s-prompt"), !0) }, checkPrivacyPolicy: function () { return a("#policy").attr("checked") ? (a(".require-policy .checkbox").removeClass("s-prompt"), !0) : (a(".require-policy .error-prompt").show(), a(".require-policy .checkbox").addClass("s-prompt"), !1) } }) }), define("views/pages/feedbackAndSuggestion/feedbackAndSuggestionForKR", ["backbone", "templates", "jquery", "helper"], function (i, e, a, n) { return i.View.extend({ events: { "click .select p": "openContactTitleType", "click .select .about a": "chooseSuggestionsAbout", "blur .contact-name input.text": "inputChangedByContactName", "blur .mobile input.text": "inputChangedByMobile", "blur .require-mail input.text": "inputChangedByMail", "blur .require-suggestion textarea.suggestion": "inputChangedBySuggestion", "click .r-btn-a": "submitForm", "click .require-policy input.policy": "agreePrivacy", "focus .contact-name input.text, .mobile input.text, .require-mail input.text, .require-suggestion textarea.suggestion ": "hideErrorPrompt", "focus #code": "hideValidcodeErrorPrompt" }, initialize: function () { this.errorCode = [], this.setDefaultValue() }, setDefaultValue: function () { a(".subclass .input").removeClass("s-prompt"), a("form")[0].reset(), this.showSubmitBtn(), this.setDefaultSuggestionAbout() }, showSubmitBtn: function () { a(".r-btn-b").hide(), a(".submit-bottom .r-prompt").hide(), a(".r-btn-a").show() }, setDefaultSuggestionAbout: function () { var e = a("ul.about").children().first().find("a").data("suggestion-type"), t = a("ul.about").children().first().find("a").text(); a("#suggestion-type").data("suggestion-type", e), a("#suggestion-type").val(t) }, openContactTitleType: function (e) { a(e.currentTarget).parent().toggleClass("active"), a(e.currentTarget).parent().siblings().removeClass("active") }, chooseSuggestionsAbout: function (e) { var t = a(e.currentTarget), i = t.html(), n = t.data("suggestion-type"); t.parent().parent().parent().removeClass("active"), t.parent().parent().siblings("p").html("").append(i), a("#suggestion-type").data("suggestion-type", n), a("#suggestion-type").val(i) }, hideErrorPrompt: function (e) { var t = a(e.currentTarget); t.parent().removeClass("s-prompt"), t.parent().children(".error-prompt").hide() }, hideValidcodeErrorPrompt: function () { a(".validation-code-prompt").hide() }, agreePrivacy: function (e) { a(e.currentTarget).attr("checked") ? a(".require-policy .error-prompt").hide() : a(".require-policy .error-prompt").show() }, refreshValidationCode: function () { var e = this.$("#validation-image"), t = n.getRESTfulDomain("captcha/pms?force=true&time=" + (new Date).getTime()); e && e.attr("src", t) }, inputChangedByContactName: function (e) { var t = a.trim(a(e.currentTarget).val()); "" == t || null == t ? (a(".contact-name .error-prompt").prop("lastChild").nodeValue = _l("您的姓名不可为空"), a(".contact-name .error-prompt").show(), a(".contact-name .input").addClass("s-prompt")) : a(".contact-name .input").removeClass("s-prompt") }, inputChangedByMobile: function (e) { var t = a.trim(a(e.currentTarget).val()), i = n.isValidPhoneNumber(t); "" == t || null == t ? (a(".mobile .error-prompt").prop("lastChild").nodeValue = _l("您的联系电话不可为空"), a(".mobile .error-prompt").show(), a(".mobile .input").addClass("s-prompt")) : i ? a(".mobile .input").removeClass("s-prompt") : (a(".mobile .error-prompt").prop("lastChild").nodeValue = _l("您输入联系电话有误，请重新输入"), a(".mobile .error-prompt").show(), a(".mobile .input").addClass("s-prompt")) }, inputChangedByMail: function (e) { var t = a.trim(a(e.currentTarget).val()), i = n.isValidMailAddr(t); "" == t || null == t ? (a(".require-mail .error-prompt").prop("lastChild").nodeValue = _l("邮箱地址不可为空"), a(".require-mail .error-prompt").show(), a(".require-mail .input").addClass("s-prompt")) : i ? a(".require-mail .input").removeClass("s-prompt") : (a(".require-mail .error-prompt").prop("lastChild").nodeValue = _l("邮箱地址格式有误"), a(".require-mail .error-prompt").show(), a(".require-mail .input").addClass("s-prompt")) }, inputChangedBySuggestion: function (e) { var t = a.trim(a(e.currentTarget).val()); "" == t || null == t ? (a(".require-suggestion .error-prompt").prop("lastChild").nodeValue = _l("意见反馈内容不可为空"), a(".require-suggestion .error-prompt").addClass("textArea"), a(".require-suggestion .error-prompt").show(), a(".require-suggestion .textarea").addClass("s-prompt")) : (a(".require-suggestion .error-prompt").removeClass("textArea"), a(".require-suggestion .textarea").removeClass("s-prompt")) }, submitForm: function () { var e = null; this.checkParams(), 0 === this.errorCode.length && (e = { customerName: a("input[name='user']").val(), companyName: a("input[name='companyName']").val(), tel: a("input[name='mobile']").val(), email: a("input[name='mail']").val(), suggestionType: a("input[name='suggestionsAbout']").val(), countryCode: n.getSiteLocation(), lang: n.getSiteLanguage(), message: a("textarea[name='suggestion']").val(), source: "CE", isRecMsg: "gb" == n.getSiteLocation() || "fr" == n.getSiteLocation() || "de" == n.getSiteLocation() ? 1 == a("#marketing-info").prop("checked") ? "1" : "0" : "" }, this.saveSuggestionAjax(e, "")) }, saveSuggestionAjax: function (e, t) { i.ajax({ type: "POST", contentType: "application/json", url: n.getRESTfulDomain("pms/suggesion?app=pms"), data: JSON.stringify(e), success: function (e) { if ("WS_PC_01" === e.resultStr && (a(".r-btn-a").hide(), a(".submit-bottom .r-prompt").show()), "WS_PC_02" === e.resultStr || "WS_PC_03" === e.resultStr || "WS_PC_04" === e.resultStr) { a(".r-btn-b").show(); setTimeout("$('.r-btn-b').hide()", 3e3) } }, error: function (e) { a(".r-btn-b").text(_l("网络异常，请稍后再试！")), a(".r-btn-b").css("width", "220px"), a(".r-btn-b").show(), setTimeout("$('.r-btn-b').hide()", 3e3) } }) }, serializeObject: function (e) { var t = {}; return a.each(e, function () { void 0 !== t[this.name] ? (t[this.name].push || (t[this.name] = [t[this.name]]), t[this.name].push(this.value || "")) : t[this.name] = this.value || "" }), t }, checkParams: function () { this.errorCode.splice(0, this.errorCode.length), this.checkContactName(), this.checkMobile(), this.checkMail(), this.checkSuggestion(), this.checkPrivacyPolicy() }, checkContactName: function () { var e = a.trim(a(".contact-name input").val()); "" != e && null != e || (a(".contact-name .error-prompt").prop("lastChild").nodeValue = _l("您的姓名不可为空"), a(".contact-name .input").addClass("s-prompt"), this.errorCode.push("901")) }, checkMobile: function () { var e = a.trim(a(".mobile input").val()); "" == e || null == e ? (a(".mobile .error-prompt").prop("lastChild").nodeValue = _l("您的联系电话不可为空"), a(".mobile .input").addClass("s-prompt"), this.errorCode.push("903")) : n.isValidPhoneNumber(e) || (a(".mobile .error-prompt").prop("lastChild").nodeValue = _l("您输入联系电话有误，请重新输入"), a(".mobile .input").addClass("s-prompt"), this.errorCode.push("904")) }, checkMail: function () { var e = a.trim(a(".require-mail input").val()), t = n.isValidMailAddr(e); "" == e || null == e ? (a(".require-mail .error-prompt").prop("lastChild").nodeValue = _l("邮箱地址不可为空"), a(".require-mail .input").addClass("s-prompt"), this.errorCode.push("905")) : t ? a(".require-mail .input").removeClass("s-prompt") : (a(".require-mail .error-prompt").prop("lastChild").nodeValue = _l("邮箱地址格式有误"), a(".require-mail .input").addClass("s-prompt"), this.errorCode.push("906")) }, checkSuggestion: function () { var e = a.trim(a(".require-suggestion textarea").val()); "" == e || null == e ? (a(".require-suggestion .error-prompt").prop("lastChild").nodeValue = _l("意见反馈内容不可为空"), a(".require-suggestion .error-prompt").addClass("textArea"), a(".require-suggestion .error-prompt").show(), a(".require-suggestion .textarea").addClass("s-prompt"), this.errorCode.push("907")) : (a(".require-suggestion .error-prompt").removeClass("textArea"), a(".require-suggestion .textarea").removeClass("s-prompt")) }, checkPrivacyPolicy: function () { a("#policy").attr("checked") ? a(".require-policy .checkbox").removeClass("s-prompt") : (a(".require-policy .error-prompt").show(), a(".require-policy .checkbox").addClass("s-prompt"), this.errorCode.push("908")) } }) }), define("views/pages/popularization/index", ["backbone", "templates", "jquery", "helper"], function (n, e, a, s) { return n.View.extend({ events: { "click #popularization-validation-image": "refreshPopularizationValidationCode", "click #popularization-submission": "sumitPopularizationApplication" }, errorTips: function (e) { a("[name=popularization-submission-error]").html(e) }, initialize: function () { this.refreshPopularizationValidationCode() }, refreshPopularizationValidationCode: function () { var e = this.$("#popularization-validation-image"), t = s.getRESTfulDomain("captcha/pms?force=true&time=" + (new Date).getTime()); e && e.attr("src", t) }, isValidMailAddr: function (e) { return s.isValidMailAddr(e) }, sumitPopularizationApplication: function (e) { var t, i = a("[name=popularization-security-code]").val(), n = a(e.currentTarget).hasClass("btn"); this.checkPopularizationContactName() && this.checkPopularizationCompanyName() && this.checkPopularizationMail() && this.checkPopularizationMailReg() && this.checkPopularizationMobile() && (n && !this.checkPopularizationCity() || this.checkMobileReg() && (n || this.checkPopularizationEnquiry()) && this.checkPopularizationValidCode() && this.checkPopularizationPrivacyPolicy() && (n || this.checkPopularizationPersonalInfAgreement()) && (t = { title: a("input[name='title']").val(), customerName: a("input[name='popularization-contact-name']").val(), companyName: a("input[name='popularization-require-company']").val(), industry: "", type: "2", tel: a("input[name='popularization-mobile']").val(), email: a("input[name='popularization-require-mail']").val(), city: a("input[name='popularization-city']").val() ? a("input[name='popularization-city']").val() : "", countryCode: s.getSiteLocation(), lang: s.getSiteLanguage(), message: a("[name='popularization-require-enquiry']").val() ? a("[name='popularization-require-enquiry']").val() : "message", countryInput: "", source: "LP" }, this.savePopularizationCooperativeAjax(t, i))) }, savePopularizationCooperativeAjax: function (e, t) { var i = this; n.ajax({ type: "POST", contentType: "application/json", url: s.getRESTfulDomain("pms/collectedInformation?app=pms&answer=" + t), data: JSON.stringify(e), success: function (e) { "WS_PC_01" === e.resultStr && i.errorTips(_l("您的信息提交成功")), "WS_PC_02" !== e.resultStr && "WS_PC_03" !== e.resultStr && "WS_PC_04" !== e.resultStr || (i.errorTips(_l("提交失败")), i.refreshPopularizationValidationCode()) }, error: function (e) { 403 === e.status ? i.errorTips(_l("您输入的验证码有误，请重新输入")) : i.errorTips(_l("网络异常，请稍后再试！")), i.refreshPopularizationValidationCode() } }) }, checkPopularizationValidCode: function () { var e = a("[name=popularization-security-code]").val(); return "" != e && null != e || (this.errorTips(_l("您输入的验证码不能为空")), !1) }, checkPopularizationContactName: function () { var e = a.trim(a("[name=popularization-contact-name]").val()); return "" != e && null != e || (this.errorTips(_l("您的姓名不可为空")), !1) }, checkPopularizationCompanyName: function () { var e = a.trim(a("[name=popularization-require-company]").val()); return "" != e && null != e || (this.errorTips(_l("公司名称不可为空")), !1) }, checkPopularizationMobile: function () { var e = a.trim(a("[name=popularization-mobile]").val()); return "" != e && null != e || (this.errorTips(_l("您的联系电话不可为空")), !1) }, checkMobileReg: function () { var e = a.trim(a("[name=popularization-mobile]").val()); return !!s.isValidPhoneNumber(e) || (this.errorTips(_l("您输入联系电话有误，请重新输入")), !1) }, checkPopularizationMail: function () { var e = a.trim(a("[name=popularization-require-mail]").val()); return "" != e && null != e || (this.errorTips(_l("邮箱地址不可为空")), !1) }, checkPopularizationMailReg: function () { var e = a.trim(a("[name=popularization-require-mail]").val()); return !!this.isValidMailAddr(e) || (this.errorTips(_l("邮箱地址格式有误")), !1) }, checkPopularizationEnquiry: function () { var e = a.trim(a("[name=popularization-require-enquiry]").val()); return "" != e && null != e || (this.errorTips(_l("咨询内容不可为空")), !1) }, checkPopularizationPrivacyPolicy: function () { return !!a("[name=popularization-require-policy]").is(":checked") || (this.errorTips(_l("必须同意隐私声明(谷歌推广)")), !1) }, checkPopularizationPersonalInfAgreement: function () { return "jp" != s.getSiteLocation() || (!!a("[name=popularization-personal-inf-agreement]").attr("checked") || (this.errorTips(_l("必须同意个人信息管理同意书")), !1)) }, checkPopularizationCity: function () { return !!a("[name=popularization-city]").val() || (this.errorTips(_l("所在城市不可为空")), !1) } }) }), define("models/track", ["backbone", "helper"], function (e, t) { return e.Model.extend({}, { parse: function (e) { return null == e.awbNo && (e.awbNo = "-"), null == e.flightNo && (e.flightNo = "-"), null == e.vrn && (e.vrn = "-"), null == e.scheDate && (e.scheDate = "-"), null == e.port && (e.port = "-"), e } }) }), define("collections/track", ["backbone", "models/track", "helper"], function (e, t, s) { return e.Collection.extend({ model: t, parse: function (e) { return e = _.map(e, function (e) { return t.parse(e) }) }, fetchDetails: function (e, t, i, n) { this.url = s.getRESTfulDomain("bills/referenceNum?monthlyCardNo=" + e + "&code=" + t + "&date=" + i + "&answer=" + n + "&app=track"); var a = this; this.fetch({ success: function (e, t) { return t }, timeout: 5e3, error: function (e, t) { 404 === t.status ? a.trigger("notFound") : 403 === t.status ? a.trigger("validationCodeError") : a.trigger("networkError") } }) } }) }), define("views/pages/track/index", ["backbone", "helper", "templates", "collections/track", "components/detailDatePicker/picker"], function (e, n, i, t, a) { return e.View.extend({ events: { "click .verification-code .refresh": "refreshValidationCode", "click #validation-image": "refreshValidationCode", "click .submit-query": "queryDetails" }, initialize: function () { this.collections = new t, this.listenTo(this.collections, "sync", this.render), this.listenTo(this.collections, "sync", this.resetQueryButton), this.listenTo(this.collections, "notFound", this.showNotFoundError), this.listenTo(this.collections, "networkError", this.showNetworkError), this.listenTo(this.collections, "validationCodeError", this.showValidationCodeError), this.refreshValidationCode(), this.$(".results").slideUp(), this.$("input").placeholder(), new a({ el: $(".detail-date-input") }) }, renderResults: function () { var e = this.$(".results"), t = n.getDynamicURLWithContext("/waybill/#search/bill-number/"); e.html(i.trackResult({ results: this.collections.models, patch: t })), e.slideDown() }, render: function () { this.refreshValidationCode(), this.renderResults() }, resetQueryButton: function () { this.$(".submit-query").button("reset") }, showNotFoundError: function () { this.$(".error[data-error=not-found]").show(), this.resetQueryButton() }, showNetworkError: function () { this.$(".error[data-error=network]").show(), this.resetQueryButton() }, showValidationCodeError: function () { var e = this.$(".primary-button"); e.html(e.data("resetText")), this.$(".error[data-error=validation-code]").show(), this.resetQueryButton() }, queryDetails: function () { if (this.isFormsValidated()) { var e = this.$("#validation-search-code").val(); this.$(".error").hide(), this.$(".submit-query").button("loading"), this.collections.fetchDetails(this.$("#account").val(), this.$("#reference").val(), moment(this.$("#date").data("date")).format("YYYY-MM-DD"), e) } }, isFormsValidated: function () { var e = this.$(".sender-form").parsley().validate(); return "" === this.$("#account").val() ? (this.$("#account").focus(), !1) : "" === this.$("#reference").val() ? (this.$("#reference").focus(), !1) : e }, refreshValidationCode: function () { var e = this.$("#validation-image"), t = $("#validation-image-child"), i = n.getRESTfulDomain("captcha/track?force=true&time=" + (new Date).getTime()); e && e.attr("src", i), t && t.attr("src", i), this.$(".verification-code input").val(""), this.$(".validation-code-error").hide() } }) }), define("collections/regulations", ["backbone", "helper"], function (e, i) { return e.Collection.extend({ fetchURL: function (e, t) { t = t || {}, this.url = i.getRESTfulDomain(e), this.reset().fetch(t) }, fetchOrigins: function () { this.fetchURL("regulation/origins") }, fetchDests: function (e) { this.fetchURL(_p("regulation/dests?originCode=%s", encodeURIComponent(e))) }, fetchItems: function (e, t) { this.fetchURL(_p("regulation/items?originCode=%s&destCode=%s", encodeURIComponent(e), encodeURIComponent(t))) }, fetchDetails: function (e, t, i) { var n = this; this.fetchURL(_p("regulation?originCode=%s&destCode=%s&item=%s", encodeURIComponent(e), encodeURIComponent(t), encodeURIComponent(i)), { error: function (e, t) { 404 === t.status ? n.trigger("notFound") : n.trigger("networkError") } }) } }) }), define("views/pages/regulation/index", ["backbone", "collections/regulations", "templates"], function (e, t, i) { return e.View.extend({ events: { "click .origin .dropdown-menu a": "selectOrigin", "click .dest .dropdown-menu a": "selectDest", "click .cargo-type-items button": "changeCargoType", "click .submit-query": "queryDetails" }, initialize: function () { this.origins = new t, this.dests = new t, this.items = new t, this.details = new t, this.listenTo(this.origins, "sync", this.render), this.listenTo(this.dests, "sync", this.render), this.listenTo(this.items, "sync", this.render), this.listenTo(this.details, "sync", this.render), this.listenTo(this.details, "sync", this.resetQueryButton), this.listenTo(this.details, "notFound", this.showNotFoundError), this.listenTo(this.details, "networkError", this.showNetworkError), this.origins.fetchOrigins(), this.render() }, selectOrigin: function (e) { var t = $(e.currentTarget); this.originSelected = { name: t.text(), code: t.data("code") }, this.destSelected = null, this.render(), this.dests.fetchDests(this.originSelected.code) }, selectDest: function (e) { var t = $(e.currentTarget); this.destSelected = { name: t.text(), code: t.data("code") }, this.render(), this.items.fetchItems(this.originSelected.code, this.destSelected.code) }, changeCargoType: function (e) { var t = $(e.currentTarget); this.$(".cargo-type-items button").removeClass("active"), t.addClass("active"), this.itemSelected = { name: t.text(), code: t.data("code") }, this.render() }, renderDropdowns: function () { this.$(".origin .dropdown-menu").html(i.dropdownTemplates({ dropdownItems: this.origins.models })), this.originSelected ? (this.$(".dest .dropdown-menu").removeClass("hidden"), this.$(".dest .dropdown-menu").html(i.dropdownTemplates({ dropdownItems: this.dests.models }))) : this.$(".dest .dropdown-menu").addClass("hidden") }, renderDropdownTitle: function () { var e = this.$(".origin .dropdown-toggle .selected-dropdown"), t = this.originSelected ? this.originSelected.name : e.data("origin-text"); e.text(t); var i = this.$(".dest .dropdown-toggle .selected-dropdown"), n = this.destSelected ? this.destSelected.name : i.data("origin-text"); i.text(n) }, renderItemSelector: function () { var e = this.$(".cargo-type"); if (this.items.length) { if (e.show(), this.$(".cargo-type-items").html(i.buttonGroupTempletas({ items: this.items.models })), this.itemSelected) { var t = this.$(".cargo-type-items button[data-code=" + this.itemSelected.code + "]"); _.isEmpty(t) ? (this.itemSelected = null, this.render()) : t.addClass("active") } } else e.hide() }, updateQueryButtonStatus: function () { var e = this.originSelected && this.destSelected && this.itemSelected; this.$(".submit-query").toggleClass("disabled", !e) }, renderResults: function () { var e = this.$(".results"); this.details.length ? (e.html(i.regulationResult({ results: this.details.models })), e.slideDown()) : e.slideUp() }, render: function () { this.renderDropdownTitle(), this.renderDropdowns(), this.renderItemSelector(), this.updateQueryButtonStatus(), this.renderResults() }, queryDetails: function () { this.$(".error").hide(), this.$(".submit-query").button("loading"); var e = this; this.$(".results").slideUp(function () { e.details.fetchDetails(e.originSelected.code, e.destSelected.code, e.itemSelected.code) }) }, resetQueryButton: function () { this.$(".submit-query").button("reset") }, showNotFoundError: function () { this.$(".error[data-error=not-found]").show(), this.resetQueryButton() }, showNetworkError: function () { this.$(".error[data-error=network]").show(), this.resetQueryButton() } }) }), define("models/consign", ["backbone", "helper", "utils/checkUtils"], function (e, t, i) { return e.Model.extend({}, { parse: function (e) { return null == e.awbNo && (e.awbNo = "-"), null == e.flightNo && (e.flightNo = "-"), null == e.vrn && (e.vrn = "-"), null == e.scheDate && (e.scheDate = "-"), null == e.port && (e.port = "-"), e }, validateBillNumber: function (e, t) { return 2 == t ? /^\d{10}$/.test(e.trim()) : i.billNumber(e.trim()) }, validateBillNumbers: function (e, t) { var i = !0, n = this; return _.each(e, function (e) { e.length && !n.validateBillNumber(e, t) && (i = !1) }), i } }) }), define("collections/consign", ["backbone", "models/consign", "helper"], function (e, t, n) { return e.Collection.extend({ model: t, parse: function (e) { return e = _.map(e, function (e) { return t.parse(e) }) }, fetchDetails: function (e, t) { this.url = n.getRESTfulDomain("consignee/list?type=" + e + "&code=" + t), this.code = t, this.type = e; var i = this; this.fetch({ success: function (e, t) { return t }, error: function (e, t) { 404 === t.status ? i.trigger("notFound") : 403 === t.status ? i.trigger("validationCodeError") : i.trigger("networkError") } }) } }) }), define("views/pages/consign/index", ["backbone", "collections/consign", "models/consign", "templates", "tokenfield", "jquery-placeholder"], function (e, t, a, i, n) { return e.View.extend({ events: { "click .cargo-type-items button": "changeCargoType", "keyup .billNumber1 input": "updateQueryButtonStatus", "mouseout .tokenfield.form-control": "stopPropagation", "focusin input.token-input": "setInputToken", "focusout input.token-input": "setInputToken", "click .submit-query": "queryDetails", "click .clear-inputs": "clearInputs" }, initialize: function () { this.itemSelected = { code: 1 }, this.placeHolder = this.$(".billNumber input").attr("placeholder"), this.setupTokenField(this.$(".billNumber input"), this.placeHolder), this.collections = new t, this.codes = [], this.$("div.tokenfield").css({ border: "1px solid #ccc" }), this.clearInputs(), this.listenTo(this.collections, "sync", this.render), this.listenTo(this.collections, "sync", this.resetQueryButton), this.listenTo(this.collections, "notFound", this.showNotFoundError), this.listenTo(this.collections, "networkError", this.showNetworkError), this.listenTo(this.collections, "validationCodeError", this.showValidationCodeError), this.render() }, clearInputs: function () { this.$(".token-input").val(""), this.$tokenfield.tokenfield("setTokens", []), this.$tokenfield.trigger("tokenfield:removetoken"), this.validateBillNumbersInput(), this.$(".error").hide(), this.placeHolderToggle() }, changeCargoType: function (e) { var t = $(e.currentTarget); this.$(".cargo-type-items button").removeClass("active"), t.addClass("active"), this.itemSelected = { name: t.text(), code: t.data("code") }, 1 == this.itemSelected.code && (this.$(".billLabel").text(_l("运单号")), this.$(".error[data-error=bill-number-format]").html(_l("运单号错误或重复。")), this.$(".error[data-error=limit-exceeded]").html(_l("您已输入超过10条运单号，系统将自动截取并显示前10条运单号的追踪信息。"))), 2 == this.itemSelected.code && (this.$(".billLabel").text(_l("海关货运编号")), this.$(".error[data-error=bill-number-format]").html(_l("海关货运编号只能为10位数字,且不能重复。")), this.$(".error[data-error=limit-exceeded]").html(_l("您已输入超过10条海关货运编号，系统将自动截取并显示前10条海关货运编号的追踪信息。"))), this.clearInputs() }, setInputToken: function (e) { var t = this; "focusin" === e.type ? (this.$(e.target).data("input-status", !0), this.$el.find(".billNumber").removeClass("folded")) : (this.$(e.target).data("input-status", !1), this.$el.find(".token").length || this.$el.find(".token-input").val() || setTimeout(function () { t.$el.find(".tokenfield.form-control").hasClass("focus") || t.$el.find(".billNumber").addClass("folded") }, 200)) }, stopPropagation: function (e) { e.stopPropagation() }, placeHolderToggle: function () { if (0 === this.inputedBillNumbers().length) { var e = this.$(".tokenfield.form-control"), t = this.$(".token-input"), i = e.offset().left + e.width() + parseInt(e.css("padding-left"), 10) - t.offset().left - 1; 1 == this.itemSelected.code ? this.placeholder = _l("最多可同时查询10条运单号，以中英文逗号、空格或回车键隔开。") : this.placeholder = _l("最多可同时查询10条海关货运编号，以中英文逗号、空格或回车键隔开。"), t.attr("placeholder", this.placeholder).width(i).placeholder() } else this.$(".token-input").attr("placeholder", "").removeClass("placeholder") }, setupTokenField: function (e, t) { this.placeholder = t; var i = this; this.$tokenfield = e; var n = function () { window.setTimeout(function () { i.validateBillNumbersInput() }, 0) }; i.$tokenfield.attr("placeholder", t).on("tokenfield:removetoken", function () { i.$(".error[data-error=limit-exceeded]").hide(), i.placeHolderToggle(), i.inputValidate() && i.$(".error[data-error=bill-number-format]").hide(), i.validateBillNumbersInput() }).on("tokenfield:createtoken", function (e) { a.validateBillNumber(e.token.value, i.itemSelected.code) || $(e.relatedTarget).addClass("invalid"), i.placeHolderToggle(), n() }).on("tokenfield:preventduplicate", function () { window.setTimeout(function () { i.$(".error[data-error=bill-number-format]").show() }, 200) }).on("tokenfield:edittoken", function () { i.$(".token-input").on("blur", function () { n() }).on("keyup", function (e) { e.currentTarget.value.length || (i.placeHolderToggle(), n()) }) }).tokenfield({ createTokensOnBlur: !0, delimiter: [",", "\n", "\t", " ", "，"], limit: 10, minWidth: 90, leakCallback: function () { i.$(".token-input").val(""), i.$(".error[data-error=limit-exceeded]").show() } }), i.$(".token-input").attr("placeholder", this.placeHolder).placeholder() }, inputedBillNumbers: function () { var t; try { t = this.$tokenfield.tokenfield("getTokensList").split(",") } catch (e) { t = this.$tokenfield.tokenfield("getTokensList").val().split(",") } return t = _.map(t, function (e) { return e.trim() }), _.compact(t) }, hasInputs: function () { var t = !1; return _.each(this.inputedBillNumbers(), function (e) { e.length && (t = !0) }), t }, inputValidate: function () { return a.validateBillNumbers(this.inputedBillNumbers(), this.itemSelected.code) }, validateBillNumbersInput: function () { this.inputValidate() ? this.$(".error[data-error=bill-number-format]").hide() : this.$(".error[data-error=bill-number-format]").show(), this.updateQueryButtonStatus() }, updateQueryButtonStatus: function () { var e = a.validateBillNumbers(this.inputedBillNumbers(), this.itemSelected.code), t = this.$el.find(".token").length; this.$(".primary-button").toggleClass("disabled", !e || !t) }, renderResults: function () { var e = this.$(".results"); this.collections.length ? (e.html(i.consignResult({ results: this.collections.models, codes: this.codes, type: this.itemSelected.code })), e.slideDown()) : e.slideUp() }, render: function () { this.updateQueryButtonStatus(), this.renderResults() }, queryDetails: function () { if (this.inputValidate() && this.hasInputs()) { this.$(".error").hide(), this.$(".submit-query").button("loading"); var e = this.$tokenfield.tokenfield("getTokensList", ",").split(", "); e = _.map(e, function (e) { return e.trim() }), this.codes = e, this.collections.fetchDetails(this.itemSelected.code, e) } else this.$(".error[data-error=bill-number-format]").show() }, resetQueryButton: function () { this.$(".submit-query").button("reset") }, showNotFoundError: function () { this.$(".error[data-error=not-found]").show(), this.resetQueryButton() }, showNetworkError: function () { this.$(".error[data-error=network]").show(), this.resetQueryButton() } }) }), define("models/notIndustry", ["backbone", "helper"], function (e, t) { return e.Model.extend({}, { parse: function (e) { return e }, getIndustryCommerceCity: function () { return e.ajax({ type: "get", url: t.getRESTfulDomain("region/industryCommerceCity") }) } }) }), define("collections/notIndustry", ["backbone", "models/notIndustry", "helper"], function (o, t, l) { return o.Collection.extend({ model: t, parse: function (e) { return e = _.map(e, function (e) { return t.parse(e) }) }, getIndustryCommerceCity: function () { return o.ajax({ type: "GET", url: l.getRESTfulDomain("region/industryCommerceCity") }) }, fetchIndustryCommerceArea: function (e) { return o.ajax({ type: "GET", url: l.getRESTfulDomain("region/" + encodeURIComponent(e) + "/industryCommerceArea") }) }, fetchIndustryCommerceTown: function (e) { return o.ajax({ type: "GET", url: l.getRESTfulDomain("region/" + e + "/industryCommerceTown") }) }, fetchTownByArea: function (e, t) { return o.ajax({ type: "GET", url: l.getRESTfulDomain("region/" + encodeURIComponent(e) + "/industryCommerceTown?area=" + encodeURIComponent(t)) }) }, fetchRoadByTown: function (e, t) { return o.ajax({ type: "GET", url: l.getRESTfulDomain("region/" + encodeURIComponent(e) + "/industryCommerceRoad?town=" + encodeURIComponent(t)) }) }, fetchRoad: function (e, t, i) { var n = "region/" + encodeURIComponent(e) + "/industryCommerceRoad?"; return null != t && t != _l("请选择") && (n += "&area=" + encodeURIComponent(t)), null != i && i != _l("请选择") && (n += "&town=" + encodeURIComponent(i)), o.ajax({ type: "GET", url: l.getRESTfulDomain(n) }) }, fetchAddressByAreaAndTownAndRoad: function (e, t, i, n) { var a = "region/" + encodeURIComponent(e) + "/industryCommerceAddress?town=" + encodeURIComponent(i); return null != t && t != _l("请选择") && (a += "&area=" + encodeURIComponent(t)), null != n && n != _l("请选择") && (a += "&road=" + encodeURIComponent(n)), o.ajax({ type: "GET", url: l.getRESTfulDomain(a) }) }, industryCommerce: function (e, t, i, n, a, s) { var r = "region/industryCommerce?"; return null != e && e != _l("请选择") && (r += "&city=" + encodeURIComponent(e)), null != t && t != _l("请选择") && (r += "&area=" + encodeURIComponent(t)), null != i && i != _l("请选择") && (r += "&town=" + encodeURIComponent(i)), null != n && n != _l("请选择") && (r += "&road=" + encodeURIComponent(n)), null != a && a != _l("请选择") && (r += "&address=" + encodeURIComponent(a)), null != s && (r += "&pageNO=" + s), o.ajax({ type: "GET", url: l.getRESTfulDomain(r) }) }, industryCommercePageCount: function (e, t, i, n, a) { var s = "region/industryCommercePageCount?"; return null != e && e != _l("请选择") && (s += "&city=" + encodeURIComponent(e)), null != t && t != _l("请选择") && (s += "&area=" + encodeURIComponent(t)), null != i && i != _l("请选择") && (s += "&town=" + encodeURIComponent(i)), null != n && n != _l("请选择") && (s += "&road=" + encodeURIComponent(n)), null != a && a != _l("请选择") && (s += "&address=" + encodeURIComponent(a)), o.ajax({ type: "GET", url: l.getRESTfulDomain(s) }) } }) }), define("views/pages/notIndustry/index", ["backbone", "collections/notIndustry", "models/notIndustry", "templates"], function (e, t, i, n) { return e.View.extend({ events: { "click .city": "renderCityDropdowns", "click .citylist.dropdown-menu a": "selectCity", "click .arealist.dropdown-menu a": "selectArea", "click .townlist.dropdown-menu a": "selectTown", "click .roadlist.dropdown-menu a": "selectRoad", "click .addresslist.dropdown-menu a": "selectAddress", "click .submit-query": "queryDetails", "keyup .address": "searchAddress", "keyup .road": "searchRoad", "click .goToPage": "goToPage" }, initialize: function () { this.itemSelected = {}, this.collections = new t, this.addresslist = [], this.roadlist = [], this.listenTo(this.collections, "sync", this.render), this.render() }, renderCityDropdowns: function () { (that = this).collections.getIndustryCommerceCity().success(function (e) { that.$(".citylist").html(n.dropdownCity({ dropdownItems: e })) }).error(function (e) { 404 === e.status && that.showNetworkError() }) }, selectCity: function (e) { e.preventDefault(); var t = $(e.currentTarget).text(); this.itemSelected = { city: t }, t != this.$(".city").val() && (this.$(".area").val(_l("请选择")), this.$(".town").val(_l("请选择")), this.$(".road").val(_l("请选择")), this.$(".address").val(_l("请选择")), this.addresslist = [], this.roadlist = [], this.collections.fetchIndustryCommerceArea(t).success(function (e) { that.$(".arealist").html(n.dropdownCity({ dropdownItems: e })), that.$(".townlist").html(n.dropdownCity({ dropdownItems: [] })), that.$(".roadlist").html(n.dropdownCity({ dropdownItems: [] })), that.$(".addresslist").html(n.dropdownCity({ dropdownItems: [] })) }).error(function (e) { 404 === e.status && that.showNetworkError() })), this.$(".city").val(t) }, selectArea: function (e) { var t = $(e.currentTarget).text(); this.itemSelected = { city: this.itemSelected.city, area: t }, t != this.$(".area").val() && (this.$(".town").val(_l("请选择")), this.$(".road").val(_l("请选择")), this.$(".address").val(_l("请选择")), this.addresslist = [], this.collections.fetchTownByArea(this.itemSelected.city, t).success(function (e) { that.$(".townlist").html(n.dropdownCity({ dropdownItems: e })), that.$(".addresslist").html(n.dropdownCity({ dropdownItems: [] })) }).error(function (e) { 404 === e.status && that.$(".townlist").html(n.dropdownCity({ dropdownItems: [] })) }), this.collections.fetchRoad(this.itemSelected.city, t, "").success(function (e) { that.$(".roadlist").html(n.dropdownCity({ dropdownItems: e })), that.roadlist = e, that.$(".addresslist").html(n.dropdownCity({ dropdownItems: [] })) }).error(function (e) { 404 === e.status && that.$(".townlist").html(n.dropdownCity({ dropdownItems: [] })) })), this.$(".area").val(t) }, selectTown: function (e) { var t = $(e.currentTarget).text(); this.itemSelected = { city: this.itemSelected.city, town: t, area: this.itemSelected.area }, t != this.$(".town").val() && (this.$(".road").val(_l("请选择")), this.$(".address").val(_l("请选择")), this.collections.fetchRoad(this.itemSelected.city, this.itemSelected.area, this.itemSelected.town).success(function (e) { that.$(".roadlist").html(n.dropdownCity({ dropdownItems: e })), that.$(".addresslist").html(n.dropdownCity({ dropdownItems: [] })), that.roadlist = e }).error(function (e) { 404 === e.status && that.showNetworkError() })), this.$(".town").val(t) }, selectRoad: function (e) { var t = $(e.currentTarget).text(); this.itemSelected = { city: this.itemSelected.city, town: this.itemSelected.town, area: this.itemSelected.area, road: t }, t != this.$(".road").val() && (this.$(".address").val(_l("请选择")), this.$(".road").val(t), null == this.itemSelected.town && (this.itemSelected.town = ""), this.collections.fetchAddressByAreaAndTownAndRoad(this.itemSelected.city, this.itemSelected.area, this.itemSelected.town, t).success(function (e) { that.$(".addresslist").html(n.dropdownCity({ dropdownItems: e })), that.addresslist = e }).error(function (e) { 404 === e.status && that.showNetworkError() })) }, selectAddress: function (e) { var t = $(e.currentTarget).text(); this.$(".address").val(t), this.itemSelected = { city: this.itemSelected.city, town: this.itemSelected.town, area: this.itemSelected.area, road: this.itemSelected.road, address: t } }, updateQueryButtonStatus: function () { }, renderResults: function () { var e = this.$(".results"); this.collections.length ? (e.html(n.notIndustryResult({ results: this.collections.models })), e.slideDown()) : e.slideUp() }, render: function () { this.$(".area").val(_l("请选择")), this.$(".town").val(_l("请选择")), this.$(".road").val(_l("请选择")), this.$(".address").val(_l("请选择")), this.renderCityDropdowns(), this.updateQueryButtonStatus(), this.renderResults() }, queryDetails: function () { this.$(".submit-query").button("loading"), this.$(".error").hide(), (that = this).$(".results").slideDown(), this.collections.industryCommerce(this.itemSelected.city, this.itemSelected.area, this.itemSelected.town, this.itemSelected.road, this.itemSelected.address, window.pageIndex).success(function (e) { that.$(".results").html(n.notIndustryResult({ results: e })), that.collections.industryCommercePageCount(that.itemSelected.city, that.itemSelected.area, that.itemSelected.town, that.itemSelected.road, that.itemSelected.address).success(function (e) { var t = window.pageIndex || 1; that.$(".results").append(n.paginationPro({ pageIndex: t, pageCount: e })), that.count = e, that.$(".submit-query").button("reset") }).error(function (e) { 404 === e.status && that.showNetworkError() }) }).error(function (e) { 404 === e.status && that.showNetworkError() }) }, goToPage: function (e) { var t = $(e.currentTarget).attr("data-pageindex"); this.itemSelected = { city: this.itemSelected.city, town: this.itemSelected.town, area: this.itemSelected.area, road: this.itemSelected.road, address: this.itemSelected.address }, this.collections.industryCommerce(this.itemSelected.city, this.itemSelected.area, this.itemSelected.town, this.itemSelected.road, this.itemSelected.address, t).success(function (e) { that.$(".results").html(n.notIndustryResult({ results: e })), that.$(".results").append(n.paginationPro({ pageIndex: t, pageCount: that.count })) }).error(function (e) { 404 === e.status && that.showNetworkError() }) }, searchAddress: function (e) { var t = $(e.currentTarget).context.value; "" != t ? this.$(".addresslist").html(n.dropdownSearch({ dropdownItems: this.addresslist, search: t })) : this.$(".addresslist").html(n.dropdownCity({ dropdownItems: this.addresslist })) }, searchRoad: function (e) { var t = $(e.currentTarget).context.value; "" != t ? this.$(".roadlist").html(n.dropdownSearch({ dropdownItems: this.roadlist, search: t })) : this.$(".roadlist").html(n.dropdownCity({ dropdownItems: this.roadlist })) }, resetQueryButton: function () { this.$(".submit-query").button("reset") }, showNotFoundError: function () { this.$(".error[data-error=not-found]").show(), this.resetQueryButton() }, showNetworkError: function () { this.$(".error[data-error=network]").show(), this.resetQueryButton() } }) }), define("views/pages/internationalApplication/index", ["backbone", "templates", "jquery", "helper"], function (n, e, a, s) { return n.View.extend({ events: { "blur .require-company input.text": "checkCompanyName", "blur .send-addr input.text": "checkRegistCountry", "blur .contact-name input.text": "checkChargePerson", "blur .mobile input.text": "inputChangedByMobile", "blur .email input.text": "checkEmail", "blur .accountNumber input.text": "inputAccountNumber", "blur .companyNameOnline input.text": "checkCompanyNameOnline", "blur .onlinePlatform input.text": "checkOnlinePlatform", "blur .conpanyWebsite input.text": "inputConpanyWebsite", "blur .productType input.text": "checkProductType", "blur .shipmentsPerDay input.text": "checkShipmentsPerDay", "blur .shipmentsTotal input.text": "checkShipmentsTotal", "click .r-btn-a": "sumitApplication", "click #validation-image": "refreshValidationCode", "focus .require-company input.text, .send-addr input.text , .contact-name input.text, .mobile input.text, .email input.text, .accountNumber input.text, .companyNameOnline input.text, .onlinePlatform input.text, .conpanyWebsite input.text, .productType input.text, .shipmentsPerDay input.text, .shipmentsTotal input.text": "hideErrorPrompt", "focus #code": "hideValidcodeErrorPrompt", "click .require-policy input.policy": "agreePrivacy" }, initialize: function () { this.errorCode = [], this.refreshValidationCode() }, refreshValidationCode: function () { var e = this.$("#validation-image"), t = s.getRESTfulDomain("captcha/cis?force=true&time=" + (new Date).getTime()); e && e.attr("src", t) }, hideErrorPrompt: function (e) { a(e.currentTarget).parent().removeClass("s-prompt") }, sumitApplication: function () { var e, t = a("#code").val(); this.checkParam() && (e = { source: a("input[name='source']").val(), companyName: a("input[name='companyName']").val(), registCountry: a("input[name='registCountry']").val(), chargePerson: a("input[name='chargePerson']").val(), contactNumber: a("input[name='contactNumber']").val(), email: a("input[name='email']").val(), accountNumber: a("input[name='accountNumber']").val(), companyNameOnline: a("input[name='companyNameOnline']").val(), onlinePlatform: a("input[name='onlinePlatform']").val(), conpanyWebsite: a("input[name='conpanyWebsite']").val(), productType: a("input[name='productType']").val(), shipmentsPerDay: a("input[name='shipmentsPerDay']").val(), shipmentsTotal: a("input[name='shipmentsTotal']").val() }, this.saveCooperativeAjax(e, t)) }, saveCooperativeAjax: function (e, t) { var i = this; n.ajax({ type: "POST", contentType: "application/json", url: s.getRESTfulDomain("pms/certifiedInternationalShipping?app=cis&answer=" + t + "&lang=" + s.getSiteLanguage() + "&region=" + s.getSiteLocation()), data: JSON.stringify(e), success: function (e) { if ("1" === e.resultStr && (a(".r-btn-a").hide(), a(".submit-bottom .r-prompt").show()), "0" === e.resultStr) { a(".r-btn-b").show(), a(".validation-code-prompt").hide(), i.refreshValidationCode(); setTimeout("$('.r-btn-b').hide()", 3e3) } }, error: function (e) { 403 === e.status ? (a(".validation-code-prompt").prop("lastChild").nodeValue = _l("您输入的验证码有误，请重新输入"), a(".validation-code-prompt").show()) : (a(".r-btn-b").text(_l("网络异常，请稍后再试！")), a(".r-btn-b").css("width", "220px"), a(".r-btn-b").show(), setTimeout("$('.r-btn-b').hide()", 3e3)), i.refreshValidationCode() } }) }, checkParam: function () { return this.checkCompanyName() && this.checkRegistCountry() && this.checkChargePerson() && this.checkMobile() && this.checkMobileReg() && this.checkEmailNotEmpty() && this.checkEmailReg() && this.checkAccountNumber() && this.checkAccountNumberReg() && this.checkCompanyNameOnline() && this.checkOnlinePlatform() && this.checkConpanyWebsite() && this.checkConpanyWebsiteReg() && this.checkProductType() && this.checkValidCode() && this.checkPrivacyPolicy() }, checkMobile: function () { var e = a.trim(a(".mobile input").val()); return "" == e || null == e ? (a(".mobile .input").addClass("s-prompt"), a(".mobile .error-prompt").prop("lastChild").nodeValue = _l("请注意此项为必填"), !1) : (a(".mobile .input").removeClass("s-prompt"), !0) }, checkMobileReg: function () { var e = a.trim(a(".mobile input").val()); return s.isValidPhoneNumber(e) ? (a(".mobile .input").removeClass("s-prompt"), !0) : (a(".mobile .error-prompt").prop("lastChild").nodeValue = _l("您输入联系电话有误，请重新输入"), a(".mobile .input").addClass("s-prompt"), !1) }, checkEmailNotEmpty: function () { var e = a.trim(a(".email input").val()); return "" == e || null == e ? (a(".email .input").addClass("s-prompt"), a(".email .error-prompt").prop("lastChild").nodeValue = _l("请注意此项为必填"), !1) : (a(".email .input").removeClass("s-prompt"), !0) }, checkEmailReg: function () { var e = a.trim(a(".email input").val()); return s.isValidMailAddr(e) ? (a(".email .input").removeClass("s-prompt"), !0) : (a(".email .error-prompt").prop("lastChild").nodeValue = _l("邮箱地址格式有误"), a(".email .input").addClass("s-prompt"), !1) }, checkConpanyWebsite: function () { var e = a.trim(a(".conpanyWebsite input").val()); return "" == e || null == e ? (a(".conpanyWebsite .input").addClass("s-prompt"), a(".accountNumber .error-prompt").prop("lastChild").nodeValue = _l("请注意此项为必填"), !1) : (a(".accountNumber .input").removeClass("s-prompt"), !0) }, checkConpanyWebsiteReg: function () { var e = a.trim(a(".conpanyWebsite input").val()); return /^([hH][tT]{2}[pP]:\/\/|[hH][tT]{2}[pP][sS]:\/\/)(([A-Za-z0-9-&._?=:~]+)\.)+([A-Za-z0-9-&._?=:~\/])+$/.test(e) ? (a(".conpanyWebsite .input").removeClass("s-prompt"), !0) : (a(".conpanyWebsite .error-prompt").prop("lastChild").nodeValue = _l("这网址不是以http://https://开头，或者不是网址！"), a(".conpanyWebsite .input").addClass("s-prompt"), !1) }, checkAccountNumber: function () { var e = a.trim(a(".accountNumber input").val()); new RegExp("^[A-Za-z0-9]+$"); return null == e || "" == e ? (a(".accountNumber .input").addClass("s-prompt"), a(".accountNumber .error-prompt").prop("lastChild").nodeValue = _l("请注意此项为必填"), !1) : (a(".accountNumber .input").removeClass("s-prompt"), !0) }, checkAccountNumberReg: function () { var e = a.trim(a(".accountNumber input").val()); return new RegExp("^[A-Za-z0-9]+$").test(e) ? (a(".accountNumber .input").removeClass("s-prompt"), !0) : (a(".accountNumber .error-prompt").prop("lastChild").nodeValue = _l("只能填写数字或字母，请重新输入"), a(".accountNumber .input").addClass("s-prompt"), !1) }, checkCompanyName: function () { var e = a.trim(a(".require-company input").val()); return "" != e && null != e || (a(".require-company .input").addClass("s-prompt"), !1) }, checkRegistCountry: function () { var e = a.trim(a(".send-addr input").val()); return "" != e && null != e || (a(".send-addr .input").addClass("s-prompt"), !1) }, checkChargePerson: function () { var e = a.trim(a(".contact-name input").val()); return "" != e && null != e || (a(".contact-name .input").addClass("s-prompt"), !1) }, inputChangedByMobile: function (e) { var t = a(e.currentTarget).val(), i = s.isValidPhoneNumber(t); "" == t || null == t ? (a(".mobile .error-prompt").prop("lastChild").nodeValue = _l("请注意此项为必填"), a(".mobile .input").addClass("s-prompt")) : i ? a(".mobile .input").removeClass("s-prompt") : (a(".mobile .error-prompt").prop("lastChild").nodeValue = _l("您输入联系电话错误，请重新输入"), a(".mobile .input").addClass("s-prompt")) }, checkEmail: function (e) { var t = a(e.currentTarget).val(), i = s.isValidMailAddr(t); "" == t || null == t ? (a(".email .error-prompt").prop("lastChild").nodeValue = _l("请注意此项为必填"), a(".email .input").addClass("s-prompt")) : i ? a(".email .input").removeClass("s-prompt") : (a(".email .error-prompt").prop("lastChild").nodeValue = _l("您输入联系邮箱错误，请重新输入"), a(".email .input").addClass("s-prompt")) }, inputAccountNumber: function (e) { var t = a(e.currentTarget).val(), i = new RegExp("^[A-Za-z0-9]+$"); "" == t || null == t ? (a(".accountNumber .error-prompt").prop("lastChild").nodeValue = _l("请注意此项为必填"), a(".accountNumber .input").addClass("s-prompt")) : i.test(t) ? a(".accountNumber .input").removeClass("s-prompt") : (a(".accountNumber .error-prompt").prop("lastChild").nodeValue = _l("只能填写数字或字母，请重新输入"), a(".accountNumber .input").addClass("s-prompt")) }, checkCompanyNameOnline: function () { var e = a.trim(a(".companyNameOnline input").val()); return "" != e && null != e || (a(".companyNameOnline .input").addClass("s-prompt"), !1) }, checkOnlinePlatform: function () { var e = a.trim(a(".onlinePlatform input").val()); return "" != e && null != e || (a(".onlinePlatform .input").addClass("s-prompt"), !1) }, inputConpanyWebsite: function (e) { if (null != e && "" != e && "undefined" != e) { var t = a(e.currentTarget).val(); /^([hH][tT]{2}[pP]:\/\/|[hH][tT]{2}[pP][sS]:\/\/)(([A-Za-z0-9-:&=_.?~]+)\.)+([A-Za-z0-9-:&=_.?~\/])+$/.test(t) ? 100 < t.length ? (a(".conpanyWebsite .error-prompt").prop("lastChild").nodeValue = _l("网店网址最大长度不能超过100个字符"), a(".conpanyWebsite .input").addClass("s-prompt")) : a(".conpanyWebsite .input").removeClass("s-prompt") : (a(".conpanyWebsite .error-prompt").prop("lastChild").nodeValue = _l("这网址不是以http://https://开头，或者不是网址！"), a(".conpanyWebsite .input").addClass("s-prompt")) } }, checkProductType: function () { var e = a.trim(a(".productType input").val()); return "" != e && null != e || (a(".productType .input").addClass("s-prompt"), !1) }, checkShipmentsPerDay: function (e) { if (null != e && "" != e && "undefined" != e) { var t = a(e.currentTarget).val(); new RegExp("^[0-9]*$").test(t) ? 9 < t.length ? (a(".shipmentsPerDay .error-prompt").prop("lastChild").nodeValue = _l("发件量最大长度只能填写9位"), a(".shipmentsPerDay .input").addClass("s-prompt")) : a(".shipmentsPerDay .input").removeClass("s-prompt") : (a(".shipmentsPerDay .error-prompt").prop("lastChild").nodeValue = _l("发件量只能为数字"), a(".shipmentsPerDay .input").addClass("s-prompt")) } }, checkShipmentsTotal: function (e) { if (null != e && "" != e && "undefined" != e) { var t = a(e.currentTarget).val(); if (null != t && "" != t) new RegExp("^[0-9]+([.][0-9]{1}){0,1}$").test(t) ? 100 < t ? (a(".shipmentsTotal .error-prompt").prop("lastChild").nodeValue = _l("顺丰发件占比不能大于100%"), a(".shipmentsTotal .input").addClass("s-prompt")) : a(".shipmentsTotal .input").removeClass("s-prompt") : (a(".shipmentsTotal .error-prompt").prop("lastChild").nodeValue = _l("格式填写有误"), a(".shipmentsTotal .input").addClass("s-prompt")) } }, checkValidCode: function () { var e = a("#code").val(); return "" != e && null != e || (a(".validation-code-prompt").prop("lastChild").nodeValue = _l("您输入的验证码不能为空"), a(".validation-code-prompt").show(), !1) }, hideValidcodeErrorPrompt: function () { a(".validation-code-prompt").hide() }, checkPrivacyPolicy: function () { return a("#policy").attr("checked") ? (a(".require-policy .checkbox").removeClass("s-prompt"), !0) : (a(".require-policy .error-prompt").prop("lastChild").nodeValue = _l("请勾选并接受相关协议提交您的申请"), a(".require-policy .error-prompt").show(), a(".require-policy .checkbox").addClass("s-prompt"), !1) }, agreePrivacy: function (e) { a(e.currentTarget).attr("checked") ? a(".require-policy .error-prompt").hide() : a(".require-policy .error-prompt").show() } }) }), function (e) { "use strict"; "function" == typeof define && define.amd ? define("jquery-form", ["jquery"], e) : e("undefined" != typeof jQuery ? jQuery : window.Zepto) }(function (L) { var y = {}; y.fileapi = void 0 !== L("<input type='file'/>").get(0).files, y.formdata = void 0 !== window.FormData; var M = !!L.fn.prop; function i(e) { var t = e.data; e.isDefaultPrevented() || (e.preventDefault(), L(e.target).ajaxSubmit(t)) } function n(e) { var t = e.target, i = L(t); if (!i.is("[type=submit],[type=image]")) { var n = i.closest("[type=submit]"); if (0 === n.length) return; t = n[0] } var a = this; if ("image" == (a.clk = t).type) if (void 0 !== e.offsetX) a.clk_x = e.offsetX, a.clk_y = e.offsetY; else if ("function" == typeof L.fn.offset) { var s = i.offset(); a.clk_x = e.pageX - s.left, a.clk_y = e.pageY - s.top } else a.clk_x = e.pageX - t.offsetLeft, a.clk_y = e.pageY - t.offsetTop; setTimeout(function () { a.clk = a.clk_x = a.clk_y = null }, 100) } function R() { if (L.fn.ajaxSubmit.debug) { var e = "[jquery.form] " + Array.prototype.join.call(arguments, ""); window.console && window.console.log ? window.console.log(e) : window.opera && window.opera.postError && window.opera.postError(e) } } L.fn.attr2 = function () { if (!M) return this.attr.apply(this, arguments); var e = this.prop.apply(this, arguments); return e && e.jquery || "string" == typeof e ? e : this.attr.apply(this, arguments) }, L.fn.ajaxSubmit = function (I) { if (!this.length) return R("ajaxSubmit: skipping submit process - no element selected"), this; var D, e, t, P = this; "function" == typeof I ? I = { success: I } : void 0 === I && (I = {}), D = I.type || this.attr2("method"), (t = (t = "string" == typeof (e = I.url || this.attr2("action")) ? L.trim(e) : "") || window.location.href || "") && (t = (t.match(/^([^#]+)/) || [])[1]), I = L.extend(!0, { url: t, success: L.ajaxSettings.success, type: D || L.ajaxSettings.type, iframeSrc: /^https/i.test(window.location.href || "") ? "javascript:false" : "about:blank" }, I); var i = {}; if (this.trigger("form-pre-serialize", [this, I, i]), i.veto) return R("ajaxSubmit: submit vetoed via form-pre-serialize trigger"), this; if (I.beforeSerialize && !1 === I.beforeSerialize(this, I)) return R("ajaxSubmit: submit aborted via beforeSerialize callback"), this; var n = I.traditional; void 0 === n && (n = L.ajaxSettings.traditional); var a, j = [], s = this.formToArray(I.semantic, j); if (I.data && (I.extraData = I.data, a = L.param(I.data, n)), I.beforeSubmit && !1 === I.beforeSubmit(s, this, I)) return R("ajaxSubmit: submit aborted via beforeSubmit callback"), this; if (this.trigger("form-submit-validate", [s, this, I, i]), i.veto) return R("ajaxSubmit: submit vetoed via form-submit-validate trigger"), this; var r = L.param(s, n); a && (r = r ? r + "&" + a : a), "GET" == I.type.toUpperCase() ? (I.url += (0 <= I.url.indexOf("?") ? "&" : "?") + r, I.data = null) : I.data = r; var o = []; if (I.resetForm && o.push(function () { P.resetForm() }), I.clearForm && o.push(function () { P.clearForm(I.includeHidden) }), !I.dataType && I.target) { var l = I.success || function () { }; o.push(function (e) { var t = I.replaceTarget ? "replaceWith" : "html"; L(I.target)[t](e).each(l, arguments) }) } else I.success && o.push(I.success); if (I.success = function (e, t, i) { for (var n = I.context || this, a = 0, s = o.length; a < s; a++)o[a].apply(n, [e, t, i || P, P]) }, I.error) { var c = I.error; I.error = function (e, t, i) { var n = I.context || this; c.apply(n, [e, t, i, P]) } } if (I.complete) { var d = I.complete; I.complete = function (e, t) { var i = I.context || this; d.apply(i, [e, t, P]) } } var u = 0 < L("input[type=file]:enabled", this).filter(function () { return "" !== L(this).val() }).length, h = "multipart/form-data", p = P.attr("enctype") == h || P.attr("encoding") == h, f = y.fileapi && y.formdata; R("fileAPI :" + f); var m, g = (u || p) && !f; !1 !== I.iframe && (I.iframe || g) ? I.closeKeepAlive ? L.get(I.closeKeepAlive, function () { m = v(s) }) : m = v(s) : m = (u || p) && f ? function (e) { for (var i = new FormData, t = 0; t < e.length; t++)i.append(e[t].name, e[t].value); if (I.extraData) { var n = function (e) { var t, i, n = L.param(e, I.traditional).split("&"), a = n.length, s = []; for (t = 0; t < a; t++)n[t] = n[t].replace(/\+/g, " "), i = n[t].split("="), s.push([decodeURIComponent(i[0]), decodeURIComponent(i[1])]); return s }(I.extraData); for (t = 0; t < n.length; t++)n[t] && i.append(n[t][0], n[t][1]) } I.data = null; var a = L.extend(!0, {}, L.ajaxSettings, I, { contentType: !1, processData: !1, cache: !1, type: D || "POST" }); I.uploadProgress && (a.xhr = function () { var e = L.ajaxSettings.xhr(); return e.upload && e.upload.addEventListener("progress", function (e) { var t = 0, i = e.loaded || e.position, n = e.total; e.lengthComputable && (t = Math.ceil(i / n * 100)), I.uploadProgress(e, i, n, t) }, !1), e }); a.data = null; var s = a.beforeSend; return a.beforeSend = function (e, t) { I.formData ? t.data = I.formData : t.data = i, s && s.call(this, e, t) }, L.ajax(a) }(s) : L.ajax(I), P.removeData("jqxhr").data("jqxhr", m); for (var _ = 0; _ < j.length; _++)j[_] = null; return this.trigger("form-submit-notify", [this, I]), this; function v(e) { var t, i, d, u, s, h, p, f, n, a, m, g, r = P[0], _ = L.Deferred(); if (_.abort = function (e) { f.abort(e) }, e) for (i = 0; i < j.length; i++)t = L(j[i]), M ? t.prop("disabled", !1) : t.removeAttr("disabled"); if ((d = L.extend(!0, {}, L.ajaxSettings, I)).context = d.context || d, s = "jqFormIO" + (new Date).getTime(), d.iframeTarget ? (a = (h = L(d.iframeTarget)).attr2("name")) ? s = a : h.attr2("name", s) : (h = L('<iframe name="' + s + '" src="' + d.iframeSrc + '" />')).css({ position: "absolute", top: "-1000px", left: "-1000px" }), p = h[0], f = { aborted: 0, responseText: null, responseXML: null, status: 0, statusText: "n/a", getAllResponseHeaders: function () { }, getResponseHeader: function () { }, setRequestHeader: function () { }, abort: function (e) { var t = "timeout" === e ? "timeout" : "aborted"; R("aborting upload... " + t), this.aborted = 1; try { p.contentWindow.document.execCommand && p.contentWindow.document.execCommand("Stop") } catch (e) { } h.attr("src", d.iframeSrc), f.error = t, d.error && d.error.call(d.context, f, t, e), u && L.event.trigger("ajaxError", [f, d, t]), d.complete && d.complete.call(d.context, f, t) } }, (u = d.global) && 0 == L.active++ && L.event.trigger("ajaxStart"), u && L.event.trigger("ajaxSend", [f, d]), d.beforeSend && !1 === d.beforeSend.call(d.context, f, d)) return d.global && L.active-- , _.reject(), _; if (f.aborted) return _.reject(), _; (n = r.clk) && (a = n.name) && !n.disabled && (d.extraData = d.extraData || {}, d.extraData[a] = n.value, "image" == n.type && (d.extraData[a + ".x"] = r.clk_x, d.extraData[a + ".y"] = r.clk_y)); var v = 1, y = 2; function b(t) { var i = null; try { t.contentWindow && (i = t.contentWindow.document) } catch (e) { R("cannot get iframe.contentWindow document: " + e) } if (i) return i; try { i = t.contentDocument ? t.contentDocument : t.document } catch (e) { R("cannot get iframe.contentDocument: " + e), i = t.document } return i } var o = L("meta[name=csrf-token]").attr("content"), l = L("meta[name=csrf-param]").attr("content"); function c() { var e = P.attr2("target"), t = P.attr2("action"), i = P.attr("enctype") || P.attr("encoding") || "multipart/form-data"; r.setAttribute("target", s), D && !/post/i.test(D) || r.setAttribute("method", "POST"), t != d.url && r.setAttribute("action", d.url), d.skipEncodingOverride || D && !/post/i.test(D) || P.attr({ encoding: "multipart/form-data", enctype: "multipart/form-data" }), d.timeout && (g = setTimeout(function () { m = !0, T(v) }, d.timeout)); var n = []; try { if (d.extraData) for (var a in d.extraData) d.extraData.hasOwnProperty(a) && (L.isPlainObject(d.extraData[a]) && d.extraData[a].hasOwnProperty("name") && d.extraData[a].hasOwnProperty("value") ? n.push(L('<input type="hidden" name="' + d.extraData[a].name + '">').val(d.extraData[a].value).appendTo(r)[0]) : n.push(L('<input type="hidden" name="' + a + '">').val(d.extraData[a]).appendTo(r)[0])); d.iframeTarget || h.appendTo("body"), p.attachEvent ? p.attachEvent("onload", T) : p.addEventListener("load", T, !1), setTimeout(function e() { try { var t = b(p).readyState; R("state = " + t), t && "uninitialized" == t.toLowerCase() && setTimeout(e, 50) } catch (e) { R("Server abort: ", e, " (", e.name, ")"), T(y), g && clearTimeout(g), g = void 0 } }, 15); try { r.submit() } catch (e) { document.createElement("form").submit.apply(r) } } finally { r.setAttribute("action", t), r.setAttribute("enctype", i), e ? r.setAttribute("target", e) : P.removeAttr("target"), L(n).remove() } } l && o && (d.extraData = d.extraData || {}, d.extraData[l] = o), d.forceSync ? c() : setTimeout(c, 10); var w, C, x, k = 50; function T(e) { if (!f.aborted && !x) { if ((C = b(p)) || (R("cannot access response document"), e = y), e === v && f) return f.abort("timeout"), void _.reject(f, "timeout"); if (e == y && f) return f.abort("server abort"), void _.reject(f, "error", "server abort"); if (C && C.location.href != d.iframeSrc || m) { p.detachEvent ? p.detachEvent("onload", T) : p.removeEventListener("load", T, !1); var t, i = "success"; try { if (m) throw "timeout"; var n = "xml" == d.dataType || C.XMLDocument || L.isXMLDoc(C); if (R("isXml=" + n), !n && window.opera && (null === C.body || !C.body.innerHTML) && --k) return R("requeing onLoad callback, DOM not available"), void setTimeout(T, 250); var a = C.body ? C.body : C.documentElement; f.responseText = a ? a.innerHTML : null, f.responseXML = C.XMLDocument ? C.XMLDocument : C, n && (d.dataType = "xml"), f.getResponseHeader = function (e) { return { "content-type": d.dataType }[e.toLowerCase()] }, a && (f.status = Number(a.getAttribute("status")) || f.status, f.statusText = a.getAttribute("statusText") || f.statusText); var s = (d.dataType || "").toLowerCase(), r = /(json|script|text)/.test(s); if (r || d.textarea) { var o = C.getElementsByTagName("textarea")[0]; if (o) f.responseText = o.value, f.status = Number(o.getAttribute("status")) || f.status, f.statusText = o.getAttribute("statusText") || f.statusText; else if (r) { var l = C.getElementsByTagName("pre")[0], c = C.getElementsByTagName("body")[0]; l ? f.responseText = l.textContent ? l.textContent : l.innerText : c && (f.responseText = c.textContent ? c.textContent : c.innerText) } } else "xml" == s && !f.responseXML && f.responseText && (f.responseXML = S(f.responseText)); try { w = A(f, s, d) } catch (e) { i = "parsererror", f.error = t = e || i } } catch (e) { R("error caught: ", e), i = "error", f.error = t = e || i } f.aborted && (R("upload aborted"), i = null), f.status && (i = 200 <= f.status && f.status < 300 || 304 === f.status ? "success" : "error"), "success" === i ? (d.success && d.success.call(d.context, w, "success", f), _.resolve(f.responseText, "success", f), u && L.event.trigger("ajaxSuccess", [f, d])) : i && (void 0 === t && (t = f.statusText), d.error && d.error.call(d.context, f, i, t), _.reject(f, "error", t), u && L.event.trigger("ajaxError", [f, d, t])), u && L.event.trigger("ajaxComplete", [f, d]), u && !--L.active && L.event.trigger("ajaxStop"), d.complete && d.complete.call(d.context, f, i), x = !0, d.timeout && clearTimeout(g), setTimeout(function () { d.iframeTarget ? h.attr("src", d.iframeSrc) : h.remove(), f.responseXML = null }, 100) } } } var S = L.parseXML || function (e, t) { return window.ActiveXObject ? ((t = new ActiveXObject("Microsoft.XMLDOM")).async = "false", t.loadXML(e)) : t = (new DOMParser).parseFromString(e, "text/xml"), t && t.documentElement && "parsererror" != t.documentElement.nodeName ? t : null }, $ = L.parseJSON || function (e) { return window.eval("(" + e + ")") }, A = function (e, t, i) { var n = e.getResponseHeader("content-type") || "", a = "xml" === t || !t && 0 <= n.indexOf("xml"), s = a ? e.responseXML : e.responseText; return a && "parsererror" === s.documentElement.nodeName && L.error && L.error("parsererror"), i && i.dataFilter && (s = i.dataFilter(s, t)), "string" == typeof s && ("json" === t || !t && 0 <= n.indexOf("json") ? s = $(s) : ("script" === t || !t && 0 <= n.indexOf("javascript")) && L.globalEval(s)), s }; return _ } }, L.fn.ajaxForm = function (e) { if ((e = e || {}).delegation = e.delegation && L.isFunction(L.fn.on), !e.delegation && 0 === this.length) { var t = { s: this.selector, c: this.context }; return !L.isReady && t.s ? (R("DOM not ready, queuing ajaxForm"), L(function () { L(t.s, t.c).ajaxForm(e) })) : R("terminating; zero elements found by selector" + (L.isReady ? "" : " (DOM not ready)")), this } return e.delegation ? (L(document).off("submit.form-plugin", this.selector, i).off("click.form-plugin", this.selector, n).on("submit.form-plugin", this.selector, e, i).on("click.form-plugin", this.selector, e, n), this) : this.ajaxFormUnbind().bind("submit.form-plugin", e, i).bind("click.form-plugin", e, n) }, L.fn.ajaxFormUnbind = function () { return this.unbind("submit.form-plugin click.form-plugin") }, L.fn.formToArray = function (e, t) { var i = []; if (0 === this.length) return i; var n, a, s, r, o, l, c, d, u = this[0], h = this.attr("id"), p = e ? u.getElementsByTagName("*") : u.elements; if (p && !/MSIE [678]/.test(navigator.userAgent) && (p = L(p).get()), h && (n = L(':input[form="' + h + '"]').get()).length && (p = (p || []).concat(n)), !p || !p.length) return i; for (a = 0, c = p.length; a < c; a++)if ((r = (l = p[a]).name) && !l.disabled) if (e && u.clk && "image" == l.type) u.clk == l && (i.push({ name: r, value: L(l).val(), type: l.type }), i.push({ name: r + ".x", value: u.clk_x }, { name: r + ".y", value: u.clk_y })); else if ((o = L.fieldValue(l, !0)) && o.constructor == Array) for (t && t.push(l), s = 0, d = o.length; s < d; s++)i.push({ name: r, value: o[s] }); else if (y.fileapi && "file" == l.type) { t && t.push(l); var f = l.files; if (f.length) for (s = 0; s < f.length; s++)i.push({ name: r, value: f[s], type: l.type }); else i.push({ name: r, value: "", type: l.type }) } else null != o && (t && t.push(l), i.push({ name: r, value: o, type: l.type, required: l.required })); if (!e && u.clk) { var m = L(u.clk), g = m[0]; (r = g.name) && !g.disabled && "image" == g.type && (i.push({ name: r, value: m.val() }), i.push({ name: r + ".x", value: u.clk_x }, { name: r + ".y", value: u.clk_y })) } return i }, L.fn.formSerialize = function (e) { return L.param(this.formToArray(e)) }, L.fn.fieldSerialize = function (a) { var s = []; return this.each(function () { var e = this.name; if (e) { var t = L.fieldValue(this, a); if (t && t.constructor == Array) for (var i = 0, n = t.length; i < n; i++)s.push({ name: e, value: t[i] }); else null != t && s.push({ name: this.name, value: t }) } }), L.param(s) }, L.fn.fieldValue = function (e) { for (var t = [], i = 0, n = this.length; i < n; i++) { var a = this[i], s = L.fieldValue(a, e); null == s || s.constructor == Array && !s.length || (s.constructor == Array ? L.merge(t, s) : t.push(s)) } return t }, L.fieldValue = function (e, t) { var i = e.name, n = e.type, a = e.tagName.toLowerCase(); if (void 0 === t && (t = !0), t && (!i || e.disabled || "reset" == n || "button" == n || ("checkbox" == n || "radio" == n) && !e.checked || ("submit" == n || "image" == n) && e.form && e.form.clk != e || "select" == a && -1 == e.selectedIndex)) return null; if ("select" == a) { var s = e.selectedIndex; if (s < 0) return null; for (var r = [], o = e.options, l = "select-one" == n, c = l ? s + 1 : o.length, d = l ? s : 0; d < c; d++) { var u = o[d]; if (u.selected) { var h = u.value; if (h || (h = u.attributes && u.attributes.value && !u.attributes.value.specified ? u.text : u.value), l) return h; r.push(h) } } return r } return L(e).val() }, L.fn.clearForm = function (e) { return this.each(function () { L("input,select,textarea", this).clearFields(e) }) }, L.fn.clearFields = L.fn.clearInputs = function (i) { var n = /^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i; return this.each(function () { var e = this.type, t = this.tagName.toLowerCase(); n.test(e) || "textarea" == t ? this.value = "" : "checkbox" == e || "radio" == e ? this.checked = !1 : "select" == t ? this.selectedIndex = -1 : "file" == e ? /MSIE/.test(navigator.userAgent) ? L(this).replaceWith(L(this).clone(!0)) : L(this).val("") : i && (!0 === i && /hidden/.test(e) || "string" == typeof i && L(this).is(i)) && (this.value = "") }) }, L.fn.resetForm = function () { return this.each(function () { ("function" == typeof this.reset || "object" == typeof this.reset && !this.reset.nodeType) && this.reset() }) }, L.fn.enable = function (e) { return void 0 === e && (e = !0), this.each(function () { this.disabled = !e }) }, L.fn.selected = function (i) { return void 0 === i && (i = !0), this.each(function () { var e = this.type; if ("checkbox" == e || "radio" == e) this.checked = i; else if ("option" == this.tagName.toLowerCase()) { var t = L(this).parent("select"); i && t[0] && "select-one" == t[0].type && t.find("option").selected(!1), this.selected = i } }) }, L.fn.ajaxSubmit.debug = !1 }), define("models/declare", ["backbone", "jquery", "helper", "jquery-form"], function (i, e, a) { return i.Model.extend({ getVerifictionCode: function (e) { var t = this; i.ajax({ type: "POST", url: a.getRESTfulDomain("sms/idcard/" + t.get("phone") + "/notification?app=sms&lang=" + a.getSiteLanguage() + "&region=" + a.getSiteLocation() + "&answer=" + e + "&area=" + a.getArea(t.get("phone"))), error: function (e) { t.trigger("get-validation-failed", e) }, success: function (e) { t.trigger("get-validation-success", e) } }) }, uploadImg: function (e, t) { var n = this; e.ajaxSubmit({ type: "POST", dataType: "json", data: { toThirdPart: t.val() }, headers: { "SMS-Verification-App": "idcard", "SMS-Verification-Code": n.get("code"), "SMS-Verification-Mobile": n.get("phone") }, url: a.getRESTfulDomain("idcard/upload/pic?verificationApp=idcard&verificationCode=" + n.get("code") + "&verificationMobile=" + n.get("phone") + n.get("queryString")), error: function (e, t, i) { n.trigger("img-upload-failed", e.responseText) }, success: function (e, t, i) { n.trigger("img-upload-success", e, i.responseText) } }) }, parseQueryString: function (e) { var t = this; i.ajax({ contentType: "application/json", type: "GET", data: e, url: a.getRESTfulDomain("idcard/decode"), error: function (e) { t.trigger("decode-url-failed", e) }, success: function (e) { t.trigger("decode-url-success", e) } }) }, uploadWithoutImg: function (e) { var t = this; i.ajax({ contentType: "application/x-www-form-urlencoded", type: "POST", headers: { "SMS-Verification-App": "idcard", "SMS-Verification-Code": t.get("code"), "SMS-Verification-Mobile": t.get("phone") }, data: e, url: a.getRESTfulDomain("idcard/upload/nopic"), error: function (e) { t.trigger("no-img-upload-failed", e) }, success: function (e) { t.trigger("no-img-upload-success", e) } }) } }) }), define("views/pages/declare/index", ["templates", "backbone", "models/declare", "helper", "views/others/graphValidate", "sflayer", "jquery-download"], function (t, e, i, l, n, a) { return e.View.extend({ initialize: function () { this.model = new i, this.queryStrings = l.getQueryStrings(), this.queryStrings && this.queryStrings.mcn && this.queryStrings.ts && this.queryStrings.sign ? (this.queryStrings.mcn = this.queryStrings.mcn.substring(0, 32), this.queryStrings.ts = this.queryStrings.ts.substring(0, 13), this.queryStrings.sign = this.queryStrings.sign.substring(0, 32), this.model.set("queryString", this.getQueryStringFromURL()), this.waitTime = 30, this.$phone = this.$("#phone"), this.$name = this.$("#name"), this.$firstUploadButton = this.$("#firstUpload"), this.$notFirstUploadButton = this.$("#notFirstUpload"), this.$validation = this.$("#validation"), this.$cardId = this.$("#cardId"), this.$validationCode = this.$(".validation-code"), this.$orderNo = this.$("#orderNo"), this.$saveToOWT = this.$("#saveToOWT"), this.$toThirdPart = this.$("#toThirdPart"), this.isFirstUpload = !0, this.maxSendPhoneValidationCount = 5, this.sendPhoneValidationCount = 0, this.listenTo(this.model, "img-upload-success", this.imgUploadSuccess).listenTo(this.model, "img-upload-failed", this.imgUploadFailed).listenTo(this.model, "no-img-upload-success", this.noimgUploadSuccess).listenTo(this.model, "no-img-upload-failed", this.noimgUploadFailed).listenTo(this.model, "get-validation-success", this.renderValidationSuccess).listenTo(this.model, "get-validation-failed", this.renderValidationFailed).listenTo(this.model, "decode-url-success", this.decodeUrlSuccess).listenTo(this.model, "decode-url-failed", this.decodeUrlFailed), this.parseQueryString(this.queryStrings)) : this.illegelURLLink() }, events: { "click .primary-button.upload-personal-id": "uploadFile", "click .primary-button.validation-code": "getValidationCode", "click  button#notFirstUpload": "notFirstUpload", "click  button#firstUpload": "firstUpload", "keyup input#orderNo": "checkInputOrderNo", "blur input#orderNo": "checkInputOrderNo", "keyup input#name": "checkInputName", "blur input#name": "checkInputName", "keyup input#phone": "checkInputPhone", "blur input#phone": "checkInputPhone", "keyup input#cardId": "checkInputIdcardNumber", "blur input#cardId": "checkInputIdcardNumber", "change input#idcardFront": "checkIdcardFileChange", "change input#idcardBack": "checkIdcardFileChange", "keyup input": "checkInput", "blur input": "checkInput", "submit form": "uploadFile", "click #proDisagree": "proDisagree", "click #proAgree": "proAgree", "click #close": "proDisagree", "click #cardTypeUl li a": "chooseCardType" }, getQueryStringFromURL: function () { return 0 === location.search.slice(1).length ? "" : "&" + location.search.slice(1).substring(0, 91) }, firstUpload: function () { this.$firstUploadButton.addClass("checked"), this.$notFirstUploadButton.removeClass("checked"), this.$(".first-upload").show(), this.isFirstUpload = !0, this.checkAllInput() }, notFirstUpload: function () { this.$firstUploadButton.removeClass("checked"), this.$notFirstUploadButton.addClass("checked"), this.$(".first-upload").hide(), this.isFirstUpload = !1, this.checkAllInput() }, render: function () { }, uploadFile: function (e) { if (l.isValidPhoneNumber(this.$("#phone").val()) && this.$("#phone").val() === this.model.get("phone")) { var n = {}; if (e && e.preventDefault(), _.each(this.$('form :input[type="text"]'), function (e) { n[e.name] = e.value }), this.$saveToOWT.is(":checked") && this.$saveToOWT.is(":visible") ? (this.$saveToOWT.val(1), n.saveToOWT = 1) : (this.$saveToOWT.val(0), n.saveToOWT = 0), this.$toThirdPart.is(":checked") ? (this.$toThirdPart.val("true"), n.toThirdPart = "true") : (this.$toThirdPart.val("false"), n.toThirdPart = "false"), n.cardType = $("#cardType").val(), this.isFirstUpload) { if (!this.isIdcardImageSelected()) return void this.renderMsg(12); this.model.set("code", this.$validation.val()).uploadImg(this.$("form"), this.$toThirdPart) } else this.$(".primary-button.upload-personal-id").text("提交中...").addClass("disabled"), _.each(this.queryStrings, function (e, t, i) { n[t] = e }), this.model.set("code", this.$validation.val()).uploadWithoutImg(n) } else this.renderMsg(15) }, isIdcardImageSelected: function () { return (isIdcardFrontSelect = "" != this.$("#idcardFront").val()) && (isIdcardBackSelect = "" != this.$("#idcardBack").val()) }, imgUploadSuccess: function (e, t) { this.clearHint(); var i = "500"; try { i = JSON.parse(t).code } catch (e) { i = t } "21" === (i += "") ? this.renderMsg("600") : "9" === i ? this.renderMsg("500") : "004" === i || "002" === i ? this.renderMsg("008") : "003" === i ? this.renderMsg("009") : "0" === i ? this.uploadImgSuccessHint() : this.renderMsg(i), this.disabledUploadButton() }, imgUploadFailed: function (e) { this.clearHint(), this.$("#code-404").addClass("show"), this.disabledUploadButton() }, noimgUploadSuccess: function (e) { this.clearHint(), this.$("#code-7").addClass("show"), 0 != e.code ? this.renderMsg(e.code) : this.uploadImgSuccessHint(), this.disabledUploadButton(), this.$("#notFirstUpload").removeClass("disabled") }, disabledUploadButton: function () { this.$(".primary-button.upload-personal-id").text(_l("提交报关信息")).removeClass("disabled") }, noimgUploadFailed: function (e) { if (this.clearHint(), 403 === e.status) { var t = JSON.parse(e.responseText).code || e.responseText; "21" === t ? this.renderMsg("600") : "004" === t || "002" === t ? this.renderMsg("008") : this.renderMsg("009") } else 400 === e.status ? this.renderMsg("14") : (this.$validationCode.addClass("disabled"), this.$(".primary-button.upload-personal-id").addClass("disabled"), this.renderMsg("#code-000")); this.$(".primary-button.upload-personal-id").text(_l("提交报关信息")) }, clearHint: function () { this.$(".hint").removeClass("show"), this.$(".hint .error.show").removeClass("show") }, uploadImgSuccessHint: function () { this.clearHint(), this.$("#code-0").addClass("show"), this.$(".primary-button.upload-personal-id").toggleClass("disabled", !0), this.disabledAllInput() }, getValidationCode: function (e) { e.preventDefault(), e.stopPropagation(), this.$("#validation-fetch-403").hide(), this.$("#validation-fetch-410").hide(), this.graphValidateLayer = a.open({ title: _l("图形验证码"), area: "380px", skin: "graphValidate", content: t.graphValidate() }), this.graphValidate = new n({ el: ".graphValidate", submitCallBack: this.getValidationCodeSubmit.bind(this) }) }, getValidationCodeSubmit: function (e) { a.close(this.graphValidateLayer); var t = this; if (t.$validation.val(""), t.$validationCode.toggleClass("disabled", !0).data("wait", !0), t.sendPhoneValidationCount > t.maxSendPhoneValidationCount) { t.$("#max-count").show(); window.setInterval(function () { t.$("#max-count4").hide() }, 5e3) } else t.model.set("phone", t.$phone.val()).getVerifictionCode(e) }, renderValidationSuccess: function () { this.clearHint(), this.setTimeOut(), this.$validation.attr({ disabled: !1 }), this.sendPhoneValidationCount += 1 }, renderValidationFailed: function (e) { if (403 === e.status) this.$("#validation-fetch-403").show(), this.setTimeOut(); else if (410 === e.status) this.$("#validation-fetch-410").show(), this.setTimeOut(); else { this.clearHint(), this.$("#validation-fetch-404").show(), this.$validationCode.data("wait", !1), this.setTimeOut(), this.$validation.attr({ disabled: !0 }); window.setInterval(function () { this.$("#validation-fetch-404").hide() }, 5e3) } }, setTimeOut: function () { var e = this, t = e.waitTime; e.$validationCode.text(_l("重新获取") + t).toggleClass("disabled", !0); var i = window.setInterval(function () { if ((t -= 1) <= 0) return window.clearInterval(i), e.$validationCode.text(_l("获取验证码")).data("wait", !1), void (/^\d{11}$/.test(e.$phone.val()) && e.$validationCode.toggleClass("disabled")); e.$validationCode.text(_l("重新获取") + t) }, 1e3) }, renderMsg: function (e) { this.$(".hint").addClass("show"), this.$(".hint .error.show").removeClass("show"), e ? (e = "#code-" + e, this.$(e).addClass("show")) : this.$("#code-2").addClass("show") }, checkAllInput: function () { var e = "" !== this.$name.val() && this.$name.val(), t = l.isValidPhoneNumber(this.$("#phone").val()), i = /^\d{6}$/.test(this.$validation.val()), n = this.validIdcardNumber(), a = this.validOrderNumber(), s = this.checkNameLength(this.$name.val()), r = a && e && s && t && i, o = r && this.isIdcardImageSelected() && n; this.isFirstUpload ? this.$(".primary-button.upload-personal-id").toggleClass("disabled", !o) : this.$(".primary-button.upload-personal-id").toggleClass("disabled", !r) }, checkInput: function (e) { this.checkAllInput() }, checkInputPhone: function (e) { "keyup" === e.type && (this.clearHint(), "phone" === e.currentTarget.id && this.$validation.val("")); var t = l.isValidPhoneNumber(this.$("#phone").val()), i = this.$validationCode.data("wait"); this.$validationCode.toggleClass("disabled", !(t && !i)), this.clearHint(); var n = this.isFirstUpload ? "4" : "4_"; "" === this.$("#phone").val() && (this.clearHint(), this.renderMsg(n)), t || (this.clearHint(), this.renderMsg(n)) }, checkInputOrderNo: function (e) { this.clearHint(); var t = this.isFirstUpload ? "4" : "4_"; "" === this.$orderNo.val() && this.renderMsg(t), this.validOrderNumber() || this.renderMsg("5") }, validOrderNumber: function () { var e = this.$orderNo.val(); return "" != e && e.length <= 35 }, checkInputName: function (e) { this.clearHint(); var t = this.isFirstUpload ? "4" : "4_"; this.checkNameLength(this.$name.val()) || this.renderMsg(t) }, checkNameLength: function (e) { return !("" === (e = (e = encodeURIComponent(e)).replace(/%[A-F\d]{2}/g, "U")) || 60 < e.length) }, checkInputIdcardNumber: function (e) { this.clearHint(), isValidIdcardNumber = this.validIdcardNumber(); var t = this.isFirstUpload ? "4" : "4_"; isValidIdcardNumber || this.renderMsg(t) }, validIdcardNumber: function () { var e = this.$cardId.val(); return "" != e && l.validIdcardNumber(e) }, parseQueryString: function (e) { this.model.parseQueryString(e) }, decodeUrlSuccess: function (e) { return e.configured ? ($("#toThirdPartWrap").show(), $("#toThirdPart").attr("checked", !0)) : $("#toThirdPartWrap").hide(), this.clearHint(), this.showProtocal(), !0 }, decodeUrlFailed: function (e) { this.clearHint(), 404 === e.status ? this.renderMsg(404) : 500 === e.status ? this.renderMsg("000") : this.illegelURLLink() }, illegelURLLink: function () { this.disabledAllInputs(), this.renderMsg(600) }, disabledAllInput: function () { this.$("input").val(""), this.$validation.prop("disabled", !0) }, disabledAllInputs: function () { this.$("input").not("#cardType").val("").prop("disabled", !0), this.$validation.prop("disabled", !0) }, clearHint: function () { this.$(".hint").removeClass("show"), this.$(".hint .error.show").removeClass("show") }, checkIdcardFileChange: function () { this.checkAllInput() }, troggleHint: function (e) { this.$(e).show(); window.setInterval(function () { this.$(e).hide() }, 5e3) }, showProtocal: function () { var e = $("#protocal"); this.resizePop(e), $("body").append('<div id="layerMask" style="background: #aaaaaa;opacity: .3;position: fixed;top: 0;left: 0;width: 100%;height: 100%;z-index:999;"></div>'), e.parent().css("display", "inline"); var t = ($(window).height() - e.height()) / 2 - 100; e.animate({ top: t + "px" }, 500) }, resizePop: function (e) { var t = e.width(), i = e.height(), n = ($(window).width() - t) / 2; $(window).height(); e.css({ left: n + "px", top: "0px", "z-index": 1e3, position: "fixed" }) }, proDisagree: function (e) { $("#layerMask").remove(), $("#protocal").hide(), this.disabledAllInputs() }, proAgree: function () { $("#layerMask").remove(), $("#protocal").hide() }, chooseCardType: function (e) { var t = $(e.currentTarget); $("#cardTypeBtn").text(t.text()), $("#cardType").val(t.data("value")) } }) }), function () { var t, i; function e() { for (var e = 0; e < t.length; e++)$("." + i[e]).length && function (e, t) { require([e], function (e) { "function" == typeof e && (-1 < ["order-page", "acs-order-page"].indexOf(t) ? (new e, Backbone.history.start()) : new e({ el: $("." + t) })) }) }(t[e], i[e]) } t = ["routers/orderDetailRouter", "routers/acsOrderDetailRouter", "views/pages/order/normal/index", "views/query/index", "views/query/abroad/waybill", "views/pages/payFee/payFeePage", "views/pages/store/storeManager", "views/pages/range/range", "views/pages/acceptanceCriteria/index", "views/pages/importExportRule/index", "views/pages/clearance/index", "views/pages/clearanceImageUpload/index", "views/pages/tax/index", "views/pages/claims/index", "views/pages/currency/index", "views/pages/invoices/index", "views/pages/userCenter/userCenter", "views/pages/sfCare/sfCare", "views/pages/sfCare/customsClearance", "views/pages/sfCare/serviceInsideNav", "views/pages/feedback/index", "views/pages/home/index", "views/pages/cooperativeAdvisory/index", "views/pages/cooperativeAdvisory/cooperativeAdvisoryForKR", "views/pages/feedbackAndSuggestion/feedbackAndSuggestionForKR", "views/pages/popularization/index", "views/pages/track/index", "views/pages/regulation/index", "views/pages/consign/index", "views/pages/notIndustry/index", "views/pages/internationalApplication/index", "views/pages/declare/index"], i = ["order-page", "acs-order-page", "new-order-page", "shipping-detail-page", "waybill-abroad", "payFee-page", "store-view", "range-page", "acceptance-criteria-page", "import-export-rule-page", "clearance-page", "clearance-img-upload", "tax", "claim-content", "currency-page", "invoices-page", "user-center", "sf-care", "customs-clearance", "service-inside-nav", "feedback-page", "index-page", "cooperative_cn", "cooperative_kr", "suggestion_kr", "popularization", "track-content", "regulation-page", "consign-page", "notIndustry-page", "internationalApplication_cn", "cmsp_upload_personal_id"], (0, window.define)("views/pages/pageManager", [], function () { return e }) }(), define("views/partials/headHoverItem", ["backbone"], function (e) { return e.View.extend({ initialize: function () { this.$el.find(".topli").each(function () { 0 < $(this).find(".dropdown").length && $(this).children("a").attr("aria-haspopup", !0).attr("aria-expanded", !1) }) }, events: { "mouseenter .topli:not(.log)": "hoverIn", "mouseleave .topli:not(.log)": "hoverOut", "keydown .topli>a": "toggleHover" }, hoverIn: function (e) { var t = $(e.target).closest(".topli"); if (0 < t.find(".dropdown").length) { if (t.find(".dropdown").css("display", "block"), 0 < t.find(".topa").length) { 1280 < t.find(".dropdown").width() && t.find(".innerWrapper").css("white-space", "initial"); var i = t.find(".topa").position().left; 1280 < i + (t.find(".dropdown").width() - 35) ? t.find(".dropdown").css("left", (1280 - t.find(".dropdown").width()) / 2 + "px") : t.find(".dropdown").css("left", i - 35 + "px") } else { var n = t.find(".region").width(); t.find(".region").css("left", 1280 - n - 40 + "px") } if (1 == t.find(".part2").length) { var a = t.find(".topa").width(); t.find(".part2").css("min-width", a) } } }, hoverOut: function (e) { var t = $(e.target).closest(".topli"); 0 < t.find(".dropdown").length && t.find(".dropdown").css("display", "none") }, toggleHover: function (e) { if (32 == e.which) { e.preventDefault(); var t = $(e.target).closest(".topli"); return t.siblings().find(".dropdown").hide().end().find('[aria-expanded="true"]').attr("aria-expanded", !1), 0 < t.find(".dropdown").length && (t.find(".dropdown").is(":visible") ? (t.trigger("mouseleave"), $(e.target).attr("aria-expanded", !1)) : (t.trigger("mouseenter"), $(e.target).attr("aria-expanded", !0))), !1 } } }) }), define("components/phoneInput", ["backbone", "helper"], function (e, n) { return e.View.extend({ data: { showAreaCodeSelect: !0, areaCodeCanEdit: !0, region: "cn", phone: "", area: "", valid: !1, callback: null }, areas: [{ name: "中国内地", tname: "中國大陸", region: "cn", code: "86", regx: /^1\d{10}$/ }, { name: "中国香港", tname: "香港", region: "hk", code: "852", regx: /^[5689]{1}\d{7}$/ }, { name: "中国澳门", tname: "澳門", region: "mo", code: "853", regx: /^6\d{7}$/ }, { name: "中国台湾", tname: "台灣", region: "tw", code: "886", regx: /^[0]{0,1}9\d{8}$/ }], events: { "keyup input": "onValidate", "click .selected-flag": "onToggleRegionOpts", "click .country": "onSelectRegion" }, initialize: function (e, t) { var i = this; this.areas.map(function (e) { e.region.toLowerCase() === n.getSiteLocation().toLowerCase() && (i.data.region = e.region) }), this.data = _.extend({}, this.data, t), this.areas.map(function (e) { i.data.region === e.region && (i.data.area = e.code, i.data.name = e.name, i.data.tname = e.tname) }), this.$el.val(this.data.phone), this.$el.wrap("<div class='intl-tel-input allow-dropdown separate-dial-code iti-sdc-4'></div>"), this.$el = this.$el.closest(".intl-tel-input"), this.render(), this.onValidate(), $("body").click(function () { i.$(".country-list").hide() }) }, onValidate: function () { for (var e, t = -1, i = this.$("input").val(); ++t < this.areas.length;)if (e = this.areas[t], this.data.area === e.code) { this.data.valid = e.regx.test(i); break } if (this.data.valid ? this.$("input").addClass("success-indicator").removeClass("warning-indicator") : this.$("input").addClass("warning-indicator").removeClass("success-indicator"), this.data.callback && this.data.callback(this.data.valid, "86" === this.data.area ? "" : this.data.area, i), _.isEmpty(i)) return this.$("input").removeClass("success-indicator warning-indicator") }, onSelectRegion: function (e) { var t = $(e.currentTarget), i = this.data.area = t.attr("data-dial-code"), n = t.attr("data-region"), a = t.find(".country-name").text(); this.$(".selected-flag .iti-flag").attr("class", "iti-flag " + n), this.$(".selected-flag .selected-dial-code").html("+" + i), this.$(".flag-container").attr("title", a), this.onValidate() }, onToggleRegionOpts: function (e) { this.data.areaCodeCanEdit && (e.stopPropagation(), this.$(".country-list").toggle()) }, render: function () { var t = ""; return this.data.showAreaCodeSelect ? (this.$el.prepend("<div class='flag-container' title='" + ("tw" === n.getSiteLocation() ? _l(this.data.tname) : _l(this.data.name)) + "'><div class='selected-flag'><span class='selected-dial-code'>+" + this.data.area + "</span><i class='iti-arrow'></i></div><ul class='country-list'></ul></div>"), this.areas.map(function (e) { t += '<li class="country" data-dial-code="' + e.code + '" data-region="' + e.region + '"><span class="country-name">' + ("tw" === n.getSiteLocation() ? _l(e.tname) : _l(e.name)) + '</span><span class="dial-code">+' + e.code + "</span></li>" }), this.$(".country-list").html(t).hide(), this.data.areaCodeCanEdit || this.$(".iti-arrow").hide()) : (this.$el.addClass("hideAreaCode"), this.$(".flag-container").hide()), this }, isValid: function () { return this.data.valid }, getAreaCode: function () { return "86" === this.data.area ? "" : this.data.area }, getPhone: function () { var e = this.$("input").val(); return "886" === this.data.area && e.startsWith("9") && (e = "0" + e), e }, setPhone: function (e) { this.$("input").val(e), this.onValidate() } }) }), define("views/partials/loginCn", ["backbone", "templates", "components/phoneInput", "helper", "event", "views/others/countDownButton", "views/others/graphValidate", "sflayer"], function (e, i, n, a, t, s, r, o) { return e.View.extend({ initialize: function () { this.hasQrCode = !0, this.judgeLogin(), this.listenTo(t, t.Needlogin, this.needlogin), this.listenTo(t, t.impNeedlogin, this.impNeedlogin), this.listenTo(t, t.RegisterLoginCallback, this.registerLoginCallback) }, events: { "click .quickLogin a": "preshowLoginModal", "click .login_validation_code": "getValidationCode", "keydown #login_mobile": "regInput", "keydown #login_code": "regInput", "blur #login_code": "regCode", "click .verification_quick_login": "login", "click .refresh-btn": "openQRCode", "click .tab-li": "toggleQRCode", "click #tab2 a": "tabContentEvent" }, impNeedlogin: function (e) { this.registerSucc = null, this.registerCancel = null, this.needlogin(e) }, needlogin: function (e) { e && (this.succCallback = e.succCallback, this.cancelCallback = e.cancelCallback), $.cookie("loginUser", null, { path: "/" }), this.judgeLogin(), this.showLoginModal() }, registerLoginCallback: function (e) { e && ("function" == typeof e ? this.registerSucc = e : (this.registerSucc = e[0], this.registerCancel = e[1])) }, judgeLogin: function () { this.$(".topli.log").hide(), $.cookie("loginUser") ? this.$(".quickLogout").find(".head-user-number").text(a.handleStr($.cookie("loginUser"))).end().show() : this.$(".quickLogin").show() }, preshowLoginModal: function () { this.succCallback = null, this.cancelCallback = null, this.showLoginModal() }, getMemberUrl: function () { return a.getURLWithContext("login_register/") }, showLoginModal: function () { var e = { verification: !0, QRcode: this.hasQrCode, password: !1 }, t = this; this.loginLayer = o.open({ title: " ", area: "417px", skin: "line", content: i.loginWindow({ logtype: e, termUrl: a.getURLWithContext("other/terms_service/"), memberUrl: this.getMemberUrl() }), cancel: function () { t.cancelLogin() } }), this.phoneInput = new n({ el: this.$("#login_mobile") }, { showAreaCodeSelect: !0, callback: this.activeBtnStatus.bind(this) }), new s({ el: this.$(".login_validation_code").parent() }), e.QRcode && this.$(".qrcode-tab").hasClass("active") && this.openQRCode(), 0 < $("#sender-mobile").length && this.$("#login_mobile").val($("#sender-mobile").val()), this.$("#login_mobile").trigger("keyup") }, activeBtnStatus: function (e) { this.$(".login_validation_code").trigger("shouldBeActive", e) }, hideErrorTips: function () { this.$(".loginWindow .error").hide() }, regInput: function () { setTimeout(function () { "" === $("#login_mobile").val().trim() || "" === $("#login_code").val().trim() ? $(".verification_quick_login").addClass("disabled") : $(".verification_quick_login").removeClass("disabled") }) }, regCode: function () { this.hideErrorTips(); var e = this.$("#login_code").val(); /^\d{6}$/.test(e) || "" === $.trim(e) ? this.validationCodeError = !1 : (this.$(".validation-code-error").show(), this.validationCodeError = !0) }, getValidationCode: function (e) { e.preventDefault(), this.graphValidateLayer = o.open({ title: _l("图形验证码"), area: "380px", skin: "graphValidate", content: i.graphValidate() }), this.graphValidate = new r({ el: ".graphValidate", submitCallBack: this.getSMSCodefromServer.bind(this) }) }, getSMSCodefromServer: function (e) { var t = this.phoneInput.getPhone(), i = this.phoneInput.getAreaCode(); this.hideErrorTips(); var n = this; sfAjax.smsUserNotification({ params: { app: "sms", mobile: t, answer: e, area: i }, success: function () { o.close(n.graphValidateLayer), n.renderValidationSuccess() }, error: function (e) { 403 == e.status ? (n.graphValidate.graphInputErr(), n.graphValidate.getNewGraph()) : (o.close(n.graphValidateLayer), n.renderValidationFailed(e)) } }) }, renderValidationFailed: function (e) { 410 == e.status ? this.$(".loginWindow .limit-send-sms").show() : 400 == e.status ? (this.$("#login_mobile").focus(), this.$(".loginWindow .telNO-err").show()) : this.$(".loginWindow .get-validation-code-failed").show() }, renderValidationSuccess: function () { this.$(".login_validation_code").trigger("start"), this.$("#login_code").val("") }, login: function (e) { if (this.validationCodeError) this.$(".validation-code-error").show(); else { this.$(e.target).button("loading").prop("disabled", !0); var t = this.$("#login_code").val(); this.mobile = this.phoneInput.getPhone(), this.area = this.phoneInput.getAreaCode(); var i = this; sfAjax.login({ params: { rememberMe: $("#pwdRemeber").prop("checked") }, headers: { "SMS-Verification-App": "user", "SMS-Verification-Code": t, "SMS-Verification-Mobile": this.mobile, "SMS-Verification-Mobile-Area": this.area, isRegister: !0 }, error: function () { i.hideErrorTips(), i.$("#login_code").focus(), i.$(".validation-code-network-error").show() }, success: function (e) { i.hideErrorTips(), 0 === e.code ? i.loginSucc() : 120 === e.code ? i.showTerms() : 122 === e.code ? i.$(".login-err").show() : 111 === e.code ? i.$(".validation-code-error").show() : 112 === e.code ? i.$(".validation-code-param-error").show() : 113 === e.code ? i.$(".validation-not-send").show() : 114 === e.code ? i.$(".validation-code-expired").show() : 115 === e.code ? i.$(".validation-code-count-expired").show() : i.$(".validation-code-network-error").show() }, complete: function () { i.$(e.target).button("reset").prop("disabled", !1) } }) } }, showTerms: function () { $(window).resize(function () { $("iframe").height() > $(this).height() - 364 ? $("iframe").css("height", $(this).height() - 364) : $("iframe").css("height", "auto") }); var t = this, e = a.getURLWithContext("other/modal/terms_service.html"); layer.open({ title: _l("服务条款及隐私条款"), type: 2, area: ["960px"], content: [e, "no"], btn: [_l("同意条款并注册会员")], yes: function (e) { sfAjax.regist({ params: { rememberMe: $("#pwdRemeber").prop("checked"), mobile: t.mobile }, headers: { "SMS-Verification-Mobile": t.mobile, "SMS-Verification-Mobile-Area": t.area }, success: function (e) { 0 === e.code ? t.loginSucc() : o.msg(_l("注册失败")) }, error: function () { o.msg(_l("注册失败")) }, complete: function () { o.close(e), $(window).scrollTop(0) } }) } }), $(window).resize() }, loginSucc: function () { o.close(this.loginLayer), this.judgeLogin(), this.succCallback && this.succCallback(), this.registerSucc && this.registerSucc(), this.closeQRCode() }, cancelLogin: function () { this.cancelCallback && this.cancelCallback(), this.registerCancel && this.registerCancel(), this.closeQRCode(), o.close(this.loginLayer) }, toggleQRCode: function (e) { var t = $(e.currentTarget); t.hasClass("qrcode-tab") ? t.hasClass("active") || this.openQRCode() : this.closeQRCode() }, refreshQRCode: function () { this.loop && this.$(".qrcode-pane .scan-img").attr("src", a.getRESTfulDomain("user/qrcode/getqrcode") + "?timestamp=" + (new Date).getTime()) }, resetQRCode: function () { this.$(".scan-img").show(), this.$(".scan-success").hide(), this.$(".scan-abate").hide(), this.refreshQRCode(), this.setQRCodeInfo(0) }, setQRCodeInfo: function (e) { $(".QRinfo").html(_l({ 0: "请使用微信扫描二维码", 10: "请在手机上登录顺丰官网", 11: "请在手机上确认", 2: "二维码已失效" }[e])) }, closeQRCode: function () { this.loop && (clearInterval(this.loop), this.refreshQRCode()) }, openQRCode: function () { var t = this; this.loop && clearInterval(this.loop), this.loop = setInterval(function () { sfAjax.qrLoginCheck({ data: { timestamp: (new Date).getTime(), rememberMe: $("#QRremember").prop("checked") }, success: function (e) { switch (e.code) { case 0: t.renderQRstatus(e.result); break; case 126: case 131: case 101: case 125: t.renderAbateStatus() } } }) }, 2e3), this.resetQRCode() }, renderQRstatus: function (e) { switch (e.status) { case 0: break; case 1: $(".scan-img").hide(), $(".scan-success").show(), this.setQRCodeInfo(e.login ? 11 : 10); break; case 2: this.renderAbateStatus(); break; case 3: this.loginSucc() } }, renderAbateStatus: function () { $(".scan-img").show(), $(".scan-success").hide(), $(".scan-abate").show(), this.setQRCodeInfo(2), this.loop && clearInterval(this.loop) }, tabContentEvent: function (e) { switch ($(e.target).data("type")) { case 1: sfgather.trackClicks("点击速运会员登录", "126001"); break; case 2: sfgather.trackClicks("点击速运月结积分登录", "126002"); break; case 3: sfgather.trackClicks("点击国际月结客户登录", "126003"); break; case 4: sfgather.trackClicks("点击优选会员登录", "126004"); break; case 5: sfgather.trackClicks("点击金融会员登录", "126005") } } }) }), define("views/partials/loginHmt", ["views/partials/loginCn", "helper", "sflayer"], function (e, t) { return e.extend({ initialize: function () { e.prototype.initialize.apply(this, arguments), this.hasQrCode = !1 }, events: _.extend({ "click .quickLogout .logout": "logout" }, e.prototype.events), getMemberUrl: function () { return "en" == t.getSiteLanguage() ? "https://i.sf-express.com/orgin/" + t.getSiteLocation() + "/en/login.html" : "https://i.sf-express.com/orgin/" + t.getSiteLocation() + "/tc/login.html" }, logout: function () { var e = this; sfAjax.logout({ success: function () { $.cookie("loginUser", null, { path: "/" }), e.judgeLogin() }, error: function () { layer.msg(_l("网络错误")) } }) }, judgeLogin: function () { this.$(".topli.log").hide(), $.cookie("loginUser") ? this.$(".quickLogout").find('[data-toggle="dropdown"]').html(t.handleStr($.cookie("loginUser")) + ' <span class="caret"></span>').end().show() : this.$(".quickLogin").show() } }) }), define("views/partials/loginRoute", ["baseView", "helper", "views/partials/loginCn", "views/partials/loginHmt"], function (e, t, i, n) { return e.extend({ init: function () { this.region = t.getSiteLocation() }, render: function () { "cn" == this.region ? new i({ el: this.$el }) : "hk" != this.region && "tw" != this.region || new n({ el: this.$el }) } }) }), define("views/partials/switchRegionAndLanguage", ["backbone", "helper"], function (e, t) { return e.View.extend({ events: { "click a": "switchRegionAndLanguage" }, switchRegionAndLanguage: function (e) { e.preventDefault(), t.switchRegionAndLanguage($(e.target).data("region"), $(e.target).data("language")) } }) }), function (r, t, e) { "$:nomunge"; var i, n = r([]), a = r.resize = r.extend(r.resize, {}), o = "setTimeout", s = "resize", l = s + "-special-event", c = "delay", d = "throttleWindow"; a[c] = 250, a[d] = !0, r.event.special[s] = { setup: function () { if (!a[d] && this[o]) return !1; var e = r(this); n = n.add(e), r.data(this, l, { w: e.width(), h: e.height() }), 1 === n.length && function e() { i = t[o](function () { n.each(function () { var e = r(this), t = e.width(), i = e.height(), n = r.data(this, l); t === n.w && i === n.h || e.trigger(s, [n.w = t, n.h = i]) }), e() }, a[c]) }() }, teardown: function () { if (!a[d] && this[o]) return !1; var e = r(this); n = n.not(e), e.removeData(l), n.length || clearTimeout(i) }, add: function (e) { if (!a[d] && this[o]) return !1; var s; function t(e, t, i) { var n = r(this), a = r.data(this, l); a.w = void 0 !== t ? t : n.width(), a.h = void 0 !== i ? i : n.height(), s.apply(this, arguments) } if (r.isFunction(e)) return s = e, t; s = e.handler, e.handler = t } } }(jQuery, this), define("jqresize", function () { }), define("views/partials/totop", ["backbone", "jqresize"], function (e) { return e.View.extend({ events: { "click .botfooter .toTop": "scrollToTop", "mouseenter .botfooter .toTop": "changBlack", "mouseleave .botfooter .toTop": "returnToRed" }, initialize: function () { var e = this; $(window).scroll(function () { e.init() }), $(window).resize(function () { e.init() }), $("body").resize(function () { e.init() }) }, init: function () { var e = this.$(".botfooter .toTop"), t = $(window).height(), i = this.$(".botfooter")[0].offsetHeight, n = this.$el.height(), a = $(window).scrollTop(), s = n - a - t; 100 < a ? e.fadeIn(500) : e.fadeOut(500), s <= i + 10 ? e.removeClass("fixed") : e.addClass("fixed") }, scrollToTop: function () { $("html,body").animate({ scrollTop: 0 }, 300) }, changBlack: function () { $(".botfooter .toTop").addClass("active") }, returnToRed: function () { $(".botfooter .toTop").removeClass("active") } }) }), define("views/partials/cookieAgree", ["backbone", "helper"], function (e, n) { !function () { var e = { days: 365, on: !0, content: ["<h1>Cookies使用策略</h1><p>我们的网站使用cookies以改进我们的网站和改善用户体验。</p><p>如您继续浏览本网站而未更改浏览器cookie设置，视为同意我们的cookies使用策略。</p>", "<h1>Cookies Policy</h1><p>Our website uses cookies to improve our website and user experience.</p><p>If you continue to browse our website and do not change the cookie settings of the browser, you are deemed to agree on our Cookies Policy.</p>"], agreeTxt: ["同意", "Agree"], policyTxt: ["Cookies政策", "Cookie Policy"], html: ['<div class="cookieCon downAndUp1024">', '\t<div id="headwarp_0_cookieDialog" class="cookieTip">', '\t\t<div class="cookieInfo"></div>', '\t\t<div class="policyOperate">', '\t\t\t<span class="agreeCookie"></span>', '\t\t\t<span class="disagreeCookie" style="display:none"></span>', '\t\t\t<span class="infoCookie"></span>', "\t\t</div>", "\t</div>", "</div>"].join("") }, t = n.getSiteLocation(); if (e.on && "cn" === t && !$.cookie("cookie-agree")) { $.cookie("cookie-agree", "true", { path: "/" }); var i = "sc" === n.getSiteLanguage() ? 0 : 1; $("body").prepend(e.html), $(".cookieTip .cookieInfo").html(e.content[i]), $(".cookieTip .agreeCookie").html(e.agreeTxt[i]), $(".cookieTip .infoCookie").html(e.policyTxt[i]), $(".agreeCookie").bind("click", function () { $.cookie("cookie-agree", "true", { expires: e.days, path: "/" }), $(".cookieTip").hide() }), $(".infoCookie").bind("click", function () { var e = n.getURLWithContext("cookie_policy/"); window.location.href = e }) } }() }), define("views/partials/index", ["./headHoverItem", "./loginRoute", "./switchRegionAndLanguage", "./totop", "./cookieAgree"], function (e, t, i, n) { return Backbone.View.extend({ initialize: function () { new e({ el: $(".topheader") }), new t({ el: $("body") }), new i({ el: $(".topheader .region") }), 0 < $(".botfooter .toTop").length && new n({ el: $("body") }), $("body").on("click", function (e) { var t = (e = window.event || e).currentTarget || e.toElement || e.srcElement || e.originalEvent || e.target; $(".location-picker").hide(), /ui-menu-item/.test(t.className) || $(".toggle-plugins").hide() }) } }) }), define("views/others/goDynamic", ["backbone", "helper"], function (e, n) { return e.View.extend({ events: { "click .go-dynamic": "locationChange", "click .go-root": "goRoot" }, goRoot: function (e) { e.preventDefault(), location.href = n.getURLWithContext("/") }, locationChange: function (e) { e.preventDefault(); var t = $(e.currentTarget); if (t.data("with-return-page")) return "_blank" === t.attr("target") ? window.open(t.attr("href") + "?return-page=" + escape(location)) : location.href = t.attr("href") + "?return-page=" + escape(location), !1; if (t.data("go-back")) { var i = n.getQueryStrings(); return i && i["return-page"] ? location.href = i["return-page"] : location.href = t.attr("href"), !1 } t.data("new-window") ? window.open(n.getDynamicURLWithContext(t.data("location"))) : location.href = n.getDynamicURLWithContext(t.data("location")) } }) }), define("views/others/inputIndicator", ["backbone"], function (e) { return e.View.extend({ events: { "keyup input": "inputKeyupTriggered", "change .phone-number-area": "selectChangeTriggered" }, selectChangeTriggered: function (e) { var t = this.$("#hk-area-list").val(), i = this.$(".phone-number-input"); null == t ? hasValidationReg = /^1\d{10}$/ : "852" == t ? hasValidationReg = /^[569]{1}\d{7}$/ : "853" == t ? hasValidationReg = /^6\d{7}$/ : "886" == t && (hasValidationReg = /^[0]{0,1}9\d{8}$/), hasValidationReg.test(i.val()) ? (i.toggleClass("success-indicator", !0), i.toggleClass("warning-indicator", !1)) : (i.toggleClass("success-indicator", !1), i.toggleClass("warning-indicator", !0)) }, inputKeyupTriggered: function (e) { var t = $(e.currentTarget), i = t.data("validation-regexp"), n = !1, a = this.$("#hk-area-list").val(); if (i) { if (":phone" === i ? (null == a ? i = /^1\d{10}$/ : "852" == a ? i = /^[569]{1}\d{7}$/ : "853" == a ? i = /^6\d{7}$/ : "886" == a && (i = /^[0]{0,1}9\d{8}$/), n = i.test(t.val())) : ":subPhone" === i && (n = /^1\d+$/.test(t.val()) ? /^1\d{10}$/.test(t.val()) : /^8\d{10,12}$/.test(t.val()) || /^[569]{1}\d{7}$/.test(t.val()) || /^6\d{7}$/.test(t.val()) || /^[0]{0,1}9\d{8}$/.test(t.val())), _.isEmpty(t.val())) return t.toggleClass("success-indicator", !1), void t.toggleClass("warning-indicator", !1); n ? (t.toggleClass("success-indicator", !0), t.toggleClass("warning-indicator", !1)) : (t.toggleClass("success-indicator", !1), t.toggleClass("warning-indicator", !0)) } } }) }), define("views/others/share", ["backbone", "helper", "jqueryQrcode"], function (e, g) { return e.View.extend({ initialize: function () { var e = this.$el, t = e.find(".xinlang"), i = encodeURIComponent(t.data("title")), n = e.find(".qq"), a = e.find(".douban"), s = e.find(".in"), r = e.find(".facebook"), o = e.find(".naver"), l = e.find(".whatsapp"), c = e.find(".twitter"), d = e.find(".googleplus"), u = e.find(".reddit"), h = e.find(".zalo"); t.attr("href", "http://v.t.sina.com.cn/share/share.php?url=" + window.location.href + "&title=" + i), n.attr("href", "http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=" + window.location.href + "&title=" + i), a.attr("href", "http://shuo.douban.com/!service/share?href=" + window.location.href + "&title=" + i), s.attr("href", "http://www.linkedin.com/shareArticle?mini=true&url=" + window.location.href + "&title=" + i), r.attr("href", "https://www.facebook.com/sharer/sharer.php?u=" + window.location.href + "&t=" + i), o.attr("href", "http://share.naver.com/web/shareView.nhn?url=" + window.location.href + "&title=" + i), l.attr("href", "https://api.whatsapp.com/send?text=" + window.location.href), c.attr("href", "http://twitter.com/home?status=" + window.location.href + "&title=" + i), u.attr("href", "http://www.reddit.com/submit?url=" + window.location.href + "&title=" + i), d.attr("href", "https://plus.google.com/share?url=" + window.location.href + "&title=" + i), h.attr("href", "https://wordpress.org/plugins/like-share-zalo-button/"); var p = e.find(".weixin").data("urltext"); if ($qrcodeCanvas = e.find("#qrcodeCanvas"), p) { var f = $qrcodeCanvas.qrcode({ render: "canvas", text: p, width: "200", height: "200", background: "#ffffff", foreground: "#000000" }), m = new Image; m.src = g.getResourceURL("images/about_us/SF_logo.png"), m.onload = function () { f.children("canvas")[0].getContext("2d").drawImage(m, 80, 80, 40, 40) } } else "cn" == g.getSiteLocation() ? $qrcodeCanvas.html('<img src="' + g.getResourceURL("images/index/sf-code-img.jpg") + '" style="width:100%"/>') : "hk" == g.getSiteLocation() ? $qrcodeCanvas.html('<img src="' + g.getResourceURL("images/index/sfwechat_hk.jpg") + '" style="width:100%"/>') : $qrcodeCanvas.html('<img src="' + g.getResourceURL("images/index/sfwechat_international.png") + '" style="width:100%"/>') } }) }), define("views/others/orderButton", ["backbone", "helper"], function (e, t) { return e.View.extend({ initialize: function () { var e = this.$el, t = e.width(), i = e.find(".arrow"), n = e.find(".flash"), a = e.find(".icon"), s = a.attr("src"); e.hover(function () { a.attr("src", s), a.show(), e.animate({ paddingLeft: 15, paddingRight: 15 }), i.animate({ opacity: 1 }), n.animate({ left: t }) }, function () { e.removeClass("hover"), e.animate({ paddingLeft: 0, paddingRight: 0 }), i.animate({ opacity: 0 }), n.hide().css({ left: "-101px" }) }) } }) }), define("views/others/video/videoMask", ["backbone"], function (e) { return e.View.extend({ el: $("#video-box"), events: { "click a.close": "videoClose" }, initialize: function (e) { this.videoUrl = e.videoUrl, this.hasShortVideo = e.hasShortVideo }, showMask: function () { this.$el.show(), Player = jwplayer("video").setup({ stretching: "fill", flashplayer: jwplayerFlashSwf, file: this.videoUrl, width: 960, height: 540, autostart: !0, skin: { name: "glow", url: jwplayerSkin } }) }, videoClose: function (e) { e.preventDefault(), Player.remove(), this.$el.hide(), this.hasShortVideo && playerShort.play() } }) }), define("views/others/video/video", ["backbone", "./videoMask", "helper"], function (e, i, n) { return e.View.extend({ events: { "click a.play": "videoPop" }, initialize: function () { var e = this.$el; if (this.videoShort = e.find("#videoShort"), this.aPlay = e.find(".play"), this.videoMaskView = new i({ videoUrl: this.aPlay.attr("data-video"), hasShortVideo: this.videoShort[0] }), jwplayer.key = "N2Z47h5lEkdFZFPwrPS0j5p+FH3UmaACS13lzg==", jwplayerFlashSwf = n.getResourceURL("scripts/old/jwplayer-7.9.1/jwplayer.flash.swf"), jwplayerSkin = n.getResourceURL("scripts/old/jwplayer-7.9.1/skins/glow.css"), 0 < this.videoShort.length) { playerShort = jwplayer("videoShort").setup({ stretching: "fill", file: this.videoShort.attr("data-videoShort"), flashplayer: jwplayerFlashSwf, height: 488, repeat: !0, controls: !1, mute: !0, autostart: !0 }); var t = this; playerShort.on("ready", function () { t.aPlay.css("display", "block") }) } }, videoPop: function (e) { e.preventDefault(), e.stopPropagation(), this.videoShort[0] && ("playing" != playerShort.getState() && "buffering" != playerShort.getState() || playerShort.pause()), this.videoMaskView.showMask() } }) }), define("views/others/bannertip", ["backbone"], function (e) { return e.View.extend({ initialize: function () { var e = this.$el; e.hover(function () { e.stop(!0, !1).animate({ right: "0px" }, 500) }, function () { e.stop(!0, !1).animate({ right: "-177px" }, 500) }), setTimeout(function () { e.stop(!0, !1).animate({ right: "-177px" }, 500) }, 3e3) } }) }), define("views/others/secondNavigation", ["backbone"], function (e) { return e.View.extend({ events: { "click .slideToggle>a": "toggleSubMenu" }, toggleSubMenu: function (e) { e.preventDefault(); var t = $(e.currentTarget), i = t.siblings(".block-holder"); t.parent().hasClass("expand") ? (t.parent().removeClass("expand").end().attr("aria-expanded", !1), i.slideUp(300)) : (t.parent().addClass("expand").end().attr("aria-expanded", !0), i.slideDown(300)) }, initialize: function () { this.$(".current").children("a").attr("aria-checked", !0), 0 < this.$(".current").parents(".slideToggle").length && this.$(".current").parents(".slideToggle").addClass("expand").children(".block-holder").slideDown() } }) }), define("views/others/swiper", ["backbone", "swiper"], function (e) { return e.View.extend({ initialize: function () { var e = this.$el, t = e.find(".swiper-pagination"), i = (e.find(".swiper-button-next"), e.find(".swiper-button-prev"), !!e.closest("#banner")[0]), n = (e.closest("#tab1")[0], e.closest("#tab2")[0], !!e.closest("#tab3")[0]), a = !!e.closest("#case-share")[0], s = !!e.closest("#exSquare")[0], r = !!e.closest("#exStation")[0], o = !!e.closest(".relatedVideo")[0]; if (s) 3 == new Swiper(e[0], { nextButton: e.closest("#exSquare").find(".swiper-button-next")[0], prevButton: e.closest("#exSquare").find(".swiper-button-prev")[0], slidesPerView: 3, spaceBetween: 80, watchSlidesProgress: !0, watchSlidesVisibility: !0, lazyLoading: !0 }).slides.length && (e.closest("#exSquare").find(".swiper-button-next").css("display", "none"), e.closest("#exSquare").find(".swiper-button-prev").css("display", "none")); else if (r) new Swiper(e[0], { loop: !0, autoplay: 3e3, speed: 1e3, slidesPerView: 4, spaceBetween: 15, pagination: t[0], paginationClickable: !0, autoplayDisableOnInteraction: !1, watchSlidesProgress: !0, watchSlidesVisibility: !0, lazyLoading: !0 }); else if (o) { 3 == new Swiper(e[0], { nextButton: e.closest(".relatedVideo").find(".swiper-button-next")[0], prevButton: e.closest(".relatedVideo").find(".swiper-button-prev")[0], slidesPerView: 3, spaceBetween: 80, watchSlidesProgress: !0, watchSlidesVisibility: !0, lazyLoading: !0 }).slides.length && (e.closest(".relatedVideo").find(".swiper-button-next").css("display", "none"), e.closest(".relatedVideo").find(".swiper-button-prev").css("display", "none")) } else new Swiper(e[0], { loop: !n && !a, autoplay: i ? 3e3 : 2e3, speed: 2e3, pagination: n ? null : a ? null : t[0], paginationClickable: !0, slidesPerView: a ? 4 : 1, noSwiping: !0, autoplayDisableOnInteraction: !1 }) } }) }), define("views/others/accessibleHover", ["backbone"], function (e) { return e.View.extend({ initialize: function () { this.$(".hover-elem").attr("aria-expanded", !1); var e = this.$el; e.hover(function () { e.addClass("hover"), e.find(".hover-elem").attr("aria-expanded", !0) }, function () { e.removeClass("hover"), e.find(".hover-elem").attr("aria-expanded", !1) }) }, events: { "keydown .hover-elem": "toggleHover" }, toggleHover: function (e) { if (32 == e.which) return e.preventDefault(), this.$el.siblings(".hover").removeClass("hover").find(".hover-elem").attr("aria-expanded", !1), this.$el.toggleClass("hover"), this.$el.hasClass("hover") ? this.$(e.currentTarget).attr("aria-expanded", !0) : this.$(e.currentTarget).attr("aria-expanded", !1), !1 } }) }), define("views/others/mailServiceNav", ["backbone"], function (e) { return e.View.extend({ initialize: function () { var e = this.$el, t = e.find("#header"), i = e.find(".t_banner"), n = e.find(".tabs_nav_fa"), a = e.find(".tab_container"); $(window).scroll(function () { var e = $(window).scrollTop(); t.height() + i.height() <= e ? (n.addClass("fixed"), a.css("margin-top", "150px")) : (n.removeClass("fixed"), a.css("margin-top", "60px")) }) } }) }), define("views/others/arrowswitch", ["backbone"], function (e) { return e.View.extend({ events: { "click .sub": "switchArrow" }, switchArrow: function (e) { $(e.target).parent().hasClass("arrowup") ? ($(e.target).parent().removeClass("arrowup").addClass("arrowdown"), $(e.target).parent().parent().next().slideUp(500)) : ($(e.target).parent().removeClass("arrowdown").addClass("arrowup"), $(e.target).parent().parent().next().slideDown(500)) } }) }), define("views/others/ifaDownload", ["backbone", "helper", "const"], function (t, i, s) { return t.View.extend({ events: { "click .downloadLink a": "popForm", "click .ifa_modal .close": "closeForm", "click .validate-code-btn": "refreshValidationCode", "click #submit": "saveInfo" }, initialize: function () { this.$el.find(".downloadLink a").css("pointer-events", "auto"), null == this.$el.find(".downloadLink a").attr("download") && this.$el.find(".downloadLink a").attr("download", "") }, popForm: function (e) { "1" != window.localStorage.getItem(s.ALREADY_IFA_VISITOR) && (e.preventDefault(), this.errorCode = [], this.refreshValidationCode(), this.$el.find(".ifa_modal").show(), $("body").css("overflow", "hidden"), this.$href = $(e.target).attr("href"), this.$download = $(e.target).attr("download")) }, closeForm: function () { $("body").css("overflow", "auto"), this.$el.find(".ifa_modal").hide() }, saveInfo: function (e) { if (e.preventDefault(), this.errorCode.splice(0, this.errorCode.length), this.validateUser(), this.validateMobile(), this.validateCompany(), this.validateEmail(), this.validateCode(), 0 === this.errorCode.length) { this.$submit = this.$el.find("#submit"); var t = this.$el.find("form").serializeArray(), i = {}; for (var n in t) i[t[n].name] = t[n].value; i.source = _l("速运"), this.$submit.attr("disabled", "true").text(_l("提交中...")), this.saveInfoAjax(JSON.stringify(i)) } }, saveInfoAjax: function (e) { var a = this; t.ajax({ type: "post", url: i.getRESTfulDomain("cudp/saveCoopConsult?app=cooperative&answer=" + a.$code.val()), data: e, contentType: "application/json", success: function (e, t) { if ("200" == e.retCode) { a.$submit.text(_l("提交成功！")); var i = 3, n = setInterval(function () { a.$submit.text(i + _l("秒后开始下载！")), 0 == i && ($("body").css("overflow", "auto"), a.$el.find(".ifa_modal").hide(), a.clickCopyDownload(), clearInterval(n)), i-- }, 1e3); window.localStorage.setItem(s.ALREADY_IFA_VISITOR, "1") } else a.ajaxError(e.retMsg) }, error: function (e) { "403" == e.status ? (a.$code.next().next().html(_l("验证码错误！")), a.$code.parent().addClass("error"), a.$submit.removeAttr("disabled").text(_l("提交")), a.refreshValidationCode()) : a.ajaxError(_l("网络错误！")) } }) }, ajaxError: function (e) { this.$submit.text(e); var t = this, i = 5, n = setInterval(function () { i <= 3 && t.$submit.text(i + _l("秒后重新提交！")), 0 == i && (t.$submit.removeAttr("disabled").text(_l("提交")), clearInterval(n)), i-- }, 1e3) }, clickCopyDownload: function () { $('<a href="' + this.$href + '" download="' + this.$download + '"></a>')[0].click() }, validateUser: function () { var e = this.$el.find('input[name="user"]'); "" == $.trim(e.val()) ? (e.parent().addClass("error"), this.errorCode.push("1")) : e.parent().removeClass("error") }, validateMobile: function () { var e = this.$el.find('input[name="mobile"]'); "" == $.trim(e.val()) ? (e.next().html(_l("手机号码不能为空！")), e.parent().addClass("error"), this.errorCode.push("2")) : i.isValidPhoneNumber($.trim(e.val())) ? e.parent().removeClass("error") : (e.next().html(_l("请输入正确的手机号！")), e.parent().addClass("error"), this.errorCode.push("2")) }, validateCompany: function () { var e = this.$el.find('input[name="companyName"]'); "" == $.trim(e.val()) ? (e.parent().addClass("error"), this.errorCode.push("3")) : e.parent().removeClass("error") }, validateEmail: function () { var e = this.$el.find('input[name="email"]'); "" == e.val() ? e.parent().removeClass("error") : i.isValidMailAddr(e.val()) ? e.parent().removeClass("error") : (e.parent().addClass("error"), this.errorCode.push("4")) }, validateCode: function () { this.$code = this.$el.find('input[name="code"]'), "" == this.$code.val() ? (this.$code.next().next().html(_l("验证码不能为空！")), this.$code.parent().addClass("error"), this.errorCode.push("5")) : this.$code.parent().removeClass("error") }, refreshValidationCode: function () { var e = this.$el.find(".validate-code-btn"), t = i.getRESTfulDomain("captcha/cooperative?force=true&time=" + (new Date).getTime()); e.attr("src", t) } }) }), define("models/uploadAddressBookModel", ["backbone", "helper", "jquery.iframe-transport"], function (a, s) { return a.Model.extend({ fetchAddressBook: function (t) { var i = this, e = { condition: "", pageNo: this.get("pageNo"), rowCount: "10", memType: "" }; t.hideOthers(), t.showLoading(), a.ajax({ type: "GET", url: s.getRESTfulDomain("address/list"), data: e, contentType: "application/json;charset=UTF-8", cache: !1, error: function (e) { t.hideOthers(), t.networkErr() }, success: function (e) { "121" == e.code ? t.needLogin() : "0" == e.code && (i.set("addressBooksArr", e.result.content), i.set("totalPage", e.result.totalPage), i.set("currentPage", e.result.pageNo), t.fetchSucc()) } }) }, uploadAddressBook: function (t) { a.ajax({ type: " POST", dataType: "json", files: t.file, iframe: !0, processData: !1, url: s.getRESTfulDomain("address/importAddress") + s.assemabledLocationAndLanguageQureyString(), success: function (e) { "121" == e.code ? t.needLogin() : "0" == e.code && (1 == e.result.success ? t.uploadSucc() : 0 == e.result.success && (e.result.errors ? t.uploadFail(e.result.errors) : t.uploadFail())) }, error: function (e) { -1 < e.responseText.indexOf("413") ? t.uploadFileTooBig() : t.uploadErr() } }) }, deleteOneAddressBook: function (e, t) { a.ajax({ type: "POST", url: s.getRESTfulDomain("address/" + e + "/delete"), dataType: "json", contentType: "application/json;charset=UTF-8", error: function () { t.deleteErr() }, success: function (e) { "121" == e.code ? t.needLogin() : "0" == e.code && t.deleteSuccess() } }) }, saveToAddressBook: function (e, t, i) { var n = { address: e.address, city: e.location.city, cityCode: e.location.cityCode, companyName: e.companyName, contactName: e.contactName, contactPhone: e.contactPhone, contactTel: e.contactTel, country: "中国", countryCode: "A000086000", county: e.location.county, countyCode: e.location.countyCode, isDefault: "0", locationCode: e.location.locationCode, province: e.location.province, provinceCode: e.location.provinceCode, addressId: t, memType: e.memType, latitude: e.latitude, longitude: e.longitude }; a.ajax({ type: "POST", url: s.getRESTfulDomain("address/save"), data: JSON.stringify(n), dataType: "json", contentType: "application/json;charset=UTF-8", error: function () { i.saveErr() }, success: function (e) { "121" == e.code ? i.needLogin() : "0" == e.code && i.saveSucc() } }) }, getAddressById: function (e, t) { a.ajax({ type: "GET", url: s.getRESTfulDomain("address/" + e + "/query"), contentType: "application/json;charset=UTF-8", error: function () { t.error() }, success: function (e) { "121" == e.code ? t.needLogin() : "0" == e.code && 0 < e.result.length ? t.success(e.result[0]) : t.error() } }) } }) }), define("views/others/uploadAddressBook", ["backbone", "models/uploadAddressBookModel", "templates", "views/others/bootstrapPagination", "components/detailedLocationPicker/picker", "helper", "event", "sflayer"], function (e, t, a, i, s, n, r) { return e.View.extend({ initialize: function () { this.model = new t, $.cookie("loginUser") ? (this.model.set("pageNo", 1), this.getAddressBook()) : r.trigger(r.Needlogin, { succCallback: this.getAddressBook.bind(this), cancelCallback: this.goToIndex.bind(this) }) }, events: { "click .fetchAgain": "getAddressBook", "click tr": "activeRadio", "pageClicked .bootstrap-pagination": "jumpPage", "click input[type=file]": "clearFileInputVal", "change input[type=file]": "uploadTemplate", "click .uploadAgain": "uploadTrigger", "click #hideExtentionError": "hideExtentionErrorModal", "click .delete": "openDeleteConfirmModal", "click .delete-yes": "predeleteAddressBook", "click .option-add": "addOneAddressBook", "click .edit": "preeditOneAddress", "click .save-address": "presaveOneAddress" }, goToIndex: function () { window.location.href = n.getURLWithContext("index.html") }, showInnerhtmlInModal: function (e) { if (0 == this.$("#" + e).length) { var t = a.modalNoHeader({ id: e, body: this.$("." + e).html(), fade: !1, backdrop: !0, width: 435 }); this.$("." + e).html(t).show() } this.$("#" + e).modal("show") }, hideInnerhtmlInModal: function (e) { this.$("#" + e).modal("hide") }, activeRadio: function (e) { "INPUT" == $(e.target)[0].nodeName ? e.stopPropagation() : (this.$('input[type="radio"]').prop("checked", !1), $(e.currentTarget).find('input[type="radio"]').prop("checked", !0)) }, getAddressBook: function () { var e = this; this.model.fetchAddressBook({ hideOthers: function () { e.$(".fetchStatus,.addressList,.initStatus").hide() }, showLoading: function () { e.$(".fetch-loading").show() }, networkErr: function () { e.$(".fetch-network-error").show() }, needLogin: function () { r.trigger(r.Needlogin, { succCallback: e.getAddressBook.bind(e), cancelCallback: function () { this.$(".fetch-loading").hide(), this.$(".fetch-network-error").show() }.bind(e) }) }, fetchSucc: function () { e.renderAddressbook() } }) }, renderAddressbook: function () { if (0 == this.model.get("addressBooksArr").length) 1 < this.model.get("pageNo") ? (this.model.set("pageNo", this.model.get("pageNo") - 1), this.getAddressBook()) : (this.$(".fetch-loading").hide(), this.$(".fetch-null").show()); else { this.$(".addressListBody").html(a.upLoadAddressBookContent({ addressBooksArr: this.model.get("addressBooksArr") })); new i({ el: this.$(".bootstrap-pagination"), totalPages: this.model.get("totalPage"), currentPage: this.model.get("currentPage"), numberOfPages: 4 }); this.$(".fetch-loading").hide(), this.$(".addressList").show() } }, jumpPage: function (e, t) { this.model.set("pageNo", t), this.getAddressBook() }, uploadTrigger: function () { this.$("input[type=file]").trigger("click") }, clearFileInputVal: function () { this.$("input[type=file]").val("") }, uploadTemplate: function (t) { t && this.$(t.target).hasClass("uploadAgain") ? (this.$(t.target).button("loading"), this.uploadActiveEle = this.$(t.target)) : this.uploadActiveEle = null; var e = this.$("input[type=file]").val(); if ("" != e) if ("xlsx" != e.substring(e.lastIndexOf(".") + 1, e.length).toLowerCase()) this.showInnerhtmlInModal("fileExtentionError"), sfgather.trackClicks("点击确认", "109001"); else { var i = this; i.model.uploadAddressBook({ file: i.$('input[type="file"]'), uploadSucc: function () { 0 < i.$("#uploadErrContent").length && i.$("#uploadErrContent").modal("hide"), i.showInnerhtmlInModal("uploadSuccContent"), i.getAddressBook() }, uploadFail: function (e) { 0 < i.$("#uploadErrContent").length && i.$("#uploadErrContent").modal("hide"), "OWF-0007" == e ? (i.showInnerhtmlInModal("uploadErrContent"), i.$(t.target).hasClass("uploadAgain") && i.$(t.target).button("reset")) : (null == e || "OWF-0006" == e ? (i.$(".uploadtemplateErr").siblings(".error").hide().end().show(), sfgather.trackClicks("点击确认", "109001")) : "OWF-0001" == e || "OWF-0005" == e ? (i.$(".uploadrequireErr").siblings(".error").hide().end().show(), sfgather.trackClicks("点击确认", "109002")) : "OWF-0002" == e ? (i.$(".uploadlimitErr").siblings(".error").hide().end().show(), sfgather.trackClicks("点击确认", "109004")) : "OWF-0003" == e ? i.$(".uploadlocationErr").siblings(".error").hide().end().show() : "OWF-0004" == e && (i.$(".uploadtelErr").siblings(".error").hide().end().show(), sfgather.trackClicks("点击确认", "109003")), i.showInnerhtmlInModal("uploadFailContent")) }, uploadFileTooBig: function () { 0 < i.$("#uploadErrContent").length && i.$("#uploadErrContent").modal("hide"), i.$(".uploadtemplateTooBig").siblings(".error").hide().end().show(), i.showInnerhtmlInModal("uploadFailContent") }, uploadErr: function () { i.showInnerhtmlInModal("uploadErrContent"), t && i.$(t.target).hasClass("uploadAgain") && i.$(t.target).button("reset") }, needLogin: function () { r.trigger(r.Needlogin, { succCallback: i.uploadTemplate.bind(i), cancelCallback: function () { this.showInnerhtmlInModal("uploadErrContent"), this.uploadActiveEle && this.uploadActiveEle.button("reset") }.bind(i) }) } }) } }, hideExtentionErrorModal: function () { this.hideInnerhtmlInModal("fileExtentionError") }, openDeleteConfirmModal: function (e) { this.delAddressId = this.$(e.target).closest("tr").data("addid"), this.showInnerhtmlInModal("deleteConfirmContent") }, predeleteAddressBook: function (e) { this.delActiveEle = this.$(e.target), this.delActiveEle.button("loading"), this.deleteAddressBook() }, deleteAddressBook: function () { var e = this; this.model.deleteOneAddressBook(this.delAddressId, { deleteSuccess: function () { e.hideInnerhtmlInModal("deleteConfirmContent"), e.getAddressBook(), e.delActiveEle.button("reset") }, deleteErr: function () { e.$("#deleteConfirmContent .error").show(), e.delActiveEle.button("reset") }, needLogin: function () { r.trigger(r.Needlogin, { succCallback: e.deleteAddressBook.bind(e), cancelCallback: function () { this.$("#deleteConfirmContent .error").show(), this.delActiveEle.button("reset") }.bind(e) }) } }) }, addOneAddressBook: function () { this.popOneAddressContent(null, _l("新增地址")) }, preeditOneAddress: function (e) { this.editAddressId = this.$(e.target).closest("tr").data("addid"), this.editOneAddress() }, editOneAddress: function () { var t = this; this.model.getAddressById(this.editAddressId, { success: function (e) { t.popOneAddressContent(e, _l("修改地址")) }, error: function () { layer.msg(_l("网络错误")) }, needLogin: function () { r.trigger(r.Needlogin, { succCallback: t.editOneAddress.bind(t), cancelCallback: null }) } }) }, popOneAddressContent: function (e, t) { var i = a.addressBookaddOrmod_hk({ addressBook: e }); this.$("#dealOneAddress").remove(); var n = a.modal({ title: t, id: "dealOneAddress", body: i, fade: !1, width: 640 }); this.$(".dealOneAddressContent").html(n), this.$("#dealOneAddress").modal("show"), this.$(".detail-location-input").data("max-A000710000", 5), this.$(".detail-location-input").data("max-886", 5), this.$(".detail-location-input").data("max-A000810000", 5), this.$(".detail-location-input").data("max-852", 5), this.location = new s({ el: this.$(".detail-location-input") }), this.location.setLocationData(e) }, presaveOneAddress: function (e) { if (this.saveActiveEle = this.$(e.target), this.$(".address-form").parsley().validate()) { if ("" == this.$("#add-mobile").val() && "" == this.$("#add-phone").val()) return void this.$(".receiver-both-phone-mobile").show(); if (this.$(".receiver-both-phone-mobile").hide(), this.saveAddressId = this.saveActiveEle.data("addressid"), this.saveAddressId) { var t = _.findWhere(this.model.get("addressBooksArr"), { addressId: this.saveAddressId }); this.saveAddressData = { contactName: this.$("#add-name").val(), contactTel: this.$("#add-mobile").val(), companyName: this.$("#add-company").val(), contactPhone: this.$("#add-phone").val(), location: this.location.getLocationData(), address: this.$("#add-detailaddress").val(), latitude: "", longitude: "", memType: t.memType } } else this.saveAddressData = { contactName: this.$("#add-name").val(), contactTel: this.$("#add-mobile").val(), companyName: this.$("#add-company").val(), contactPhone: this.$("#add-phone").val(), location: this.location.getLocationData(), address: this.$("#add-detailaddress").val(), latitude: "", longitude: "", memType: 2 }; this.$(".address-form .save-fail").hide(), this.saveActiveEle.button("loading"), this.saveAddressId || sfgather.trackClicks("点击保存", "108001"), this.saveOneAddress() } }, saveOneAddress: function () { var e = this; this.model.saveToAddressBook(this.saveAddressData, this.saveAddressId, { saveSucc: function () { e.$("#dealOneAddress").modal("hide"), e.showInnerhtmlInModal("saveSuccContent"), e.getAddressBook() }, saveErr: function () { e.$(".address-form .save-fail").show(), e.saveActiveEle.button("reset") }, needLogin: function () { r.trigger(r.Needlogin, { succCallback: e.saveOneAddress.bind(e), cancelCallback: function () { this.$(".address-form .save-fail").show(), this.saveActiveEle.button("reset") }.bind(e) }) } }) } }) }), define("views/others/usOrder/index", ["baseView", "templates", "helper"], function (e, t, i) { return e.extend({ layerOpts: { title: _l("请选择"), area: ["500px", "225px"], skin: "line" }, template: t.usOrder, events: { "click .enterprise": "toEnterprise", "click .personal": "toPersonal" }, init: function () { }, render: function () { this.$el.html(this.template()) }, toEnterprise: function (e) { e.stopPropagation(), "sc" === i.getSiteLanguage() && window.open("https://osms.sf-express.com/osms/index.pub?request_locale=zh_CN"), "en" === i.getSiteLanguage() && window.open("https://osms.sf-express.com/osms/index.pub?request_locale=en"), this.close() }, toPersonal: function (e) { e.stopPropagation(), window.open("https://usshipweb.sf-express.com/"), this.close() } }) }), define("views/others/index", ["./goDynamic", "./inputIndicator", "./share", "./countDownButton", "./orderButton", "./video/video", "./bannertip", "./secondNavigation", "./swiper", "./accessibleHover", "./mailServiceNav", "./arrowswitch", "./ifaDownload", "./uploadAddressBook", "./usOrder/index"], function (t, i, e, n, a, s, r, o, l, c, d, u, h, p, f) { var m = { "share-pages": e, "order-button": a, videoWrapper: s, "same-tip": r, "content-second-navigation": o, "swiper-container": l, "accessible-hover": c }; return { init: function () { for (var e in m) $("." + e).each(function () { new m[e]({ el: this }) }); new t({ el: $("body") }), new i({ el: $("body") }), $(".count-down-button").each(function () { new n({ el: $(this).parent() }) }), 0 < $(".mail_service").length && new d({ el: $("body") }), 0 < $(".kr-services").length && new u({ el: $(".kr-services .part") }), 0 < $(".ifadownLoad").length && new h({ el: $(".ifadownLoad") }), 0 < $(".uploadAddressBook").length && new p({ el: $(".uploadAddressBook") }), $(".us-order-entry").on("click", function () { new f({}) }) } } }), require.config({ baseUrl: "scripts", shim: { datepicker: { exports: "datepicker" }, datepickercn: { deps: ["datepicker"], exports: "datepickercn" }, momentcn: { deps: ["moment"] }, momenttc: { deps: ["moment"] }, momentko: { deps: ["moment"] }, momentja: { deps: ["moment"] }, momentru: { deps: ["moment"] }, momentvn: { deps: ["moment"] }, momentde: { deps: ["moment"] }, momentfr: { deps: ["moment"] }, momentth: { deps: ["moment"] }, parsleyjs: {}, parsleyjssc: { deps: ["parsleyjs"] }, parsleyjstc: { deps: ["parsleyjs"] }, parsleyjsko: { deps: ["parsleyjs"] }, parsleyjsja: { deps: ["parsleyjs"] }, parsleyjsth: { deps: ["parsleyjs"] }, parsleyjsfr: { deps: ["parsleyjs"] }, parsleyjsde: { deps: ["parsleyjs"] }, jqprint: { deps: ["jquery-migrate"] }, "jquery-validate": { deps: ["jquery"] }, "jquery-scrollable": { deps: ["jquery"] }, "jquery-form": { deps: ["jquery"] } }, paths: { jquery: "../bower_components/jquery/jquery", underscore: "../bower_components/underscore/underscore", backbone: "../bower_components/backbone/backbone", swiper: "lib-fix/swiper-3.4.1.jquery.min", bootstrap: "../bower_components/sass-bootstrap/dist/bootstrap", "jquery-ui": "../bower_components/jquery-ui/jquery-ui", "underscore.string": "../bower_components/underscore.string/lib/underscore.string", bootstrapPagination: "lib-fix/bootstrap-pagination/bootstrap-paginator", moment: "../bower_components/momentjs/moment", momentcn: "../bower_components/momentjs/lang/zh-cn", momenttc: "../bower_components/momentjs/lang/zh-tw", momentko: "../bower_components/momentjs/lang/ko", momentja: "../bower_components/momentjs/lang/ja", momentru: "../bower_components/momentjs/lang/ru", momentvn: "../bower_components/momentjs/lang/vn", momentth: "../bower_components/momentjs/lang/th", momentde: "../bower_components/momentjs/lang/de", momentfr: "../bower_components/momentjs/lang/fr", datepicker: "../bower_components/bootstrap-datepicker/js/bootstrap-datepicker", datepickercn: "lib-fix/bootstrap-datepicker.zh-CN", "jquery-placeholder": "lib-fix/jquery.placeholder", tokenfield: "lib-fix/bootstrap-tokenfield", parsleyjs: "../bower_components/parsleyjs/dist/parsley.min", parsleyjssc: "../bower_components/parsleyjs/src/i18n/zh_cn", parsleyjstc: "../bower_components/parsleyjs/src/i18n/zh_tw", parsleyjsko: "../bower_components/parsleyjs/src/i18n/ko", parsleyjsja: "../bower_components/parsleyjs/src/i18n/ja", parsleyjsth: "../bower_components/parsleyjs/src/i18n/th", parsleyjsfr: "../bower_components/parsleyjs/src/i18n/fr", parsleyjsde: "../bower_components/parsleyjs/src/i18n/de", "jquery-download": "../bower_components/jquery.fileDownload/src/Scripts/jquery.fileDownload", "jQuery.XDomainRequest": "../bower_components/jQuery.XDomainRequest/jQuery.XDomainRequest", "jquery.iframe-transport": "lib-fix/jquery.iframe-transport", jqueryQrcode: "../bower_components/jquery.qrcode.js/jquery.qrcode.min", "jquery-migrate": "lib-fix/jquery-migrate-1.2.1.min", jqprint: "lib-fix/jquery.jqprint-0.3", jqcookie: "lib-fix/jquery.cookie", jqresize: "lib-fix/jquery.ba-resize", sfgather: "lib-fix/SfGather", xlayer: "lib-fix/layer", sflayer: "plugins/sflayer/sflayer", JsBarcode: "lib-fix/JsBarcode.all.min", JqueryRotate: "lib-fix/jquery.rotate", "jquery-validate": "plugins/jqueryValidate/jquery.validate", "sf-validate": "plugins/jqueryValidate/sf-validate", "jquery-scrollable": "plugins/jqueryScrollable", "jquery-form": "lib-fix/jquery.form", jspdf: "lib-fix/jspdf", html2canvas: "../bower_components/html2canvas/build/html2canvas", eventSource: "../bower_components/event-source-polyfill/src/eventsource", const: "utils/constant", verify: "utils/verify", baseView: "views/baseView", popHeightView: "views/popHeightView", components: "views/components/" }, waitSeconds: 0 }), require(["initialSetups", "api/ajax", "views/pages/pageManager", "views/partials/index", "views/others/index"], function (e, t, i, n, a) { new n, a.init(), i() }), define("main", function () { });